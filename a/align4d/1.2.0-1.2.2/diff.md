# Comparing `tmp/align4d-1.2.0.tar.gz` & `tmp/align4d-1.2.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "align4d-1.2.0.tar", last modified: Fri Jan  1 00:00:00 2016, max compression
+gzip compressed data, was "align4d-1.2.2.tar", last modified: Fri Jan  1 00:00:00 2016, max compression
```

## Comparing `align4d-1.2.0.tar` & `align4d-1.2.2.tar`

### file list

```diff
@@ -1,14 +1,16 @@
--rw-r--r--   0        0        0    12435 2023-05-23 03:37:38.315621 align4d-1.2.0/README.md
--rw-r--r--   0        0        0      822 2023-05-23 03:37:55.996851 align4d-1.2.0/pyproject.toml
--rw-r--r--   0        0        0        0 2023-02-22 15:58:38.000000 align4d-1.2.0/src/align4d/__init__.py
--rw-r--r--   0        0        0     4646 2023-05-20 16:07:52.747761 align4d-1.2.0/src/align4d/align.py
--rw-r--r--   0        0        0    68096 2023-05-06 20:40:24.892372 align4d-1.2.0/src/align4d/align4d.cp310-win_amd64.pyd
--rw-r--r--   0        0        0    68096 2023-05-22 21:58:51.584011 align4d-1.2.0/src/align4d/align4d.cp311-win_amd64.pyd
--rw-r--r--   0        0        0   170778 2023-05-22 23:35:26.096799 align4d-1.2.0/src/align4d/align4d.cpython-310-darwin(arm).so
--rw-r--r--   0        0        0   129312 2023-05-23 03:31:21.579946 align4d-1.2.0/src/align4d/align4d.cpython-310-darwin(intel).so
--rw-r--r--   0        0        0   127024 2023-05-22 22:43:40.607750 align4d-1.2.0/src/align4d/align4d.cpython-310-x86_64-linux-gnu.so
--rw-r--r--   0        0        0   170778 2023-05-22 23:42:28.152180 align4d-1.2.0/src/align4d/align4d.cpython-311-darwin(arm).so
--rw-r--r--   0        0        0   170778 2023-05-22 23:42:28.152180 align4d-1.2.0/src/align4d/align4d.cpython-311-darwin(intel).so
--rw-r--r--   0        0        0   127024 2023-05-22 22:46:23.017728 align4d-1.2.0/src/align4d/align4d.cpython-311-x86_64-linux-gnu.so
--rw-r--r--   0        0        0     1126 2023-05-09 01:39:20.296078 align4d-1.2.0/src/align4d/align4d.py
--rw-r--r--   0        0        0    13160 1970-01-01 00:00:00.000000 align4d-1.2.0/PKG-INFO
+-rw-r--r--   0        0        0    13824 2023-05-24 15:58:19.921621 align4d-1.2.2/README.md
+-rw-r--r--   0        0        0      822 2023-05-25 00:05:08.864830 align4d-1.2.2/pyproject.toml
+-rw-r--r--   0        0        0        0 2023-02-22 15:58:38.000000 align4d-1.2.2/src/align4d/__init__.py
+-rw-r--r--   0        0        0     6865 2023-05-24 23:55:09.226943 align4d-1.2.2/src/align4d/align.py
+-rw-r--r--   0        0        0     1126 2023-05-09 01:39:20.296078 align4d-1.2.2/src/align4d/align4d.py
+-rw-r--r--   0        0        0    10873 2023-05-06 05:20:19.306748 align4d-1.2.2/src/align4d/cpp/align.cpp
+-rw-r--r--   0        0        0      739 2023-05-20 18:31:44.397330 align4d-1.2.2/src/align4d/cpp/align.h
+-rw-r--r--   0        0        0    11216 2023-05-06 05:19:22.245690 align4d-1.2.2/src/align4d/cpp/align4d_cpython_extension.cpp
+-rw-r--r--   0        0        0    17229 2023-05-23 22:36:06.537819 align4d-1.2.2/src/align4d/cpp/msa.cpp
+-rw-r--r--   0        0        0     1199 2023-05-06 00:02:45.112359 align4d-1.2.2/src/align4d/cpp/msa.h
+-rw-r--r--   0        0        0     4479 2023-05-06 05:17:40.301355 align4d-1.2.2/src/align4d/cpp/postprocess.cpp
+-rw-r--r--   0        0        0     2175 2023-05-06 05:17:40.309160 align4d-1.2.2/src/align4d/cpp/postprocess.h
+-rw-r--r--   0        0        0    10501 2023-05-23 22:36:06.535319 align4d-1.2.2/src/align4d/cpp/preprocess.cpp
+-rw-r--r--   0        0        0     1375 2023-02-23 22:03:46.707574 align4d-1.2.2/src/align4d/cpp/preprocess.h
+-rw-r--r--   0        0        0     1255 2023-05-24 14:55:30.141829 align4d-1.2.2/src/align4d/cpp/setup.py
+-rw-r--r--   0        0        0    14549 1970-01-01 00:00:00.000000 align4d-1.2.2/PKG-INFO
```

### Comparing `align4d-1.2.0/README.md` & `align4d-1.2.2/README.md`

 * *Files 7% similar despite different names*

```diff
@@ -2,15 +2,15 @@
 
 ## Introduction
 
 **align4d** is a powerful Python package used for aligning text results from Speaker Diarization and Speech Recognition to gold standard transcript, especially when there are overlappings between speakers. This user manual provides a step-by-step guide on how to install, use and troubleshoot the package.
 
 ## Mechanism
 
-The **align4d** uses global alignment alignment that is a multi-sequence variant of Needleman-Wunsch algorithm to align hypothesis (results generated by Speaker Diarization and Speech Recognition models) to reference (usually gold standard transcript, which will be separated into multiple sequence if there are multiple speakers). The alignment happens on the token level. For long sequence the **align4d** will automatically separate the sequence into smaller segments, align them separately by finding the absolute aligned parts (called barriers), and finally assemble them together. 
+The **align4d** uses global alignment algorithm that is a multi-sequence variant of Needleman-Wunsch algorithm to align hypothesis (results generated by Speaker Diarization and Speech Recognition models) to reference (usually gold standard transcript, which will be separated into multiple sequence if there are multiple speakers). The alignment happens on the token level. For long sequence the **align4d** will automatically separate the sequence into smaller segments, align them separately by finding the absolute aligned parts (called barriers), and finally assemble them together. 
 
 The **align4d** uses Levenshtein Distance as the measurement of the similarity between tokens while doing alignment. There can be 4 situations between each position of alignment:
 
 1. Fully match. Two tokens are exactly the same (Levenshtein Distance is 0).
 2. Partially match. Two tokens are not exactly the same but the Levenshtein Distance between them are within a boundary.
 3. Mismatch. Two tokens are different and the Levenshtein Distance between them exceed the boundary.
 4. Gap. Only one token is present because it is aligned to a gap (insertion or deletion of tokens).
@@ -21,74 +21,88 @@
 
 1. Open your terminal or command prompt.
 2. Type in the following command: `pip install align4d`
 3. Wait for the package to download and install.
 
 ## Usage
 
-### Importing Align4d
+### Importing align4d
 
-To use Align4d in your Python code, you need to import it. Here's how:
+To use **align4d** in your Python code, you need to import it. Here's how:
 
 ```python
 from align4d import align
 ```
 
+### Compile
+
+Before actual alignment, the **align4d** is required to compile the c++ source codes distributed along with the package. 
+To ensure successful compilation, the latest version of compiler that supports c++20 is required.
+
+1. For Windows, install or update to the latest version of Visual Studio with the latest version of Visual C++ (or Visual Studio version >= 17.4.4).
+2. For macOS, install or update to the latest version of Xcode with Apple Clang (or Xcode version >= 14.3 with Apple Clang version >= 14.0.3).
+3. For Linux, install or update to the latest version of GCC with G++ (or GCC version >= 11.2.0).
+
+To compile the c++ source code, use the function `align.compile()`:
+
+```python
+align.compile()
+```
+
+At this stage, do not run any alignment related functions introduced in the following sections but just run `align.compile()`.
+Once it is compiled, you don't need to (and should not) run this function again while doing alignment. You do need to rerun the `align.compile()` when you switch to a new environment or reinstall the align4d.
+
 ### Aligning Text Results
 
-Align4d can align results from Speaker Diarization and Speech Recognition. For simple and straight forward usage, the function can be used like this:
+**align4d** can align results from Speaker Diarization and Speech Recognition. For simple and straight forward usage, the function can be used like this:
 
 ```python
 aligned_result = align.align(hypothesis, reference)
 ```
 
 Here's the overview of all parameters of the function:
 
 ```python
-aligned_result = align.align(hypothesis: str | list[str], reference: list[list[str]], partial_bound: int = 2, segment_length: int = None, barrier_length: int = None, strip_punctuation: bool = True)
+aligned_result = align.align(hypothesis: str | list[str], reference: list[list], partial_bound: int = 2, segment_length: int = None, barrier_length: int = None, strip_punctuation: bool = True)
 ```
 
 The `align()` function takes in 6 parameters, the `hypothesis` and `reference` are required and the other 4 of them are optional:
 
 1. `hypothesis`: This is a list of strings or a string containing tokenized text . Each string represents a word that is generated from the Speech Recognition model. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
     
     ```python
     hypothesis = ["ok", "I", "am", "a", "fish", "Are", "you", "Hello", "there", "How", "are", "you", "ok"]
     # or 
     hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
     ```
     
-2. `reference`: This is a nested list of strings containing utterance and speaker labels from the gold standard text. The first string within each secondary list represents the speaker label, the second string represents the utterance. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
+2. `reference`: This is a nested list of strings containing utterance and speaker labels from the gold standard text. The first string within each secondary list represents the speaker label, the second string represents the utterance. The second string can also be a list of strings where each string is a token. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
     
     ```python
     reference = [
         ["A", "I am a fish."],
         ["B", "okay."],
         ["C", "Are you?"],
         ["D", "Hello there."],
         ["E", "How are you?"]
     ]
+    # or 
+    reference = [
+        ["A", ["I", "am", "a", "fish."]],
+        ["B", ["okay."]],
+        ["C", ["Are", "you?"]],
+        ["D", ["Hello", "there."]],
+        ["E", ["How", "are", "you?"]]
+    ]
     ```
     
 3. `partial_bound`: This is an integer that specifies the boundary between partially match and mismatch in terms of the Levenshtein Distance between the two tokens in comparison. This is an optional parameter and the default value is 2.
 4. `segment_length`: This is a integer that specifies the minimum length of each segment in terms of the number of hypothesis tokens. By providing `segment_length` and `barrier_length` the program can perform manual segmentation before actual alignment for long sequence based on the provided parameters. 
     
-    If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is over 100, the program will automatically search the optimal `segment_length` between 30 and 120 and the following message will appear while doing alignment:
-    
-    ```python
-    segment length: 30 max hypothesis length: 13 max reference length: 12
-    segment length: 31 max hypothesis length: 13 max reference length: 12
-    segment length: 32 max hypothesis length: 13 max reference length: 12
-    ...
-    ...
-    segment length: 117 max hypothesis length: 13 max reference length: 12
-    segment length: 118 max hypothesis length: 13 max reference length: 12
-    segment length: 119 max hypothesis length: 13 max reference length: 12
-    optimal length: 119 optimal barrier length: 6
-    ```
+    If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is over 100, the program will automatically search and use the optimal `segment_length` between 30 and 120
     
     If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is lower than 100, no segmentation will be performed.
     
     If `segment_length` and `barrier_length` are provided and both are integers less than or equal to 0, no segmentation will be performed.
     
     It is strongly suggested to perform auto or manual segmentation when the input sequence are long otherwise the alignment may fail because of RAM space limit.
     
@@ -102,22 +116,15 @@
     
     It is important that the `segment_length` and `barrier_length` need to be provided together to perform manual segmentation otherwise an Exception will be raised.
     
     ```python
     Exception: Segment length or barrier length parameter incorrect or missing.
     ```
     
-6. `strip_punctuation`: This is an boolean that specifies if the **align4d** will strip all punctuation in the hypothesis and reference to provide more accurate alignment result or not. The default is set to **True** and the output will provide alignment with the original punctuation. 
-
-At this stage, the alignment function will also print out the relative information for alignment calculation, including the size of the total matrix used for storing scores for alignment, the number of speakers, the maximum score in the matrix, and the time for computation.
-
-```python
- matrix size: 14 5 2 3 3 4  total cell: 5040 speaker num: 5 cell max score: 21
-time: 0
-```
+6. `strip_punctuation`: This is a boolean that specifies if the **align4d** will strip all punctuation in the hypothesis and reference to provide more accurate alignment result or not. The default is set to **True** and the output will provide alignment with the original punctuation.
 
 The `align()` function returns a dictionary containing the aligned results. The hypothesis will be the list of strings (tokens) as the value for the key “hypothesis”. The reference will be separated into multiple sequences according to the provided speaker label, where each sequence will be a list of strings (tokens) as the value for the key of their speaker labels. All the reference sequences will be contained in a secondary dictionary as the value for the key “reference” in the primary dictionary. In each list, each token is aligned to the positions that have the same index and the gap is denoted as “” (empty string). If there is punctuation in the input, the punctuation will be preserved in the output.
 
 ```python
 import json
 
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
@@ -146,24 +153,24 @@
         "E": ['', '', '', '', '', '', '', '', '', 'How', 'are', 'you?', '']
     }
 }
 ```
 
 ### Retrieve token match result
 
-Based on the alignment result, this tool provide function to retrieve the matching result (fully match, partially match, mismatch, gap) for each token. Use `get_token_match_result()` to retrieve the token level matching result.
+Based on the alignment result, this tool provide function to retrieve the matching result (fully match, partially match, mismatch, gap) for each token. Use `token_match()` to retrieve the token level matching result.
 
 The criterion for determining the matching result are the following (also mentioned in the **Mechanism**):
 
 1. fully match: Levenshtein Distance = 0
 2. partially match: Levenshtein Distance ≤ boundary (default to be 2)
 3. mismatch: Levenshtein Distance > boundary (default to be 2)
 4. gap: aligned to a gap
 
-The `get_token_match_result()` requires 2 parameter, the `align_result` which is the direct return value from the previous three alignment functions, and an optional parameter `partial_bound` which must be the same as the `partial_bound` used in `align()` function. 
+The `token_match()` requires 2 parameter, the `align_result` which is the direct return value from the previous three alignment functions, and an optional parameter `partial_bound` which must be the same as the `partial_bound` used in `align()` function. 
 
 ```python
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
 reference = [
         ["A", "I am a fish. "],
         ["B", "okay. "],
         ["C", "Are you? "],
@@ -182,15 +189,15 @@
 ['mismatch', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'gap']
 ```
 
 ### Retrieve mapping from reference to hypothesis
 
 Based on the alignment result, this tool provide function to retrieve the mapping from each token in the reference sequences to the hypothesis sequence. Each index shows the relative position (index) in the hypothesis sequence of the non-gap token (fully match, partially match, or mismatch) from the separated reference sequences. If the index is -1, it means that the current token does not aligned to any token in the hypothesis (align to a gap).
 
-To achieve this, use function `get_align_indices()`. This function requires one parameter, the `align_result` which is the direct return value from the previous `align()` function. 
+To achieve this, use function `align_indices()`. This function requires one parameter, the `align_result` which is the direct return value from the previous `align()` function. 
 
 ```python
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
 reference = [
         ["A", "I am a fish. "],
         ["B", "okay. "],
         ["C", "Are you? "],
@@ -214,13 +221,20 @@
     'E': [9, 10, 11]
 }
 ```
 
 ## Troubleshooting
 This package currently only supports Windows 10/11 x86_64, Linux x86_64 (tested with Ubuntu 22.04), and macOS (M-series processor or Intel processor). 
 
-If you encounter any issues while using Align4d, try the following:
+If you encounter any issues while using **align4d**, try the following:
 
 1. Make sure you have installed Python version 3.10 or 3.11.
-2. Make sure you have installed the latest version of Align4d.
-3. Check the input data to make sure it is in the correct format.
-    1. All the input strings must be encoded in the utf-8 format.
+2. For compilation, make sure you have the compiler that supports c++20. The compilers can be acquired by installing:
+   1. For Windows, install or update to the latest version of Visual Studio with the latest version of Visual C++ (or Visual Studio version >= 17.4.4).
+   2. For macOS, install or update to the latest version of Xcode with Apple Clang (or Xcode version >= 14.3 with Apple Clang version >= 14.0.3).
+   3. For Linux, install or update to the latest version of GCC with G++ (or GCC version >= 11.2.0).
+3. If you have permission or access issues during compilation, please manually delete all compiled objects (ended with .so, .pyd, .dll) in the package under the same directory of align.py.
+4. Do not run `align.compile()` with other align functions (`align()`, `token_match()`, `align_indices()`) at the same time.
+5. Make sure you have installed the latest version of **align4d**.
+6. Check the input data to make sure it is in the correct format.
+   1. All the input strings must be encoded in the utf-8 format.
+   2. Characters that are within the utf-8 format but not part of the natural language may affect the alignment performance. Remove them unless you are clear about the usages about these characters.
```

### Comparing `align4d-1.2.0/pyproject.toml` & `align4d-1.2.2/pyproject.toml`

 * *Files 11% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 [build-system]
 requires = ["flit_core>=3.4"]
 build-backend = "flit_core.buildapi"
 
 [project]
 name = "align4d"
-version = "1.2.0"
+version = "1.2.2"
 authors = [
   { name="Peilin Wu", email="pwu54@emory.edu" },
 ]
 description = "align4d: Multi-sequence alignment tools for aligning ASR and Speaker Diarization result"
 readme = "README.md"
 requires-python = ">=3.10"
 classifiers = [
```

### Comparing `align4d-1.2.0/src/align4d/align4d.py` & `align4d-1.2.2/src/align4d/align4d.py`

 * *Files identical despite different names*

### Comparing `align4d-1.2.0/PKG-INFO` & `align4d-1.2.2/PKG-INFO`

 * *Files 15% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: align4d
-Version: 1.2.0
+Version: 1.2.2
 Summary: align4d: Multi-sequence alignment tools for aligning ASR and Speaker Diarization result
 Author-email: Peilin Wu <pwu54@emory.edu>
 Requires-Python: >=3.10
 Description-Content-Type: text/markdown
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: Microsoft :: Windows :: Windows 10
@@ -18,15 +18,15 @@
 
 ## Introduction
 
 **align4d** is a powerful Python package used for aligning text results from Speaker Diarization and Speech Recognition to gold standard transcript, especially when there are overlappings between speakers. This user manual provides a step-by-step guide on how to install, use and troubleshoot the package.
 
 ## Mechanism
 
-The **align4d** uses global alignment alignment that is a multi-sequence variant of Needleman-Wunsch algorithm to align hypothesis (results generated by Speaker Diarization and Speech Recognition models) to reference (usually gold standard transcript, which will be separated into multiple sequence if there are multiple speakers). The alignment happens on the token level. For long sequence the **align4d** will automatically separate the sequence into smaller segments, align them separately by finding the absolute aligned parts (called barriers), and finally assemble them together. 
+The **align4d** uses global alignment algorithm that is a multi-sequence variant of Needleman-Wunsch algorithm to align hypothesis (results generated by Speaker Diarization and Speech Recognition models) to reference (usually gold standard transcript, which will be separated into multiple sequence if there are multiple speakers). The alignment happens on the token level. For long sequence the **align4d** will automatically separate the sequence into smaller segments, align them separately by finding the absolute aligned parts (called barriers), and finally assemble them together. 
 
 The **align4d** uses Levenshtein Distance as the measurement of the similarity between tokens while doing alignment. There can be 4 situations between each position of alignment:
 
 1. Fully match. Two tokens are exactly the same (Levenshtein Distance is 0).
 2. Partially match. Two tokens are not exactly the same but the Levenshtein Distance between them are within a boundary.
 3. Mismatch. Two tokens are different and the Levenshtein Distance between them exceed the boundary.
 4. Gap. Only one token is present because it is aligned to a gap (insertion or deletion of tokens).
@@ -37,74 +37,88 @@
 
 1. Open your terminal or command prompt.
 2. Type in the following command: `pip install align4d`
 3. Wait for the package to download and install.
 
 ## Usage
 
-### Importing Align4d
+### Importing align4d
 
-To use Align4d in your Python code, you need to import it. Here's how:
+To use **align4d** in your Python code, you need to import it. Here's how:
 
 ```python
 from align4d import align
 ```
 
+### Compile
+
+Before actual alignment, the **align4d** is required to compile the c++ source codes distributed along with the package. 
+To ensure successful compilation, the latest version of compiler that supports c++20 is required.
+
+1. For Windows, install or update to the latest version of Visual Studio with the latest version of Visual C++ (or Visual Studio version >= 17.4.4).
+2. For macOS, install or update to the latest version of Xcode with Apple Clang (or Xcode version >= 14.3 with Apple Clang version >= 14.0.3).
+3. For Linux, install or update to the latest version of GCC with G++ (or GCC version >= 11.2.0).
+
+To compile the c++ source code, use the function `align.compile()`:
+
+```python
+align.compile()
+```
+
+At this stage, do not run any alignment related functions introduced in the following sections but just run `align.compile()`.
+Once it is compiled, you don't need to (and should not) run this function again while doing alignment. You do need to rerun the `align.compile()` when you switch to a new environment or reinstall the align4d.
+
 ### Aligning Text Results
 
-Align4d can align results from Speaker Diarization and Speech Recognition. For simple and straight forward usage, the function can be used like this:
+**align4d** can align results from Speaker Diarization and Speech Recognition. For simple and straight forward usage, the function can be used like this:
 
 ```python
 aligned_result = align.align(hypothesis, reference)
 ```
 
 Here's the overview of all parameters of the function:
 
 ```python
-aligned_result = align.align(hypothesis: str | list[str], reference: list[list[str]], partial_bound: int = 2, segment_length: int = None, barrier_length: int = None, strip_punctuation: bool = True)
+aligned_result = align.align(hypothesis: str | list[str], reference: list[list], partial_bound: int = 2, segment_length: int = None, barrier_length: int = None, strip_punctuation: bool = True)
 ```
 
 The `align()` function takes in 6 parameters, the `hypothesis` and `reference` are required and the other 4 of them are optional:
 
 1. `hypothesis`: This is a list of strings or a string containing tokenized text . Each string represents a word that is generated from the Speech Recognition model. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
     
     ```python
     hypothesis = ["ok", "I", "am", "a", "fish", "Are", "you", "Hello", "there", "How", "are", "you", "ok"]
     # or 
     hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
     ```
     
-2. `reference`: This is a nested list of strings containing utterance and speaker labels from the gold standard text. The first string within each secondary list represents the speaker label, the second string represents the utterance. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
+2. `reference`: This is a nested list of strings containing utterance and speaker labels from the gold standard text. The first string within each secondary list represents the speaker label, the second string represents the utterance. The second string can also be a list of strings where each string is a token. It is suggested to remove all the punctuations, escape values, and any other characters that is not in the natural language.
     
     ```python
     reference = [
         ["A", "I am a fish."],
         ["B", "okay."],
         ["C", "Are you?"],
         ["D", "Hello there."],
         ["E", "How are you?"]
     ]
+    # or 
+    reference = [
+        ["A", ["I", "am", "a", "fish."]],
+        ["B", ["okay."]],
+        ["C", ["Are", "you?"]],
+        ["D", ["Hello", "there."]],
+        ["E", ["How", "are", "you?"]]
+    ]
     ```
     
 3. `partial_bound`: This is an integer that specifies the boundary between partially match and mismatch in terms of the Levenshtein Distance between the two tokens in comparison. This is an optional parameter and the default value is 2.
 4. `segment_length`: This is a integer that specifies the minimum length of each segment in terms of the number of hypothesis tokens. By providing `segment_length` and `barrier_length` the program can perform manual segmentation before actual alignment for long sequence based on the provided parameters. 
     
-    If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is over 100, the program will automatically search the optimal `segment_length` between 30 and 120 and the following message will appear while doing alignment:
-    
-    ```python
-    segment length: 30 max hypothesis length: 13 max reference length: 12
-    segment length: 31 max hypothesis length: 13 max reference length: 12
-    segment length: 32 max hypothesis length: 13 max reference length: 12
-    ...
-    ...
-    segment length: 117 max hypothesis length: 13 max reference length: 12
-    segment length: 118 max hypothesis length: 13 max reference length: 12
-    segment length: 119 max hypothesis length: 13 max reference length: 12
-    optimal length: 119 optimal barrier length: 6
-    ```
+    If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is over 100, the program will automatically search and use the optimal `segment_length` between 30 and 120
     
     If `segment_length` and `barrier_length` are not provided and the hypothesis length in terms of tokens is lower than 100, no segmentation will be performed.
     
     If `segment_length` and `barrier_length` are provided and both are integers less than or equal to 0, no segmentation will be performed.
     
     It is strongly suggested to perform auto or manual segmentation when the input sequence are long otherwise the alignment may fail because of RAM space limit.
     
@@ -118,22 +132,15 @@
     
     It is important that the `segment_length` and `barrier_length` need to be provided together to perform manual segmentation otherwise an Exception will be raised.
     
     ```python
     Exception: Segment length or barrier length parameter incorrect or missing.
     ```
     
-6. `strip_punctuation`: This is an boolean that specifies if the **align4d** will strip all punctuation in the hypothesis and reference to provide more accurate alignment result or not. The default is set to **True** and the output will provide alignment with the original punctuation. 
-
-At this stage, the alignment function will also print out the relative information for alignment calculation, including the size of the total matrix used for storing scores for alignment, the number of speakers, the maximum score in the matrix, and the time for computation.
-
-```python
- matrix size: 14 5 2 3 3 4  total cell: 5040 speaker num: 5 cell max score: 21
-time: 0
-```
+6. `strip_punctuation`: This is a boolean that specifies if the **align4d** will strip all punctuation in the hypothesis and reference to provide more accurate alignment result or not. The default is set to **True** and the output will provide alignment with the original punctuation.
 
 The `align()` function returns a dictionary containing the aligned results. The hypothesis will be the list of strings (tokens) as the value for the key “hypothesis”. The reference will be separated into multiple sequences according to the provided speaker label, where each sequence will be a list of strings (tokens) as the value for the key of their speaker labels. All the reference sequences will be contained in a secondary dictionary as the value for the key “reference” in the primary dictionary. In each list, each token is aligned to the positions that have the same index and the gap is denoted as “” (empty string). If there is punctuation in the input, the punctuation will be preserved in the output.
 
 ```python
 import json
 
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
@@ -162,24 +169,24 @@
         "E": ['', '', '', '', '', '', '', '', '', 'How', 'are', 'you?', '']
     }
 }
 ```
 
 ### Retrieve token match result
 
-Based on the alignment result, this tool provide function to retrieve the matching result (fully match, partially match, mismatch, gap) for each token. Use `get_token_match_result()` to retrieve the token level matching result.
+Based on the alignment result, this tool provide function to retrieve the matching result (fully match, partially match, mismatch, gap) for each token. Use `token_match()` to retrieve the token level matching result.
 
 The criterion for determining the matching result are the following (also mentioned in the **Mechanism**):
 
 1. fully match: Levenshtein Distance = 0
 2. partially match: Levenshtein Distance ≤ boundary (default to be 2)
 3. mismatch: Levenshtein Distance > boundary (default to be 2)
 4. gap: aligned to a gap
 
-The `get_token_match_result()` requires 2 parameter, the `align_result` which is the direct return value from the previous three alignment functions, and an optional parameter `partial_bound` which must be the same as the `partial_bound` used in `align()` function. 
+The `token_match()` requires 2 parameter, the `align_result` which is the direct return value from the previous three alignment functions, and an optional parameter `partial_bound` which must be the same as the `partial_bound` used in `align()` function. 
 
 ```python
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
 reference = [
         ["A", "I am a fish. "],
         ["B", "okay. "],
         ["C", "Are you? "],
@@ -198,15 +205,15 @@
 ['mismatch', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'fully match', 'gap']
 ```
 
 ### Retrieve mapping from reference to hypothesis
 
 Based on the alignment result, this tool provide function to retrieve the mapping from each token in the reference sequences to the hypothesis sequence. Each index shows the relative position (index) in the hypothesis sequence of the non-gap token (fully match, partially match, or mismatch) from the separated reference sequences. If the index is -1, it means that the current token does not aligned to any token in the hypothesis (align to a gap).
 
-To achieve this, use function `get_align_indices()`. This function requires one parameter, the `align_result` which is the direct return value from the previous `align()` function. 
+To achieve this, use function `align_indices()`. This function requires one parameter, the `align_result` which is the direct return value from the previous `align()` function. 
 
 ```python
 hypothesis = "ok I am a fish. Are you? Hello there. How are you? ok"
 reference = [
         ["A", "I am a fish. "],
         ["B", "okay. "],
         ["C", "Are you? "],
@@ -230,13 +237,20 @@
     'E': [9, 10, 11]
 }
 ```
 
 ## Troubleshooting
 This package currently only supports Windows 10/11 x86_64, Linux x86_64 (tested with Ubuntu 22.04), and macOS (M-series processor or Intel processor). 
 
-If you encounter any issues while using Align4d, try the following:
+If you encounter any issues while using **align4d**, try the following:
 
 1. Make sure you have installed Python version 3.10 or 3.11.
-2. Make sure you have installed the latest version of Align4d.
-3. Check the input data to make sure it is in the correct format.
-    1. All the input strings must be encoded in the utf-8 format.
+2. For compilation, make sure you have the compiler that supports c++20. The compilers can be acquired by installing:
+   1. For Windows, install or update to the latest version of Visual Studio with the latest version of Visual C++ (or Visual Studio version >= 17.4.4).
+   2. For macOS, install or update to the latest version of Xcode with Apple Clang (or Xcode version >= 14.3 with Apple Clang version >= 14.0.3).
+   3. For Linux, install or update to the latest version of GCC with G++ (or GCC version >= 11.2.0).
+3. If you have permission or access issues during compilation, please manually delete all compiled objects (ended with .so, .pyd, .dll) in the package under the same directory of align.py.
+4. Do not run `align.compile()` with other align functions (`align()`, `token_match()`, `align_indices()`) at the same time.
+5. Make sure you have installed the latest version of **align4d**.
+6. Check the input data to make sure it is in the correct format.
+   1. All the input strings must be encoded in the utf-8 format.
+   2. Characters that are within the utf-8 format but not part of the natural language may affect the alignment performance. Remove them unless you are clear about the usages about these characters.
```

