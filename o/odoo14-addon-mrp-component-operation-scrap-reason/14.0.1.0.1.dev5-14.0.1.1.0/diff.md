# Comparing `tmp/odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5-py3-none-any.whl.zip` & `tmp/odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,18 @@
-Zip file size: 22239 bytes, number of entries: 16
--rw-r--r--  2.0 unx     2798 b- defN 23-Mar-09 05:47 odoo/addons/mrp_component_operation_scrap_reason/README.rst
--rw-r--r--  2.0 unx       22 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/__init__.py
--rw-r--r--  2.0 unx      666 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/__manifest__.py
--rw-r--r--  2.0 unx     1596 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/i18n/it.po
--rw-r--r--  2.0 unx     1362 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/i18n/mrp_component_operation_scrap_reason.pot
--rw-r--r--  2.0 unx       47 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx       89 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx     9455 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/static/description/icon.png
--rw-r--r--  2.0 unx    11915 b- defN 23-Mar-09 05:47 odoo/addons/mrp_component_operation_scrap_reason/static/description/index.html
--rw-r--r--  2.0 unx       36 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/wizards/__init__.py
--rw-r--r--  2.0 unx      504 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate.py
--rw-r--r--  2.0 unx      779 b- defN 23-Mar-09 05:46 odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate_wizard.xml
--rw-r--r--  2.0 unx     3495 b- defN 23-Mar-09 05:47 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Mar-09 05:47 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Mar-09 05:47 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2050 b- defN 23-Mar-09 05:47 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/RECORD
-16 files, 34911 bytes uncompressed, 18587 bytes compressed:  46.8%
+Zip file size: 22513 bytes, number of entries: 16
+-rw-r--r--  2.0 unx     2836 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/README.rst
+-rw-r--r--  2.0 unx       22 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/__init__.py
+-rw-r--r--  2.0 unx      666 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/__manifest__.py
+-rw-r--r--  2.0 unx     1596 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/i18n/it.po
+-rw-r--r--  2.0 unx     1582 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/i18n/mrp_component_operation_scrap_reason.pot
+-rw-r--r--  2.0 unx       85 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       89 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/static/description/icon.png
+-rw-r--r--  2.0 unx    12046 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/static/description/index.html
+-rw-r--r--  2.0 unx       36 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/wizards/__init__.py
+-rw-r--r--  2.0 unx     1240 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate.py
+-rw-r--r--  2.0 unx      850 b- defN 23-May-25 07:18 odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate_wizard.xml
+-rw-r--r--  2.0 unx     3528 b- defN 23-May-25 07:19 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-25 07:19 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-25 07:19 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2031 b- defN 23-May-25 07:19 odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/RECORD
+16 files, 36159 bytes uncompressed, 18901 bytes compressed:  47.7%
```

## zipnote {}

```diff
@@ -30,20 +30,20 @@
 
 Filename: odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate.py
 Comment: 
 
 Filename: odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate_wizard.xml
 Comment: 
 
-Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/METADATA
+Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/WHEEL
+Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/top_level.txt
+Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/RECORD
+Filename: odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/mrp_component_operation_scrap_reason/README.rst

```diff
@@ -50,14 +50,15 @@
 
 * ForgeFlow
 
 Contributors
 ~~~~~~~~~~~~
 
 * David Jiménez <david.jimenez@forgeflow.com>
+* Lois Rilo <lois.rilo@forgeflow.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

## odoo/addons/mrp_component_operation_scrap_reason/__manifest__.py

```diff
@@ -1,18 +1,18 @@
 # Copyright 2022 ForgeFlow S.L. (https://www.forgeflow.com)
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/lgpl).
 
 {
     "name": "MRP Component Operation Scrap Reason",
-    "version": "14.0.1.0.0",
+    "version": "14.0.1.1.0",
     "author": "ForgeFlow, Odoo Community Association (OCA)",
     "summary": "Allows to pass a reason to scrap with MRP component operation",
     "website": "https://github.com/OCA/manufacture",
     "category": "Manufacturing/Manufacturing",
     "license": "AGPL-3",
     "depends": ["scrap_reason_code", "mrp_component_operation"],
     "data": [
         "wizards/mrp_component_operate_wizard.xml",
     ],
     "installable": True,
-    "auto-install": True,
+    "auto_install": True,
 }
```

## odoo/addons/mrp_component_operation_scrap_reason/i18n/mrp_component_operation_scrap_reason.pot

```diff
@@ -10,14 +10,19 @@
 "Language-Team: \n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
 
 #. module: mrp_component_operation_scrap_reason
+#: model:ir.model.fields,field_description:mrp_component_operation_scrap_reason.field_mrp_component_operate__allowed_reason_code_ids
+msgid "Allowed Reason Code"
+msgstr ""
+
+#. module: mrp_component_operation_scrap_reason
 #: model:ir.model,name:mrp_component_operation_scrap_reason.model_mrp_component_operate
 msgid "Component Operate"
 msgstr ""
 
 #. module: mrp_component_operation_scrap_reason
 #: model:ir.model.fields,field_description:mrp_component_operation_scrap_reason.field_mrp_component_operate__display_name
 msgid "Display Name"
```

## odoo/addons/mrp_component_operation_scrap_reason/readme/CONTRIBUTORS.rst

```diff
@@ -1 +1,2 @@
 * David Jiménez <david.jimenez@forgeflow.com>
+* Lois Rilo <lois.rilo@forgeflow.com>
```

## odoo/addons/mrp_component_operation_scrap_reason/static/description/index.html

### odoo/addons/mrp_component_operation_scrap_reason/static/description/index.html

```diff
@@ -439,14 +439,19 @@
           </h2>
           <ul class="simple">
             <li>
               David Jiménez &lt;
               <a class="reference external" href="mailto:david.jimenez@forgeflow.com">david.jimenez@forgeflow.com</a>
               &gt;
             </li>
+            <li>
+              Lois Rilo &lt;
+              <a class="reference external" href="mailto:lois.rilo@forgeflow.com">lois.rilo@forgeflow.com</a>
+              &gt;
+            </li>
           </ul>
         </div>
         <div class="section" id="maintainers">
           <h2>
             <a class="toc-backref" href="#id5">Maintainers</a>
           </h2>
           <p>This module is maintained by the OCA.</p>
```

## odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate.py

```diff
@@ -1,18 +1,37 @@
-# Copyright 2022 ForgeFlow S.L. (https://www.forgeflow.com)
+# Copyright 2022-23 ForgeFlow S.L. (https://www.forgeflow.com)
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/lgpl).
 
-from odoo import fields, models
+from odoo import api, fields, models
 
 
 class MrpComponentOperate(models.Model):
     _inherit = "mrp.component.operate"
 
     scrap_reason_code_id = fields.Many2one(
-        "scrap.reason.code",
+        comodel_name="scrap.reason.code",
         string="Scrap Reason Code",
+        domain="[('id', 'in', allowed_reason_code_ids)]",
     )
+    allowed_reason_code_ids = fields.Many2many(
+        comodel_name="scrap.reason.code",
+        compute="_compute_allowed_reason_code_ids",
+    )
+
+    @api.depends("product_id")
+    def _compute_allowed_reason_code_ids(self):
+        for rec in self:
+            codes = self.env["scrap.reason.code"]
+            if rec.product_id:
+                codes = codes.search(
+                    [
+                        "|",
+                        ("product_category_ids", "=", False),
+                        ("product_category_ids", "in", rec.product_id.categ_id.id),
+                    ]
+                )
+            rec.allowed_reason_code_ids = codes
 
     def _create_scrap(self):
         scrap = super()._create_scrap()
         scrap.reason_code_id = self.scrap_reason_code_id
         return scrap
```

## odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate_wizard.xml

### odoo/addons/mrp_component_operation_scrap_reason/wizards/mrp_component_operate_wizard.xml

```diff
@@ -3,11 +3,12 @@
   <record id="view_mrp_component_operate_form_scrap_reason" model="ir.ui.view">
     <field name="name">view_mrp_component_operate_form_scrap_reason</field>
     <field name="model">mrp.component.operate</field>
     <field name="inherit_id" ref="mrp_component_operation.view_mrp_component_operate_form"/>
     <field name="arch" type="xml">
       <field name="operation_id" position="after">
         <field name="scrap_reason_code_id" attrs="{'invisible': [('outgoing_operation', '!=', 'scrap')], 'required': [('outgoing_operation', '=', 'scrap')]}"/>
+        <field name="allowed_reason_code_ids" invisible="1"/>
       </field>
     </field>
   </record>
 </odoo>
```

## Comparing `odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.0.1.dev5.dist-info/METADATA` & `odoo14_addon_mrp_component_operation_scrap_reason-14.0.1.1.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-mrp-component-operation-scrap-reason
-Version: 14.0.1.0.1.dev5
+Version: 14.0.1.1.0
 Summary: Allows to pass a reason to scrap with MRP component operation
 Home-page: https://github.com/OCA/manufacture
 Author: ForgeFlow, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
@@ -68,14 +68,15 @@
 
 * ForgeFlow
 
 Contributors
 ~~~~~~~~~~~~
 
 * David Jiménez <david.jimenez@forgeflow.com>
+* Lois Rilo <lois.rilo@forgeflow.com>
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
```

