# Comparing `tmp/siat-2.0.5-py3-none-any.whl.zip` & `tmp/siat-2.0.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,25 +1,26 @@
-Zip file size: 1131923 bytes, number of entries: 117
+Zip file size: 1135604 bytes, number of entries: 118
 -rw-rw-rw-  2.0 fat      840 b- defN 23-Apr-10 11:29 siat/__init__.py
 -rw-rw-rw-  2.0 fat     2130 b- defN 23-Apr-10 11:29 siat/allin.py
 -rw-rw-rw-  2.0 fat      747 b- defN 23-Apr-10 11:29 siat/alpha_vantage_test.py
 -rw-rw-rw-  2.0 fat    28555 b- defN 23-Apr-10 11:29 siat/assets_liquidity.py
 -rw-rw-rw-  2.0 fat     1285 b- defN 23-Apr-10 11:29 siat/assets_liquidity_test.py
 -rw-rw-rw-  2.0 fat    10110 b- defN 23-Apr-10 11:29 siat/barrons_scraping_test.py
 -rw-rw-rw-  2.0 fat    36597 b- defN 23-Apr-10 11:29 siat/beta_adjustment.py
 -rw-rw-rw-  2.0 fat    20433 b- defN 23-Apr-10 11:29 siat/beta_adjustment_china.py
 -rw-rw-rw-  2.0 fat     2467 b- defN 23-Apr-10 11:29 siat/beta_adjustment_test.py
 -rw-rw-rw-  2.0 fat     6032 b- defN 23-Apr-10 11:29 siat/blockchain.py
--rw-rw-rw-  2.0 fat    98594 b- defN 23-May-22 15:20 siat/bond.py
+-rw-rw-rw-  2.0 fat    98691 b- defN 23-May-25 03:33 siat/bond.py
 -rw-rw-rw-  2.0 fat    24155 b- defN 23-Apr-10 11:29 siat/bond_base.py
+-rw-rw-rw-  2.0 fat     3002 b- defN 23-May-25 13:09 siat/bond_china.py
 -rw-rw-rw-  2.0 fat     5246 b- defN 23-Apr-10 11:29 siat/bond_test.py
 -rw-rw-rw-  2.0 fat    28499 b- defN 23-Apr-10 11:29 siat/capm_beta.py
 -rw-rw-rw-  2.0 fat     1745 b- defN 23-Apr-10 11:29 siat/capm_beta_test.py
 -rw-rw-rw-  2.0 fat    38116 b- defN 23-Apr-10 11:29 siat/cmat_commons.py
--rw-rw-rw-  2.0 fat    63743 b- defN 23-Apr-10 11:29 siat/common.py
+-rw-rw-rw-  2.0 fat    65280 b- defN 23-May-25 13:08 siat/common.py
 -rw-rw-rw-  2.0 fat    20806 b- defN 23-Apr-11 14:17 siat/compare_cross.py
 -rw-rw-rw-  2.0 fat     3473 b- defN 23-Apr-10 11:29 siat/compare_cross_test.py
 -rw-rw-rw-  2.0 fat     3061 b- defN 23-Apr-10 11:29 siat/concepts_iwencai.py
 -rw-rw-rw-  2.0 fat     4941 b- defN 23-Apr-10 11:29 siat/concepts_kpl.py
 -rw-rw-rw-  2.0 fat      690 b- defN 23-Apr-10 11:29 siat/copyrights.py
 -rw-rw-rw-  2.0 fat    27351 b- defN 23-Apr-10 11:29 siat/cryptocurrency.py
 -rw-rw-rw-  2.0 fat     2669 b- defN 23-Apr-10 11:29 siat/cryptocurrency_test.py
@@ -42,15 +43,15 @@
 -rw-rw-rw-  2.0 fat     3118 b- defN 23-Apr-10 11:29 siat/financials_china2_test3.py
 -rw-rw-rw-  2.0 fat    17549 b- defN 23-Apr-10 11:29 siat/financials_china_test.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:54 siat/financials_china_test2.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:55 siat/financials_china_test2_fin_indicator.py
 -rw-rw-rw-  2.0 fat    23829 b- defN 23-Apr-10 11:29 siat/financials_test.py
 -rw-rw-rw-  2.0 fat     1201 b- defN 23-Apr-10 11:29 siat/fred_test.py
 -rw-rw-rw-  2.0 fat    24637 b- defN 23-Apr-10 11:29 siat/fund.py
--rw-rw-rw-  2.0 fat    67706 b- defN 23-May-22 16:04 siat/fund_china.py
+-rw-rw-rw-  2.0 fat    73231 b- defN 23-May-25 13:11 siat/fund_china.py
 -rw-rw-rw-  2.0 fat     6649 b- defN 23-Apr-10 11:29 siat/fund_china_test.py
 -rw-rw-rw-  2.0 fat     1116 b- defN 23-Apr-10 11:29 siat/fund_test.py
 -rw-rw-rw-  2.0 fat    16657 b- defN 23-May-22 07:43 siat/future_china.py
 -rw-rw-rw-  2.0 fat     1163 b- defN 23-Apr-10 11:29 siat/future_china_test.py
 -rw-rw-rw-  2.0 fat     2402 b- defN 23-Apr-10 11:29 siat/global_index_test.py
 -rw-rw-rw-  2.0 fat    63498 b- defN 23-May-10 12:01 siat/grafix.py
 -rw-rw-rw-  2.0 fat     3150 b- defN 23-Apr-10 11:29 siat/grafix_test.py
@@ -62,35 +63,35 @@
 -rw-rw-rw-  2.0 fat     1593 b- defN 23-Apr-10 11:29 siat/markowitz_ccb_test.py
 -rw-rw-rw-  2.0 fat     4032 b- defN 23-Apr-10 11:29 siat/markowitz_ef_test.py
 -rw-rw-rw-  2.0 fat    33046 b- defN 23-Apr-10 11:29 siat/markowitz_old.py
 -rw-rw-rw-  2.0 fat     5818 b- defN 23-Apr-10 11:29 siat/markowitz_test.py
 -rw-rw-rw-  2.0 fat     2193 b- defN 23-Apr-11 06:52 siat/markowitz_test2.py
 -rw-rw-rw-  2.0 fat    86874 b- defN 23-Apr-10 11:29 siat/ml_cases.py
 -rw-rw-rw-  2.0 fat     1673 b- defN 23-Apr-10 11:29 siat/ml_cases_example1.py
--rw-rw-rw-  2.0 fat    95112 b- defN 23-May-23 00:50 siat/option_china.py
+-rw-rw-rw-  2.0 fat    95158 b- defN 23-May-24 14:28 siat/option_china.py
 -rw-rw-rw-  2.0 fat    16355 b- defN 23-Apr-10 11:29 siat/option_china_test.py
 -rw-rw-rw-  2.0 fat    69625 b- defN 23-Apr-10 11:29 siat/option_pricing.py
 -rw-rw-rw-  2.0 fat     2203 b- defN 23-Apr-10 11:29 siat/option_pricing_test.py
 -rw-rw-rw-  2.0 fat     5908 b- defN 23-Apr-10 11:29 siat/option_sina_api_test.py
 -rw-rw-rw-  2.0 fat     2610 b- defN 23-Apr-10 11:29 siat/proxy_test.py
 -rw-rw-rw-  2.0 fat     1552 b- defN 23-Apr-10 11:29 siat/quandl_test.py
 -rw-rw-rw-  2.0 fat    49073 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return.py
 -rw-rw-rw-  2.0 fat     3416 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return_test.py
 -rw-rw-rw-  2.0 fat    75061 b- defN 23-Apr-10 11:29 siat/risk_evaluation.py
 -rw-rw-rw-  2.0 fat     3731 b- defN 23-Apr-10 11:29 siat/risk_evaluation_test.py
 -rw-rw-rw-  2.0 fat    12304 b- defN 23-Apr-10 11:29 siat/risk_free_rate.py
 -rw-rw-rw-  2.0 fat     4285 b- defN 23-Apr-10 11:29 siat/risk_free_rate_test.py
 -rw-rw-rw-  2.0 fat   100084 b- defN 23-May-04 05:22 siat/sector_china.py
 -rw-rw-rw-  2.0 fat     5843 b- defN 23-Apr-11 14:17 siat/sector_china_test.py
--rw-rw-rw-  2.0 fat    29148 b- defN 23-Apr-10 11:29 siat/security_price.py
+-rw-rw-rw-  2.0 fat    29185 b- defN 23-May-25 02:36 siat/security_price.py
 -rw-rw-rw-  2.0 fat    71984 b- defN 23-May-22 08:26 siat/security_prices.py
 -rw-rw-rw-  2.0 fat    10779 b- defN 23-Apr-10 11:29 siat/security_prices_test.py
 -rw-rw-rw-  2.0 fat     1335 b- defN 23-Apr-10 11:29 siat/setup.py
 -rw-rw-rw-  2.0 fat     1418 b- defN 23-Apr-10 11:29 siat/shenwan index history test.py
--rw-rw-rw-  2.0 fat   117508 b- defN 23-May-10 12:01 siat/stock.py
+-rw-rw-rw-  2.0 fat   117962 b- defN 23-May-25 08:18 siat/stock.py
 -rw-rw-rw-  2.0 fat    31655 b- defN 23-Apr-10 11:29 siat/stock_advice_linear.py
 -rw-rw-rw-  2.0 fat     1312 b- defN 23-Apr-10 11:29 siat/stock_base.py
 -rw-rw-rw-  2.0 fat    68123 b- defN 23-Apr-10 11:29 siat/stock_china.py
 -rw-rw-rw-  2.0 fat     1276 b- defN 23-Apr-10 11:29 siat/stock_china_test.py
 -rw-rw-rw-  2.0 fat  1242926 b- defN 23-Apr-10 11:29 siat/stock_info.pickle
 -rw-rw-rw-  2.0 fat     6122 b- defN 23-Apr-10 11:29 siat/stock_info_test.py
 -rw-rw-rw-  2.0 fat     1014 b- defN 23-Apr-10 11:29 siat/stock_list_china_test.py
@@ -103,17 +104,17 @@
 -rw-rw-rw-  2.0 fat    16648 b- defN 23-Apr-18 09:06 siat/test2_graphviz.py
 -rw-rw-rw-  2.0 fat    16999 b- defN 23-Apr-14 14:38 siat/test_graphviz.py
 -rw-rw-rw-  2.0 fat    14492 b- defN 23-Apr-10 11:29 siat/transaction.py
 -rw-rw-rw-  2.0 fat    18580 b- defN 23-Apr-10 11:29 siat/transaction_test.py
 -rw-rw-rw-  2.0 fat   117953 b- defN 23-Apr-10 11:29 siat/translate-20230125.py
 -rw-rw-rw-  2.0 fat   118133 b- defN 23-Apr-10 11:29 siat/translate-20230206.py
 -rw-rw-rw-  2.0 fat   121657 b- defN 23-Apr-10 11:29 siat/translate-20230215.py
--rw-rw-rw-  2.0 fat   125295 b- defN 23-May-23 13:30 siat/translate.py
+-rw-rw-rw-  2.0 fat   126254 b- defN 23-May-25 03:25 siat/translate.py
 -rw-rw-rw-  2.0 fat     3936 b- defN 23-Apr-10 11:29 siat/universal_test.py
 -rw-rw-rw-  2.0 fat    51342 b- defN 23-May-11 00:30 siat/valuation_china.py
 -rw-rw-rw-  2.0 fat     1571 b- defN 23-Apr-10 11:29 siat/valuation_market_china_test.py
 -rw-rw-rw-  2.0 fat    14859 b- defN 23-Apr-10 11:29 siat/var_model_validation.py
--rw-rw-rw-  2.0 fat     1399 b- defN 23-May-23 13:42 siat-2.0.5.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-May-23 13:42 siat-2.0.5.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        5 b- defN 23-May-23 13:42 siat-2.0.5.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     9354 b- defN 23-May-23 13:42 siat-2.0.5.dist-info/RECORD
-117 files, 4462838 bytes uncompressed, 1117653 bytes compressed:  75.0%
+-rw-rw-rw-  2.0 fat     1399 b- defN 23-May-25 14:01 siat-2.0.7.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-May-25 14:01 siat-2.0.7.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        5 b- defN 23-May-25 14:01 siat-2.0.7.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     9429 b- defN 23-May-25 14:01 siat-2.0.7.dist-info/RECORD
+118 files, 4474570 bytes uncompressed, 1121222 bytes compressed:  75.0%
```

## zipnote {}

```diff
@@ -30,14 +30,17 @@
 
 Filename: siat/bond.py
 Comment: 
 
 Filename: siat/bond_base.py
 Comment: 
 
+Filename: siat/bond_china.py
+Comment: 
+
 Filename: siat/bond_test.py
 Comment: 
 
 Filename: siat/capm_beta.py
 Comment: 
 
 Filename: siat/capm_beta_test.py
@@ -333,20 +336,20 @@
 
 Filename: siat/valuation_market_china_test.py
 Comment: 
 
 Filename: siat/var_model_validation.py
 Comment: 
 
-Filename: siat-2.0.5.dist-info/METADATA
+Filename: siat-2.0.7.dist-info/METADATA
 Comment: 
 
-Filename: siat-2.0.5.dist-info/WHEEL
+Filename: siat-2.0.7.dist-info/WHEEL
 Comment: 
 
-Filename: siat-2.0.5.dist-info/top_level.txt
+Filename: siat-2.0.7.dist-info/top_level.txt
 Comment: 
 
-Filename: siat-2.0.5.dist-info/RECORD
+Filename: siat-2.0.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## siat/bond.py

```diff
@@ -691,19 +691,22 @@
     ebd=exchange_bond_deal(num,option) 
     option='6'
     ebd=exchange_bond_deal(num,option) 
 
 #==============================================================================
 if __name__=='__main__':
     symbol='sh019521'
-    fromdate='2022-1-1'
-    todate='2022-6-30'
+    symbol='sz102229'
+    fromdate='2023-1-1'
+    todate='2023-5-20'
     power=4
+    
+    prices=exchange_bond_price(symbol,fromdate,todate,power=power)
 
-def exchange_bond_price(symbol,fromdate,todate,power=4):
+def exchange_bond_price(symbol,fromdate,todate,power=0):
     """
     功能：获得沪深债券市场历史成交行情
     输入：沪深债券代码symbol，起始日期fromdate，截止日期todate。
     返回：历史价格df
     输出：折线图
     """
     #检查日期期间的合理性
```

## siat/common.py

```diff
@@ -1871,9 +1871,59 @@
     df['timestamp']=df.index
     df['timestamp'] = df['timestamp'].apply(remove_timezone)
     df.index=df['timestamp']
     del df['timestamp']
     
     return df
 #==============================================================================
+if __name__=='__main__':
+    ltext='景顺长城沪深300指数增强A,景顺长城量化精选股票,景顺长城量化新动力股票,景顺长城量化平衡混合'
+
+def print_long_text(ltext,separators=[',','，'],numberPerLine=4,colalign='left'):
+    """
+    功能：分行打印有规律的长字符串，每行打印numPerLine，分隔符列表为separators
+    """
+    # 分隔符合成
+    reSeparator=''
+    for s in separators:
+        reSeparator=reSeparator+s+'|'
+    reSLen=len(reSeparator) 
+    reSeparator=reSeparator[:-1]           
+    
+    # 分割长字符串，形成列表
+    import re
+    aList=re.split(reSeparator,ltext)
+    aListLen=len(aList)
+    printInLine_md(aList,numberPerLine=numberPerLine,colalign=colalign)
+    
+    return aListLen
+    
+#==============================================================================
+if __name__=='__main__':
+    printInMarkdown(df)
+
+def printInMarkdown(df,titletxt='',footnote='', \
+                    firstAlign='center',restAlign='center'):
+    """
+    功能：使用markdown格式打印df
+    """
+    colList=list(df)
+    colNum=len(colList)
+
+    # 打印标题
+    if not titletxt == '':
+        print(' ')
+        print(titletxt,'\n')
+    else:
+        print(' ')
+    
+    # 打印表体
+    alignList=[firstAlign]+[restAlign]*(colNum-1)
+    print(df.to_markdown(index=False,tablefmt='plain',colalign=alignList))
+    
+    # 打印尾注
+    if not footnote == '':
+        print('\n',footnote)
+    
+    return
 #==============================================================================
```

## siat/fund_china.py

```diff
@@ -1541,15 +1541,15 @@
     fdf=compare_metf_china(fund_list,start,end,ftype='单位净值',graph=True)
     
 #==============================================================================
 #==============================================================================
 #==============================================================================
 #以下信息专注于中国内地基金信息，来源于akshare，尚未利用
 #==============================================================================
-def fund_info_china():
+def fund_info_china0():
     
     #证券公司集合资管产品
     cam_df = ak.amac_securities_info()
     
     #证券公司直投基金：
     #中国证券投资基金业协会-信息公示-私募基金管理人公示-基金产品公示-证券公司直投基金
     sdif_df = ak.amac_aoin_info()
@@ -1677,14 +1677,159 @@
     print(footnote)
 
     
     return list(names_etf4['基金代码']),names_etf2
 
 #==============================================================================
 #==============================================================================
+if __name__=='__main__':
+    fund='sh510170'
+    fund='sh000311'
+    
+    info=fund_info_china('sh510170')
+    info=fund_info_china('510170.SS')
+
+def fund_info_china(fund):
+    """
+    功能：查询中国基金代码和类型
+    注意：实际仅需6位数字代码
+    
+    数据来源：东方财富，天天基金网
+    """
+    print("Searching for fund info, it may take a long time, please wait ...")
+    
+    # 代码中提取6位数字
+    fund1=fund.upper()
+    exchlist=['SH','SZ','.SS','.SZ']
+    for exch in exchlist:
+        fund1=fund1.replace(exch,'')
+    
+    import pandas as pd
+    import akshare as ak
+    # 检查基金是否存在
+    try:
+        names = ak.fund_name_em()
+        namedf=names[names['基金代码']==fund1]
+        
+        if len(namedf) >= 1:
+            df1=namedf[['基金代码','基金简称','基金类型']]
+            fname=namedf['基金简称'].values[0]
+            ftype=namedf['基金类型'].values[0]
+        else:
+            print("  #Warning(fund_info_china): info not found for fund",fund)
+            return None
+    except:
+            print("  #Warning(fund_info_china): info source inaccessible for now, try later")
+            return None
+    
+    # 基金评级
+    df6=pd.DataFrame()
+    titletxt6="***** 基金概况与评级"
+    footnote6="注：评级机构为上海证券、招商证券和济安金信，数字表示星星个数，在同类基金中通常越高越好"
+    try:
+        dft6 = ak.fund_rating_all()
+        dft6t=dft6[dft6['代码']==fund1]
+        dft6t.fillna('---',inplace=True)
+        fmanager=dft6t['基金经理'].values[0]
+        
+        if len(dft6t) >= 1:
+            df6=dft6t
+            printInMarkdown(df6,titletxt=titletxt6,footnote=footnote6)
+    except:
+        pass
+    
+    # 指数型基金信息
+    df2=pd.DataFrame()
+    titletxt2="***** 指数型基金的相关信息"
+    footnote2="注：单位净值元，日/今年来/今年来的增长率及手续费为百分比"
+    try:
+        dft2 = ak.fund_info_index_em(symbol="全部", indicator="全部")
+        dft2.sort_values('基金代码',inplace=True)
+        dft2t=dft2[dft2['基金代码']==fund1]
+        
+        if len(dft2t) >= 1:
+            df2=dft2t[['基金代码','单位净值','日期','日增长率','今年来','今年来','手续费']]
+            printInMarkdown(df2,titletxt=titletxt2,footnote=footnote2)
+    except:
+        pass
+    
+    # 基金持仓：股票
+    titletxt3="***** 基金持仓情况：股票"
+    footnote3="注：占净值比例为百分比，持股数为万股，(持仓)市值为万元"
+    df3=pd.DataFrame()
+    import datetime; today = datetime.date.today()
+    thisYear=str(today)[:4]
+    try:
+        dft3 = ak.fund_portfolio_hold_em(symbol=fund1,date=thisYear)
+        dft3.sort_values(by=['季度','占净值比例'],ascending=[False,False],inplace=True)
+        
+        if len(dft3) >= 1:
+            df3=dft3
+            df3['持仓类型']='股票'
+            printInMarkdown(df3,titletxt=titletxt3,footnote=footnote3)
+    except:
+        pass
+    
+    # 基金持仓：债券
+    titletxt4="***** 基金持仓情况：债券"
+    df4=pd.DataFrame()
+    try:
+        dft4 = ak.fund_portfolio_bond_hold_em(symbol=fund1,date=thisYear)
+        dft4.sort_values(by=['季度','占净值比例'],ascending=[False,False],inplace=True)
+        
+        if len(dft4) >= 1:
+            df4=dft4
+            df4['持仓类型']='债券'
+            printInMarkdown(df4,titletxt=titletxt4)
+    except:
+        print("\n #Warning(fund_info_china): unable to retrieve bond holding info for",fund,"@",thisYear)
+
+    
+    # 基金持仓：行业配置
+    titletxt5="***** 基金的行业配置情况"
+    footnote5="注：占净值比例为百分比，市值为万元"
+    df5=pd.DataFrame()
+    try:
+        dft5 = ak.fund_portfolio_industry_allocation_em(symbol=fund1,date=thisYear)
+        dft5.sort_values(by=['截止时间','占净值比例'],ascending=[False,False],inplace=True)
+        
+        if len(dft5) >= 1:
+            df5=dft5
+            df5['持仓类型']='行业配置'   
+            printInMarkdown(df5,titletxt=titletxt5,footnote=footnote5)
+    except:
+        pass
+    
+    # 基金经理
+    titletxt7="***** 基金经理的相关情况"
+    source="数据来源：东方财富/天天基金"
+    footnote7="注：从业时间为天数，现任基金资产总规模为该基金经理管辖所有基金的总规模(亿元)，最佳回报为历史业绩(百分比)\n"+source+"，"+str(today)
+    
+    df7=pd.DataFrame()
+    try:
+        dft7 = ak.fund_manager(adjust='0')
+        dft7t=dft7[dft7['姓名']==fmanager]
+        
+        if len(dft7t) >= 1:
+            current=dft7t['现任基金'].values[0]
+            df7=dft7t[['姓名','所属公司','累计从业时间','现任基金资产总规模','现任基金最佳回报']]
+            
+            printInMarkdown(df7,titletxt=titletxt7)
+            print(' ')
+            print("基金经理当前兼任情况：")
+            num=print_long_text(current)
+            print(' ')
+            print(footnote7)
+    except:
+        print("\n #Warning(fund_info_china): unable to retrieve job info for",fmanager)
+    
+    return 
+
+#==============================================================================
+#==============================================================================
 #==============================================================================
 #==============================================================================
 #==============================================================================
```

## siat/option_china.py

```diff
@@ -525,17 +525,17 @@
 #==============================================================================
 
 if __name__=='__main__':
     symbol="华夏上证50ETF期权"
     symbol="华泰柏瑞沪深300ETF期权"
     symbol="嘉实沪深300ETF期权"
     symbol="沪深300股指期权"
-    num=12
+    num=24
     
-def option_fin_month_china(symbol,num=12):
+def option_fin_month_china(symbol,num=24):
     """
     功能：遍历并显示一个金融期货品种的到期年月YYMM
     """
     
     if not (symbol in option_fin_list):
         print("  #Warning(option_fin_month_china): info not found for",symbol)
         return None
@@ -623,15 +623,15 @@
     nth_weekday('2112',4,3)
 #==============================================================================
 if __name__=='__main__':
     symbol="华夏上证50ETF期权"
     symbol="华泰柏瑞沪深300ETF期权"
     symbol="嘉实沪深300ETF期权"
     symbol="沪深300股指期权"   
-    end_month='2112'
+    end_month='2312'
     direction='call'
     printout=True
     
     
 def option_fin_contracts(symbol,end_month,direction='call',printout=True):
     """
     功能：抓取指定金融期权品种和到期日年月的具体合约
@@ -666,14 +666,15 @@
             df1=df[df['direction']=='C']
         elif utype=='PUT':
             df1=df[df['direction']=='P']
         else:
             df1=df
         
         #取交易日期
+        df1.set_index('日期',inplace=True)
         df1['date']=df1.index[0][:8]
         contracts['date']=pd.to_datetime(df1['date'])
         
         #去掉前后空格
         df1['合约交易代码']=df1['合约交易代码'].apply(lambda x: x.strip())
         contracts['contract']=df1['合约交易代码']
```

## siat/security_price.py

```diff
@@ -7,14 +7,16 @@
 最新修订日期：2020年2月2日
 作者：王德宏 (WANG Dehong, Peter)
 作者单位：北京外国语大学国际商学院
 作者邮件：wdehong2000@163.com
 版权所有：王德宏
 用途限制：仅限研究与教学使用，不可商用！商用需要额外授权。
 特别声明：作者不对使用本工具进行证券投资导致的任何损益负责！
+
+注意：本文件弃用！！！
 """
 
 #==============================================================================
 #屏蔽所有警告性信息
 import warnings; warnings.filterwarnings('ignore')
 #==============================================================================
 #以下使用雅虎财经数据源
```

## siat/stock.py

```diff
@@ -433,14 +433,20 @@
     df=security_price("01810.HK","2022-11-1","2022-12-15")
     
     # 测试获取股价：美股
     df=security_price("JD","2022-11-1","2022-12-15")
     df=security_price("AAPL","2022-11-1","2022-12-15")
 
 #==============================================================================
+if __name__ =="__main__":
+    ticker="185851.SS"
+    fromdate="2023-1-1"
+    todate="2023-5-20"
+
+
 def stock_price(ticker, fromdate, todate, adj=False, datatag=False, power=0):
     """
     功能：绘制证券价格折线图。
     输入：证券代码ticker；开始日期fromdate，结束日期todate；
     是否标注数据标签datatag，默认否；多项式趋势线的阶数，若为0则不绘制趋势线。
     输出：绘制证券价格折线图
     返回：证券价格数据表
@@ -507,28 +513,28 @@
     df1c=ret_volatility2(df1b,ticker1,fromdate,todate,graph=False)
 
     #加入收益率下偏标准差指标
     df1d=ret_lpsd2(df1c,ticker1,fromdate,todate,graph=False)
 
     return df1d
 
-def stock_ret(ticker,fromdate,todate,type="Daily Ret%",datatag=False,power=4,graph=True):
+def stock_ret(ticker,fromdate,todate,rtype="Daily Ret%",datatag=False,power=4,graph=True):
     """
     功能：绘制证券收益率折线图。
     输入：证券代码ticker；开始日期fromdate，结束日期todate；收益率类型type；
     是否标注数据标签datatag，默认否；多项式趋势线的阶数，若为0则不绘制趋势线。
     输出：绘制证券价格折线图
     返回：证券价格数据表
     """
     #调整抓取样本的开始日期366*2=732，以便保证有足够的样本供后续计算
     fromdate1=date_adjust(fromdate, -732)
 
     #抓取证券价格
     adj=False
-    if 'Adj' in type: adj=True
+    if 'Adj' in rtype: adj=True
     pricedf=get_price(ticker,fromdate1,todate,adj=adj)
     if pricedf is None:
         print("  #Error(stock_ret): failed to find price info for",ticker,fromdate,todate)
         return None
     pricedfcols=list(pricedf)    
     
     #加入日收益率
@@ -547,25 +553,25 @@
     
     #获得支持的收益率类型列名
     colnames=list(erdf)
     for c in pricedfcols:
         colnames.remove(c)
     
     #检查type是否在支持的收益率列名中
-    if not (type in colnames):
+    if not (rtype in colnames):
         print("  #Error(stock_ret)：only support return types of",colnames)
         return        
 
     titletxt=texttranslate("证券收益率走势图：")+codetranslate(ticker)
     import datetime; today = datetime.date.today()
     footnote=texttranslate("数据来源：新浪/东方财富/stooq，")+str(today)
-    collabel=ectranslate(type)
-    ylabeltxt=ectranslate(type)
+    collabel=ectranslate(rtype)
+    ylabeltxt=ectranslate(rtype)
     pltdf=erdf[erdf.index >= fromdate]
-    plot_line(pltdf,type,collabel,ylabeltxt,titletxt,footnote,datatag=datatag, \
+    plot_line(pltdf,rtype,collabel,ylabeltxt,titletxt,footnote,datatag=datatag, \
               power=power,zeroline=True)
     
     return erdf
 
 if __name__ =="__main__":
     ticker="000002.SZ"
     fromdate="2020-1-1"
@@ -939,18 +945,23 @@
     返回：无
     """
     #筛选证券指标，检验是否支持指标
     dfcols=list(df)
     #nouselist=['date','Weekday','ticker']
     #for c in nouselist: dfcols.remove(c)
     
-    if not (measure1 in dfcols) or not (measure2 in dfcols):
-        print("... #Error(comp_1security_2measures)，supporting measures: ",dfcols)
+    if not (measure1 in dfcols):
+        print("  #Error(comp_1security_2measures): unsupported measures: ",measure1)
+        print("  Supporting measures: ",dfcols)
         return        
-
+    if not (measure2 in dfcols):
+        print("  #Error(comp_1security_2measures): unsupported measures: ",measure2)
+        print("  Supporting measures: ",dfcols)
+        return 
+    
     #判断是否绘制水平0线
     pricelist=['High','Low','Open','Close','Volume','Adj Close']
     if (measure1 in pricelist) or (measure2 in pricelist): 
         zeroline=False
     else: zeroline=True
 
     #提取信息
@@ -1135,16 +1146,22 @@
         
         #去掉开始日期以前的数据
         pltdf1=df1d[df1d.index >= fromdate]
         #绘制单个证券的双指标对比图
         if graph:
             comp_1security_2measures(pltdf1,measure1,measure2,twinx=twinx,loc1=loc1,loc2=loc2,graph=graph)
         
-        result1=pltdf1[[measure1]]
-        result2=pltdf1[[measure2]]
+        try:
+            result1=pltdf1[[measure1]]
+        except:
+            return None,None
+        try:
+            result2=pltdf1[[measure2]]
+        except:
+            return result1,None
         
     elif (security_num >= 2) and (measure_num >= 1):
         #双证券+单个测度指标        
         #证券ticker1：抓取行情，并计算其各种期间的收益率
         df1a=stock_ret(ticker1,fromdate,todate,graph=False)
         if df1a is None: return None,None
         #加入价格波动指标
```

## siat/translate.py

```diff
@@ -1661,19 +1661,21 @@
     从文件中查询证券代码的短名称，速度较慢
     """
     # 查询股票名称
     name=get_names0(symbol)
     
     #未查到时再查询其他种类的证券
     if name == symbol:
-        
         # 查询基金
         name=get_fund_name_china(symbol)
         
+    #未查到时再查询其他种类的证券
+    if name == symbol:
         # 查询债券
+        name=get_bond_name_china(symbol)
         
     return name
 
 
 #==============================================================================
 if __name__=='__main__':
     symbol='00700.HK'
@@ -1763,27 +1765,60 @@
     # 代码中提取6位数字
     fund1=fund.upper()
     exchlist=['SH','SZ','.SS','.SZ']
     for exch in exchlist:
         fund1=fund1.replace(exch,'')
     
     import akshare as ak
-    names = ak.fund_name_em()
-    namedf=names[names['基金代码']==fund1]
-    
-    if len(namedf) >= 1:
-        fname=namedf['基金简称'].values[0]
-        ftype=namedf['基金类型'].values[0]
-    else:
+    try:
+        names = ak.fund_name_em()
+        namedf=names[names['基金代码']==fund1]
+        
+        if len(namedf) >= 1:
+            fname=namedf['基金简称'].values[0]
+            ftype=namedf['基金类型'].values[0]
+        else:
+            fname=fund
+            ftype=''
+    except:
         fname=fund
-        ftype=''
-    
+        
     #return fname,ftype
     return fname
 
+#==============================================================================
+if __name__=='__main__':
+    bond="185851.SS"
+    bond="102229.SZ"
+    
+    get_bond_name_china('sh185851')
+    get_bond_name_china('185851.SS')
+    
+    get_bond_name_china("102229.SZ")
+
+def get_bond_name_china(bond):
+    """
+    功能：查询中国债券名称
+    注意：实际仅需6位数字代码
+    """
+    # 代码中提取6位数字
+    bond1=bond.upper()
+    # 顺序不可颠倒
+    exchlist=['.SS','.SZ','SH','SZ']
+    for exch in exchlist:
+        bond1=bond1.replace(exch,'')
+    
+    import akshare as ak
+    try:
+        bname=ak.bond_info_cm(bond_code=bond1)['债券简称'].values[0]
+    except:
+        bname=bond
+    
+    return bname
+
 #==============================================================================    
 #==============================================================================
 def str_replace(str1):
     """
     删除给定字符串中的子串
     """
     replist=['Ltd.','Ltd','Co.','LTD.','CO.',' CO','LTD','Inc.','INC.', \
```

## Comparing `siat-2.0.5.dist-info/METADATA` & `siat-2.0.7.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: siat
-Version: 2.0.5
+Version: 2.0.7
 Summary: Securities Investment Analysis Tools (siat)
 Home-page: https://pypi.org/project/siat/
 Author: Prof. WANG Dehong, Business School, BFSU (北京外国语大学 国际商学院 王德宏 教授)
 Author-email: wdehong2000@163.com
 License: Copyright (C) WANG Dehong, 2023. For educational purpose only!
 Platform: UNKNOWN
 Requires-Dist: pandas-datareader
```

## Comparing `siat-2.0.5.dist-info/RECORD` & `siat-2.0.7.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -4,21 +4,22 @@
 siat/assets_liquidity.py,sha256=ma-1rO_t_Mg3j_suWcySHkBoAl-H71CR1dm7iEGAfwM,28555
 siat/assets_liquidity_test.py,sha256=UWk6HIUlizU7LQZ890fGx8LwU1jMMrIZswg8cFUJWZ8,1285
 siat/barrons_scraping_test.py,sha256=jSRVPxyYylcgG3fAsuqE-9WH3sDfJ3CdZUcU8VBVdoU,10110
 siat/beta_adjustment.py,sha256=PW1DgBB17u8jjaDl4Bi6pEQ5RE_tIjg3kZB1xP8l9KI,36597
 siat/beta_adjustment_china.py,sha256=FX5xdGHiVKo0f03RhWmkz398t5VbkvL8Eyw2xLz5Lvw,20433
 siat/beta_adjustment_test.py,sha256=nBhvQQfqxooCHjy5hL0a8V0ZC58BjuCZVFpqpWpHeF0,2467
 siat/blockchain.py,sha256=awF3GDtlwaJhku0a2kLuXOS8d3IzkjR_RyzlZWvD3L4,6032
-siat/bond.py,sha256=7PUCzSgpnqEi1_faUNzdbP40TGGjeLOq3npzxgkCUbs,98594
+siat/bond.py,sha256=7jLdkJ2_UHhm3cpTPF1TlBU6Qq-5M6dVlEtLY3td7vg,98691
 siat/bond_base.py,sha256=mY1TscUH2kWzsR3Cnh5ea0Xu7-Nc8ZyFupraRipi4BM,24155
+siat/bond_china.py,sha256=ct28F7d6V0m9S3S-t-0lW1ZnSQYSCZhmsCHcZrPZno8,3002
 siat/bond_test.py,sha256=yUOFw7ddGU-kb1rJdnsjkJWziDNgUR7OLDA7F7Ub91A,5246
 siat/capm_beta.py,sha256=L40UbrSU4QQ5CxmEu8CpLT5WptsOUOfDRF7Pxdw6HZs,28499
 siat/capm_beta_test.py,sha256=ImR0c5mc4hIl714XmHztdl7qg8v1E2lycKyiqnFj6qs,1745
 siat/cmat_commons.py,sha256=Nj9Kf0alywaztVoMVeVVL_EZk5jRERJy8R8kBw88_Tg,38116
-siat/common.py,sha256=3qyrC3lAxD-nZ8nXW8rzZi9luUmgNV-pY1dj7Mz88OQ,63743
+siat/common.py,sha256=O1bBT3EHGCUloIEI-rEw_xvzDLAHa6WYe5GDTuEDGV4,65280
 siat/compare_cross.py,sha256=XXLLBFz66vkrup50ehyP7jR5IyHUB3zqEJGCzWibVYw,20806
 siat/compare_cross_test.py,sha256=xra5XYmQGEtfIZL2h-GssdH2hLdFIhG3eoCrkDrL3gY,3473
 siat/concepts_iwencai.py,sha256=m1YEDtECRT6FqtzlKm91pt2I9d3Z_XoP59BtWdRdu8I,3061
 siat/concepts_kpl.py,sha256=SJ9UaJp5i79EXKZ3dPa_vBEoG_zgl1Ig5rZAm-ubgM4,4941
 siat/copyrights.py,sha256=YMLjZb328YpFMR-s_GUu0HBgeGce3pV7DgRut8S3I7w,690
 siat/cryptocurrency.py,sha256=SKh_S85cqd2tRgKBKls1Fpd6HdFd9JfmUTCa2e3mpsE,27351
 siat/cryptocurrency_test.py,sha256=3AikTNJ7j-HwLGLIYEfyXZ3bLVuLeru9mwiwHQi2SdA,2669
@@ -41,15 +42,15 @@
 siat/financials_china2_test3.py,sha256=UXYSA80DNSPRhHpovc2MA9JkpILWMAQaRatbWCHBNPs,3118
 siat/financials_china_test.py,sha256=QS1SD_mXx4uH1Lg3gl2PmwLrvkLqkRs3e4x7SyFI_Xk,17549
 siat/financials_china_test2.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
 siat/financials_china_test2_fin_indicator.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
 siat/financials_test.py,sha256=HJ3CPo_Xckz2wXi3AEP6ZNWCF1Duc1pLi0Y10USiImc,23829
 siat/fred_test.py,sha256=KF50ssSbsfpa_kT6iuomD0vG4eXztAcOasZxg1OGX5w,1201
 siat/fund.py,sha256=wMDORsCBV8ZXfgwbtq-0bu3qqWY66dHnbqgllW0gWCo,24637
-siat/fund_china.py,sha256=Oz9pUGWV6Q5LSOo2vTnrJq3woN2m_c3nvC0lqgu5MRM,67706
+siat/fund_china.py,sha256=Hf89CFTJ3z4RV4ij218w2cPIvn-1Wk3YwrhbCSmdSVs,73231
 siat/fund_china_test.py,sha256=-Bh6m0J0GPpIbYXx-H2vpzJoNFI6pE2C2jVPa8DazgE,6649
 siat/fund_test.py,sha256=V4ADb8Gsp8gyeFTwcgRsJBpnUih_O-Q2V1ILc5oKjK8,1116
 siat/future_china.py,sha256=5fTJCQ0AnZcHUY47TIaRXrASndzMTttAWPe2_QkhGk4,16657
 siat/future_china_test.py,sha256=BrSzmDVaOHki6rntOtosmRn-6dkfOBuLulJNqh7MOpc,1163
 siat/global_index_test.py,sha256=hnFp3wqqzzL-kAP8mgxDZ54Bd5Ijf6ENi5YJlGBgcXw,2402
 siat/grafix.py,sha256=P9juLNhqs1TkmKz9oPZxlra2obVGcTVN1QdsJ4fZJn4,63498
 siat/grafix_test.py,sha256=kXvcpLgQNO7wd30g_bWljLj5UH7bIVI0_dUtXbfiKR0,3150
@@ -61,35 +62,35 @@
 siat/markowitz_ccb_test.py,sha256=xBkkoaNHdq9KSUrNuHGgKTdNYUvgi84kNYcf719eoyE,1593
 siat/markowitz_ef_test.py,sha256=wjNlICkgRIqnonPeSIHo4Mu2GRtb9dr21wDt2kMNEcI,4032
 siat/markowitz_old.py,sha256=Lf7O_4QWT8RsdkHiUyc_7kKY3eZjKDtFR89Fz3pwYnY,33046
 siat/markowitz_test.py,sha256=fDXoPp6DrKeneYjd0lbb0KfYUJj-VcOvVaPlfsIOstw,5818
 siat/markowitz_test2.py,sha256=FcVZqYU5va4567WGUVUJ7cMQdVbBGxeBAz82Y3BhCTI,2193
 siat/ml_cases.py,sha256=FYDk0O7l9hhHlbrlOVGgbH-h2DA503lhKFi9XugH1f0,86874
 siat/ml_cases_example1.py,sha256=xRGb3YTQEDTOnaWNzZN_myU5umQnA2RdMNiPrxTmn9c,1673
-siat/option_china.py,sha256=h8QSaF9TJJAW2IEhTOPfAmgjiwKDZJtlxgLYJTsGiIE,95112
+siat/option_china.py,sha256=Oorj8Bmrl22kuLOkEiqnTPwe37Jw-Vo3AhICQX4uwEc,95158
 siat/option_china_test.py,sha256=UQ-YUHUjoGBQyanLcM-yzqeEIUQP_gCQIeT0W6rnUnA,16355
 siat/option_pricing.py,sha256=ZvOziCkXODUjqSw2Q7Ux_gepw9UQaGMgvbI_YuceyX8,69625
 siat/option_pricing_test.py,sha256=eeorV5Ja5vjlRXnP6fWJHetGU5Vb8SnLopkC6RV3GfA,2203
 siat/option_sina_api_test.py,sha256=dn-k_wrQnAaNKHoROvWJEc7lqlU0bwiV2Aa4usWAFGM,5908
 siat/proxy_test.py,sha256=erQJrmGs2X46z8Gb1h-7GYQ0rTUcaR8dxHExWoBz2eM,2610
 siat/quandl_test.py,sha256=EcPoXnLuqzPl5dKyVEZi3j3PJZFpsnU_iNPhLWC9p-A,1552
 siat/risk_adjusted_return.py,sha256=8vyjOCap9xEvWIpJnBEsDm8Ba3CD9QrEXy2qFG6zvVk,49073
 siat/risk_adjusted_return_test.py,sha256=m_VHL5AtT74cJv5i7taTeTfnkX48y0AFJk5phawyYWg,3416
 siat/risk_evaluation.py,sha256=lCDqCaSEppH0MFPFg-P14IYcF3IJqILbPfDmzf_AfcY,75061
 siat/risk_evaluation_test.py,sha256=YEXM96gKzTfwN4U61AS4Rr1tV7KgUvn4rRC6f3iMw9s,3731
 siat/risk_free_rate.py,sha256=r62zCl1qbI4lJU17GsgM-OmVx9oo3dltXeZVCNd6Uxg,12304
 siat/risk_free_rate_test.py,sha256=CpmhUf8aEAEZeNu4gvWP2Mz2dLoIgBX5bI41vfUBEr8,4285
 siat/sector_china.py,sha256=0JFs5wXZXOu5tuGnFXKBuR4TVIGqvP_W4psQAAAjW-M,100084
 siat/sector_china_test.py,sha256=1wq7ef8Bb_L8F0h0W6FvyBrIcBTEbrTV7hljtpj49U4,5843
-siat/security_price.py,sha256=ibrdUJyt_n0c8oKRbVStE1_ptmWkzy4YIHjpc_fGiPQ,29148
+siat/security_price.py,sha256=2oHskgiw41KMGfqtnA0i2YjNNV6cYgtlUK0j3YeuXWs,29185
 siat/security_prices.py,sha256=vmN39llWbm-B1awfuZzR14UlEca6Tm3KOvBQUYZJzXw,71984
 siat/security_prices_test.py,sha256=OEphoJ87NPKoNow1QA8EU_5MUYrJF-qKoWKNapVfZNI,10779
 siat/setup.py,sha256=up65rQGLmTBkhtaMLowjoQXYmIsnycnm4g1SYmeQS6o,1335
 siat/shenwan index history test.py,sha256=JCVAzOSEldHalhSFa3pqD8JI_8_djPMQOxpkuYU-Esg,1418
-siat/stock.py,sha256=UtM4ybqEShGaCmHmi__vpOeaXJtAj77SkWZ6onpYNS0,117508
+siat/stock.py,sha256=zIDSttJSO6z5Cp4Jq5eNeRHvmeqCkhMZgwIM_aGT47s,117962
 siat/stock_advice_linear.py,sha256=-twT7IGP-NEplkL1WPSACcNJjggRB2j4mlAQCkzOAuo,31655
 siat/stock_base.py,sha256=uISvbRyOGy8p9QREA96CVydgflBkn5L3OXOGKl8oanc,1312
 siat/stock_china.py,sha256=qsrGq5tUyToOGDfVRnMEeiGps2Tpz5o38LlK6kB6k3Y,68123
 siat/stock_china_test.py,sha256=Qc1m19FAUSvBi9E0ZTVcYBveiGYFIlIFvthbidzCe1s,1276
 siat/stock_info.pickle,sha256=gzhzPvCrX3tr24CzWPVAOXPJ21XQ5keU2cz6PfKwfJ8,1242926
 siat/stock_info_test.py,sha256=gfG3DbhDACbtD8wnv_R6zhj0t11XaC8NX8uLD9Qv3Fo,6122
 siat/stock_list_china_test.py,sha256=gv14UwMMvkZqtb6G7DCTSuehIwVHuVwu7w60p6gyHoo,1014
@@ -102,16 +103,16 @@
 siat/test2_graphviz.py,sha256=05w2YJuIBH0LsJjdA60EFn7rL0vCo-CA6EVJEQOXNE4,16648
 siat/test_graphviz.py,sha256=CETKpDL8PnysS-PD3fHkeAgagUxjaUl0CsXPiadQySg,16999
 siat/transaction.py,sha256=foTWS1qYXQFuzNTG2m7ec6aDgsJjzpKmyAbyxKcE8KU,14492
 siat/transaction_test.py,sha256=Z8g1LJCN4-mnUByXMUMoFmN0t105cbmsz2QmvSuIkbU,18580
 siat/translate-20230125.py,sha256=NPPSXhT38s5t9fzMvl_fvi4ckSB73ThLmZetVI-xGdU,117953
 siat/translate-20230206.py,sha256=-vtI125WyaJhmPotOpDAmclt_XnYVaWU9ByLWZ6FyYE,118133
 siat/translate-20230215.py,sha256=TJgtPE3n8IjljmZ4Pefy8dmHoNdFF-1zpML6BhA9FKE,121657
-siat/translate.py,sha256=tp8UfU2MIYyzGiT9mZm2wGdjDGteTuFzMMpI0DSr_ZY,125295
+siat/translate.py,sha256=pW6jWGfuypUNgZiu_ojJLsaEOEb12XWDzdp77z1sG3I,126254
 siat/universal_test.py,sha256=CDAOffW1Rvs-TcNN5giWVvHMlch1w4dp-w5SIV9jXL0,3936
 siat/valuation_china.py,sha256=gYYXeT9bBPyQ251TCsYlibWcu6JA8x-YOKqLUEeLE7U,51342
 siat/valuation_market_china_test.py,sha256=gbJ0ioauuo4koTPH6WKUkqcXiQPafnbhU5eKJ6lpdLA,1571
 siat/var_model_validation.py,sha256=zB_Skk_tmzIR15l6oAW3am4HBGVIG-eZ8gJhCdXZ8Qw,14859
-siat-2.0.5.dist-info/METADATA,sha256=lZs9P8HtV4jaVZhOoV-RfkF6OmTIRv3av0ea3SHQgOM,1399
-siat-2.0.5.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-siat-2.0.5.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
-siat-2.0.5.dist-info/RECORD,,
+siat-2.0.7.dist-info/METADATA,sha256=0EqJR3k60Tub6vJw9HCaWO-7bjd5cI1_YFk7UEUD308,1399
+siat-2.0.7.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
+siat-2.0.7.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
+siat-2.0.7.dist-info/RECORD,,
```

