# Comparing `tmp/stemtool-2023.2.6-py3.9.egg` & `tmp/stemtool-2023.5.25-py3.10.egg`

## zipinfo {}

```diff
@@ -1,62 +1,56 @@
-Zip file size: 195489 bytes, number of entries: 60
--rw-r--r--  2.0 unx     1547 b- defN 23-Feb-06 16:52 EGG-INFO/PKG-INFO
--rw-r--r--  2.0 unx      854 b- defN 23-Feb-06 16:52 EGG-INFO/SOURCES.txt
--rw-r--r--  2.0 unx        1 b- defN 23-Feb-06 16:52 EGG-INFO/dependency_links.txt
--rw-r--r--  2.0 unx        1 b- defN 20-Aug-07 19:51 EGG-INFO/not-zip-safe
--rw-r--r--  2.0 unx      179 b- defN 23-Feb-06 16:52 EGG-INFO/requires.txt
--rw-r--r--  2.0 unx        9 b- defN 23-Feb-06 16:52 EGG-INFO/top_level.txt
--rw-r--r--  2.0 unx      216 b- defN 20-Jul-26 19:25 stemtool/__init__.py
--rw-r--r--  2.0 unx       26 b- defN 23-Feb-06 16:49 stemtool/__version__.py
--rw-r--r--  2.0 unx      845 b- defN 20-May-01 17:03 stemtool/code_timer.py
--rw-r--r--  2.0 unx      841 b- defN 20-Dec-30 13:41 stemtool/timer.py
--rw-r--r--  2.0 unx      412 b- defN 23-Feb-06 16:52 stemtool/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx      175 b- defN 23-Feb-06 16:52 stemtool/__pycache__/__version__.cpython-39.pyc
--rw-r--r--  2.0 unx      895 b- defN 23-Feb-06 16:52 stemtool/__pycache__/code_timer.cpython-39.pyc
--rw-r--r--  2.0 unx      889 b- defN 23-Feb-06 16:52 stemtool/__pycache__/timer.cpython-39.pyc
--rw-r--r--  2.0 unx       56 b- defN 20-Jul-26 19:25 stemtool/afit/__init__.py
--rw-r--r--  2.0 unx    42862 b- defN 23-Feb-06 12:29 stemtool/afit/atom_positions.py
--rw-r--r--  2.0 unx     9668 b- defN 23-Feb-06 12:26 stemtool/afit/drift_corr.py
--rw-r--r--  2.0 unx      204 b- defN 23-Feb-06 16:52 stemtool/afit/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    33492 b- defN 23-Feb-06 16:52 stemtool/afit/__pycache__/atom_positions.cpython-39.pyc
--rw-r--r--  2.0 unx     8972 b- defN 23-Feb-06 16:52 stemtool/afit/__pycache__/drift_corr.cpython-39.pyc
--rw-r--r--  2.0 unx       24 b- defN 20-May-01 17:03 stemtool/beam/__init__.py
--rw-r--r--  2.0 unx     3495 b- defN 20-May-01 17:03 stemtool/beam/gen_probe.py
--rw-r--r--  2.0 unx      177 b- defN 23-Feb-06 16:52 stemtool/beam/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx     3190 b- defN 23-Feb-06 16:52 stemtool/beam/__pycache__/gen_probe.cpython-39.pyc
--rw-r--r--  2.0 unx       75 b- defN 20-Jul-26 19:25 stemtool/dpc/__init__.py
--rw-r--r--  2.0 unx    22908 b- defN 23-Feb-06 12:07 stemtool/dpc/atomic_dpc.py
--rw-r--r--  2.0 unx     8339 b- defN 23-Feb-06 12:07 stemtool/dpc/dpc_utils.py
--rw-r--r--  2.0 unx    10890 b- defN 23-Feb-06 12:27 stemtool/dpc/nbed_dpc.py
--rw-r--r--  2.0 unx      218 b- defN 23-Feb-06 16:52 stemtool/dpc/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    18160 b- defN 23-Feb-06 16:52 stemtool/dpc/__pycache__/atomic_dpc.cpython-39.pyc
--rw-r--r--  2.0 unx     6599 b- defN 23-Feb-06 16:52 stemtool/dpc/__pycache__/dpc_utils.cpython-39.pyc
--rw-r--r--  2.0 unx     8383 b- defN 23-Feb-06 16:52 stemtool/dpc/__pycache__/nbed_dpc.cpython-39.pyc
--rw-r--r--  2.0 unx       26 b- defN 20-Jul-26 19:25 stemtool/eels/__init__.py
--rw-r--r--  2.0 unx    11485 b- defN 23-Feb-06 12:29 stemtool/eels/eels_tools.py
--rw-r--r--  2.0 unx      178 b- defN 23-Feb-06 16:52 stemtool/eels/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx     8309 b- defN 23-Feb-06 16:52 stemtool/eels/__pycache__/eels_tools.cpython-39.pyc
--rw-r--r--  2.0 unx       19 b- defN 20-Jul-26 19:25 stemtool/gpa/__init__.py
--rw-r--r--  2.0 unx    28390 b- defN 23-Feb-06 12:52 stemtool/gpa/gpa.py
--rw-r--r--  2.0 unx      170 b- defN 23-Feb-06 16:52 stemtool/gpa/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    23150 b- defN 23-Feb-06 16:52 stemtool/gpa/__pycache__/gpa.cpython-39.pyc
--rw-r--r--  2.0 unx       27 b- defN 20-Jul-26 19:25 stemtool/nbed/__init__.py
--rw-r--r--  2.0 unx    71865 b- defN 23-Feb-06 13:00 stemtool/nbed/nbed_strain.py
--rw-r--r--  2.0 unx      179 b- defN 23-Feb-06 16:52 stemtool/nbed/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    56075 b- defN 23-Feb-06 16:52 stemtool/nbed/__pycache__/nbed_strain.cpython-39.pyc
--rw-r--r--  2.0 unx       26 b- defN 20-Jul-26 19:25 stemtool/sim/__init__.py
--rw-r--r--  2.0 unx    16438 b- defN 21-Nov-05 20:05 stemtool/sim/multislice.py
--rw-r--r--  2.0 unx      177 b- defN 23-Feb-06 16:52 stemtool/sim/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    13512 b- defN 23-Feb-06 16:52 stemtool/sim/__pycache__/multislice.cpython-39.pyc
--rw-r--r--  2.0 unx      129 b- defN 20-Jul-26 19:25 stemtool/util/__init__.py
--rw-r--r--  2.0 unx    15999 b- defN 23-Feb-06 12:07 stemtool/util/fourier_reg.py
--rw-r--r--  2.0 unx    13446 b- defN 23-Feb-06 12:07 stemtool/util/gauss_utils.py
--rw-r--r--  2.0 unx    23884 b- defN 23-Feb-06 12:51 stemtool/util/image_utils.py
--rw-r--r--  2.0 unx    23294 b- defN 23-Feb-06 12:07 stemtool/util/pnccd.py
--rw-r--r--  2.0 unx    12916 b- defN 23-Feb-06 12:48 stemtool/util/sobel_canny.py
--rw-r--r--  2.0 unx      265 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/__init__.cpython-39.pyc
--rw-r--r--  2.0 unx    12546 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/fourier_reg.cpython-39.pyc
--rw-r--r--  2.0 unx    11835 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/gauss_utils.cpython-39.pyc
--rw-r--r--  2.0 unx    21850 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/image_utils.cpython-39.pyc
--rw-r--r--  2.0 unx    13037 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/pnccd.cpython-39.pyc
--rw-r--r--  2.0 unx    11557 b- defN 23-Feb-06 16:52 stemtool/util/__pycache__/sobel_canny.cpython-39.pyc
-60 files, 575386 bytes uncompressed, 186663 bytes compressed:  67.6%
+Zip file size: 191037 bytes, number of entries: 54
+-rw-rw-r--  2.0 unx     1548 b- defN 23-May-25 10:57 EGG-INFO/PKG-INFO
+-rw-rw-r--  2.0 unx      854 b- defN 23-May-25 10:57 EGG-INFO/SOURCES.txt
+-rw-rw-r--  2.0 unx        1 b- defN 23-May-25 10:57 EGG-INFO/dependency_links.txt
+-rw-rw-r--  2.0 unx        1 b- defN 21-Nov-15 13:48 EGG-INFO/not-zip-safe
+-rw-rw-r--  2.0 unx      164 b- defN 23-May-25 10:57 EGG-INFO/requires.txt
+-rw-rw-r--  2.0 unx        9 b- defN 23-May-25 10:57 EGG-INFO/top_level.txt
+-rw-rw-r--  2.0 unx      216 b- defN 21-Nov-15 13:48 stemtool/__init__.py
+-rw-rw-rw-  2.0 unx       26 b- defN 23-May-25 10:55 stemtool/__version__.py
+-rw-rw-r--  2.0 unx      841 b- defN 21-Nov-15 13:48 stemtool/timer.py
+-rw-rw-r--  2.0 unx      408 b- defN 23-May-25 10:57 stemtool/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx      171 b- defN 23-May-25 10:57 stemtool/__pycache__/__version__.cpython-310.pyc
+-rw-rw-r--  2.0 unx      896 b- defN 23-May-25 10:57 stemtool/__pycache__/timer.cpython-310.pyc
+-rw-rw-r--  2.0 unx       56 b- defN 21-Nov-15 13:48 stemtool/afit/__init__.py
+-rw-rw-rw-  2.0 unx    42719 b- defN 23-May-25 10:41 stemtool/afit/atom_positions.py
+-rw-rw-rw-  2.0 unx    10247 b- defN 23-May-25 10:43 stemtool/afit/drift_corr.py
+-rw-rw-r--  2.0 unx      200 b- defN 23-May-25 10:57 stemtool/afit/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    33274 b- defN 23-May-25 10:57 stemtool/afit/__pycache__/atom_positions.cpython-310.pyc
+-rw-rw-rw-  2.0 unx     9189 b- defN 23-May-25 10:57 stemtool/afit/__pycache__/drift_corr.cpython-310.pyc
+-rw-rw-r--  2.0 unx       75 b- defN 21-Nov-15 13:48 stemtool/dpc/__init__.py
+-rw-rw-rw-  2.0 unx    22908 b- defN 22-Oct-04 14:38 stemtool/dpc/atomic_dpc.py
+-rw-rw-rw-  2.0 unx     8339 b- defN 22-Oct-04 16:22 stemtool/dpc/dpc_utils.py
+-rw-rw-rw-  2.0 unx    10934 b- defN 23-May-25 10:44 stemtool/dpc/nbed_dpc.py
+-rw-rw-r--  2.0 unx      214 b- defN 23-May-25 10:57 stemtool/dpc/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    18143 b- defN 23-May-25 10:57 stemtool/dpc/__pycache__/atomic_dpc.cpython-310.pyc
+-rw-rw-rw-  2.0 unx     6678 b- defN 23-May-25 10:57 stemtool/dpc/__pycache__/dpc_utils.cpython-310.pyc
+-rw-rw-rw-  2.0 unx     8413 b- defN 23-May-25 10:57 stemtool/dpc/__pycache__/nbed_dpc.cpython-310.pyc
+-rw-rw-r--  2.0 unx       26 b- defN 21-Nov-15 13:48 stemtool/eels/__init__.py
+-rw-rw-rw-  2.0 unx    11485 b- defN 23-May-25 10:45 stemtool/eels/eels_tools.py
+-rw-rw-r--  2.0 unx      174 b- defN 23-May-25 10:57 stemtool/eels/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx     8301 b- defN 23-May-25 10:57 stemtool/eels/__pycache__/eels_tools.cpython-310.pyc
+-rw-rw-r--  2.0 unx       19 b- defN 21-Nov-15 13:48 stemtool/gpa/__init__.py
+-rw-rw-rw-  2.0 unx    28386 b- defN 23-May-25 10:46 stemtool/gpa/gpa.py
+-rw-rw-r--  2.0 unx      166 b- defN 23-May-25 10:57 stemtool/gpa/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    23146 b- defN 23-May-25 10:57 stemtool/gpa/__pycache__/gpa.cpython-310.pyc
+-rw-rw-r--  2.0 unx       27 b- defN 21-Nov-15 13:48 stemtool/nbed/__init__.py
+-rw-rw-rw-  2.0 unx    72754 b- defN 23-May-25 10:51 stemtool/nbed/nbed_strain.py
+-rw-rw-r--  2.0 unx      175 b- defN 23-May-25 10:57 stemtool/nbed/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    56808 b- defN 23-May-25 10:57 stemtool/nbed/__pycache__/nbed_strain.cpython-310.pyc
+-rw-rw-r--  2.0 unx       26 b- defN 21-Nov-15 13:48 stemtool/sim/__init__.py
+-rw-rw-rw-  2.0 unx    16435 b- defN 23-May-25 10:51 stemtool/sim/multislice.py
+-rw-rw-r--  2.0 unx      173 b- defN 23-May-25 10:57 stemtool/sim/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    13491 b- defN 23-May-25 10:57 stemtool/sim/__pycache__/multislice.cpython-310.pyc
+-rw-rw-r--  2.0 unx      129 b- defN 21-Nov-15 13:48 stemtool/util/__init__.py
+-rw-rw-rw-  2.0 unx    15999 b- defN 22-Oct-04 17:35 stemtool/util/fourier_reg.py
+-rw-rw-rw-  2.0 unx    13446 b- defN 22-Oct-04 17:35 stemtool/util/gauss_utils.py
+-rw-rw-rw-  2.0 unx    24046 b- defN 23-May-25 10:53 stemtool/util/image_utils.py
+-rw-rw-rw-  2.0 unx    23294 b- defN 22-Oct-04 17:35 stemtool/util/pnccd.py
+-rw-rw-rw-  2.0 unx    12644 b- defN 23-May-25 10:55 stemtool/util/sobel_canny.py
+-rw-rw-r--  2.0 unx      261 b- defN 23-May-25 10:57 stemtool/util/__pycache__/__init__.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    12568 b- defN 23-May-25 10:57 stemtool/util/__pycache__/fourier_reg.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    11813 b- defN 23-May-25 10:57 stemtool/util/__pycache__/gauss_utils.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    21958 b- defN 23-May-25 10:57 stemtool/util/__pycache__/image_utils.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    13032 b- defN 23-May-25 10:57 stemtool/util/__pycache__/pnccd.cpython-310.pyc
+-rw-rw-rw-  2.0 unx    11418 b- defN 23-May-25 10:57 stemtool/util/__pycache__/sobel_canny.cpython-310.pyc
+54 files, 568724 bytes uncompressed, 183055 bytes compressed:  67.8%
```

## zipnote «TEMP»/diffoscope_bbgl10qm_/tmpf8f_25tv_.zip

```diff
@@ -18,132 +18,114 @@
 
 Filename: stemtool/__init__.py
 Comment: 
 
 Filename: stemtool/__version__.py
 Comment: 
 
-Filename: stemtool/code_timer.py
-Comment: 
-
 Filename: stemtool/timer.py
 Comment: 
 
-Filename: stemtool/__pycache__/__init__.cpython-39.pyc
-Comment: 
-
-Filename: stemtool/__pycache__/__version__.cpython-39.pyc
+Filename: stemtool/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/__pycache__/code_timer.cpython-39.pyc
+Filename: stemtool/__pycache__/__version__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/__pycache__/timer.cpython-39.pyc
+Filename: stemtool/__pycache__/timer.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/afit/__init__.py
 Comment: 
 
 Filename: stemtool/afit/atom_positions.py
 Comment: 
 
 Filename: stemtool/afit/drift_corr.py
 Comment: 
 
-Filename: stemtool/afit/__pycache__/__init__.cpython-39.pyc
-Comment: 
-
-Filename: stemtool/afit/__pycache__/atom_positions.cpython-39.pyc
-Comment: 
-
-Filename: stemtool/afit/__pycache__/drift_corr.cpython-39.pyc
-Comment: 
-
-Filename: stemtool/beam/__init__.py
-Comment: 
-
-Filename: stemtool/beam/gen_probe.py
+Filename: stemtool/afit/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/beam/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/afit/__pycache__/atom_positions.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/beam/__pycache__/gen_probe.cpython-39.pyc
+Filename: stemtool/afit/__pycache__/drift_corr.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/dpc/__init__.py
 Comment: 
 
 Filename: stemtool/dpc/atomic_dpc.py
 Comment: 
 
 Filename: stemtool/dpc/dpc_utils.py
 Comment: 
 
 Filename: stemtool/dpc/nbed_dpc.py
 Comment: 
 
-Filename: stemtool/dpc/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/dpc/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/dpc/__pycache__/atomic_dpc.cpython-39.pyc
+Filename: stemtool/dpc/__pycache__/atomic_dpc.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/dpc/__pycache__/dpc_utils.cpython-39.pyc
+Filename: stemtool/dpc/__pycache__/dpc_utils.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/dpc/__pycache__/nbed_dpc.cpython-39.pyc
+Filename: stemtool/dpc/__pycache__/nbed_dpc.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/eels/__init__.py
 Comment: 
 
 Filename: stemtool/eels/eels_tools.py
 Comment: 
 
-Filename: stemtool/eels/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/eels/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/eels/__pycache__/eels_tools.cpython-39.pyc
+Filename: stemtool/eels/__pycache__/eels_tools.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/gpa/__init__.py
 Comment: 
 
 Filename: stemtool/gpa/gpa.py
 Comment: 
 
-Filename: stemtool/gpa/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/gpa/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/gpa/__pycache__/gpa.cpython-39.pyc
+Filename: stemtool/gpa/__pycache__/gpa.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/nbed/__init__.py
 Comment: 
 
 Filename: stemtool/nbed/nbed_strain.py
 Comment: 
 
-Filename: stemtool/nbed/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/nbed/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/nbed/__pycache__/nbed_strain.cpython-39.pyc
+Filename: stemtool/nbed/__pycache__/nbed_strain.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/sim/__init__.py
 Comment: 
 
 Filename: stemtool/sim/multislice.py
 Comment: 
 
-Filename: stemtool/sim/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/sim/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/sim/__pycache__/multislice.cpython-39.pyc
+Filename: stemtool/sim/__pycache__/multislice.cpython-310.pyc
 Comment: 
 
 Filename: stemtool/util/__init__.py
 Comment: 
 
 Filename: stemtool/util/fourier_reg.py
 Comment: 
@@ -156,26 +138,26 @@
 
 Filename: stemtool/util/pnccd.py
 Comment: 
 
 Filename: stemtool/util/sobel_canny.py
 Comment: 
 
-Filename: stemtool/util/__pycache__/__init__.cpython-39.pyc
+Filename: stemtool/util/__pycache__/__init__.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/util/__pycache__/fourier_reg.cpython-39.pyc
+Filename: stemtool/util/__pycache__/fourier_reg.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/util/__pycache__/gauss_utils.cpython-39.pyc
+Filename: stemtool/util/__pycache__/gauss_utils.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/util/__pycache__/image_utils.cpython-39.pyc
+Filename: stemtool/util/__pycache__/image_utils.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/util/__pycache__/pnccd.cpython-39.pyc
+Filename: stemtool/util/__pycache__/pnccd.cpython-310.pyc
 Comment: 
 
-Filename: stemtool/util/__pycache__/sobel_canny.cpython-39.pyc
+Filename: stemtool/util/__pycache__/sobel_canny.cpython-310.pyc
 Comment: 
 
 Zip file comment:
```

## EGG-INFO/PKG-INFO

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: stemtool
-Version: 2023.2.6
+Version: 2023.5.25
 Summary: A single package for analyzing atomic resolution STEM, 4D-STEM and STEM-EELS datasets, along with basic STEM simulation functionality
 Home-page: https://github.com/stemtool/stemtool
 Author: Debangshu Mukherjee
 Author-email: mukherjeed@ornl.gov
 License: MIT
 Keywords: STEM,EELS,4D-STEM,electron microscopy
 Description-Content-Type: text/markdown
```

## EGG-INFO/requires.txt

```diff
@@ -1,11 +1,10 @@
-pyfftw>=0.10.3
 pywavelets>=0.5.2
 numpy>=1.13.0
 scipy>=1.0.0
 matplotlib>=2.2.0
-pillow>=9.2.1
+pillow>=8.3.2
 scikit-image>=0.13.0
 matplotlib-scalebar>=0.5.0
 ase>=3.16.0
 h5py>=2.7.0
 dask>=2021.9.0
```

## stemtool/__version__.py

```diff
@@ -1 +1 @@
-__version__ = "2023.02.06"
+__version__ = "2023.05.25"
```

## stemtool/afit/atom_positions.py

```diff
@@ -1,18 +1,16 @@
 import skimage.feature as skfeat
 import matplotlib.pyplot as plt
 import numpy as np
 import scipy.ndimage as scnd
 import scipy.optimize as spo
 import scipy.interpolate as scinterp
+import warnings
 import matplotlib_scalebar.scalebar as mpss
 import stemtool as st
-from tqdm.auto import trange
-from typing import Any, Tuple, Union
-from nptyping import NDArray, Shape, Int, Float, Bool, Complex
 
 
 def remove_close_vals(input_arr, limit):
     result = np.copy(input_arr)
     ii = 0
     newlen = len(result)
     while ii < newlen:
@@ -107,20 +105,20 @@
     single 2D Gaussian function. The center of the Gaussian
     is returned as the refined atom position.
     """
     warnings.filterwarnings("ignore")
     no_pos = len(positions)
     dist = np.empty(no_pos, dtype=np.float)
     ccd = np.empty(no_pos, dtype=np.float)
-    for ii in trange(no_pos):
+    for ii in np.aprange(no_pos):
         ccd = np.sum(((positions[:, 0:2] - positions[ii, 0:2]) ** 2), axis=1)
         dist[ii] = (np.amin(ccd[ccd > 0])) ** 0.5
     med_dist = 0.5 * np.median(dist)
     ref_arr = np.empty((no_pos, 7), dtype=np.float)
-    for ii in trange(no_pos):
+    for ii in np.arange(no_pos):
         pos_x = positions[ii, 1]
         pos_y = positions[ii, 0]
         refined_ii = st.util.fit_gaussian2D_mask(image_data, pos_x, pos_y, med_dist)
         ref_arr[ii, 0:2] = np.flip(refined_ii[0:2])
         ref_arr[ii, 2:7] = refined_ii[2:7]
     return ref_arr
 
@@ -833,16 +831,16 @@
     for ii in np.arange(no_pos):
         ccd = np.sum(((positions[:, 0:2] - positions[ii, 0:2]) ** 2), axis=1)
         dist[ii] = (np.amin(ccd[ccd > 0])) ** 0.5
     med_dist = 0.5 * np.median(dist)
     return med_dist
 
 
+
 def refine_atoms(image_data, positions, ref_arr, med_dist):
-    warnings.filterwarnings("ignore")
     for ii in np.arange(len(positions)):
         pos_x = positions[ii, 1]
         pos_y = positions[ii, 0]
         refined_ii = st.util.fit_gaussian2D_mask(1 + image_data, pos_x, pos_y, med_dist)
         ref_arr[ii, 0:2] = np.flip(refined_ii[0:2])
         ref_arr[ii, 2:6] = refined_ii[2:6]
         ref_arr[ii, -1] = refined_ii[-1] - 1
```

## stemtool/afit/drift_corr.py

```diff
@@ -40,14 +40,15 @@
 
     References
     ----------
     [1]_, Savitzky, B.H., El Baggari, I., Clement, C.B., Waite, E., Goodge, B.H.,
           Baek, D.J., Sheckelton, J.P., Pasco, C., Nair, H., Schreiber, N.J. and
           Hoffman, J., 2018. Image registration of low signal-to-noise cryo-STEM data.
           Ultramicroscopy, 191, pp.56-65.
+
     """
     pfi.cache.enable()
     for pp in range(len(stack_pos)):
         ii = stack_pos[pp, 0]
         jj = stack_pos[pp, 1]
         row_stack[ii, jj], col_stack[ii, jj], _, _, _ = st.util.dftregistration(
             pfi.numpy_fft.fft2(image_stack[ii, :, :]),
@@ -163,14 +164,25 @@
         cross-correlated with all the other images of the stack, to generate
         a skew matrix of row shifts and column shifts, calculated with sub
         pixel precision.
         """
         pfi.cache.enable()
         rows, cols = np.mgrid[0 : self.no_im, 0 : self.no_im]
         pos_stack = np.asarray((np.ravel(rows), np.ravel(cols))).transpose()
+
+        # Initialize JIT
+        shift_stack(
+            self.image_stack,
+            self.row_stack,
+            self.col_stack,
+            pos_stack[0:10, :],
+            self.sampling,
+        )
+
+        # Run JITted function
         shift_stack(
             self.image_stack, self.row_stack, self.col_stack, pos_stack, self.sampling
         )
 
         self.max_shift = np.amax(
             np.asarray((np.amax(self.row_stack), np.amax(self.col_stack)))
         )
@@ -192,14 +204,22 @@
         mean and move each image by that amount in the stack and then
         sum them up.
         """
         if not self.stack_check:
             raise RuntimeError(
                 "Please get the images correlated first as get_shape_stack()"
             )
+        image_stack = np.copy(self.image_stack[0:3, :, :])
+        moved_stack = np.copy(self.moved_stack[0:3, :, :])
+        row_stack = np.copy(self.row_stack[0:3, 0:3])
+        col_stack = np.copy(self.col_stack[0:3, 0:3])
+        # Initialize JIT
+        stack_corr(image_stack, moved_stack, row_stack, col_stack)
+
+        # Run JITted code
         stack_corr(
             self.image_stack, self.moved_stack, self.row_stack, self.col_stack
         )
         self.corr_image = np.sum(self.moved_stack, axis=0) / self.no_im
         return self.corr_image
 
     def plot_shifts(self, imwidth=15):
```

## stemtool/dpc/nbed_dpc.py

```diff
@@ -1,13 +1,13 @@
 import scipy.ndimage as scnd
 import scipy.optimize as sio
 import numpy as np
 import warnings
 import stemtool as st
-from tqdm.auto import trange
+from tqdm.auto import tqdm, trange
 
 
 def fit_nbed_disks(corr_image, disk_size, positions, diff_spots):
     warnings.filterwarnings("ignore")
     positions = np.asarray(positions, dtype=np.float64)
     diff_spots = np.asarray(diff_spots, dtype=np.float64)
     fitted_disk_list = np.zeros_like(positions)
@@ -166,14 +166,15 @@
     point, and then a disk is calculated centered on the edge
     fitted center and then the COM inside that disk is also
     calculated.
 
     :Authors:
     Debangshu Mukherjee <mukherjeed@ornl.gov>
     """
+    warnings.filterwarnings("ignore")
 
     if np.size(ROI) < 2:
         ROI = np.ones((data4D.shape[2], data4D.shape[3]), dtype=bool)
 
     yy, xx = np.mgrid[0 : data4D.shape[2], 0 : data4D.shape[3]]
     data4D_ROI = data4D[:, :, yy[ROI], xx[ROI]]
     pp, qq = np.mgrid[0 : data4D.shape[0], 0 : data4D.shape[1]]
```

## stemtool/gpa/gpa.py

```diff
@@ -270,15 +270,15 @@
     yy = np.ravel(yy)
     xx = np.ravel(xx)
     P_mat = np.zeros((2, 2), dtype=np.float)
     e_xx = np.zeros_like(P_1)
     e_xy = np.zeros_like(P_1)
     e_yx = np.zeros_like(P_1)
     e_yy = np.zeros_like(P_1)
-    for ii in np.arange(len(yy)):
+    for ii in range(len(yy)):
         ypos = yy[ii]
         xpos = xx[ii]
         P_mat[0, 0] = P1_x[ypos, xpos]
         P_mat[0, 1] = P1_y[ypos, xpos]
         P_mat[1, 0] = P2_x[ypos, xpos]
         P_mat[1, 1] = P2_y[ypos, xpos]
         e_mat = ((1) / (2 * np.pi)) * np.matmul(a_matrix, P_mat)
```

## stemtool/nbed/nbed_strain.py

```diff
@@ -118,14 +118,43 @@
     """
     data2D = np.transpose(data4D, (2, 3, 0, 1))
     data_shape = data2D.shape
     data2D.shape = (data_shape[0] * data_shape[1], data_shape[2] * data_shape[3])
     return data2D
 
 
+def resizer1D_opt(data, res, N):
+    M = data.size
+    carry = 0
+    m = 0
+    for n in range(int(N)):
+        data_sum = carry
+        while ((m * N) - (n * M)) < M:
+            data_sum += data[m]
+            m += 1
+        carry = (m - (n + 1) * (M / N)) * data[m - 1]
+        data_sum -= carry
+        res[n] = data_sum * (N / M)
+    return res
+
+
+def resizer2D_opt(data2D, resampled_x, resampled_f, sampling):
+    data_shape = np.asarray(data2D.shape)
+    sampled_shape = (np.round(data_shape / sampling)).astype(int)
+    for yy in range(data_shape[0]):
+        resampled_x[yy, :] = resizer1D_opt(
+            data2D[yy, :], resampled_x[yy, :], sampled_shape[1]
+        )
+    for xx in range(sampled_shape[1]):
+        resampled_f[:, xx] = resizer1D_opt(
+            resampled_x[:, xx], resampled_f[:, xx], sampled_shape[0]
+        )
+    return resampled_f
+
+
 def resizer1D(data, N):
     M = data.size
     carry = 0
     m = 0
     res = np.zeros(int(N))
     for n in range(int(N)):
         data_sum = carry
@@ -192,15 +221,17 @@
     datashape = np.asarray(data4D_flat.shape)
     res_shape = np.copy(datashape)
     res_shape[0:2] = np.round(datashape[0:2] / bin_factor)
     data4D_res = np.zeros(res_shape.astype(int), dtype=data4D_flat.dtype)
     resampled_x = np.zeros((datashape[0], res_shape[1]), data4D_flat.dtype)
     resampled_f = np.zeros(res_shape[0:2], dtype=data4D_flat.dtype)
     for zz in range(data4D_flat.shape[-1]):
-        data4D_res[:, :, zz] = resizer2D(data4D_flat[:, :, zz], resampled_x, resampled_f, bin_factor)
+        data4D_res[:, :, zz] = resizer2D_opt(
+            data4D_flat[:, :, zz], resampled_x, resampled_f, bin_factor
+        )
     binned_data = np.reshape(
         data4D_res,
         (resampled_f.shape[0], resampled_f.shape[1], data4D.shape[2], data4D.shape[3]),
     )
     return binned_data
```

## stemtool/sim/multislice.py

```diff
@@ -271,15 +271,15 @@
     sspot_im = PIL.Image.fromarray(sspot)
     potential = np.array(sspot_im.resize(finalsize, resample=PIL.Image.LANCZOS))
     return potential
 
 
 def find_uc_pos(atom_pos, cell_dim):
     uc_pos = np.zeros_like(atom_pos)
-    for ii in numba.prange(len(uc_pos)):
+    for ii in np.arange(len(uc_pos)):
         for jj in range(len(cell_dim)):
             cc = atom_pos[ii, :] / cell_dim[jj, :]
             cc[cc < 0] += 1
             cc[cc == np.inf] = 0
             cc[cc > 0.001]
             uc_pos[ii, jj] = cc[jj]
     uc_nonzero = uc_pos != 0
```

## stemtool/util/image_utils.py

```diff
@@ -1,16 +1,15 @@
 import numpy as np
 import matplotlib as mpl
 import mpl_toolkits.axes_grid1 as mplax
 import matplotlib.colors as mplc
 import matplotlib.cm as mplcm
-import scipy.misc as scm
+import warnings
 import scipy.optimize as spo
 import scipy.ndimage as scnd
-import scipy.signal as scsig
 import skimage.color as skc
 import stemtool as st
 
 
 def move_by_phase(image_to_move, x_pixels, y_pixels):
     """
     Move Images with sub-pixel precision
@@ -473,14 +472,15 @@
     the X direction of the ronchigram. This
     corrects for that.
 
     :Authors:
     Debangshu Mukherjee <mukherjeed@ornl.gov>
 
     """
+    warnings.filterwarnings("ignore")
     datasize = (np.asarray(data4D.shape)).astype(int)
     flipped4D = np.zeros((datasize[0], datasize[1], datasize[2], datasize[3]))
     for jj in range(datasize[3]):
         for ii in range(datasize[2]):
             ronchi = data4D[:, :, ii, jj]
             ronchi_flip = np.fliplr(ronchi)
             flipped4D[:, :, ii, jj] = ronchi_flip
@@ -554,18 +554,22 @@
           New size of array
 
     Returns
     -------
     res: ndarray of shape N
          Data resampled
 
+    Notes
+    -----
+    The data is resampled. 
 
     :Authors:
     Debangshu Mukherjee <mukherjeed@ornl.gov>
     """
+    warnings.filterwarnings("ignore")
     M = data.size
     data = (data).astype(np.float64)
     res = np.zeros(int(N), dtype=np.float64)
     carry = 0
     m = 0
     for n in range(int(N)):
         data_sum = carry
@@ -602,14 +606,15 @@
     See Also
     --------
     resizer
 
     :Authors:
     Debangshu Mukherjee <mukherjeed@ornl.gov>
     """
+    warnings.filterwarnings("ignore")
     sampling = np.asarray(sampling)
     data_shape = np.asarray(np.shape(data))
     sampled_shape = (np.round(data_shape / sampling)).astype(int)
     resampled_x = np.zeros((data_shape[0], sampled_shape[1]), data.dtype)
     resampled_f = np.zeros(sampled_shape, dtype=data.dtype)
     for yy in range(int(data_shape[0])):
         resampled_x[yy, :] = st.util.resizer(data[yy, :], sampled_shape[1])
@@ -638,14 +643,15 @@
     --------
     resizer
     resizer2D
 
     :Authors:
     Debangshu Mukherjee <mukherjeed@ornl.gov>
     """
+    warnings.filterwarnings("ignore")
     data_shape = np.asarray(np.shape(data_orig))
     resampled_x = np.zeros((data_shape[0], new_shape[1]), dtype=data_orig.dtype)
     resampled_f = np.zeros(new_shape, dtype=data_orig.dtype)
     for yy in range(int(data_shape[0])):
         resampled_x[yy, :] = st.util.resizer(data_orig[yy, :], new_shape[1])
     for xx in range(int(new_shape[1])):
         resampled_f[:, xx] = st.util.resizer(resampled_x[:, xx], new_shape[0])
```

## stemtool/util/sobel_canny.py

```diff
@@ -1,14 +1,12 @@
 import numpy as np
-import warnings
 import scipy.signal as scisig
 import scipy.ndimage as scnd
 import stemtool as st
 import matplotlib.pyplot as plt
-import math
 
 
 def sobel(im, order=3):
     """
     Sobel Filter an Input Image
 
     Parameters
@@ -131,18 +129,16 @@
 
     Rvalues = np.sqrt(((xValues - xCenter) ** 2) + ((yValues - yCenter) ** 2))
     radius = np.mean(Rvalues)
 
     return xCenter, yCenter, radius
 
 
-def edge_thinner(pos, mag, ang):
+def thinner(pos, edge, mag, ang):
     """
-    Function for thinning Sobel
-    Filtered Edges
 
     Parameters
     ----------
     pos:  ndarray
           List of pixel positions
     edge: ndarray
           Thinned Edge
@@ -154,15 +150,14 @@
     Notes
     -----
     We use the direction of the Sobel gradient to
     determine whether a pixel belongs to the edge
     or not. If the gradient is perpendicular to the
     pixels then it is an edge pixel or else it is not.
     """
-    thinned_edge = np.zeros_like(mag)
     for pp in np.arange(len(pos)):
         ii = pos[pp, 0]
         jj = pos[pp, 1]
         q = 1
         r = 1
         if (0 <= ang[ii, jj] < 22.5) or (157.5 <= ang[ii, jj] <= 180):
             q = mag[ii, jj + 1]
@@ -174,22 +169,23 @@
             q = mag[ii + 1, jj]
             r = mag[ii - 1, jj]
         elif 112.5 <= ang[ii, jj] < 157.5:
             q = mag[ii - 1, jj - 1]
             r = mag[ii + 1, jj + 1]
 
         if (mag[ii, jj] >= q) and (mag[ii, jj] >= r):
-            thinned_edge[ii, jj] = mag[ii, jj]
+            edge[ii, jj] = mag[ii, jj]
         else:
-            thinned_edge[ii, jj] = 0
-    return thinned_edge
+            edge[ii, jj] = 0
 
 
-def edge_joiner(pos, thinned_edge, upper, lower):
+def joiner(pos, edge, upper, lower):
     """
+    Joining of Edges
+
     Parameters
     ----------
     pos:   ndarray
            List of pixel positions
     edge:  ndarray
            Thinned Edge, that will be joined
     upper: float
@@ -202,33 +198,31 @@
     The input image now consists of strong and weak
     thresholds. The final step of the algorithm is to
     look at some of the measured edges and join/link them.
     The idea is that if a edge pixel is classified as a
     weak edge but one of its neighbors is a strong edge then
     it is a strong edge pixel.
     """
-    joined_edge = np.copy(thinned_edge)
     for pp in np.arange(len(pos)):
         ii = pos[pp, 0]
         jj = pos[pp, 1]
-        if joined_edge[ii, jj] == lower:
+        if edge[ii, jj] == lower:
             if (
-                (joined_edge[ii - 1, jj - 1] == upper)  # top left
-                or (joined_edge[ii - 1, jj] == upper)  # top
-                or (joined_edge[ii - 1, jj + 1] == upper)  # top right
-                or (joined_edge[ii, jj - 1] == upper)  # left
-                or (joined_edge[ii, jj + 1] == upper)  # right
-                or (joined_edge[ii + 1, jj - 1] == upper)  # bottom left
-                or (joined_edge[ii + 1, jj] == upper)  # bottom
-                or (joined_edge[ii + 1, jj + 1] == upper)
+                (edge[ii - 1, jj - 1] == upper)  # top left
+                or (edge[ii - 1, jj] == upper)  # top
+                or (edge[ii - 1, jj + 1] == upper)  # top right
+                or (edge[ii, jj - 1] == upper)  # left
+                or (edge[ii, jj + 1] == upper)  # right
+                or (edge[ii + 1, jj - 1] == upper)  # bottom left
+                or (edge[ii + 1, jj] == upper)  # bottom
+                or (edge[ii + 1, jj + 1] == upper)
             ):  # bottom right
-                joined_edge[ii, jj] = upper
+                edge[ii, jj] = upper
             else:
-                joined_edge[ii, jj] = 0
-    return joined_edge
+                edge[ii, jj] = 0
 
 
 class Canny(object):
     """
     Canny Edge Detection
 
     Parameters
@@ -285,14 +279,15 @@
         self.image = image
         self.im_size = (np.asarray(image.shape)).astype(int)
         self.thresh_lower = lowThreshold
         self.thresh_upper = highThreshold
         self.imblur = st.util.image_normalizer(scnd.gaussian_filter(image, blurVal))
         self.sobel_mag = np.empty_like(image)
         self.sobel_ang = np.empty_like(image)
+        self.thin_edge = np.empty_like(image)
         self.residual = np.empty_like(image)
         self.cannyEdge = np.empty_like(image)
         self.edge_check = False
         self.thresh_check = False
         self.plot_steps = plot_steps
 
     def edge_thinning(self):
@@ -301,23 +296,22 @@
 
         Notes
         -----
         We use the direction of the Sobel gradient to
         determine whether a pixel belongs to the edge
         or not. If the gradient is perpendicular to the
         pixels then it is an edge pixel or else it is not.
-
         """
         self.sobel_mag, self.sobel_ang = st.util.sobel(self.imblur, order=5)
         self.sobel_ang = self.sobel_ang * (180 / np.pi)
         self.sobel_ang[self.sobel_ang < 0] += 180
         yRange, xRange = np.mgrid[1 : self.im_size[0] - 1, 1 : self.im_size[1] - 1]
         thin_pos = np.asarray((np.ravel(yRange), np.ravel(xRange))).transpose()
-
-        self.thin_edge = edge_thinner(thin_pos, self.sobel_mag, self.sobel_ang)
+        thin_edge = np.copy(self.thin_edge)
+        thinner(thin_pos, self.thin_edge, self.sobel_mag, self.sobel_ang)
         if self.plot_steps:
             plt.figure(figsize=(20, 10))
             plt.subplot(1, 2, 1)
             plt.imshow(self.sobel_mag)
             plt.axis("off")
             plt.subplot(1, 2, 2)
             plt.imshow(self.thin_edge)
@@ -333,15 +327,15 @@
         Sort edges measured as either strong edges or weak edges,
         depending on the intensity of the edge. The thresholds are
         user defined parameters and while they can be played around
         with it is recommended to use a thresholding algorithm like
         Otsu thresholding to robustly determine edges.
         """
         if not self.edge_check:
-            raise RuntimeError("Please thin the edges first by calling edge_thinning()")
+            raise RuntimeError("Please thin the edges first by calling edge_thinner()")
         highT = np.amax(self.thin_edge) * self.thresh_upper
         lowT = highT * self.thresh_lower
         self.residual[np.where(self.thin_edge > highT)] = highT
         self.residual[
             np.where((self.thin_edge <= highT) & (self.thin_edge > lowT))
         ] = lowT
         self.residual[self.residual > self.thresh_upper] = self.thresh_upper
@@ -372,18 +366,18 @@
         """
         if not self.thresh_check:
             raise RuntimeError(
                 "Please threshold the edges first by calling canny_threshold()"
             )
         yRange, xRange = np.mgrid[1 : self.im_size[0] - 1, 1 : self.im_size[1] - 1]
         edge_pos = np.asarray((np.ravel(yRange), np.ravel(xRange))).transpose()
+        cannyEdge = np.copy(self.residual)
         self.cannyEdge = np.copy(self.residual)
 
-        # run edge_joiner on full dataset, twice
-        self.cannyEdge = st.util.edge_joiner(edge_pos, self.cannyEdge, self.thresh_upper, self.thresh_lower)
-        self.cannyEdge = st.util.edge_joiner(edge_pos, self.cannyEdge, self.thresh_upper, self.thresh_lower)
+        joiner(edge_pos, self.cannyEdge, self.thresh_upper, self.thresh_lower)
+        joiner(edge_pos, self.cannyEdge, self.thresh_upper, self.thresh_lower)
         if self.plot_steps:
             plt.figure(figsize=(10, 10))
             plt.imshow(self.cannyEdge)
             plt.axis("off")
         self.cannyEdge = (self.cannyEdge / np.amax(self.cannyEdge)).astype(bool)
         return self.cannyEdge
```

## Comparing `stemtool/afit/__pycache__/atom_positions.cpython-39.pyc` & `stemtool/afit/__pycache__/atom_positions.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:29:16 2023 UTC, .py size: 42862 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 9% similar despite different names*

```diff
@@ -1,2094 +1,2080 @@
-00000000: 610d 0d0a 0000 0000 ec38 e163 6ea7 0000  a........8.cn...
+00000000: 6f0d 0d0a 0000 0000 ac73 6f64 dfa6 0000  o........sod....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 4001 0000 6400  .....@...s@...d.
+00000020: 0004 0000 0040 0000 0073 1801 0000 6400  .....@...s....d.
 00000030: 6401 6c00 6d01 5a02 0100 6400 6401 6c03  d.l.m.Z...d.d.l.
 00000040: 6d04 5a05 0100 6400 6401 6c06 5a07 6400  m.Z...d.d.l.Z.d.
 00000050: 6401 6c08 6d09 5a0a 0100 6400 6401 6c0b  d.l.m.Z...d.d.l.
 00000060: 6d0c 5a0d 0100 6400 6401 6c0e 6d0f 5a10  m.Z...d.d.l.m.Z.
-00000070: 0100 6400 6401 6c11 6d12 5a13 0100 6400  ..d.d.l.m.Z...d.
-00000080: 6401 6c14 5a15 6400 6402 6c16 6d17 5a17  d.l.Z.d.d.l.m.Z.
-00000090: 0100 6400 6403 6c18 6d19 5a19 6d1a 5a1a  ..d.d.l.m.Z.m.Z.
-000000a0: 6d1b 5a1b 0100 6400 6404 6c1c 6d1d 5a1d  m.Z...d.d.l.m.Z.
-000000b0: 6d1e 5a1e 6d1f 5a1f 6d20 5a20 6d21 5a21  m.Z.m.Z.m Z m!Z!
-000000c0: 6d22 5a22 0100 6405 6406 8400 5a23 6433  m"Z"..d.d...Z#d3
-000000d0: 640a 640b 8401 5a24 640c 640d 8400 5a25  d.d...Z$d.d...Z%
-000000e0: 6434 6412 6413 8401 5a26 6435 6415 6416  d4d.d...Z&d5d.d.
-000000f0: 8401 5a27 6436 6418 6419 8401 5a28 641a  ..Z'd6d.d...Z(d.
-00000100: 641b 8400 5a29 641c 641d 8400 5a2a 641e  d...Z)d.d...Z*d.
-00000110: 641f 8400 5a2b 6420 6421 8400 5a2c 6422  d...Z+d d!..Z,d"
-00000120: 6423 8400 5a2d 6437 6424 6425 8401 5a2e  d#..Z-d7d$d%..Z.
-00000130: 6426 6427 8400 5a2f 6428 6429 8400 5a30  d&d'..Z/d(d)..Z0
-00000140: 6438 642c 642d 8401 5a31 642e 642f 8400  d8d,d-..Z1d.d/..
-00000150: 5a32 6430 640d 8400 5a25 4700 6431 6432  Z2d0d...Z%G.d1d2
-00000160: 8400 6432 6533 8303 5a34 6401 5300 2939  ..d2e3..Z4d.S.)9
-00000170: e900 0000 004e 2901 da06 7472 616e 6765  .....N)...trange
-00000180: 2903 da03 416e 79da 0554 7570 6c65 da05  )...Any..Tuple..
-00000190: 556e 696f 6e29 06da 074e 4441 7272 6179  Union)...NDArray
-000001a0: da05 5368 6170 65da 0349 6e74 da05 466c  ..Shape..Int..Fl
-000001b0: 6f61 74da 0442 6f6f 6cda 0743 6f6d 706c  oat..Bool..Compl
-000001c0: 6578 6302 0000 0000 0000 0000 0000 0007  exc.............
-000001d0: 0000 0006 0000 0043 0000 0073 9000 0000  .......C...s....
-000001e0: 7400 a001 7c00 a101 7d02 6401 7d03 7402  t...|...}.d.}.t.
-000001f0: 7c02 8301 7d04 7c03 7c04 6b00 728c 7400  |...}.|.|.k.r.t.
-00000200: 6a03 7c02 6400 6400 8502 6401 6402 8502  j.|.d.d...d.d...
-00000210: 6602 1900 7c02 7c03 6401 6402 8502 6602  f...|.|.d.d...f.
-00000220: 1900 1800 6402 1300 6403 6404 8d02 6405  ....d...d.d...d.
-00000230: 1300 7d05 7c05 7c01 6b04 7d06 6406 7c06  ..}.|.|.k.}.d.|.
-00000240: 7c03 3c00 7400 a001 7c02 7c06 6400 6400  |.<.t...|.|.d.d.
-00000250: 8502 6602 1900 a101 7d02 7c03 6403 1700  ..f.....}.|.d...
-00000260: 7d03 7402 7c02 8301 7d04 7116 7c02 5300  }.t.|...}.q.|.S.
-00000270: 2907 4e72 0100 0000 e902 0000 00e9 0100  ).Nr............
-00000280: 0000 a901 da04 6178 6973 e700 0000 0000  ......axis......
-00000290: 00e0 3f54 2904 da02 6e70 da04 636f 7079  ..?T)...np..copy
-000002a0: da03 6c65 6eda 0373 756d 2907 5a09 696e  ..len..sum).Z.in
-000002b0: 7075 745f 6172 72da 056c 696d 6974 da06  put_arr..limit..
-000002c0: 7265 7375 6c74 da02 6969 5a06 6e65 776c  result..iiZ.newl
-000002d0: 656e da04 6469 7374 5a08 6469 7374 626f  en..distZ.distbo
-000002e0: 6f6c a900 7219 0000 00fa 4262 7569 6c64  ol..r.....Bbuild
-000002f0: 2f62 6469 7374 2e6d 6163 6f73 782d 3130  /bdist.macosx-10
-00000300: 2e39 2d78 3836 5f36 342f 6567 672f 7374  .9-x86_64/egg/st
-00000310: 656d 746f 6f6c 2f61 6669 742f 6174 6f6d  emtool/afit/atom
-00000320: 5f70 6f73 6974 696f 6e73 2e70 79da 1172  _positions.py..r
-00000330: 656d 6f76 655f 636c 6f73 655f 7661 6c73  emove_close_vals
-00000340: 0e00 0000 7316 0000 0000 010a 0104 0108  ....s...........
-00000350: 0108 0136 0108 0108 0116 0108 010a 0172  ...6...........r
-00000360: 1b00 0000 e90a 0000 00e7 9a99 9999 9999  ................
-00000370: b93f a902 e914 0000 0072 1f00 0000 6304  .?.......r....c.
-00000380: 0000 0000 0000 0000 0000 000a 0000 0009  ................
-00000390: 0000 0043 0000 0073 fa00 0000 7c00 7400  ...C...s....|.t.
-000003a0: a001 7c00 a101 1800 7400 a002 7c00 a101  ..|.....t...|...
-000003b0: 7400 a001 7c00 a101 1800 1b00 7d00 7400  t...|.......}.t.
-000003c0: 6a03 7c00 7c02 6b04 7400 6a04 6401 8d02  j.|.|.k.t.j.d...
-000003d0: 7d04 7c00 7c04 1400 7c02 1800 7d05 6402  }.|.|...|...}.d.
-000003e0: 7c05 7c05 6402 6b00 3c00 7c05 6403 7c02  |.|.d.k.<.|.d.|.
-000003f0: 1800 1b00 7d05 7405 6a06 7c05 7407 7c01  ....}.t.j.|.t.|.
-00000400: 6404 1b00 8301 6405 6406 8d03 7d06 7408  d.....d.d...}.t.
-00000410: 6a09 a00a 7c06 a101 6402 1900 7d07 7408  j...|...d...}.t.
-00000420: 6a09 a00b 7c06 7c07 740c 6403 7400 a00d  j...|.|.t.d.t...
-00000430: 7c07 a101 6403 1700 8302 a103 7d08 7400  |...d.......}.t.
-00000440: a003 7c08 a101 7d09 740e 7c09 7c01 8302  ..|...}.t.|.|...
-00000450: 7d09 740f 6a10 7c03 6407 8d01 0100 740f  }.t.j.|.d.....t.
-00000460: a011 7c00 a101 0100 740f 6a12 7c09 6408  ..|.....t.j.|.d.
-00000470: 6408 8502 6403 6602 1900 7c09 6408 6408  d...d.f...|.d.d.
-00000480: 8502 6402 6602 1900 6409 640a 640b 8d04  ..d.f...d.d.d...
-00000490: 0100 7c09 5300 290c 61fd 0300 000a 2020  ..|.S.).a.....  
-000004a0: 2020 4669 6e64 2061 746f 6d20 6d61 7869    Find atom maxi
-000004b0: 6d61 2070 6978 656c 7320 696e 2069 6d61  ma pixels in ima
-000004c0: 6765 730a 0a20 2020 2050 6172 616d 6574  ges..    Paramet
-000004d0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-000004e0: 2d2d 0a20 2020 2064 6174 615f 696d 6167  --.    data_imag
-000004f0: 653a 206e 6461 7272 6179 0a20 2020 2020  e: ndarray.     
-00000500: 2020 2020 2020 2020 2020 204f 7269 6769             Origi
-00000510: 6e61 6c20 6174 6f6d 6963 2072 6573 6f6c  nal atomic resol
-00000520: 7574 696f 6e20 696d 6167 650a 2020 2020  ution image.    
-00000530: 6469 7374 3a20 2020 2020 2020 696e 740a  dist:       int.
-00000540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000550: 4176 6572 6167 6520 6469 7374 616e 6365  Average distance
-00000560: 2062 6574 7765 656e 206e 6569 6768 626f   between neighbo
-00000570: 7269 6e67 2070 6561 6b73 0a20 2020 2020  ring peaks.     
-00000580: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00000590: 6c74 2069 7320 3130 0a20 2020 2074 6872  lt is 10.    thr
-000005a0: 6573 683a 2020 2020 2066 6c6f 6174 0a20  esh:     float. 
-000005b0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-000005c0: 6865 2063 7574 6f66 6620 696e 7465 6e73  he cutoff intens
-000005d0: 6974 7920 7661 6c75 6520 6265 6c6f 7720  ity value below 
-000005e0: 7768 6963 6820 6120 7065 616b 0a20 2020  which a peak.   
-000005f0: 2020 2020 2020 2020 2020 2020 2077 696c               wil
-00000600: 6c20 6e6f 7420 6265 2064 6574 6563 7465  l not be detecte
-00000610: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00000620: 2020 4465 6661 756c 7420 6973 2030 2e31    Default is 0.1
-00000630: 0a20 2020 2069 6d73 697a 653a 2020 2020  .    imsize:    
-00000640: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000650: 2020 2020 2020 2020 2053 697a 6520 6f66           Size of
-00000660: 2074 6865 2064 6973 706c 6179 2069 6d61   the display ima
-00000670: 6765 0a20 2020 2020 2020 2020 2020 2020  ge.             
-00000680: 2020 2044 6566 6175 6c74 2069 7320 2832     Default is (2
-00000690: 302c 3230 290a 0a20 2020 2052 6574 7572  0,20)..    Retur
-000006a0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-000006b0: 2020 2070 6561 6b73 3a20 6e64 6172 7261     peaks: ndarra
-000006c0: 790a 2020 2020 2020 2020 2020 204c 6973  y.           Lis
-000006d0: 7420 6f66 2070 6561 6b20 706f 7369 7469  t of peak positi
-000006e0: 6f6e 7320 6173 2079 2c20 780a 0a20 2020  ons as y, x..   
-000006f0: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00000700: 0a20 2020 2054 6869 7320 6973 2061 2077  .    This is a w
-00000710: 7261 7070 6572 2061 726f 756e 6420 7468  rapper around th
-00000720: 6520 736b 696d 6167 6520 7065 616b 2066  e skimage peak f
-00000730: 696e 6469 6e67 0a20 2020 206d 6f64 756c  inding.    modul
-00000740: 6520 7768 6963 6820 6669 6e64 7320 7468  e which finds th
-00000750: 6520 7065 616b 7320 7769 7468 2061 2067  e peaks with a g
-00000760: 6976 656e 2074 6872 6573 686f 6c64 0a20  iven threshold. 
-00000770: 2020 2076 616c 7565 2061 6e64 2061 6e20     value and an 
-00000780: 696e 7465 722d 7065 616b 2073 6570 6172  inter-peak separ
-00000790: 6174 696f 6e2e 2054 6865 2066 756e 6374  ation. The funct
-000007a0: 696f 6e0a 2020 2020 6164 6469 7469 6f6e  ion.    addition
-000007b0: 616c 6c79 2070 6c6f 7473 2074 6865 2070  ally plots the p
-000007c0: 6561 6b20 706f 7369 7469 6f6e 7320 6f6e  eak positions on
-000007d0: 2074 6865 206f 7269 6769 6e61 6c0a 2020   the original.  
-000007e0: 2020 696d 6167 6520 7468 7573 2075 7365    image thus use
-000007f0: 7273 2063 616e 206d 6f64 6966 7920 7468  rs can modify th
-00000800: 6520 696e 7075 7420 7661 6c75 6573 206f  e input values o
-00000810: 660a 2020 2020 7468 7265 7368 6f6c 6420  f.    threshold 
-00000820: 616e 6420 6469 7374 616e 6365 2074 6f20  and distance to 
-00000830: 656e 7375 7265 2074 6865 2072 6967 6874  ensure the right
-00000840: 2070 6561 6b73 2061 7265 0a20 2020 2073   peaks are.    s
-00000850: 656c 6563 7465 642e 0a0a 2020 2020 3a41  elected...    :A
-00000860: 7574 686f 7273 3a0a 2020 2020 4465 6261  uthors:.    Deba
-00000870: 6e67 7368 7520 4d75 6b68 6572 6a65 6520  ngshu Mukherjee 
-00000880: 3c6d 756b 6865 726a 6565 6440 6f72 6e6c  <mukherjeed@ornl
-00000890: 2e67 6f76 3e0a 2020 2020 a901 5a05 6474  .gov>.    ..Z.dt
-000008a0: 7970 6572 0100 0000 720d 0000 00e9 0300  yper....r.......
-000008b0: 0000 46a9 025a 0c6d 696e 5f64 6973 7461  ..F..Z.min_dista
-000008c0: 6e63 65da 0769 6e64 6963 6573 a901 5a07  nce..indices..Z.
-000008d0: 6669 6773 697a 654e da01 62e9 0f00 0000  figsizeN..b.....
-000008e0: a902 da01 63da 0173 2913 7211 0000 00da  ....c..s).r.....
-000008f0: 0461 6d69 6eda 0461 6d61 78da 0561 7272  .amin..amax..arr
-00000900: 6179 da05 666c 6f61 74da 0673 6b66 6561  ay..float..skfea
-00000910: 74da 0e70 6561 6b5f 6c6f 6361 6c5f 6d61  t..peak_local_ma
-00000920: 78da 0369 6e74 da04 7363 6e64 da0c 6d65  x..int..scnd..me
-00000930: 6173 7572 656d 656e 7473 da05 6c61 6265  asurements..labe
-00000940: 6cda 0e63 656e 7465 725f 6f66 5f6d 6173  l..center_of_mas
-00000950: 73da 0572 616e 6765 da03 6d61 7872 1b00  s..range..maxr..
-00000960: 0000 da03 706c 74da 0666 6967 7572 65da  ....plt..figure.
-00000970: 0669 6d73 686f 77da 0773 6361 7474 6572  .imshow..scatter
-00000980: 290a 5a0a 6461 7461 5f69 6d61 6765 7218  ).Z.data_imager.
-00000990: 0000 00da 0674 6872 6573 68da 0669 6d73  .....thresh..ims
-000009a0: 697a 655a 0a74 6872 6573 685f 6172 72da  izeZ.thresh_arr.
-000009b0: 0b64 6174 615f 7468 7265 7368 da0a 6461  .data_thresh..da
-000009c0: 7461 5f70 6561 6b73 da0b 7065 616b 5f6c  ta_peaks..peak_l
-000009d0: 6162 656c 73da 0c6d 6572 6765 645f 7065  abels..merged_pe
-000009e0: 616b 73da 0570 6561 6b73 7219 0000 0072  aks..peaksr....r
-000009f0: 1900 0000 721a 0000 00da 0970 6561 6b73  ....r......peaks
-00000a00: 5f76 6973 1c00 0000 7328 0000 0000 250c  _vis....s(....%.
-00000a10: 0112 ff04 0314 010c 010c 010c 0104 010e  ................
-00000a20: ff06 0310 0106 0116 ff04 030a 010a 010c  ................
-00000a30: 010a 012a 0172 4200 0000 6302 0000 0000  ...*.rB...c.....
-00000a40: 0000 0000 0000 000b 0000 0007 0000 0043  ...............C
-00000a50: 0000 0073 2001 0000 7400 a001 6401 a101  ...s ...t...d...
-00000a60: 0100 7402 7c01 8301 7d02 7403 6a04 7c02  ..t.|...}.t.j.|.
-00000a70: 7403 6a05 6402 8d02 7d03 7403 6a04 7c02  t.j.d...}.t.j.|.
-00000a80: 7403 6a05 6402 8d02 7d04 7406 7c02 8301  t.j.d...}.t.|...
-00000a90: 4400 5d50 7d05 7403 6a07 7c01 6403 6403  D.]P}.t.j.|.d.d.
-00000aa0: 8502 6404 6405 8502 6602 1900 7c01 7c05  ..d.d...f...|.|.
-00000ab0: 6404 6405 8502 6602 1900 1800 6405 1300  d.d...f.....d...
-00000ac0: 6406 6407 8d02 7d04 7403 a008 7c04 7c04  d.d...}.t...|.|.
-00000ad0: 6404 6b04 1900 a101 6408 1300 7c03 7c05  d.k.....d...|.|.
-00000ae0: 3c00 713a 6408 7403 a009 7c03 a101 1400  <.q:d.t...|.....
-00000af0: 7d06 7403 6a04 7c02 6409 6602 7403 6a05  }.t.j.|.d.f.t.j.
-00000b00: 6402 8d02 7d07 7406 7c02 8301 4400 5d64  d...}.t.|...D.]d
-00000b10: 7d05 7c01 7c05 6406 6602 1900 7d08 7c01  }.|.|.d.f...}.|.
-00000b20: 7c05 6404 6602 1900 7d09 740a 6a0b a00c  |.d.f...}.t.j...
-00000b30: 7c00 7c08 7c09 7c06 a104 7d0a 7403 a00d  |.|.|.|...}.t...
-00000b40: 7c0a 6404 6405 8502 1900 a101 7c07 7c05  |.d.d.......|.|.
-00000b50: 6404 6405 8502 6602 3c00 7c0a 6405 6409  d.d...f.<.|.d.d.
-00000b60: 8502 1900 7c07 7c05 6405 6409 8502 6602  ....|.|.d.d...f.
-00000b70: 3c00 71b6 7c07 5300 290a 612a 0200 000a  <.q.|.S.).a*....
-00000b80: 2020 2020 5369 6e67 6c65 2047 6175 7373      Single Gauss
-00000b90: 6961 6e20 5065 616b 2041 746f 6d20 5265  ian Peak Atom Re
-00000ba0: 6669 6e65 6d65 6e74 0a0a 2020 2020 5061  finement..    Pa
-00000bb0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00000bc0: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
-00000bd0: 655f 6461 7461 3a20 6e64 6172 7261 790a  e_data: ndarray.
-00000be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000bf0: 4f72 6967 696e 616c 2061 746f 6d69 6320  Original atomic 
-00000c00: 7265 736f 6c75 7469 6f6e 2069 6d61 6765  resolution image
-00000c10: 0a20 2020 2070 6f73 6974 696f 6e73 3a20  .    positions: 
-00000c20: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000c30: 2020 2020 2020 2020 2049 6e74 656e 7369           Intensi
-00000c40: 7479 206d 696e 696d 612f 6d61 7869 6d61  ty minima/maxima
-00000c50: 206c 6973 740a 0a20 2020 2052 6574 7572   list..    Retur
-00000c60: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-00000c70: 2020 2072 6566 5f61 7272 3a20 6e64 6172     ref_arr: ndar
-00000c80: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00000c90: 204c 6973 7420 6f66 2072 6566 696e 6564   List of refined
-00000ca0: 2070 6561 6b20 706f 7369 7469 6f6e 7320   peak positions 
-00000cb0: 6173 2079 2c20 780a 0a20 2020 204e 6f74  as y, x..    Not
-00000cc0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-00000cd0: 2054 6869 7320 6973 2074 6865 2073 696e   This is the sin
-00000ce0: 676c 6520 4761 7573 7369 616e 2070 6561  gle Gaussian pea
-00000cf0: 6b20 6669 7474 696e 6720 7465 6368 6e69  k fitting techni
-00000d00: 7175 650a 2020 2020 7768 6572 6520 7468  que.    where th
-00000d10: 6520 696e 6974 6961 6c20 6174 6f6d 2070  e initial atom p
-00000d20: 6f73 6974 696f 6e73 2061 7265 2066 6974  ositions are fit
-00000d30: 7465 6420 7769 7468 2061 0a20 2020 2073  ted with a.    s
-00000d40: 696e 676c 6520 3244 2047 6175 7373 6961  ingle 2D Gaussia
-00000d50: 6e20 6675 6e63 7469 6f6e 2e20 5468 6520  n function. The 
-00000d60: 6365 6e74 6572 206f 6620 7468 6520 4761  center of the Ga
-00000d70: 7573 7369 616e 0a20 2020 2069 7320 7265  ussian.    is re
-00000d80: 7475 726e 6564 2061 7320 7468 6520 7265  turned as the re
-00000d90: 6669 6e65 6420 6174 6f6d 2070 6f73 6974  fined atom posit
-00000da0: 696f 6e2e 0a20 2020 20da 0669 676e 6f72  ion..    ..ignor
-00000db0: 6572 2000 0000 4e72 0100 0000 720c 0000  er ...Nr....r...
-00000dc0: 0072 0d00 0000 720e 0000 0072 1000 0000  .r....r....r....
-00000dd0: e907 0000 0029 0eda 0877 6172 6e69 6e67  .....)...warning
-00000de0: 73da 0e66 696c 7465 7277 6172 6e69 6e67  s..filterwarning
-00000df0: 7372 1300 0000 7211 0000 00da 0565 6d70  sr....r......emp
-00000e00: 7479 722d 0000 0072 0200 0000 7214 0000  tyr-...r....r...
-00000e10: 0072 2a00 0000 da06 6d65 6469 616e da02  .r*.....median..
-00000e20: 7374 da04 7574 696c da13 6669 745f 6761  st..util..fit_ga
-00000e30: 7573 7369 616e 3244 5f6d 6173 6bda 0466  ussian2D_mask..f
-00000e40: 6c69 7029 0bda 0a69 6d61 6765 5f64 6174  lip)...image_dat
-00000e50: 61da 0970 6f73 6974 696f 6e73 da06 6e6f  a..positions..no
-00000e60: 5f70 6f73 7218 0000 00da 0363 6364 7217  _posr......ccdr.
-00000e70: 0000 00da 086d 6564 5f64 6973 74da 0772  .....med_dist..r
-00000e80: 6566 5f61 7272 da05 706f 735f 78da 0570  ef_arr..pos_x..p
-00000e90: 6f73 5f79 da0a 7265 6669 6e65 645f 6969  os_y..refined_ii
-00000ea0: 7219 0000 0072 1900 0000 721a 0000 00da  r....r....r.....
-00000eb0: 0c72 6566 696e 655f 6174 6f6d 7357 0000  .refine_atomsW..
-00000ec0: 0073 2000 0000 0017 0a01 0801 1001 1001  .s .............
-00000ed0: 0c01 3201 1c01 0e01 1401 0c01 0c01 0c01  ..2.............
-00000ee0: 1201 1e01 1a01 7256 0000 00e9 1000 0000  ......rV........
-00000ef0: e755 5555 5555 55e5 3fe7 7b14 ae47 e17a  .UUUUUU.?.{..G.z
-00000f00: 843f 4663 0600 0000 0000 0000 0000 0000  .?Fc............
-00000f10: 2500 0000 0c00 0000 4300 0000 73b2 0300  %.......C...s...
-00000f20: 0074 00a0 0164 01a1 0101 0074 02a0 0374  .t...d.....t...t
-00000f30: 047c 0183 01a1 017d 0674 02a0 0574 047c  .|.....}.t...t.|
-00000f40: 0183 01a1 0144 005d 507d 0774 026a 067c  .....D.]P}.t.j.|
-00000f50: 0164 0264 0285 0264 0364 0485 0266 0219  .d.d...d.d...f..
-00000f60: 007c 017c 0764 0364 0485 0266 0219 0018  .|.|.d.d...f....
-00000f70: 0064 0413 0064 0564 068d 027d 0874 02a0  .d...d.d...}.t..
-00000f80: 077c 087c 0864 036b 0419 00a1 0164 0713  .|.|.d.k.....d..
-00000f90: 007c 067c 073c 0071 2674 02a0 087c 06a1  .|.|.<.q&t...|..
-00000fa0: 017d 0974 026a 097c 0174 026a 0a64 088d  .}.t.j.|.t.j.d..
-00000fb0: 027d 0a74 026a 0b64 037c 006a 0c64 0319  .}.t.j.d.|.j.d..
-00000fc0: 0085 0264 037c 006a 0c64 0519 0085 0266  ...d.|.j.d.....f
-00000fd0: 0219 005c 027d 0b7d 0c74 026a 037c 0264  ...\.}.}.t.j.|.d
-00000fe0: 0966 0274 026a 0a64 088d 027d 0d74 026a  .f.t.j.d...}.t.j
-00000ff0: 0374 047c 0183 017c 0264 0966 0374 026a  .t.|...|.d.f.t.j
-00001000: 0a64 088d 027d 0e74 02a0 0574 047c 0183  .d...}.t...t.|..
-00001010: 01a1 0144 0090 025d a47d 0f7c 017c 0f64  ...D...].}.|.|.d
-00001020: 0366 0219 007d 107c 017c 0f64 0566 0219  .f...}.|.|.d.f..
-00001030: 007d 1174 02a0 0d7c 0b7c 1018 00a1 017c  .}.t...|.|.....|
-00001040: 096b 007d 1274 02a0 0d7c 0c7c 1118 00a1  .k.}.t...|.|....
-00001050: 017c 096b 007d 1374 02a0 0e7c 137c 12a1  .|.k.}.t...|.|..
-00001060: 027d 147c 0c7c 1419 007d 157c 0b7c 1419  .}.|.|...}.|.|..
-00001070: 007d 167c 007c 1419 007d 1774 02a0 097c  .}.|.|...}.t...|
-00001080: 17a1 017d 1874 02a0 057c 02a1 0144 0090  ...}.t...|...D..
-00001090: 015d 8a7d 077c 177c 1818 007d 177c 1774  .].}.|.|...}.|.t
-000010a0: 02a0 077c 17a1 0118 0074 02a0 0f7c 17a1  ...|.....t...|..
-000010b0: 0174 02a0 077c 17a1 0118 001b 007d 197c  .t...|.......}.|
-000010c0: 097d 1a7c 157c 1666 027d 1b74 106a 11a0  .}.|.|.f.}.t.j..
-000010d0: 127c 157c 167c 19a1 037d 1c7c 1c64 0319  .|.|.|...}.|.d..
-000010e0: 007c 0918 007c 1c64 0519 007c 0918 0064  .|...|.d...|...d
-000010f0: 0a64 0364 0364 0b7c 1c64 0c19 0014 0066  .d.d.d.|.d.....f
-00001100: 067d 1d7c 1c64 0319 007c 0917 007c 1c64  .}.|.d...|...|.d
-00001110: 0519 007c 0917 0064 0d64 0e7c 1a14 0064  ...|...d.d.|...d
-00001120: 0e7c 1a14 0064 0e7c 1c64 0c19 0014 0066  .|...d.|.d.....f
-00001130: 067d 1e74 136a 1474 106a 116a 157c 1b7c  .}.t.j.t.j.j.|.|
-00001140: 197c 1c7c 1d7c 1e66 027c 047c 0464 0f8d  .|.|.|.f.|.|.d..
-00001150: 075c 027d 1f7d 207c 1f64 0319 007c 0d7c  .\.}.} |.d...|.|
-00001160: 0764 0566 023c 007c 1f64 0519 007c 0d7c  .d.f.<.|.d...|.|
-00001170: 0764 0366 023c 007c 1f64 1019 0074 02a0  .d.f.<.|.d...t..
-00001180: 0f7c 17a1 0174 02a0 077c 17a1 0118 0014  .|...t...|......
-00001190: 007c 0d7c 0764 1066 023c 007c 1f64 0319  .|.|.d.f.<.|.d..
-000011a0: 007c 1118 0064 0413 007c 1f64 0519 007c  .|...d...|.d...|
-000011b0: 1018 0064 0413 0017 0064 0713 007c 0d7c  ...d.....d...|.|
-000011c0: 0764 0466 023c 0074 106a 11a0 157c 1b7c  .d.f.<.t.j...|.|
-000011d0: 1f64 0319 007c 1f64 0519 007c 1f64 0419  .d...|.d...|.d..
-000011e0: 007c 1f64 1119 007c 1f64 0919 007c 1f64  .|.d...|.d...|.d
-000011f0: 0c19 00a1 077d 187c 1874 02a0 0f7c 17a1  .....}.|.t...|..
-00001200: 0174 02a0 077c 17a1 0118 0014 0074 02a0  .t...|.......t..
-00001210: 077c 17a1 0117 007d 1890 0171 6e7c 0d64  .|.....}...qn|.d
-00001220: 0264 0285 0264 0466 0219 007c 037c 0914  .d...d.f...|.|..
-00001230: 006b 007d 2174 02a0 067c 0d7c 2164 1166  .k.}!t...|.|!d.f
-00001240: 0219 00a1 017d 2274 02a0 067c 0d7c 2164  .....}"t...|.|!d
-00001250: 0366 0219 007c 0d7c 2164 1166 0219 0014  .f...|.|!d.f....
-00001260: 00a1 017c 221b 007d 2374 02a0 067c 0d7c  ...|"..}#t...|.|
-00001270: 2164 0566 0219 007c 0d7c 2164 1166 0219  !d.f...|.|!d.f..
-00001280: 0014 00a1 017c 221b 007d 2474 02a0 167c  .....|"..}$t...|
-00001290: 237c 2466 02a1 017c 0a7c 0f64 0364 0485  #|$f...|.|.d.d..
-000012a0: 0266 023c 007c 0d7c 0e7c 0f64 0264 0285  .f.<.|.|.|.d.d..
-000012b0: 0264 0264 0285 0266 033c 0071 f47c 0590  .d.d...f.<.q.|..
-000012c0: 0372 aa7c 0a7c 0e66 0253 007c 0a53 0064  .r.|.|.f.S.|.S.d
-000012d0: 0253 0029 1261 4506 0000 0a20 2020 204d  .S.).aE....    M
-000012e0: 756c 7469 2d47 6175 7373 6961 6e20 5065  ulti-Gaussian Pe
-000012f0: 616b 2052 6566 696e 656d 656e 7420 286d  ak Refinement (m
-00001300: 7066 6974 290a 0a20 2020 2050 6172 616d  pfit)..    Param
-00001310: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00001320: 2d2d 2d2d 0a20 2020 206d 6169 6e5f 696d  ----.    main_im
-00001330: 6167 653a 2020 2020 206e 6461 7272 6179  age:     ndarray
-00001340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001350: 2020 2020 204f 7269 6769 6e61 6c20 6174       Original at
-00001360: 6f6d 6963 2072 6573 6f6c 7574 696f 6e20  omic resolution 
-00001370: 696d 6167 650a 2020 2020 696e 6974 6961  image.    initia
-00001380: 6c5f 7065 616b 733a 2020 6e64 6172 7261  l_peaks:  ndarra
-00001390: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-000013a0: 2020 2020 2020 5920 616e 6420 5820 706f        Y and X po
-000013b0: 7369 7469 6f6e 206f 6620 6d61 7869 6d61  sition of maxima
-000013c0: 2f6d 696e 696d 610a 2020 2020 7065 616b  /minima.    peak
-000013d0: 5f72 756e 733a 2020 2020 2020 696e 740a  _runs:      int.
-000013e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000013f0: 2020 2020 4e75 6d62 6572 206f 6620 6d75      Number of mu
-00001400: 6c74 692d 4761 7573 7369 616e 2073 7465  lti-Gaussian ste
-00001410: 7073 2074 6f20 7275 6e0a 2020 2020 2020  ps to run.      
-00001420: 2020 2020 2020 2020 2020 2020 2020 4465                De
-00001430: 6661 756c 7420 6973 2031 360a 2020 2020  fault is 16.    
-00001440: 6375 745f 706f 696e 743a 2020 2020 2020  cut_point:      
-00001450: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-00001460: 2020 2020 2020 2020 2020 5261 7469 6f20            Ratio 
-00001470: 6f66 2064 6973 7461 6e63 6520 746f 2074  of distance to t
-00001480: 6865 206d 6564 6961 6e20 696e 7465 722d  he median inter-
-00001490: 7065 616b 0a20 2020 2020 2020 2020 2020  peak.           
-000014a0: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
-000014b0: 652e 204f 6e6c 7920 4761 7573 7369 616e  e. Only Gaussian
-000014c0: 2070 6561 6b73 2062 656c 6f77 2074 6869   peaks below thi
-000014d0: 7320 6172 650a 2020 2020 2020 2020 2020  s are.          
-000014e0: 2020 2020 2020 2020 2020 7573 6564 2066            used f
-000014f0: 6f72 2074 6865 2066 696e 616c 2065 7374  or the final est
-00001500: 696d 6174 696f 6e0a 2020 2020 2020 2020  imation.        
-00001510: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00001520: 756c 7420 6973 2032 2f33 0a20 2020 2074  ult is 2/3.    t
-00001530: 6f6c 5f76 616c 3a20 2020 2020 2020 2066  ol_val:        f
-00001540: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00001550: 2020 2020 2020 2020 2054 6865 2074 6f6c           The tol
-00001560: 6572 616e 6365 2076 616c 7565 2074 6f20  erance value to 
-00001570: 7573 6520 666f 7220 6120 6761 7573 7369  use for a gaussi
-00001580: 616e 2065 7374 696d 6174 696f 6e0a 2020  an estimation.  
-00001590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000015a0: 2020 4465 6661 756c 7420 6973 2030 2e30    Default is 0.0
-000015b0: 310a 2020 2020 7065 616b 7061 7261 6d73  1.    peakparams
-000015c0: 3a20 2020 2020 626f 6f6c 6561 6e0a 2020  :     boolean.  
-000015d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000015e0: 2020 4966 2073 6574 2074 6f20 5472 7565    If set to True
-000015f0: 2c20 7468 656e 2074 6865 2069 6e64 6976  , then the indiv
-00001600: 6964 7561 6c20 4761 7573 7369 616e 2070  idual Gaussian p
-00001610: 6561 6b73 2061 6e64 0a20 2020 2020 2020  eaks and.       
-00001620: 2020 2020 2020 2020 2020 2020 2074 6865               the
-00001630: 6972 2061 6d70 6c69 7475 6465 7320 6172  ir amplitudes ar
-00001640: 6520 616c 736f 2072 6574 7572 6e65 642e  e also returned.
-00001650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001660: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-00001670: 4661 6c73 650a 0a20 2020 2052 6574 7572  False..    Retur
-00001680: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-00001690: 2020 206d 7066 6974 5f70 6561 6b73 3a20     mpfit_peaks: 
-000016a0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-000016b0: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
-000016c0: 2072 6566 696e 6564 2070 6561 6b20 706f   refined peak po
-000016d0: 7369 7469 6f6e 7320 6173 2079 2c20 780a  sitions as y, x.
-000016e0: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-000016f0: 2d2d 2d2d 0a20 2020 2054 6869 7320 6973  ----.    This is
-00001700: 2074 6865 206d 756c 7469 706c 6520 4761   the multiple Ga
-00001710: 7573 7369 616e 2070 6561 6b20 6669 7474  ussian peak fitt
-00001720: 696e 6720 7465 6368 6e69 7175 650a 2020  ing technique.  
-00001730: 2020 7768 6572 6520 7468 6520 696e 6974    where the init
-00001740: 6961 6c20 6174 6f6d 2070 6f73 6974 696f  ial atom positio
-00001750: 6e73 2061 7265 2066 6974 7465 6420 7769  ns are fitted wi
-00001760: 7468 2061 0a20 2020 2073 696e 676c 6520  th a.    single 
-00001770: 3244 2047 6175 7373 6961 6e20 6675 6e63  2D Gaussian func
-00001780: 7469 6f6e 2e20 5468 6520 6361 6c63 756c  tion. The calcul
-00001790: 6174 6564 2047 6175 7373 6961 6e20 6973  ated Gaussian is
-000017a0: 0a20 2020 2074 6865 6e20 7375 6273 6571  .    then subseq
-000017b0: 7565 6e74 6c79 2073 7562 7472 6163 7465  uently subtracte
-000017c0: 6420 616e 6420 7265 6669 6e65 6420 6167  d and refined ag
-000017d0: 6169 6e2e 2054 6865 2066 696e 616c 0a20  ain. The final. 
-000017e0: 2020 2072 6566 696e 6564 2070 6f73 6974     refined posit
-000017f0: 696f 6e20 6973 2074 6865 2073 756d 206f  ion is the sum o
-00001800: 6620 616c 6c20 7468 6520 706f 7369 7469  f all the positi
-00001810: 6f6e 7320 7363 616c 6564 0a20 2020 2077  ons scaled.    w
-00001820: 6974 6820 7468 6520 616d 706c 6974 7564  ith the amplitud
-00001830: 650a 0a20 2020 2052 6566 6572 656e 6365  e..    Reference
-00001840: 733a 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s:.    ---------
-00001850: 2d2d 0a20 2020 2031 5d5f 2c20 4d75 6b68  --.    1]_, Mukh
-00001860: 6572 6a65 652c 2044 2e2c 204d 6961 6f2c  erjee, D., Miao,
-00001870: 204c 2e2c 2053 746f 6e65 2c20 472e 2061   L., Stone, G. a
-00001880: 6e64 2041 6c65 6d2c 204e 2e2c 0a20 2020  nd Alem, N.,.   
-00001890: 2020 2020 2020 6d70 6669 743a 2061 2072        mpfit: a r
-000018a0: 6f62 7573 7420 6d65 7468 6f64 2066 6f72  obust method for
-000018b0: 2066 6974 7469 6e67 2061 746f 6d69 6320   fitting atomic 
-000018c0: 7265 736f 6c75 7469 6f6e 2069 6d61 6765  resolution image
-000018d0: 730a 2020 2020 2020 2020 2077 6974 6820  s.         with 
-000018e0: 6d75 6c74 6970 6c65 2047 6175 7373 6961  multiple Gaussia
-000018f0: 6e20 7065 616b 732e 2041 6476 2053 7472  n peaks. Adv Str
-00001900: 7563 7420 4368 656d 2049 6d61 6720 362c  uct Chem Imag 6,
-00001910: 2031 2028 3230 3230 292e 0a20 2020 2072   1 (2020)..    r
-00001920: 4300 0000 4e72 0100 0000 720c 0000 0072  C...Nr....r....r
-00001930: 0d00 0000 720e 0000 0072 1000 0000 7220  ....r....r....r 
-00001940: 0000 00e9 0400 0000 e94c ffff ffe7 0000  .........L......
-00001950: 0000 0000 04c0 e905 0000 00e9 b400 0000  ................
-00001960: e700 0000 0000 0004 40a9 03da 0662 6f75  ........@....bou
-00001970: 6e64 735a 0466 746f 6c5a 0478 746f 6ce9  ndsZ.ftolZ.xtol.
-00001980: ffff ffff 7221 0000 0029 1772 4500 0000  ....r!...).rE...
-00001990: 7246 0000 0072 1100 0000 da05 7a65 726f  rF...r......zero
-000019a0: 7372 1300 0000 da06 6172 616e 6765 7214  sr......aranger.
-000019b0: 0000 0072 2a00 0000 7248 0000 00da 0a7a  ...r*...rH.....z
-000019c0: 6572 6f73 5f6c 696b 6572 2d00 0000 da05  eros_liker-.....
-000019d0: 6d67 7269 64da 0573 6861 7065 da03 6162  mgrid..shape..ab
-000019e0: 735a 0b6c 6f67 6963 616c 5f61 6e64 722b  sZ.logical_andr+
-000019f0: 0000 0072 4900 0000 724a 0000 00da 1269  ...rI...rJ.....i
-00001a00: 6e69 7469 616c 697a 655f 6761 7573 7332  nitialize_gauss2
-00001a10: 44da 0373 706f da09 6375 7276 655f 6669  D..spo..curve_fi
-00001a20: 74da 1467 6175 7373 6961 6e5f 3244 5f66  t..gaussian_2D_f
-00001a30: 756e 6374 696f 6eda 0761 7361 7272 6179  unction..asarray
-00001a40: 2925 da0a 6d61 696e 5f69 6d61 6765 da0d  )%..main_image..
-00001a50: 696e 6974 6961 6c5f 7065 616b 73da 0970  initial_peaks..p
-00001a60: 6561 6b5f 7275 6e73 da09 6375 745f 706f  eak_runs..cut_po
-00001a70: 696e 74da 0774 6f6c 5f76 616c 5a0a 7065  int..tol_valZ.pe
-00001a80: 616b 7061 7261 6d73 7218 0000 0072 1700  akparamsr....r..
-00001a90: 0000 7250 0000 0072 5100 0000 da0b 6d70  ..rP...rQ.....mp
-00001aa0: 6669 745f 7065 616b 73da 0279 79da 0278  fit_peaks..yy..x
-00001ab0: 78da 0563 7661 6c73 5a09 7065 616b 5f76  x..cvalsZ.peak_v
-00001ac0: 616c 73da 026a 6a5a 0679 7374 6172 745a  als..jjZ.ystartZ
-00001ad0: 0678 7374 6172 745a 0573 7562 5f79 5a05  .xstartZ.sub_yZ.
-00001ae0: 7375 625f 78da 0373 7562 da05 7876 616c  sub_x..sub..xval
-00001af0: 73da 0579 7661 6c73 da05 7a76 616c 73da  s..yvals..zvals.
-00001b00: 057a 6361 6c63 da05 7a67 6175 735a 0b6d  .zcalc..zgausZ.m
-00001b10: 6173 6b5f 7261 6469 7573 da02 7879 da0d  ask_radius..xy..
-00001b20: 696e 6974 6961 6c5f 6775 6573 73da 0b6c  initial_guess..l
-00001b30: 6f77 6572 5f62 6f75 6e64 da0b 7570 7065  ower_bound..uppe
-00001b40: 725f 626f 756e 64da 0470 6f70 74da 015f  r_bound..popt.._
-00001b50: da0e 7265 7175 6972 6564 5f63 7661 6c73  ..required_cvals
-00001b60: da05 746f 7461 6cda 0779 5f6d 7066 6974  ..total..y_mpfit
-00001b70: da07 785f 6d70 6669 7472 1900 0000 7219  ..x_mpfitr....r.
-00001b80: 0000 0072 1a00 0000 da05 6d70 6669 7480  ...r......mpfit.
-00001b90: 0000 0073 8800 0000 0035 0a01 0e01 1201  ...s.....5......
-00001ba0: 3201 1c01 0a01 1001 2601 1401 1a01 1401  2.......&.......
-00001bb0: 0c01 0c01 1201 1201 0c01 0801 0801 0801  ................
-00001bc0: 0a01 1001 0801 2201 0401 0801 1002 0a01  ......".........
-00001bd0: 0a01 0201 0201 0201 0afa 0409 0a01 0a01  ................
-00001be0: 0201 0601 0601 0afa 0408 0401 0601 0201  ................
-00001bf0: 0201 0201 0601 0201 02f9 0a09 1001 1001  ................
-00001c00: 2402 1e01 02fe 0c03 0601 26ff 0403 2601  $.........&...&.
-00001c10: 1801 1201 2201 2201 1a01 1801 0601 0802  ....".".........
-00001c20: 7288 0000 00e7 0000 0000 0000 d03f 6306  r............?c.
-00001c30: 0000 0000 0000 0000 0000 002d 0000 000c  ...........-....
-00001c40: 0000 0043 0000 0073 7a04 0000 7400 a001  ...C...sz...t...
-00001c50: 6401 a101 0100 7402 a003 7404 7c01 8301  d.....t...t.|...
-00001c60: a101 7d06 7402 a005 7404 7c01 8301 a101  ..}.t...t.|.....
-00001c70: 4400 5d50 7d07 7402 6a06 7c01 6402 6402  D.]P}.t.j.|.d.d.
-00001c80: 8502 6403 6404 8502 6602 1900 7c01 7c07  ..d.d...f...|.|.
-00001c90: 6403 6404 8502 6602 1900 1800 6404 1300  d.d...f.....d...
-00001ca0: 6405 6406 8d02 7d08 7402 a007 7c08 7c08  d.d...}.t...|.|.
-00001cb0: 6403 6b04 1900 a101 6407 1300 7c06 7c07  d.k.....d...|.|.
-00001cc0: 3c00 7126 7402 a008 7c06 a101 7d09 7402  <.q&t...|...}.t.
-00001cd0: 6a09 7c01 7402 6a0a 6408 8d02 7d0a 7402  j.|.t.j.d...}.t.
-00001ce0: 6a0b 6403 7c00 6a0c 6403 1900 8502 6403  j.d.|.j.d.....d.
-00001cf0: 7c00 6a0c 6405 1900 8502 6602 1900 5c02  |.j.d.....f...\.
-00001d00: 7d0b 7d0c 7c09 6409 1400 7d0d 7402 a005  }.}.|.d...}.t...
-00001d10: 7404 7c01 8301 a101 4400 9003 5da4 7d0e  t.|.....D...].}.
-00001d20: 7c01 7c0e 6402 6402 8502 6602 1900 5c02  |.|.d.d...f...\.
-00001d30: 7d0f 7d10 7402 6a06 7c01 6402 6402 8502  }.}.t.j.|.d.d...
-00001d40: 6403 6404 8502 6602 1900 7c01 7c0e 6403  d.d...f...|.|.d.
-00001d50: 6404 8502 6602 1900 1800 6404 1300 6405  d...f.....d...d.
-00001d60: 6406 8d02 6407 1300 7d11 7c11 7c0d 6b00  d...d...}.|.|.k.
-00001d70: 7d12 640a 7c12 7c11 640b 6b00 3c00 7c01  }.d.|.|.d.k.<.|.
-00001d80: 7c12 6403 6404 8502 6602 1900 7d13 7c0b  |.d.d...f...}.|.
-00001d90: 7c0f 1800 6404 1300 7c0c 7c10 1800 6404  |...d...|.|...d.
-00001da0: 1300 1700 7c0d 6404 1300 6b00 7d14 7c0c  ....|.d...k.}.|.
-00001db0: 7c14 1900 7d15 7c0b 7c14 1900 7d16 7c00  |...}.|.|...}.|.
-00001dc0: 7c14 1900 7d17 7c15 7c10 1800 6404 1300  |...}.|.|...d...
-00001dd0: 7c16 7c0f 1800 6404 1300 1700 7d18 7402  |.|...d.....}.t.
-00001de0: a003 7404 7c15 8301 7404 7c13 8301 6602  ..t.|...t.|...f.
-00001df0: a101 7d19 7402 a005 7404 7c13 8301 a101  ..}.t...t.|.....
-00001e00: 4400 5d3a 7d07 7c15 7c13 7c07 6405 6602  D.]:}.|.|.|.d.f.
-00001e10: 1900 1800 6404 1300 7c16 7c13 7c07 6403  ....d...|.|.|.d.
-00001e20: 6602 1900 1800 6404 1300 1700 7c19 6402  f.....d.....|.d.
-00001e30: 6402 8502 7c07 6602 3c00 9001 71b6 7402  d...|.f.<...q.t.
-00001e40: 6a07 7c19 6405 6406 8d02 7d1a 7c18 6405  j.|.d.d...}.|.d.
-00001e50: 7c05 1700 7c1a 1400 6b00 7d1b 7c15 7c1b  |...|...k.}.|.|.
-00001e60: 1900 7d1c 7c16 7c1b 1900 7d1d 7c17 7c1b  ..}.|.|...}.|.|.
-00001e70: 1900 7d1e 7402 a00d 7c1c 7c10 1800 6404  ..}.t...|.|...d.
-00001e80: 1300 7c1d 7c0f 1800 6404 1300 1700 6407  ..|.|...d.....d.
-00001e90: 1300 a101 7d1f 7402 a009 7c1e a101 7d20  ....}.t...|...} 
-00001ea0: 7c1c 7c1d 6602 7d21 7402 6a03 7c02 640c  |.|.f.}!t.j.|.d.
-00001eb0: 6602 7402 6a0a 6408 8d02 7d22 7402 a005  f.t.j.d...}"t...
-00001ec0: 7c02 a101 4400 9001 5d6e 7d07 7c1e 7c20  |...D...]n}.|.| 
-00001ed0: 1800 7d1e 7c1e 7402 a007 7c1e a101 1800  ..}.|.t...|.....
-00001ee0: 7402 a00d 7c1e a101 7402 a007 7c1e a101  t...|...t...|...
-00001ef0: 1800 1b00 7d23 740e 6a0f a010 7c1c 7c1d  ....}#t.j...|.|.
-00001f00: 7c23 a103 7d24 7402 a007 7c1c a101 7402  |#..}$t...|...t.
-00001f10: a007 7c1d a101 640d 6403 6403 640e 7c24  ..|...d.d.d.d.|$
-00001f20: 640f 1900 1400 6606 7d25 7402 a00d 7c1c  d.....f.}%t...|.
-00001f30: a101 7402 a00d 7c1d a101 6410 7c1f 7c1f  ..t...|...d.|.|.
-00001f40: 6409 7c24 640f 1900 1400 6606 7d26 7411  d.|$d.....f.}&t.
-00001f50: 6a12 740e 6a0f 6a13 7c21 7c23 7c24 7c25  j.t.j.j.|!|#|$|%
-00001f60: 7c26 6602 7c04 7c04 6411 8d07 5c02 7d27  |&f.|.|.d...\.}'
-00001f70: 7d28 7c27 6403 1900 7c22 7c07 6405 6602  }(|'d...|"|.d.f.
-00001f80: 3c00 7c27 6405 1900 7c22 7c07 6403 6602  <.|'d...|"|.d.f.
-00001f90: 3c00 7c27 6412 1900 7402 a00d 7c1e a101  <.|'d...t...|...
-00001fa0: 7402 a007 7c1e a101 1800 1400 7c22 7c07  t...|.......|"|.
-00001fb0: 6412 6602 3c00 7c27 6403 1900 7c10 1800  d.f.<.|'d...|...
-00001fc0: 6404 1300 7c27 6405 1900 7c0f 1800 6404  d...|'d...|...d.
-00001fd0: 1300 1700 6407 1300 7c22 7c07 6404 6602  ....d...|"|.d.f.
-00001fe0: 3c00 740e 6a0f a013 7c21 7c27 6403 1900  <.t.j...|!|'d...
-00001ff0: 7c27 6405 1900 7c27 6404 1900 7c27 6413  |'d...|'d...|'d.
-00002000: 1900 7c27 640c 1900 7c27 640f 1900 a107  ..|'d...|'d.....
-00002010: 7d20 7c20 7402 a00d 7c1e a101 7402 a007  } | t...|...t...
-00002020: 7c1e a101 1800 1400 7402 a007 7c1e a101  |.......t...|...
-00002030: 1700 7d20 9002 717a 7c22 6402 6402 8502  ..} ..qz|"d.d...
-00002040: 6404 6602 1900 7c03 7c1f 1400 6b00 7d29  d.f...|.|...k.})
-00002050: 7402 a006 7c22 7c29 6413 6602 1900 a101  t...|"|)d.f.....
-00002060: 7d2a 7402 a006 7c22 7c29 6403 6602 1900  }*t...|"|)d.f...
-00002070: 7c22 7c29 6413 6602 1900 1400 a101 7c2a  |"|)d.f.......|*
-00002080: 1b00 7d2b 7402 a006 7c22 7c29 6405 6602  ..}+t...|"|)d.f.
-00002090: 1900 7c22 7c29 6413 6602 1900 1400 a101  ..|"|)d.f.......
-000020a0: 7c2a 1b00 7d2c 7402 a014 7c2b 7c2c 6602  |*..},t...|+|,f.
-000020b0: a101 7c0a 7c0e 6403 6404 8502 6602 3c00  ..|.|.d.d...f.<.
-000020c0: 71ce 7c0a 5300 2914 61d2 0600 000a 2020  q.|.S.).a.....  
-000020d0: 2020 4d75 6c74 692d 4761 7573 7369 616e    Multi-Gaussian
-000020e0: 2050 6561 6b20 5265 6669 6e65 6d65 6e74   Peak Refinement
-000020f0: 2028 6d70 6669 7429 0a0a 2020 2020 5061   (mpfit)..    Pa
-00002100: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00002110: 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61 696e  -------.    main
-00002120: 5f69 6d61 6765 3a20 2020 2020 6e64 6172  _image:     ndar
-00002130: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00002140: 2020 2020 2020 2020 4f72 6967 696e 616c          Original
-00002150: 2061 746f 6d69 6320 7265 736f 6c75 7469   atomic resoluti
-00002160: 6f6e 2069 6d61 6765 0a20 2020 2069 6e69  on image.    ini
-00002170: 7469 616c 5f70 6561 6b73 3a20 206e 6461  tial_peaks:  nda
-00002180: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00002190: 2020 2020 2020 2020 2059 2061 6e64 2058           Y and X
-000021a0: 2070 6f73 6974 696f 6e20 6f66 206d 6178   position of max
-000021b0: 696d 612f 6d69 6e69 6d61 0a20 2020 2070  ima/minima.    p
-000021c0: 6561 6b5f 7275 6e73 3a20 2020 2020 2069  eak_runs:      i
-000021d0: 6e74 0a20 2020 2020 2020 2020 2020 2020  nt.             
-000021e0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-000021f0: 206d 756c 7469 2d47 6175 7373 6961 6e20   multi-Gaussian 
-00002200: 7374 6570 7320 746f 2072 756e 0a20 2020  steps to run.   
-00002210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002220: 2044 6566 6175 6c74 2069 7320 3136 0a20   Default is 16. 
-00002230: 2020 2063 7574 5f70 6f69 6e74 3a20 2020     cut_point:   
-00002240: 2020 2066 6c6f 6174 0a20 2020 2020 2020     float.       
-00002250: 2020 2020 2020 2020 2020 2020 2052 6174               Rat
-00002260: 696f 206f 6620 6469 7374 616e 6365 2074  io of distance t
-00002270: 6f20 7468 6520 6d65 6469 616e 2069 6e74  o the median int
-00002280: 6572 2d70 6561 6b0a 2020 2020 2020 2020  er-peak.        
-00002290: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-000022a0: 616e 6365 2e20 4f6e 6c79 2047 6175 7373  ance. Only Gauss
-000022b0: 6961 6e20 7065 616b 7320 6265 6c6f 7720  ian peaks below 
-000022c0: 7468 6973 2061 7265 0a20 2020 2020 2020  this are.       
-000022d0: 2020 2020 2020 2020 2020 2020 2075 7365               use
-000022e0: 6420 666f 7220 7468 6520 6669 6e61 6c20  d for the final 
-000022f0: 6573 7469 6d61 7469 6f6e 0a20 2020 2020  estimation.     
-00002300: 2020 2020 2020 2020 2020 2020 2020 2044                 D
-00002310: 6566 6175 6c74 2069 7320 322f 330a 2020  efault is 2/3.  
-00002320: 2020 746f 6c5f 7661 6c3a 2020 2020 2020    tol_val:      
-00002330: 2020 666c 6f61 740a 2020 2020 2020 2020    float.        
-00002340: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00002350: 746f 6c65 7261 6e63 6520 7661 6c75 6520  tolerance value 
-00002360: 746f 2075 7365 2066 6f72 2061 2067 6175  to use for a gau
-00002370: 7373 6961 6e20 6573 7469 6d61 7469 6f6e  ssian estimation
-00002380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002390: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-000023a0: 302e 3031 0a20 2020 2062 6c75 725f 6661  0.01.    blur_fa
-000023b0: 6374 6f72 3a20 2020 2066 6c6f 6174 0a20  ctor:    float. 
-000023c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000023d0: 2020 204d 616b 6520 7468 6520 566f 726f     Make the Voro
-000023e0: 6e6f 6920 7265 6769 6f6e 7320 736c 6967  noi regions slig
-000023f0: 6874 6c79 2062 6967 6765 722e 0a20 2020  htly bigger..   
-00002400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002410: 2044 6566 6175 6c74 2069 7320 3235 2520   Default is 25% 
-00002420: 6269 6767 6572 0a0a 2020 2020 5265 7475  bigger..    Retu
-00002430: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-00002440: 2020 2020 6d70 6669 745f 7065 616b 733a      mpfit_peaks:
-00002450: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00002460: 2020 2020 2020 2020 2020 4c69 7374 206f            List o
-00002470: 6620 7265 6669 6e65 6420 7065 616b 2070  f refined peak p
-00002480: 6f73 6974 696f 6e73 2061 7320 792c 2078  ositions as y, x
-00002490: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
-000024a0: 2d2d 2d2d 2d0a 2020 2020 5468 6973 2069  -----.    This i
-000024b0: 7320 7468 6520 6d75 6c74 6970 6c65 2047  s the multiple G
-000024c0: 6175 7373 6961 6e20 7065 616b 2066 6974  aussian peak fit
-000024d0: 7469 6e67 2074 6563 686e 6971 7565 0a20  ting technique. 
-000024e0: 2020 2077 6865 7265 2074 6865 2069 6e69     where the ini
-000024f0: 7469 616c 2061 746f 6d20 706f 7369 7469  tial atom positi
-00002500: 6f6e 7320 6172 6520 6669 7474 6564 2077  ons are fitted w
-00002510: 6974 6820 610a 2020 2020 7369 6e67 6c65  ith a.    single
-00002520: 2032 4420 4761 7573 7369 616e 2066 756e   2D Gaussian fun
-00002530: 6374 696f 6e2e 2054 6865 2063 616c 6375  ction. The calcu
-00002540: 6c61 7465 6420 4761 7573 7369 616e 2069  lated Gaussian i
-00002550: 730a 2020 2020 7468 656e 2073 7562 7365  s.    then subse
-00002560: 7175 656e 746c 7920 7375 6274 7261 6374  quently subtract
-00002570: 6564 2061 6e64 2072 6566 696e 6564 2061  ed and refined a
-00002580: 6761 696e 2e20 5468 6520 6669 6e61 6c0a  gain. The final.
-00002590: 2020 2020 7265 6669 6e65 6420 706f 7369      refined posi
-000025a0: 7469 6f6e 2069 7320 7468 6520 7375 6d20  tion is the sum 
-000025b0: 6f66 2061 6c6c 2074 6865 2070 6f73 6974  of all the posit
-000025c0: 696f 6e73 2073 6361 6c65 640a 2020 2020  ions scaled.    
-000025d0: 7769 7468 2074 6865 2061 6d70 6c69 7475  with the amplitu
-000025e0: 6465 2e20 5468 6520 6469 6666 6572 656e  de. The differen
-000025f0: 6365 2077 6974 6820 7468 6520 7374 616e  ce with the stan
-00002600: 6461 7264 206d 7066 6974 0a20 2020 2063  dard mpfit.    c
-00002610: 6f64 6520 6973 2074 6861 7420 7468 6520  ode is that the 
-00002620: 6d61 736b 696e 6720 7265 6769 6f6e 2069  masking region i
-00002630: 7320 6163 7475 616c 6c79 2063 686f 7365  s actually chose
-00002640: 6e20 6173 2061 0a20 2020 2056 6f72 6f6e  n as a.    Voron
-00002650: 6f69 2072 6567 696f 6e20 6672 6f6d 2074  oi region from t
-00002660: 6865 206e 6561 7265 7374 206e 6569 6768  he nearest neigh
-00002670: 626f 7273 0a0a 2020 2020 5265 6665 7265  bors..    Refere
-00002680: 6e63 6573 3a0a 2020 2020 2d2d 2d2d 2d2d  nces:.    ------
-00002690: 2d2d 2d2d 2d0a 2020 2020 315d 5f2c 204d  -----.    1]_, M
-000026a0: 756b 6865 726a 6565 2c20 442e 2c20 4d69  ukherjee, D., Mi
-000026b0: 616f 2c20 4c2e 2c20 5374 6f6e 652c 2047  ao, L., Stone, G
-000026c0: 2e20 616e 6420 416c 656d 2c20 4e2e 2c0a  . and Alem, N.,.
-000026d0: 2020 2020 2020 2020 206d 7066 6974 3a20           mpfit: 
-000026e0: 6120 726f 6275 7374 206d 6574 686f 6420  a robust method 
-000026f0: 666f 7220 6669 7474 696e 6720 6174 6f6d  for fitting atom
-00002700: 6963 2072 6573 6f6c 7574 696f 6e20 696d  ic resolution im
-00002710: 6167 6573 0a20 2020 2020 2020 2020 7769  ages.         wi
-00002720: 7468 206d 756c 7469 706c 6520 4761 7573  th multiple Gaus
-00002730: 7369 616e 2070 6561 6b73 2e20 4164 7620  sian peaks. Adv 
-00002740: 5374 7275 6374 2043 6865 6d20 496d 6167  Struct Chem Imag
-00002750: 2036 2c20 3120 2832 3032 3029 2e0a 0a20   6, 1 (2020)... 
-00002760: 2020 203a 4175 7468 6f72 733a 0a20 2020     :Authors:.   
-00002770: 2044 6562 616e 6773 6875 204d 756b 6865   Debangshu Mukhe
-00002780: 726a 6565 203c 6d75 6b68 6572 6a65 6564  rjee <mukherjeed
-00002790: 406f 726e 6c2e 676f 763e 0a20 2020 2072  @ornl.gov>.    r
-000027a0: 4300 0000 4e72 0100 0000 720c 0000 0072  C...Nr....r....r
-000027b0: 0d00 0000 720e 0000 0072 1000 0000 7220  ....r....r....r 
-000027c0: 0000 0072 5f00 0000 4672 1d00 0000 725a  ...r_...Fr....rZ
-000027d0: 0000 0072 5b00 0000 725c 0000 0072 5d00  ...r[...r\...r].
-000027e0: 0000 725e 0000 0072 6000 0000 7262 0000  ..r^...r`...rb..
-000027f0: 0072 2100 0000 2915 7245 0000 0072 4600  .r!...).rE...rF.
-00002800: 0000 7211 0000 0072 6300 0000 7213 0000  ..r....rc...r...
-00002810: 0072 6400 0000 7214 0000 0072 2a00 0000  .rd...r....r*...
-00002820: 7248 0000 0072 6500 0000 722d 0000 0072  rH...re...r-...r
-00002830: 6600 0000 7267 0000 0072 2b00 0000 7249  f...rg...r+...rI
-00002840: 0000 0072 4a00 0000 7269 0000 0072 6a00  ...rJ...ri...rj.
-00002850: 0000 726b 0000 0072 6c00 0000 726d 0000  ..rk...rl...rm..
-00002860: 0029 2d72 6e00 0000 726f 0000 0072 7000  .)-rn...ro...rp.
-00002870: 0000 7271 0000 0072 7200 0000 5a0b 626c  ..rq...rr...Z.bl
-00002880: 7572 5f66 6163 746f 725a 0564 6973 746d  ur_factorZ.distm
-00002890: 7217 0000 0072 5000 0000 7251 0000 0072  r....rP...rQ...r
-000028a0: 7300 0000 7274 0000 0072 7500 0000 da06  s...rt...ru.....
-000028b0: 6375 746f 6666 7277 0000 005a 0479 706f  cutoffrw...Z.ypo
-000028c0: 735a 0478 706f 7372 1800 0000 5a05 6469  sZ.xposr....Z.di
-000028d0: 7374 6e5a 056e 6569 6768 7278 0000 0072  stnZ.neighrx...r
-000028e0: 7900 0000 727a 0000 0072 7b00 0000 5a08  y...rz...r{...Z.
-000028f0: 6d61 696e 6469 7374 5a08 6469 7374 5f6d  maindistZ.dist_m
-00002900: 6174 5a0a 6e65 6967 685f 6469 7374 5a07  atZ.neigh_distZ.
-00002910: 766f 726f 6e6f 695a 0478 766f 725a 0479  voronoiZ.xvorZ.y
-00002920: 766f 725a 047a 766f 725a 0876 6f72 5f64  vorZ.zvorZ.vor_d
-00002930: 6973 7472 7c00 0000 727e 0000 0072 7600  istr|...r~...rv.
-00002940: 0000 727d 0000 0072 7f00 0000 7280 0000  ..r}...r....r...
-00002950: 0072 8100 0000 7282 0000 0072 8300 0000  .r....r....r....
-00002960: 7284 0000 0072 8500 0000 7286 0000 0072  r....r....r....r
-00002970: 8700 0000 7219 0000 0072 1900 0000 721a  ....r....r....r.
-00002980: 0000 00da 0d6d 7066 6974 5f76 6f72 6f6e  .....mpfit_voron
-00002990: 6f69 fe00 0000 739a 0000 0000 390a 010e  oi....s.....9...
-000029a0: 0112 0132 011c 010a 0110 0126 0108 0114  ...2.......&....
-000029b0: 0114 0230 0102 fe04 0308 010c 0110 0120  ...0........... 
-000029c0: 0108 0108 0108 0118 0116 0112 0112 0112  ................
-000029d0: ff14 030e 0110 0108 0108 0108 0122 010a  ............."..
-000029e0: 0108 0114 0110 0108 0122 0110 0208 0108  ........."......
-000029f0: 0102 0102 0102 010a fa04 0908 0108 0102  ................
-00002a00: 0102 0102 010a fa04 0804 0106 0102 0102  ................
-00002a10: 0102 0106 0102 0102 f90a 0910 0110 0124  ...............$
-00002a20: 012c 0106 0126 ff04 0326 0118 0112 0122  .,...&...&....."
-00002a30: 0122 011c 0172 8b00 0000 e79a 9999 9999  ."...r..........
-00002a40: 99c9 3f63 0400 0000 0000 0000 0000 0000  ..?c............
-00002a50: 1700 0000 0600 0000 4300 0000 737c 0100  ........C...s|..
-00002a60: 0074 006a 01a0 0274 006a 01a0 037c 00a1  .t.j...t.j...|..
-00002a70: 01a1 017d 047c 0164 0119 007d 057c 0164  ...}.|.d...}.|.d
-00002a80: 0219 007d 0674 046a 05a0 0674 00a0 077c  ...}.t.j...t...|
-00002a90: 04a1 0164 03a1 027d 0774 086a 09a0 0a7c  ...d...}.t.j...|
-00002aa0: 077c 057c 067c 02a1 047d 087c 0864 0119  .|.|.|...}.|.d..
-00002ab0: 007d 097c 0864 0219 007d 0a74 00a0 0b7c  .}.|.d...}.t...|
-00002ac0: 097c 0a66 02a1 017d 0b74 006a 0b74 00a0  .|.f...}.t.j.t..
-00002ad0: 0c7c 04a1 0174 0d64 048d 027d 0c74 006a  .|...t.d...}.t.j
-00002ae0: 0e64 017c 0c64 0119 0085 0264 017c 0c64  .d.|.d.....d.|.d
-00002af0: 0219 0085 0266 0219 005c 027d 0d7d 0e7c  .....f...\.}.}.|
-00002b00: 0d7c 0a18 0064 0513 007c 0e7c 0918 0064  .|...d...|.|...d
-00002b10: 0513 0017 0064 0613 007c 026b 007d 0f74  .....d...|.k.}.t
-00002b20: 00a0 0f7c 0fa1 017d 107c 10a0 1074 006a  ...|...}.|...t.j
-00002b30: 11a1 017d 1074 046a 05a0 067c 1064 02a1  ...}.t.j...|.d..
-00002b40: 027d 1174 00a0 127c 047c 11a1 027d 1274  .}.t...|.|...}.t
-00002b50: 006a 01a0 137c 12a1 017d 1374 00a0 077c  .j...|...}.t...|
-00002b60: 13a1 017d 147c 1474 00a0 147c 14a1 0118  ...}.|.t...|....
-00002b70: 0074 00a0 157c 14a1 0174 00a0 147c 14a1  .t...|...t...|..
-00002b80: 0118 001b 007d 1464 017c 147c 147c 036b  .....}.d.|.|.|.k
-00002b90: 003c 0064 027c 147c 147c 036b 043c 0074  .<.d.|.|.|.k.<.t
-00002ba0: 046a 05a0 067c 1464 03a1 027d 1564 017c  .j...|.d...}.d.|
-00002bb0: 157c 157c 036b 003c 0064 027c 157c 157c  .|.|.k.<.d.|.|.|
-00002bc0: 036b 043c 0074 00a0 127c 007c 15a1 027d  .k.<.t...|.|...}
-00002bd0: 167c 167c 137c 0b7c 1566 0453 0029 074e  .|.|.|.|.f.S.).N
-00002be0: 7201 0000 0072 0d00 0000 7221 0000 0072  r....r....r!...r
-00002bf0: 2000 0000 720c 0000 0072 1000 0000 2916   ...r....r....).
-00002c00: 7211 0000 00da 0366 6674 da08 6666 7473  r......fft..ffts
-00002c10: 6869 6674 da04 6666 7432 7231 0000 00da  hift..fft2r1....
-00002c20: 0766 696c 7465 7273 da0f 6761 7573 7369  .filters..gaussi
-00002c30: 616e 5f66 696c 7465 7272 6800 0000 7249  an_filterrh...rI
-00002c40: 0000 0072 4a00 0000 724b 0000 0072 6d00  ...rJ...rK...rm.
-00002c50: 0000 7267 0000 0072 3000 0000 7266 0000  ..rg...r0...rf..
-00002c60: 0072 1200 0000 da06 6173 7479 7065 5a07  .r......astypeZ.
-00002c70: 666c 6f61 7436 34da 086d 756c 7469 706c  float64..multipl
-00002c80: 795a 0569 6666 7432 722a 0000 0072 2b00  yZ.ifft2r*...r+.
-00002c90: 0000 2917 5a0e 6f72 6967 696e 616c 5f69  ..).Z.original_i
-00002ca0: 6d61 6765 da06 6365 6e74 6572 da06 7261  mage..center..ra
-00002cb0: 6469 7573 da09 7468 7265 7368 6f6c 645a  dius..thresholdZ
-00002cc0: 0d69 6d61 6765 5f66 6f75 7269 6572 7253  .image_fourierrS
-00002cd0: 0000 0072 5400 0000 da0d 626c 7572 7265  ...rT.....blurre
-00002ce0: 645f 696d 6167 65da 0b66 6974 7465 645f  d_image..fitted_
-00002cf0: 6469 6666 5a05 6e65 775f 785a 056e 6577  diffZ.new_xZ.new
-00002d00: 5f79 da0a 6e65 775f 6365 6e74 6572 da0a  _y..new_center..
-00002d10: 7369 7a65 5f69 6d61 6765 da02 7956 da02  size_image..yV..
-00002d20: 7856 7278 0000 005a 0663 6972 636c 655a  xVrx...Z.circleZ
-00002d30: 0d66 696c 7465 7265 645f 6369 7263 da0c  .filtered_circ..
-00002d40: 6d61 736b 6564 5f69 6d61 6765 5a0a 5341  masked_imageZ.SA
-00002d50: 4544 5f69 6d61 6765 5a08 6d61 675f 5341  ED_imageZ.mag_SA
-00002d60: 4544 5a0d 6669 6c74 6572 6564 5f53 4145  EDZ.filtered_SAE
-00002d70: 445a 1666 6f75 7269 6572 5f73 656c 6563  DZ.fourier_selec
-00002d80: 7465 645f 696d 6167 6572 1900 0000 7219  ted_imager....r.
-00002d90: 0000 0072 1a00 0000 da0c 666f 7572 6965  ...r......fourie
-00002da0: 725f 6d61 736b 8801 0000 7332 0000 0000  r_mask....s2....
-00002db0: 0114 0108 0108 0114 0112 0108 0108 010e  ................
-00002dc0: 0114 0122 0120 010a 010c 010e 010c 010c  ...". ..........
-00002dd0: 010a 0122 010c 010c 010e 010c 010c 010c  ..."............
-00002de0: 0172 9e00 0000 6304 0000 0000 0000 0000  .r....c.........
-00002df0: 0000 000b 0000 0007 0000 0043 0000 0073  ...........C...s
-00002e00: ac00 0000 7400 6a01 a002 7400 6a01 a003  ....t.j...t.j...
-00002e10: 7c00 a101 a101 7d04 7404 6a05 a006 7400  |.....}.t.j...t.
-00002e20: a007 7400 a008 7c04 a101 a101 6401 a102  ..t...|.....d...
-00002e30: 7d05 7409 6a0a 6402 6403 8d01 5c02 7d06  }.t.j.d.d...\.}.
-00002e40: 7d07 7409 6a0b 7c01 6404 6405 6406 6407  }.t.j.|.d.d.d.d.
-00002e50: 8d04 7d08 7409 6a0b 7c02 6404 6408 6406  ..}.t.j.|.d.d.d.
-00002e60: 6407 8d04 7d09 7409 6a0b 7c03 6404 6409  d...}.t.j.|.d.d.
-00002e70: 6406 6407 8d04 7d0a 7c07 6a0c 7c05 640a  d.d...}.|.j.|.d.
-00002e80: 640b 8d02 0100 7c07 a00d 7c08 a101 0100  d.....|...|.....
-00002e90: 7c07 a00d 7c09 a101 0100 7c07 a00d 7c0a  |...|.....|...|.
-00002ea0: a101 0100 7409 a00e a100 0100 640c 5300  ....t.......d.S.
-00002eb0: 290d 6161 0200 000a 2020 2020 4669 6e64  ).aa....    Find
-00002ec0: 2074 6865 2064 6966 6672 6163 7469 6f6e   the diffraction
-00002ed0: 2073 706f 7473 2076 6973 7561 6c6c 792e   spots visually.
-00002ee0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00002ef0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00002f00: 2020 2020 696d 6167 653a 2020 6e64 6172      image:  ndar
-00002f10: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00002f20: 4f72 6967 696e 616c 2069 6d61 6765 0a20  Original image. 
-00002f30: 2020 2063 6972 635f 633a 206e 6461 7272     circ_c: ndarr
-00002f40: 6179 0a20 2020 2020 2020 2020 2020 2050  ay.            P
-00002f50: 6f73 6974 696f 6e20 6f66 2074 6865 2063  osition of the c
-00002f60: 656e 7472 616c 2062 6561 6d20 696e 0a20  entral beam in. 
-00002f70: 2020 2020 2020 2020 2020 2074 6865 2046             the F
-00002f80: 6f75 7269 6572 2070 6174 7465 726e 0a20  ourier pattern. 
-00002f90: 2020 2063 6972 635f 793a 206e 6461 7272     circ_y: ndarr
-00002fa0: 6179 0a20 2020 2020 2020 2020 2020 2050  ay.            P
-00002fb0: 6f73 6974 696f 6e20 6f66 2074 6865 2079  osition of the y
-00002fc0: 2062 6561 6d20 696e 0a20 2020 2020 2020   beam in.       
-00002fd0: 2020 2020 2074 6865 2046 6f75 7269 6572       the Fourier
-00002fe0: 2070 6174 7465 726e 0a20 2020 2063 6972   pattern.    cir
-00002ff0: 635f 783a 206e 6461 7272 6179 0a20 2020  c_x: ndarray.   
-00003000: 2020 2020 2020 2020 2050 6f73 6974 696f           Positio
-00003010: 6e20 6f66 2074 6865 2078 2062 6561 6d20  n of the x beam 
-00003020: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
-00003030: 6865 2046 6f75 7269 6572 2070 6174 7465  he Fourier patte
-00003040: 726e 0a0a 0a20 2020 204e 6f74 6573 0a20  rn...    Notes. 
-00003050: 2020 202d 2d2d 2d2d 0a20 2020 2050 7574     -----.    Put
-00003060: 2063 6972 636c 6573 2069 6e20 7265 6428   circles in red(
-00003070: 6365 6e74 7261 6c29 2c20 7928 626c 7565  central), y(blue
-00003080: 2920 616e 6420 7828 6772 6565 6e29 0a20  ) and x(green). 
-00003090: 2020 206f 6e20 7468 6520 6469 6666 7261     on the diffra
-000030a0: 6374 696f 6e20 7061 7474 6572 6e20 746f  ction pattern to
-000030b0: 2061 7070 726f 7869 6d61 7465 6c79 206b   approximately k
-000030c0: 6e6f 770a 2020 2020 7468 6520 706f 7369  now.    the posi
-000030d0: 7469 6f6e 732e 0a0a 2020 2020 3a41 7574  tions...    :Aut
-000030e0: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
-000030f0: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
-00003100: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
-00003110: 6f76 3e0a 2020 2020 7221 0000 0072 1e00  ov>.    r!...r..
-00003120: 0000 7224 0000 0072 2600 0000 5a03 7265  ..r$...r&...Z.re
-00003130: 64e7 1f85 eb51 b81e d53f 2902 da05 636f  d....Q...?)...co
-00003140: 6c6f 72da 0561 6c70 6861 5a04 626c 7565  lor..alphaZ.blue
-00003150: 5a05 6772 6565 6e5a 0467 7261 79a9 01da  Z.greenZ.gray...
-00003160: 0463 6d61 704e 290f 7211 0000 0072 8d00  .cmapN).r....r..
-00003170: 0000 728e 0000 0072 8f00 0000 7231 0000  ..r....r....r1..
-00003180: 0072 9000 0000 7291 0000 00da 056c 6f67  .r....r......log
-00003190: 3130 7268 0000 0072 3700 0000 5a08 7375  10rh...r7...Z.su
-000031a0: 6270 6c6f 7473 5a06 4369 7263 6c65 7239  bplotsZ.Circler9
-000031b0: 0000 00da 0a61 6464 5f61 7274 6973 745a  .....add_artistZ
-000031c0: 0473 686f 7729 0bda 0569 6d61 6765 5a06  .show)...imageZ.
-000031d0: 6369 7263 5f63 5a06 6369 7263 5f79 5a06  circ_cZ.circ_yZ.
-000031e0: 6369 7263 5f78 5a08 696d 6167 655f 6674  circ_xZ.image_ft
-000031f0: 5a0a 6c6f 675f 6162 735f 6674 da01 665a  Z.log_abs_ft..fZ
-00003200: 0261 785a 0963 6972 635f 635f 696d 5a09  .axZ.circ_c_imZ.
-00003210: 6369 7263 5f79 5f69 6d5a 0963 6972 635f  circ_y_imZ.circ_
-00003220: 785f 696d 7219 0000 0072 1900 0000 721a  x_imr....r....r.
-00003230: 0000 00da 1666 696e 645f 6469 6666 7261  .....find_diffra
-00003240: 6374 696f 6e5f 7370 6f74 73a4 0100 0073  ction_spots....s
-00003250: 1600 0000 001c 1401 1a01 1001 1201 1201  ................
-00003260: 1201 0e01 0a01 0a01 0a01 72a8 0000 0063  ..........r....c
-00003270: 0600 0000 0000 0000 0000 0000 1700 0000  ................
-00003280: 0800 0000 4300 0000 7370 0200 007c 006a  ....C...sp...|.j
-00003290: 007d 0674 01a0 027c 0664 0119 000b 0064  .}.t...|.d.....d
-000032a0: 021b 007c 0664 0119 0064 021b 0064 01a1  ...|.d...d...d..
-000032b0: 037c 0664 0119 001b 007d 0774 01a0 027c  .|.d.....}.t...|
-000032c0: 0664 0319 000b 0064 021b 007c 0664 0319  .d.....d...|.d..
-000032d0: 0064 021b 0064 01a1 037c 0664 0319 001b  .d...d...|.d....
-000032e0: 007d 0874 01a0 0374 01a0 047c 07a1 01a1  .}.t...t...|....
-000032f0: 017d 0974 01a0 0374 01a0 047c 08a1 01a1  .}.t...t...|....
-00003300: 017d 0a7c 0a7c 0966 027d 0b64 017c 047c  .}.|.|.f.}.d.|.|
-00003310: 0464 036b 023c 0064 017c 057c 0564 036b  .d.k.<.d.|.|.d.k
-00003320: 023c 007c 027c 0118 007d 0c74 01a0 057c  .<.|.|...}.t...|
-00003330: 0c7c 0464 0364 0285 0219 00a1 027d 0c7c  .|.d.d.......}.|
-00003340: 037c 0118 007d 0d74 01a0 057c 0d7c 0564  .|...}.t...|.|.d
-00003350: 0364 0285 0219 00a1 027d 0d7c 0c7c 0b14  .d.......}.|.|..
-00003360: 007d 0e7c 0d7c 0b14 007d 0f74 01a0 0674  .}.|.|...}.t...t
-00003370: 01a0 077c 0e64 0319 0074 016a 08a0 097c  ...|.d...t.j...|
-00003380: 0ea1 011b 00a1 01a1 017d 1064 0174 016a  .........}.d.t.j
-00003390: 08a0 097c 0ea1 011b 007d 1174 01a0 0674  ...|.....}.t...t
-000033a0: 01a0 077c 0f64 0319 0074 016a 08a0 097c  ...|.d...t.j...|
-000033b0: 0fa1 011b 00a1 01a1 017d 1264 0174 016a  .........}.d.t.j
-000033c0: 08a0 097c 0fa1 011b 007d 137c 1174 01a0  ...|.....}.|.t..
-000033d0: 0a74 01a0 0b7c 1064 0418 00a1 01a1 0114  .t...|.d........
-000033e0: 007c 1174 01a0 0c74 01a0 0b7c 1064 0418  .|.t...t...|.d..
-000033f0: 00a1 01a1 0114 0066 027d 147c 1374 01a0  .......f.}.|.t..
-00003400: 0a74 01a0 0b7c 1264 0418 00a1 01a1 0114  .t...|.d........
-00003410: 007c 1374 01a0 0c74 01a0 0b7c 1264 0418  .|.t...t...|.d..
-00003420: 00a1 01a1 0114 0066 027d 1574 01a0 0d7c  .......f.}.t...|
-00003430: 1464 0119 007c 1464 0319 0066 027c 1564  .d...|.d...f.|.d
-00003440: 0119 007c 1564 0319 0066 0266 02a1 017d  ...|.d...f.f...}
-00003450: 1674 01a0 0e74 01a0 0f7c 1664 0364 0564  .t...t...|.d.d.d
-00003460: 0585 0266 0219 00a1 01a1 0174 01a0 0e7c  ...f.......t...|
-00003470: 1664 0364 0564 0585 0266 0219 00a1 016b  .d.d.d...f.....k
-00003480: 0490 0272 1864 067c 1664 0364 0564 0585  ...r.d.|.d.d.d..
-00003490: 0266 0219 0014 007c 1664 0364 0564 0585  .f.....|.d.d.d..
-000034a0: 0266 023c 0074 01a0 0e74 01a0 0f7c 1664  .f.<.t...t...|.d
-000034b0: 0164 0564 0585 0266 0219 00a1 01a1 0174  .d.d...f.......t
-000034c0: 01a0 0e7c 1664 0164 0564 0585 0266 0219  ...|.d.d.d...f..
-000034d0: 00a1 016b 0490 0272 6c64 067c 1664 0164  ...k...rld.|.d.d
-000034e0: 0564 0585 0266 0219 0014 007c 1664 0164  .d...f.....|.d.d
-000034f0: 0564 0585 0266 023c 007c 1653 0029 0761  .d...f.<.|.S.).a
-00003500: 0f03 0000 0a20 2020 2043 6f6e 7665 7274  .....    Convert
-00003510: 2074 6865 2066 6f75 7269 6572 2070 6f73   the fourier pos
-00003520: 6974 696f 6e73 2074 6f20 696d 6167 6520  itions to image 
-00003530: 6178 6573 2e0a 0a20 2020 2050 6172 616d  axes...    Param
-00003540: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00003550: 2d2d 2d2d 0a20 2020 2069 6d61 6765 3a20  ----.    image: 
-00003560: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00003570: 2020 2020 204f 7269 6769 6e61 6c20 696d       Original im
-00003580: 6167 650a 2020 2020 666f 7572 5f63 3a20  age.    four_c: 
-00003590: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-000035a0: 2020 2020 506f 7369 7469 6f6e 206f 6620      Position of 
-000035b0: 7468 6520 6365 6e74 7261 6c20 6265 616d  the central beam
-000035c0: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-000035d0: 7468 6520 466f 7572 6965 7220 7061 7474  the Fourier patt
-000035e0: 6572 6e0a 2020 2020 666f 7572 5f79 3a20  ern.    four_y: 
-000035f0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00003600: 2020 2020 506f 7369 7469 6f6e 206f 6620      Position of 
-00003610: 7468 6520 7920 6265 616d 2069 6e0a 2020  the y beam in.  
-00003620: 2020 2020 2020 2020 2020 7468 6520 466f            the Fo
-00003630: 7572 6965 7220 7061 7474 6572 6e0a 2020  urier pattern.  
-00003640: 2020 666f 7572 5f78 3a20 6e64 6172 7261    four_x: ndarra
-00003650: 790a 2020 2020 2020 2020 2020 2020 506f  y.            Po
-00003660: 7369 7469 6f6e 206f 6620 7468 6520 7820  sition of the x 
-00003670: 6265 616d 2069 6e0a 2020 2020 2020 2020  beam in.        
-00003680: 2020 2020 7468 6520 466f 7572 6965 7220      the Fourier 
-00003690: 7061 7474 6572 6e0a 0a20 2020 2052 6574  pattern..    Ret
-000036a0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-000036b0: 0a20 2020 2063 6f6f 7264 733a 206e 6461  .    coords: nda
-000036c0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-000036d0: 2041 7865 7320 636f 2d6f 7264 696e 6174   Axes co-ordinat
-000036e0: 6573 2069 6e20 7468 6520 7265 616c 2069  es in the real i
-000036f0: 6d61 6765 2c0a 2020 2020 2020 2020 2020  mage,.          
-00003700: 2020 6173 205b 7931 2078 310a 2020 2020    as [y1 x1.    
-00003710: 2020 2020 2020 2020 2020 2020 7932 2078              y2 x
-00003720: 325d 0a0a 2020 2020 4e6f 7465 730a 2020  2]..    Notes.  
-00003730: 2020 2d2d 2d2d 2d0a 2020 2020 5573 6520    -----.    Use 
-00003740: 7468 6520 666f 7572 6965 7220 636f 6f72  the fourier coor
-00003750: 6469 6e61 7465 7320 746f 2064 6566 696e  dinates to defin
-00003760: 6520 7468 6520 6178 6573 0a20 2020 2063  e the axes.    c
-00003770: 6f2d 6f72 6469 6e61 7465 7320 696e 2072  o-ordinates in r
-00003780: 6561 6c20 7370 6163 652c 2077 6869 6368  eal space, which
-00003790: 2077 696c 6c20 6265 2075 7365 640a 2020   will be used.  
-000037a0: 2020 746f 2061 7373 6967 6e20 6561 6368    to assign each
-000037b0: 2061 746f 6d20 706f 7369 7469 6f6e 2074   atom position t
-000037c0: 6f20 6120 6178 6573 2070 6f73 6974 696f  o a axes positio
-000037d0: 6e0a 0a20 2020 203a 4175 7468 6f72 733a  n..    :Authors:
-000037e0: 0a20 2020 2044 6562 616e 6773 6875 204d  .    Debangshu M
-000037f0: 756b 6865 726a 6565 203c 6d75 6b68 6572  ukherjee <mukher
-00003800: 6a65 6564 406f 726e 6c2e 676f 763e 0a20  jeed@ornl.gov>. 
-00003810: 2020 2072 0d00 0000 720c 0000 0072 0100     r....r....r..
-00003820: 0000 e95a 0000 004e 7262 0000 0029 1072  ...Z...Nrb...).r
-00003830: 6700 0000 7211 0000 0072 6400 0000 da04  g...r....rd.....
-00003840: 6d65 616e 5a04 6469 6666 da06 6469 7669  meanZ.diff..divi
-00003850: 6465 da07 6465 6772 6565 73da 0661 7263  de..degrees..arc
-00003860: 636f 73da 066c 696e 616c 67da 046e 6f72  cos..linalg..nor
-00003870: 6dda 0363 6f73 da07 6465 6732 7261 64da  m..cos..deg2rad.
-00003880: 0373 696e 726d 0000 0072 2b00 0000 7268  .sinrm...r+...rh
-00003890: 0000 0029 1772 a600 0000 5a0e 666f 7572  ...).r....Z.four
-000038a0: 6965 725f 6365 6e74 6572 5a09 666f 7572  ier_centerZ.four
-000038b0: 6965 725f 795a 0966 6f75 7269 6572 5f78  ier_yZ.fourier_x
-000038c0: 5a06 795f 6178 6973 5a06 785f 6178 6973  Z.y_axisZ.x_axis
-000038d0: 5a0a 696d 6167 655f 7369 7a65 5a02 7178  Z.image_sizeZ.qx
-000038e0: 5a02 7179 5a02 6478 5a02 6479 5a0d 666f  Z.qyZ.dxZ.dyZ.fo
-000038f0: 7572 6965 725f 6361 6c69 625a 0a64 6973  urier_calibZ.dis
-00003900: 7461 6e63 655f 795a 0a64 6973 7461 6e63  tance_yZ.distanc
-00003910: 655f 785a 1066 6f75 7269 6572 5f6c 656e  e_xZ.fourier_len
-00003920: 6774 685f 795a 1066 6f75 7269 6572 5f6c  gth_yZ.fourier_l
-00003930: 656e 6774 685f 785a 0761 6e67 6c65 5f79  ength_xZ.angle_y
-00003940: 5a0b 7265 616c 5f79 5f73 697a 655a 0761  Z.real_y_sizeZ.a
-00003950: 6e67 6c65 5f78 5a0b 7265 616c 5f78 5f73  ngle_xZ.real_x_s
-00003960: 697a 655a 0672 6561 6c5f 795a 0672 6561  izeZ.real_yZ.rea
-00003970: 6c5f 78da 0663 6f6f 7264 7372 1900 0000  l_x..coordsr....
-00003980: 7219 0000 0072 1a00 0000 da0b 6669 6e64  r....r......find
-00003990: 5f63 6f6f 7264 73cd 0100 0073 4400 0000  _coords....sD...
-000039a0: 0022 0601 2801 2801 1001 1001 0801 0c01  ."..(.(.........
-000039b0: 0c01 0801 1401 0801 1401 0801 0801 0401  ................
-000039c0: 18ff 0403 1001 0401 18ff 0403 1002 1601  ................
-000039d0: 16fe 0405 1601 16fe 0404 2601 3401 2001  ..........&.4. .
-000039e0: 3401 2001 72b4 0000 0063 0300 0000 0000  4. .r....c......
-000039f0: 0000 0000 0000 0b00 0000 0600 0000 4300  ..............C.
-00003a00: 0000 7394 0000 007c 017c 0266 0266 0164  ..s....|.|.f.f.d
-00003a10: 0164 0284 017d 037c 006a 0064 0319 0064  .d...}.|.j.d...d
-00003a20: 041b 007d 047c 006a 0064 0519 0064 041b  ...}.|.j.d...d..
-00003a30: 007d 0574 01a0 027c 057c 0466 02a1 017d  .}.t...|.|.f...}
-00003a40: 0674 01a0 027c 057c 0564 041b 0018 007c  .t...|.|.d.....|
-00003a50: 047c 0464 041b 0018 0066 02a1 017d 0774  .|.d.....f...}.t
-00003a60: 01a0 027c 057c 0564 041b 0017 007c 047c  ...|.|.d.....|.|
-00003a70: 0464 041b 0017 0066 02a1 017d 0874 036a  .d.....f...}.t.j
-00003a80: 047c 037c 067c 077c 0866 0264 068d 037d  .|.|.|.|.f.d...}
-00003a90: 097c 096a 057d 0a7c 0a53 0029 074e 6302  .|.j.}.|.S.).Nc.
-00003aa0: 0000 0000 0000 0000 0000 0006 0000 0009  ................
-00003ab0: 0000 0053 0000 0073 1601 0000 7c01 6401  ...S...s....|.d.
-00003ac0: 1900 7d02 7c01 6402 1900 7d03 7400 a001  ..}.|.d...}.t...
-00003ad0: 7c02 6a02 6401 1900 6403 6602 a101 7d04  |.j.d...d.f...}.
-00003ae0: 7c02 6400 6400 8502 6401 6404 8502 6602  |.d.d...d.d...f.
-00003af0: 1900 7c00 6401 6404 8502 1900 1800 7c04  ..|.d.d.......|.
-00003b00: 6400 6400 8502 6401 6404 8502 6602 3c00  d.d...d.d...f.<.
-00003b10: 7c04 6400 6400 8502 6401 6404 8502 6602  |.d.d...d.d...f.
-00003b20: 1900 7400 6a03 a004 7c03 a101 1000 7c04  ..t.j...|.....|.
-00003b30: 6400 6400 8502 6404 6405 8502 6602 3c00  d.d...d.d...f.<.
-00003b40: 7400 a005 7c04 6400 6400 8502 6404 6405  t...|.d.d...d.d.
-00003b50: 8502 6602 1900 a101 7c04 6400 6400 8502  ..f.....|.d.d...
-00003b60: 6405 6403 8502 6602 3c00 7400 a006 7400  d.d...f.<.t...t.
-00003b70: a007 7c04 6400 6400 8502 6406 6602 1900  ..|.d.d...d.f...
-00003b80: 7c04 6400 6400 8502 6407 6602 1900 1800  |.d.d...d.f.....
-00003b90: a101 a101 6404 1300 7400 a006 7400 a007  ....d...t...t...
-00003ba0: 7c04 6400 6400 8502 6404 6602 1900 7c04  |.d.d...d.f...|.
-00003bb0: 6400 6400 8502 6405 6602 1900 1800 a101  d.d...d.f.......
-00003bc0: a101 6404 1300 1700 6408 1300 7d05 7c05  ..d.....d...}.|.
-00003bd0: 5300 2909 4e72 0100 0000 720d 0000 00e9  S.).Nr....r.....
-00003be0: 0600 0000 720c 0000 0072 5a00 0000 7221  ....r....rZ...r!
-00003bf0: 0000 0072 5d00 0000 7210 0000 0029 0872  ...r]...r....).r
-00003c00: 1100 0000 7263 0000 0072 6700 0000 72ae  ....rc...rg...r.
-00003c10: 0000 00da 0369 6e76 da05 726f 756e 6472  .....inv..roundr
-00003c20: aa00 0000 7268 0000 0029 065a 0878 7943  ....rh...).Z.xyC
-00003c30: 656e 7465 72da 0a69 6e70 7574 5f64 6174  enter..input_dat
-00003c40: 6172 4100 0000 72b3 0000 00da 0b61 746f  arA...r......ato
-00003c50: 6d5f 636f 6f72 6473 da11 6176 6572 6167  m_coords..averag
-00003c60: 655f 6465 7669 6174 696f 6e72 1900 0000  e_deviationr....
-00003c70: 7219 0000 0072 1a00 0000 da0f 6f72 6967  r....r......orig
-00003c80: 696e 5f66 756e 6374 696f 6e16 0200 0073  in_function....s
-00003c90: 1800 0000 0001 0801 0801 1401 3001 3001  ............0.0.
-00003ca0: 2a02 2e01 2eff 0202 02fd 0404 7a23 6765  *...........z#ge
-00003cb0: 745f 6f72 6967 696e 2e3c 6c6f 6361 6c73  t_origin.<locals
-00003cc0: 3e2e 6f72 6967 696e 5f66 756e 6374 696f  >.origin_functio
-00003cd0: 6e72 0d00 0000 720c 0000 0072 0100 0000  nr....r....r....
-00003ce0: a903 5a03 6675 6e5a 0278 3072 6100 0000  ..Z.funZ.x0ra...
-00003cf0: 2906 7267 0000 0072 1100 0000 726d 0000  ).rg...r....rm..
-00003d00: 0072 6a00 0000 da08 6d69 6e69 6d69 7a65  .rj.....minimize
-00003d10: da01 7829 0b72 a600 0000 da08 7065 616b  ..x).r......peak
-00003d20: 5f70 6f73 72b3 0000 0072 bb00 0000 5a09  _posr....r....Z.
-00003d30: 696e 6974 6961 6c5f 785a 0969 6e69 7469  initial_xZ.initi
-00003d40: 616c 5f79 727f 0000 0072 8000 0000 7281  al_yr....r....r.
-00003d50: 0000 00da 0372 6573 da06 6f72 6967 696e  .....res..origin
-00003d60: 7219 0000 0072 1900 0000 721a 0000 00da  r....r....r.....
-00003d70: 0a67 6574 5f6f 7269 6769 6e15 0200 0073  .get_origin....s
-00003d80: 1600 0000 0001 100d 0e01 0e01 0e01 1e01  ................
-00003d90: 1e01 0401 0aff 0603 0601 72c2 0000 0063  ..........r....c
-00003da0: 0400 0000 0000 0000 0000 0000 0f00 0000  ................
-00003db0: 0a00 0000 4300 0000 7322 0100 0074 00a0  ....C...s"...t..
-00003dc0: 0174 00a0 027c 0364 0119 007c 0364 0219  .t...|.d...|.d..
-00003dd0: 00a1 02a1 017d 0474 006a 03a0 047c 0364  .....}.t.j...|.d
-00003de0: 0119 007c 0364 0219 0066 02a1 017d 0574  ...|.d...f...}.t
-00003df0: 00a0 0174 00a0 027c 0364 0319 007c 0364  ...t...|.d...|.d
-00003e00: 0419 00a1 02a1 017d 0674 006a 03a0 047c  .......}.t.j...|
-00003e10: 0364 0319 007c 0364 0419 0066 02a1 017d  .d...|.d...f...}
-00003e20: 077c 017c 027c 047c 0666 0466 0164 0564  .|.|.|.|.f.f.d.d
-00003e30: 0684 017d 0874 00a0 057c 057c 0766 02a1  ...}.t...|.|.f..
-00003e40: 017d 097c 0964 077c 0914 0018 007d 0a7c  .}.|.d.|.....}.|
-00003e50: 0964 077c 0914 0017 007d 0b74 066a 077c  .d.|.....}.t.j.|
-00003e60: 087c 097c 0a7c 0b66 0264 088d 037d 0c7c  .|.|.|.f.d...}.|
-00003e70: 0c6a 087d 0d74 00a0 057c 0d64 0919 0074  .j.}.t...|.d...t
-00003e80: 00a0 0974 00a0 0a7c 04a1 01a1 0114 007c  ...t...|.......|
-00003e90: 0d64 0919 0074 00a0 0b74 00a0 0a7c 04a1  .d...t...t...|..
-00003ea0: 01a1 0114 0066 027c 0d64 0a19 0074 00a0  .....f.|.d...t..
-00003eb0: 0974 00a0 0a7c 06a1 01a1 0114 007c 0d64  .t...|.......|.d
-00003ec0: 0a19 0074 00a0 0b74 00a0 0a7c 06a1 01a1  ...t...t...|....
-00003ed0: 0114 0066 0266 02a1 017d 0e7c 0e53 0029  ...f.f...}.|.S.)
-00003ee0: 0b4e a902 7201 0000 0072 0d00 0000 a902  .N..r....r......
-00003ef0: 7201 0000 0072 0100 0000 a902 720d 0000  r....r......r...
-00003f00: 0072 0d00 0000 a902 720d 0000 0072 0100  .r......r....r..
-00003f10: 0000 6302 0000 0000 0000 0000 0000 000b  ..c.............
-00003f20: 0000 000a 0000 0053 0000 0073 8c01 0000  .......S...s....
-00003f30: 7c00 6401 1900 7d02 7c00 6402 1900 7d03  |.d...}.|.d...}.
-00003f40: 7c01 6401 1900 7d04 7c01 6402 1900 7d05  |.d...}.|.d...}.
-00003f50: 7c01 6403 1900 7d06 7c01 6404 1900 7d07  |.d...}.|.d...}.
-00003f60: 7400 a001 7c02 7400 a002 7400 a003 7c06  t...|.t...t...|.
-00003f70: a101 a101 1400 7c02 7400 a004 7400 a003  ......|.t...t...
-00003f80: 7c06 a101 a101 1400 6602 7c03 7400 a002  |.......f.|.t...
-00003f90: 7400 a003 7c07 a101 a101 1400 7c03 7400  t...|.......|.t.
-00003fa0: a004 7400 a003 7c07 a101 a101 1400 6602  ..t...|.......f.
-00003fb0: 6602 a101 7d08 7400 a005 7c04 6a06 6401  f...}.t...|.j.d.
-00003fc0: 1900 6405 6602 a101 7d09 7c04 6400 6400  ..d.f...}.|.d.d.
-00003fd0: 8502 6401 6403 8502 6602 1900 7c05 6401  ..d.d...f...|.d.
-00003fe0: 6403 8502 1900 1800 7c09 6400 6400 8502  d.......|.d.d...
-00003ff0: 6401 6403 8502 6602 3c00 7c09 6400 6400  d.d...f.<.|.d.d.
-00004000: 8502 6401 6403 8502 6602 1900 7400 6a07  ..d.d...f...t.j.
-00004010: a008 7c08 a101 1000 7c09 6400 6400 8502  ..|.....|.d.d...
-00004020: 6403 6406 8502 6602 3c00 7400 a009 7c09  d.d...f.<.t...|.
-00004030: 6400 6400 8502 6403 6406 8502 6602 1900  d.d...d.d...f...
-00004040: a101 7c09 6400 6400 8502 6406 6405 8502  ..|.d.d...d.d...
-00004050: 6602 3c00 7400 a00a 7400 a00b 7c09 6400  f.<.t...t...|.d.
-00004060: 6400 8502 6404 6602 1900 7c09 6400 6400  d...d.f...|.d.d.
-00004070: 8502 6407 6602 1900 1800 a101 a101 6403  ..d.f.........d.
-00004080: 1300 7400 a00a 7400 a00b 7c09 6400 6400  ..t...t...|.d.d.
-00004090: 8502 6403 6602 1900 7c09 6400 6400 8502  ..d.f...|.d.d...
-000040a0: 6406 6602 1900 1800 a101 a101 6403 1300  d.f.........d...
-000040b0: 1700 6408 1300 7d0a 7c0a 5300 2909 4e72  ..d...}.|.S.).Nr
-000040c0: 0100 0000 720d 0000 0072 0c00 0000 7221  ....r....r....r!
-000040d0: 0000 0072 b500 0000 725a 0000 0072 5d00  ...r....rZ...r].
-000040e0: 0000 7210 0000 0029 0c72 1100 0000 726d  ..r....).r....rm
-000040f0: 0000 0072 b000 0000 72b1 0000 0072 b200  ...r....r....r..
-00004100: 0000 7263 0000 0072 6700 0000 72ae 0000  ..rc...rg...r...
-00004110: 0072 b600 0000 72b7 0000 0072 aa00 0000  .r....r....r....
-00004120: 7268 0000 0029 0b5a 0a63 6f6f 7264 5f76  rh...).Z.coord_v
-00004130: 616c 7372 b800 0000 5a05 6d61 675f 745a  alsr....Z.mag_tZ
-00004140: 056d 6167 5f62 7241 0000 005a 0572 6967  .mag_brA...Z.rig
-00004150: 696e 5a05 616e 675f 745a 0561 6e67 5f62  inZ.ang_tZ.ang_b
-00004160: 5a09 7879 5f63 6f6f 7264 7372 b900 0000  Z.xy_coordsr....
-00004170: 72ba 0000 0072 1900 0000 7219 0000 0072  r....r....r....r
-00004180: 1a00 0000 da0f 636f 6f72 6473 5f66 756e  ......coords_fun
-00004190: 6374 696f 6e35 0200 0073 2a00 0000 0001  ction5...s*.....
-000041a0: 0801 0801 0801 0801 0801 0801 0402 2601  ..............&.
-000041b0: 26fe 02ff 0406 1401 3001 3001 2a02 2e01  &.......0.0.*...
-000041c0: 2eff 0202 02fd 0404 7a23 6765 745f 636f  ........z#get_co
-000041d0: 6f72 6473 2e3c 6c6f 6361 6c73 3e2e 636f  ords.<locals>.co
-000041e0: 6f72 6473 5f66 756e 6374 696f 6e72 8900  ords_functionr..
-000041f0: 0000 72bc 0000 0072 0100 0000 720d 0000  ..r....r....r...
-00004200: 0029 0c72 1100 0000 72ac 0000 005a 0761  .).r....r....Z.a
-00004210: 7263 7461 6e32 72ae 0000 0072 af00 0000  rctan2r....r....
-00004220: 726d 0000 0072 6a00 0000 72bd 0000 0072  rm...rj...r....r
-00004230: be00 0000 72b0 0000 0072 b100 0000 72b2  ....r....r....r.
-00004240: 0000 0029 0f72 a600 0000 72bf 0000 0072  ...).r....r....r
-00004250: c100 0000 5a0e 6375 7272 656e 745f 636f  ....Z.current_co
-00004260: 6f72 6473 5a05 616e 675f 315a 056d 6167  ordsZ.ang_1Z.mag
-00004270: 5f31 5a05 616e 675f 325a 056d 6167 5f32  _1Z.ang_2Z.mag_2
-00004280: 72c7 0000 0072 7f00 0000 7280 0000 0072  r....r....r....r
-00004290: 8100 0000 72c0 0000 005a 036d 6167 5a0a  ....r....Z.magZ.
-000042a0: 6e65 775f 636f 6f72 6473 7219 0000 0072  new_coordsr....r
-000042b0: 1900 0000 721a 0000 00da 0a67 6574 5f63  ....r......get_c
-000042c0: 6f6f 7264 732f 0200 0073 2400 0000 0001  oords/...s$.....
-000042d0: 1a01 1801 1a01 1802 1417 0e01 0c01 0c01  ................
-000042e0: 0401 0aff 0603 0601 0402 2e01 2efe 02ff  ................
-000042f0: 0406 72c8 0000 0063 0300 0000 0000 0000  ..r....c........
-00004300: 0000 0000 0400 0000 0600 0000 4300 0000  ............C...
-00004310: 731e 0100 0074 00a0 017c 006a 0264 0119  s....t...|.j.d..
-00004320: 0064 0266 02a1 017d 037c 0064 0364 0385  .d.f...}.|.d.d..
-00004330: 0264 0164 0485 0266 0219 007c 0264 0164  .d.d...f...|.d.d
-00004340: 0485 0219 0018 007c 0364 0364 0385 0264  .......|.d.d...d
-00004350: 0164 0485 0266 023c 007c 0364 0364 0385  .d...f.<.|.d.d..
-00004360: 0264 0164 0485 0266 0219 0074 006a 03a0  .d.d...f...t.j..
-00004370: 047c 01a1 0110 007c 0364 0364 0385 0264  .|.....|.d.d...d
-00004380: 0464 0585 0266 023c 007c 0064 0364 0385  .d...f.<.|.d.d..
-00004390: 0264 0164 0485 0266 0219 007c 0364 0364  .d.d...f...|.d.d
-000043a0: 0385 0264 0164 0485 0266 023c 0074 00a0  ...d.d...f.<.t..
-000043b0: 057c 0364 0364 0385 0264 0464 0585 0266  .|.d.d...d.d...f
-000043c0: 0219 00a1 017c 0364 0364 0385 0264 0564  .....|.d.d...d.d
-000043d0: 0685 0266 023c 007c 0364 0364 0385 0264  ...f.<.|.d.d...d
-000043e0: 0564 0685 0266 0219 007c 0110 007c 0364  .d...f...|...|.d
-000043f0: 0364 0385 0264 0664 0285 0266 023c 007c  .d...d.d...f.<.|
-00004400: 0364 0364 0385 0264 0664 0285 0266 0219  .d.d...d.d...f..
-00004410: 007c 0264 0164 0485 0219 0017 007c 0364  .|.d.d.......|.d
-00004420: 0364 0385 0264 0664 0285 0266 023c 007c  .d...d.d...f.<.|
-00004430: 0353 0029 0761 fa01 0000 0a20 2020 2043  .S.).a.....    C
-00004440: 6f6e 7665 7274 2061 746f 6d20 706f 7369  onvert atom posi
-00004450: 7469 6f6e 7320 746f 2063 6f6f 7264 696e  tions to coordin
-00004460: 6174 6573 0a0a 2020 2020 5061 7261 6d65  ates..    Parame
-00004470: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-00004480: 2d2d 2d0a 2020 2020 7065 616b 733a 2020  ---.    peaks:  
-00004490: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-000044a0: 2020 2020 4c69 7374 206f 6620 4761 7573      List of Gaus
-000044b0: 7369 616e 2066 6974 7465 6420 7065 616b  sian fitted peak
-000044c0: 730a 2020 2020 636f 6f72 6473 3a20 6e64  s.    coords: nd
-000044d0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-000044e0: 2020 436f 2d6f 7264 696e 6174 6573 206f    Co-ordinates o
-000044f0: 6620 7468 6520 6178 6573 0a0a 2020 2020  f the axes..    
-00004500: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-00004510: 2d2d 2d0a 2020 2020 6174 6f6d 5f63 6f6f  ---.    atom_coo
-00004520: 7264 733a 206e 6461 7272 6179 0a20 2020  rds: ndarray.   
-00004530: 2020 2020 2020 2020 2020 2020 2020 5065                Pe
-00004540: 616b 2070 6f73 6974 696f 6e73 2061 7320  ak positions as 
-00004550: 7468 6520 6174 6f6d 2063 6f6f 7264 696e  the atom coordin
-00004560: 6174 6573 0a0a 2020 2020 4e6f 7465 730a  ates..    Notes.
-00004570: 2020 2020 2d2d 2d2d 2d0a 2020 2020 4f6e      -----.    On
-00004580: 6520 6174 6f6d 2069 7320 6368 6f73 656e  e atom is chosen
-00004590: 2061 7320 7468 6520 6f72 6967 696e 2061   as the origin a
-000045a0: 6e64 2074 6865 2063 6f2d 6f72 6469 6e61  nd the co-ordina
-000045b0: 7465 730a 2020 2020 6f66 2061 6c6c 2074  tes.    of all t
-000045c0: 6865 2061 746f 6d73 2061 7265 2063 616c  he atoms are cal
-000045d0: 6375 6c61 7465 6420 7769 7468 2072 6573  culated with res
-000045e0: 7065 6374 2074 6f20 7468 6520 6f72 6967  pect to the orig
-000045f0: 696e 0a0a 2020 2020 3a41 7574 686f 7273  in..    :Authors
-00004600: 3a0a 2020 2020 4465 6261 6e67 7368 7520  :.    Debangshu 
-00004610: 4d75 6b68 6572 6a65 6520 3c6d 756b 6865  Mukherjee <mukhe
-00004620: 726a 6565 6440 6f72 6e6c 2e67 6f76 3e0a  rjeed@ornl.gov>.
-00004630: 2020 2020 7201 0000 00e9 0800 0000 4e72      r.........Nr
-00004640: 0c00 0000 725a 0000 0072 b500 0000 2906  ....rZ...r....).
-00004650: 7211 0000 0072 6300 0000 7267 0000 0072  r....rc...rg...r
-00004660: ae00 0000 72b6 0000 0072 b700 0000 2904  ....r....r....).
-00004670: 7241 0000 0072 b300 0000 72c1 0000 0072  rA...r....r....r
-00004680: b900 0000 7219 0000 0072 1900 0000 721a  ....r....r....r.
-00004690: 0000 00da 0f63 6f6f 7264 735f 6f66 5f61  .....coords_of_a
-000046a0: 746f 6d73 5c02 0000 7310 0000 0000 1814  toms\...s.......
-000046b0: 0130 0130 0124 012a 0128 0130 0172 ca00  .0.0.$.*.(.0.r..
-000046c0: 0000 6303 0000 0000 0000 0000 0000 0018  ..c.............
-000046d0: 0000 0009 0000 0043 0000 0073 ea03 0000  .......C...s....
-000046e0: 7400 a001 6401 a101 0100 7c00 6a02 6402  t...d.....|.j.d.
-000046f0: 1900 7d03 7403 a004 7c03 6403 6602 a101  ..}.t...|.d.f...
-00004700: 7d04 7403 a004 7c03 6404 6602 a101 7d05  }.t...|.d.f...}.
-00004710: 7405 7c03 8301 4400 9001 5dda 7d06 7c00  t.|...D...].}.|.
-00004720: 7c06 6402 6405 8502 6602 1900 7d07 7c07  |.d.d...f...}.|.
-00004730: 7c01 6402 6400 6400 8502 6602 1900 1700  |.d.d.d...f.....
-00004740: 7d08 7c07 7c01 6406 6400 6400 8502 6602  }.|.|.d.d.d...f.
-00004750: 1900 1700 7d09 7c07 7c01 6402 6400 6400  ....}.|.|.d.d.d.
-00004760: 8502 6602 1900 1700 7c01 6406 6400 6400  ..f.....|.d.d.d.
-00004770: 8502 6602 1900 1700 7d0a 7c00 6400 6400  ..f.....}.|.d.d.
-00004780: 8502 6402 6602 1900 7c08 6402 1900 1800  ..d.f...|.d.....
-00004790: 6405 1300 7c00 6400 6400 8502 6406 6602  d...|.d.d...d.f.
-000047a0: 1900 7c08 6406 1900 1800 6405 1300 1700  ..|.d.....d.....
-000047b0: 7d0b 7c00 7c0b 7403 a006 7c0b a101 6b02  }.|.|.t...|...k.
-000047c0: 6402 6405 8502 6602 1900 6402 1900 7d08  d.d...f...d...}.
-000047d0: 7403 6a07 a008 7c08 7c07 1800 a101 7d0c  t.j...|.|.....}.
-000047e0: 7c00 6400 6400 8502 6402 6602 1900 7c09  |.d.d...d.f...|.
-000047f0: 6402 1900 1800 6405 1300 7c00 6400 6400  d.....d...|.d.d.
-00004800: 8502 6406 6602 1900 7c09 6406 1900 1800  ..d.f...|.d.....
-00004810: 6405 1300 1700 7d0d 7c00 7c0d 7403 a006  d.....}.|.|.t...
-00004820: 7c0d a101 6b02 6402 6405 8502 6602 1900  |...k.d.d...f...
-00004830: 6402 1900 7d09 7403 6a07 a008 7c09 7c07  d...}.t.j...|.|.
-00004840: 1800 a101 7d0e 7c00 6400 6400 8502 6402  ....}.|.d.d...d.
-00004850: 6602 1900 7c0a 6402 1900 1800 6405 1300  f...|.d.....d...
-00004860: 7c00 6400 6400 8502 6406 6602 1900 7c0a  |.d.d...d.f...|.
-00004870: 6406 1900 1800 6405 1300 1700 7d0f 7c00  d.....d.....}.|.
-00004880: 7c0f 7403 a006 7c0f a101 6b02 6402 6405  |.t...|...k.d.d.
-00004890: 8502 6602 1900 6402 1900 7d0a 7403 6a07  ..f...d...}.t.j.
-000048a0: a008 7c0a 7c07 1800 a101 7d10 7403 a009  ..|.|.....}.t...
-000048b0: 7403 a00a 7c07 7c08 7c09 7c0a 6604 a101  t...|.|.|.|.f...
-000048c0: a101 7c04 7c06 6400 6400 8502 6602 3c00  ..|.|.d.d...f.<.
-000048d0: 7403 a009 7403 a00a 6402 7c0c 7c0e 7c10  t...t...d.|.|.|.
-000048e0: 6604 a101 a101 7c05 7c06 6400 6400 8502  f.....|.|.d.d...
-000048f0: 6602 3c00 7138 7403 6a07 a008 7c01 6402  f.<.q8t.j...|.d.
-00004900: 6400 6400 8502 6602 1900 a101 7d11 7403  d.d...f.....}.t.
-00004910: a00a 7c11 6406 7c02 1800 1400 7c11 6406  ..|.d.|.....|.d.
-00004920: 7c02 1700 1400 6602 a101 7d12 7403 6a07  |.....f...}.t.j.
-00004930: a008 7c01 6406 6400 6400 8502 6602 1900  ..|.d.d.d...f...
-00004940: a101 7d13 7403 a00a 7c13 6406 7c02 1800  ..}.t...|.d.|...
-00004950: 1400 7c13 6406 7c02 1700 1400 6602 a101  ..|.d.|.....f...
-00004960: 7d14 7403 6a07 a008 7c01 6402 6400 6400  }.t.j...|.d.d.d.
-00004970: 8502 6602 1900 7c01 6406 6400 6400 8502  ..f...|.d.d.d...
-00004980: 6602 1900 1700 a101 7d15 7403 a00a 7c15  f.......}.t...|.
-00004990: 6406 7c02 1800 1400 7c15 6406 7c02 1700  d.|.....|.d.|...
-000049a0: 1400 6602 a101 7d16 7c05 6400 6400 8502  ..f...}.|.d.d...
-000049b0: 6406 6602 1900 7d17 6402 7c17 7c17 7c12  d.f...}.d.|.|.|.
-000049c0: 6406 1900 6b04 3c00 6402 7c17 7c17 7c12  d...k.<.d.|.|.|.
-000049d0: 6402 1900 6b00 3c00 7403 6a0b 7c17 7c17  d...k.<.t.j.|.|.
-000049e0: 6402 6b02 3c00 7c17 7c05 6400 6400 8502  d.k.<.|.|.d.d...
-000049f0: 6406 6602 3c00 7c05 6400 6400 8502 6405  d.f.<.|.d.d...d.
-00004a00: 6602 1900 7d17 6402 7c17 7c17 7c14 6406  f...}.d.|.|.|.d.
-00004a10: 1900 6b04 3c00 6402 7c17 7c17 7c14 6402  ..k.<.d.|.|.|.d.
-00004a20: 1900 6b00 3c00 7403 6a0b 7c17 7c17 6402  ..k.<.t.j.|.|.d.
-00004a30: 6b02 3c00 7c17 7c05 6400 6400 8502 6405  k.<.|.|.d.d...d.
-00004a40: 6602 3c00 7c05 6400 6400 8502 6407 6602  f.<.|.d.d...d.f.
-00004a50: 1900 7d17 6402 7c17 7c17 7c16 6406 1900  ..}.d.|.|.|.d...
-00004a60: 6b04 3c00 6402 7c17 7c17 7c16 6402 1900  k.<.d.|.|.|.d...
-00004a70: 6b00 3c00 7403 6a0b 7c17 7c17 6402 6b02  k.<.t.j.|.|.d.k.
-00004a80: 3c00 7c17 7c05 6400 6400 8502 6407 6602  <.|.|.d.d...d.f.
-00004a90: 3c00 7c04 7403 a00c 7c05 a101 6a0d 6406  <.|.t...|...j.d.
-00004aa0: 6408 8d01 0f00 1900 7d04 7c05 7403 a00c  d.......}.|.t...
-00004ab0: 7c05 a101 6a0d 6406 6408 8d01 0f00 1900  |...j.d.d.......
-00004ac0: 7d05 7c04 7c05 6602 5300 2909 4e72 4300  }.|.|.f.S.).NrC.
-00004ad0: 0000 7201 0000 0072 c900 0000 725a 0000  ..r....r....rZ..
-00004ae0: 0072 0c00 0000 720d 0000 0072 2100 0000  .r....r....r!...
-00004af0: 720e 0000 0029 0e72 4500 0000 7246 0000  r....).rE...rF..
-00004b00: 0072 6700 0000 7211 0000 0072 6300 0000  .rg...r....rc...
-00004b10: 7235 0000 0072 2a00 0000 72ae 0000 0072  r5...r*...r....r
-00004b20: af00 0000 da05 7261 7665 6c72 6d00 0000  ......ravelrm...
-00004b30: da03 6e61 6eda 0569 736e 616e da03 616e  ..nan..isnan..an
-00004b40: 7929 185a 0970 6561 6b5f 6c69 7374 72b3  y).Z.peak_listr.
-00004b50: 0000 00da 0564 656c 7461 da08 6e6f 5f61  .....delta..no_a
-00004b60: 746f 6d73 5a0f 6174 6f6d 735f 6e65 6967  tomsZ.atoms_neig
-00004b70: 6862 6f72 735a 0f61 746f 6d73 5f64 6973  hborsZ.atoms_dis
-00004b80: 7461 6e63 6573 7217 0000 005a 0861 746f  tancesr....Z.ato
-00004b90: 6d5f 706f 735a 086e 6569 6768 5f79 795a  m_posZ.neigh_yyZ
-00004ba0: 086e 6569 6768 5f78 785a 086e 6569 6768  .neigh_xxZ.neigh
-00004bb0: 5f78 795a 0870 6172 6e62 5f79 795a 086e  _xyZ.parnb_yyZ.n
-00004bc0: 6469 7374 5f79 795a 0870 6172 6e62 5f78  dist_yyZ.parnb_x
-00004bd0: 785a 086e 6469 7374 5f78 785a 0870 6172  xZ.ndist_xxZ.par
-00004be0: 6e62 5f78 795a 086e 6469 7374 5f78 795a  nb_xyZ.ndist_xyZ
-00004bf0: 0779 795f 6469 7374 5a07 7979 5f6c 6973  .yy_distZ.yy_lis
-00004c00: 745a 0778 785f 6469 7374 5a07 7878 5f6c  tZ.xx_distZ.xx_l
-00004c10: 6973 745a 0778 795f 6469 7374 5a07 7879  istZ.xy_distZ.xy
-00004c20: 5f6c 6973 74da 0270 7072 1900 0000 7219  _list..ppr....r.
-00004c30: 0000 0072 1a00 0000 da0f 7468 7265 655f  ...r......three_
-00004c40: 6e65 6967 6862 6f72 737e 0200 0073 6800  neighbors~...sh.
-00004c50: 0000 0001 0a01 0a01 0e01 0e01 0e01 1001  ................
-00004c60: 1401 1401 2401 1a01 1aff 0403 1e01 1001  ....$...........
-00004c70: 1a01 1aff 0403 1e01 1001 1a01 1aff 0403  ................
-00004c80: 1e01 1001 0401 10ff 1003 2601 1801 1e01  ..........&.....
-00004c90: 1801 1e01 2801 1e01 1001 1001 1001 0e01  ....(...........
-00004ca0: 1001 1001 1001 1001 0e01 1001 1001 1001  ................
-00004cb0: 1001 0e01 1001 1801 1801 72d2 0000 0063  ..........r....c
-00004cc0: 0200 0000 0000 0000 0000 0000 1000 0000  ................
-00004cd0: 0600 0000 4300 0000 7330 0200 0074 00a0  ....C...s0...t..
-00004ce0: 0164 01a1 0101 0074 02a0 0364 02a1 017d  .d.....t...d...}
-00004cf0: 0274 02a0 0364 03a1 017d 0374 02a0 047c  .t...d...}.t...|
-00004d00: 00a1 0164 0419 007d 0474 026a 05a0 067c  ...d...}.t.j...|
-00004d10: 01a1 017d 0574 02a0 077c 0464 0566 02a1  ...}.t...|.d.f..
-00004d20: 017d 0674 02a0 077c 04a1 017d 0774 02a0  .}.t...|...}.t..
-00004d30: 077c 04a1 017d 0874 02a0 077c 04a1 017d  .|...}.t...|...}
-00004d40: 0974 02a0 077c 04a1 017d 0a74 087c 0483  .t...|...}.t.|..
-00004d50: 0144 0090 015d a87d 0b74 02a0 0764 06a1  .D...].}.t...d..
-00004d60: 017d 0c7c 007c 0b64 0464 0585 0266 0219  .}.|.|.d.d...f..
-00004d70: 007c 007c 0b64 0464 0585 0266 0219 0018  .|.|.d.d...f....
-00004d80: 007c 0c64 0464 0064 0085 0266 023c 007c  .|.d.d.d...f.<.|
-00004d90: 007c 0b64 0564 0785 0266 0219 007c 007c  .|.d.d...f...|.|
-00004da0: 0b64 0464 0585 0266 0219 0018 007c 0c64  .d.d...f.....|.d
-00004db0: 0864 0064 0085 0266 023c 007c 007c 0b64  .d.d...f.<.|.|.d
-00004dc0: 0764 0985 0266 0219 007c 007c 0b64 0464  .d...f...|.|.d.d
-00004dd0: 0585 0266 0219 0018 007c 0c64 0564 0064  ...f.....|.d.d.d
-00004de0: 0085 0266 023c 007c 007c 0b64 0964 0a85  ...f.<.|.|.d.d..
-00004df0: 0266 0219 007c 007c 0b64 0464 0585 0266  .f...|.|.d.d...f
-00004e00: 0219 0018 007c 0c64 0b64 0064 0085 0266  .....|.d.d.d...f
-00004e10: 023c 0074 026a 056a 097c 037c 0c64 0064  .<.t.j.j.|.|.d.d
-00004e20: 0c8d 035c 047d 0d7d 0e7d 0e7d 0e74 02a0  ...\.}.}.}.}.t..
-00004e30: 0a7c 0d7c 05a1 027c 0218 007d 0f7c 0f64  .|.|...|...}.|.d
-00004e40: 0d19 007c 097c 0b3c 007c 0f64 0e19 007c  ...|.|.<.|.d...|
-00004e50: 077c 0b3c 0064 0f7c 0f64 1019 007c 0f64  .|.<.d.|.d...|.d
-00004e60: 1119 0017 0014 007c 087c 0b3c 0064 0f7c  .......|.|.<.d.|
-00004e70: 0f64 1019 007c 0f64 1119 0018 0014 007c  .d...|.d.......|
-00004e80: 0a7c 0b3c 0064 127c 007c 0b64 0466 0219  .|.<.d.|.|.d.f..
-00004e90: 007c 007c 0b64 0566 0219 0017 007c 007c  .|.|.d.f.....|.|
-00004ea0: 0b64 0766 0219 0017 007c 007c 0b64 0966  .d.f.....|.|.d.f
-00004eb0: 0219 0017 0014 007c 067c 0b64 0466 023c  .......|.|.d.f.<
-00004ec0: 0064 127c 007c 0b64 0866 0219 007c 007c  .d.|.|.d.f...|.|
-00004ed0: 0b64 0b66 0219 0017 007c 007c 0b64 1366  .d.f.....|.|.d.f
-00004ee0: 0219 0017 007c 007c 0b64 1466 0219 0017  .....|.|.d.f....
-00004ef0: 0014 007c 067c 0b64 0866 023c 0071 767c  ...|.|.d.f.<.qv|
-00004f00: 067c 097c 077c 087c 0a66 0553 0029 154e  .|.|.|.|.f.S.).N
-00004f10: 7243 0000 0029 0272 c600 0000 72c3 0000  rC...).r....r...
-00004f20: 0029 0472 c400 0000 72c6 0000 0072 c300  .).r....r....r..
-00004f30: 0000 72c5 0000 0072 0100 0000 720c 0000  ..r....r....r...
-00004f40: 0029 0272 5a00 0000 720c 0000 0072 5a00  .).rZ...r....rZ.
-00004f50: 0000 720d 0000 0072 b500 0000 72c9 0000  ..r....r....r...
-00004f60: 0072 2100 0000 2901 5a05 7263 6f6e 6472  .r!...).Z.rcondr
-00004f70: c400 0000 72c5 0000 0072 1000 0000 72c3  ....r....r....r.
-00004f80: 0000 0072 c600 0000 7289 0000 0072 5d00  ...r....r....r].
-00004f90: 0000 7244 0000 0029 0b72 4500 0000 7246  ..rD...).rE...rF
-00004fa0: 0000 0072 1100 0000 726d 0000 0072 6700  ...r....rm...rg.
-00004fb0: 0000 72ae 0000 0072 b600 0000 7263 0000  ..r....r....rc..
-00004fc0: 0072 3500 0000 5a05 6c73 7473 71da 066d  .r5...Z.lstsq..m
-00004fd0: 6174 6d75 6c29 105a 066e 5f6c 6973 7472  atmul).Z.n_listr
-00004fe0: b300 0000 da08 6964 656e 7469 7479 5a08  ......identityZ.
-00004ff0: 6178 6973 5f70 6f73 72d0 0000 005a 0a63  axis_posr....Z.c
-00005000: 6f6f 7264 735f 696e 765a 0b63 656c 6c5f  oords_invZ.cell_
-00005010: 6365 6e74 6572 da04 655f 7878 da04 655f  center..e_xx..e_
-00005020: 7879 da04 655f 7979 da04 655f 7468 7217  xy..e_yy..e_thr.
-00005030: 0000 00da 0263 635a 046c 5f63 6372 8300  .....ccZ.l_ccr..
-00005040: 0000 5a04 745f 6363 7219 0000 0072 1900  ..Z.t_ccr....r..
-00005050: 0000 721a 0000 00da 0f72 656c 6174 6976  ..r......relativ
-00005060: 655f 7374 7261 696e b502 0000 733a 0000  e_strain....s:..
-00005070: 0000 010a 010a 010a 010e 010c 010e 010a  ................
-00005080: 010a 010a 010a 010e 010a 012c 012c 012c  ...........,.,.,
-00005090: 012c 011a 0110 010c 010c 0118 0118 0102  .,..............
-000050a0: 012e ff0c 0302 012e ff0e 0372 da00 0000  ...........r....
-000050b0: 6306 0000 0000 0000 0000 0000 0011 0000  c...............
-000050c0: 0009 0000 0043 0000 0073 a001 0000 7400  .....C...s....t.
-000050d0: 6a01 6401 7c05 6a02 6401 1900 8502 6401  j.d.|.j.d.....d.
-000050e0: 7c05 6a02 6402 1900 8502 6602 1900 5c02  |.j.d.....f...\.
-000050f0: 7d06 7d07 7403 7404 7c00 6400 6400 8502  }.}.t.t.|.d.d...
-00005100: 6402 6602 1900 7c00 6400 6400 8502 6401  d.f...|.d.d...d.
-00005110: 6602 1900 8302 8301 7d08 6401 7c01 7400  f.......}.d.|.t.
-00005120: a005 7c01 a101 6403 7400 a006 7400 a005  ..|...d.t...t...
-00005130: 7c01 a101 a101 1400 6b04 3c00 6401 7c02  |.......k.<.d.|.
-00005140: 7400 a005 7c02 a101 6403 7400 a006 7400  t...|...d.t...t.
-00005150: a005 7c02 a101 a101 1400 6b04 3c00 6401  ..|.......k.<.d.
-00005160: 7c03 7400 a005 7c03 a101 6403 7400 a006  |.t...|...d.t...
-00005170: 7400 a005 7c03 a101 a101 1400 6b04 3c00  t...|.......k.<.
-00005180: 6401 7c04 7400 a005 7c04 a101 6403 7400  d.|.t...|...d.t.
-00005190: a006 7400 a005 7c04 a101 a101 1400 6b04  ..t...|.......k.
-000051a0: 3c00 7407 a008 7c08 7c01 a102 7d09 7407  <.t...|.|...}.t.
-000051b0: a008 7c08 7c02 a102 7d0a 7407 a008 7c08  ..|.|...}.t...|.
-000051c0: 7c03 a102 7d0b 7407 a008 7c08 7c04 a102  |...}.t...|.|...
-000051d0: 7d0c 7c09 7c07 7c06 8302 7d0d 6401 7c0d  }.|.|.|...}.d.|.
-000051e0: 7400 a009 7c0d a101 3c00 7400 a00a 7c0d  t...|...<.t...|.
-000051f0: 7c05 a102 7d0d 7c0a 7c07 7c06 8302 7d0e  |...}.|.|.|...}.
-00005200: 6401 7c0e 7400 a009 7c0e a101 3c00 7400  d.|.t...|...<.t.
-00005210: a00a 7c0e 7c05 a102 7d0e 7c0b 7c07 7c06  ..|.|...}.|.|.|.
-00005220: 8302 7d0f 6401 7c0f 7400 a009 7c0f a101  ..}.d.|.t...|...
-00005230: 3c00 7400 a00a 7c0f 7c05 a102 7d0f 7c0c  <.t...|.|...}.|.
-00005240: 7c07 7c06 8302 7d10 6401 7c10 7400 a009  |.|...}.d.|.t...
-00005250: 7c10 a101 3c00 7400 a00a 7c10 7c05 a102  |...<.t...|.|...
-00005260: 7d10 7c0d 7c0e 7c0f 7c10 6604 5300 2904  }.|.|.|.|.f.S.).
-00005270: 4e72 0100 0000 720d 0000 0072 2100 0000  Nr....r....r!...
-00005280: 290b 7211 0000 0072 6600 0000 7267 0000  ).r....rf...rg..
-00005290: 00da 046c 6973 74da 037a 6970 7268 0000  ...list..ziprh..
-000052a0: 0072 4800 0000 da08 7363 696e 7465 7270  .rH.....scinterp
-000052b0: 5a14 4c69 6e65 6172 4e44 496e 7465 7270  Z.LinearNDInterp
-000052c0: 6f6c 6174 6f72 72cd 0000 0072 9300 0000  olatorr....r....
-000052d0: 2911 5a07 6365 6e74 6572 7372 d700 0000  ).Z.centersr....
-000052e0: 72d5 0000 0072 d600 0000 72d8 0000 00da  r....r....r.....
-000052f0: 046d 6173 6b5a 0279 725a 0278 725a 0963  .maskZ.yrZ.xrZ.c
-00005300: 6172 7463 6f6f 7264 5a04 665f 7979 5a04  artcoordZ.f_yyZ.
-00005310: 665f 7878 5a04 665f 7879 5a04 665f 7468  f_xxZ.f_xyZ.f_th
-00005320: 5a06 6d61 705f 7979 5a06 6d61 705f 7878  Z.map_yyZ.map_xx
-00005330: 5a06 6d61 705f 7879 5a06 6d61 705f 7468  Z.map_xyZ.map_th
-00005340: 7219 0000 0072 1900 0000 721a 0000 00da  r....r....r.....
-00005350: 0a73 7472 6169 6e5f 6d61 70d5 0200 0073  .strain_map....s
-00005360: 2e00 0000 0001 2601 2602 2201 2201 2201  ......&.&.".".".
-00005370: 2202 0c01 0c01 0c01 0c02 0a01 0e01 0c02  "...............
-00005380: 0a01 0e01 0c02 0a01 0e01 0c02 0a01 0e01  ................
-00005390: 0c02 72df 0000 0072 2100 0000 5463 0500  ..r....r!...Tc..
-000053a0: 0000 0000 0000 0000 0000 0d00 0000 0700  ................
-000053b0: 0000 4300 0000 7302 0100 0074 006a 01a0  ..C...s....t.j..
-000053c0: 0274 03a0 047c 00a1 017c 03a1 027d 0574  .t...|...|...}.t
-000053d0: 056a 06a0 077c 057c 0164 0119 007c 0164  .j...|.|.d...|.d
-000053e0: 0219 007c 02a1 047d 0674 036a 0874 03a0  ...|...}.t.j.t..
-000053f0: 097c 00a1 0174 0a64 038d 027d 0774 036a  .|...t.d...}.t.j
-00005400: 0b64 017c 0764 0119 0085 0264 017c 0764  .d.|.d.....d.|.d
-00005410: 0219 0085 0266 0219 005c 027d 087d 0974  .....f...\.}.}.t
-00005420: 03a0 0c7c 05a1 017d 0a7c 0472 b474 03a0  ...|...}.|.r.t..
-00005430: 0874 03a0 0d7c 0664 0164 0485 0219 00a1  .t...|.d.d......
-00005440: 01a1 017d 0b7c 087c 0b64 0119 0018 0064  ...}.|.|.d.....d
-00005450: 0413 007c 097c 0b64 0219 0018 0064 0413  ...|.|.d.....d..
-00005460: 0017 0064 0513 007c 026b 007d 0c6e 3a74  ...d...|.k.}.n:t
-00005470: 03a0 087c 0664 0164 0485 0219 00a1 017d  ...|.d.d.......}
-00005480: 0b7c 087c 0b64 0219 0018 0064 0413 007c  .|.|.d.....d...|
-00005490: 097c 0b64 0119 0018 0064 0413 0017 0064  .|.d.....d.....d
-000054a0: 0513 007c 026b 007d 0c7c 007c 0c19 007c  ...|.k.}.|.|...|
-000054b0: 0a7c 0c3c 007c 0a7c 0b66 0253 0029 0661  .|.<.|.|.f.S.).a
-000054c0: 0e05 0000 0a20 2020 2055 7365 2061 2047  .....    Use a G
-000054d0: 6175 7373 6961 6e20 626c 7572 7265 6420  aussian blurred 
-000054e0: 696d 6167 6520 746f 2066 6974 0a20 2020  image to fit.   
-000054f0: 2070 6561 6b73 2e0a 0a20 2020 2050 6172   peaks...    Par
-00005500: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00005510: 2d2d 2d2d 2d2d 0a20 2020 2069 6d61 6765  ------.    image
-00005520: 3a20 206e 6461 7272 6179 0a20 2020 2020  :  ndarray.     
-00005530: 2020 2020 2020 2032 4420 6172 7261 7920         2D array 
-00005540: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
-00005550: 2069 6d61 6765 0a20 2020 2063 656e 7465   image.    cente
-00005560: 723a 2074 7570 6c65 0a20 2020 2020 2020  r: tuple.       
-00005570: 2020 2020 2041 7070 726f 7869 6d61 7465       Approximate
-00005580: 206c 6f63 6174 696f 6e20 6173 2028 782c   location as (x,
-00005590: 7929 206f 660a 2020 2020 2020 2020 2020  y) of.          
-000055a0: 2020 7468 6520 7065 616b 2077 6520 6172    the peak we ar
-000055b0: 6520 7472 7969 6e67 2074 6f20 6669 740a  e trying to fit.
-000055c0: 2020 2020 7261 6469 7573 3a20 666c 6f61      radius: floa
-000055d0: 740a 2020 2020 2020 2020 2020 2020 4d61  t.            Ma
-000055e0: 736b 696e 6720 7261 6469 7573 0a20 2020  sking radius.   
-000055f0: 2067 5f76 616c 3a20 2066 6c6f 6174 0a20   g_val:  float. 
-00005600: 2020 2020 2020 2020 2020 2056 616c 7565             Value
-00005610: 2069 6e20 7069 7865 6c73 206f 6620 7468   in pixels of th
-00005620: 6520 4761 7573 7369 616e 0a20 2020 2020  e Gaussian.     
-00005630: 2020 2020 2020 2062 6c75 7220 6170 706c         blur appl
-00005640: 6965 642e 2044 6566 6175 6c74 2069 7320  ied. Default is 
-00005650: 330a 2020 2020 666c 6970 3a20 2020 626f  3.    flip:   bo
-00005660: 6f6c 0a20 2020 2020 2020 2020 2020 2053  ol.            S
-00005670: 7769 7463 6820 746f 2066 6c69 7020 7265  witch to flip re
-00005680: 6669 6e65 6420 6365 6e74 6572 2070 6f73  fined center pos
-00005690: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
-000056a0: 2020 6672 6f6d 2028 782c 7929 2074 6f20    from (x,y) to 
-000056b0: 2879 2c78 292e 2044 6566 6175 6c74 2069  (y,x). Default i
-000056c0: 7320 5472 7565 0a20 2020 2020 2020 2020  s True.         
-000056d0: 2020 2077 6869 6368 2072 6574 7572 6e73     which returns
-000056e0: 2074 6865 2063 656e 7465 7220 6173 2028   the center as (
-000056f0: 792c 7829 0a0a 0a20 2020 2052 6574 7572  y,x)...    Retur
-00005700: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-00005710: 2020 206d 6173 6b65 645f 696d 6167 653a     masked_image:
-00005720: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00005730: 2020 2020 2020 2020 2020 204d 6173 6b65             Maske
-00005740: 6420 496d 6167 6520 6365 6e74 6572 6564  d Image centered
-00005750: 2061 7420 7265 6669 6e65 640a 2020 2020   at refined.    
-00005760: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-00005770: 616b 2070 6f73 6974 696f 6e0a 2020 2020  ak position.    
-00005780: 6e65 775f 6365 6e74 6572 3a20 2020 6e64  new_center:   nd
-00005790: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-000057a0: 2020 2020 2020 2020 5265 6669 6e65 6420          Refined 
-000057b0: 6174 6f6d 2063 656e 7465 7220 6173 2028  atom center as (
-000057c0: 792c 7829 2069 660a 2020 2020 2020 2020  y,x) if.        
-000057d0: 2020 2020 2020 2020 2020 666c 6970 2073            flip s
-000057e0: 7769 7463 6820 6973 206f 6e2c 2065 6c73  witch is on, els
-000057f0: 6520 7468 6520 6365 6e74 6572 0a20 2020  e the center.   
-00005800: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00005810: 7320 7265 7475 726e 6564 2061 7320 2878  s returned as (x
-00005820: 2c79 290a 0a20 2020 204e 6f74 6573 0a20  ,y)..    Notes. 
-00005830: 2020 202d 2d2d 2d2d 0a20 2020 2046 6f72     -----.    For
-00005840: 2073 6f6d 6520 6e6f 6973 7920 6461 7461   some noisy data
-00005850: 7365 7473 2c20 6120 7065 616b 206d 6179  sets, a peak may
-00005860: 2062 6520 7669 7369 626c 6520 7769 7468   be visible with
-00005870: 0a20 2020 2074 6865 2068 756d 616e 2065  .    the human e
-00005880: 7965 2c20 6275 7420 6765 7474 696e 6720  ye, but getting 
-00005890: 6120 7375 622d 7069 7865 6c20 6573 7469  a sub-pixel esti
-000058a0: 6d61 7469 6f6e 206f 660a 2020 2020 7468  mation of.    th
-000058b0: 6520 7065 616b 2070 6f73 6974 696f 6e20  e peak position 
-000058c0: 6973 206f 6674 656e 2063 6861 6c6c 656e  is often challen
-000058d0: 6769 6e67 2c20 6573 7065 6369 616c 6c79  ging, especially
-000058e0: 0a20 2020 2066 6f72 2046 4654 2066 6f72  .    for FFT for
-000058f0: 2064 6966 6672 6163 7469 6f6e 2070 6174   diffraction pat
-00005900: 7465 726e 732e 2054 6869 7320 636f 6465  terns. This code
-00005910: 2047 6175 7373 6961 6e0a 2020 2020 626c   Gaussian.    bl
-00005920: 7572 7320 7468 6520 696d 6167 652c 2061  urs the image, a
-00005930: 6e64 2072 6574 7572 6e73 2074 6865 2072  nd returns the r
-00005940: 6566 696e 6564 2070 6561 6b20 706f 7369  efined peak posi
-00005950: 7469 6f6e 0a0a 2020 2020 5365 6520 616c  tion..    See al
-00005960: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
-00005970: 2020 2020 7374 2e75 7469 6c2e 6669 745f      st.util.fit_
-00005980: 6761 7573 7369 616e 3244 5f6d 6173 6b0a  gaussian2D_mask.
-00005990: 0a20 2020 203a 4175 7468 6f72 733a 0a20  .    :Authors:. 
-000059a0: 2020 2044 6562 616e 6773 6875 204d 756b     Debangshu Muk
-000059b0: 6865 726a 6565 203c 6d75 6b68 6572 6a65  herjee <mukherje
-000059c0: 6564 406f 726e 6c2e 676f 763e 0a0a 2020  ed@ornl.gov>..  
-000059d0: 2020 7201 0000 0072 0d00 0000 7220 0000    r....r....r ..
-000059e0: 0072 0c00 0000 7210 0000 0029 0e72 3100  .r....r....).r1.
-000059f0: 0000 7290 0000 0072 9100 0000 7211 0000  ..r....r....r...
-00005a00: 0072 6800 0000 7249 0000 0072 4a00 0000  .rh...rI...rJ...
-00005a10: 724b 0000 0072 6d00 0000 7267 0000 0072  rK...rm...rg...r
-00005a20: 3000 0000 7266 0000 0072 6500 0000 724c  0...rf...re...rL
-00005a30: 0000 0029 0d72 a600 0000 7294 0000 0072  ...).r....r....r
-00005a40: 9500 0000 5a05 675f 7661 6c72 4c00 0000  ....Z.g_valrL...
-00005a50: 7297 0000 0072 9800 0000 729a 0000 0072  r....r....r....r
-00005a60: 9b00 0000 729c 0000 0072 9d00 0000 7299  ....r....r....r.
-00005a70: 0000 0072 7800 0000 7219 0000 0072 1900  ...rx...r....r..
-00005a80: 0000 721a 0000 00da 0f63 7265 6174 655f  ..r......create_
-00005a90: 6369 7263 6d61 736b f602 0000 7324 0000  circmask....s$..
-00005aa0: 0000 3114 0106 0110 ff04 0314 0122 010a  ..1.........."..
-00005ab0: 0104 0118 0222 0102 fe06 0412 0222 0102  ....."......."..
-00005ac0: fe04 030c 0172 e000 0000 6301 0000 0000  .....r....c.....
-00005ad0: 0000 0000 0000 0006 0000 0007 0000 0043  ...............C
-00005ae0: 0000 0073 a000 0000 7400 a001 6401 a101  ...s....t...d...
-00005af0: 0100 7402 7c00 8301 7d01 7403 6a04 7c01  ..t.|...}.t.j.|.
-00005b00: 7403 6a05 6402 8d02 7d02 7403 6a04 7c01  t.j.d...}.t.j.|.
-00005b10: 7403 6a05 6402 8d02 7d03 7403 a006 7c01  t.j.d...}.t...|.
-00005b20: a101 4400 5d50 7d04 7403 6a07 7c00 6400  ..D.]P}.t.j.|.d.
-00005b30: 6400 8502 6403 6404 8502 6602 1900 7c00  d...d.d...f...|.
-00005b40: 7c04 6403 6404 8502 6602 1900 1800 6404  |.d.d...f.....d.
-00005b50: 1300 6405 6406 8d02 7d03 7403 a008 7c03  ..d.d...}.t...|.
-00005b60: 7c03 6403 6b04 1900 a101 6407 1300 7c02  |.d.k.....d...|.
-00005b70: 7c04 3c00 713c 6407 7403 a009 7c02 a101  |.<.q<d.t...|...
-00005b80: 1400 7d05 7c05 5300 2908 4e72 4300 0000  ..}.|.S.).NrC...
-00005b90: 7220 0000 0072 0100 0000 720c 0000 0072  r ...r....r....r
-00005ba0: 0d00 0000 720e 0000 0072 1000 0000 290a  ....r....r....).
-00005bb0: 7245 0000 0072 4600 0000 7213 0000 0072  rE...rF...r....r
-00005bc0: 1100 0000 7247 0000 0072 2d00 0000 7264  ....rG...r-...rd
-00005bd0: 0000 0072 1400 0000 722a 0000 0072 4800  ...r....r*...rH.
-00005be0: 0000 2906 724e 0000 0072 4f00 0000 7218  ..).rN...rO...r.
-00005bf0: 0000 0072 5000 0000 7217 0000 0072 5100  ...rP...r....rQ.
-00005c00: 0000 7219 0000 0072 1900 0000 721a 0000  ..r....r....r...
-00005c10: 0072 5100 0000 3c03 0000 7312 0000 0000  .rQ...<...s.....
-00005c20: 010a 0108 0110 0110 010e 0132 011c 010e  ...........2....
-00005c30: 0172 5100 0000 6304 0000 0000 0000 0000  .rQ...c.........
-00005c40: 0000 0008 0000 0007 0000 0043 0000 0073  ...........C...s
-00005c50: 9a00 0000 7400 a001 6401 a101 0100 7402  ....t...d.....t.
-00005c60: a003 7404 7c01 8301 a101 4400 5d7c 7d04  ..t.|.....D.]|}.
-00005c70: 7c01 7c04 6402 6602 1900 7d05 7c01 7c04  |.|.d.f...}.|.|.
-00005c80: 6403 6602 1900 7d06 7405 6a06 a007 6402  d.f...}.t.j...d.
-00005c90: 7c00 1700 7c05 7c06 7c03 a104 7d07 7402  |...|.|.|...}.t.
-00005ca0: a008 7c07 6403 6404 8502 1900 a101 7c02  ..|.d.d.......|.
-00005cb0: 7c04 6403 6404 8502 6602 3c00 7c07 6404  |.d.d...f.<.|.d.
-00005cc0: 6405 8502 1900 7c02 7c04 6404 6405 8502  d.....|.|.d.d...
-00005cd0: 6602 3c00 7c07 6406 1900 6402 1800 7c02  f.<.|.d...d...|.
-00005ce0: 7c04 6406 6602 3c00 7118 6400 5300 2907  |.d.f.<.q.d.S.).
-00005cf0: 4e72 4300 0000 720d 0000 0072 0100 0000  NrC...r....r....
-00005d00: 720c 0000 0072 b500 0000 7262 0000 0029  r....r....rb...)
-00005d10: 0972 4500 0000 7246 0000 0072 1100 0000  .rE...rF...r....
-00005d20: 7264 0000 0072 1300 0000 7249 0000 0072  rd...r....rI...r
-00005d30: 4a00 0000 724b 0000 0072 4c00 0000 2908  J...rK...rL...).
-00005d40: 724d 0000 0072 4e00 0000 7252 0000 0072  rM...rN...rR...r
-00005d50: 5100 0000 7217 0000 0072 5300 0000 7254  Q...r....rS...rT
-00005d60: 0000 0072 5500 0000 7219 0000 0072 1900  ...rU...r....r..
-00005d70: 0000 721a 0000 0072 5600 0000 4803 0000  ..r....rV...H...
-00005d80: 7310 0000 0000 010a 0112 010c 010c 0116  s...............
-00005d90: 011e 0118 0163 0000 0000 0000 0000 0000  .....c..........
-00005da0: 0000 0000 0000 0300 0000 4000 0000 7348  ..........@...sH
-00005db0: 0000 0065 005a 0164 005a 0264 015a 0364  ...e.Z.d.Z.d.Z.d
-00005dc0: 0264 0384 005a 0464 1664 0764 0884 015a  .d...Z.d.d.d...Z
-00005dd0: 0564 1764 0a64 0b84 015a 0664 1864 0e64  .d.d.d...Z.d.d.d
-00005de0: 0f84 015a 0764 1064 1184 005a 0864 1964  ...Z.d.d...Z.d.d
-00005df0: 1364 1484 015a 0964 1553 0029 1ada 0861  .d...Z.d.S.)...a
-00005e00: 746f 6d5f 6669 7461 c106 0000 0a20 2020  tom_fita.....   
-00005e10: 204c 6f63 6174 6520 6174 6f6d 2063 6f6c   Locate atom col
-00005e20: 756d 6e73 2069 6e20 6174 6f6d 6963 2072  umns in atomic r
-00005e30: 6573 6f6c 7574 696f 6e20 5354 454d 2069  esolution STEM i
-00005e40: 6d61 6765 730a 2020 2020 616e 6420 7468  mages.    and th
-00005e50: 656e 2073 7562 7365 7175 656e 746c 7920  en subsequently 
-00005e60: 7573 6520 6761 7573 7369 616e 2070 6561  use gaussian pea
-00005e70: 6b20 6669 7474 696e 6720 746f 0a20 2020  k fitting to.   
-00005e80: 2072 6566 696e 6520 7468 6520 636f 6c75   refine the colu
-00005e90: 6d6e 206c 6f63 6174 696f 6e20 7769 7468  mn location with
-00005ea0: 2073 7562 2d70 6978 656c 2070 7265 6369   sub-pixel preci
-00005eb0: 7369 6f6e 2e0a 0a20 2020 2050 6172 616d  sion...    Param
-00005ec0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00005ed0: 2d2d 2d2d 0a20 2020 2069 6d61 6765 3a20  ----.    image: 
-00005ee0: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-00005ef0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00005f00: 6865 2069 6d61 6765 2066 726f 6d20 7768  he image from wh
-00005f10: 6963 6820 7468 6520 7065 616b 2070 6f73  ich the peak pos
-00005f20: 6974 696f 6e73 0a20 2020 2020 2020 2020  itions.         
-00005f30: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
-00005f40: 6173 6365 7274 6169 6e65 642e 0a20 2020  ascertained..   
-00005f50: 2063 616c 6962 3a20 2020 2020 2020 666c   calib:       fl
-00005f60: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-00005f70: 2020 2020 2053 697a 6520 6f66 2061 6e20       Size of an 
-00005f80: 696e 6469 7669 6475 616c 2070 6978 656c  individual pixel
-00005f90: 0a20 2020 2063 616c 6962 5f75 6e69 7473  .    calib_units
-00005fa0: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-00005fb0: 2020 2020 2020 2055 6e69 7420 6f66 2063         Unit of c
-00005fc0: 616c 6962 7261 7469 6f6e 0a0a 2020 2020  alibration..    
-00005fd0: 5265 6665 7265 6e63 6573 0a20 2020 202d  References.    -
-00005fe0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 315d  ---------.    1]
-00005ff0: 5f2c 204d 756b 6865 726a 6565 2c20 442e  _, Mukherjee, D.
-00006000: 2c20 4d69 616f 2c20 4c2e 2c20 5374 6f6e  , Miao, L., Ston
-00006010: 652c 2047 2e20 616e 6420 416c 656d 2c20  e, G. and Alem, 
-00006020: 4e2e 2c0a 2020 2020 2020 2020 206d 7066  N.,.         mpf
-00006030: 6974 3a20 6120 726f 6275 7374 206d 6574  it: a robust met
-00006040: 686f 6420 666f 7220 6669 7474 696e 6720  hod for fitting 
-00006050: 6174 6f6d 6963 2072 6573 6f6c 7574 696f  atomic resolutio
-00006060: 6e20 696d 6167 6573 0a20 2020 2020 2020  n images.       
-00006070: 2020 7769 7468 206d 756c 7469 706c 6520    with multiple 
-00006080: 4761 7573 7369 616e 2070 6561 6b73 2e20  Gaussian peaks. 
-00006090: 4164 7620 5374 7275 6374 2043 6865 6d20  Adv Struct Chem 
-000060a0: 496d 6167 2036 2c20 3120 2832 3032 3029  Imag 6, 1 (2020)
-000060b0: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
-000060c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000060d0: 2052 756e 2061 733a 0a0a 2020 2020 3e3e   Run as:..    >>
-000060e0: 3e20 6174 6f6d 7320 3d20 7374 2e61 6669  > atoms = st.afi
-000060f0: 742e 6174 6f6d 5f66 6974 2873 7465 6d5f  t.atom_fit(stem_
-00006100: 696d 6167 652c 2063 616c 6962 7261 7469  image, calibrati
-00006110: 6f6e 2c20 276e 6d27 290a 0a20 2020 2054  on, 'nm')..    T
-00006120: 6865 6e20 746f 2063 6865 636b 2074 6865  hen to check the
-00006130: 2069 6d61 6765 2079 6f75 206a 7573 7420   image you just 
-00006140: 6c6f 6164 6564 2c20 7769 7468 2074 6865  loaded, with the
-00006150: 206f 7074 696f 6e61 6c20 7061 7261 6d65   optional parame
-00006160: 7465 720a 2020 2020 6031 3260 2064 6574  ter.    `12` det
-00006170: 6572 6d69 6e69 6e67 2068 6f77 206d 616e  ermining how man
-00006180: 7920 7069 7865 6c73 206f 6620 6761 7573  y pixels of gaus
-00006190: 7369 616e 2062 6c75 7220 6e65 6564 2074  sian blur need t
-000061a0: 6f20 6170 706c 6965 6420 746f 0a20 2020  o applied to.   
-000061b0: 2063 616c 6375 6c61 7465 2061 6e64 2073   calculate and s
-000061c0: 6570 6172 6174 6520 6120 6261 636b 6772  eparate a backgr
-000061d0: 6f75 6e64 2e20 4966 2069 6e20 646f 7562  ound. If in doub
-000061e0: 742c 2064 6f6e 2774 2075 7365 2069 742e  t, don't use it.
-000061f0: 0a0a 2020 2020 3e3e 3e20 6174 6f6d 732e  ..    >>> atoms.
-00006200: 7368 6f77 5f69 6d61 6765 2831 3229 0a0a  show_image(12)..
-00006210: 2020 2020 4974 2069 7320 7468 656e 206f      It is then o
-00006220: 7074 696f 6e61 6c20 746f 2064 6566 696e  ptional to defin
-00006230: 6520 6120 7265 6665 726e 6365 2072 6567  e a refernce reg
-00006240: 696f 6e20 666f 7220 7468 6520 696d 6167  ion for the imag
-00006250: 652e 0a20 2020 2049 6620 7375 6368 2061  e..    If such a
-00006260: 2072 6567 696f 6e20 6973 2064 6566 696e   region is defin
-00006270: 6564 2c20 6174 6f6d 2070 6f73 6974 696f  ed, atom positio
-00006280: 6e73 2077 696c 6c20 6f6e 6c79 2062 6520  ns will only be 
-00006290: 6173 6365 7274 6169 6e65 640a 2020 2020  ascertained.    
-000062a0: 6772 6f6d 2074 6865 2072 6566 6572 656e  grom the referen
-000062b0: 6365 2072 6567 696f 6e2e 2049 6620 796f  ce region. If yo
-000062c0: 7520 646f 6e27 7420 7275 6e20 7468 6973  u don't run this
-000062d0: 2073 7465 702c 2074 6865 2065 6e74 6972   step, the entir
-000062e0: 6520 696d 6167 650a 2020 2020 7769 6c6c  e image.    will
-000062f0: 2062 6520 616e 616c 797a 6564 0a0a 2020   be analyzed..  
-00006300: 2020 3e3e 3e20 6174 6f6d 732e 6465 6669    >>> atoms.defi
-00006310: 6e65 5f72 6566 6572 656e 6365 2828 3137  ne_reference((17
-00006320: 2c20 3729 2c20 2832 362c 2037 292c 2028  , 7), (26, 7), (
-00006330: 3236 2c20 3234 292c 2028 3137 2c20 3234  26, 24), (17, 24
-00006340: 2929 0a0a 2020 2020 5468 656e 2c20 7669  ))..    Then, vi
-00006350: 7375 616c 697a 6520 7468 6520 7065 616b  sualize the peak
-00006360: 733a 0a0a 2020 2020 3e3e 3e20 6174 6f6d  s:..    >>> atom
-00006370: 732e 7065 616b 735f 7669 7328 6469 7374  s.peaks_vis(dist
-00006380: 3d30 2e31 2c20 7468 7265 7368 3d30 2e31  =0.1, thresh=0.1
-00006390: 290a 0a20 2020 2060 6469 7374 6020 696e  )..    `dist` in
-000063a0: 6469 6361 7465 7320 7468 6520 6469 7374  dicates the dist
-000063b0: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
-000063c0: 0a20 2020 2070 6561 6b73 2069 6e20 6361  .    peaks in ca
-000063d0: 6c69 6272 6174 696f 6e20 756e 6974 732e  libration units.
-000063e0: 2050 6c61 7920 6172 6f75 6e64 2077 6974   Play around wit
-000063f0: 6820 7468 6520 6e75 6d62 6572 7320 7469  h the numbers ti
-00006400: 6c6c 0a20 2020 2079 6f75 2067 6574 2061  ll.    you get a
-00006410: 2073 6174 6973 6661 6374 6f72 7920 7265   satisfactory re
-00006420: 7375 6c74 2e20 5468 656e 2072 756e 2074  sult. Then run t
-00006430: 6865 2067 6175 7373 6961 6e20 7065 616b  he gaussian peak
-00006440: 2072 6566 696e 656d 656e 7420 6173 3a0a   refinement as:.
-00006450: 0a20 2020 203e 3e3e 2061 746f 6d73 2e72  .    >>> atoms.r
-00006460: 6566 696e 655f 7065 616b 7328 290a 0a20  efine_peaks().. 
-00006470: 2020 2059 6f75 2063 616e 2076 6973 7561     You can visua
-00006480: 6c69 7a65 2079 6f75 7220 6669 7474 6564  lize your fitted
-00006490: 2070 6561 6b73 2061 733a 0a0a 2020 2020   peaks as:..    
-000064a0: 3e3e 3e20 6174 6f6d 732e 7368 6f77 5f70  >>> atoms.show_p
-000064b0: 6561 6b73 2873 7479 6c65 3d20 2773 6570  eaks(style= 'sep
-000064c0: 6172 6174 6527 290a 0a20 2020 2063 0400  arate')..    c..
-000064d0: 0000 0000 0000 0000 0000 0400 0000 0300  ................
-000064e0: 0000 4300 0000 734c 0000 0074 006a 01a0  ..C...sL...t.j..
-000064f0: 027c 01a1 017c 005f 0374 04a0 057c 006a  .|...|._.t...|.j
-00006500: 03a1 017c 005f 067c 027c 005f 077c 037c  ...|._.|.|._.|.|
-00006510: 005f 0874 04a0 097c 016a 0aa1 017c 005f  ._.t...|.j...|._
-00006520: 0b64 017c 005f 0c64 017c 005f 0d64 017c  .d.|._.d.|._.d.|
-00006530: 005f 0e64 0053 0029 024e 4629 0f72 4900  ._.d.S.).NF).rI.
-00006540: 0000 724a 0000 00da 1069 6d61 6765 5f6e  ..rJ.....image_n
-00006550: 6f72 6d61 6c69 7a65 7272 a600 0000 7211  ormalizerr....r.
-00006560: 0000 0072 1200 0000 da09 696d 636c 6561  ...r......imclea
-00006570: 6e65 64da 0563 616c 6962 da0b 6361 6c69  ned..calib..cali
-00006580: 625f 756e 6974 7372 6d00 0000 7267 0000  b_unitsrm...rg..
-00006590: 00da 0769 6d73 6861 7065 da0b 7065 616b  ...imshape..peak
-000065a0: 735f 6368 6563 6bda 0e72 6566 696e 696e  s_check..refinin
-000065b0: 675f 6368 6563 6bda 0f72 6566 6572 656e  g_check..referen
-000065c0: 6365 5f63 6865 636b 2904 da04 7365 6c66  ce_check)...self
-000065d0: 72a6 0000 0072 e400 0000 72e5 0000 0072  r....r....r....r
-000065e0: 1900 0000 7219 0000 0072 1a00 0000 da08  ....r....r......
-000065f0: 5f5f 696e 6974 5f5f 8c03 0000 7310 0000  __init__....s...
-00006600: 0000 010e 010e 0106 0106 010e 0106 0106  ................
-00006610: 017a 1161 746f 6d5f 6669 742e 5f5f 696e  .z.atom_fit.__in
-00006620: 6974 5f5f 7201 0000 00a9 0272 2600 0000  it__r......r&...
-00006630: 7226 0000 00da 0769 6e66 6572 6e6f 6304  r&.....infernoc.
-00006640: 0000 0000 0000 0000 0000 0005 0000 0004  ................
-00006650: 0000 0043 0000 0073 9400 0000 7c01 7c00  ...C...s....|.|.
-00006660: 5f00 7c01 6401 6b04 7234 7401 a002 7c00  _.|.d.k.r4t...|.
-00006670: 6a03 7c01 a102 7c00 5f04 7405 6a06 a007  j.|...|._.t.j...
-00006680: 7c00 6a03 7c00 6a04 1800 a101 7c00 5f08  |.j.|.j.....|._.
-00006690: 7c01 7c00 5f09 740a 6a0b 7c02 6402 8d01  |.|._.t.j.|.d...
-000066a0: 0100 740a 6a0c 7c00 6a08 7c03 6403 8d02  ..t.j.|.j.|.d...
-000066b0: 0100 740d a00e 7c00 6a0f 7c00 6a10 a102  ..t...|.j.|.j...
-000066c0: 7d04 6404 7c04 5f11 6405 7c04 5f12 6406  }.d.|._.d.|._.d.
-000066d0: 7c04 5f13 740a a014 a100 a015 7c04 a101  |._.t.......|...
-000066e0: 0100 740a a016 6407 a101 0100 6408 5300  ..t...d.....d.S.
-000066f0: 2909 61dd 0100 000a 2020 2020 2020 2020  ).a.....        
-00006700: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00006710: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00006720: 2020 2020 2020 6761 7573 7376 616c 3a20        gaussval: 
-00006730: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
-00006740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006750: 4578 7465 6e74 206f 6620 4761 7573 7369  Extent of Gaussi
-00006760: 616e 2062 6c75 7272 696e 6720 696e 2070  an blurring in p
-00006770: 6978 656c 730a 2020 2020 2020 2020 2020  ixels.          
-00006780: 2020 2020 2020 2020 746f 2067 656e 6572          to gener
-00006790: 6174 6520 6120 6261 636b 6772 6f75 6e64  ate a background
-000067a0: 2069 6d61 6765 2066 6f72 0a20 2020 2020   image for.     
-000067b0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
-000067c0: 7472 6163 7469 6f6e 2e20 4465 6661 756c  traction. Defaul
-000067d0: 7420 6973 2030 0a20 2020 2020 2020 2069  t is 0.        i
-000067e0: 6d73 697a 653a 2020 2074 7570 6c65 2c20  msize:   tuple, 
-000067f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00006800: 2020 2020 2020 2020 2020 2053 697a 6520             Size 
-00006810: 696e 2069 6e63 6865 7320 6f66 2074 6865  in inches of the
-00006820: 2069 6d61 6765 2077 6974 6820 7468 650a   image with the.
-00006830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006840: 2020 6469 6666 7261 6374 696f 6e20 7370    diffraction sp
-00006850: 6f74 7320 6d61 726b 6564 2e20 4465 6661  ots marked. Defa
-00006860: 756c 7420 6973 2028 3135 2c20 3135 290a  ult is (15, 15).
-00006870: 2020 2020 2020 2020 636f 6c6f 726d 6170          colormap
-00006880: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
-00006890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000068a0: 2020 436f 6c6f 726d 6170 206f 6620 7468    Colormap of th
-000068b0: 6520 696d 6167 652e 2044 6566 6175 6c74  e image. Default
-000068c0: 2069 7320 696e 6665 726e 6f0a 2020 2020   is inferno.    
-000068d0: 2020 2020 7201 0000 0072 2400 0000 72a2      r....r$...r.
-000068e0: 0000 00fa 0b6c 6f77 6572 2072 6967 6874  .....lower right
-000068f0: 720d 0000 00da 016b da03 6f66 664e 2917  r......k..offN).
-00006900: da08 6761 7573 7376 616c 7231 0000 0072  ..gaussvalr1...r
-00006910: 9100 0000 72a6 0000 005a 0567 626c 7572  ....r....Z.gblur
-00006920: 7249 0000 0072 4a00 0000 72e2 0000 0072  rI...rJ...r....r
-00006930: e300 0000 5a0b 6761 7573 735f 636c 6561  ....Z.gauss_clea
-00006940: 6e72 3700 0000 7238 0000 0072 3900 0000  nr7...r8...r9...
-00006950: da04 6d70 7373 da08 5363 616c 6542 6172  ..mpss..ScaleBar
-00006960: 72e4 0000 0072 e500 0000 da08 6c6f 6361  r....r......loca
-00006970: 7469 6f6e da09 626f 785f 616c 7068 6172  tion..box_alphar
-00006980: a000 0000 da03 6763 6172 a500 0000 720f  ......gcar....r.
-00006990: 0000 0029 0572 ea00 0000 72f1 0000 0072  ...).r....r....r
-000069a0: 3c00 0000 5a08 636f 6c6f 726d 6170 da08  <...Z.colormap..
-000069b0: 7363 616c 6562 6172 7219 0000 0072 1900  scalebarr....r..
-000069c0: 0000 721a 0000 00da 0a73 686f 775f 696d  ..r......show_im
-000069d0: 6167 6596 0300 0073 1a00 0000 000e 0601  age....s........
-000069e0: 0801 1001 1601 0601 0c01 1001 1001 0601  ................
-000069f0: 0601 0601 0e01 7a13 6174 6f6d 5f66 6974  ......z.atom_fit
-00006a00: 2e73 686f 775f 696d 6167 6572 ef00 0000  .show_imager....
-00006a10: 6307 0000 0000 0000 0000 0000 001c 0000  c...............
-00006a20: 0008 0000 0043 0000 0073 1204 0000 7400  .....C...s....t.
-00006a30: a001 7c01 a101 7c00 6a02 1b00 7d07 7400  ..|...|.j...}.t.
-00006a40: a001 7c02 a101 7c00 6a02 1b00 7d08 7400  ..|...|.j...}.t.
-00006a50: a001 7c03 a101 7c00 6a02 1b00 7d09 7400  ..|...|.j...}.t.
-00006a60: a001 7c04 a101 7c00 6a02 1b00 7d0a 7400  ..|...|.j...}.t.
-00006a70: 6a03 6401 7c00 6a04 6401 1900 8502 6401  j.d.|.j.d.....d.
-00006a80: 7c00 6a04 6402 1900 8502 6602 1900 5c02  |.j.d.....f...\.
-00006a90: 7d0b 7d0c 7400 a005 7c0b a101 7d0b 7400  }.}.t...|...}.t.
-00006aa0: a005 7c0c a101 7d0c 7400 a001 7c0c 7c0b  ..|...}.t...|.|.
-00006ab0: 6602 a101 a006 a100 7c07 1800 7d0d 7400  f.......|...}.t.
-00006ac0: a001 7c0c 7c0b 6602 a101 a006 a100 7c08  ..|.|.f.......|.
-00006ad0: 1800 7d0e 7400 a001 7c0c 7c0b 6602 a101  ..}.t...|.|.f...
-00006ae0: a006 a100 7c09 1800 7d0f 7400 a001 7c0c  ....|...}.t...|.
-00006af0: 7c0b 6602 a101 a006 a100 7c0a 1800 7d10  |.f.......|...}.
-00006b00: 7400 a007 7400 6a08 7c0d 7c0e 1400 6402  t...t.j.|.|...d.
-00006b10: 6403 8d02 7400 6a08 7c0d 6404 1300 6402  d...t.j.|.d...d.
-00006b20: 6403 8d02 6405 1300 7400 6a08 7c0e 6404  d...d...t.j.|.d.
-00006b30: 1300 6402 6403 8d02 6405 1300 1400 1b00  ..d.d...d.......
-00006b40: a101 7d11 7400 a007 7400 6a08 7c0e 7c0f  ..}.t...t.j.|.|.
-00006b50: 1400 6402 6403 8d02 7400 6a08 7c0e 6404  ..d.d...t.j.|.d.
-00006b60: 1300 6402 6403 8d02 6405 1300 7400 6a08  ..d.d...d...t.j.
-00006b70: 7c0f 6404 1300 6402 6403 8d02 6405 1300  |.d...d.d...d...
-00006b80: 1400 1b00 a101 7d12 7400 a007 7400 6a08  ......}.t...t.j.
-00006b90: 7c0f 7c10 1400 6402 6403 8d02 7400 6a08  |.|...d.d...t.j.
-00006ba0: 7c0f 6404 1300 6402 6403 8d02 6405 1300  |.d...d.d...d...
-00006bb0: 7400 6a08 7c10 6404 1300 6402 6403 8d02  t.j.|.d...d.d...
-00006bc0: 6405 1300 1400 1b00 a101 7d13 7400 a007  d.........}.t...
-00006bd0: 7400 6a08 7c10 7c0d 1400 6402 6403 8d02  t.j.|.|...d.d...
-00006be0: 7400 6a08 7c10 6404 1300 6402 6403 8d02  t.j.|.d...d.d...
-00006bf0: 6405 1300 7400 6a08 7c0d 6404 1300 6402  d...t.j.|.d...d.
-00006c00: 6403 8d02 6405 1300 1400 1b00 a101 7d14  d...d.........}.
-00006c10: 7c11 7c12 1700 7c13 1700 7c14 1700 6404  |.|...|...|...d.
-00006c20: 7400 6a09 1400 1b00 a00a 7c00 6a0b 6a0c  t.j.......|.j.j.
-00006c30: a101 7d15 7400 a00d 7c15 6402 a102 7c00  ..}.t...|.d...|.
-00006c40: 5f0e 7400 a00f 7c00 6a0e a101 7c00 5f0e  _.t...|.j...|._.
-00006c50: 7400 a010 6401 7c00 6a02 7c00 6a04 6401  t...d.|.j.|.j.d.
-00006c60: 1900 1400 7c00 6a02 a103 7d16 6406 7d17  ....|.j...}.d.}.
-00006c70: 7411 7c00 6a04 6401 1900 7c17 6402 1800  t.|.j.d...|.d...
-00006c80: 1b00 8301 7d18 7400 a010 6401 7c00 6a04  ....}.t...d.|.j.
-00006c90: 6401 1900 7c18 a103 7d19 7400 a012 7c16  d...|...}.t...|.
-00006ca0: 6407 6407 7c18 8503 1900 6402 a102 7d1a  d.d.|.....d...}.
-00006cb0: 7411 6408 7400 a013 7400 a001 7c05 a101  t.d.t...t...|...
-00006cc0: a101 1400 8301 7d1b 7414 6409 8301 0100  ......}.t.d.....
-00006cd0: 7415 6a16 7c05 640a 8d01 0100 7415 6a17  t.j.|.d.....t.j.
-00006ce0: 7400 a00f 7c00 6a0b 640b 7c00 6a0e 1400  t...|.j.d.|.j...
-00006cf0: 1700 a101 640c 640d 640e 8d03 0100 7415  ....d.d.d.....t.
-00006d00: 6a18 640f 7419 7c01 8301 1700 7c07 7c00  j.d.t.|.....|.|.
-00006d10: 6a04 1b00 6410 7c1b 7c06 6411 8d05 0100  j...d.|.|.d.....
-00006d20: 7415 6a18 6412 7419 7c02 8301 1700 7c08  t.j.d.t.|.....|.
-00006d30: 7c00 6a04 1b00 6410 7c1b 7c06 6411 8d05  |.j...d.|.|.d...
-00006d40: 0100 7415 6a18 6413 7419 7c03 8301 1700  ..t.j.d.t.|.....
-00006d50: 7c09 7c00 6a04 1b00 6410 7c1b 7c06 6411  |.|.j...d.|.|.d.
-00006d60: 8d05 0100 7415 6a18 6414 7419 7c04 8301  ....t.j.d.t.|...
-00006d70: 1700 7c0a 7c00 6a04 1b00 6410 7c1b 7c06  ..|.|.j...d.|.|.
-00006d80: 6411 8d05 0100 7415 6a1a 7c07 6401 1900  d.....t.j.|.d...
-00006d90: 7c07 6402 1900 6415 6416 8d03 0100 7415  |.d...d.d.....t.
-00006da0: 6a1a 7c08 6401 1900 7c08 6402 1900 6415  j.|.d...|.d...d.
-00006db0: 6416 8d03 0100 7415 6a1a 7c09 6401 1900  d.....t.j.|.d...
-00006dc0: 7c09 6402 1900 6415 6416 8d03 0100 7415  |.d...d.d.....t.
-00006dd0: 6a1a 7c0a 6401 1900 7c0a 6402 1900 6415  j.|.d...|.d...d.
-00006de0: 6416 8d03 0100 7415 6a1b 7c19 7c1a 7c1b  d.....t.j.|.|.|.
-00006df0: 6417 8d03 0100 7415 6a1c 7c19 7c1a 7c1b  d.....t.j.|.|.|.
-00006e00: 6417 8d03 0100 7415 6a1d 6418 7c00 6a1e  d.....t.j.d.|.j.
-00006e10: 1700 6419 1700 7c1b 6417 8d02 0100 7415  ..d...|.d.....t.
-00006e20: 6a1f 641a 7c00 6a1e 1700 6419 1700 7c1b  j.d.|.j...d...|.
-00006e30: 6417 8d02 0100 641b 7c00 5f20 6407 5300  d.....d.|._ d.S.
-00006e40: 291c 615a 0300 000a 2020 2020 2020 2020  ).aZ....        
-00006e50: 4c6f 6361 7465 2074 6865 2072 6566 6572  Locate the refer
-00006e60: 656e 6365 2069 6d61 6765 2e0a 0a20 2020  ence image...   
-00006e70: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00006e80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00006e90: 2d2d 0a20 2020 2020 2020 2041 5f70 743a  --.        A_pt:
-00006ea0: 2020 2074 7570 6c65 0a20 2020 2020 2020     tuple.       
-00006eb0: 2020 2020 2020 2020 2054 6f70 206c 6566           Top lef
-00006ec0: 7420 706f 7369 7469 6f6e 206f 6620 7265  t position of re
-00006ed0: 6665 7265 6e63 6520 7265 6769 6f6e 2069  ference region i
-00006ee0: 6e20 2878 2c20 7929 0a20 2020 2020 2020  n (x, y).       
-00006ef0: 2042 5f70 743a 2020 2074 7570 6c65 0a20   B_pt:   tuple. 
-00006f00: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00006f10: 6f70 2072 6967 6874 2070 6f73 6974 696f  op right positio
-00006f20: 6e20 6f66 2072 6566 6572 656e 6365 2072  n of reference r
-00006f30: 6567 696f 6e20 696e 2028 782c 2079 290a  egion in (x, y).
-00006f40: 2020 2020 2020 2020 435f 7074 3a20 2020          C_pt:   
-00006f50: 7475 706c 650a 2020 2020 2020 2020 2020  tuple.          
-00006f60: 2020 2020 2020 426f 7474 6f6d 2072 6967        Bottom rig
-00006f70: 6874 2070 6f73 6974 696f 6e20 6f66 2072  ht position of r
-00006f80: 6566 6572 656e 6365 2072 6567 696f 6e20  eference region 
-00006f90: 696e 2028 782c 2079 290a 2020 2020 2020  in (x, y).      
-00006fa0: 2020 445f 7074 3a20 2020 7475 706c 650a    D_pt:   tuple.
-00006fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006fc0: 426f 7474 6f6d 206c 6566 7420 706f 7369  Bottom left posi
-00006fd0: 7469 6f6e 206f 6620 7265 6665 7265 6e63  tion of referenc
-00006fe0: 6520 7265 6769 6f6e 2069 6e20 2878 2c20  e region in (x, 
-00006ff0: 7929 0a20 2020 2020 2020 2069 6d73 697a  y).        imsiz
-00007000: 653a 2074 7570 6c65 2c20 6f70 7469 6f6e  e: tuple, option
-00007010: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00007020: 2020 2053 697a 6520 696e 2069 6e63 6865     Size in inche
-00007030: 7320 6f66 2074 6865 2069 6d61 6765 2077  s of the image w
-00007040: 6974 6820 7468 650a 2020 2020 2020 2020  ith the.        
-00007050: 2020 2020 2020 2020 6469 6666 7261 6374          diffract
-00007060: 696f 6e20 7370 6f74 7320 6d61 726b 6564  ion spots marked
-00007070: 2e20 4465 6661 756c 7420 6973 0a20 2020  . Default is.   
-00007080: 2020 2020 2020 2020 2020 2020 2028 3130               (10
-00007090: 2c20 3130 290a 2020 2020 2020 2020 7443  , 10).        tC
-000070a0: 6f6c 6f72 3a20 7374 722c 206f 7074 696f  olor: str, optio
-000070b0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-000070c0: 2020 2020 436f 6c6f 7220 6f66 2074 6865      Color of the
-000070d0: 2074 6578 7420 6f6e 2074 6865 2069 6d61   text on the ima
-000070e0: 6765 2e20 4465 6661 756c 7420 6973 2062  ge. Default is b
-000070f0: 6c61 636b 0a0a 2020 2020 2020 2020 4e6f  lack..        No
-00007100: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
-00007110: 2d0a 2020 2020 2020 2020 4c6f 6361 7465  -.        Locate
-00007120: 7320 6120 7265 6665 7265 6e63 6520 7265  s a reference re
-00007130: 6769 6f6e 2062 6f75 6e64 6564 2062 7920  gion bounded by 
-00007140: 7468 6520 666f 7572 2070 6f69 6e74 7320  the four points 
-00007150: 6769 7665 6e20 696e 0a20 2020 2020 2020  given in.       
-00007160: 206c 656e 6774 6820 756e 6974 732e 2043   length units. C
-00007170: 686f 6f73 6520 7468 6520 706f 696e 7473  hoose the points
-00007180: 2069 6e20 6120 636c 6f63 6b77 6973 6520   in a clockwise 
-00007190: 6661 7368 696f 6e2e 0a20 2020 2020 2020  fashion..       
-000071a0: 2072 0100 0000 720d 0000 0072 0e00 0000   r....r....r....
-000071b0: 720c 0000 0072 1000 0000 721c 0000 004e  r....r....r....N
-000071c0: 6700 0000 0000 00f8 3f7a 4e43 686f 6f73  g.......?zNChoos
-000071d0: 6520 796f 7572 2070 6f69 6e74 7320 696e  e your points in
-000071e0: 2061 2063 6c6f 636b 7769 7365 2066 6173   a clockwise fas
-000071f0: 6869 6f6e 2c20 6f72 2065 6c73 6520 796f  hion, or else yo
-00007200: 7520 7769 6c6c 2067 6574 2061 2077 726f  u will get a wro
-00007210: 6e67 2072 6573 756c 7472 2400 0000 729f  ng resultr$...r.
-00007220: 0000 00da 056d 6167 6d61 da05 6c6f 7765  .....magma..lowe
-00007230: 7229 0272 a300 0000 72c1 0000 007a 0241  r).r....r....z.A
-00007240: 3d7a 0d61 7865 7320 6672 6163 7469 6f6e  =z.axes fraction
-00007250: 2903 5a0a 7465 7874 636f 6f72 6473 da04  ).Z.textcoords..
-00007260: 7369 7a65 72a0 0000 007a 0242 3d7a 0243  sizer....z.B=z.C
-00007270: 3d7a 0244 3dda 0172 2901 7228 0000 0029  =z.D=..r).r(...)
-00007280: 015a 0866 6f6e 7473 697a 657a 1744 6973  .Z.fontsizez.Dis
-00007290: 7461 6e63 6520 616c 6f6e 6720 582d 6178  tance along X-ax
-000072a0: 6973 2028 fa01 297a 1744 6973 7461 6e63  is (..)z.Distanc
-000072b0: 6520 616c 6f6e 6720 592d 6178 6973 2028  e along Y-axis (
-000072c0: 5429 2172 1100 0000 726d 0000 0072 e400  T)!r....rm...r..
-000072d0: 0000 7266 0000 0072 e600 0000 72cb 0000  ..rf...r....r...
-000072e0: 005a 0974 7261 6e73 706f 7365 72ad 0000  .Z.transposer...
-000072f0: 0072 1400 0000 da02 7069 5a07 7265 7368  .r......piZ.resh
-00007300: 6170 6572 e300 0000 7267 0000 00da 0769  aper....rg.....i
-00007310: 7363 6c6f 7365 da07 7265 665f 7265 675a  sclose..ref_regZ
-00007320: 0666 6c69 7075 6472 6400 0000 7230 0000  .flipudrd...r0..
-00007330: 0072 b700 0000 72aa 0000 00da 0570 7269  .r....r......pri
-00007340: 6e74 7237 0000 0072 3800 0000 7239 0000  ntr7...r8...r9..
-00007350: 005a 0861 6e6e 6f74 6174 65da 0373 7472  .Z.annotate..str
-00007360: 723a 0000 005a 0678 7469 636b 735a 0679  r:...Z.xticksZ.y
-00007370: 7469 636b 735a 0678 6c61 6265 6c72 e500  ticksZ.xlabelr..
-00007380: 0000 5a06 796c 6162 656c 72e9 0000 0029  ..Z.ylabelr....)
-00007390: 1c72 ea00 0000 5a04 415f 7074 5a04 425f  .r....Z.A_ptZ.B_
-000073a0: 7074 5a04 435f 7074 5a04 445f 7074 723c  ptZ.C_ptZ.D_ptr<
-000073b0: 0000 005a 0674 436f 6c6f 72da 0141 da01  ...Z.tColor..A..
-000073c0: 42da 0143 da01 4472 7400 0000 7275 0000  B..C..Drt...ru..
-000073d0: 005a 0470 7441 415a 0470 7442 425a 0470  .Z.ptAAZ.ptBBZ.p
-000073e0: 7443 435a 0470 7444 445a 0761 6e67 4141  tCCZ.ptDDZ.angAA
-000073f0: 4242 5a07 616e 6742 4243 435a 0761 6e67  BBZ.angBBCCZ.ang
-00007400: 4343 4444 5a07 616e 6744 4441 415a 0661  CCDDZ.angDDAAZ.a
-00007410: 6e67 7375 6d5a 0a70 6978 656c 5f6c 6973  ngsumZ.pixel_lis
-00007420: 745a 096e 6f5f 6c61 6265 6c73 5a06 7374  tZ.no_labelsZ.st
-00007430: 6570 5f78 5a0b 785f 706f 7369 7469 6f6e  ep_xZ.x_position
-00007440: 735a 0878 5f6c 6162 656c 73da 0566 7369  sZ.x_labels..fsi
-00007450: 7a65 7219 0000 0072 1900 0000 721a 0000  zer....r....r...
-00007460: 00da 1064 6566 696e 655f 7265 6665 7265  ...define_refere
-00007470: 6e63 65b2 0300 0073 c000 0000 001a 1001  nce....s........
-00007480: 1001 1001 1002 2601 0a01 0a01 1601 1601  ......&.........
-00007490: 1601 1601 0401 1002 1401 14ff 02fe 02ff  ................
-000074a0: 0407 0401 1002 1401 14ff 02fe 02ff 0407  ................
-000074b0: 0401 1002 1401 14ff 02fe 02ff 0407 0401  ................
-000074c0: 1002 1401 14ff 02fe 02ff 0407 1a01 06ff  ................
-000074d0: 0403 0e01 0e02 1c01 0401 1601 1401 1601  ................
-000074e0: 1802 0201 02ff 0404 0c01 0401 1401 0201  ................
-000074f0: 02fd 0605 0401 0a01 0801 0201 0201 02fb  ................
-00007500: 0607 0401 0a01 0801 0201 0201 02fb 0607  ................
-00007510: 0401 0a01 0801 0201 0201 02fb 0607 0401  ................
-00007520: 0a01 0801 0201 0201 02fb 0607 1801 1801  ................
-00007530: 1801 1801 1001 1001 1801 1801 7a19 6174  ............z.at
-00007540: 6f6d 5f66 6974 2e64 6566 696e 655f 7265  om_fit.define_re
-00007550: 6665 7265 6e63 6572 0c00 0000 7228 0000  ferencer....r(..
-00007560: 0063 0600 0000 0000 0000 0000 0000 0d00  .c..............
-00007570: 0000 0900 0000 4300 0000 7378 0100 007c  ......C...sx...|
-00007580: 006a 0073 1874 016a 027c 006a 0374 0464  .j.s.t.j.|.j.t.d
-00007590: 018d 027c 005f 057c 017c 006a 061b 007d  ...|._.|.|.j...}
-000075a0: 0674 07a0 087c 006a 037c 03a1 027c 005f  .t...|.j.|...|._
-000075b0: 097c 027c 005f 0a7c 006a 097c 006a 0514  .|.|._.|.j.|.j..
-000075c0: 007c 006a 0a18 0064 027c 006a 0a18 001b  .|.j...d.|.j....
-000075d0: 007c 005f 0b64 037c 006a 0b7c 006a 0b64  .|._.d.|.j.|.j.d
-000075e0: 036b 003c 0074 0c6a 0d7c 006a 0b74 0e7c  .k.<.t.j.|.j.t.|
-000075f0: 0664 041b 0083 0164 0564 068d 037d 0774  .d.....d.d...}.t
-00007600: 076a 0fa0 107c 07a1 0164 0319 007d 0874  .j...|...d...}.t
-00007610: 076a 0fa0 117c 077c 0874 1264 0274 01a0  .j...|.|.t.d.t..
-00007620: 137c 08a1 0164 0217 0083 02a1 037d 0974  .|...d.......}.t
-00007630: 01a0 147c 09a1 017d 0a74 156a 16a0 177c  ...|...}.t.j...|
-00007640: 0a7c 06a1 02a0 1874 016a 19a1 017c 005f  .|.....t.j...|._
-00007650: 1a74 0e64 0774 01a0 1b74 01a0 1c7c 04a1  .t.d.t...t...|..
-00007660: 01a1 0114 0083 017d 0b74 1d6a 1e7c 0464  .......}.t.j.|.d
-00007670: 088d 0101 0074 1d6a 1f7c 006a 0964 0964  .....t.j.|.j.d.d
-00007680: 0a8d 0201 0074 1d6a 207c 006a 1a64 0064  .....t.j |.j.d.d
-00007690: 0085 0264 0266 0219 007c 006a 1a64 0064  ...d.f...|.j.d.d
-000076a0: 0085 0264 0366 0219 007c 057c 0b64 0b8d  ...d.f...|.|.d..
-000076b0: 0401 0074 21a0 227c 006a 067c 006a 23a1  ...t!."|.j.|.j#.
-000076c0: 027d 0c64 0c7c 0c5f 2464 027c 0c5f 2564  .}.d.|._$d.|._%d
-000076d0: 0d7c 0c5f 2674 1da0 27a1 00a0 287c 0ca1  .|._&t..'...(|..
-000076e0: 0101 0074 1da0 2964 0ea1 0101 0064 0f7c  ...t..)d.....d.|
-000076f0: 005f 2a64 0053 0029 104e 7220 0000 0072  ._*d.S.).Nr ...r
-00007700: 0d00 0000 7201 0000 0072 2100 0000 4672  ....r....r!...Fr
-00007710: 2200 0000 7210 0000 0072 2400 0000 72f9  "...r....r$...r.
-00007720: 0000 0072 a200 0000 7227 0000 0072 ee00  ...r....r'...r..
-00007730: 0000 72ef 0000 0072 f000 0000 5429 2b72  ..r....r....T)+r
-00007740: e900 0000 7211 0000 005a 096f 6e65 735f  ....r....Z.ones_
-00007750: 6c69 6b65 72e3 0000 00da 0462 6f6f 6c72  liker......boolr
-00007760: 0001 0000 72e4 0000 0072 3100 0000 7291  ....r....r1...r.
-00007770: 0000 005a 0669 6d66 696c 7472 9600 0000  ...Z.imfiltr....
-00007780: 723d 0000 0072 2e00 0000 722f 0000 0072  r=...r....r/...r
-00007790: 3000 0000 7232 0000 0072 3300 0000 7234  0...r2...r3...r4
-000077a0: 0000 0072 3500 0000 7236 0000 0072 2c00  ...r5...r6...r,.
-000077b0: 0000 7249 0000 00da 0461 6669 7472 1b00  ..rI.....afitr..
-000077c0: 0000 7292 0000 0072 2d00 0000 7241 0000  ..r....r-...rA..
-000077d0: 0072 aa00 0000 726d 0000 0072 3700 0000  .r....rm...r7...
-000077e0: 7238 0000 0072 3900 0000 723a 0000 0072  r8...r9...r:...r
-000077f0: f200 0000 72f3 0000 0072 e500 0000 72f4  ....r....r....r.
-00007800: 0000 0072 f500 0000 72a0 0000 0072 f600  ...r....r....r..
-00007810: 0000 72a5 0000 0072 0f00 0000 72e7 0000  ..r....r....r...
-00007820: 0029 0d72 ea00 0000 7218 0000 0072 3b00  .).r....r....r;.
-00007830: 0000 5a05 6766 696c 7472 3c00 0000 5a0a  ..Z.gfiltr<...Z.
-00007840: 7370 6f74 5f63 6f6c 6f72 5a0a 7069 7865  spot_colorZ.pixe
-00007850: 6c5f 6469 7374 723e 0000 0072 3f00 0000  l_distr>...r?...
-00007860: 7240 0000 0072 4100 0000 da09 7370 6f74  r@...rA.....spot
-00007870: 5f73 697a 6572 f700 0000 7219 0000 0072  _sizer....r....r
-00007880: 1900 0000 721a 0000 0072 4200 0000 3104  ....r....rB...1.
-00007890: 0000 733a 0000 0000 0106 0112 010a 0110  ..s:............
-000078a0: 0106 0110 0108 ff06 0310 0104 0110 ff06  ................
-000078b0: 0310 0106 0116 ff04 030a 0118 0118 010c  ................
-000078c0: 0110 012e 0110 0106 0106 0106 010e 010a  ................
-000078d0: 017a 1261 746f 6d5f 6669 742e 7065 616b  .z.atom_fit.peak
-000078e0: 735f 7669 7363 0100 0000 0000 0000 0000  s_visc..........
-000078f0: 0000 0400 0000 0800 0000 4300 0000 73c2  ..........C...s.
-00007900: 0000 007c 006a 0073 0e74 0164 0183 0182  ...|.j.s.t.d....
-00007910: 0174 0274 037c 006a 0483 0164 021b 0083  .t.t.|.j...d....
-00007920: 017d 0174 056a 06a0 077c 006a 0464 037c  .}.t.j...|.j.d.|
-00007930: 0185 0264 0064 0085 0266 0219 00a1 0101  ...d.d...f......
-00007940: 0074 056a 06a0 077c 006a 04a1 017d 0274  .t.j...|.j...}.t
-00007950: 086a 0974 037c 006a 0483 0164 0466 0274  .j.t.|.j...d.f.t
-00007960: 086a 0a64 058d 027d 0374 056a 06a0 0b7c  .j.d...}.t.j...|
-00007970: 006a 0c7c 006a 0464 037c 0185 0264 0064  .j.|.j.d.|...d.d
-00007980: 0085 0266 0219 007c 0364 037c 0185 0264  ...f...|.d.|...d
-00007990: 0064 0085 0266 0219 007c 02a1 0401 0074  .d...f...|.....t
-000079a0: 056a 06a0 0b7c 006a 0c7c 006a 047c 037c  .j...|.j.|.j.|.|
-000079b0: 02a1 0401 007c 037c 005f 0d64 067c 005f  .....|.|._.d.|._
-000079c0: 0e64 0053 0029 074e 7a34 506c 6561 7365  .d.S.).Nz4Please
-000079d0: 206c 6f63 6174 6520 7468 6520 696e 6974   locate the init
-000079e0: 6961 6c20 7065 616b 7320 6669 7273 7420  ial peaks first 
-000079f0: 6173 2070 6561 6b73 5f76 6973 2829 e932  as peaks_vis().2
-00007a00: 0000 0072 0100 0000 7244 0000 0072 2000  ...r....rD...r .
-00007a10: 0000 5429 0f72 e700 0000 da0c 5275 6e74  ..T).r......Runt
-00007a20: 696d 6545 7272 6f72 7230 0000 0072 1300  imeErrorr0...r..
-00007a30: 0000 7241 0000 0072 4900 0000 720a 0100  ..rA...rI...r...
-00007a40: 0072 5100 0000 7211 0000 0072 4700 0000  .rQ...r....rG...
-00007a50: 722d 0000 0072 5600 0000 72e3 0000 00da  r-...rV...r.....
-00007a60: 0d72 6566 696e 6564 5f70 6561 6b73 72e8  .refined_peaksr.
-00007a70: 0000 0029 0472 ea00 0000 da04 7465 7374  ...).r......test
-00007a80: 5a02 6d64 720e 0100 0072 1900 0000 7219  Z.mdr....r....r.
-00007a90: 0000 0072 1a00 0000 da0c 7265 6669 6e65  ...r......refine
-00007aa0: 5f70 6561 6b73 5004 0000 7318 0000 0000  _peaksP...s.....
-00007ab0: 0106 0108 0112 011e 010e 011a 0306 012c  ...............,
-00007ac0: ff04 0516 0106 017a 1561 746f 6d5f 6669  .......z.atom_fi
-00007ad0: 742e 7265 6669 6e65 5f70 6561 6b73 da08  t.refine_peaks..
-00007ae0: 746f 6765 7468 6572 6303 0000 0000 0000  togetherc.......
-00007af0: 0000 0000 0007 0000 0007 0000 0043 0000  .............C..
-00007b00: 0073 6602 0000 7c00 6a00 730e 7401 6401  .sf...|.j.s.t.d.
-00007b10: 8301 8201 7402 7403 a004 6402 a101 7403  ....t.t...d...t.
-00007b20: a004 7c01 a101 1400 8301 7d03 7405 7403  ..|.......}.t.t.
-00007b30: a006 7403 a004 7c01 a101 a101 8301 7d04  ..t...|.......}.
-00007b40: 7405 6403 7c04 1400 8301 7d05 7c02 6404  t.d.|.....}.|.d.
-00007b50: 6b02 9001 721e 7407 6a08 7c01 6405 8d01  k...r.t.j.|.d...
-00007b60: 0100 7407 6a09 7c00 6a0a 6406 6407 8d02  ..t.j.|.j.d.d...
-00007b70: 0100 7407 6a0b 7c00 6a0c 6400 6400 8502  ..t.j.|.j.d.d...
-00007b80: 6408 6602 1900 7c00 6a0c 6400 6400 8502  d.f...|.j.d.d...
-00007b90: 6409 6602 1900 640a 7c05 640b 640c 8d05  d.f...d.|.d.d...
-00007ba0: 0100 7407 6a0b 7c00 6a0d 6400 6400 8502  ..t.j.|.j.d.d...
-00007bb0: 6408 6602 1900 7c00 6a0d 6400 6400 8502  d.f...|.j.d.d...
-00007bc0: 6409 6602 1900 640d 7c04 640e 640c 8d05  d.f...d.|.d.d...
-00007bd0: 0100 7407 a00e a100 6a0f 640f 6403 6408  ..t.....j.d.d.d.
-00007be0: 6410 8d03 0100 7410 a011 7c00 6a12 7c00  d.....t...|.j.|.
-00007bf0: 6a13 a102 7d06 6411 7c06 5f14 6408 7c06  j...}.d.|._.d.|.
-00007c00: 5f15 6412 7c06 5f16 7407 a00e a100 a017  _.d.|._.t.......
-00007c10: 7c06 a101 0100 7407 a018 6413 a101 0100  |.....t...d.....
-00007c20: 9001 6e44 7407 6a08 7c03 6405 8d01 0100  ..nDt.j.|.d.....
-00007c30: 7407 a019 6408 6414 6408 a103 0100 7407  t...d.d.d.....t.
-00007c40: 6a09 7c00 6a0a 6406 6407 8d02 0100 7407  j.|.j.d.d.....t.
-00007c50: 6a0b 7c00 6a0c 6400 6400 8502 6408 6602  j.|.j.d.d...d.f.
-00007c60: 1900 7c00 6a0c 6400 6400 8502 6409 6602  ..|.j.d.d...d.f.
-00007c70: 1900 6415 7c04 640b 640c 8d05 0100 7407  ..d.|.d.d.....t.
-00007c80: a00e a100 6a0f 640f 6403 6408 6410 8d03  ....j.d.d.d.d...
-00007c90: 0100 7410 a011 7c00 6a12 7c00 6a13 a102  ..t...|.j.|.j...
-00007ca0: 7d06 6411 7c06 5f14 6408 7c06 5f15 6412  }.d.|._.d.|._.d.
-00007cb0: 7c06 5f16 7407 a00e a100 a017 7c06 a101  |._.t.......|...
-00007cc0: 0100 7407 a018 6413 a101 0100 7407 a019  ..t...d.....t...
-00007cd0: 6408 6414 6414 a103 0100 7407 6a09 7c00  d.d.d.....t.j.|.
-00007ce0: 6a0a 6406 6407 8d02 0100 7407 6a0b 7c00  j.d.d.....t.j.|.
-00007cf0: 6a0d 6400 6400 8502 6408 6602 1900 7c00  j.d.d...d.f...|.
-00007d00: 6a0d 6400 6400 8502 6409 6602 1900 6412  j.d.d...d.f...d.
-00007d10: 7c04 640e 640c 8d05 0100 7407 a00e a100  |.d.d.....t.....
-00007d20: 6a0f 640f 6403 6408 6410 8d03 0100 7410  j.d.d.d.d.....t.
-00007d30: a011 7c00 6a12 7c00 6a13 a102 7d06 6411  ..|.j.|.j...}.d.
-00007d40: 7c06 5f14 6408 7c06 5f15 6412 7c06 5f16  |._.d.|._.d.|._.
-00007d50: 7407 a00e a100 a017 7c06 a101 0100 7407  t.......|.....t.
-00007d60: a018 6413 a101 0100 6400 5300 2916 4e7a  ..d.....d.S.).Nz
-00007d70: 3450 6c65 6173 6520 7265 6669 6e65 2074  4Please refine t
-00007d80: 6865 2061 746f 6d20 7065 616b 7320 6669  he atom peaks fi
-00007d90: 7273 7420 6173 2072 6566 696e 655f 7065  rst as refine_pe
-00007da0: 616b 7328 2929 0272 0c00 0000 720d 0000  aks()).r....r...
-00007db0: 0072 2100 0000 7211 0100 0072 2400 0000  .r!...r....r$...
-00007dc0: 72f9 0000 0072 a200 0000 720d 0000 0072  r....r....r....r
-00007dd0: 0100 0000 7228 0000 007a 0e4f 7269 6769  ....r(...z.Origi
-00007de0: 6e61 6c20 5065 616b 7329 0372 2800 0000  nal Peaks).r(...
-00007df0: 7229 0000 0072 3300 0000 72fc 0000 007a  r)...r3...r....z
-00007e00: 0c46 6974 7465 6420 5065 616b 737a 0a75  .Fitted Peaksz.u
-00007e10: 7070 6572 206c 6566 7429 03da 036c 6f63  pper left)...loc
-00007e20: 5a0b 6d61 726b 6572 7363 616c 655a 0a66  Z.markerscaleZ.f
-00007e30: 7261 6d65 616c 7068 6172 ee00 0000 72ef  ramealphar....r.
-00007e40: 0000 0072 f000 0000 720c 0000 0072 2500  ...r....r....r%.
-00007e50: 0000 291a 72e8 0000 0072 0d01 0000 da05  ..).r....r......
-00007e60: 7475 706c 6572 1100 0000 726d 0000 0072  tupler....rm...r
-00007e70: 3000 0000 722a 0000 0072 3700 0000 7238  0...r*...r7...r8
-00007e80: 0000 0072 3900 0000 72e3 0000 0072 3a00  ...r9...r....r:.
-00007e90: 0000 7241 0000 0072 0e01 0000 72f6 0000  ..rA...r....r...
-00007ea0: 005a 066c 6567 656e 6472 f200 0000 72f3  .Z.legendr....r.
-00007eb0: 0000 0072 e400 0000 72e5 0000 0072 f400  ...r....r....r..
-00007ec0: 0000 72f5 0000 0072 a000 0000 72a5 0000  ..r....r....r...
-00007ed0: 0072 0f00 0000 5a07 7375 6270 6c6f 7429  .r....Z.subplot)
-00007ee0: 0772 ea00 0000 723c 0000 00da 0573 7479  .r....r<.....sty
-00007ef0: 6c65 5a07 746f 6773 697a 6572 0b01 0000  leZ.togsizer....
-00007f00: 5a08 6269 675f 7369 7a65 72f7 0000 0072  Z.big_sizer....r
-00007f10: 1900 0000 7219 0000 0072 1a00 0000 da0a  ....r....r......
-00007f20: 7368 6f77 5f70 6561 6b73 6204 0000 737c  show_peaksb...s|
-00007f30: 0000 0000 0106 0108 0118 0114 010c 010a  ................
-00007f40: 010c 0110 0104 0110 0110 0102 0102 0102  ................
-00007f50: fb06 0704 0110 0110 0102 0102 0102 fb06  ................
-00007f60: 0714 0110 0106 0106 0106 010e 010e 020c  ................
-00007f70: 010e 0110 0104 0110 0110 0102 0102 0102  ................
-00007f80: fb06 0714 0110 0106 0106 0106 010e 010a  ................
-00007f90: 020e 0110 0104 0110 0110 0102 0102 0102  ................
-00007fa0: fb06 0714 0110 0106 0106 0106 010e 017a  ...............z
-00007fb0: 1361 746f 6d5f 6669 742e 7368 6f77 5f70  .atom_fit.show_p
-00007fc0: 6561 6b73 4e29 0372 0100 0000 72ec 0000  eaksN).r....r...
-00007fd0: 0072 ed00 0000 2902 72ec 0000 0072 ef00  .r....).r....r..
-00007fe0: 0000 2903 720c 0000 0072 ec00 0000 7228  ..).r....r....r(
-00007ff0: 0000 0029 0272 ec00 0000 7211 0100 0029  ...).r....r....)
-00008000: 0ada 085f 5f6e 616d 655f 5fda 0a5f 5f6d  ...__name__..__m
-00008010: 6f64 756c 655f 5fda 0c5f 5f71 7561 6c6e  odule__..__qualn
-00008020: 616d 655f 5fda 075f 5f64 6f63 5f5f 72eb  ame__..__doc__r.
-00008030: 0000 0072 f800 0000 7208 0100 0072 4200  ...r....r....rB.
-00008040: 0000 7210 0100 0072 1501 0000 7219 0000  ..r....r....r...
-00008050: 0072 1900 0000 7219 0000 0072 1a00 0000  .r....r....r....
-00008060: 72e1 0000 0053 0300 0073 0e00 0000 0801  r....S...s......
-00008070: 0438 080a 0a1c 0a7f 0a1f 0812 72e1 0000  .8..........r...
-00008080: 0029 0372 1c00 0000 721d 0000 0072 1e00  .).r....r....r..
-00008090: 0000 2904 7257 0000 0072 5800 0000 7259  ..).rW...rX...rY
-000080a0: 0000 0046 2904 7257 0000 0072 5800 0000  ...F).rW...rX...
-000080b0: 7259 0000 0072 8900 0000 2901 728c 0000  rY...r....).r...
-000080c0: 0029 0172 8900 0000 2902 7221 0000 0054  .).r....).r!...T
-000080d0: 2935 5a0f 736b 696d 6167 652e 6665 6174  )5Z.skimage.feat
-000080e0: 7572 655a 0766 6561 7475 7265 722e 0000  ureZ.featurer...
-000080f0: 005a 116d 6174 706c 6f74 6c69 622e 7079  .Z.matplotlib.py
-00008100: 706c 6f74 5a06 7079 706c 6f74 7237 0000  plotZ.pyplotr7..
-00008110: 005a 056e 756d 7079 7211 0000 005a 0d73  .Z.numpyr....Z.s
-00008120: 6369 7079 2e6e 6469 6d61 6765 5a07 6e64  cipy.ndimageZ.nd
-00008130: 696d 6167 6572 3100 0000 5a0e 7363 6970  imager1...Z.scip
-00008140: 792e 6f70 7469 6d69 7a65 da08 6f70 7469  y.optimize..opti
-00008150: 6d69 7a65 726a 0000 005a 1173 6369 7079  mizerj...Z.scipy
-00008160: 2e69 6e74 6572 706f 6c61 7465 5a0b 696e  .interpolateZ.in
-00008170: 7465 7270 6f6c 6174 6572 dd00 0000 5a1c  terpolater....Z.
-00008180: 6d61 7470 6c6f 746c 6962 5f73 6361 6c65  matplotlib_scale
-00008190: 6261 722e 7363 616c 6562 6172 72f7 0000  bar.scalebarr...
-000081a0: 0072 f200 0000 da08 7374 656d 746f 6f6c  .r......stemtool
-000081b0: 7249 0000 005a 0974 7164 6d2e 6175 746f  rI...Z.tqdm.auto
-000081c0: 7202 0000 00da 0674 7970 696e 6772 0300  r......typingr..
-000081d0: 0000 7204 0000 0072 0500 0000 5a08 6e70  ..r....r....Z.np
-000081e0: 7479 7069 6e67 7206 0000 0072 0700 0000  typingr....r....
-000081f0: 7208 0000 0072 0900 0000 720a 0000 0072  r....r....r....r
-00008200: 0b00 0000 721b 0000 0072 4200 0000 7256  ....r....rB...rV
-00008210: 0000 0072 8800 0000 728b 0000 0072 9e00  ...r....r....r..
-00008220: 0000 72a8 0000 0072 b400 0000 72c2 0000  ..r....r....r...
-00008230: 0072 c800 0000 72ca 0000 0072 d200 0000  .r....r....r....
-00008240: 72da 0000 0072 df00 0000 72e0 0000 0072  r....r....r....r
-00008250: 5100 0000 da06 6f62 6a65 6374 72e1 0000  Q.....objectr...
-00008260: 0072 1900 0000 7219 0000 0072 1900 0000  .r....r....r....
-00008270: 721a 0000 00da 083c 6d6f 6475 6c65 3e01  r......<module>.
-00008280: 0000 0073 4c00 0000 0c01 0c01 0801 0c01  ...sL...........
-00008290: 0c01 0c01 0c01 0801 0c01 1401 2003 080e  ............ ...
-000082a0: 0a3b 082c 0001 0001 0001 00fa 0a7f 0002  .;.,............
-000082b0: 0001 0001 0001 00fa 0a7f 000b 0a1c 0829  ...............)
-000082c0: 0848 081a 082d 0822 0a37 0820 0821 0a46  .H...-.".7. .!.F
-000082d0: 080c 080b                                ....
+00000070: 0100 6400 6401 6c11 5a11 6400 6401 6c12  ..d.d.l.Z.d.d.l.
+00000080: 6d13 5a14 0100 6400 6401 6c15 5a16 6402  m.Z...d.d.l.Z.d.
+00000090: 6403 8400 5a17 6430 6407 6408 8401 5a18  d...Z.d0d.d...Z.
+000000a0: 6409 640a 8400 5a19 090b 090c 090d 090e  d.d...Z.........
+000000b0: 6431 640f 6410 8401 5a1a 090b 090c 090d  d1d.d...Z.......
+000000c0: 0911 6432 6412 6413 8401 5a1b 6433 6415  ..d2d.d...Z.d3d.
+000000d0: 6416 8401 5a1c 6417 6418 8400 5a1d 6419  d...Z.d.d...Z.d.
+000000e0: 641a 8400 5a1e 641b 641c 8400 5a1f 641d  d...Z.d.d...Z.d.
+000000f0: 641e 8400 5a20 641f 6420 8400 5a21 6434  d...Z d.d ..Z!d4
+00000100: 6421 6422 8401 5a22 6423 6424 8400 5a23  d!d"..Z"d#d$..Z#
+00000110: 6425 6426 8400 5a24 6435 6429 642a 8401  d%d&..Z$d5d)d*..
+00000120: 5a25 642b 642c 8400 5a26 642d 640a 8400  Z%d+d,..Z&d-d...
+00000130: 5a19 4700 642e 642f 8400 642f 6527 8303  Z.G.d.d/..d/e'..
+00000140: 5a28 6401 5300 2936 e900 0000 004e 6302  Z(d.S.)6.....Nc.
+00000150: 0000 0000 0000 0000 0000 0007 0000 0006  ................
+00000160: 0000 0043 0000 0073 9600 0000 7400 a001  ...C...s....t...
+00000170: 7c00 a101 7d02 6401 7d03 7402 7c02 8301  |...}.d.}.t.|...
+00000180: 7d04 7c03 7c04 6b00 7249 7400 6a03 7c02  }.|.|.k.rIt.j.|.
+00000190: 6400 6400 8502 6401 6402 8502 6602 1900  d.d...d.d...f...
+000001a0: 7c02 7c03 6401 6402 8502 6602 1900 1800  |.|.d.d...f.....
+000001b0: 6402 1300 6403 6404 8d02 6405 1300 7d05  d...d.d...d...}.
+000001c0: 7c05 7c01 6b04 7d06 6406 7c06 7c03 3c00  |.|.k.}.d.|.|.<.
+000001d0: 7400 a001 7c02 7c06 6400 6400 8502 6602  t...|.|.d.d...f.
+000001e0: 1900 a101 7d02 7c03 6403 1700 7d03 7402  ....}.|.d...}.t.
+000001f0: 7c02 8301 7d04 7c03 7c04 6b00 730f 7c02  |...}.|.|.k.s.|.
+00000200: 5300 2907 4e72 0100 0000 e902 0000 00e9  S.).Nr..........
+00000210: 0100 0000 a901 da04 6178 6973 e700 0000  ........axis....
+00000220: 0000 00e0 3f54 2904 da02 6e70 da04 636f  ....?T)...np..co
+00000230: 7079 da03 6c65 6eda 0373 756d 2907 5a09  py..len..sum).Z.
+00000240: 696e 7075 745f 6172 72da 056c 696d 6974  input_arr..limit
+00000250: da06 7265 7375 6c74 da02 6969 5a06 6e65  ..result..iiZ.ne
+00000260: 776c 656e da04 6469 7374 5a08 6469 7374  wlen..distZ.dist
+00000270: 626f 6f6c a900 720f 0000 00fa 3c62 7569  bool..r.....<bui
+00000280: 6c64 2f62 6469 7374 2e6c 696e 7578 2d78  ld/bdist.linux-x
+00000290: 3836 5f36 342f 6567 672f 7374 656d 746f  86_64/egg/stemto
+000002a0: 6f6c 2f61 6669 742f 6174 6f6d 5f70 6f73  ol/afit/atom_pos
+000002b0: 6974 696f 6e73 2e70 79da 1172 656d 6f76  itions.py..remov
+000002c0: 655f 636c 6f73 655f 7661 6c73 0c00 0000  e_close_vals....
+000002d0: 7318 0000 000a 0104 0108 0108 0136 0108  s............6..
+000002e0: 0108 0116 0108 0108 0108 fa04 0772 1100  .............r..
+000002f0: 0000 e90a 0000 00e7 9a99 9999 9999 b93f  ...............?
+00000300: a902 e914 0000 0072 1500 0000 6304 0000  .......r....c...
+00000310: 0000 0000 0000 0000 000a 0000 0009 0000  ................
+00000320: 0043 0000 0073 fa00 0000 7c00 7400 a001  .C...s....|.t...
+00000330: 7c00 a101 1800 7400 a002 7c00 a101 7400  |.....t...|...t.
+00000340: a001 7c00 a101 1800 1b00 7d00 7400 6a03  ..|.......}.t.j.
+00000350: 7c00 7c02 6b04 7400 6a04 6401 8d02 7d04  |.|.k.t.j.d...}.
+00000360: 7c00 7c04 1400 7c02 1800 7d05 6402 7c05  |.|...|...}.d.|.
+00000370: 7c05 6402 6b00 3c00 7c05 6403 7c02 1800  |.d.k.<.|.d.|...
+00000380: 1b00 7d05 7405 6a06 7c05 7407 7c01 6404  ..}.t.j.|.t.|.d.
+00000390: 1b00 8301 6405 6406 8d03 7d06 7408 6a09  ....d.d...}.t.j.
+000003a0: a00a 7c06 a101 6402 1900 7d07 7408 6a09  ..|...d...}.t.j.
+000003b0: a00b 7c06 7c07 740c 6403 7400 a00d 7c07  ..|.|.t.d.t...|.
+000003c0: a101 6403 1700 8302 a103 7d08 7400 a003  ..d.......}.t...
+000003d0: 7c08 a101 7d09 740e 7c09 7c01 8302 7d09  |...}.t.|.|...}.
+000003e0: 740f 6a10 7c03 6407 8d01 0100 740f a011  t.j.|.d.....t...
+000003f0: 7c00 a101 0100 740f 6a12 7c09 6408 6408  |.....t.j.|.d.d.
+00000400: 8502 6403 6602 1900 7c09 6408 6408 8502  ..d.f...|.d.d...
+00000410: 6402 6602 1900 6409 640a 640b 8d04 0100  d.f...d.d.d.....
+00000420: 7c09 5300 290c 61fd 0300 000a 2020 2020  |.S.).a.....    
+00000430: 4669 6e64 2061 746f 6d20 6d61 7869 6d61  Find atom maxima
+00000440: 2070 6978 656c 7320 696e 2069 6d61 6765   pixels in image
+00000450: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
+00000460: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00000470: 0a20 2020 2064 6174 615f 696d 6167 653a  .    data_image:
+00000480: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00000490: 2020 2020 2020 2020 204f 7269 6769 6e61           Origina
+000004a0: 6c20 6174 6f6d 6963 2072 6573 6f6c 7574  l atomic resolut
+000004b0: 696f 6e20 696d 6167 650a 2020 2020 6469  ion image.    di
+000004c0: 7374 3a20 2020 2020 2020 696e 740a 2020  st:       int.  
+000004d0: 2020 2020 2020 2020 2020 2020 2020 4176                Av
+000004e0: 6572 6167 6520 6469 7374 616e 6365 2062  erage distance b
+000004f0: 6574 7765 656e 206e 6569 6768 626f 7269  etween neighbori
+00000500: 6e67 2070 6561 6b73 0a20 2020 2020 2020  ng peaks.       
+00000510: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+00000520: 2069 7320 3130 0a20 2020 2074 6872 6573   is 10.    thres
+00000530: 683a 2020 2020 2066 6c6f 6174 0a20 2020  h:     float.   
+00000540: 2020 2020 2020 2020 2020 2020 2054 6865               The
+00000550: 2063 7574 6f66 6620 696e 7465 6e73 6974   cutoff intensit
+00000560: 7920 7661 6c75 6520 6265 6c6f 7720 7768  y value below wh
+00000570: 6963 6820 6120 7065 616b 0a20 2020 2020  ich a peak.     
+00000580: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00000590: 6e6f 7420 6265 2064 6574 6563 7465 640a  not be detected.
+000005a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000005b0: 4465 6661 756c 7420 6973 2030 2e31 0a20  Default is 0.1. 
+000005c0: 2020 2069 6d73 697a 653a 2020 2020 206e     imsize:     n
+000005d0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+000005e0: 2020 2020 2020 2053 697a 6520 6f66 2074         Size of t
+000005f0: 6865 2064 6973 706c 6179 2069 6d61 6765  he display image
+00000600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000610: 2044 6566 6175 6c74 2069 7320 2832 302c   Default is (20,
+00000620: 3230 290a 0a20 2020 2052 6574 7572 6e73  20)..    Returns
+00000630: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00000640: 2070 6561 6b73 3a20 6e64 6172 7261 790a   peaks: ndarray.
+00000650: 2020 2020 2020 2020 2020 204c 6973 7420             List 
+00000660: 6f66 2070 6561 6b20 706f 7369 7469 6f6e  of peak position
+00000670: 7320 6173 2079 2c20 780a 0a20 2020 204e  s as y, x..    N
+00000680: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+00000690: 2020 2054 6869 7320 6973 2061 2077 7261     This is a wra
+000006a0: 7070 6572 2061 726f 756e 6420 7468 6520  pper around the 
+000006b0: 736b 696d 6167 6520 7065 616b 2066 696e  skimage peak fin
+000006c0: 6469 6e67 0a20 2020 206d 6f64 756c 6520  ding.    module 
+000006d0: 7768 6963 6820 6669 6e64 7320 7468 6520  which finds the 
+000006e0: 7065 616b 7320 7769 7468 2061 2067 6976  peaks with a giv
+000006f0: 656e 2074 6872 6573 686f 6c64 0a20 2020  en threshold.   
+00000700: 2076 616c 7565 2061 6e64 2061 6e20 696e   value and an in
+00000710: 7465 722d 7065 616b 2073 6570 6172 6174  ter-peak separat
+00000720: 696f 6e2e 2054 6865 2066 756e 6374 696f  ion. The functio
+00000730: 6e0a 2020 2020 6164 6469 7469 6f6e 616c  n.    additional
+00000740: 6c79 2070 6c6f 7473 2074 6865 2070 6561  ly plots the pea
+00000750: 6b20 706f 7369 7469 6f6e 7320 6f6e 2074  k positions on t
+00000760: 6865 206f 7269 6769 6e61 6c0a 2020 2020  he original.    
+00000770: 696d 6167 6520 7468 7573 2075 7365 7273  image thus users
+00000780: 2063 616e 206d 6f64 6966 7920 7468 6520   can modify the 
+00000790: 696e 7075 7420 7661 6c75 6573 206f 660a  input values of.
+000007a0: 2020 2020 7468 7265 7368 6f6c 6420 616e      threshold an
+000007b0: 6420 6469 7374 616e 6365 2074 6f20 656e  d distance to en
+000007c0: 7375 7265 2074 6865 2072 6967 6874 2070  sure the right p
+000007d0: 6561 6b73 2061 7265 0a20 2020 2073 656c  eaks are.    sel
+000007e0: 6563 7465 642e 0a0a 2020 2020 3a41 7574  ected...    :Aut
+000007f0: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
+00000800: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
+00000810: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
+00000820: 6f76 3e0a 2020 2020 a901 5a05 6474 7970  ov>.    ..Z.dtyp
+00000830: 6572 0100 0000 7203 0000 00e9 0300 0000  er....r.........
+00000840: 46a9 025a 0c6d 696e 5f64 6973 7461 6e63  F..Z.min_distanc
+00000850: 65da 0769 6e64 6963 6573 a901 5a07 6669  e..indices..Z.fi
+00000860: 6773 697a 654e da01 62e9 0f00 0000 a902  gsizeN..b.......
+00000870: da01 63da 0173 2913 7207 0000 00da 0461  ..c..s).r......a
+00000880: 6d69 6eda 0461 6d61 78da 0561 7272 6179  min..amax..array
+00000890: da05 666c 6f61 74da 0673 6b66 6561 74da  ..float..skfeat.
+000008a0: 0e70 6561 6b5f 6c6f 6361 6c5f 6d61 78da  .peak_local_max.
+000008b0: 0369 6e74 da04 7363 6e64 da0c 6d65 6173  .int..scnd..meas
+000008c0: 7572 656d 656e 7473 da05 6c61 6265 6cda  urements..label.
+000008d0: 0e63 656e 7465 725f 6f66 5f6d 6173 73da  .center_of_mass.
+000008e0: 0572 616e 6765 da03 6d61 7872 1100 0000  .range..maxr....
+000008f0: da03 706c 74da 0666 6967 7572 65da 0669  ..plt..figure..i
+00000900: 6d73 686f 77da 0773 6361 7474 6572 290a  mshow..scatter).
+00000910: 5a0a 6461 7461 5f69 6d61 6765 720e 0000  Z.data_imager...
+00000920: 00da 0674 6872 6573 68da 0669 6d73 697a  ...thresh..imsiz
+00000930: 655a 0a74 6872 6573 685f 6172 72da 0b64  eZ.thresh_arr..d
+00000940: 6174 615f 7468 7265 7368 da0a 6461 7461  ata_thresh..data
+00000950: 5f70 6561 6b73 da0b 7065 616b 5f6c 6162  _peaks..peak_lab
+00000960: 656c 73da 0c6d 6572 6765 645f 7065 616b  els..merged_peak
+00000970: 73da 0570 6561 6b73 720f 0000 0072 0f00  s..peaksr....r..
+00000980: 0000 7210 0000 00da 0970 6561 6b73 5f76  ..r......peaks_v
+00000990: 6973 1a00 0000 7328 0000 000c 2512 0104  is....s(....%...
+000009a0: ff14 030c 010c 010c 0104 010e 0106 ff10  ................
+000009b0: 0306 0116 0104 ff0a 030a 010c 010a 012a  ...............*
+000009c0: 0104 0172 3800 0000 6302 0000 0000 0000  ...r8...c.......
+000009d0: 0000 0000 000b 0000 0007 0000 0043 0000  .............C..
+000009e0: 0073 2401 0000 7400 a001 6401 a101 0100  .s$...t...d.....
+000009f0: 7402 7c01 8301 7d02 7403 6a04 7c02 7403  t.|...}.t.j.|.t.
+00000a00: 6a05 6402 8d02 7d03 7403 6a04 7c02 7403  j.d...}.t.j.|.t.
+00000a10: 6a05 6402 8d02 7d04 7403 a006 7c02 a101  j.d...}.t...|...
+00000a20: 4400 5d28 7d05 7403 6a07 7c01 6403 6403  D.](}.t.j.|.d.d.
+00000a30: 8502 6404 6405 8502 6602 1900 7c01 7c05  ..d.d...f...|.|.
+00000a40: 6404 6405 8502 6602 1900 1800 6405 1300  d.d...f.....d...
+00000a50: 6406 6407 8d02 7d04 7403 a008 7c04 7c04  d.d...}.t...|.|.
+00000a60: 6404 6b04 1900 a101 6408 1300 7c03 7c05  d.k.....d...|.|.
+00000a70: 3c00 711e 6408 7403 a009 7c03 a101 1400  <.q.d.t...|.....
+00000a80: 7d06 7403 6a04 7c02 6409 6602 7403 6a05  }.t.j.|.d.f.t.j.
+00000a90: 6402 8d02 7d07 7403 a00a 7c02 a101 4400  d...}.t...|...D.
+00000aa0: 5d32 7d05 7c01 7c05 6406 6602 1900 7d08  ]2}.|.|.d.f...}.
+00000ab0: 7c01 7c05 6404 6602 1900 7d09 740b 6a0c  |.|.d.f...}.t.j.
+00000ac0: a00d 7c00 7c08 7c09 7c06 a104 7d0a 7403  ..|.|.|.|...}.t.
+00000ad0: a00e 7c0a 6404 6405 8502 1900 a101 7c07  ..|.d.d.......|.
+00000ae0: 7c05 6404 6405 8502 6602 3c00 7c0a 6405  |.d.d...f.<.|.d.
+00000af0: 6409 8502 1900 7c07 7c05 6405 6409 8502  d.....|.|.d.d...
+00000b00: 6602 3c00 715d 7c07 5300 290a 612a 0200  f.<.q]|.S.).a*..
+00000b10: 000a 2020 2020 5369 6e67 6c65 2047 6175  ..    Single Gau
+00000b20: 7373 6961 6e20 5065 616b 2041 746f 6d20  ssian Peak Atom 
+00000b30: 5265 6669 6e65 6d65 6e74 0a0a 2020 2020  Refinement..    
+00000b40: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+00000b50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 696d  ---------.    im
+00000b60: 6167 655f 6461 7461 3a20 6e64 6172 7261  age_data: ndarra
+00000b70: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00000b80: 2020 4f72 6967 696e 616c 2061 746f 6d69    Original atomi
+00000b90: 6320 7265 736f 6c75 7469 6f6e 2069 6d61  c resolution ima
+00000ba0: 6765 0a20 2020 2070 6f73 6974 696f 6e73  ge.    positions
+00000bb0: 3a20 206e 6461 7272 6179 0a20 2020 2020  :  ndarray.     
+00000bc0: 2020 2020 2020 2020 2020 2049 6e74 656e             Inten
+00000bd0: 7369 7479 206d 696e 696d 612f 6d61 7869  sity minima/maxi
+00000be0: 6d61 206c 6973 740a 0a20 2020 2052 6574  ma list..    Ret
+00000bf0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00000c00: 0a20 2020 2072 6566 5f61 7272 3a20 6e64  .    ref_arr: nd
+00000c10: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00000c20: 2020 204c 6973 7420 6f66 2072 6566 696e     List of refin
+00000c30: 6564 2070 6561 6b20 706f 7369 7469 6f6e  ed peak position
+00000c40: 7320 6173 2079 2c20 780a 0a20 2020 204e  s as y, x..    N
+00000c50: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+00000c60: 2020 2054 6869 7320 6973 2074 6865 2073     This is the s
+00000c70: 696e 676c 6520 4761 7573 7369 616e 2070  ingle Gaussian p
+00000c80: 6561 6b20 6669 7474 696e 6720 7465 6368  eak fitting tech
+00000c90: 6e69 7175 650a 2020 2020 7768 6572 6520  nique.    where 
+00000ca0: 7468 6520 696e 6974 6961 6c20 6174 6f6d  the initial atom
+00000cb0: 2070 6f73 6974 696f 6e73 2061 7265 2066   positions are f
+00000cc0: 6974 7465 6420 7769 7468 2061 0a20 2020  itted with a.   
+00000cd0: 2073 696e 676c 6520 3244 2047 6175 7373   single 2D Gauss
+00000ce0: 6961 6e20 6675 6e63 7469 6f6e 2e20 5468  ian function. Th
+00000cf0: 6520 6365 6e74 6572 206f 6620 7468 6520  e center of the 
+00000d00: 4761 7573 7369 616e 0a20 2020 2069 7320  Gaussian.    is 
+00000d10: 7265 7475 726e 6564 2061 7320 7468 6520  returned as the 
+00000d20: 7265 6669 6e65 6420 6174 6f6d 2070 6f73  refined atom pos
+00000d30: 6974 696f 6e2e 0a20 2020 20da 0669 676e  ition..    ..ign
+00000d40: 6f72 6572 1600 0000 4e72 0100 0000 7202  orer....Nr....r.
+00000d50: 0000 0072 0300 0000 7204 0000 0072 0600  ...r....r....r..
+00000d60: 0000 e907 0000 0029 0fda 0877 6172 6e69  .......)...warni
+00000d70: 6e67 73da 0e66 696c 7465 7277 6172 6e69  ngs..filterwarni
+00000d80: 6e67 7372 0900 0000 7207 0000 00da 0565  ngsr....r......e
+00000d90: 6d70 7479 7223 0000 005a 0761 7072 616e  mptyr#...Z.apran
+00000da0: 6765 720a 0000 0072 2000 0000 da06 6d65  ger....r .....me
+00000db0: 6469 616e da06 6172 616e 6765 da02 7374  dian..arange..st
+00000dc0: da04 7574 696c da13 6669 745f 6761 7573  ..util..fit_gaus
+00000dd0: 7369 616e 3244 5f6d 6173 6bda 0466 6c69  sian2D_mask..fli
+00000de0: 7029 0bda 0a69 6d61 6765 5f64 6174 61da  p)...image_data.
+00000df0: 0970 6f73 6974 696f 6e73 da06 6e6f 5f70  .positions..no_p
+00000e00: 6f73 720e 0000 00da 0363 6364 720d 0000  osr......ccdr...
+00000e10: 00da 086d 6564 5f64 6973 74da 0772 6566  ...med_dist..ref
+00000e20: 5f61 7272 da05 706f 735f 78da 0570 6f73  _arr..pos_x..pos
+00000e30: 5f79 da0a 7265 6669 6e65 645f 6969 720f  _y..refined_iir.
+00000e40: 0000 0072 0f00 0000 7210 0000 00da 0c72  ...r....r......r
+00000e50: 6566 696e 655f 6174 6f6d 7355 0000 0073  efine_atomsU...s
+00000e60: 2000 0000 0a17 0801 1001 1001 0e01 3201   .............2.
+00000e70: 1c01 0e01 1401 0e01 0c01 0c01 1201 1e01  ................
+00000e80: 1a01 0401 724d 0000 00e9 1000 0000 e755  ....rM.........U
+00000e90: 5555 5555 55e5 3fe7 7b14 ae47 e17a 843f  UUUUU.?.{..G.z.?
+00000ea0: 4663 0600 0000 0000 0000 0000 0000 2500  Fc............%.
+00000eb0: 0000 0c00 0000 4300 0000 73aa 0300 0074  ......C...s....t
+00000ec0: 00a0 0164 01a1 0101 0074 02a0 0374 047c  ...d.....t...t.|
+00000ed0: 0183 01a1 017d 0674 02a0 0574 047c 0183  .....}.t...t.|..
+00000ee0: 01a1 0144 005d 287d 0774 026a 067c 0164  ...D.](}.t.j.|.d
+00000ef0: 0264 0285 0264 0364 0485 0266 0219 007c  .d...d.d...f...|
+00000f00: 017c 0764 0364 0485 0266 0219 0018 0064  .|.d.d...f.....d
+00000f10: 0413 0064 0564 068d 027d 0874 02a0 077c  ...d.d...}.t...|
+00000f20: 087c 0864 036b 0419 00a1 0164 0713 007c  .|.d.k.....d...|
+00000f30: 067c 073c 0071 1374 02a0 087c 06a1 017d  .|.<.q.t...|...}
+00000f40: 0974 026a 097c 0174 026a 0a64 088d 027d  .t.j.|.t.j.d...}
+00000f50: 0a74 026a 0b64 037c 006a 0c64 0319 0085  .t.j.d.|.j.d....
+00000f60: 0264 037c 006a 0c64 0519 0085 0266 0219  .d.|.j.d.....f..
+00000f70: 005c 027d 0b7d 0c74 026a 037c 0264 0966  .\.}.}.t.j.|.d.f
+00000f80: 0274 026a 0a64 088d 027d 0d74 026a 0374  .t.j.d...}.t.j.t
+00000f90: 047c 0183 017c 0264 0966 0374 026a 0a64  .|...|.d.f.t.j.d
+00000fa0: 088d 027d 0e74 02a0 0574 047c 0183 01a1  ...}.t...t.|....
+00000fb0: 0144 0090 015d 507d 0f7c 017c 0f64 0366  .D...]P}.|.|.d.f
+00000fc0: 0219 007d 107c 017c 0f64 0566 0219 007d  ...}.|.|.d.f...}
+00000fd0: 1174 02a0 0d7c 0b7c 1018 00a1 017c 096b  .t...|.|.....|.k
+00000fe0: 007d 1274 02a0 0d7c 0c7c 1118 00a1 017c  .}.t...|.|.....|
+00000ff0: 096b 007d 1374 02a0 0e7c 137c 12a1 027d  .k.}.t...|.|...}
+00001000: 147c 0c7c 1419 007d 157c 0b7c 1419 007d  .|.|...}.|.|...}
+00001010: 167c 007c 1419 007d 1774 02a0 097c 17a1  .|.|...}.t...|..
+00001020: 017d 1874 02a0 057c 02a1 0144 005d c47d  .}.t...|...D.].}
+00001030: 077c 177c 1818 007d 177c 1774 02a0 077c  .|.|...}.|.t...|
+00001040: 17a1 0118 0074 02a0 0f7c 17a1 0174 02a0  .....t...|...t..
+00001050: 077c 17a1 0118 001b 007d 197c 097d 1a7c  .|.......}.|.}.|
+00001060: 157c 1666 027d 1b74 106a 11a0 127c 157c  .|.f.}.t.j...|.|
+00001070: 167c 19a1 037d 1c7c 1c64 0319 007c 0918  .|...}.|.d...|..
+00001080: 007c 1c64 0519 007c 0918 0064 0a64 0364  .|.d...|...d.d.d
+00001090: 0364 0b7c 1c64 0c19 0014 0066 067d 1d7c  .d.|.d.....f.}.|
+000010a0: 1c64 0319 007c 0917 007c 1c64 0519 007c  .d...|...|.d...|
+000010b0: 0917 0064 0d64 0e7c 1a14 0064 0e7c 1a14  ...d.d.|...d.|..
+000010c0: 0064 0e7c 1c64 0c19 0014 0066 067d 1e74  .d.|.d.....f.}.t
+000010d0: 136a 1474 106a 116a 157c 1b7c 197c 1c7c  .j.t.j.j.|.|.|.|
+000010e0: 1d7c 1e66 027c 047c 0464 0f8d 075c 027d  .|.f.|.|.d...\.}
+000010f0: 1f7d 207c 1f64 0319 007c 0d7c 0764 0566  .} |.d...|.|.d.f
+00001100: 023c 007c 1f64 0519 007c 0d7c 0764 0366  .<.|.d...|.|.d.f
+00001110: 023c 007c 1f64 1019 0074 02a0 0f7c 17a1  .<.|.d...t...|..
+00001120: 0174 02a0 077c 17a1 0118 0014 007c 0d7c  .t...|.......|.|
+00001130: 0764 1066 023c 007c 1f64 0319 007c 1118  .d.f.<.|.d...|..
+00001140: 0064 0413 007c 1f64 0519 007c 1018 0064  .d...|.d...|...d
+00001150: 0413 0017 0064 0713 007c 0d7c 0764 0466  .....d...|.|.d.f
+00001160: 023c 0074 106a 11a0 157c 1b7c 1f64 0319  .<.t.j...|.|.d..
+00001170: 007c 1f64 0519 007c 1f64 0419 007c 1f64  .|.d...|.d...|.d
+00001180: 1119 007c 1f64 0919 007c 1f64 0c19 00a1  ...|.d...|.d....
+00001190: 077d 187c 1874 02a0 0f7c 17a1 0174 02a0  .}.|.t...|...t..
+000011a0: 077c 17a1 0118 0014 0074 02a0 077c 17a1  .|.......t...|..
+000011b0: 0117 007d 1871 b77c 0d64 0264 0285 0264  ...}.q.|.d.d...d
+000011c0: 0466 0219 007c 037c 0914 006b 007d 2174  .f...|.|...k.}!t
+000011d0: 02a0 067c 0d7c 2164 1166 0219 00a1 017d  ...|.|!d.f.....}
+000011e0: 2274 02a0 067c 0d7c 2164 0366 0219 007c  "t...|.|!d.f...|
+000011f0: 0d7c 2164 1166 0219 0014 00a1 017c 221b  .|!d.f.......|".
+00001200: 007d 2374 02a0 067c 0d7c 2164 0566 0219  .}#t...|.|!d.f..
+00001210: 007c 0d7c 2164 1166 0219 0014 00a1 017c  .|.|!d.f.......|
+00001220: 221b 007d 2474 02a0 167c 237c 2466 02a1  "..}$t...|#|$f..
+00001230: 017c 0a7c 0f64 0364 0485 0266 023c 007c  .|.|.d.d...f.<.|
+00001240: 0d7c 0e7c 0f64 0264 0285 0264 0264 0285  .|.|.d.d...d.d..
+00001250: 0266 033c 0071 7a7c 0590 0172 d37c 0a7c  .f.<.qz|...r.|.|
+00001260: 0e66 0253 007c 0a53 0029 1261 4506 0000  .f.S.|.S.).aE...
+00001270: 0a20 2020 204d 756c 7469 2d47 6175 7373  .    Multi-Gauss
+00001280: 6961 6e20 5065 616b 2052 6566 696e 656d  ian Peak Refinem
+00001290: 656e 7420 286d 7066 6974 290a 0a20 2020  ent (mpfit)..   
+000012a0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000012b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206d  ----------.    m
+000012c0: 6169 6e5f 696d 6167 653a 2020 2020 206e  ain_image:     n
+000012d0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+000012e0: 2020 2020 2020 2020 2020 204f 7269 6769             Origi
+000012f0: 6e61 6c20 6174 6f6d 6963 2072 6573 6f6c  nal atomic resol
+00001300: 7574 696f 6e20 696d 6167 650a 2020 2020  ution image.    
+00001310: 696e 6974 6961 6c5f 7065 616b 733a 2020  initial_peaks:  
+00001320: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00001330: 2020 2020 2020 2020 2020 2020 5920 616e              Y an
+00001340: 6420 5820 706f 7369 7469 6f6e 206f 6620  d X position of 
+00001350: 6d61 7869 6d61 2f6d 696e 696d 610a 2020  maxima/minima.  
+00001360: 2020 7065 616b 5f72 756e 733a 2020 2020    peak_runs:    
+00001370: 2020 696e 740a 2020 2020 2020 2020 2020    int.          
+00001380: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
+00001390: 206f 6620 6d75 6c74 692d 4761 7573 7369   of multi-Gaussi
+000013a0: 616e 2073 7465 7073 2074 6f20 7275 6e0a  an steps to run.
+000013b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000013c0: 2020 2020 4465 6661 756c 7420 6973 2031      Default is 1
+000013d0: 360a 2020 2020 6375 745f 706f 696e 743a  6.    cut_point:
+000013e0: 2020 2020 2020 666c 6f61 740a 2020 2020        float.    
+000013f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001400: 5261 7469 6f20 6f66 2064 6973 7461 6e63  Ratio of distanc
+00001410: 6520 746f 2074 6865 206d 6564 6961 6e20  e to the median 
+00001420: 696e 7465 722d 7065 616b 0a20 2020 2020  inter-peak.     
+00001430: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00001440: 6973 7461 6e63 652e 204f 6e6c 7920 4761  istance. Only Ga
+00001450: 7573 7369 616e 2070 6561 6b73 2062 656c  ussian peaks bel
+00001460: 6f77 2074 6869 7320 6172 650a 2020 2020  ow this are.    
+00001470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001480: 7573 6564 2066 6f72 2074 6865 2066 696e  used for the fin
+00001490: 616c 2065 7374 696d 6174 696f 6e0a 2020  al estimation.  
+000014a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000014b0: 2020 4465 6661 756c 7420 6973 2032 2f33    Default is 2/3
+000014c0: 0a20 2020 2074 6f6c 5f76 616c 3a20 2020  .    tol_val:   
+000014d0: 2020 2020 2066 6c6f 6174 0a20 2020 2020       float.     
+000014e0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000014f0: 6865 2074 6f6c 6572 616e 6365 2076 616c  he tolerance val
+00001500: 7565 2074 6f20 7573 6520 666f 7220 6120  ue to use for a 
+00001510: 6761 7573 7369 616e 2065 7374 696d 6174  gaussian estimat
+00001520: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00001530: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
+00001540: 6973 2030 2e30 310a 2020 2020 7065 616b  is 0.01.    peak
+00001550: 7061 7261 6d73 3a20 2020 2020 626f 6f6c  params:     bool
+00001560: 6561 6e0a 2020 2020 2020 2020 2020 2020  ean.            
+00001570: 2020 2020 2020 2020 4966 2073 6574 2074          If set t
+00001580: 6f20 5472 7565 2c20 7468 656e 2074 6865  o True, then the
+00001590: 2069 6e64 6976 6964 7561 6c20 4761 7573   individual Gaus
+000015a0: 7369 616e 2070 6561 6b73 2061 6e64 0a20  sian peaks and. 
+000015b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000015c0: 2020 2074 6865 6972 2061 6d70 6c69 7475     their amplitu
+000015d0: 6465 7320 6172 6520 616c 736f 2072 6574  des are also ret
+000015e0: 7572 6e65 642e 0a20 2020 2020 2020 2020  urned..         
+000015f0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00001600: 6c74 2069 7320 4661 6c73 650a 0a20 2020  lt is False..   
+00001610: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00001620: 2d2d 2d2d 0a20 2020 206d 7066 6974 5f70  ----.    mpfit_p
+00001630: 6561 6b73 3a20 6e64 6172 7261 790a 2020  eaks: ndarray.  
+00001640: 2020 2020 2020 2020 2020 2020 2020 204c                 L
+00001650: 6973 7420 6f66 2072 6566 696e 6564 2070  ist of refined p
+00001660: 6561 6b20 706f 7369 7469 6f6e 7320 6173  eak positions as
+00001670: 2079 2c20 780a 0a20 2020 204e 6f74 6573   y, x..    Notes
+00001680: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2054  .    -----.    T
+00001690: 6869 7320 6973 2074 6865 206d 756c 7469  his is the multi
+000016a0: 706c 6520 4761 7573 7369 616e 2070 6561  ple Gaussian pea
+000016b0: 6b20 6669 7474 696e 6720 7465 6368 6e69  k fitting techni
+000016c0: 7175 650a 2020 2020 7768 6572 6520 7468  que.    where th
+000016d0: 6520 696e 6974 6961 6c20 6174 6f6d 2070  e initial atom p
+000016e0: 6f73 6974 696f 6e73 2061 7265 2066 6974  ositions are fit
+000016f0: 7465 6420 7769 7468 2061 0a20 2020 2073  ted with a.    s
+00001700: 696e 676c 6520 3244 2047 6175 7373 6961  ingle 2D Gaussia
+00001710: 6e20 6675 6e63 7469 6f6e 2e20 5468 6520  n function. The 
+00001720: 6361 6c63 756c 6174 6564 2047 6175 7373  calculated Gauss
+00001730: 6961 6e20 6973 0a20 2020 2074 6865 6e20  ian is.    then 
+00001740: 7375 6273 6571 7565 6e74 6c79 2073 7562  subsequently sub
+00001750: 7472 6163 7465 6420 616e 6420 7265 6669  tracted and refi
+00001760: 6e65 6420 6167 6169 6e2e 2054 6865 2066  ned again. The f
+00001770: 696e 616c 0a20 2020 2072 6566 696e 6564  inal.    refined
+00001780: 2070 6f73 6974 696f 6e20 6973 2074 6865   position is the
+00001790: 2073 756d 206f 6620 616c 6c20 7468 6520   sum of all the 
+000017a0: 706f 7369 7469 6f6e 7320 7363 616c 6564  positions scaled
+000017b0: 0a20 2020 2077 6974 6820 7468 6520 616d  .    with the am
+000017c0: 706c 6974 7564 650a 0a20 2020 2052 6566  plitude..    Ref
+000017d0: 6572 656e 6365 733a 0a20 2020 202d 2d2d  erences:.    ---
+000017e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2031 5d5f  --------.    1]_
+000017f0: 2c20 4d75 6b68 6572 6a65 652c 2044 2e2c  , Mukherjee, D.,
+00001800: 204d 6961 6f2c 204c 2e2c 2053 746f 6e65   Miao, L., Stone
+00001810: 2c20 472e 2061 6e64 2041 6c65 6d2c 204e  , G. and Alem, N
+00001820: 2e2c 0a20 2020 2020 2020 2020 6d70 6669  .,.         mpfi
+00001830: 743a 2061 2072 6f62 7573 7420 6d65 7468  t: a robust meth
+00001840: 6f64 2066 6f72 2066 6974 7469 6e67 2061  od for fitting a
+00001850: 746f 6d69 6320 7265 736f 6c75 7469 6f6e  tomic resolution
+00001860: 2069 6d61 6765 730a 2020 2020 2020 2020   images.        
+00001870: 2077 6974 6820 6d75 6c74 6970 6c65 2047   with multiple G
+00001880: 6175 7373 6961 6e20 7065 616b 732e 2041  aussian peaks. A
+00001890: 6476 2053 7472 7563 7420 4368 656d 2049  dv Struct Chem I
+000018a0: 6d61 6720 362c 2031 2028 3230 3230 292e  mag 6, 1 (2020).
+000018b0: 0a20 2020 2072 3900 0000 4e72 0100 0000  .    r9...Nr....
+000018c0: 7202 0000 0072 0300 0000 7204 0000 0072  r....r....r....r
+000018d0: 0600 0000 7216 0000 00e9 0400 0000 e94c  ....r..........L
+000018e0: ffff ffe7 0000 0000 0000 04c0 e905 0000  ................
+000018f0: 00e9 b400 0000 e700 0000 0000 0004 40a9  ..............@.
+00001900: 03da 0662 6f75 6e64 735a 0466 746f 6c5a  ...boundsZ.ftolZ
+00001910: 0478 746f 6ce9 ffff ffff 7217 0000 0029  .xtol.....r....)
+00001920: 1772 3b00 0000 723c 0000 0072 0700 0000  .r;...r<...r....
+00001930: da05 7a65 726f 7372 0900 0000 723f 0000  ..zerosr....r?..
+00001940: 0072 0a00 0000 7220 0000 0072 3e00 0000  .r....r ...r>...
+00001950: da0a 7a65 726f 735f 6c69 6b65 7223 0000  ..zeros_liker#..
+00001960: 00da 056d 6772 6964 da05 7368 6170 65da  ...mgrid..shape.
+00001970: 0361 6273 5a0b 6c6f 6769 6361 6c5f 616e  .absZ.logical_an
+00001980: 6472 2100 0000 7240 0000 0072 4100 0000  dr!...r@...rA...
+00001990: da12 696e 6974 6961 6c69 7a65 5f67 6175  ..initialize_gau
+000019a0: 7373 3244 da03 7370 6fda 0963 7572 7665  ss2D..spo..curve
+000019b0: 5f66 6974 da14 6761 7573 7369 616e 5f32  _fit..gaussian_2
+000019c0: 445f 6675 6e63 7469 6f6e da07 6173 6172  D_function..asar
+000019d0: 7261 7929 25da 0a6d 6169 6e5f 696d 6167  ray)%..main_imag
+000019e0: 65da 0d69 6e69 7469 616c 5f70 6561 6b73  e..initial_peaks
+000019f0: da09 7065 616b 5f72 756e 73da 0963 7574  ..peak_runs..cut
+00001a00: 5f70 6f69 6e74 da07 746f 6c5f 7661 6c5a  _point..tol_valZ
+00001a10: 0a70 6561 6b70 6172 616d 7372 0e00 0000  .peakparamsr....
+00001a20: 720d 0000 0072 4700 0000 7248 0000 00da  r....rG...rH....
+00001a30: 0b6d 7066 6974 5f70 6561 6b73 da02 7979  .mpfit_peaks..yy
+00001a40: da02 7878 da05 6376 616c 735a 0970 6561  ..xx..cvalsZ.pea
+00001a50: 6b5f 7661 6c73 da02 6a6a 5a06 7973 7461  k_vals..jjZ.ysta
+00001a60: 7274 5a06 7873 7461 7274 5a05 7375 625f  rtZ.xstartZ.sub_
+00001a70: 795a 0573 7562 5f78 da03 7375 62da 0578  yZ.sub_x..sub..x
+00001a80: 7661 6c73 da05 7976 616c 73da 057a 7661  vals..yvals..zva
+00001a90: 6c73 da05 7a63 616c 63da 057a 6761 7573  ls..zcalc..zgaus
+00001aa0: 5a0b 6d61 736b 5f72 6164 6975 73da 0278  Z.mask_radius..x
+00001ab0: 79da 0d69 6e69 7469 616c 5f67 7565 7373  y..initial_guess
+00001ac0: da0b 6c6f 7765 725f 626f 756e 64da 0b75  ..lower_bound..u
+00001ad0: 7070 6572 5f62 6f75 6e64 da04 706f 7074  pper_bound..popt
+00001ae0: da01 5fda 0e72 6571 7569 7265 645f 6376  .._..required_cv
+00001af0: 616c 73da 0574 6f74 616c da07 795f 6d70  als..total..y_mp
+00001b00: 6669 74da 0778 5f6d 7066 6974 720f 0000  fit..x_mpfitr...
+00001b10: 0072 0f00 0000 7210 0000 00da 056d 7066  .r....r......mpf
+00001b20: 6974 7e00 0000 7388 0000 000a 350e 0112  it~...s.....5...
+00001b30: 0132 011c 010a 0110 0126 0114 011a 0114  .2.......&......
+00001b40: 010c 010c 0112 0112 010c 0108 0108 0108  ................
+00001b50: 010a 010e 0108 0122 0104 0108 0110 010a  ......."........
+00001b60: 020a 0102 0102 0102 010a 0104 fa0a 090a  ................
+00001b70: 0102 0106 0106 010a 0104 fa04 0806 0102  ................
+00001b80: 0102 0102 0106 0102 0102 010a f910 0910  ................
+00001b90: 0124 011e 0202 010c fe06 0326 0104 ff24  .$.........&...$
+00001ba0: 0318 0112 0122 0122 011a 0118 0106 0108  ....."."........
+00001bb0: 0104 0272 7e00 0000 e700 0000 0000 00d0  ...r~...........
+00001bc0: 3f63 0600 0000 0000 0000 0000 0000 2d00  ?c............-.
+00001bd0: 0000 0c00 0000 4300 0000 7376 0400 0074  ......C...sv...t
+00001be0: 00a0 0164 01a1 0101 0074 02a0 0374 047c  ...d.....t...t.|
+00001bf0: 0183 01a1 017d 0674 02a0 0574 047c 0183  .....}.t...t.|..
+00001c00: 01a1 0144 005d 287d 0774 026a 067c 0164  ...D.](}.t.j.|.d
+00001c10: 0264 0285 0264 0364 0485 0266 0219 007c  .d...d.d...f...|
+00001c20: 017c 0764 0364 0485 0266 0219 0018 0064  .|.d.d...f.....d
+00001c30: 0413 0064 0564 068d 027d 0874 02a0 077c  ...d.d...}.t...|
+00001c40: 087c 0864 036b 0419 00a1 0164 0713 007c  .|.d.k.....d...|
+00001c50: 067c 073c 0071 1374 02a0 087c 06a1 017d  .|.<.q.t...|...}
+00001c60: 0974 026a 097c 0174 026a 0a64 088d 027d  .t.j.|.t.j.d...}
+00001c70: 0a74 026a 0b64 037c 006a 0c64 0319 0085  .t.j.d.|.j.d....
+00001c80: 0264 037c 006a 0c64 0519 0085 0266 0219  .d.|.j.d.....f..
+00001c90: 005c 027d 0b7d 0c7c 0964 0914 007d 0d74  .\.}.}.|.d...}.t
+00001ca0: 02a0 0574 047c 0183 01a1 0144 0090 015d  ...t.|.....D...]
+00001cb0: d07d 0e7c 017c 0e64 0264 0285 0266 0219  .}.|.|.d.d...f..
+00001cc0: 005c 027d 0f7d 1074 026a 067c 0164 0264  .\.}.}.t.j.|.d.d
+00001cd0: 0285 0264 0364 0485 0266 0219 007c 017c  ...d.d...f...|.|
+00001ce0: 0e64 0364 0485 0266 0219 0018 0064 0413  .d.d...f.....d..
+00001cf0: 0064 0564 068d 0264 0713 007d 117c 117c  .d.d...d...}.|.|
+00001d00: 0d6b 007d 1264 0a7c 127c 1164 0b6b 003c  .k.}.d.|.|.d.k.<
+00001d10: 007c 017c 1264 0364 0485 0266 0219 007d  .|.|.d.d...f...}
+00001d20: 137c 0b7c 0f18 0064 0413 007c 0c7c 1018  .|.|...d...|.|..
+00001d30: 0064 0413 0017 007c 0d64 0413 006b 007d  .d.....|.d...k.}
+00001d40: 147c 0c7c 1419 007d 157c 0b7c 1419 007d  .|.|...}.|.|...}
+00001d50: 167c 007c 1419 007d 177c 157c 1018 0064  .|.|...}.|.|...d
+00001d60: 0413 007c 167c 0f18 0064 0413 0017 007d  ...|.|...d.....}
+00001d70: 1874 02a0 0374 047c 1583 0174 047c 1383  .t...t.|...t.|..
+00001d80: 0166 02a1 017d 1974 02a0 0574 047c 1383  .f...}.t...t.|..
+00001d90: 01a1 0144 005d 1c7d 077c 157c 137c 0764  ...D.].}.|.|.|.d
+00001da0: 0566 0219 0018 0064 0413 007c 167c 137c  .f.....d...|.|.|
+00001db0: 0764 0366 0219 0018 0064 0413 0017 007c  .d.f.....d.....|
+00001dc0: 1964 0264 0285 027c 0766 023c 0071 db74  .d.d...|.f.<.q.t
+00001dd0: 026a 077c 1964 0564 068d 027d 1a7c 1864  .j.|.d.d...}.|.d
+00001de0: 057c 0517 007c 1a14 006b 007d 1b7c 157c  .|...|...k.}.|.|
+00001df0: 1b19 007d 1c7c 167c 1b19 007d 1d7c 177c  ...}.|.|...}.|.|
+00001e00: 1b19 007d 1e74 02a0 0d7c 1c7c 1018 0064  ...}.t...|.|...d
+00001e10: 0413 007c 1d7c 0f18 0064 0413 0017 0064  ...|.|...d.....d
+00001e20: 0713 00a1 017d 1f74 02a0 097c 1ea1 017d  .....}.t...|...}
+00001e30: 207c 1c7c 1d66 027d 2174 026a 037c 0264   |.|.f.}!t.j.|.d
+00001e40: 0c66 0274 026a 0a64 088d 027d 2274 02a0  .f.t.j.d...}"t..
+00001e50: 057c 02a1 0144 005d b77d 077c 1e7c 2018  .|...D.].}.|.| .
+00001e60: 007d 1e7c 1e74 02a0 077c 1ea1 0118 0074  .}.|.t...|.....t
+00001e70: 02a0 0d7c 1ea1 0174 02a0 077c 1ea1 0118  ...|...t...|....
+00001e80: 001b 007d 2374 0e6a 0fa0 107c 1c7c 1d7c  ...}#t.j...|.|.|
+00001e90: 23a1 037d 2474 02a0 077c 1ca1 0174 02a0  #..}$t...|...t..
+00001ea0: 077c 1da1 0164 0d64 0364 0364 0e7c 2464  .|...d.d.d.d.|$d
+00001eb0: 0f19 0014 0066 067d 2574 02a0 0d7c 1ca1  .....f.}%t...|..
+00001ec0: 0174 02a0 0d7c 1da1 0164 107c 1f7c 1f64  .t...|...d.|.|.d
+00001ed0: 097c 2464 0f19 0014 0066 067d 2674 116a  .|$d.....f.}&t.j
+00001ee0: 1274 0e6a 0f6a 137c 217c 237c 247c 257c  .t.j.j.|!|#|$|%|
+00001ef0: 2666 027c 047c 0464 118d 075c 027d 277d  &f.|.|.d...\.}'}
+00001f00: 287c 2764 0319 007c 227c 0764 0566 023c  (|'d...|"|.d.f.<
+00001f10: 007c 2764 0519 007c 227c 0764 0366 023c  .|'d...|"|.d.f.<
+00001f20: 007c 2764 1219 0074 02a0 0d7c 1ea1 0174  .|'d...t...|...t
+00001f30: 02a0 077c 1ea1 0118 0014 007c 227c 0764  ...|.......|"|.d
+00001f40: 1266 023c 007c 2764 0319 007c 1018 0064  .f.<.|'d...|...d
+00001f50: 0413 007c 2764 0519 007c 0f18 0064 0413  ...|'d...|...d..
+00001f60: 0017 0064 0713 007c 227c 0764 0466 023c  ...d...|"|.d.f.<
+00001f70: 0074 0e6a 0fa0 137c 217c 2764 0319 007c  .t.j...|!|'d...|
+00001f80: 2764 0519 007c 2764 0419 007c 2764 1319  'd...|'d...|'d..
+00001f90: 007c 2764 0c19 007c 2764 0f19 00a1 077d  .|'d...|'d.....}
+00001fa0: 207c 2074 02a0 0d7c 1ea1 0174 02a0 077c   | t...|...t...|
+00001fb0: 1ea1 0118 0014 0074 02a0 077c 1ea1 0117  .......t...|....
+00001fc0: 007d 2090 0171 3c7c 2264 0264 0285 0264  .} ..q<|"d.d...d
+00001fd0: 0466 0219 007c 037c 1f14 006b 007d 2974  .f...|.|...k.})t
+00001fe0: 02a0 067c 227c 2964 1366 0219 00a1 017d  ...|"|)d.f.....}
+00001ff0: 2a74 02a0 067c 227c 2964 0366 0219 007c  *t...|"|)d.f...|
+00002000: 227c 2964 1366 0219 0014 00a1 017c 2a1b  "|)d.f.......|*.
+00002010: 007d 2b74 02a0 067c 227c 2964 0566 0219  .}+t...|"|)d.f..
+00002020: 007c 227c 2964 1366 0219 0014 00a1 017c  .|"|)d.f.......|
+00002030: 2a1b 007d 2c74 02a0 147c 2b7c 2c66 02a1  *..},t...|+|,f..
+00002040: 017c 0a7c 0e64 0364 0485 0266 023c 0071  .|.|.d.d...f.<.q
+00002050: 677c 0a53 0029 1461 d206 0000 0a20 2020  g|.S.).a.....   
+00002060: 204d 756c 7469 2d47 6175 7373 6961 6e20   Multi-Gaussian 
+00002070: 5065 616b 2052 6566 696e 656d 656e 7420  Peak Refinement 
+00002080: 286d 7066 6974 290a 0a20 2020 2050 6172  (mpfit)..    Par
+00002090: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+000020a0: 2d2d 2d2d 2d2d 0a20 2020 206d 6169 6e5f  ------.    main_
+000020b0: 696d 6167 653a 2020 2020 206e 6461 7272  image:     ndarr
+000020c0: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+000020d0: 2020 2020 2020 204f 7269 6769 6e61 6c20         Original 
+000020e0: 6174 6f6d 6963 2072 6573 6f6c 7574 696f  atomic resolutio
+000020f0: 6e20 696d 6167 650a 2020 2020 696e 6974  n image.    init
+00002100: 6961 6c5f 7065 616b 733a 2020 6e64 6172  ial_peaks:  ndar
+00002110: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00002120: 2020 2020 2020 2020 5920 616e 6420 5820          Y and X 
+00002130: 706f 7369 7469 6f6e 206f 6620 6d61 7869  position of maxi
+00002140: 6d61 2f6d 696e 696d 610a 2020 2020 7065  ma/minima.    pe
+00002150: 616b 5f72 756e 733a 2020 2020 2020 696e  ak_runs:      in
+00002160: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+00002170: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+00002180: 6d75 6c74 692d 4761 7573 7369 616e 2073  multi-Gaussian s
+00002190: 7465 7073 2074 6f20 7275 6e0a 2020 2020  teps to run.    
+000021a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000021b0: 4465 6661 756c 7420 6973 2031 360a 2020  Default is 16.  
+000021c0: 2020 6375 745f 706f 696e 743a 2020 2020    cut_point:    
+000021d0: 2020 666c 6f61 740a 2020 2020 2020 2020    float.        
+000021e0: 2020 2020 2020 2020 2020 2020 5261 7469              Rati
+000021f0: 6f20 6f66 2064 6973 7461 6e63 6520 746f  o of distance to
+00002200: 2074 6865 206d 6564 6961 6e20 696e 7465   the median inte
+00002210: 722d 7065 616b 0a20 2020 2020 2020 2020  r-peak.         
+00002220: 2020 2020 2020 2020 2020 2064 6973 7461             dista
+00002230: 6e63 652e 204f 6e6c 7920 4761 7573 7369  nce. Only Gaussi
+00002240: 616e 2070 6561 6b73 2062 656c 6f77 2074  an peaks below t
+00002250: 6869 7320 6172 650a 2020 2020 2020 2020  his are.        
+00002260: 2020 2020 2020 2020 2020 2020 7573 6564              used
+00002270: 2066 6f72 2074 6865 2066 696e 616c 2065   for the final e
+00002280: 7374 696d 6174 696f 6e0a 2020 2020 2020  stimation.      
+00002290: 2020 2020 2020 2020 2020 2020 2020 4465                De
+000022a0: 6661 756c 7420 6973 2032 2f33 0a20 2020  fault is 2/3.   
+000022b0: 2074 6f6c 5f76 616c 3a20 2020 2020 2020   tol_val:       
+000022c0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
+000022d0: 2020 2020 2020 2020 2020 2054 6865 2074             The t
+000022e0: 6f6c 6572 616e 6365 2076 616c 7565 2074  olerance value t
+000022f0: 6f20 7573 6520 666f 7220 6120 6761 7573  o use for a gaus
+00002300: 7369 616e 2065 7374 696d 6174 696f 6e0a  sian estimation.
+00002310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002320: 2020 2020 4465 6661 756c 7420 6973 2030      Default is 0
+00002330: 2e30 310a 2020 2020 626c 7572 5f66 6163  .01.    blur_fac
+00002340: 746f 723a 2020 2020 666c 6f61 740a 2020  tor:    float.  
+00002350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002360: 2020 4d61 6b65 2074 6865 2056 6f72 6f6e    Make the Voron
+00002370: 6f69 2072 6567 696f 6e73 2073 6c69 6768  oi regions sligh
+00002380: 746c 7920 6269 6767 6572 2e0a 2020 2020  tly bigger..    
+00002390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000023a0: 4465 6661 756c 7420 6973 2032 3525 2062  Default is 25% b
+000023b0: 6967 6765 720a 0a20 2020 2052 6574 7572  igger..    Retur
+000023c0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+000023d0: 2020 206d 7066 6974 5f70 6561 6b73 3a20     mpfit_peaks: 
+000023e0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+000023f0: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
+00002400: 2072 6566 696e 6564 2070 6561 6b20 706f   refined peak po
+00002410: 7369 7469 6f6e 7320 6173 2079 2c20 780a  sitions as y, x.
+00002420: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
+00002430: 2d2d 2d2d 0a20 2020 2054 6869 7320 6973  ----.    This is
+00002440: 2074 6865 206d 756c 7469 706c 6520 4761   the multiple Ga
+00002450: 7573 7369 616e 2070 6561 6b20 6669 7474  ussian peak fitt
+00002460: 696e 6720 7465 6368 6e69 7175 650a 2020  ing technique.  
+00002470: 2020 7768 6572 6520 7468 6520 696e 6974    where the init
+00002480: 6961 6c20 6174 6f6d 2070 6f73 6974 696f  ial atom positio
+00002490: 6e73 2061 7265 2066 6974 7465 6420 7769  ns are fitted wi
+000024a0: 7468 2061 0a20 2020 2073 696e 676c 6520  th a.    single 
+000024b0: 3244 2047 6175 7373 6961 6e20 6675 6e63  2D Gaussian func
+000024c0: 7469 6f6e 2e20 5468 6520 6361 6c63 756c  tion. The calcul
+000024d0: 6174 6564 2047 6175 7373 6961 6e20 6973  ated Gaussian is
+000024e0: 0a20 2020 2074 6865 6e20 7375 6273 6571  .    then subseq
+000024f0: 7565 6e74 6c79 2073 7562 7472 6163 7465  uently subtracte
+00002500: 6420 616e 6420 7265 6669 6e65 6420 6167  d and refined ag
+00002510: 6169 6e2e 2054 6865 2066 696e 616c 0a20  ain. The final. 
+00002520: 2020 2072 6566 696e 6564 2070 6f73 6974     refined posit
+00002530: 696f 6e20 6973 2074 6865 2073 756d 206f  ion is the sum o
+00002540: 6620 616c 6c20 7468 6520 706f 7369 7469  f all the positi
+00002550: 6f6e 7320 7363 616c 6564 0a20 2020 2077  ons scaled.    w
+00002560: 6974 6820 7468 6520 616d 706c 6974 7564  ith the amplitud
+00002570: 652e 2054 6865 2064 6966 6665 7265 6e63  e. The differenc
+00002580: 6520 7769 7468 2074 6865 2073 7461 6e64  e with the stand
+00002590: 6172 6420 6d70 6669 740a 2020 2020 636f  ard mpfit.    co
+000025a0: 6465 2069 7320 7468 6174 2074 6865 206d  de is that the m
+000025b0: 6173 6b69 6e67 2072 6567 696f 6e20 6973  asking region is
+000025c0: 2061 6374 7561 6c6c 7920 6368 6f73 656e   actually chosen
+000025d0: 2061 7320 610a 2020 2020 566f 726f 6e6f   as a.    Vorono
+000025e0: 6920 7265 6769 6f6e 2066 726f 6d20 7468  i region from th
+000025f0: 6520 6e65 6172 6573 7420 6e65 6967 6862  e nearest neighb
+00002600: 6f72 730a 0a20 2020 2052 6566 6572 656e  ors..    Referen
+00002610: 6365 733a 0a20 2020 202d 2d2d 2d2d 2d2d  ces:.    -------
+00002620: 2d2d 2d2d 0a20 2020 2031 5d5f 2c20 4d75  ----.    1]_, Mu
+00002630: 6b68 6572 6a65 652c 2044 2e2c 204d 6961  kherjee, D., Mia
+00002640: 6f2c 204c 2e2c 2053 746f 6e65 2c20 472e  o, L., Stone, G.
+00002650: 2061 6e64 2041 6c65 6d2c 204e 2e2c 0a20   and Alem, N.,. 
+00002660: 2020 2020 2020 2020 6d70 6669 743a 2061          mpfit: a
+00002670: 2072 6f62 7573 7420 6d65 7468 6f64 2066   robust method f
+00002680: 6f72 2066 6974 7469 6e67 2061 746f 6d69  or fitting atomi
+00002690: 6320 7265 736f 6c75 7469 6f6e 2069 6d61  c resolution ima
+000026a0: 6765 730a 2020 2020 2020 2020 2077 6974  ges.         wit
+000026b0: 6820 6d75 6c74 6970 6c65 2047 6175 7373  h multiple Gauss
+000026c0: 6961 6e20 7065 616b 732e 2041 6476 2053  ian peaks. Adv S
+000026d0: 7472 7563 7420 4368 656d 2049 6d61 6720  truct Chem Imag 
+000026e0: 362c 2031 2028 3230 3230 292e 0a0a 2020  6, 1 (2020)...  
+000026f0: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
+00002700: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
+00002710: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
+00002720: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 7239  ornl.gov>.    r9
+00002730: 0000 004e 7201 0000 0072 0200 0000 7203  ...Nr....r....r.
+00002740: 0000 0072 0400 0000 7206 0000 0072 1600  ...r....r....r..
+00002750: 0000 7256 0000 0046 7213 0000 0072 5100  ..rV...Fr....rQ.
+00002760: 0000 7252 0000 0072 5300 0000 7254 0000  ..rR...rS...rT..
+00002770: 0072 5500 0000 7257 0000 0072 5900 0000  .rU...rW...rY...
+00002780: 7217 0000 0029 1572 3b00 0000 723c 0000  r....).r;...r<..
+00002790: 0072 0700 0000 725a 0000 0072 0900 0000  .r....rZ...r....
+000027a0: 723f 0000 0072 0a00 0000 7220 0000 0072  r?...r....r ...r
+000027b0: 3e00 0000 725b 0000 0072 2300 0000 725c  >...r[...r#...r\
+000027c0: 0000 0072 5d00 0000 7221 0000 0072 4000  ...r]...r!...r@.
+000027d0: 0000 7241 0000 0072 5f00 0000 7260 0000  ..rA...r_...r`..
+000027e0: 0072 6100 0000 7262 0000 0072 6300 0000  .ra...rb...rc...
+000027f0: 292d 7264 0000 0072 6500 0000 7266 0000  )-rd...re...rf..
+00002800: 0072 6700 0000 7268 0000 005a 0b62 6c75  .rg...rh...Z.blu
+00002810: 725f 6661 6374 6f72 5a05 6469 7374 6d72  r_factorZ.distmr
+00002820: 0d00 0000 7247 0000 0072 4800 0000 7269  ....rG...rH...ri
+00002830: 0000 0072 6a00 0000 726b 0000 00da 0663  ...rj...rk.....c
+00002840: 7574 6f66 6672 6d00 0000 5a04 7970 6f73  utoffrm...Z.ypos
+00002850: 5a04 7870 6f73 720e 0000 005a 0564 6973  Z.xposr....Z.dis
+00002860: 746e 5a05 6e65 6967 6872 6e00 0000 726f  tnZ.neighrn...ro
+00002870: 0000 0072 7000 0000 7271 0000 005a 086d  ...rp...rq...Z.m
+00002880: 6169 6e64 6973 745a 0864 6973 745f 6d61  aindistZ.dist_ma
+00002890: 745a 0a6e 6569 6768 5f64 6973 745a 0776  tZ.neigh_distZ.v
+000028a0: 6f72 6f6e 6f69 5a04 7876 6f72 5a04 7976  oronoiZ.xvorZ.yv
+000028b0: 6f72 5a04 7a76 6f72 5a08 766f 725f 6469  orZ.zvorZ.vor_di
+000028c0: 7374 7272 0000 0072 7400 0000 726c 0000  strr...rt...rl..
+000028d0: 0072 7300 0000 7275 0000 0072 7600 0000  .rs...ru...rv...
+000028e0: 7277 0000 0072 7800 0000 7279 0000 0072  rw...rx...ry...r
+000028f0: 7a00 0000 727b 0000 0072 7c00 0000 727d  z...r{...r|...r}
+00002900: 0000 0072 0f00 0000 720f 0000 0072 1000  ...r....r....r..
+00002910: 0000 da0d 6d70 6669 745f 766f 726f 6e6f  ....mpfit_vorono
+00002920: 69fc 0000 0073 9a00 0000 0a39 0e01 1201  i....s.....9....
+00002930: 3201 1c01 0a01 1001 2601 0801 1401 1401  2.......&.......
+00002940: 3002 0201 04fe 0803 0c01 1001 2001 0801  0........... ...
+00002950: 0801 0801 1801 1601 1201 1201 1201 12ff  ................
+00002960: 0e03 1001 0801 0801 0801 2201 0a01 0801  ..........".....
+00002970: 1401 0e01 0801 2201 1001 0802 0801 0201  ......".........
+00002980: 0201 0201 0a01 04fa 0809 0801 0201 0201  ................
+00002990: 0201 0a01 04fa 0408 0601 0201 0201 0201  ................
+000029a0: 0601 0201 0201 0af9 1009 1001 2401 2c01  ............$.,.
+000029b0: 0601 2601 04ff 2603 1801 1201 2201 2201  ..&...&.....".".
+000029c0: 1c01 0401 7281 0000 00e7 9a99 9999 9999  ....r...........
+000029d0: c93f 6304 0000 0000 0000 0000 0000 0017  .?c.............
+000029e0: 0000 0006 0000 0043 0000 0073 7c01 0000  .......C...s|...
+000029f0: 7400 6a01 a002 7400 6a01 a003 7c00 a101  t.j...t.j...|...
+00002a00: a101 7d04 7c01 6401 1900 7d05 7c01 6402  ..}.|.d...}.|.d.
+00002a10: 1900 7d06 7404 6a05 a006 7400 a007 7c04  ..}.t.j...t...|.
+00002a20: a101 6403 a102 7d07 7408 6a09 a00a 7c07  ..d...}.t.j...|.
+00002a30: 7c05 7c06 7c02 a104 7d08 7c08 6401 1900  |.|.|...}.|.d...
+00002a40: 7d09 7c08 6402 1900 7d0a 7400 a00b 7c09  }.|.d...}.t...|.
+00002a50: 7c0a 6602 a101 7d0b 7400 6a0b 7400 a00c  |.f...}.t.j.t...
+00002a60: 7c04 a101 740d 6404 8d02 7d0c 7400 6a0e  |...t.d...}.t.j.
+00002a70: 6401 7c0c 6401 1900 8502 6401 7c0c 6402  d.|.d.....d.|.d.
+00002a80: 1900 8502 6602 1900 5c02 7d0d 7d0e 7c0d  ....f...\.}.}.|.
+00002a90: 7c0a 1800 6405 1300 7c0e 7c09 1800 6405  |...d...|.|...d.
+00002aa0: 1300 1700 6406 1300 7c02 6b00 7d0f 7400  ....d...|.k.}.t.
+00002ab0: a00f 7c0f a101 7d10 7c10 a010 7400 6a11  ..|...}.|...t.j.
+00002ac0: a101 7d10 7404 6a05 a006 7c10 6402 a102  ..}.t.j...|.d...
+00002ad0: 7d11 7400 a012 7c04 7c11 a102 7d12 7400  }.t...|.|...}.t.
+00002ae0: 6a01 a013 7c12 a101 7d13 7400 a007 7c13  j...|...}.t...|.
+00002af0: a101 7d14 7c14 7400 a014 7c14 a101 1800  ..}.|.t...|.....
+00002b00: 7400 a015 7c14 a101 7400 a014 7c14 a101  t...|...t...|...
+00002b10: 1800 1b00 7d14 6401 7c14 7c14 7c03 6b00  ....}.d.|.|.|.k.
+00002b20: 3c00 6402 7c14 7c14 7c03 6b04 3c00 7404  <.d.|.|.|.k.<.t.
+00002b30: 6a05 a006 7c14 6403 a102 7d15 6401 7c15  j...|.d...}.d.|.
+00002b40: 7c15 7c03 6b00 3c00 6402 7c15 7c15 7c03  |.|.k.<.d.|.|.|.
+00002b50: 6b04 3c00 7400 a012 7c00 7c15 a102 7d16  k.<.t...|.|...}.
+00002b60: 7c16 7c13 7c0b 7c15 6604 5300 2907 4e72  |.|.|.|.f.S.).Nr
+00002b70: 0100 0000 7203 0000 0072 1700 0000 7216  ....r....r....r.
+00002b80: 0000 0072 0200 0000 7206 0000 0029 1672  ...r....r....).r
+00002b90: 0700 0000 da03 6666 74da 0866 6674 7368  ......fft..fftsh
+00002ba0: 6966 74da 0466 6674 3272 2700 0000 da07  ift..fft2r'.....
+00002bb0: 6669 6c74 6572 73da 0f67 6175 7373 6961  filters..gaussia
+00002bc0: 6e5f 6669 6c74 6572 725e 0000 0072 4000  n_filterr^...r@.
+00002bd0: 0000 7241 0000 0072 4200 0000 7263 0000  ..rA...rB...rc..
+00002be0: 0072 5d00 0000 7226 0000 0072 5c00 0000  .r]...r&...r\...
+00002bf0: 7208 0000 00da 0661 7374 7970 655a 0766  r......astypeZ.f
+00002c00: 6c6f 6174 3634 da08 6d75 6c74 6970 6c79  loat64..multiply
+00002c10: 5a05 6966 6674 3272 2000 0000 7221 0000  Z.ifft2r ...r!..
+00002c20: 0029 175a 0e6f 7269 6769 6e61 6c5f 696d  .).Z.original_im
+00002c30: 6167 65da 0663 656e 7465 72da 0672 6164  age..center..rad
+00002c40: 6975 73da 0974 6872 6573 686f 6c64 5a0d  ius..thresholdZ.
+00002c50: 696d 6167 655f 666f 7572 6965 7272 4a00  image_fourierrJ.
+00002c60: 0000 724b 0000 00da 0d62 6c75 7272 6564  ..rK.....blurred
+00002c70: 5f69 6d61 6765 da0b 6669 7474 6564 5f64  _image..fitted_d
+00002c80: 6966 665a 056e 6577 5f78 5a05 6e65 775f  iffZ.new_xZ.new_
+00002c90: 79da 0a6e 6577 5f63 656e 7465 72da 0a73  y..new_center..s
+00002ca0: 697a 655f 696d 6167 65da 0279 56da 0278  ize_image..yV..x
+00002cb0: 5672 6e00 0000 5a06 6369 7263 6c65 5a0d  Vrn...Z.circleZ.
+00002cc0: 6669 6c74 6572 6564 5f63 6972 63da 0c6d  filtered_circ..m
+00002cd0: 6173 6b65 645f 696d 6167 655a 0a53 4145  asked_imageZ.SAE
+00002ce0: 445f 696d 6167 655a 086d 6167 5f53 4145  D_imageZ.mag_SAE
+00002cf0: 445a 0d66 696c 7465 7265 645f 5341 4544  DZ.filtered_SAED
+00002d00: 5a16 666f 7572 6965 725f 7365 6c65 6374  Z.fourier_select
+00002d10: 6564 5f69 6d61 6765 720f 0000 0072 0f00  ed_imager....r..
+00002d20: 0000 7210 0000 00da 0c66 6f75 7269 6572  ..r......fourier
+00002d30: 5f6d 6173 6b86 0100 0073 3200 0000 1401  _mask....s2.....
+00002d40: 0801 0801 1401 1201 0801 0801 0e01 1401  ................
+00002d50: 2201 2001 0a01 0c01 0e01 0c01 0c01 0a01  ". .............
+00002d60: 2201 0c01 0c01 0e01 0c01 0c01 0c01 0c01  "...............
+00002d70: 7294 0000 0063 0400 0000 0000 0000 0000  r....c..........
+00002d80: 0000 0b00 0000 0700 0000 4300 0000 73ac  ..........C...s.
+00002d90: 0000 0074 006a 01a0 0274 006a 01a0 037c  ...t.j...t.j...|
+00002da0: 00a1 01a1 017d 0474 046a 05a0 0674 00a0  .....}.t.j...t..
+00002db0: 0774 00a0 087c 04a1 01a1 0164 01a1 027d  .t...|.....d...}
+00002dc0: 0574 096a 0a64 0264 038d 015c 027d 067d  .t.j.d.d...\.}.}
+00002dd0: 0774 096a 0b7c 0164 0464 0564 0664 078d  .t.j.|.d.d.d.d..
+00002de0: 047d 0874 096a 0b7c 0264 0464 0864 0664  .}.t.j.|.d.d.d.d
+00002df0: 078d 047d 0974 096a 0b7c 0364 0464 0964  ...}.t.j.|.d.d.d
+00002e00: 0664 078d 047d 0a7c 076a 0c7c 0564 0a64  .d...}.|.j.|.d.d
+00002e10: 0b8d 0201 007c 07a0 0d7c 08a1 0101 007c  .....|...|.....|
+00002e20: 07a0 0d7c 09a1 0101 007c 07a0 0d7c 0aa1  ...|.....|...|..
+00002e30: 0101 0074 09a0 0ea1 0001 0064 0c53 0029  ...t.......d.S.)
+00002e40: 0d61 6102 0000 0a20 2020 2046 696e 6420  .aa....    Find 
+00002e50: 7468 6520 6469 6666 7261 6374 696f 6e20  the diffraction 
+00002e60: 7370 6f74 7320 7669 7375 616c 6c79 2e0a  spots visually..
+00002e70: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00002e80: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00002e90: 2020 2069 6d61 6765 3a20 206e 6461 7272     image:  ndarr
+00002ea0: 6179 0a20 2020 2020 2020 2020 2020 204f  ay.            O
+00002eb0: 7269 6769 6e61 6c20 696d 6167 650a 2020  riginal image.  
+00002ec0: 2020 6369 7263 5f63 3a20 6e64 6172 7261    circ_c: ndarra
+00002ed0: 790a 2020 2020 2020 2020 2020 2020 506f  y.            Po
+00002ee0: 7369 7469 6f6e 206f 6620 7468 6520 6365  sition of the ce
+00002ef0: 6e74 7261 6c20 6265 616d 2069 6e0a 2020  ntral beam in.  
+00002f00: 2020 2020 2020 2020 2020 7468 6520 466f            the Fo
+00002f10: 7572 6965 7220 7061 7474 6572 6e0a 2020  urier pattern.  
+00002f20: 2020 6369 7263 5f79 3a20 6e64 6172 7261    circ_y: ndarra
+00002f30: 790a 2020 2020 2020 2020 2020 2020 506f  y.            Po
+00002f40: 7369 7469 6f6e 206f 6620 7468 6520 7920  sition of the y 
+00002f50: 6265 616d 2069 6e0a 2020 2020 2020 2020  beam in.        
+00002f60: 2020 2020 7468 6520 466f 7572 6965 7220      the Fourier 
+00002f70: 7061 7474 6572 6e0a 2020 2020 6369 7263  pattern.    circ
+00002f80: 5f78 3a20 6e64 6172 7261 790a 2020 2020  _x: ndarray.    
+00002f90: 2020 2020 2020 2020 506f 7369 7469 6f6e          Position
+00002fa0: 206f 6620 7468 6520 7820 6265 616d 2069   of the x beam i
+00002fb0: 6e0a 2020 2020 2020 2020 2020 2020 7468  n.            th
+00002fc0: 6520 466f 7572 6965 7220 7061 7474 6572  e Fourier patter
+00002fd0: 6e0a 0a0a 2020 2020 4e6f 7465 730a 2020  n...    Notes.  
+00002fe0: 2020 2d2d 2d2d 2d0a 2020 2020 5075 7420    -----.    Put 
+00002ff0: 6369 7263 6c65 7320 696e 2072 6564 2863  circles in red(c
+00003000: 656e 7472 616c 292c 2079 2862 6c75 6529  entral), y(blue)
+00003010: 2061 6e64 2078 2867 7265 656e 290a 2020   and x(green).  
+00003020: 2020 6f6e 2074 6865 2064 6966 6672 6163    on the diffrac
+00003030: 7469 6f6e 2070 6174 7465 726e 2074 6f20  tion pattern to 
+00003040: 6170 7072 6f78 696d 6174 656c 7920 6b6e  approximately kn
+00003050: 6f77 0a20 2020 2074 6865 2070 6f73 6974  ow.    the posit
+00003060: 696f 6e73 2e0a 0a20 2020 203a 4175 7468  ions...    :Auth
+00003070: 6f72 733a 0a20 2020 2044 6562 616e 6773  ors:.    Debangs
+00003080: 6875 204d 756b 6865 726a 6565 203c 6d75  hu Mukherjee <mu
+00003090: 6b68 6572 6a65 6564 406f 726e 6c2e 676f  kherjeed@ornl.go
+000030a0: 763e 0a20 2020 2072 1700 0000 7214 0000  v>.    r....r...
+000030b0: 0072 1a00 0000 721c 0000 005a 0372 6564  .r....r....Z.red
+000030c0: e71f 85eb 51b8 1ed5 3f29 02da 0563 6f6c  ....Q...?)...col
+000030d0: 6f72 da05 616c 7068 615a 0462 6c75 655a  or..alphaZ.blueZ
+000030e0: 0567 7265 656e 5a04 6772 6179 a901 da04  .greenZ.gray....
+000030f0: 636d 6170 4e29 0f72 0700 0000 7283 0000  cmapN).r....r...
+00003100: 0072 8400 0000 7285 0000 0072 2700 0000  .r....r....r'...
+00003110: 7286 0000 0072 8700 0000 da05 6c6f 6731  r....r......log1
+00003120: 3072 5e00 0000 722d 0000 005a 0873 7562  0r^...r-...Z.sub
+00003130: 706c 6f74 735a 0643 6972 636c 6572 2f00  plotsZ.Circler/.
+00003140: 0000 da0a 6164 645f 6172 7469 7374 5a04  ....add_artistZ.
+00003150: 7368 6f77 290b da05 696d 6167 655a 0663  show)...imageZ.c
+00003160: 6972 635f 635a 0663 6972 635f 795a 0663  irc_cZ.circ_yZ.c
+00003170: 6972 635f 785a 0869 6d61 6765 5f66 745a  irc_xZ.image_ftZ
+00003180: 0a6c 6f67 5f61 6273 5f66 74da 0166 5a02  .log_abs_ft..fZ.
+00003190: 6178 5a09 6369 7263 5f63 5f69 6d5a 0963  axZ.circ_c_imZ.c
+000031a0: 6972 635f 795f 696d 5a09 6369 7263 5f78  irc_y_imZ.circ_x
+000031b0: 5f69 6d72 0f00 0000 720f 0000 0072 1000  _imr....r....r..
+000031c0: 0000 da16 6669 6e64 5f64 6966 6672 6163  ....find_diffrac
+000031d0: 7469 6f6e 5f73 706f 7473 a201 0000 7316  tion_spots....s.
+000031e0: 0000 0014 1c1a 0110 0112 0112 0112 010e  ................
+000031f0: 010a 010a 010a 010c 0172 9e00 0000 6306  .........r....c.
+00003200: 0000 0000 0000 0000 0000 0017 0000 0008  ................
+00003210: 0000 0043 0000 0073 7002 0000 7c00 6a00  ...C...sp...|.j.
+00003220: 7d06 7401 a002 7c06 6401 1900 0b00 6402  }.t...|.d.....d.
+00003230: 1b00 7c06 6401 1900 6402 1b00 6401 a103  ..|.d...d...d...
+00003240: 7c06 6401 1900 1b00 7d07 7401 a002 7c06  |.d.....}.t...|.
+00003250: 6403 1900 0b00 6402 1b00 7c06 6403 1900  d.....d...|.d...
+00003260: 6402 1b00 6401 a103 7c06 6403 1900 1b00  d...d...|.d.....
+00003270: 7d08 7401 a003 7401 a004 7c07 a101 a101  }.t...t...|.....
+00003280: 7d09 7401 a003 7401 a004 7c08 a101 a101  }.t...t...|.....
+00003290: 7d0a 7c0a 7c09 6602 7d0b 6401 7c04 7c04  }.|.|.f.}.d.|.|.
+000032a0: 6403 6b02 3c00 6401 7c05 7c05 6403 6b02  d.k.<.d.|.|.d.k.
+000032b0: 3c00 7c02 7c01 1800 7d0c 7401 a005 7c0c  <.|.|...}.t...|.
+000032c0: 7c04 6403 6402 8502 1900 a102 7d0c 7c03  |.d.d.......}.|.
+000032d0: 7c01 1800 7d0d 7401 a005 7c0d 7c05 6403  |...}.t...|.|.d.
+000032e0: 6402 8502 1900 a102 7d0d 7c0c 7c0b 1400  d.......}.|.|...
+000032f0: 7d0e 7c0d 7c0b 1400 7d0f 7401 a006 7401  }.|.|...}.t...t.
+00003300: a007 7c0e 6403 1900 7401 6a08 a009 7c0e  ..|.d...t.j...|.
+00003310: a101 1b00 a101 a101 7d10 6401 7401 6a08  ........}.d.t.j.
+00003320: a009 7c0e a101 1b00 7d11 7401 a006 7401  ..|.....}.t...t.
+00003330: a007 7c0f 6403 1900 7401 6a08 a009 7c0f  ..|.d...t.j...|.
+00003340: a101 1b00 a101 a101 7d12 6401 7401 6a08  ........}.d.t.j.
+00003350: a009 7c0f a101 1b00 7d13 7c11 7401 a00a  ..|.....}.|.t...
+00003360: 7401 a00b 7c10 6404 1800 a101 a101 1400  t...|.d.........
+00003370: 7c11 7401 a00c 7401 a00b 7c10 6404 1800  |.t...t...|.d...
+00003380: a101 a101 1400 6602 7d14 7c13 7401 a00a  ......f.}.|.t...
+00003390: 7401 a00b 7c12 6404 1800 a101 a101 1400  t...|.d.........
+000033a0: 7c13 7401 a00c 7401 a00b 7c12 6404 1800  |.t...t...|.d...
+000033b0: a101 a101 1400 6602 7d15 7401 a00d 7c14  ......f.}.t...|.
+000033c0: 6401 1900 7c14 6403 1900 6602 7c15 6401  d...|.d...f.|.d.
+000033d0: 1900 7c15 6403 1900 6602 6602 a101 7d16  ..|.d...f.f...}.
+000033e0: 7401 a00e 7401 a00f 7c16 6403 6405 6405  t...t...|.d.d.d.
+000033f0: 8502 6602 1900 a101 a101 7401 a00e 7c16  ..f.......t...|.
+00003400: 6403 6405 6405 8502 6602 1900 a101 6b04  d.d.d...f.....k.
+00003410: 9001 720c 6406 7c16 6403 6405 6405 8502  ..r.d.|.d.d.d...
+00003420: 6602 1900 1400 7c16 6403 6405 6405 8502  f.....|.d.d.d...
+00003430: 6602 3c00 7401 a00e 7401 a00f 7c16 6401  f.<.t...t...|.d.
+00003440: 6405 6405 8502 6602 1900 a101 a101 7401  d.d...f.......t.
+00003450: a00e 7c16 6401 6405 6405 8502 6602 1900  ..|.d.d.d...f...
+00003460: a101 6b04 9001 7236 6406 7c16 6401 6405  ..k...r6d.|.d.d.
+00003470: 6405 8502 6602 1900 1400 7c16 6401 6405  d...f.....|.d.d.
+00003480: 6405 8502 6602 3c00 7c16 5300 2907 610f  d...f.<.|.S.).a.
+00003490: 0300 000a 2020 2020 436f 6e76 6572 7420  ....    Convert 
+000034a0: 7468 6520 666f 7572 6965 7220 706f 7369  the fourier posi
+000034b0: 7469 6f6e 7320 746f 2069 6d61 6765 2061  tions to image a
+000034c0: 7865 732e 0a0a 2020 2020 5061 7261 6d65  xes...    Parame
+000034d0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+000034e0: 2d2d 2d0a 2020 2020 696d 6167 653a 2020  ---.    image:  
+000034f0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00003500: 2020 2020 4f72 6967 696e 616c 2069 6d61      Original ima
+00003510: 6765 0a20 2020 2066 6f75 725f 633a 206e  ge.    four_c: n
+00003520: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00003530: 2020 2050 6f73 6974 696f 6e20 6f66 2074     Position of t
+00003540: 6865 2063 656e 7472 616c 2062 6561 6d20  he central beam 
+00003550: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
+00003560: 6865 2046 6f75 7269 6572 2070 6174 7465  he Fourier patte
+00003570: 726e 0a20 2020 2066 6f75 725f 793a 206e  rn.    four_y: n
+00003580: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00003590: 2020 2050 6f73 6974 696f 6e20 6f66 2074     Position of t
+000035a0: 6865 2079 2062 6561 6d20 696e 0a20 2020  he y beam in.   
+000035b0: 2020 2020 2020 2020 2074 6865 2046 6f75           the Fou
+000035c0: 7269 6572 2070 6174 7465 726e 0a20 2020  rier pattern.   
+000035d0: 2066 6f75 725f 783a 206e 6461 7272 6179   four_x: ndarray
+000035e0: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+000035f0: 6974 696f 6e20 6f66 2074 6865 2078 2062  ition of the x b
+00003600: 6561 6d20 696e 0a20 2020 2020 2020 2020  eam in.         
+00003610: 2020 2074 6865 2046 6f75 7269 6572 2070     the Fourier p
+00003620: 6174 7465 726e 0a0a 2020 2020 5265 7475  attern..    Retu
+00003630: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+00003640: 2020 2020 636f 6f72 6473 3a20 6e64 6172      coords: ndar
+00003650: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00003660: 4178 6573 2063 6f2d 6f72 6469 6e61 7465  Axes co-ordinate
+00003670: 7320 696e 2074 6865 2072 6561 6c20 696d  s in the real im
+00003680: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+00003690: 2061 7320 5b79 3120 7831 0a20 2020 2020   as [y1 x1.     
+000036a0: 2020 2020 2020 2020 2020 2079 3220 7832             y2 x2
+000036b0: 5d0a 0a20 2020 204e 6f74 6573 0a20 2020  ]..    Notes.   
+000036c0: 202d 2d2d 2d2d 0a20 2020 2055 7365 2074   -----.    Use t
+000036d0: 6865 2066 6f75 7269 6572 2063 6f6f 7264  he fourier coord
+000036e0: 696e 6174 6573 2074 6f20 6465 6669 6e65  inates to define
+000036f0: 2074 6865 2061 7865 730a 2020 2020 636f   the axes.    co
+00003700: 2d6f 7264 696e 6174 6573 2069 6e20 7265  -ordinates in re
+00003710: 616c 2073 7061 6365 2c20 7768 6963 6820  al space, which 
+00003720: 7769 6c6c 2062 6520 7573 6564 0a20 2020  will be used.   
+00003730: 2074 6f20 6173 7369 676e 2065 6163 6820   to assign each 
+00003740: 6174 6f6d 2070 6f73 6974 696f 6e20 746f  atom position to
+00003750: 2061 2061 7865 7320 706f 7369 7469 6f6e   a axes position
+00003760: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
+00003770: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
+00003780: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
+00003790: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 2020  eed@ornl.gov>.  
+000037a0: 2020 7203 0000 0072 0200 0000 7201 0000    r....r....r...
+000037b0: 00e9 5a00 0000 4e72 5900 0000 2910 725d  ..Z...NrY...).r]
+000037c0: 0000 0072 0700 0000 723f 0000 00da 046d  ...r....r?.....m
+000037d0: 6561 6e5a 0464 6966 66da 0664 6976 6964  eanZ.diff..divid
+000037e0: 65da 0764 6567 7265 6573 da06 6172 6363  e..degrees..arcc
+000037f0: 6f73 da06 6c69 6e61 6c67 da04 6e6f 726d  os..linalg..norm
+00003800: da03 636f 73da 0764 6567 3272 6164 da03  ..cos..deg2rad..
+00003810: 7369 6e72 6300 0000 7221 0000 0072 5e00  sinrc...r!...r^.
+00003820: 0000 2917 729c 0000 005a 0e66 6f75 7269  ..).r....Z.fouri
+00003830: 6572 5f63 656e 7465 725a 0966 6f75 7269  er_centerZ.fouri
+00003840: 6572 5f79 5a09 666f 7572 6965 725f 785a  er_yZ.fourier_xZ
+00003850: 0679 5f61 7869 735a 0678 5f61 7869 735a  .y_axisZ.x_axisZ
+00003860: 0a69 6d61 6765 5f73 697a 655a 0271 785a  .image_sizeZ.qxZ
+00003870: 0271 795a 0264 785a 0264 795a 0d66 6f75  .qyZ.dxZ.dyZ.fou
+00003880: 7269 6572 5f63 616c 6962 5a0a 6469 7374  rier_calibZ.dist
+00003890: 616e 6365 5f79 5a0a 6469 7374 616e 6365  ance_yZ.distance
+000038a0: 5f78 5a10 666f 7572 6965 725f 6c65 6e67  _xZ.fourier_leng
+000038b0: 7468 5f79 5a10 666f 7572 6965 725f 6c65  th_yZ.fourier_le
+000038c0: 6e67 7468 5f78 5a07 616e 676c 655f 795a  ngth_xZ.angle_yZ
+000038d0: 0b72 6561 6c5f 795f 7369 7a65 5a07 616e  .real_y_sizeZ.an
+000038e0: 676c 655f 785a 0b72 6561 6c5f 785f 7369  gle_xZ.real_x_si
+000038f0: 7a65 5a06 7265 616c 5f79 5a06 7265 616c  zeZ.real_yZ.real
+00003900: 5f78 da06 636f 6f72 6473 720f 0000 0072  _x..coordsr....r
+00003910: 0f00 0000 7210 0000 00da 0b66 696e 645f  ....r......find_
+00003920: 636f 6f72 6473 cb01 0000 7344 0000 0006  coords....sD....
+00003930: 2228 0128 0110 0110 0108 010c 010c 0108  "(.(............
+00003940: 0114 0108 0114 0108 0108 0104 0118 0104  ................
+00003950: ff10 0304 0118 0104 ff10 0316 0216 0104  ................
+00003960: fe16 0516 0104 fe26 0434 0120 0134 0120  .......&.4. .4. 
+00003970: 0104 0172 aa00 0000 6303 0000 0000 0000  ...r....c.......
+00003980: 0000 0000 000b 0000 0006 0000 0043 0000  .............C..
+00003990: 0073 9400 0000 7c01 7c02 6602 6601 6401  .s....|.|.f.f.d.
+000039a0: 6402 8401 7d03 7c00 6a00 6403 1900 6404  d...}.|.j.d...d.
+000039b0: 1b00 7d04 7c00 6a00 6405 1900 6404 1b00  ..}.|.j.d...d...
+000039c0: 7d05 7401 a002 7c05 7c04 6602 a101 7d06  }.t...|.|.f...}.
+000039d0: 7401 a002 7c05 7c05 6404 1b00 1800 7c04  t...|.|.d.....|.
+000039e0: 7c04 6404 1b00 1800 6602 a101 7d07 7401  |.d.....f...}.t.
+000039f0: a002 7c05 7c05 6404 1b00 1700 7c04 7c04  ..|.|.d.....|.|.
+00003a00: 6404 1b00 1700 6602 a101 7d08 7403 6a04  d.....f...}.t.j.
+00003a10: 7c03 7c06 7c07 7c08 6602 6406 8d03 7d09  |.|.|.|.f.d...}.
+00003a20: 7c09 6a05 7d0a 7c0a 5300 2907 4e63 0200  |.j.}.|.S.).Nc..
+00003a30: 0000 0000 0000 0000 0000 0600 0000 0900  ................
+00003a40: 0000 5300 0000 7316 0100 007c 0164 0119  ..S...s....|.d..
+00003a50: 007d 027c 0164 0219 007d 0374 00a0 017c  .}.|.d...}.t...|
+00003a60: 026a 0264 0119 0064 0366 02a1 017d 047c  .j.d...d.f...}.|
+00003a70: 0264 0064 0085 0264 0164 0485 0266 0219  .d.d...d.d...f..
+00003a80: 007c 0064 0164 0485 0219 0018 007c 0464  .|.d.d.......|.d
+00003a90: 0064 0085 0264 0164 0485 0266 023c 007c  .d...d.d...f.<.|
+00003aa0: 0464 0064 0085 0264 0164 0485 0266 0219  .d.d...d.d...f..
+00003ab0: 0074 006a 03a0 047c 03a1 0110 007c 0464  .t.j...|.....|.d
+00003ac0: 0064 0085 0264 0464 0585 0266 023c 0074  .d...d.d...f.<.t
+00003ad0: 00a0 057c 0464 0064 0085 0264 0464 0585  ...|.d.d...d.d..
+00003ae0: 0266 0219 00a1 017c 0464 0064 0085 0264  .f.....|.d.d...d
+00003af0: 0564 0385 0266 023c 0074 00a0 0674 00a0  .d...f.<.t...t..
+00003b00: 077c 0464 0064 0085 0264 0666 0219 007c  .|.d.d...d.f...|
+00003b10: 0464 0064 0085 0264 0766 0219 0018 00a1  .d.d...d.f......
+00003b20: 01a1 0164 0413 0074 00a0 0674 00a0 077c  ...d...t...t...|
+00003b30: 0464 0064 0085 0264 0466 0219 007c 0464  .d.d...d.f...|.d
+00003b40: 0064 0085 0264 0566 0219 0018 00a1 01a1  .d...d.f........
+00003b50: 0164 0413 0017 0064 0813 007d 057c 0553  .d.....d...}.|.S
+00003b60: 0029 094e 7201 0000 0072 0300 0000 e906  .).Nr....r......
+00003b70: 0000 0072 0200 0000 7251 0000 0072 1700  ...r....rQ...r..
+00003b80: 0000 7254 0000 0072 0600 0000 2908 7207  ..rT...r....).r.
+00003b90: 0000 0072 5a00 0000 725d 0000 0072 a400  ...rZ...r]...r..
+00003ba0: 0000 da03 696e 76da 0572 6f75 6e64 72a0  ....inv..roundr.
+00003bb0: 0000 0072 5e00 0000 2906 5a08 7879 4365  ...r^...).Z.xyCe
+00003bc0: 6e74 6572 da0a 696e 7075 745f 6461 7461  nter..input_data
+00003bd0: 7237 0000 0072 a900 0000 da0b 6174 6f6d  r7...r......atom
+00003be0: 5f63 6f6f 7264 73da 1161 7665 7261 6765  _coords..average
+00003bf0: 5f64 6576 6961 7469 6f6e 720f 0000 0072  _deviationr....r
+00003c00: 0f00 0000 7210 0000 00da 0f6f 7269 6769  ....r......origi
+00003c10: 6e5f 6675 6e63 7469 6f6e 1402 0000 7318  n_function....s.
+00003c20: 0000 0008 0108 0114 0130 0130 012a 012e  .........0.0.*..
+00003c30: 022e 0102 ff02 0204 fd04 047a 2367 6574  ...........z#get
+00003c40: 5f6f 7269 6769 6e2e 3c6c 6f63 616c 733e  _origin.<locals>
+00003c50: 2e6f 7269 6769 6e5f 6675 6e63 7469 6f6e  .origin_function
+00003c60: 7203 0000 0072 0200 0000 7201 0000 00a9  r....r....r.....
+00003c70: 035a 0366 756e 5a02 7830 7258 0000 0029  .Z.funZ.x0rX...)
+00003c80: 0672 5d00 0000 7207 0000 0072 6300 0000  .r]...r....rc...
+00003c90: 7260 0000 00da 086d 696e 696d 697a 65da  r`.....minimize.
+00003ca0: 0178 290b 729c 0000 00da 0870 6561 6b5f  .x).r......peak_
+00003cb0: 706f 7372 a900 0000 72b1 0000 005a 0969  posr....r....Z.i
+00003cc0: 6e69 7469 616c 5f78 5a09 696e 6974 6961  nitial_xZ.initia
+00003cd0: 6c5f 7972 7500 0000 7276 0000 0072 7700  l_yru...rv...rw.
+00003ce0: 0000 da03 7265 73da 066f 7269 6769 6e72  ....res..originr
+00003cf0: 0f00 0000 720f 0000 0072 1000 0000 da0a  ....r....r......
+00003d00: 6765 745f 6f72 6967 696e 1302 0000 7316  get_origin....s.
+00003d10: 0000 0010 010e 0d0e 010e 011e 011e 0104  ................
+00003d20: 010a 0106 ff06 0304 0172 b800 0000 6304  .........r....c.
+00003d30: 0000 0000 0000 0000 0000 000f 0000 000a  ................
+00003d40: 0000 0043 0000 0073 2201 0000 7400 a001  ...C...s"...t...
+00003d50: 7400 a002 7c03 6401 1900 7c03 6402 1900  t...|.d...|.d...
+00003d60: a102 a101 7d04 7400 6a03 a004 7c03 6401  ....}.t.j...|.d.
+00003d70: 1900 7c03 6402 1900 6602 a101 7d05 7400  ..|.d...f...}.t.
+00003d80: a001 7400 a002 7c03 6403 1900 7c03 6404  ..t...|.d...|.d.
+00003d90: 1900 a102 a101 7d06 7400 6a03 a004 7c03  ......}.t.j...|.
+00003da0: 6403 1900 7c03 6404 1900 6602 a101 7d07  d...|.d...f...}.
+00003db0: 7c01 7c02 7c04 7c06 6604 6601 6405 6406  |.|.|.|.f.f.d.d.
+00003dc0: 8401 7d08 7400 a005 7c05 7c07 6602 a101  ..}.t...|.|.f...
+00003dd0: 7d09 7c09 6407 7c09 1400 1800 7d0a 7c09  }.|.d.|.....}.|.
+00003de0: 6407 7c09 1400 1700 7d0b 7406 6a07 7c08  d.|.....}.t.j.|.
+00003df0: 7c09 7c0a 7c0b 6602 6408 8d03 7d0c 7c0c  |.|.|.f.d...}.|.
+00003e00: 6a08 7d0d 7400 a005 7c0d 6409 1900 7400  j.}.t...|.d...t.
+00003e10: a009 7400 a00a 7c04 a101 a101 1400 7c0d  ..t...|.......|.
+00003e20: 6409 1900 7400 a00b 7400 a00a 7c04 a101  d...t...t...|...
+00003e30: a101 1400 6602 7c0d 640a 1900 7400 a009  ....f.|.d...t...
+00003e40: 7400 a00a 7c06 a101 a101 1400 7c0d 640a  t...|.......|.d.
+00003e50: 1900 7400 a00b 7400 a00a 7c06 a101 a101  ..t...t...|.....
+00003e60: 1400 6602 6602 a101 7d0e 7c0e 5300 290b  ..f.f...}.|.S.).
+00003e70: 4ea9 0272 0100 0000 7203 0000 00a9 0272  N..r....r......r
+00003e80: 0100 0000 7201 0000 00a9 0272 0300 0000  ....r......r....
+00003e90: 7203 0000 00a9 0272 0300 0000 7201 0000  r......r....r...
+00003ea0: 0063 0200 0000 0000 0000 0000 0000 0b00  .c..............
+00003eb0: 0000 0a00 0000 5300 0000 738c 0100 007c  ......S...s....|
+00003ec0: 0064 0119 007d 027c 0064 0219 007d 037c  .d...}.|.d...}.|
+00003ed0: 0164 0119 007d 047c 0164 0219 007d 057c  .d...}.|.d...}.|
+00003ee0: 0164 0319 007d 067c 0164 0419 007d 0774  .d...}.|.d...}.t
+00003ef0: 00a0 017c 0274 00a0 0274 00a0 037c 06a1  ...|.t...t...|..
+00003f00: 01a1 0114 007c 0274 00a0 0474 00a0 037c  .....|.t...t...|
+00003f10: 06a1 01a1 0114 0066 027c 0374 00a0 0274  .......f.|.t...t
+00003f20: 00a0 037c 07a1 01a1 0114 007c 0374 00a0  ...|.......|.t..
+00003f30: 0474 00a0 037c 07a1 01a1 0114 0066 0266  .t...|.......f.f
+00003f40: 02a1 017d 0874 00a0 057c 046a 0664 0119  ...}.t...|.j.d..
+00003f50: 0064 0566 02a1 017d 097c 0464 0064 0085  .d.f...}.|.d.d..
+00003f60: 0264 0164 0385 0266 0219 007c 0564 0164  .d.d...f...|.d.d
+00003f70: 0385 0219 0018 007c 0964 0064 0085 0264  .......|.d.d...d
+00003f80: 0164 0385 0266 023c 007c 0964 0064 0085  .d...f.<.|.d.d..
+00003f90: 0264 0164 0385 0266 0219 0074 006a 07a0  .d.d...f...t.j..
+00003fa0: 087c 08a1 0110 007c 0964 0064 0085 0264  .|.....|.d.d...d
+00003fb0: 0364 0685 0266 023c 0074 00a0 097c 0964  .d...f.<.t...|.d
+00003fc0: 0064 0085 0264 0364 0685 0266 0219 00a1  .d...d.d...f....
+00003fd0: 017c 0964 0064 0085 0264 0664 0585 0266  .|.d.d...d.d...f
+00003fe0: 023c 0074 00a0 0a74 00a0 0b7c 0964 0064  .<.t...t...|.d.d
+00003ff0: 0085 0264 0466 0219 007c 0964 0064 0085  ...d.f...|.d.d..
+00004000: 0264 0766 0219 0018 00a1 01a1 0164 0313  .d.f.........d..
+00004010: 0074 00a0 0a74 00a0 0b7c 0964 0064 0085  .t...t...|.d.d..
+00004020: 0264 0366 0219 007c 0964 0064 0085 0264  .d.f...|.d.d...d
+00004030: 0666 0219 0018 00a1 01a1 0164 0313 0017  .f.........d....
+00004040: 0064 0813 007d 0a7c 0a53 0029 094e 7201  .d...}.|.S.).Nr.
+00004050: 0000 0072 0300 0000 7202 0000 0072 1700  ...r....r....r..
+00004060: 0000 72ab 0000 0072 5100 0000 7254 0000  ..r....rQ...rT..
+00004070: 0072 0600 0000 290c 7207 0000 0072 6300  .r....).r....rc.
+00004080: 0000 72a6 0000 0072 a700 0000 72a8 0000  ..r....r....r...
+00004090: 0072 5a00 0000 725d 0000 0072 a400 0000  .rZ...r]...r....
+000040a0: 72ac 0000 0072 ad00 0000 72a0 0000 0072  r....r....r....r
+000040b0: 5e00 0000 290b 5a0a 636f 6f72 645f 7661  ^...).Z.coord_va
+000040c0: 6c73 72ae 0000 005a 056d 6167 5f74 5a05  lsr....Z.mag_tZ.
+000040d0: 6d61 675f 6272 3700 0000 5a05 7269 6769  mag_br7...Z.rigi
+000040e0: 6e5a 0561 6e67 5f74 5a05 616e 675f 625a  nZ.ang_tZ.ang_bZ
+000040f0: 0978 795f 636f 6f72 6473 72af 0000 0072  .xy_coordsr....r
+00004100: b000 0000 720f 0000 0072 0f00 0000 7210  ....r....r....r.
+00004110: 0000 00da 0f63 6f6f 7264 735f 6675 6e63  .....coords_func
+00004120: 7469 6f6e 3302 0000 732a 0000 0008 0108  tion3...s*......
+00004130: 0108 0108 0108 0108 0104 0126 0226 0102  ...........&.&..
+00004140: fe04 ff14 0630 0130 012a 012e 022e 0102  .....0.0.*......
+00004150: ff02 0204 fd04 047a 2367 6574 5f63 6f6f  .......z#get_coo
+00004160: 7264 732e 3c6c 6f63 616c 733e 2e63 6f6f  rds.<locals>.coo
+00004170: 7264 735f 6675 6e63 7469 6f6e 727f 0000  rds_functionr...
+00004180: 0072 b200 0000 7201 0000 0072 0300 0000  .r....r....r....
+00004190: 290c 7207 0000 0072 a200 0000 5a07 6172  ).r....r....Z.ar
+000041a0: 6374 616e 3272 a400 0000 72a5 0000 0072  ctan2r....r....r
+000041b0: 6300 0000 7260 0000 0072 b300 0000 72b4  c...r`...r....r.
+000041c0: 0000 0072 a600 0000 72a7 0000 0072 a800  ...r....r....r..
+000041d0: 0000 290f 729c 0000 0072 b500 0000 72b7  ..).r....r....r.
+000041e0: 0000 005a 0e63 7572 7265 6e74 5f63 6f6f  ...Z.current_coo
+000041f0: 7264 735a 0561 6e67 5f31 5a05 6d61 675f  rdsZ.ang_1Z.mag_
+00004200: 315a 0561 6e67 5f32 5a05 6d61 675f 3272  1Z.ang_2Z.mag_2r
+00004210: bd00 0000 7275 0000 0072 7600 0000 7277  ....ru...rv...rw
+00004220: 0000 0072 b600 0000 5a03 6d61 675a 0a6e  ...r....Z.magZ.n
+00004230: 6577 5f63 6f6f 7264 7372 0f00 0000 720f  ew_coordsr....r.
+00004240: 0000 0072 1000 0000 da0a 6765 745f 636f  ...r......get_co
+00004250: 6f72 6473 2d02 0000 7324 0000 001a 0118  ords-...s$......
+00004260: 011a 0118 0114 020e 170c 010c 0104 010a  ................
+00004270: 0106 ff06 0304 012e 022e 0102 fe04 ff04  ................
+00004280: 0672 be00 0000 6303 0000 0000 0000 0000  .r....c.........
+00004290: 0000 0004 0000 0006 0000 0043 0000 0073  ...........C...s
+000042a0: 1e01 0000 7400 a001 7c00 6a02 6401 1900  ....t...|.j.d...
+000042b0: 6402 6602 a101 7d03 7c00 6403 6403 8502  d.f...}.|.d.d...
+000042c0: 6401 6404 8502 6602 1900 7c02 6401 6404  d.d...f...|.d.d.
+000042d0: 8502 1900 1800 7c03 6403 6403 8502 6401  ......|.d.d...d.
+000042e0: 6404 8502 6602 3c00 7c03 6403 6403 8502  d...f.<.|.d.d...
+000042f0: 6401 6404 8502 6602 1900 7400 6a03 a004  d.d...f...t.j...
+00004300: 7c01 a101 1000 7c03 6403 6403 8502 6404  |.....|.d.d...d.
+00004310: 6405 8502 6602 3c00 7c00 6403 6403 8502  d...f.<.|.d.d...
+00004320: 6401 6404 8502 6602 1900 7c03 6403 6403  d.d...f...|.d.d.
+00004330: 8502 6401 6404 8502 6602 3c00 7400 a005  ..d.d...f.<.t...
+00004340: 7c03 6403 6403 8502 6404 6405 8502 6602  |.d.d...d.d...f.
+00004350: 1900 a101 7c03 6403 6403 8502 6405 6406  ....|.d.d...d.d.
+00004360: 8502 6602 3c00 7c03 6403 6403 8502 6405  ..f.<.|.d.d...d.
+00004370: 6406 8502 6602 1900 7c01 1000 7c03 6403  d...f...|...|.d.
+00004380: 6403 8502 6406 6402 8502 6602 3c00 7c03  d...d.d...f.<.|.
+00004390: 6403 6403 8502 6406 6402 8502 6602 1900  d.d...d.d...f...
+000043a0: 7c02 6401 6404 8502 1900 1700 7c03 6403  |.d.d.......|.d.
+000043b0: 6403 8502 6406 6402 8502 6602 3c00 7c03  d...d.d...f.<.|.
+000043c0: 5300 2907 61fa 0100 000a 2020 2020 436f  S.).a.....    Co
+000043d0: 6e76 6572 7420 6174 6f6d 2070 6f73 6974  nvert atom posit
+000043e0: 696f 6e73 2074 6f20 636f 6f72 6469 6e61  ions to coordina
+000043f0: 7465 730a 0a20 2020 2050 6172 616d 6574  tes..    Paramet
+00004400: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00004410: 2d2d 0a20 2020 2070 6561 6b73 3a20 206e  --.    peaks:  n
+00004420: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00004430: 2020 204c 6973 7420 6f66 2047 6175 7373     List of Gauss
+00004440: 6961 6e20 6669 7474 6564 2070 6561 6b73  ian fitted peaks
+00004450: 0a20 2020 2063 6f6f 7264 733a 206e 6461  .    coords: nda
+00004460: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00004470: 2043 6f2d 6f72 6469 6e61 7465 7320 6f66   Co-ordinates of
+00004480: 2074 6865 2061 7865 730a 0a20 2020 2052   the axes..    R
+00004490: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+000044a0: 2d2d 0a20 2020 2061 746f 6d5f 636f 6f72  --.    atom_coor
+000044b0: 6473 3a20 6e64 6172 7261 790a 2020 2020  ds: ndarray.    
+000044c0: 2020 2020 2020 2020 2020 2020 2050 6561               Pea
+000044d0: 6b20 706f 7369 7469 6f6e 7320 6173 2074  k positions as t
+000044e0: 6865 2061 746f 6d20 636f 6f72 6469 6e61  he atom coordina
+000044f0: 7465 730a 0a20 2020 204e 6f74 6573 0a20  tes..    Notes. 
+00004500: 2020 202d 2d2d 2d2d 0a20 2020 204f 6e65     -----.    One
+00004510: 2061 746f 6d20 6973 2063 686f 7365 6e20   atom is chosen 
+00004520: 6173 2074 6865 206f 7269 6769 6e20 616e  as the origin an
+00004530: 6420 7468 6520 636f 2d6f 7264 696e 6174  d the co-ordinat
+00004540: 6573 0a20 2020 206f 6620 616c 6c20 7468  es.    of all th
+00004550: 6520 6174 6f6d 7320 6172 6520 6361 6c63  e atoms are calc
+00004560: 756c 6174 6564 2077 6974 6820 7265 7370  ulated with resp
+00004570: 6563 7420 746f 2074 6865 206f 7269 6769  ect to the origi
+00004580: 6e0a 0a20 2020 203a 4175 7468 6f72 733a  n..    :Authors:
+00004590: 0a20 2020 2044 6562 616e 6773 6875 204d  .    Debangshu M
+000045a0: 756b 6865 726a 6565 203c 6d75 6b68 6572  ukherjee <mukher
+000045b0: 6a65 6564 406f 726e 6c2e 676f 763e 0a20  jeed@ornl.gov>. 
+000045c0: 2020 2072 0100 0000 e908 0000 004e 7202     r.........Nr.
+000045d0: 0000 0072 5100 0000 72ab 0000 0029 0672  ...rQ...r....).r
+000045e0: 0700 0000 725a 0000 0072 5d00 0000 72a4  ....rZ...r]...r.
+000045f0: 0000 0072 ac00 0000 72ad 0000 0029 0472  ...r....r....).r
+00004600: 3700 0000 72a9 0000 0072 b700 0000 72af  7...r....r....r.
+00004610: 0000 0072 0f00 0000 720f 0000 0072 1000  ...r....r....r..
+00004620: 0000 da0f 636f 6f72 6473 5f6f 665f 6174  ....coords_of_at
+00004630: 6f6d 735a 0200 0073 1000 0000 1418 3001  omsZ...s......0.
+00004640: 3001 2401 2a01 2801 3001 0401 72c0 0000  0.$.*.(.0...r...
+00004650: 0063 0300 0000 0000 0000 0000 0000 1800  .c..............
+00004660: 0000 0900 0000 4300 0000 73e8 0300 0074  ......C...s....t
+00004670: 00a0 0164 01a1 0101 007c 006a 0264 0219  ...d.....|.j.d..
+00004680: 007d 0374 03a0 047c 0364 0366 02a1 017d  .}.t...|.d.f...}
+00004690: 0474 03a0 047c 0364 0466 02a1 017d 0574  .t...|.d.f...}.t
+000046a0: 057c 0383 0144 005d ed7d 067c 007c 0664  .|...D.].}.|.|.d
+000046b0: 0264 0585 0266 0219 007d 077c 077c 0164  .d...f...}.|.|.d
+000046c0: 0264 0064 0085 0266 0219 0017 007d 087c  .d.d...f.....}.|
+000046d0: 077c 0164 0664 0064 0085 0266 0219 0017  .|.d.d.d...f....
+000046e0: 007d 097c 077c 0164 0264 0064 0085 0266  .}.|.|.d.d.d...f
+000046f0: 0219 0017 007c 0164 0664 0064 0085 0266  .....|.d.d.d...f
+00004700: 0219 0017 007d 0a7c 0064 0064 0085 0264  .....}.|.d.d...d
+00004710: 0266 0219 007c 0864 0219 0018 0064 0513  .f...|.d.....d..
+00004720: 007c 0064 0064 0085 0264 0666 0219 007c  .|.d.d...d.f...|
+00004730: 0864 0619 0018 0064 0513 0017 007d 0b7c  .d.....d.....}.|
+00004740: 007c 0b74 03a0 067c 0ba1 016b 0264 0264  .|.t...|...k.d.d
+00004750: 0585 0266 0219 0064 0219 007d 0874 036a  ...f...d...}.t.j
+00004760: 07a0 087c 087c 0718 00a1 017d 0c7c 0064  ...|.|.....}.|.d
+00004770: 0064 0085 0264 0266 0219 007c 0964 0219  .d...d.f...|.d..
+00004780: 0018 0064 0513 007c 0064 0064 0085 0264  ...d...|.d.d...d
+00004790: 0666 0219 007c 0964 0619 0018 0064 0513  .f...|.d.....d..
+000047a0: 0017 007d 0d7c 007c 0d74 03a0 067c 0da1  ...}.|.|.t...|..
+000047b0: 016b 0264 0264 0585 0266 0219 0064 0219  .k.d.d...f...d..
+000047c0: 007d 0974 036a 07a0 087c 097c 0718 00a1  .}.t.j...|.|....
+000047d0: 017d 0e7c 0064 0064 0085 0264 0266 0219  .}.|.d.d...d.f..
+000047e0: 007c 0a64 0219 0018 0064 0513 007c 0064  .|.d.....d...|.d
+000047f0: 0064 0085 0264 0666 0219 007c 0a64 0619  .d...d.f...|.d..
+00004800: 0018 0064 0513 0017 007d 0f7c 007c 0f74  ...d.....}.|.|.t
+00004810: 03a0 067c 0fa1 016b 0264 0264 0585 0266  ...|...k.d.d...f
+00004820: 0219 0064 0219 007d 0a74 036a 07a0 087c  ...d...}.t.j...|
+00004830: 0a7c 0718 00a1 017d 1074 03a0 0974 03a0  .|.....}.t...t..
+00004840: 0a7c 077c 087c 097c 0a66 04a1 01a1 017c  .|.|.|.|.f.....|
+00004850: 047c 0664 0064 0085 0266 023c 0074 03a0  .|.d.d...f.<.t..
+00004860: 0974 03a0 0a64 027c 0c7c 0e7c 1066 04a1  .t...d.|.|.|.f..
+00004870: 01a1 017c 057c 0664 0064 0085 0266 023c  ...|.|.d.d...f.<
+00004880: 0071 1c74 036a 07a0 087c 0164 0264 0064  .q.t.j...|.d.d.d
+00004890: 0085 0266 0219 00a1 017d 1174 03a0 0a7c  ...f.....}.t...|
+000048a0: 1164 067c 0218 0014 007c 1164 067c 0217  .d.|.....|.d.|..
+000048b0: 0014 0066 02a1 017d 1274 036a 07a0 087c  ...f...}.t.j...|
+000048c0: 0164 0664 0064 0085 0266 0219 00a1 017d  .d.d.d...f.....}
+000048d0: 1374 03a0 0a7c 1364 067c 0218 0014 007c  .t...|.d.|.....|
+000048e0: 1364 067c 0217 0014 0066 02a1 017d 1474  .d.|.....f...}.t
+000048f0: 036a 07a0 087c 0164 0264 0064 0085 0266  .j...|.d.d.d...f
+00004900: 0219 007c 0164 0664 0064 0085 0266 0219  ...|.d.d.d...f..
+00004910: 0017 00a1 017d 1574 03a0 0a7c 1564 067c  .....}.t...|.d.|
+00004920: 0218 0014 007c 1564 067c 0217 0014 0066  .....|.d.|.....f
+00004930: 02a1 017d 167c 0564 0064 0085 0264 0666  ...}.|.d.d...d.f
+00004940: 0219 007d 1764 027c 177c 177c 1264 0619  ...}.d.|.|.|.d..
+00004950: 006b 043c 0064 027c 177c 177c 1264 0219  .k.<.d.|.|.|.d..
+00004960: 006b 003c 0074 036a 0b7c 177c 1764 026b  .k.<.t.j.|.|.d.k
+00004970: 023c 007c 177c 0564 0064 0085 0264 0666  .<.|.|.d.d...d.f
+00004980: 023c 007c 0564 0064 0085 0264 0566 0219  .<.|.d.d...d.f..
+00004990: 007d 1764 027c 177c 177c 1464 0619 006b  .}.d.|.|.|.d...k
+000049a0: 043c 0064 027c 177c 177c 1464 0219 006b  .<.d.|.|.|.d...k
+000049b0: 003c 0074 036a 0b7c 177c 1764 026b 023c  .<.t.j.|.|.d.k.<
+000049c0: 007c 177c 0564 0064 0085 0264 0566 023c  .|.|.d.d...d.f.<
+000049d0: 007c 0564 0064 0085 0264 0766 0219 007d  .|.d.d...d.f...}
+000049e0: 1764 027c 177c 177c 1664 0619 006b 043c  .d.|.|.|.d...k.<
+000049f0: 0064 027c 177c 177c 1664 0219 006b 003c  .d.|.|.|.d...k.<
+00004a00: 0074 036a 0b7c 177c 1764 026b 023c 007c  .t.j.|.|.d.k.<.|
+00004a10: 177c 0564 0064 0085 0264 0766 023c 007c  .|.d.d...d.f.<.|
+00004a20: 0474 03a0 0c7c 05a1 016a 0d64 0664 088d  .t...|...j.d.d..
+00004a30: 010f 0019 007d 047c 0574 03a0 0c7c 05a1  .....}.|.t...|..
+00004a40: 016a 0d64 0664 088d 010f 0019 007d 057c  .j.d.d.......}.|
+00004a50: 047c 0566 0253 0029 094e 7239 0000 0072  .|.f.S.).Nr9...r
+00004a60: 0100 0000 72bf 0000 0072 5100 0000 7202  ....r....rQ...r.
+00004a70: 0000 0072 0300 0000 7217 0000 0072 0400  ...r....r....r..
+00004a80: 0000 290e 723b 0000 0072 3c00 0000 725d  ..).r;...r<...r]
+00004a90: 0000 0072 0700 0000 725a 0000 0072 2b00  ...r....rZ...r+.
+00004aa0: 0000 7220 0000 0072 a400 0000 72a5 0000  ..r ...r....r...
+00004ab0: 00da 0572 6176 656c 7263 0000 00da 036e  ...ravelrc.....n
+00004ac0: 616e da05 6973 6e61 6eda 0361 6e79 2918  an..isnan..any).
+00004ad0: 5a09 7065 616b 5f6c 6973 7472 a900 0000  Z.peak_listr....
+00004ae0: da05 6465 6c74 61da 086e 6f5f 6174 6f6d  ..delta..no_atom
+00004af0: 735a 0f61 746f 6d73 5f6e 6569 6768 626f  sZ.atoms_neighbo
+00004b00: 7273 5a0f 6174 6f6d 735f 6469 7374 616e  rsZ.atoms_distan
+00004b10: 6365 7372 0d00 0000 5a08 6174 6f6d 5f70  cesr....Z.atom_p
+00004b20: 6f73 5a08 6e65 6967 685f 7979 5a08 6e65  osZ.neigh_yyZ.ne
+00004b30: 6967 685f 7878 5a08 6e65 6967 685f 7879  igh_xxZ.neigh_xy
+00004b40: 5a08 7061 726e 625f 7979 5a08 6e64 6973  Z.parnb_yyZ.ndis
+00004b50: 745f 7979 5a08 7061 726e 625f 7878 5a08  t_yyZ.parnb_xxZ.
+00004b60: 6e64 6973 745f 7878 5a08 7061 726e 625f  ndist_xxZ.parnb_
+00004b70: 7879 5a08 6e64 6973 745f 7879 5a07 7979  xyZ.ndist_xyZ.yy
+00004b80: 5f64 6973 745a 0779 795f 6c69 7374 5a07  _distZ.yy_listZ.
+00004b90: 7878 5f64 6973 745a 0778 785f 6c69 7374  xx_distZ.xx_list
+00004ba0: 5a07 7879 5f64 6973 745a 0778 795f 6c69  Z.xy_distZ.xy_li
+00004bb0: 7374 da02 7070 720f 0000 0072 0f00 0000  st..ppr....r....
+00004bc0: 7210 0000 00da 0f74 6872 6565 5f6e 6569  r......three_nei
+00004bd0: 6768 626f 7273 7c02 0000 7368 0000 000a  ghbors|...sh....
+00004be0: 010a 010e 010e 010c 0110 0114 0114 0124  ...............$
+00004bf0: 011a 011a 0104 ff1e 0310 011a 011a 0104  ................
+00004c00: ff1e 0310 011a 011a 0104 ff1e 0310 0104  ................
+00004c10: 0110 0110 ff26 0318 011e 0118 011e 0128  .....&.........(
+00004c20: 011e 0110 0110 0110 010e 0110 0110 0110  ................
+00004c30: 0110 010e 0110 0110 0110 0110 010e 0110  ................
+00004c40: 0118 0118 0108 0172 c800 0000 6302 0000  .......r....c...
+00004c50: 0000 0000 0000 0000 0010 0000 0006 0000  ................
+00004c60: 0043 0000 0073 2e02 0000 7400 a001 6401  .C...s....t...d.
+00004c70: a101 0100 7402 a003 6402 a101 7d02 7402  ....t...d...}.t.
+00004c80: a003 6403 a101 7d03 7402 a004 7c00 a101  ..d...}.t...|...
+00004c90: 6404 1900 7d04 7402 6a05 a006 7c01 a101  d...}.t.j...|...
+00004ca0: 7d05 7402 a007 7c04 6405 6602 a101 7d06  }.t...|.d.f...}.
+00004cb0: 7402 a007 7c04 a101 7d07 7402 a007 7c04  t...|...}.t...|.
+00004cc0: a101 7d08 7402 a007 7c04 a101 7d09 7402  ..}.t...|...}.t.
+00004cd0: a007 7c04 a101 7d0a 7408 7c04 8301 4400  ..|...}.t.|...D.
+00004ce0: 5dd4 7d0b 7402 a007 6406 a101 7d0c 7c00  ].}.t...d...}.|.
+00004cf0: 7c0b 6404 6405 8502 6602 1900 7c00 7c0b  |.d.d...f...|.|.
+00004d00: 6404 6405 8502 6602 1900 1800 7c0c 6404  d.d...f.....|.d.
+00004d10: 6400 6400 8502 6602 3c00 7c00 7c0b 6405  d.d...f.<.|.|.d.
+00004d20: 6407 8502 6602 1900 7c00 7c0b 6404 6405  d...f...|.|.d.d.
+00004d30: 8502 6602 1900 1800 7c0c 6408 6400 6400  ..f.....|.d.d.d.
+00004d40: 8502 6602 3c00 7c00 7c0b 6407 6409 8502  ..f.<.|.|.d.d...
+00004d50: 6602 1900 7c00 7c0b 6404 6405 8502 6602  f...|.|.d.d...f.
+00004d60: 1900 1800 7c0c 6405 6400 6400 8502 6602  ....|.d.d.d...f.
+00004d70: 3c00 7c00 7c0b 6409 640a 8502 6602 1900  <.|.|.d.d...f...
+00004d80: 7c00 7c0b 6404 6405 8502 6602 1900 1800  |.|.d.d...f.....
+00004d90: 7c0c 640b 6400 6400 8502 6602 3c00 7402  |.d.d.d...f.<.t.
+00004da0: 6a05 6a09 7c03 7c0c 6400 640c 8d03 5c04  j.j.|.|.d.d...\.
+00004db0: 7d0d 7d0e 7d0e 7d0e 7402 a00a 7c0d 7c05  }.}.}.}.t...|.|.
+00004dc0: a102 7c02 1800 7d0f 7c0f 640d 1900 7c09  ..|...}.|.d...|.
+00004dd0: 7c0b 3c00 7c0f 640e 1900 7c07 7c0b 3c00  |.<.|.d...|.|.<.
+00004de0: 640f 7c0f 6410 1900 7c0f 6411 1900 1700  d.|.d...|.d.....
+00004df0: 1400 7c08 7c0b 3c00 640f 7c0f 6410 1900  ..|.|.<.d.|.d...
+00004e00: 7c0f 6411 1900 1800 1400 7c0a 7c0b 3c00  |.d.......|.|.<.
+00004e10: 6412 7c00 7c0b 6404 6602 1900 7c00 7c0b  d.|.|.d.f...|.|.
+00004e20: 6405 6602 1900 1700 7c00 7c0b 6407 6602  d.f.....|.|.d.f.
+00004e30: 1900 1700 7c00 7c0b 6409 6602 1900 1700  ....|.|.d.f.....
+00004e40: 1400 7c06 7c0b 6404 6602 3c00 6412 7c00  ..|.|.d.f.<.d.|.
+00004e50: 7c0b 6408 6602 1900 7c00 7c0b 640b 6602  |.d.f...|.|.d.f.
+00004e60: 1900 1700 7c00 7c0b 6413 6602 1900 1700  ....|.|.d.f.....
+00004e70: 7c00 7c0b 6414 6602 1900 1700 1400 7c06  |.|.d.f.......|.
+00004e80: 7c0b 6408 6602 3c00 713b 7c06 7c09 7c07  |.d.f.<.q;|.|.|.
+00004e90: 7c08 7c0a 6605 5300 2915 4e72 3900 0000  |.|.f.S.).Nr9...
+00004ea0: 2902 72bc 0000 0072 b900 0000 2904 72ba  ).r....r....).r.
+00004eb0: 0000 0072 bc00 0000 72b9 0000 0072 bb00  ...r....r....r..
+00004ec0: 0000 7201 0000 0072 0200 0000 2902 7251  ..r....r....).rQ
+00004ed0: 0000 0072 0200 0000 7251 0000 0072 0300  ...r....rQ...r..
+00004ee0: 0000 72ab 0000 0072 bf00 0000 7217 0000  ..r....r....r...
+00004ef0: 0029 015a 0572 636f 6e64 72ba 0000 0072  .).Z.rcondr....r
+00004f00: bb00 0000 7206 0000 0072 b900 0000 72bc  ....r....r....r.
+00004f10: 0000 0072 7f00 0000 7254 0000 0072 3a00  ...r....rT...r:.
+00004f20: 0000 290b 723b 0000 0072 3c00 0000 7207  ..).r;...r<...r.
+00004f30: 0000 0072 6300 0000 725d 0000 0072 a400  ...rc...r]...r..
+00004f40: 0000 72ac 0000 0072 5a00 0000 722b 0000  ..r....rZ...r+..
+00004f50: 005a 056c 7374 7371 da06 6d61 746d 756c  .Z.lstsq..matmul
+00004f60: 2910 5a06 6e5f 6c69 7374 72a9 0000 00da  ).Z.n_listr.....
+00004f70: 0869 6465 6e74 6974 795a 0861 7869 735f  .identityZ.axis_
+00004f80: 706f 7372 c600 0000 5a0a 636f 6f72 6473  posr....Z.coords
+00004f90: 5f69 6e76 5a0b 6365 6c6c 5f63 656e 7465  _invZ.cell_cente
+00004fa0: 72da 0465 5f78 78da 0465 5f78 79da 0465  r..e_xx..e_xy..e
+00004fb0: 5f79 79da 0465 5f74 6872 0d00 0000 da02  _yy..e_thr......
+00004fc0: 6363 5a04 6c5f 6363 7279 0000 005a 0474  ccZ.l_ccry...Z.t
+00004fd0: 5f63 6372 0f00 0000 720f 0000 0072 1000  _ccr....r....r..
+00004fe0: 0000 da0f 7265 6c61 7469 7665 5f73 7472  ....relative_str
+00004ff0: 6169 6eb3 0200 0073 3a00 0000 0a01 0a01  ain....s:.......
+00005000: 0a01 0e01 0c01 0e01 0a01 0a01 0a01 0a01  ................
+00005010: 0c01 0a01 2c01 2c01 2c01 2c01 1a01 1001  ....,.,.,.,.....
+00005020: 0c01 0c01 1801 1801 0201 2e01 0cff 0203  ................
+00005030: 2e01 0eff 0e03 72d0 0000 0063 0600 0000  ......r....c....
+00005040: 0000 0000 0000 0000 1100 0000 0900 0000  ................
+00005050: 4300 0000 73a0 0100 0074 006a 0164 017c  C...s....t.j.d.|
+00005060: 056a 0264 0119 0085 0264 017c 056a 0264  .j.d.....d.|.j.d
+00005070: 0219 0085 0266 0219 005c 027d 067d 0774  .....f...\.}.}.t
+00005080: 0374 047c 0064 0064 0085 0264 0266 0219  .t.|.d.d...d.f..
+00005090: 007c 0064 0064 0085 0264 0166 0219 0083  .|.d.d...d.f....
+000050a0: 0283 017d 0864 017c 0174 00a0 057c 01a1  ...}.d.|.t...|..
+000050b0: 0164 0374 00a0 0674 00a0 057c 01a1 01a1  .d.t...t...|....
+000050c0: 0114 006b 043c 0064 017c 0274 00a0 057c  ...k.<.d.|.t...|
+000050d0: 02a1 0164 0374 00a0 0674 00a0 057c 02a1  ...d.t...t...|..
+000050e0: 01a1 0114 006b 043c 0064 017c 0374 00a0  .....k.<.d.|.t..
+000050f0: 057c 03a1 0164 0374 00a0 0674 00a0 057c  .|...d.t...t...|
+00005100: 03a1 01a1 0114 006b 043c 0064 017c 0474  .......k.<.d.|.t
+00005110: 00a0 057c 04a1 0164 0374 00a0 0674 00a0  ...|...d.t...t..
+00005120: 057c 04a1 01a1 0114 006b 043c 0074 07a0  .|.......k.<.t..
+00005130: 087c 087c 01a1 027d 0974 07a0 087c 087c  .|.|...}.t...|.|
+00005140: 02a1 027d 0a74 07a0 087c 087c 03a1 027d  ...}.t...|.|...}
+00005150: 0b74 07a0 087c 087c 04a1 027d 0c7c 097c  .t...|.|...}.|.|
+00005160: 077c 0683 027d 0d64 017c 0d74 00a0 097c  .|...}.d.|.t...|
+00005170: 0da1 013c 0074 00a0 0a7c 0d7c 05a1 027d  ...<.t...|.|...}
+00005180: 0d7c 0a7c 077c 0683 027d 0e64 017c 0e74  .|.|.|...}.d.|.t
+00005190: 00a0 097c 0ea1 013c 0074 00a0 0a7c 0e7c  ...|...<.t...|.|
+000051a0: 05a1 027d 0e7c 0b7c 077c 0683 027d 0f64  ...}.|.|.|...}.d
+000051b0: 017c 0f74 00a0 097c 0fa1 013c 0074 00a0  .|.t...|...<.t..
+000051c0: 0a7c 0f7c 05a1 027d 0f7c 0c7c 077c 0683  .|.|...}.|.|.|..
+000051d0: 027d 1064 017c 1074 00a0 097c 10a1 013c  .}.d.|.t...|...<
+000051e0: 0074 00a0 0a7c 107c 05a1 027d 107c 0d7c  .t...|.|...}.|.|
+000051f0: 0e7c 0f7c 1066 0453 0029 044e 7201 0000  .|.|.f.S.).Nr...
+00005200: 0072 0300 0000 7217 0000 0029 0b72 0700  .r....r....).r..
+00005210: 0000 725c 0000 0072 5d00 0000 da04 6c69  ..r\...r].....li
+00005220: 7374 da03 7a69 7072 5e00 0000 723e 0000  st..zipr^...r>..
+00005230: 00da 0873 6369 6e74 6572 705a 144c 696e  ...scinterpZ.Lin
+00005240: 6561 724e 4449 6e74 6572 706f 6c61 746f  earNDInterpolato
+00005250: 7272 c300 0000 7289 0000 0029 115a 0763  rr....r....).Z.c
+00005260: 656e 7465 7273 72cd 0000 0072 cb00 0000  entersr....r....
+00005270: 72cc 0000 0072 ce00 0000 da04 6d61 736b  r....r......mask
+00005280: 5a02 7972 5a02 7872 5a09 6361 7274 636f  Z.yrZ.xrZ.cartco
+00005290: 6f72 645a 0466 5f79 795a 0466 5f78 785a  ordZ.f_yyZ.f_xxZ
+000052a0: 0466 5f78 795a 0466 5f74 685a 066d 6170  .f_xyZ.f_thZ.map
+000052b0: 5f79 795a 066d 6170 5f78 785a 066d 6170  _yyZ.map_xxZ.map
+000052c0: 5f78 795a 066d 6170 5f74 6872 0f00 0000  _xyZ.map_thr....
+000052d0: 720f 0000 0072 1000 0000 da0a 7374 7261  r....r......stra
+000052e0: 696e 5f6d 6170 d302 0000 732e 0000 0026  in_map....s....&
+000052f0: 0126 0122 0222 0122 0122 010c 020c 010c  .&."."."."......
+00005300: 010c 010a 020e 010c 010a 020e 010c 010a  ................
+00005310: 020e 010c 010a 020e 010c 010c 0272 d500  .............r..
+00005320: 0000 7217 0000 0054 6305 0000 0000 0000  ..r....Tc.......
+00005330: 0000 0000 000d 0000 0007 0000 0043 0000  .............C..
+00005340: 0073 0201 0000 7400 6a01 a002 7403 a004  .s....t.j...t...
+00005350: 7c00 a101 7c03 a102 7d05 7405 6a06 a007  |...|...}.t.j...
+00005360: 7c05 7c01 6401 1900 7c01 6402 1900 7c02  |.|.d...|.d...|.
+00005370: a104 7d06 7403 6a08 7403 a009 7c00 a101  ..}.t.j.t...|...
+00005380: 740a 6403 8d02 7d07 7403 6a0b 6401 7c07  t.d...}.t.j.d.|.
+00005390: 6401 1900 8502 6401 7c07 6402 1900 8502  d.....d.|.d.....
+000053a0: 6602 1900 5c02 7d08 7d09 7403 a00c 7c05  f...\.}.}.t...|.
+000053b0: a101 7d0a 7c04 725a 7403 a008 7403 a00d  ..}.|.rZt...t...
+000053c0: 7c06 6401 6404 8502 1900 a101 a101 7d0b  |.d.d.........}.
+000053d0: 7c08 7c0b 6401 1900 1800 6404 1300 7c09  |.|.d.....d...|.
+000053e0: 7c0b 6402 1900 1800 6404 1300 1700 6405  |.d.....d.....d.
+000053f0: 1300 7c02 6b00 7d0c 6e1d 7403 a008 7c06  ..|.k.}.n.t...|.
+00005400: 6401 6404 8502 1900 a101 7d0b 7c08 7c0b  d.d.......}.|.|.
+00005410: 6402 1900 1800 6404 1300 7c09 7c0b 6401  d.....d...|.|.d.
+00005420: 1900 1800 6404 1300 1700 6405 1300 7c02  ....d.....d...|.
+00005430: 6b00 7d0c 7c00 7c0c 1900 7c0a 7c0c 3c00  k.}.|.|...|.|.<.
+00005440: 7c0a 7c0b 6602 5300 2906 610e 0500 000a  |.|.f.S.).a.....
+00005450: 2020 2020 5573 6520 6120 4761 7573 7369      Use a Gaussi
+00005460: 616e 2062 6c75 7272 6564 2069 6d61 6765  an blurred image
+00005470: 2074 6f20 6669 740a 2020 2020 7065 616b   to fit.    peak
+00005480: 732e 0a0a 2020 2020 5061 7261 6d65 7465  s...    Paramete
+00005490: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+000054a0: 2d0a 2020 2020 696d 6167 653a 2020 6e64  -.    image:  nd
+000054b0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+000054c0: 2020 3244 2061 7272 6179 2072 6570 7265    2D array repre
+000054d0: 7365 6e74 696e 6720 7468 6520 696d 6167  senting the imag
+000054e0: 650a 2020 2020 6365 6e74 6572 3a20 7475  e.    center: tu
+000054f0: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+00005500: 4170 7072 6f78 696d 6174 6520 6c6f 6361  Approximate loca
+00005510: 7469 6f6e 2061 7320 2878 2c79 2920 6f66  tion as (x,y) of
+00005520: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00005530: 2070 6561 6b20 7765 2061 7265 2074 7279   peak we are try
+00005540: 696e 6720 746f 2066 6974 0a20 2020 2072  ing to fit.    r
+00005550: 6164 6975 733a 2066 6c6f 6174 0a20 2020  adius: float.   
+00005560: 2020 2020 2020 2020 204d 6173 6b69 6e67           Masking
+00005570: 2072 6164 6975 730a 2020 2020 675f 7661   radius.    g_va
+00005580: 6c3a 2020 666c 6f61 740a 2020 2020 2020  l:  float.      
+00005590: 2020 2020 2020 5661 6c75 6520 696e 2070        Value in p
+000055a0: 6978 656c 7320 6f66 2074 6865 2047 6175  ixels of the Gau
+000055b0: 7373 6961 6e0a 2020 2020 2020 2020 2020  ssian.          
+000055c0: 2020 626c 7572 2061 7070 6c69 6564 2e20    blur applied. 
+000055d0: 4465 6661 756c 7420 6973 2033 0a20 2020  Default is 3.   
+000055e0: 2066 6c69 703a 2020 2062 6f6f 6c0a 2020   flip:   bool.  
+000055f0: 2020 2020 2020 2020 2020 5377 6974 6368            Switch
+00005600: 2074 6f20 666c 6970 2072 6566 696e 6564   to flip refined
+00005610: 2063 656e 7465 7220 706f 7369 7469 6f6e   center position
+00005620: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+00005630: 6d20 2878 2c79 2920 746f 2028 792c 7829  m (x,y) to (y,x)
+00005640: 2e20 4465 6661 756c 7420 6973 2054 7275  . Default is Tru
+00005650: 650a 2020 2020 2020 2020 2020 2020 7768  e.            wh
+00005660: 6963 6820 7265 7475 726e 7320 7468 6520  ich returns the 
+00005670: 6365 6e74 6572 2061 7320 2879 2c78 290a  center as (y,x).
+00005680: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00005690: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61    -------.    ma
+000056a0: 736b 6564 5f69 6d61 6765 3a20 6e64 6172  sked_image: ndar
+000056b0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+000056c0: 2020 2020 2020 4d61 736b 6564 2049 6d61        Masked Ima
+000056d0: 6765 2063 656e 7465 7265 6420 6174 2072  ge centered at r
+000056e0: 6566 696e 6564 0a20 2020 2020 2020 2020  efined.         
+000056f0: 2020 2020 2020 2020 2070 6561 6b20 706f           peak po
+00005700: 7369 7469 6f6e 0a20 2020 206e 6577 5f63  sition.    new_c
+00005710: 656e 7465 723a 2020 206e 6461 7272 6179  enter:   ndarray
+00005720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005730: 2020 2052 6566 696e 6564 2061 746f 6d20     Refined atom 
+00005740: 6365 6e74 6572 2061 7320 2879 2c78 2920  center as (y,x) 
+00005750: 6966 0a20 2020 2020 2020 2020 2020 2020  if.             
+00005760: 2020 2020 2066 6c69 7020 7377 6974 6368       flip switch
+00005770: 2069 7320 6f6e 2c20 656c 7365 2074 6865   is on, else the
+00005780: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
+00005790: 2020 2020 2020 2020 2020 6973 2072 6574            is ret
+000057a0: 7572 6e65 6420 6173 2028 782c 7929 0a0a  urned as (x,y)..
+000057b0: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+000057c0: 2d2d 2d0a 2020 2020 466f 7220 736f 6d65  ---.    For some
+000057d0: 206e 6f69 7379 2064 6174 6173 6574 732c   noisy datasets,
+000057e0: 2061 2070 6561 6b20 6d61 7920 6265 2076   a peak may be v
+000057f0: 6973 6962 6c65 2077 6974 680a 2020 2020  isible with.    
+00005800: 7468 6520 6875 6d61 6e20 6579 652c 2062  the human eye, b
+00005810: 7574 2067 6574 7469 6e67 2061 2073 7562  ut getting a sub
+00005820: 2d70 6978 656c 2065 7374 696d 6174 696f  -pixel estimatio
+00005830: 6e20 6f66 0a20 2020 2074 6865 2070 6561  n of.    the pea
+00005840: 6b20 706f 7369 7469 6f6e 2069 7320 6f66  k position is of
+00005850: 7465 6e20 6368 616c 6c65 6e67 696e 672c  ten challenging,
+00005860: 2065 7370 6563 6961 6c6c 790a 2020 2020   especially.    
+00005870: 666f 7220 4646 5420 666f 7220 6469 6666  for FFT for diff
+00005880: 7261 6374 696f 6e20 7061 7474 6572 6e73  raction patterns
+00005890: 2e20 5468 6973 2063 6f64 6520 4761 7573  . This code Gaus
+000058a0: 7369 616e 0a20 2020 2062 6c75 7273 2074  sian.    blurs t
+000058b0: 6865 2069 6d61 6765 2c20 616e 6420 7265  he image, and re
+000058c0: 7475 726e 7320 7468 6520 7265 6669 6e65  turns the refine
+000058d0: 6420 7065 616b 2070 6f73 6974 696f 6e0a  d peak position.
+000058e0: 0a20 2020 2053 6565 2061 6c73 6f0a 2020  .    See also.  
+000058f0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073    --------.    s
+00005900: 742e 7574 696c 2e66 6974 5f67 6175 7373  t.util.fit_gauss
+00005910: 6961 6e32 445f 6d61 736b 0a0a 2020 2020  ian2D_mask..    
+00005920: 3a41 7574 686f 7273 3a0a 2020 2020 4465  :Authors:.    De
+00005930: 6261 6e67 7368 7520 4d75 6b68 6572 6a65  bangshu Mukherje
+00005940: 6520 3c6d 756b 6865 726a 6565 6440 6f72  e <mukherjeed@or
+00005950: 6e6c 2e67 6f76 3e0a 0a20 2020 2072 0100  nl.gov>..    r..
+00005960: 0000 7203 0000 0072 1600 0000 7202 0000  ..r....r....r...
+00005970: 0072 0600 0000 290e 7227 0000 0072 8600  .r....).r'...r..
+00005980: 0000 7287 0000 0072 0700 0000 725e 0000  ..r....r....r^..
+00005990: 0072 4000 0000 7241 0000 0072 4200 0000  .r@...rA...rB...
+000059a0: 7263 0000 0072 5d00 0000 7226 0000 0072  rc...r]...r&...r
+000059b0: 5c00 0000 725b 0000 0072 4300 0000 290d  \...r[...rC...).
+000059c0: 729c 0000 0072 8a00 0000 728b 0000 005a  r....r....r....Z
+000059d0: 0567 5f76 616c 7243 0000 0072 8d00 0000  .g_valrC...r....
+000059e0: 728e 0000 0072 9000 0000 7291 0000 0072  r....r....r....r
+000059f0: 9200 0000 7293 0000 0072 8f00 0000 726e  ....r....r....rn
+00005a00: 0000 0072 0f00 0000 720f 0000 0072 1000  ...r....r....r..
+00005a10: 0000 da0f 6372 6561 7465 5f63 6972 636d  ....create_circm
+00005a20: 6173 6bf4 0200 0073 2400 0000 1431 0601  ask....s$....1..
+00005a30: 1001 04ff 1403 2201 0a01 0401 1801 2202  ......".......".
+00005a40: 0201 06fe 1204 2202 0201 04fe 0c03 0801  ......".........
+00005a50: 72d6 0000 0063 0100 0000 0000 0000 0000  r....c..........
+00005a60: 0000 0600 0000 0700 0000 4300 0000 73a0  ..........C...s.
+00005a70: 0000 0074 00a0 0164 01a1 0101 0074 027c  ...t...d.....t.|
+00005a80: 0083 017d 0174 036a 047c 0174 036a 0564  ...}.t.j.|.t.j.d
+00005a90: 028d 027d 0274 036a 047c 0174 036a 0564  ...}.t.j.|.t.j.d
+00005aa0: 028d 027d 0374 03a0 067c 01a1 0144 005d  ...}.t...|...D.]
+00005ab0: 287d 0474 036a 077c 0064 0064 0085 0264  (}.t.j.|.d.d...d
+00005ac0: 0364 0485 0266 0219 007c 007c 0464 0364  .d...f...|.|.d.d
+00005ad0: 0485 0266 0219 0018 0064 0413 0064 0564  ...f.....d...d.d
+00005ae0: 068d 027d 0374 03a0 087c 037c 0364 036b  ...}.t...|.|.d.k
+00005af0: 0419 00a1 0164 0713 007c 027c 043c 0071  .....d...|.|.<.q
+00005b00: 1e64 0774 03a0 097c 02a1 0114 007d 057c  .d.t...|.....}.|
+00005b10: 0553 0029 084e 7239 0000 0072 1600 0000  .S.).Nr9...r....
+00005b20: 7201 0000 0072 0200 0000 7203 0000 0072  r....r....r....r
+00005b30: 0400 0000 7206 0000 0029 0a72 3b00 0000  ....r....).r;...
+00005b40: 723c 0000 0072 0900 0000 7207 0000 0072  r<...r....r....r
+00005b50: 3d00 0000 7223 0000 0072 3f00 0000 720a  =...r#...r?...r.
+00005b60: 0000 0072 2000 0000 723e 0000 0029 0672  ...r ...r>...).r
+00005b70: 4500 0000 7246 0000 0072 0e00 0000 7247  E...rF...r....rG
+00005b80: 0000 0072 0d00 0000 7248 0000 0072 0f00  ...r....rH...r..
+00005b90: 0000 720f 0000 0072 1000 0000 7248 0000  ..r....r....rH..
+00005ba0: 003a 0300 0073 1200 0000 0a01 0801 1001  .:...s..........
+00005bb0: 1001 0e01 3201 1c01 0e01 0401 7248 0000  ....2.......rH..
+00005bc0: 0063 0400 0000 0000 0000 0000 0000 0800  .c..............
+00005bd0: 0000 0700 0000 4300 0000 7390 0000 0074  ......C...s....t
+00005be0: 00a0 0174 027c 0183 01a1 0144 005d 3e7d  ...t.|.....D.]>}
+00005bf0: 047c 017c 0464 0166 0219 007d 057c 017c  .|.|.d.f...}.|.|
+00005c00: 0464 0266 0219 007d 0674 036a 04a0 0564  .d.f...}.t.j...d
+00005c10: 017c 0017 007c 057c 067c 03a1 047d 0774  .|...|.|.|...}.t
+00005c20: 00a0 067c 0764 0264 0385 0219 00a1 017c  ...|.d.d.......|
+00005c30: 027c 0464 0264 0385 0266 023c 007c 0764  .|.d.d...f.<.|.d
+00005c40: 0364 0485 0219 007c 027c 0464 0364 0485  .d.....|.|.d.d..
+00005c50: 0266 023c 007c 0764 0519 0064 0118 007c  .f.<.|.d...d...|
+00005c60: 027c 0464 0566 023c 0071 0764 0053 0029  .|.d.f.<.q.d.S.)
+00005c70: 064e 7203 0000 0072 0100 0000 7202 0000  .Nr....r....r...
+00005c80: 0072 ab00 0000 7259 0000 0029 0772 0700  .r....rY...).r..
+00005c90: 0000 723f 0000 0072 0900 0000 7240 0000  ..r?...r....r@..
+00005ca0: 0072 4100 0000 7242 0000 0072 4300 0000  .rA...rB...rC...
+00005cb0: 2908 7244 0000 0072 4500 0000 7249 0000  ).rD...rE...rI..
+00005cc0: 0072 4800 0000 720d 0000 0072 4a00 0000  .rH...r....rJ...
+00005cd0: 724b 0000 0072 4c00 0000 720f 0000 0072  rK...rL...r....r
+00005ce0: 0f00 0000 7210 0000 0072 4d00 0000 4703  ....r....rM...G.
+00005cf0: 0000 7310 0000 0012 010c 010c 0116 011e  ..s.............
+00005d00: 0118 0116 0104 fa63 0000 0000 0000 0000  .......c........
+00005d10: 0000 0000 0000 0000 0300 0000 4000 0000  ............@...
+00005d20: 7348 0000 0065 005a 0164 005a 0264 015a  sH...e.Z.d.Z.d.Z
+00005d30: 0364 0264 0384 005a 0464 1664 0764 0884  .d.d...Z.d.d.d..
+00005d40: 015a 0564 1764 0a64 0b84 015a 0664 1864  .Z.d.d.d...Z.d.d
+00005d50: 0e64 0f84 015a 0764 1064 1184 005a 0864  .d...Z.d.d...Z.d
+00005d60: 1964 1364 1484 015a 0964 1553 0029 1ada  .d.d...Z.d.S.)..
+00005d70: 0861 746f 6d5f 6669 7461 c106 0000 0a20  .atom_fita..... 
+00005d80: 2020 204c 6f63 6174 6520 6174 6f6d 2063     Locate atom c
+00005d90: 6f6c 756d 6e73 2069 6e20 6174 6f6d 6963  olumns in atomic
+00005da0: 2072 6573 6f6c 7574 696f 6e20 5354 454d   resolution STEM
+00005db0: 2069 6d61 6765 730a 2020 2020 616e 6420   images.    and 
+00005dc0: 7468 656e 2073 7562 7365 7175 656e 746c  then subsequentl
+00005dd0: 7920 7573 6520 6761 7573 7369 616e 2070  y use gaussian p
+00005de0: 6561 6b20 6669 7474 696e 6720 746f 0a20  eak fitting to. 
+00005df0: 2020 2072 6566 696e 6520 7468 6520 636f     refine the co
+00005e00: 6c75 6d6e 206c 6f63 6174 696f 6e20 7769  lumn location wi
+00005e10: 7468 2073 7562 2d70 6978 656c 2070 7265  th sub-pixel pre
+00005e20: 6369 7369 6f6e 2e0a 0a20 2020 2050 6172  cision...    Par
+00005e30: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00005e40: 2d2d 2d2d 2d2d 0a20 2020 2069 6d61 6765  ------.    image
+00005e50: 3a20 2020 2020 2020 6e64 6172 7261 790a  :       ndarray.
+00005e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e70: 2054 6865 2069 6d61 6765 2066 726f 6d20   The image from 
+00005e80: 7768 6963 6820 7468 6520 7065 616b 2070  which the peak p
+00005e90: 6f73 6974 696f 6e73 0a20 2020 2020 2020  ositions.       
+00005ea0: 2020 2020 2020 2020 2020 7769 6c6c 2062            will b
+00005eb0: 6520 6173 6365 7274 6169 6e65 642e 0a20  e ascertained.. 
+00005ec0: 2020 2063 616c 6962 3a20 2020 2020 2020     calib:       
+00005ed0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+00005ee0: 2020 2020 2020 2053 697a 6520 6f66 2061         Size of a
+00005ef0: 6e20 696e 6469 7669 6475 616c 2070 6978  n individual pix
+00005f00: 656c 0a20 2020 2063 616c 6962 5f75 6e69  el.    calib_uni
+00005f10: 7473 3a20 7374 720a 2020 2020 2020 2020  ts: str.        
+00005f20: 2020 2020 2020 2020 2055 6e69 7420 6f66           Unit of
+00005f30: 2063 616c 6962 7261 7469 6f6e 0a0a 2020   calibration..  
+00005f40: 2020 5265 6665 7265 6e63 6573 0a20 2020    References.   
+00005f50: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00005f60: 315d 5f2c 204d 756b 6865 726a 6565 2c20  1]_, Mukherjee, 
+00005f70: 442e 2c20 4d69 616f 2c20 4c2e 2c20 5374  D., Miao, L., St
+00005f80: 6f6e 652c 2047 2e20 616e 6420 416c 656d  one, G. and Alem
+00005f90: 2c20 4e2e 2c0a 2020 2020 2020 2020 206d  , N.,.         m
+00005fa0: 7066 6974 3a20 6120 726f 6275 7374 206d  pfit: a robust m
+00005fb0: 6574 686f 6420 666f 7220 6669 7474 696e  ethod for fittin
+00005fc0: 6720 6174 6f6d 6963 2072 6573 6f6c 7574  g atomic resolut
+00005fd0: 696f 6e20 696d 6167 6573 0a20 2020 2020  ion images.     
+00005fe0: 2020 2020 7769 7468 206d 756c 7469 706c      with multipl
+00005ff0: 6520 4761 7573 7369 616e 2070 6561 6b73  e Gaussian peaks
+00006000: 2e20 4164 7620 5374 7275 6374 2043 6865  . Adv Struct Che
+00006010: 6d20 496d 6167 2036 2c20 3120 2832 3032  m Imag 6, 1 (202
+00006020: 3029 2e0a 0a20 2020 2045 7861 6d70 6c65  0)...    Example
+00006030: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+00006040: 2020 2052 756e 2061 733a 0a0a 2020 2020     Run as:..    
+00006050: 3e3e 3e20 6174 6f6d 7320 3d20 7374 2e61  >>> atoms = st.a
+00006060: 6669 742e 6174 6f6d 5f66 6974 2873 7465  fit.atom_fit(ste
+00006070: 6d5f 696d 6167 652c 2063 616c 6962 7261  m_image, calibra
+00006080: 7469 6f6e 2c20 276e 6d27 290a 0a20 2020  tion, 'nm')..   
+00006090: 2054 6865 6e20 746f 2063 6865 636b 2074   Then to check t
+000060a0: 6865 2069 6d61 6765 2079 6f75 206a 7573  he image you jus
+000060b0: 7420 6c6f 6164 6564 2c20 7769 7468 2074  t loaded, with t
+000060c0: 6865 206f 7074 696f 6e61 6c20 7061 7261  he optional para
+000060d0: 6d65 7465 720a 2020 2020 6031 3260 2064  meter.    `12` d
+000060e0: 6574 6572 6d69 6e69 6e67 2068 6f77 206d  etermining how m
+000060f0: 616e 7920 7069 7865 6c73 206f 6620 6761  any pixels of ga
+00006100: 7573 7369 616e 2062 6c75 7220 6e65 6564  ussian blur need
+00006110: 2074 6f20 6170 706c 6965 6420 746f 0a20   to applied to. 
+00006120: 2020 2063 616c 6375 6c61 7465 2061 6e64     calculate and
+00006130: 2073 6570 6172 6174 6520 6120 6261 636b   separate a back
+00006140: 6772 6f75 6e64 2e20 4966 2069 6e20 646f  ground. If in do
+00006150: 7562 742c 2064 6f6e 2774 2075 7365 2069  ubt, don't use i
+00006160: 742e 0a0a 2020 2020 3e3e 3e20 6174 6f6d  t...    >>> atom
+00006170: 732e 7368 6f77 5f69 6d61 6765 2831 3229  s.show_image(12)
+00006180: 0a0a 2020 2020 4974 2069 7320 7468 656e  ..    It is then
+00006190: 206f 7074 696f 6e61 6c20 746f 2064 6566   optional to def
+000061a0: 696e 6520 6120 7265 6665 726e 6365 2072  ine a refernce r
+000061b0: 6567 696f 6e20 666f 7220 7468 6520 696d  egion for the im
+000061c0: 6167 652e 0a20 2020 2049 6620 7375 6368  age..    If such
+000061d0: 2061 2072 6567 696f 6e20 6973 2064 6566   a region is def
+000061e0: 696e 6564 2c20 6174 6f6d 2070 6f73 6974  ined, atom posit
+000061f0: 696f 6e73 2077 696c 6c20 6f6e 6c79 2062  ions will only b
+00006200: 6520 6173 6365 7274 6169 6e65 640a 2020  e ascertained.  
+00006210: 2020 6772 6f6d 2074 6865 2072 6566 6572    grom the refer
+00006220: 656e 6365 2072 6567 696f 6e2e 2049 6620  ence region. If 
+00006230: 796f 7520 646f 6e27 7420 7275 6e20 7468  you don't run th
+00006240: 6973 2073 7465 702c 2074 6865 2065 6e74  is step, the ent
+00006250: 6972 6520 696d 6167 650a 2020 2020 7769  ire image.    wi
+00006260: 6c6c 2062 6520 616e 616c 797a 6564 0a0a  ll be analyzed..
+00006270: 2020 2020 3e3e 3e20 6174 6f6d 732e 6465      >>> atoms.de
+00006280: 6669 6e65 5f72 6566 6572 656e 6365 2828  fine_reference((
+00006290: 3137 2c20 3729 2c20 2832 362c 2037 292c  17, 7), (26, 7),
+000062a0: 2028 3236 2c20 3234 292c 2028 3137 2c20   (26, 24), (17, 
+000062b0: 3234 2929 0a0a 2020 2020 5468 656e 2c20  24))..    Then, 
+000062c0: 7669 7375 616c 697a 6520 7468 6520 7065  visualize the pe
+000062d0: 616b 733a 0a0a 2020 2020 3e3e 3e20 6174  aks:..    >>> at
+000062e0: 6f6d 732e 7065 616b 735f 7669 7328 6469  oms.peaks_vis(di
+000062f0: 7374 3d30 2e31 2c20 7468 7265 7368 3d30  st=0.1, thresh=0
+00006300: 2e31 290a 0a20 2020 2060 6469 7374 6020  .1)..    `dist` 
+00006310: 696e 6469 6361 7465 7320 7468 6520 6469  indicates the di
+00006320: 7374 616e 6365 2062 6574 7765 656e 2074  stance between t
+00006330: 6865 0a20 2020 2070 6561 6b73 2069 6e20  he.    peaks in 
+00006340: 6361 6c69 6272 6174 696f 6e20 756e 6974  calibration unit
+00006350: 732e 2050 6c61 7920 6172 6f75 6e64 2077  s. Play around w
+00006360: 6974 6820 7468 6520 6e75 6d62 6572 7320  ith the numbers 
+00006370: 7469 6c6c 0a20 2020 2079 6f75 2067 6574  till.    you get
+00006380: 2061 2073 6174 6973 6661 6374 6f72 7920   a satisfactory 
+00006390: 7265 7375 6c74 2e20 5468 656e 2072 756e  result. Then run
+000063a0: 2074 6865 2067 6175 7373 6961 6e20 7065   the gaussian pe
+000063b0: 616b 2072 6566 696e 656d 656e 7420 6173  ak refinement as
+000063c0: 3a0a 0a20 2020 203e 3e3e 2061 746f 6d73  :..    >>> atoms
+000063d0: 2e72 6566 696e 655f 7065 616b 7328 290a  .refine_peaks().
+000063e0: 0a20 2020 2059 6f75 2063 616e 2076 6973  .    You can vis
+000063f0: 7561 6c69 7a65 2079 6f75 7220 6669 7474  ualize your fitt
+00006400: 6564 2070 6561 6b73 2061 733a 0a0a 2020  ed peaks as:..  
+00006410: 2020 3e3e 3e20 6174 6f6d 732e 7368 6f77    >>> atoms.show
+00006420: 5f70 6561 6b73 2873 7479 6c65 3d20 2773  _peaks(style= 's
+00006430: 6570 6172 6174 6527 290a 0a20 2020 2063  eparate')..    c
+00006440: 0400 0000 0000 0000 0000 0000 0400 0000  ................
+00006450: 0300 0000 4300 0000 734c 0000 0074 006a  ....C...sL...t.j
+00006460: 01a0 027c 01a1 017c 005f 0374 04a0 057c  ...|...|._.t...|
+00006470: 006a 03a1 017c 005f 067c 027c 005f 077c  .j...|._.|.|._.|
+00006480: 037c 005f 0874 04a0 097c 016a 0aa1 017c  .|._.t...|.j...|
+00006490: 005f 0b64 017c 005f 0c64 017c 005f 0d64  ._.d.|._.d.|._.d
+000064a0: 017c 005f 0e64 0053 0029 024e 4629 0f72  .|._.d.S.).NF).r
+000064b0: 4000 0000 7241 0000 00da 1069 6d61 6765  @...rA.....image
+000064c0: 5f6e 6f72 6d61 6c69 7a65 7272 9c00 0000  _normalizerr....
+000064d0: 7207 0000 0072 0800 0000 da09 696d 636c  r....r......imcl
+000064e0: 6561 6e65 64da 0563 616c 6962 da0b 6361  eaned..calib..ca
+000064f0: 6c69 625f 756e 6974 7372 6300 0000 725d  lib_unitsrc...r]
+00006500: 0000 00da 0769 6d73 6861 7065 da0b 7065  .....imshape..pe
+00006510: 616b 735f 6368 6563 6bda 0e72 6566 696e  aks_check..refin
+00006520: 696e 675f 6368 6563 6bda 0f72 6566 6572  ing_check..refer
+00006530: 656e 6365 5f63 6865 636b 2904 da04 7365  ence_check)...se
+00006540: 6c66 729c 0000 0072 da00 0000 72db 0000  lfr....r....r...
+00006550: 0072 0f00 0000 720f 0000 0072 1000 0000  .r....r....r....
+00006560: da08 5f5f 696e 6974 5f5f 8a03 0000 7310  ..__init__....s.
+00006570: 0000 000e 010e 0106 0106 010e 0106 0106  ................
+00006580: 010a 017a 1161 746f 6d5f 6669 742e 5f5f  ...z.atom_fit.__
+00006590: 696e 6974 5f5f 7201 0000 00a9 0272 1c00  init__r......r..
+000065a0: 0000 721c 0000 00da 0769 6e66 6572 6e6f  ..r......inferno
+000065b0: 6304 0000 0000 0000 0000 0000 0005 0000  c...............
+000065c0: 0004 0000 0043 0000 0073 9400 0000 7c01  .....C...s....|.
+000065d0: 7c00 5f00 7c01 6401 6b04 721a 7401 a002  |._.|.d.k.r.t...
+000065e0: 7c00 6a03 7c01 a102 7c00 5f04 7405 6a06  |.j.|...|._.t.j.
+000065f0: a007 7c00 6a03 7c00 6a04 1800 a101 7c00  ..|.j.|.j.....|.
+00006600: 5f08 7c01 7c00 5f09 740a 6a0b 7c02 6402  _.|.|._.t.j.|.d.
+00006610: 8d01 0100 740a 6a0c 7c00 6a08 7c03 6403  ....t.j.|.j.|.d.
+00006620: 8d02 0100 740d a00e 7c00 6a0f 7c00 6a10  ....t...|.j.|.j.
+00006630: a102 7d04 6404 7c04 5f11 6405 7c04 5f12  ..}.d.|._.d.|._.
+00006640: 6406 7c04 5f13 740a a014 a100 a015 7c04  d.|._.t.......|.
+00006650: a101 0100 740a a016 6407 a101 0100 6408  ....t...d.....d.
+00006660: 5300 2909 61dd 0100 000a 2020 2020 2020  S.).a.....      
+00006670: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00006680: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00006690: 2020 2020 2020 2020 6761 7573 7376 616c          gaussval
+000066a0: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
+000066b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000066c0: 2020 4578 7465 6e74 206f 6620 4761 7573    Extent of Gaus
+000066d0: 7369 616e 2062 6c75 7272 696e 6720 696e  sian blurring in
+000066e0: 2070 6978 656c 730a 2020 2020 2020 2020   pixels.        
+000066f0: 2020 2020 2020 2020 2020 746f 2067 656e            to gen
+00006700: 6572 6174 6520 6120 6261 636b 6772 6f75  erate a backgrou
+00006710: 6e64 2069 6d61 6765 2066 6f72 0a20 2020  nd image for.   
+00006720: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00006730: 7562 7472 6163 7469 6f6e 2e20 4465 6661  ubtraction. Defa
+00006740: 756c 7420 6973 2030 0a20 2020 2020 2020  ult is 0.       
+00006750: 2069 6d73 697a 653a 2020 2074 7570 6c65   imsize:   tuple
+00006760: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00006770: 2020 2020 2020 2020 2020 2020 2053 697a               Siz
+00006780: 6520 696e 2069 6e63 6865 7320 6f66 2074  e in inches of t
+00006790: 6865 2069 6d61 6765 2077 6974 6820 7468  he image with th
+000067a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000067b0: 2020 2020 6469 6666 7261 6374 696f 6e20      diffraction 
+000067c0: 7370 6f74 7320 6d61 726b 6564 2e20 4465  spots marked. De
+000067d0: 6661 756c 7420 6973 2028 3135 2c20 3135  fault is (15, 15
+000067e0: 290a 2020 2020 2020 2020 636f 6c6f 726d  ).        colorm
+000067f0: 6170 3a20 7374 722c 206f 7074 696f 6e61  ap: str, optiona
+00006800: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+00006810: 2020 2020 436f 6c6f 726d 6170 206f 6620      Colormap of 
+00006820: 7468 6520 696d 6167 652e 2044 6566 6175  the image. Defau
+00006830: 6c74 2069 7320 696e 6665 726e 6f0a 2020  lt is inferno.  
+00006840: 2020 2020 2020 7201 0000 0072 1a00 0000        r....r....
+00006850: 7298 0000 00fa 0b6c 6f77 6572 2072 6967  r......lower rig
+00006860: 6874 7203 0000 00da 016b da03 6f66 664e  htr......k..offN
+00006870: 2917 da08 6761 7573 7376 616c 7227 0000  )...gaussvalr'..
+00006880: 0072 8700 0000 729c 0000 005a 0567 626c  .r....r....Z.gbl
+00006890: 7572 7240 0000 0072 4100 0000 72d8 0000  urr@...rA...r...
+000068a0: 0072 d900 0000 5a0b 6761 7573 735f 636c  .r....Z.gauss_cl
+000068b0: 6561 6e72 2d00 0000 722e 0000 0072 2f00  eanr-...r....r/.
+000068c0: 0000 da04 6d70 7373 da08 5363 616c 6542  ....mpss..ScaleB
+000068d0: 6172 72da 0000 0072 db00 0000 da08 6c6f  arr....r......lo
+000068e0: 6361 7469 6f6e da09 626f 785f 616c 7068  cation..box_alph
+000068f0: 6172 9600 0000 da03 6763 6172 9b00 0000  ar......gcar....
+00006900: 7205 0000 0029 0572 e000 0000 72e7 0000  r....).r....r...
+00006910: 0072 3200 0000 5a08 636f 6c6f 726d 6170  .r2...Z.colormap
+00006920: da08 7363 616c 6562 6172 720f 0000 0072  ..scalebarr....r
+00006930: 0f00 0000 7210 0000 00da 0a73 686f 775f  ....r......show_
+00006940: 696d 6167 6594 0300 0073 1a00 0000 060e  image....s......
+00006950: 0801 1001 1601 0601 0c01 1001 1001 0601  ................
+00006960: 0601 0601 0e01 0e01 7a13 6174 6f6d 5f66  ........z.atom_f
+00006970: 6974 2e73 686f 775f 696d 6167 6572 e500  it.show_imager..
+00006980: 0000 6307 0000 0000 0000 0000 0000 001c  ..c.............
+00006990: 0000 0008 0000 0043 0000 0073 1204 0000  .......C...s....
+000069a0: 7400 a001 7c01 a101 7c00 6a02 1b00 7d07  t...|...|.j...}.
+000069b0: 7400 a001 7c02 a101 7c00 6a02 1b00 7d08  t...|...|.j...}.
+000069c0: 7400 a001 7c03 a101 7c00 6a02 1b00 7d09  t...|...|.j...}.
+000069d0: 7400 a001 7c04 a101 7c00 6a02 1b00 7d0a  t...|...|.j...}.
+000069e0: 7400 6a03 6401 7c00 6a04 6401 1900 8502  t.j.d.|.j.d.....
+000069f0: 6401 7c00 6a04 6402 1900 8502 6602 1900  d.|.j.d.....f...
+00006a00: 5c02 7d0b 7d0c 7400 a005 7c0b a101 7d0b  \.}.}.t...|...}.
+00006a10: 7400 a005 7c0c a101 7d0c 7400 a001 7c0c  t...|...}.t...|.
+00006a20: 7c0b 6602 a101 a006 a100 7c07 1800 7d0d  |.f.......|...}.
+00006a30: 7400 a001 7c0c 7c0b 6602 a101 a006 a100  t...|.|.f.......
+00006a40: 7c08 1800 7d0e 7400 a001 7c0c 7c0b 6602  |...}.t...|.|.f.
+00006a50: a101 a006 a100 7c09 1800 7d0f 7400 a001  ......|...}.t...
+00006a60: 7c0c 7c0b 6602 a101 a006 a100 7c0a 1800  |.|.f.......|...
+00006a70: 7d10 7400 a007 7400 6a08 7c0d 7c0e 1400  }.t...t.j.|.|...
+00006a80: 6402 6403 8d02 7400 6a08 7c0d 6404 1300  d.d...t.j.|.d...
+00006a90: 6402 6403 8d02 6405 1300 7400 6a08 7c0e  d.d...d...t.j.|.
+00006aa0: 6404 1300 6402 6403 8d02 6405 1300 1400  d...d.d...d.....
+00006ab0: 1b00 a101 7d11 7400 a007 7400 6a08 7c0e  ....}.t...t.j.|.
+00006ac0: 7c0f 1400 6402 6403 8d02 7400 6a08 7c0e  |...d.d...t.j.|.
+00006ad0: 6404 1300 6402 6403 8d02 6405 1300 7400  d...d.d...d...t.
+00006ae0: 6a08 7c0f 6404 1300 6402 6403 8d02 6405  j.|.d...d.d...d.
+00006af0: 1300 1400 1b00 a101 7d12 7400 a007 7400  ........}.t...t.
+00006b00: 6a08 7c0f 7c10 1400 6402 6403 8d02 7400  j.|.|...d.d...t.
+00006b10: 6a08 7c0f 6404 1300 6402 6403 8d02 6405  j.|.d...d.d...d.
+00006b20: 1300 7400 6a08 7c10 6404 1300 6402 6403  ..t.j.|.d...d.d.
+00006b30: 8d02 6405 1300 1400 1b00 a101 7d13 7400  ..d.........}.t.
+00006b40: a007 7400 6a08 7c10 7c0d 1400 6402 6403  ..t.j.|.|...d.d.
+00006b50: 8d02 7400 6a08 7c10 6404 1300 6402 6403  ..t.j.|.d...d.d.
+00006b60: 8d02 6405 1300 7400 6a08 7c0d 6404 1300  ..d...t.j.|.d...
+00006b70: 6402 6403 8d02 6405 1300 1400 1b00 a101  d.d...d.........
+00006b80: 7d14 7c11 7c12 1700 7c13 1700 7c14 1700  }.|.|...|...|...
+00006b90: 6404 7400 6a09 1400 1b00 a00a 7c00 6a0b  d.t.j.......|.j.
+00006ba0: 6a0c a101 7d15 7400 a00d 7c15 6402 a102  j...}.t...|.d...
+00006bb0: 7c00 5f0e 7400 a00f 7c00 6a0e a101 7c00  |._.t...|.j...|.
+00006bc0: 5f0e 7400 a010 6401 7c00 6a02 7c00 6a04  _.t...d.|.j.|.j.
+00006bd0: 6401 1900 1400 7c00 6a02 a103 7d16 6406  d.....|.j...}.d.
+00006be0: 7d17 7411 7c00 6a04 6401 1900 7c17 6402  }.t.|.j.d...|.d.
+00006bf0: 1800 1b00 8301 7d18 7400 a010 6401 7c00  ......}.t...d.|.
+00006c00: 6a04 6401 1900 7c18 a103 7d19 7400 a012  j.d...|...}.t...
+00006c10: 7c16 6407 6407 7c18 8503 1900 6402 a102  |.d.d.|.....d...
+00006c20: 7d1a 7411 6408 7400 a013 7400 a001 7c05  }.t.d.t...t...|.
+00006c30: a101 a101 1400 8301 7d1b 7414 6409 8301  ........}.t.d...
+00006c40: 0100 7415 6a16 7c05 640a 8d01 0100 7415  ..t.j.|.d.....t.
+00006c50: 6a17 7400 a00f 7c00 6a0b 640b 7c00 6a0e  j.t...|.j.d.|.j.
+00006c60: 1400 1700 a101 640c 640d 640e 8d03 0100  ......d.d.d.....
+00006c70: 7415 6a18 640f 7419 7c01 8301 1700 7c07  t.j.d.t.|.....|.
+00006c80: 7c00 6a04 1b00 6410 7c1b 7c06 6411 8d05  |.j...d.|.|.d...
+00006c90: 0100 7415 6a18 6412 7419 7c02 8301 1700  ..t.j.d.t.|.....
+00006ca0: 7c08 7c00 6a04 1b00 6410 7c1b 7c06 6411  |.|.j...d.|.|.d.
+00006cb0: 8d05 0100 7415 6a18 6413 7419 7c03 8301  ....t.j.d.t.|...
+00006cc0: 1700 7c09 7c00 6a04 1b00 6410 7c1b 7c06  ..|.|.j...d.|.|.
+00006cd0: 6411 8d05 0100 7415 6a18 6414 7419 7c04  d.....t.j.d.t.|.
+00006ce0: 8301 1700 7c0a 7c00 6a04 1b00 6410 7c1b  ....|.|.j...d.|.
+00006cf0: 7c06 6411 8d05 0100 7415 6a1a 7c07 6401  |.d.....t.j.|.d.
+00006d00: 1900 7c07 6402 1900 6415 6416 8d03 0100  ..|.d...d.d.....
+00006d10: 7415 6a1a 7c08 6401 1900 7c08 6402 1900  t.j.|.d...|.d...
+00006d20: 6415 6416 8d03 0100 7415 6a1a 7c09 6401  d.d.....t.j.|.d.
+00006d30: 1900 7c09 6402 1900 6415 6416 8d03 0100  ..|.d...d.d.....
+00006d40: 7415 6a1a 7c0a 6401 1900 7c0a 6402 1900  t.j.|.d...|.d...
+00006d50: 6415 6416 8d03 0100 7415 6a1b 7c19 7c1a  d.d.....t.j.|.|.
+00006d60: 7c1b 6417 8d03 0100 7415 6a1c 7c19 7c1a  |.d.....t.j.|.|.
+00006d70: 7c1b 6417 8d03 0100 7415 6a1d 6418 7c00  |.d.....t.j.d.|.
+00006d80: 6a1e 1700 6419 1700 7c1b 6417 8d02 0100  j...d...|.d.....
+00006d90: 7415 6a1f 641a 7c00 6a1e 1700 6419 1700  t.j.d.|.j...d...
+00006da0: 7c1b 6417 8d02 0100 641b 7c00 5f20 6407  |.d.....d.|._ d.
+00006db0: 5300 291c 615a 0300 000a 2020 2020 2020  S.).aZ....      
+00006dc0: 2020 4c6f 6361 7465 2074 6865 2072 6566    Locate the ref
+00006dd0: 6572 656e 6365 2069 6d61 6765 2e0a 0a20  erence image... 
+00006de0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00006df0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00006e00: 2d2d 2d2d 0a20 2020 2020 2020 2041 5f70  ----.        A_p
+00006e10: 743a 2020 2074 7570 6c65 0a20 2020 2020  t:   tuple.     
+00006e20: 2020 2020 2020 2020 2020 2054 6f70 206c             Top l
+00006e30: 6566 7420 706f 7369 7469 6f6e 206f 6620  eft position of 
+00006e40: 7265 6665 7265 6e63 6520 7265 6769 6f6e  reference region
+00006e50: 2069 6e20 2878 2c20 7929 0a20 2020 2020   in (x, y).     
+00006e60: 2020 2042 5f70 743a 2020 2074 7570 6c65     B_pt:   tuple
+00006e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006e80: 2054 6f70 2072 6967 6874 2070 6f73 6974   Top right posit
+00006e90: 696f 6e20 6f66 2072 6566 6572 656e 6365  ion of reference
+00006ea0: 2072 6567 696f 6e20 696e 2028 782c 2079   region in (x, y
+00006eb0: 290a 2020 2020 2020 2020 435f 7074 3a20  ).        C_pt: 
+00006ec0: 2020 7475 706c 650a 2020 2020 2020 2020    tuple.        
+00006ed0: 2020 2020 2020 2020 426f 7474 6f6d 2072          Bottom r
+00006ee0: 6967 6874 2070 6f73 6974 696f 6e20 6f66  ight position of
+00006ef0: 2072 6566 6572 656e 6365 2072 6567 696f   reference regio
+00006f00: 6e20 696e 2028 782c 2079 290a 2020 2020  n in (x, y).    
+00006f10: 2020 2020 445f 7074 3a20 2020 7475 706c      D_pt:   tupl
+00006f20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00006f30: 2020 426f 7474 6f6d 206c 6566 7420 706f    Bottom left po
+00006f40: 7369 7469 6f6e 206f 6620 7265 6665 7265  sition of refere
+00006f50: 6e63 6520 7265 6769 6f6e 2069 6e20 2878  nce region in (x
+00006f60: 2c20 7929 0a20 2020 2020 2020 2069 6d73  , y).        ims
+00006f70: 697a 653a 2074 7570 6c65 2c20 6f70 7469  ize: tuple, opti
+00006f80: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00006f90: 2020 2020 2053 697a 6520 696e 2069 6e63       Size in inc
+00006fa0: 6865 7320 6f66 2074 6865 2069 6d61 6765  hes of the image
+00006fb0: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
+00006fc0: 2020 2020 2020 2020 2020 6469 6666 7261            diffra
+00006fd0: 6374 696f 6e20 7370 6f74 7320 6d61 726b  ction spots mark
+00006fe0: 6564 2e20 4465 6661 756c 7420 6973 0a20  ed. Default is. 
+00006ff0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00007000: 3130 2c20 3130 290a 2020 2020 2020 2020  10, 10).        
+00007010: 7443 6f6c 6f72 3a20 7374 722c 206f 7074  tColor: str, opt
+00007020: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00007030: 2020 2020 2020 436f 6c6f 7220 6f66 2074        Color of t
+00007040: 6865 2074 6578 7420 6f6e 2074 6865 2069  he text on the i
+00007050: 6d61 6765 2e20 4465 6661 756c 7420 6973  mage. Default is
+00007060: 2062 6c61 636b 0a0a 2020 2020 2020 2020   black..        
+00007070: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+00007080: 2d2d 2d0a 2020 2020 2020 2020 4c6f 6361  ---.        Loca
+00007090: 7465 7320 6120 7265 6665 7265 6e63 6520  tes a reference 
+000070a0: 7265 6769 6f6e 2062 6f75 6e64 6564 2062  region bounded b
+000070b0: 7920 7468 6520 666f 7572 2070 6f69 6e74  y the four point
+000070c0: 7320 6769 7665 6e20 696e 0a20 2020 2020  s given in.     
+000070d0: 2020 206c 656e 6774 6820 756e 6974 732e     length units.
+000070e0: 2043 686f 6f73 6520 7468 6520 706f 696e   Choose the poin
+000070f0: 7473 2069 6e20 6120 636c 6f63 6b77 6973  ts in a clockwis
+00007100: 6520 6661 7368 696f 6e2e 0a20 2020 2020  e fashion..     
+00007110: 2020 2072 0100 0000 7203 0000 0072 0400     r....r....r..
+00007120: 0000 7202 0000 0072 0600 0000 7212 0000  ..r....r....r...
+00007130: 004e 6700 0000 0000 00f8 3f7a 4e43 686f  .Ng.......?zNCho
+00007140: 6f73 6520 796f 7572 2070 6f69 6e74 7320  ose your points 
+00007150: 696e 2061 2063 6c6f 636b 7769 7365 2066  in a clockwise f
+00007160: 6173 6869 6f6e 2c20 6f72 2065 6c73 6520  ashion, or else 
+00007170: 796f 7520 7769 6c6c 2067 6574 2061 2077  you will get a w
+00007180: 726f 6e67 2072 6573 756c 7472 1a00 0000  rong resultr....
+00007190: 7295 0000 00da 056d 6167 6d61 da05 6c6f  r......magma..lo
+000071a0: 7765 7229 0272 9900 0000 72b7 0000 007a  wer).r....r....z
+000071b0: 0241 3d7a 0d61 7865 7320 6672 6163 7469  .A=z.axes fracti
+000071c0: 6f6e 2903 5a0a 7465 7874 636f 6f72 6473  on).Z.textcoords
+000071d0: da04 7369 7a65 7296 0000 007a 0242 3d7a  ..sizer....z.B=z
+000071e0: 0243 3d7a 0244 3dda 0172 2901 721e 0000  .C=z.D=..r).r...
+000071f0: 0029 015a 0866 6f6e 7473 697a 657a 1744  .).Z.fontsizez.D
+00007200: 6973 7461 6e63 6520 616c 6f6e 6720 582d  istance along X-
+00007210: 6178 6973 2028 fa01 297a 1744 6973 7461  axis (..)z.Dista
+00007220: 6e63 6520 616c 6f6e 6720 592d 6178 6973  nce along Y-axis
+00007230: 2028 5429 2172 0700 0000 7263 0000 0072   (T)!r....rc...r
+00007240: da00 0000 725c 0000 0072 dc00 0000 72c1  ....r\...r....r.
+00007250: 0000 005a 0974 7261 6e73 706f 7365 72a3  ...Z.transposer.
+00007260: 0000 0072 0a00 0000 da02 7069 5a07 7265  ...r......piZ.re
+00007270: 7368 6170 6572 d900 0000 725d 0000 00da  shaper....r]....
+00007280: 0769 7363 6c6f 7365 da07 7265 665f 7265  .isclose..ref_re
+00007290: 675a 0666 6c69 7075 6472 3f00 0000 7226  gZ.flipudr?...r&
+000072a0: 0000 0072 ad00 0000 72a0 0000 00da 0570  ...r....r......p
+000072b0: 7269 6e74 722d 0000 0072 2e00 0000 722f  rintr-...r....r/
+000072c0: 0000 005a 0861 6e6e 6f74 6174 65da 0373  ...Z.annotate..s
+000072d0: 7472 7230 0000 005a 0678 7469 636b 735a  trr0...Z.xticksZ
+000072e0: 0679 7469 636b 735a 0678 6c61 6265 6c72  .yticksZ.xlabelr
+000072f0: db00 0000 5a06 796c 6162 656c 72df 0000  ....Z.ylabelr...
+00007300: 0029 1c72 e000 0000 5a04 415f 7074 5a04  .).r....Z.A_ptZ.
+00007310: 425f 7074 5a04 435f 7074 5a04 445f 7074  B_ptZ.C_ptZ.D_pt
+00007320: 7232 0000 005a 0674 436f 6c6f 72da 0141  r2...Z.tColor..A
+00007330: da01 42da 0143 da01 4472 6a00 0000 726b  ..B..C..Drj...rk
+00007340: 0000 005a 0470 7441 415a 0470 7442 425a  ...Z.ptAAZ.ptBBZ
+00007350: 0470 7443 435a 0470 7444 445a 0761 6e67  .ptCCZ.ptDDZ.ang
+00007360: 4141 4242 5a07 616e 6742 4243 435a 0761  AABBZ.angBBCCZ.a
+00007370: 6e67 4343 4444 5a07 616e 6744 4441 415a  ngCCDDZ.angDDAAZ
+00007380: 0661 6e67 7375 6d5a 0a70 6978 656c 5f6c  .angsumZ.pixel_l
+00007390: 6973 745a 096e 6f5f 6c61 6265 6c73 5a06  istZ.no_labelsZ.
+000073a0: 7374 6570 5f78 5a0b 785f 706f 7369 7469  step_xZ.x_positi
+000073b0: 6f6e 735a 0878 5f6c 6162 656c 73da 0566  onsZ.x_labels..f
+000073c0: 7369 7a65 720f 0000 0072 0f00 0000 7210  sizer....r....r.
+000073d0: 0000 00da 1064 6566 696e 655f 7265 6665  .....define_refe
+000073e0: 7265 6e63 65b0 0300 0073 c000 0000 101a  rence....s......
+000073f0: 1001 1001 1001 2602 0a01 0a01 1601 1601  ......&.........
+00007400: 1601 1601 0401 1001 1402 1401 02ff 02fe  ................
+00007410: 04ff 0407 1001 1402 1401 02ff 02fe 04ff  ................
+00007420: 0407 1001 1402 1401 02ff 02fe 04ff 0407  ................
+00007430: 1001 1402 1401 02ff 02fe 04ff 1a07 0601  ................
+00007440: 04ff 0e03 0e01 1c02 0401 1601 1401 1601  ................
+00007450: 1801 0202 0201 04ff 0c04 0401 1401 0201  ................
+00007460: 0201 06fd 0405 0a01 0801 0201 0201 0201  ................
+00007470: 06fb 0407 0a01 0801 0201 0201 0201 06fb  ................
+00007480: 0407 0a01 0801 0201 0201 0201 06fb 0407  ................
+00007490: 0a01 0801 0201 0201 0201 06fb 1807 1801  ................
+000074a0: 1801 1801 1001 1001 1801 1801 0a01 7a19  ..............z.
+000074b0: 6174 6f6d 5f66 6974 2e64 6566 696e 655f  atom_fit.define_
+000074c0: 7265 6665 7265 6e63 6572 0200 0000 721e  referencer....r.
+000074d0: 0000 0063 0600 0000 0000 0000 0000 0000  ...c............
+000074e0: 0d00 0000 0900 0000 4300 0000 7378 0100  ........C...sx..
+000074f0: 007c 006a 0073 0c74 016a 027c 006a 0374  .|.j.s.t.j.|.j.t
+00007500: 0464 018d 027c 005f 057c 017c 006a 061b  .d...|._.|.|.j..
+00007510: 007d 0674 07a0 087c 006a 037c 03a1 027c  .}.t...|.j.|...|
+00007520: 005f 097c 027c 005f 0a7c 006a 097c 006a  ._.|.|._.|.j.|.j
+00007530: 0514 007c 006a 0a18 0064 027c 006a 0a18  ...|.j...d.|.j..
+00007540: 001b 007c 005f 0b64 037c 006a 0b7c 006a  ...|._.d.|.j.|.j
+00007550: 0b64 036b 003c 0074 0c6a 0d7c 006a 0b74  .d.k.<.t.j.|.j.t
+00007560: 0e7c 0664 041b 0083 0164 0564 068d 037d  .|.d.....d.d...}
+00007570: 0774 076a 0fa0 107c 07a1 0164 0319 007d  .t.j...|...d...}
+00007580: 0874 076a 0fa0 117c 077c 0874 1264 0274  .t.j...|.|.t.d.t
+00007590: 01a0 137c 08a1 0164 0217 0083 02a1 037d  ...|...d.......}
+000075a0: 0974 01a0 147c 09a1 017d 0a74 156a 16a0  .t...|...}.t.j..
+000075b0: 177c 0a7c 06a1 02a0 1874 016a 19a1 017c  .|.|.....t.j...|
+000075c0: 005f 1a74 0e64 0774 01a0 1b74 01a0 1c7c  ._.t.d.t...t...|
+000075d0: 04a1 01a1 0114 0083 017d 0b74 1d6a 1e7c  .........}.t.j.|
+000075e0: 0464 088d 0101 0074 1d6a 1f7c 006a 0964  .d.....t.j.|.j.d
+000075f0: 0964 0a8d 0201 0074 1d6a 207c 006a 1a64  .d.....t.j |.j.d
+00007600: 0064 0085 0264 0266 0219 007c 006a 1a64  .d...d.f...|.j.d
+00007610: 0064 0085 0264 0366 0219 007c 057c 0b64  .d...d.f...|.|.d
+00007620: 0b8d 0401 0074 21a0 227c 006a 067c 006a  .....t!."|.j.|.j
+00007630: 23a1 027d 0c64 0c7c 0c5f 2464 027c 0c5f  #..}.d.|._$d.|._
+00007640: 2564 0d7c 0c5f 2674 1da0 27a1 00a0 287c  %d.|._&t..'...(|
+00007650: 0ca1 0101 0074 1da0 2964 0ea1 0101 0064  .....t..)d.....d
+00007660: 0f7c 005f 2a64 0053 0029 104e 7216 0000  .|._*d.S.).Nr...
+00007670: 0072 0300 0000 7201 0000 0072 1700 0000  .r....r....r....
+00007680: 4672 1800 0000 7206 0000 0072 1a00 0000  Fr....r....r....
+00007690: 72ef 0000 0072 9800 0000 721d 0000 0072  r....r....r....r
+000076a0: e400 0000 72e5 0000 0072 e600 0000 5429  ....r....r....T)
+000076b0: 2b72 df00 0000 7207 0000 005a 096f 6e65  +r....r....Z.one
+000076c0: 735f 6c69 6b65 72d9 0000 00da 0462 6f6f  s_liker......boo
+000076d0: 6c72 f600 0000 72da 0000 0072 2700 0000  lr....r....r'...
+000076e0: 7287 0000 005a 0669 6d66 696c 7472 8c00  r....Z.imfiltr..
+000076f0: 0000 7233 0000 0072 2400 0000 7225 0000  ..r3...r$...r%..
+00007700: 0072 2600 0000 7228 0000 0072 2900 0000  .r&...r(...r)...
+00007710: 722a 0000 0072 2b00 0000 722c 0000 0072  r*...r+...r,...r
+00007720: 2200 0000 7240 0000 00da 0461 6669 7472  "...r@.....afitr
+00007730: 1100 0000 7288 0000 0072 2300 0000 7237  ....r....r#...r7
+00007740: 0000 0072 a000 0000 7263 0000 0072 2d00  ...r....rc...r-.
+00007750: 0000 722e 0000 0072 2f00 0000 7230 0000  ..r....r/...r0..
+00007760: 0072 e800 0000 72e9 0000 0072 db00 0000  .r....r....r....
+00007770: 72ea 0000 0072 eb00 0000 7296 0000 0072  r....r....r....r
+00007780: ec00 0000 729b 0000 0072 0500 0000 72dd  ....r....r....r.
+00007790: 0000 0029 0d72 e000 0000 720e 0000 0072  ...).r....r....r
+000077a0: 3100 0000 5a05 6766 696c 7472 3200 0000  1...Z.gfiltr2...
+000077b0: 5a0a 7370 6f74 5f63 6f6c 6f72 5a0a 7069  Z.spot_colorZ.pi
+000077c0: 7865 6c5f 6469 7374 7234 0000 0072 3500  xel_distr4...r5.
+000077d0: 0000 7236 0000 0072 3700 0000 da09 7370  ..r6...r7.....sp
+000077e0: 6f74 5f73 697a 6572 ed00 0000 720f 0000  ot_sizer....r...
+000077f0: 0072 0f00 0000 7210 0000 0072 3800 0000  .r....r....r8...
+00007800: 2f04 0000 733a 0000 0006 0112 010a 0110  /...s:..........
+00007810: 0106 0110 0108 0106 ff10 0304 0110 0106  ................
+00007820: ff10 0306 0116 0104 ff0a 0318 0118 010c  ................
+00007830: 0110 012e 0110 0106 0106 0106 010e 010a  ................
+00007840: 010a 017a 1261 746f 6d5f 6669 742e 7065  ...z.atom_fit.pe
+00007850: 616b 735f 7669 7363 0100 0000 0000 0000  aks_visc........
+00007860: 0000 0000 0400 0000 0800 0000 4300 0000  ............C...
+00007870: 73c2 0000 007c 006a 0073 0774 0164 0183  s....|.j.s.t.d..
+00007880: 0182 0174 0274 037c 006a 0483 0164 021b  ...t.t.|.j...d..
+00007890: 0083 017d 0174 056a 06a0 077c 006a 0464  ...}.t.j...|.j.d
+000078a0: 037c 0185 0264 0064 0085 0266 0219 00a1  .|...d.d...f....
+000078b0: 0101 0074 056a 06a0 077c 006a 04a1 017d  ...t.j...|.j...}
+000078c0: 0274 086a 0974 037c 006a 0483 0164 0466  .t.j.t.|.j...d.f
+000078d0: 0274 086a 0a64 058d 027d 0374 056a 06a0  .t.j.d...}.t.j..
+000078e0: 0b7c 006a 0c7c 006a 0464 037c 0185 0264  .|.j.|.j.d.|...d
+000078f0: 0064 0085 0266 0219 007c 0364 037c 0185  .d...f...|.d.|..
+00007900: 0264 0064 0085 0266 0219 007c 02a1 0401  .d.d...f...|....
+00007910: 0074 056a 06a0 0b7c 006a 0c7c 006a 047c  .t.j...|.j.|.j.|
+00007920: 037c 02a1 0401 007c 037c 005f 0d64 067c  .|.....|.|._.d.|
+00007930: 005f 0e64 0053 0029 074e 7a34 506c 6561  ._.d.S.).Nz4Plea
+00007940: 7365 206c 6f63 6174 6520 7468 6520 696e  se locate the in
+00007950: 6974 6961 6c20 7065 616b 7320 6669 7273  itial peaks firs
+00007960: 7420 6173 2070 6561 6b73 5f76 6973 2829  t as peaks_vis()
+00007970: e932 0000 0072 0100 0000 723a 0000 0072  .2...r....r:...r
+00007980: 1600 0000 5429 0f72 dd00 0000 da0c 5275  ....T).r......Ru
+00007990: 6e74 696d 6545 7272 6f72 7226 0000 0072  ntimeErrorr&...r
+000079a0: 0900 0000 7237 0000 0072 4000 0000 7200  ....r7...r@...r.
+000079b0: 0100 0072 4800 0000 7207 0000 0072 3d00  ...rH...r....r=.
+000079c0: 0000 7223 0000 0072 4d00 0000 72d9 0000  ..r#...rM...r...
+000079d0: 00da 0d72 6566 696e 6564 5f70 6561 6b73  ...refined_peaks
+000079e0: 72de 0000 0029 0472 e000 0000 da04 7465  r....).r......te
+000079f0: 7374 5a02 6d64 7204 0100 0072 0f00 0000  stZ.mdr....r....
+00007a00: 720f 0000 0072 1000 0000 da0c 7265 6669  r....r......refi
+00007a10: 6e65 5f70 6561 6b73 4e04 0000 7318 0000  ne_peaksN...s...
+00007a20: 0006 0108 0112 011e 010e 011a 0106 032c  ...............,
+00007a30: 0104 ff16 0506 010a 017a 1561 746f 6d5f  .........z.atom_
+00007a40: 6669 742e 7265 6669 6e65 5f70 6561 6b73  fit.refine_peaks
+00007a50: da08 746f 6765 7468 6572 6303 0000 0000  ..togetherc.....
+00007a60: 0000 0000 0000 0007 0000 0007 0000 0043  ...............C
+00007a70: 0000 0073 6402 0000 7c00 6a00 7307 7401  ...sd...|.j.s.t.
+00007a80: 6401 8301 8201 7402 7403 a004 6402 a101  d.....t.t...d...
+00007a90: 7403 a004 7c01 a101 1400 8301 7d03 7405  t...|.......}.t.
+00007aa0: 7403 a006 7403 a004 7c01 a101 a101 8301  t...t...|.......
+00007ab0: 7d04 7405 6403 7c04 1400 8301 7d05 7c02  }.t.d.|.....}.|.
+00007ac0: 6404 6b02 728e 7407 6a08 7c01 6405 8d01  d.k.r.t.j.|.d...
+00007ad0: 0100 7407 6a09 7c00 6a0a 6406 6407 8d02  ..t.j.|.j.d.d...
+00007ae0: 0100 7407 6a0b 7c00 6a0c 6400 6400 8502  ..t.j.|.j.d.d...
+00007af0: 6408 6602 1900 7c00 6a0c 6400 6400 8502  d.f...|.j.d.d...
+00007b00: 6409 6602 1900 640a 7c05 640b 640c 8d05  d.f...d.|.d.d...
+00007b10: 0100 7407 6a0b 7c00 6a0d 6400 6400 8502  ..t.j.|.j.d.d...
+00007b20: 6408 6602 1900 7c00 6a0d 6400 6400 8502  d.f...|.j.d.d...
+00007b30: 6409 6602 1900 640d 7c04 640e 640c 8d05  d.f...d.|.d.d...
+00007b40: 0100 7407 a00e a100 6a0f 640f 6403 6408  ..t.....j.d.d.d.
+00007b50: 6410 8d03 0100 7410 a011 7c00 6a12 7c00  d.....t...|.j.|.
+00007b60: 6a13 a102 7d06 6411 7c06 5f14 6408 7c06  j...}.d.|._.d.|.
+00007b70: 5f15 6412 7c06 5f16 7407 a00e a100 a017  _.d.|._.t.......
+00007b80: 7c06 a101 0100 7407 a018 6413 a101 0100  |.....t...d.....
+00007b90: 6400 5300 7407 6a08 7c03 6405 8d01 0100  d.S.t.j.|.d.....
+00007ba0: 7407 a019 6408 6414 6408 a103 0100 7407  t...d.d.d.....t.
+00007bb0: 6a09 7c00 6a0a 6406 6407 8d02 0100 7407  j.|.j.d.d.....t.
+00007bc0: 6a0b 7c00 6a0c 6400 6400 8502 6408 6602  j.|.j.d.d...d.f.
+00007bd0: 1900 7c00 6a0c 6400 6400 8502 6409 6602  ..|.j.d.d...d.f.
+00007be0: 1900 6415 7c04 640b 640c 8d05 0100 7407  ..d.|.d.d.....t.
+00007bf0: a00e a100 6a0f 640f 6403 6408 6410 8d03  ....j.d.d.d.d...
+00007c00: 0100 7410 a011 7c00 6a12 7c00 6a13 a102  ..t...|.j.|.j...
+00007c10: 7d06 6411 7c06 5f14 6408 7c06 5f15 6412  }.d.|._.d.|._.d.
+00007c20: 7c06 5f16 7407 a00e a100 a017 7c06 a101  |._.t.......|...
+00007c30: 0100 7407 a018 6413 a101 0100 7407 a019  ..t...d.....t...
+00007c40: 6408 6414 6414 a103 0100 7407 6a09 7c00  d.d.d.....t.j.|.
+00007c50: 6a0a 6406 6407 8d02 0100 7407 6a0b 7c00  j.d.d.....t.j.|.
+00007c60: 6a0d 6400 6400 8502 6408 6602 1900 7c00  j.d.d...d.f...|.
+00007c70: 6a0d 6400 6400 8502 6409 6602 1900 6412  j.d.d...d.f...d.
+00007c80: 7c04 640e 640c 8d05 0100 7407 a00e a100  |.d.d.....t.....
+00007c90: 6a0f 640f 6403 6408 6410 8d03 0100 7410  j.d.d.d.d.....t.
+00007ca0: a011 7c00 6a12 7c00 6a13 a102 7d06 6411  ..|.j.|.j...}.d.
+00007cb0: 7c06 5f14 6408 7c06 5f15 6412 7c06 5f16  |._.d.|._.d.|._.
+00007cc0: 7407 a00e a100 a017 7c06 a101 0100 7407  t.......|.....t.
+00007cd0: a018 6413 a101 0100 6400 5300 2916 4e7a  ..d.....d.S.).Nz
+00007ce0: 3450 6c65 6173 6520 7265 6669 6e65 2074  4Please refine t
+00007cf0: 6865 2061 746f 6d20 7065 616b 7320 6669  he atom peaks fi
+00007d00: 7273 7420 6173 2072 6566 696e 655f 7065  rst as refine_pe
+00007d10: 616b 7328 2929 0272 0200 0000 7203 0000  aks()).r....r...
+00007d20: 0072 1700 0000 7207 0100 0072 1a00 0000  .r....r....r....
+00007d30: 72ef 0000 0072 9800 0000 7203 0000 0072  r....r....r....r
+00007d40: 0100 0000 721e 0000 007a 0e4f 7269 6769  ....r....z.Origi
+00007d50: 6e61 6c20 5065 616b 7329 0372 1e00 0000  nal Peaks).r....
+00007d60: 721f 0000 0072 2900 0000 72f2 0000 007a  r....r)...r....z
+00007d70: 0c46 6974 7465 6420 5065 616b 737a 0a75  .Fitted Peaksz.u
+00007d80: 7070 6572 206c 6566 7429 03da 036c 6f63  pper left)...loc
+00007d90: 5a0b 6d61 726b 6572 7363 616c 655a 0a66  Z.markerscaleZ.f
+00007da0: 7261 6d65 616c 7068 6172 e400 0000 72e5  ramealphar....r.
+00007db0: 0000 0072 e600 0000 7202 0000 0072 1b00  ...r....r....r..
+00007dc0: 0000 291a 72de 0000 0072 0301 0000 da05  ..).r....r......
+00007dd0: 7475 706c 6572 0700 0000 7263 0000 0072  tupler....rc...r
+00007de0: 2600 0000 7220 0000 0072 2d00 0000 722e  &...r ...r-...r.
+00007df0: 0000 0072 2f00 0000 72d9 0000 0072 3000  ...r/...r....r0.
+00007e00: 0000 7237 0000 0072 0401 0000 72ec 0000  ..r7...r....r...
+00007e10: 005a 066c 6567 656e 6472 e800 0000 72e9  .Z.legendr....r.
+00007e20: 0000 0072 da00 0000 72db 0000 0072 ea00  ...r....r....r..
+00007e30: 0000 72eb 0000 0072 9600 0000 729b 0000  ..r....r....r...
+00007e40: 0072 0500 0000 5a07 7375 6270 6c6f 7429  .r....Z.subplot)
+00007e50: 0772 e000 0000 7232 0000 00da 0573 7479  .r....r2.....sty
+00007e60: 6c65 5a07 746f 6773 697a 6572 0101 0000  leZ.togsizer....
+00007e70: 5a08 6269 675f 7369 7a65 72ed 0000 0072  Z.big_sizer....r
+00007e80: 0f00 0000 720f 0000 0072 1000 0000 da0a  ....r....r......
+00007e90: 7368 6f77 5f70 6561 6b73 6004 0000 737c  show_peaks`...s|
+00007ea0: 0000 0006 0108 0118 0114 010c 0108 010c  ................
+00007eb0: 0110 0104 0110 0110 0102 0102 0102 0106  ................
+00007ec0: fb04 0710 0110 0102 0102 0102 0106 fb14  ................
+00007ed0: 0710 0106 0106 0106 010e 010e 010c 020e  ................
+00007ee0: 0110 0104 0110 0110 0102 0102 0102 0106  ................
+00007ef0: fb14 0710 0106 0106 0106 010e 010a 010e  ................
+00007f00: 0210 0104 0110 0110 0102 0102 0102 0106  ................
+00007f10: fb14 0710 0106 0106 0106 010e 010e 017a  ...............z
+00007f20: 1361 746f 6d5f 6669 742e 7368 6f77 5f70  .atom_fit.show_p
+00007f30: 6561 6b73 4e29 0372 0100 0000 72e2 0000  eaksN).r....r...
+00007f40: 0072 e300 0000 2902 72e2 0000 0072 e500  .r....).r....r..
+00007f50: 0000 2903 7202 0000 0072 e200 0000 721e  ..).r....r....r.
+00007f60: 0000 0029 0272 e200 0000 7207 0100 0029  ...).r....r....)
+00007f70: 0ada 085f 5f6e 616d 655f 5fda 0a5f 5f6d  ...__name__..__m
+00007f80: 6f64 756c 655f 5fda 0c5f 5f71 7561 6c6e  odule__..__qualn
+00007f90: 616d 655f 5fda 075f 5f64 6f63 5f5f 72e1  ame__..__doc__r.
+00007fa0: 0000 0072 ee00 0000 72fe 0000 0072 3800  ...r....r....r8.
+00007fb0: 0000 7206 0100 0072 0b01 0000 720f 0000  ..r....r....r...
+00007fc0: 0072 0f00 0000 720f 0000 0072 1000 0000  .r....r....r....
+00007fd0: 72d7 0000 0051 0300 0073 1000 0000 0800  r....Q...s......
+00007fe0: 0401 0838 0a0a 0a1c 0a7f 081f 0e12 72d7  ...8..........r.
+00007ff0: 0000 0029 0372 1200 0000 7213 0000 0072  ...).r....r....r
+00008000: 1400 0000 2904 724e 0000 0072 4f00 0000  ....).rN...rO...
+00008010: 7250 0000 0046 2904 724e 0000 0072 4f00  rP...F).rN...rO.
+00008020: 0000 7250 0000 0072 7f00 0000 2901 7282  ..rP...r....).r.
+00008030: 0000 0029 0172 7f00 0000 2902 7217 0000  ...).r....).r...
+00008040: 0054 2929 5a0f 736b 696d 6167 652e 6665  .T))Z.skimage.fe
+00008050: 6174 7572 655a 0766 6561 7475 7265 7224  atureZ.featurer$
+00008060: 0000 005a 116d 6174 706c 6f74 6c69 622e  ...Z.matplotlib.
+00008070: 7079 706c 6f74 5a06 7079 706c 6f74 722d  pyplotZ.pyplotr-
+00008080: 0000 005a 056e 756d 7079 7207 0000 005a  ...Z.numpyr....Z
+00008090: 0d73 6369 7079 2e6e 6469 6d61 6765 5a07  .scipy.ndimageZ.
+000080a0: 6e64 696d 6167 6572 2700 0000 5a0e 7363  ndimager'...Z.sc
+000080b0: 6970 792e 6f70 7469 6d69 7a65 da08 6f70  ipy.optimize..op
+000080c0: 7469 6d69 7a65 7260 0000 005a 1173 6369  timizer`...Z.sci
+000080d0: 7079 2e69 6e74 6572 706f 6c61 7465 5a0b  py.interpolateZ.
+000080e0: 696e 7465 7270 6f6c 6174 6572 d300 0000  interpolater....
+000080f0: 723b 0000 005a 1c6d 6174 706c 6f74 6c69  r;...Z.matplotli
+00008100: 625f 7363 616c 6562 6172 2e73 6361 6c65  b_scalebar.scale
+00008110: 6261 7272 ed00 0000 72e8 0000 00da 0873  barr....r......s
+00008120: 7465 6d74 6f6f 6c72 4000 0000 7211 0000  temtoolr@...r...
+00008130: 0072 3800 0000 724d 0000 0072 7e00 0000  .r8...rM...r~...
+00008140: 7281 0000 0072 9400 0000 729e 0000 0072  r....r....r....r
+00008150: aa00 0000 72b8 0000 0072 be00 0000 72c0  ....r....r....r.
+00008160: 0000 0072 c800 0000 72d0 0000 0072 d500  ...r....r....r..
+00008170: 0000 72d6 0000 0072 4800 0000 da06 6f62  ..r....rH.....ob
+00008180: 6a65 6374 72d7 0000 0072 0f00 0000 720f  jectr....r....r.
+00008190: 0000 0072 0f00 0000 7210 0000 00da 083c  ...r....r......<
+000081a0: 6d6f 6475 6c65 3e01 0000 0073 4a00 0000  module>....sJ...
+000081b0: 0c00 0c01 0801 0c01 0c01 0c01 0801 0c01  ................
+000081c0: 0801 0803 0a0e 083b 022c 0201 0201 0201  .......;.,......
+000081d0: 0afa 007f 0202 0201 0201 0201 0afa 007f  ................
+000081e0: 0a0b 081c 0829 0848 081a 082d 0a22 0837  .....).H...-.".7
+000081f0: 0820 0a21 0846 080d 140a                 . .!.F....
```

## Comparing `stemtool/afit/__pycache__/drift_corr.cpython-39.pyc` & `stemtool/afit/__pycache__/drift_corr.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:26:09 2023 UTC, .py size: 9668 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 7% similar despite different names*

```diff
@@ -1,29 +1,29 @@
-00000000: 610d 0d0a 0000 0000 3138 e163 c425 0000  a.......18.c.%..
+00000000: 6f0d 0d0a 0000 0000 0574 6f64 0728 0000  o........tod.(..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 6600 0000 6400  .....@...sf...d.
 00000030: 6401 6c00 6d01 5a02 0100 6400 6401 6c03  d.l.m.Z...d.d.l.
 00000040: 5a04 6400 6401 6c05 6d06 5a07 0100 6400  Z.d.d.l.m.Z...d.
 00000050: 6401 6c08 5a09 6400 6401 6c0a 6d0b 5a0c  d.l.Z.d.d.l.m.Z.
 00000060: 0100 6400 6401 6c0d 6d0e 5a0f 0100 6409  ..d.d.l.m.Z...d.
 00000070: 6403 6404 8401 5a10 6405 6406 8400 5a11  d.d...Z.d.d...Z.
 00000080: 4700 6407 6408 8400 6408 6512 8303 5a13  G.d.d...d.e...Z.
 00000090: 6401 5300 290a e900 0000 004e e9f4 0100  d.S.)......N....
 000000a0: 0063 0500 0000 0000 0000 0000 0000 0900  .c..............
 000000b0: 0000 0b00 0000 4300 0000 7396 0000 0074  ......C...s....t
 000000c0: 006a 01a0 02a1 0001 0074 0374 047c 0383  .j.......t.t.|..
-000000d0: 0183 0144 005d 7a7d 057c 037c 0564 0166  ...D.]z}.|.|.d.f
+000000d0: 0183 0144 005d 3d7d 057c 037c 0564 0166  ...D.]=}.|.|.d.f
 000000e0: 0219 007d 067c 037c 0564 0266 0219 007d  ...}.|.|.d.f...}
 000000f0: 0774 056a 06a0 0774 006a 08a0 097c 007c  .t.j...t.j...|.|
 00000100: 0664 0364 0385 0264 0364 0385 0266 0319  .d.d...d.d...f..
 00000110: 00a1 0174 006a 08a0 097c 007c 0764 0364  ...t.j...|.|.d.d
 00000120: 0385 0264 0364 0385 0266 0319 00a1 017c  ...d.d...f.....|
 00000130: 04a1 035c 057c 017c 067c 0766 023c 007c  ...\.|.|.|.f.<.|
 00000140: 027c 067c 0766 023c 007d 087d 087d 0871  .|.|.f.<.}.}.}.q
-00000150: 1664 0353 0029 0461 3905 0000 0a20 2020  .d.S.).a9....   
+00000150: 0b64 0353 0029 0461 3a05 0000 0a20 2020  .d.S.).a:....   
 00000160: 2043 726f 7373 2d43 6f72 7265 6c61 7465   Cross-Correlate
 00000170: 2073 7461 636b 206f 6620 696d 6167 6573   stack of images
 00000180: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
 00000190: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
 000001a0: 2020 2020 696d 6167 655f 7374 6163 6b3a      image_stack:
 000001b0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
 000001c0: 2020 2020 2020 2020 2020 5374 6163 6b20            Stack 
@@ -99,463 +99,477 @@
 00000620: 6e2c 204a 2e2c 2032 3031 382e 2049 6d61  n, J., 2018. Ima
 00000630: 6765 2072 6567 6973 7472 6174 696f 6e20  ge registration 
 00000640: 6f66 206c 6f77 2073 6967 6e61 6c2d 746f  of low signal-to
 00000650: 2d6e 6f69 7365 2063 7279 6f2d 5354 454d  -noise cryo-STEM
 00000660: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
 00000670: 2055 6c74 7261 6d69 6372 6f73 636f 7079   Ultramicroscopy
 00000680: 2c20 3139 312c 2070 702e 3536 2d36 352e  , 191, pp.56-65.
-00000690: 0a20 2020 2072 0100 0000 e901 0000 004e  .    r.........N
-000006a0: 290a da03 7066 69da 0563 6163 6865 da06  )...pfi..cache..
-000006b0: 656e 6162 6c65 da05 7261 6e67 65da 036c  enable..range..l
-000006c0: 656e da02 7374 da04 7574 696c 5a0f 6466  en..st..utilZ.df
-000006d0: 7472 6567 6973 7472 6174 696f 6e5a 096e  tregistrationZ.n
-000006e0: 756d 7079 5f66 6674 5a04 6666 7432 2909  umpy_fftZ.fft2).
-000006f0: da0b 696d 6167 655f 7374 6163 6bda 0972  ..image_stack..r
-00000700: 6f77 5f73 7461 636b da09 636f 6c5f 7374  ow_stack..col_st
-00000710: 6163 6b5a 0973 7461 636b 5f70 6f73 da08  ackZ.stack_pos..
-00000720: 7361 6d70 6c69 6e67 da02 7070 da02 6969  sampling..pp..ii
-00000730: 5a02 6a6a da01 5fa9 0072 1200 0000 fa3e  Z.jj.._..r.....>
-00000740: 6275 696c 642f 6264 6973 742e 6d61 636f  build/bdist.maco
-00000750: 7378 2d31 302e 392d 7838 365f 3634 2f65  sx-10.9-x86_64/e
-00000760: 6767 2f73 7465 6d74 6f6f 6c2f 6166 6974  gg/stemtool/afit
-00000770: 2f64 7269 6674 5f63 6f72 722e 7079 da0b  /drift_corr.py..
-00000780: 7368 6966 745f 7374 6163 6b09 0000 0073  shift_stack....s
-00000790: 1200 0000 0027 0a01 1001 0c01 0c01 0601  .....'..........
-000007a0: 1c01 1c01 02fd 7214 0000 0063 0400 0000  ......r....c....
-000007b0: 0000 0000 0000 0000 0700 0000 0a00 0000  ................
-000007c0: 4300 0000 7374 0000 0074 006a 017c 0264  C...st...t.j.|.d
-000007d0: 0164 028d 027d 0474 006a 017c 0364 0164  .d...}.t.j.|.d.d
-000007e0: 028d 027d 0574 0274 037c 0483 0183 0144  ...}.t.t.|.....D
-000007f0: 005d 467d 0674 00a0 0474 056a 06a0 077c  .]F}.t...t.j...|
-00000800: 007c 0664 0364 0385 0264 0364 0385 0266  .|.d.d...d.d...f
-00000810: 0319 007c 057c 0619 007c 047c 0619 00a1  ...|.|...|.|....
-00000820: 03a1 017c 017c 0664 0364 0385 0264 0364  ...|.|.d.d...d.d
-00000830: 0385 0266 033c 0071 2864 0353 0029 0461  ...f.<.q(d.S.).a
-00000840: d404 0000 0a20 2020 2047 6574 2063 6f72  .....    Get cor
-00000850: 7265 6374 6564 2069 6d61 6765 2073 7461  rected image sta
-00000860: 636b 0a0a 2020 2020 5061 7261 6d65 7465  ck..    Paramete
-00000870: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00000880: 2d0a 2020 2020 696d 6167 655f 7374 6163  -.    image_stac
-00000890: 6b3a 206e 6461 7272 6179 0a20 2020 2020  k: ndarray.     
-000008a0: 2020 2020 2020 2020 2020 2020 5374 6163              Stac
-000008b0: 6b20 6f66 2069 6d61 6765 7320 636f 6c6c  k of images coll
-000008c0: 6563 7465 6420 696e 2072 6170 6964 2073  ected in rapid s
-000008d0: 7563 6365 7373 696f 6e2c 0a20 2020 2020  uccession,.     
-000008e0: 2020 2020 2020 2020 2020 2020 7768 6572              wher
-000008f0: 6520 7468 6520 7468 6520 6669 7273 7420  e the the first 
-00000900: 6172 7261 7920 706f 7369 7469 6f6e 2072  array position r
-00000910: 6566 6572 7320 746f 2074 6865 0a20 2020  efers to the.   
-00000920: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00000930: 6167 6520 636f 6c6c 6563 7465 642e 2054  age collected. T
-00000940: 6875 7320 7468 6520 6e74 6820 696d 6167  hus the nth imag
-00000950: 6520 696e 2074 6865 2073 7461 636b 0a20  e in the stack. 
-00000960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000970: 6973 2069 6d61 6765 5f73 7461 636b 5b6e  is image_stack[n
-00000980: 2d31 2c3a 2c3a 5d0a 2020 2020 6d6f 7665  -1,:,:].    move
-00000990: 645f 7374 6163 6b3a 206e 6461 7272 6179  d_stack: ndarray
-000009a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000009b0: 2020 5374 6163 6b20 6f66 206d 6f76 6564    Stack of moved
-000009c0: 2069 6d61 6765 730a 2020 2020 726f 7773   images.    rows
-000009d0: 6869 6674 733a 2020 206e 6461 7272 6179  hifts:   ndarray
-000009e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000009f0: 2020 5468 6520 7369 7a65 2069 7320 6e58    The size is nX
-00000a00: 6e20 7768 6572 6520 6e20 6973 2074 6865  n where n is the
-00000a10: 206e 206f 6620 696d 6167 6573 2069 6e0a   n of images in.
-00000a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a30: 2074 6865 2069 6d61 6765 5f73 7461 636b   the image_stack
-00000a40: 0a20 2020 2063 6f6c 7368 6966 7473 3a20  .    colshifts: 
-00000a50: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-00000a60: 2020 2020 2020 2020 2020 2054 6865 2073             The s
-00000a70: 697a 6520 6973 206e 586e 2077 6865 7265  ize is nXn where
-00000a80: 206e 2069 7320 7468 6520 6e20 6f66 2069   n is the n of i
-00000a90: 6d61 6765 7320 696e 0a20 2020 2020 2020  mages in.       
-00000aa0: 2020 2020 2020 2020 2020 7468 6520 696d            the im
-00000ab0: 6167 655f 7374 6163 6b0a 0a20 2020 204e  age_stack..    N
-00000ac0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-00000ad0: 2020 2054 6865 206d 6561 6e20 6f66 2074     The mean of t
-00000ae0: 6865 2073 6869 6674 2073 7461 636b 7320  he shift stacks 
-00000af0: 666f 7220 6576 6572 7920 696d 6167 6520  for every image 
-00000b00: 706f 7369 7469 6f6e 2061 7265 2074 6865  position are the
-00000b10: 0a20 2020 2061 6d6f 756e 7420 6279 2077  .    amount by w
-00000b20: 6869 6368 2065 6163 6820 696d 6167 6520  hich each image 
-00000b30: 6973 2074 6f20 6265 2073 6869 6674 6564  is to be shifted
-00000b40: 2e20 5765 2063 616c 6375 6c61 7465 2074  . We calculate t
-00000b50: 6865 0a20 2020 206d 6561 6e20 616e 6420  he.    mean and 
-00000b60: 6d6f 7665 2065 6163 6820 696d 6167 6520  move each image 
-00000b70: 6279 2074 6861 7420 616d 6f75 6e74 2069  by that amount i
-00000b80: 6e20 7468 6520 7374 6163 6b20 616e 6420  n the stack and 
-00000b90: 7468 656e 0a20 2020 2073 756d 2074 6865  then.    sum the
-00000ba0: 6d20 7570 2e0a 0a20 2020 2053 6565 2041  m up...    See A
-00000bb0: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
-00000bc0: 0a20 2020 2075 7469 6c2e 6d6f 7665 5f62  .    util.move_b
-00000bd0: 795f 7068 6173 650a 0a20 2020 2052 6566  y_phase..    Ref
-00000be0: 6572 656e 6365 730a 2020 2020 2d2d 2d2d  erences.    ----
-00000bf0: 2d2d 2d2d 2d2d 0a20 2020 202e 2e20 5b32  ------.    .. [2
-00000c00: 5d20 5361 7669 747a 6b79 2c20 422e 482e  ] Savitzky, B.H.
-00000c10: 2c20 456c 2042 6167 6761 7269 2c20 492e  , El Baggari, I.
-00000c20: 2c20 436c 656d 656e 742c 2043 2e42 2e2c  , Clement, C.B.,
-00000c30: 2057 6169 7465 2c20 452e 2c20 476f 6f64   Waite, E., Good
-00000c40: 6765 2c20 422e 482e 2c0a 2020 2020 2020  ge, B.H.,.      
-00000c50: 2042 6165 6b2c 2044 2e4a 2e2c 2053 6865   Baek, D.J., She
-00000c60: 636b 656c 746f 6e2c 204a 2e50 2e2c 2050  ckelton, J.P., P
-00000c70: 6173 636f 2c20 432e 2c20 4e61 6972 2c20  asco, C., Nair, 
-00000c80: 482e 2c20 5363 6872 6569 6265 722c 204e  H., Schreiber, N
-00000c90: 2e4a 2e20 616e 640a 2020 2020 2020 2048  .J. and.       H
-00000ca0: 6f66 666d 616e 2c20 4a2e 2c20 3230 3138  offman, J., 2018
-00000cb0: 2e20 496d 6167 6520 7265 6769 7374 7261  . Image registra
-00000cc0: 7469 6f6e 206f 6620 6c6f 7720 7369 676e  tion of low sign
-00000cd0: 616c 2d74 6f2d 6e6f 6973 6520 6372 796f  al-to-noise cryo
-00000ce0: 2d53 5445 4d20 6461 7461 2e0a 2020 2020  -STEM data..    
-00000cf0: 2020 2055 6c74 7261 6d69 6372 6f73 636f     Ultramicrosco
-00000d00: 7079 2c20 3139 312c 2070 702e 3536 2d36  py, 191, pp.56-6
-00000d10: 352e 0a0a 2020 2020 7201 0000 00a9 01da  5...    r.......
-00000d20: 0461 7869 734e 2908 da02 6e70 5a06 6d65  .axisN)...npZ.me
-00000d30: 6469 616e 7207 0000 0072 0800 0000 da03  dianr....r......
-00000d40: 6162 7372 0900 0000 720a 0000 005a 0d6d  absr....r....Z.m
-00000d50: 6f76 655f 6279 5f70 6861 7365 2907 720b  ove_by_phase).r.
-00000d60: 0000 00da 0b6d 6f76 6564 5f73 7461 636b  .....moved_stack
-00000d70: 5a09 726f 7773 6869 6674 735a 0963 6f6c  Z.rowshiftsZ.col
-00000d80: 7368 6966 7473 5a08 726f 775f 6d65 616e  shiftsZ.row_mean
-00000d90: 5a08 636f 6c5f 6d65 616e 7210 0000 0072  Z.col_meanr....r
-00000da0: 1200 0000 7212 0000 0072 1300 0000 da0a  ....r....r......
-00000db0: 7374 6163 6b5f 636f 7272 3b00 0000 730c  stack_corr;...s.
-00000dc0: 0000 0000 270e 010e 0110 0104 0128 ff72  ....'........(.r
-00000dd0: 1a00 0000 6300 0000 0000 0000 0000 0000  ....c...........
-00000de0: 0000 0000 0003 0000 0040 0000 0073 3400  .........@...s4.
-00000df0: 0000 6500 5a01 6400 5a02 6401 5a03 640d  ..e.Z.d.Z.d.Z.d.
-00000e00: 6403 6404 8401 5a04 6405 6406 8400 5a05  d.d...Z.d.d...Z.
-00000e10: 6407 6408 8400 5a06 640e 640a 640b 8401  d.d...Z.d.d.d...
-00000e20: 5a07 640c 5300 290f da11 6d75 6c74 695f  Z.d.S.)...multi_
-00000e30: 696d 6167 655f 6472 6966 7461 f703 0000  image_drifta....
-00000e40: 0a20 2020 2043 6f72 7265 6374 2066 6f72  .    Correct for
-00000e50: 2073 6361 6e20 6472 6966 7420 7468 726f   scan drift thro
-00000e60: 7567 6820 6372 6f73 732d 636f 7272 656c  ugh cross-correl
-00000e70: 6174 696e 6720 610a 2020 2020 7261 7069  ating a.    rapi
-00000e80: 646c 7920 6163 7175 6972 6564 2069 6d61  dly acquired ima
-00000e90: 6765 2073 7461 636b 0a0a 2020 2020 5061  ge stack..    Pa
-00000ea0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00000eb0: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
-00000ec0: 655f 7374 6163 6b3a 206e 6461 7272 6179  e_stack: ndarray
-00000ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000ee0: 2020 5374 6163 6b20 6f66 2069 6d61 6765    Stack of image
-00000ef0: 7320 636f 6c6c 6563 7465 6420 696e 2072  s collected in r
-00000f00: 6170 6964 2073 7563 6365 7373 696f 6e2c  apid succession,
-00000f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000f20: 2020 7768 6572 6520 7468 6520 7468 6520    where the the 
-00000f30: 6669 7273 7420 6172 7261 7920 706f 7369  first array posi
-00000f40: 7469 6f6e 2072 6566 6572 7320 746f 2074  tion refers to t
-00000f50: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
-00000f60: 2020 2020 696d 6167 6520 636f 6c6c 6563      image collec
-00000f70: 7465 642e 2054 6875 7320 7468 6520 6e74  ted. Thus the nt
-00000f80: 6820 696d 6167 6520 696e 2074 6865 2073  h image in the s
-00000f90: 7461 636b 0a20 2020 2020 2020 2020 2020  tack.           
-00000fa0: 2020 2020 2020 6973 2069 6d61 6765 5f73        is image_s
-00000fb0: 7461 636b 5b6e 2d31 2c3a 2c3a 5d0a 2020  tack[n-1,:,:].  
-00000fc0: 2020 7361 6d70 6c69 6e67 3a20 2020 2069    sampling:    i
-00000fd0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-00000fe0: 2020 2020 2020 2020 2020 2020 2020 4672                Fr
-00000ff0: 6163 7469 6f6e 206f 6620 7468 6520 7069  action of the pi
-00001000: 7865 6c20 746f 2063 616c 6375 6c61 7465  xel to calculate
-00001010: 2075 7073 616d 706c 6564 0a20 2020 2020   upsampled.     
-00001020: 2020 2020 2020 2020 2020 2020 6372 6f73              cros
-00001030: 732d 636f 7272 656c 6174 696f 6e20 666f  s-correlation fo
-00001040: 722e 2044 6566 6175 6c74 2069 7320 3530  r. Default is 50
-00001050: 300a 0a20 2020 2052 6566 6572 656e 6365  0..    Reference
-00001060: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00001070: 0a20 2020 202e 2e20 5b31 5d20 5361 7669  .    .. [1] Savi
-00001080: 747a 6b79 2c20 422e 482e 2c20 456c 2042  tzky, B.H., El B
-00001090: 6167 6761 7269 2c20 492e 2c20 436c 656d  aggari, I., Clem
-000010a0: 656e 742c 2043 2e42 2e2c 2057 6169 7465  ent, C.B., Waite
-000010b0: 2c20 452e 2c20 476f 6f64 6765 2c20 422e  , E., Goodge, B.
-000010c0: 482e 2c0a 2020 2020 2020 2042 6165 6b2c  H.,.       Baek,
-000010d0: 2044 2e4a 2e2c 2053 6865 636b 656c 746f   D.J., Sheckelto
-000010e0: 6e2c 204a 2e50 2e2c 2050 6173 636f 2c20  n, J.P., Pasco, 
-000010f0: 432e 2c20 4e61 6972 2c20 482e 2c20 5363  C., Nair, H., Sc
-00001100: 6872 6569 6265 722c 204e 2e4a 2e20 616e  hreiber, N.J. an
-00001110: 640a 2020 2020 2020 2048 6f66 666d 616e  d.       Hoffman
-00001120: 2c20 4a2e 2c20 3230 3138 2e20 496d 6167  , J., 2018. Imag
-00001130: 6520 7265 6769 7374 7261 7469 6f6e 206f  e registration o
-00001140: 6620 6c6f 7720 7369 676e 616c 2d74 6f2d  f low signal-to-
-00001150: 6e6f 6973 6520 6372 796f 2d53 5445 4d20  noise cryo-STEM 
-00001160: 6461 7461 2e0a 2020 2020 2020 2055 6c74  data..       Ult
-00001170: 7261 6d69 6372 6f73 636f 7079 2c20 3139  ramicroscopy, 19
-00001180: 312c 2070 702e 3536 2d36 352e 0a0a 2020  1, pp.56-65...  
-00001190: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-000011a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 5275 6e20  -------.    Run 
-000011b0: 7468 6520 6675 6e63 7469 6f6e 2061 733a  the function as:
-000011c0: 0a0a 2020 2020 3e3e 3e20 6363 203d 2064  ..    >>> cc = d
-000011d0: 7269 6674 5f63 6f72 7265 6374 6f72 2869  rift_corrector(i
-000011e0: 6d61 6765 5f73 7461 636b 290a 2020 2020  mage_stack).    
-000011f0: 3e3e 3e20 6363 2e67 6574 5f73 6869 6674  >>> cc.get_shift
-00001200: 5f73 7461 636b 2829 0a20 2020 203e 3e3e  _stack().    >>>
-00001210: 2063 6f72 7265 6374 6564 203d 2063 632e   corrected = cc.
-00001220: 636f 7272 6563 7465 645f 7374 6163 6b28  corrected_stack(
-00001230: 290a 0a20 2020 2072 0200 0000 6303 0000  )..    r....c...
-00001240: 0000 0000 0000 0000 0004 0000 0004 0000  ................
-00001250: 0043 0000 0073 9c00 0000 7c02 6401 6b00  .C...s....|.d.k.
-00001260: 7210 7400 6402 8301 8201 7c01 7c00 5f01  r.t.d.....|.|._.
-00001270: 7c01 6a02 6403 1900 7c00 5f03 7c01 6a02  |.j.d...|._.|.j.
-00001280: 6403 1900 7d03 7c03 7c00 5f04 7c02 7c00  d...}.|.|._.|.|.
-00001290: 5f05 7406 a007 7c03 7c03 6602 a101 7c00  _.t...|.|.f...|.
-000012a0: 5f08 7406 a007 7c03 7c03 6602 a101 7c00  _.t...|.|.f...|.
-000012b0: 5f09 6403 7c00 5f0a 7406 6a07 7c01 6a02  _.d.|._.t.j.|.j.
-000012c0: 6401 1900 7c01 6a02 6404 1900 6602 7c01  d...|.j.d...f.|.
-000012d0: 6a0b 6405 8d02 7c00 5f0c 7406 6a0d 7c01  j.d...|._.t.j.|.
-000012e0: 7c01 6a0b 6405 8d02 7c00 5f0e 6406 7c00  |.j.d...|._.d.|.
-000012f0: 5f0f 6400 5300 2907 4e72 0300 0000 7a2c  _.d.S.).Nr....z,
-00001300: 5361 6d70 6c69 6e67 2066 6163 746f 7220  Sampling factor 
-00001310: 7368 6f75 6c64 2062 6520 6120 706f 7369  should be a posi
-00001320: 7469 7665 2069 6e74 6567 6572 7201 0000  tive integerr...
-00001330: 00e9 0200 0000 a901 da05 6474 7970 6546  ..........dtypeF
-00001340: 2910 da0c 5275 6e74 696d 6545 7272 6f72  )...RuntimeError
-00001350: 720b 0000 00da 0573 6861 7065 5a0b 7374  r......shapeZ.st
-00001360: 6163 6b5f 7368 6170 65da 056e 6f5f 696d  ack_shape..no_im
-00001370: 720e 0000 0072 1700 0000 da05 656d 7074  r....r......empt
-00001380: 7972 0c00 0000 720d 0000 00da 096d 6178  yr....r......max
-00001390: 5f73 6869 6674 721e 0000 00da 0a63 6f72  _shiftr......cor
-000013a0: 725f 696d 6167 655a 0a65 6d70 7479 5f6c  r_imageZ.empty_l
-000013b0: 696b 6572 1900 0000 da0b 7374 6163 6b5f  iker......stack_
-000013c0: 6368 6563 6b29 04da 0473 656c 6672 0b00  check)...selfr..
-000013d0: 0000 720e 0000 0072 2100 0000 7212 0000  ..r....r!...r...
-000013e0: 0072 1200 0000 7213 0000 00da 085f 5f69  .r....r......__i
-000013f0: 6e69 745f 5f8b 0000 0073 1e00 0000 0001  nit__....s......
-00001400: 0801 0801 0601 0c01 0a01 0601 0601 1001  ................
-00001410: 1001 0601 0401 16ff 0803 1201 7a1a 6d75  ............z.mu
-00001420: 6c74 695f 696d 6167 655f 6472 6966 742e  lti_image_drift.
-00001430: 5f5f 696e 6974 5f5f 6301 0000 0000 0000  __init__c.......
-00001440: 0000 0000 0004 0000 0008 0000 0043 0000  .............C..
-00001450: 0073 8e00 0000 7400 6a01 a002 a100 0100  .s....t.j.......
-00001460: 7403 6a04 6401 7c00 6a05 8502 6401 7c00  t.j.d.|.j...d.|.
-00001470: 6a05 8502 6602 1900 5c02 7d01 7d02 7403  j...f...\.}.}.t.
-00001480: a006 7403 a007 7c01 a101 7403 a007 7c02  ..t...|...t...|.
-00001490: a101 6602 a101 a008 a100 7d03 7409 7c00  ..f.......}.t.|.
-000014a0: 6a0a 7c00 6a0b 7c00 6a0c 7c03 7c00 6a0d  j.|.j.|.j.|.|.j.
-000014b0: 8305 0100 7403 a00e 7403 a006 7403 a00e  ....t...t...t...
-000014c0: 7c00 6a0b a101 7403 a00e 7c00 6a0c a101  |.j...t...|.j...
-000014d0: 6602 a101 a101 7c00 5f0f 6402 7c00 5f10  f.....|._.d.|._.
-000014e0: 6403 5300 2904 6147 0100 000a 2020 2020  d.S.).aG....    
-000014f0: 2020 2020 4372 6f73 732d 436f 7272 656c      Cross-Correl
-00001500: 6174 6520 7374 6163 6b20 6f66 2069 6d61  ate stack of ima
-00001510: 6765 730a 0a20 2020 2020 2020 204e 6f74  ges..        Not
-00001520: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00001530: 0a20 2020 2020 2020 2046 6f72 2061 2072  .        For a r
-00001540: 6170 6964 6c79 2063 6f6c 6c65 6374 6564  apidly collected
-00001550: 2069 6d61 6765 2073 7461 636b 2c20 6561   image stack, ea
-00001560: 6368 2069 6d61 6765 2069 6e20 7468 6520  ch image in the 
-00001570: 7374 6163 6b20 6973 0a20 2020 2020 2020  stack is.       
-00001580: 2063 726f 7373 2d63 6f72 7265 6c61 7465   cross-correlate
-00001590: 6420 7769 7468 2061 6c6c 2074 6865 206f  d with all the o
-000015a0: 7468 6572 2069 6d61 6765 7320 6f66 2074  ther images of t
-000015b0: 6865 2073 7461 636b 2c20 746f 2067 656e  he stack, to gen
-000015c0: 6572 6174 650a 2020 2020 2020 2020 6120  erate.        a 
-000015d0: 736b 6577 206d 6174 7269 7820 6f66 2072  skew matrix of r
-000015e0: 6f77 2073 6869 6674 7320 616e 6420 636f  ow shifts and co
-000015f0: 6c75 6d6e 2073 6869 6674 732c 2063 616c  lumn shifts, cal
-00001600: 6375 6c61 7465 6420 7769 7468 2073 7562  culated with sub
-00001610: 0a20 2020 2020 2020 2070 6978 656c 2070  .        pixel p
-00001620: 7265 6369 7369 6f6e 2e0a 2020 2020 2020  recision..      
-00001630: 2020 7201 0000 0054 4e29 1172 0400 0000    r....TN).r....
-00001640: 7205 0000 0072 0600 0000 7217 0000 005a  r....r....r....Z
-00001650: 056d 6772 6964 7221 0000 005a 0761 7361  .mgridr!...Z.asa
-00001660: 7272 6179 5a05 7261 7665 6c5a 0974 7261  rrayZ.ravelZ.tra
-00001670: 6e73 706f 7365 7214 0000 0072 0b00 0000  nsposer....r....
-00001680: 720c 0000 0072 0d00 0000 720e 0000 005a  r....r....r....Z
-00001690: 0461 6d61 7872 2300 0000 7225 0000 0029  .amaxr#...r%...)
-000016a0: 0472 2600 0000 5a04 726f 7773 da04 636f  .r&...Z.rows..co
-000016b0: 6c73 5a09 706f 735f 7374 6163 6b72 1200  lsZ.pos_stackr..
-000016c0: 0000 7212 0000 0072 1300 0000 da0f 6765  ..r....r......ge
-000016d0: 745f 7368 6170 655f 7374 6163 6b9c 0000  t_shape_stack...
-000016e0: 0073 1400 0000 000b 0a01 1e01 1e01 0201  .s..............
-000016f0: 12ff 0404 0401 1cff 0603 7a21 6d75 6c74  ..........z!mult
-00001700: 695f 696d 6167 655f 6472 6966 742e 6765  i_image_drift.ge
-00001710: 745f 7368 6170 655f 7374 6163 6b63 0100  t_shape_stackc..
-00001720: 0000 0000 0000 0000 0000 0100 0000 0500  ................
-00001730: 0000 4300 0000 7342 0000 007c 006a 0073  ..C...sB...|.j.s
-00001740: 0e74 0164 0183 0182 0174 027c 006a 037c  .t.d.....t.|.j.|
-00001750: 006a 047c 006a 057c 006a 0683 0401 0074  .j.|.j.|.j.....t
-00001760: 076a 087c 006a 0464 0264 038d 027c 006a  .j.|.j.d.d...|.j
-00001770: 091b 007c 005f 0a7c 006a 0a53 0029 0461  ...|._.|.j.S.).a
-00001780: a501 0000 0a20 2020 2020 2020 2047 6574  .....        Get
-00001790: 2063 6f72 7265 6374 6564 2069 6d61 6765   corrected image
-000017a0: 2073 7461 636b 0a0a 2020 2020 2020 2020   stack..        
-000017b0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-000017c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000017d0: 636f 7272 5f73 7461 636b 3a20 6e64 6172  corr_stack: ndar
-000017e0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-000017f0: 2020 2020 2020 2020 436f 7272 6563 7465          Correcte
-00001800: 6420 696d 6167 6520 6672 6f6d 2074 6865  d image from the
-00001810: 2069 6d61 6765 2073 7461 636b 0a0a 2020   image stack..  
-00001820: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
-00001830: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
-00001840: 2020 5468 6520 6d65 616e 206f 6620 7468    The mean of th
-00001850: 6520 7368 6966 7420 7374 6163 6b73 2066  e shift stacks f
-00001860: 6f72 2065 7665 7279 2069 6d61 6765 2070  or every image p
-00001870: 6f73 6974 696f 6e20 6172 6520 7468 650a  osition are the.
-00001880: 2020 2020 2020 2020 616d 6f75 6e74 2062          amount b
-00001890: 7920 7768 6963 6820 6561 6368 2069 6d61  y which each ima
-000018a0: 6765 2069 7320 746f 2062 6520 7368 6966  ge is to be shif
-000018b0: 7465 642e 2057 6520 6361 6c63 756c 6174  ted. We calculat
-000018c0: 6520 7468 650a 2020 2020 2020 2020 6d65  e the.        me
-000018d0: 616e 2061 6e64 206d 6f76 6520 6561 6368  an and move each
-000018e0: 2069 6d61 6765 2062 7920 7468 6174 2061   image by that a
-000018f0: 6d6f 756e 7420 696e 2074 6865 2073 7461  mount in the sta
-00001900: 636b 2061 6e64 2074 6865 6e0a 2020 2020  ck and then.    
-00001910: 2020 2020 7375 6d20 7468 656d 2075 702e      sum them up.
-00001920: 0a20 2020 2020 2020 20fa 3b50 6c65 6173  .        .;Pleas
-00001930: 6520 6765 7420 7468 6520 696d 6167 6573  e get the images
-00001940: 2063 6f72 7265 6c61 7465 6420 6669 7273   correlated firs
-00001950: 7420 6173 2067 6574 5f73 6861 7065 5f73  t as get_shape_s
-00001960: 7461 636b 2829 7201 0000 0072 1500 0000  tack()r....r....
-00001970: 290b 7225 0000 0072 1f00 0000 721a 0000  ).r%...r....r...
-00001980: 0072 0b00 0000 7219 0000 0072 0c00 0000  .r....r....r....
-00001990: 720d 0000 0072 1700 0000 da03 7375 6d72  r....r......sumr
-000019a0: 2100 0000 7224 0000 0029 0172 2600 0000  !...r$...).r&...
-000019b0: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
-000019c0: 0f63 6f72 7265 6374 6564 5f73 7461 636b  .corrected_stack
-000019d0: b300 0000 7312 0000 0000 1006 0102 0102  ....s...........
-000019e0: ff04 0302 0110 ff04 0318 017a 216d 756c  ...........z!mul
-000019f0: 7469 5f69 6d61 6765 5f64 7269 6674 2e63  ti_image_drift.c
-00001a00: 6f72 7265 6374 6564 5f73 7461 636b e90f  orrected_stack..
-00001a10: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
-00001a20: 1000 0000 0900 0000 4300 0000 73c4 0200  ........C...s...
-00001a30: 007c 006a 0073 0e74 0164 0183 0182 0174  .|.j.s.t.d.....t
-00001a40: 027c 0183 017d 0264 027c 0264 039c 027d  .|...}.d.|.d...}
-00001a50: 0374 027c 0183 0174 027c 0164 0414 0083  .t.|...t.|.d....
-00001a60: 0166 027d 0474 036a 047c 0464 058d 0101  .f.}.t.j.|.d....
-00001a70: 007c 006a 057d 0574 06a0 0764 0664 07a1  .|.j.}.t...d.d..
-00001a80: 027d 0674 03a0 087c 0664 0864 0985 0264  .}.t...|.d.d...d
-00001a90: 0864 0a85 0266 0219 00a1 017d 0774 03a0  .d...f.....}.t..
-00001aa0: 087c 0664 0864 0985 0264 0b64 0785 0266  .|.d.d...d.d...f
-00001ab0: 0219 00a1 017d 0874 03a0 087c 0664 0964  .....}.t...|.d.d
-00001ac0: 0685 0264 0c64 0c85 0266 0219 00a1 017d  ...d.d...f.....}
-00001ad0: 097c 076a 097c 006a 0a7c 050b 007c 0564  .|.j.|.j.|...|.d
-00001ae0: 0d64 0e8d 0401 007c 076a 0b64 2769 007c  .d.....|.j.d'i.|
-00001af0: 03a4 018e 0101 007c 076a 0c64 2869 007c  .......|.j.d(i.|
-00001b00: 03a4 018e 0101 007c 076a 0d6a 0e64 107c  .......|.j.j.d.|
-00001b10: 0114 0064 117c 0114 0064 1264 0964 138d  ...d.|...d.d.d..
-00001b20: 0401 007c 076a 0f6a 0e64 107c 0114 0064  ...|.j.j.d.|...d
-00001b30: 117c 0114 0064 1264 0964 138d 0401 0074  .|...d.d.d.....t
-00001b40: 106a 1164 1474 127c 0264 158d 0164 1664  .j.d.t.|.d...d.d
-00001b50: 1764 188d 047d 0a7c 0a6a 13a0 1464 19a1  .d...}.|.j...d..
-00001b60: 0101 007c 07a0 157c 0aa1 0101 007c 086a  ...|...|.....|.j
-00001b70: 097c 006a 167c 050b 007c 0564 0d64 0e8d  .|.j.|...|.d.d..
-00001b80: 0401 007c 086a 0b64 2969 007c 03a4 018e  ...|.j.d)i.|....
-00001b90: 0101 007c 086a 0c64 2a69 007c 03a4 018e  ...|.j.d*i.|....
-00001ba0: 0101 007c 086a 0d6a 0e64 107c 0114 0064  ...|.j.j.d.|...d
-00001bb0: 117c 0114 0064 1264 0964 138d 0401 007c  .|...d.d.d.....|
-00001bc0: 086a 0f6a 0e64 107c 0114 0064 117c 0114  .j.j.d.|...d.|..
-00001bd0: 0064 1264 0964 138d 0401 0074 106a 1164  .d.d.d.....t.j.d
-00001be0: 1a74 127c 0264 158d 0164 1664 1764 188d  .t.|.d...d.d.d..
-00001bf0: 047d 0a7c 0a6a 13a0 1464 19a1 0101 007c  .}.|.j...d.....|
-00001c00: 08a0 157c 0aa1 0101 0074 176a 1864 1b74  ...|.....t.j.d.t
-00001c10: 176a 1964 1c8d 027d 0b74 1a64 0983 0144  .j.d...}.t.d...D
-00001c20: 005d 227d 0c74 17a0 1b7c 050b 007c 0564  .]"}.t...|...|.d
-00001c30: 1da1 037c 0b7c 0c64 0c64 0c85 0266 023c  ...|.|.d.d...f.<
-00001c40: 0090 0171 f07c 096a 097c 0b64 0d64 1e8d  ...q.|.j.|.d.d..
-00001c50: 0201 007c 096a 0fa0 1c64 1fa1 0101 0064  ...|.j...d.....d
-00001c60: 0a7d 0d74 17a0 1b64 0864 1d7c 0da1 037d  .}.t...d.d.|...}
-00001c70: 0e7c 09a0 1d7c 0ea1 0101 007c 09a0 1e74  .|...|.....|...t
-00001c80: 17a0 1f74 17a0 1b7c 050b 007c 057c 0da1  ...t...|...|.|..
-00001c90: 0364 20a1 02a1 0101 0064 2144 005d 267d  .d ......d!D.]&}
-00001ca0: 0f7c 096a 207c 0f19 00a0 2164 22a1 0101  .|.j |....!d"...
-00001cb0: 007c 096a 207c 0f19 00a0 2264 23a1 0101  .|.j |...."d#...
-00001cc0: 0090 0271 6c7c 096a 0d6a 0e64 2264 2464  ...ql|.j.j.d"d$d
-00001cd0: 2564 0964 138d 0401 007c 096a 2364 2b69  %d.d.....|.j#d+i
-00001ce0: 007c 03a4 018e 0101 0074 03a0 24a1 0001  .|.......t..$...
-00001cf0: 0064 0c53 0029 2c7a 600a 2020 2020 2020  .d.S.),z`.      
-00001d00: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
-00001d10: 2d2d 2d2d 2d0a 2020 2020 2020 2020 506c  -----.        Pl
-00001d20: 6f74 2074 6865 2072 656c 6174 6976 6520  ot the relative 
-00001d30: 7368 6966 7473 206f 6620 696d 6167 6573  shifts of images
-00001d40: 2077 6974 6820 6561 6368 206f 7468 6572   with each other
-00001d50: 0a20 2020 2020 2020 2072 2a00 0000 5a04  .        r*...Z.
-00001d60: 626f 6c64 2902 da06 7765 6967 6874 da04  bold)...weight..
-00001d70: 7369 7a65 6733 3333 3333 33e3 3f29 015a  sizeg333333.?).Z
-00001d80: 0766 6967 7369 7a65 e90c 0000 00e9 1400  .figsize........
-00001d90: 0000 7201 0000 00e9 0a00 0000 e909 0000  ..r.............
-00001da0: 00e9 0b00 0000 4e5a 0652 6442 755f 7229  ......NZ.RdBu_r)
-00001db0: 035a 0476 6d69 6e5a 0476 6d61 78da 0463  .Z.vminZ.vmax..c
-00001dc0: 6d61 70fa 0c53 7461 636b 204e 756d 6265  map..Stack Numbe
-00001dd0: 7267 9a99 9999 9999 b93f 679a 9999 9999  rg.......?g.....
-00001de0: 99d9 3fda 0269 6e29 04da 0577 6964 7468  ..?..in)...width
-00001df0: da06 6c65 6e67 7468 da09 6469 7265 6374  ..length..direct
-00001e00: 696f 6eda 0370 6164 7a17 5368 6966 7420  ion..padz.Shift 
-00001e10: 616c 6f6e 6720 5820 6469 7265 6374 696f  along X directio
-00001e20: 6e29 0172 2f00 0000 547a 0a75 7070 6572  n).r/...Tz.upper
-00001e30: 206c 6566 7429 03da 0470 726f 705a 0766   left)...propZ.f
-00001e40: 7261 6d65 6f6e da03 6c6f 637a 2272 6f75  rameon..locz"rou
-00001e50: 6e64 2c20 7061 643d 2030 2e2c 2072 6f75  nd, pad= 0., rou
-00001e60: 6e64 696e 675f 7369 7a65 3d20 302e 327a  nding_size= 0.2z
-00001e70: 1753 6869 6674 2061 6c6f 6e67 2059 2064  .Shift along Y d
-00001e80: 6972 6563 7469 6f6e 2902 7232 0000 00e9  irection).r2....
-00001e90: e803 0000 721d 0000 0072 3e00 0000 2901  ....r....r>...).
-00001ea0: 7235 0000 0046 e904 0000 0029 04da 0374  r5...F.....)...t
-00001eb0: 6f70 5a06 626f 7474 6f6d da04 6c65 6674  opZ.bottom..left
-00001ec0: da05 7269 6768 7472 1c00 0000 5a05 626c  ..rightr....Z.bl
-00001ed0: 6163 6be9 0600 0000 da03 6f75 74fa 1752  ack.......out..R
-00001ee0: 656c 6174 6976 6520 5368 6966 7420 2870  elative Shift (p
-00001ef0: 6978 656c 7329 2901 7236 0000 0029 0172  ixels)).r6...).r
-00001f00: 3600 0000 2901 7236 0000 0029 0172 3600  6...).r6...).r6.
-00001f10: 0000 2901 7245 0000 0029 2572 2500 0000  ..).rE...)%r%...
-00001f20: 721f 0000 00da 0369 6e74 da03 706c 745a  r......int..pltZ
-00001f30: 0666 6967 7572 6572 2300 0000 da04 6d70  .figurer#.....mp
-00001f40: 6773 5a08 4772 6964 5370 6563 5a07 7375  gsZ.GridSpecZ.su
-00001f50: 6270 6c6f 745a 0669 6d73 686f 7772 0c00  bplotZ.imshowr..
-00001f60: 0000 5a0a 7365 745f 786c 6162 656c 5a0a  ..Z.set_xlabelZ.
-00001f70: 7365 745f 796c 6162 656c 5a05 7861 7869  set_ylabelZ.xaxi
-00001f80: 735a 0f73 6574 5f74 6963 6b5f 7061 7261  sZ.set_tick_para
-00001f90: 6d73 5a05 7961 7869 73da 066d 706c 6f66  msZ.yaxis..mplof
-00001fa0: 665a 0c41 6e63 686f 7265 6454 6578 74da  fZ.AnchoredText.
-00001fb0: 0464 6963 745a 0570 6174 6368 5a0c 7365  .dictZ.patchZ.se
-00001fc0: 745f 626f 7873 7479 6c65 5a0a 6164 645f  t_boxstyleZ.add_
-00001fd0: 6172 7469 7374 720d 0000 0072 1700 0000  artistr....r....
-00001fe0: 5a05 7a65 726f 73da 0566 6c6f 6174 7207  Z.zeros..floatr.
-00001ff0: 0000 005a 086c 696e 7370 6163 655a 0b73  ...Z.linspaceZ.s
-00002000: 6574 5f76 6973 6962 6c65 5a0a 7365 745f  et_visibleZ.set_
-00002010: 7874 6963 6b73 5a0f 7365 745f 7874 6963  xticksZ.set_xtic
-00002020: 6b6c 6162 656c 73da 0572 6f75 6e64 5a06  klabels..roundZ.
-00002030: 7370 696e 6573 5a0d 7365 745f 6c69 6e65  spinesZ.set_line
-00002040: 7769 6474 685a 0973 6574 5f63 6f6c 6f72  widthZ.set_color
-00002050: 5a09 7365 745f 7469 746c 655a 0961 7574  Z.set_titleZ.aut
-00002060: 6f73 6361 6c65 2910 7226 0000 005a 0769  oscale).r&...Z.i
-00002070: 6d77 6964 7468 5a08 666f 6e74 7369 7a65  mwidthZ.fontsize
-00002080: 5a07 7363 5f66 6f6e 745a 0669 6d73 697a  Z.sc_fontZ.imsiz
-00002090: 655a 0276 6d5a 0267 735a 0361 7831 5a03  eZ.vmZ.gsZ.ax1Z.
-000020a0: 6178 325a 0361 7833 da02 6174 5a02 7362  ax2Z.ax3..atZ.sb
-000020b0: 7210 0000 005a 096e 6f5f 6c61 6265 6c73  r....Z.no_labels
-000020c0: da02 7831 7216 0000 0072 1200 0000 7212  ..x1r....r....r.
-000020d0: 0000 0072 1300 0000 da0b 706c 6f74 5f73  ...r......plot_s
-000020e0: 6869 6674 73cd 0000 0073 7c00 0000 0006  hifts....s|.....
-000020f0: 0601 0201 02ff 0403 0801 0a01 1401 0c01  ................
-00002100: 0602 0c01 1a01 1a01 1a02 1601 1001 1001  ................
-00002110: 0601 10ff 0603 0601 10ff 0603 0401 0201  ................
-00002120: 0801 0201 02fc 0606 0c01 0a02 1601 1001  ................
-00002130: 1001 0601 10ff 0603 0601 10ff 0603 0401  ................
-00002140: 0201 0801 0201 02fc 0606 0c01 0a02 1001  ................
-00002150: 0c01 2001 0e01 0c01 0401 0e01 0a01 1e01  .. .............
-00002160: 0801 1001 1401 1401 1002 7a1d 6d75 6c74  ..........z.mult
-00002170: 695f 696d 6167 655f 6472 6966 742e 706c  i_image_drift.pl
-00002180: 6f74 5f73 6869 6674 734e 2901 7202 0000  ot_shiftsN).r...
-00002190: 0029 0172 2d00 0000 2908 da08 5f5f 6e61  .).r-...)...__na
-000021a0: 6d65 5f5f da0a 5f5f 6d6f 6475 6c65 5f5f  me__..__module__
-000021b0: da0c 5f5f 7175 616c 6e61 6d65 5f5f da07  ..__qualname__..
-000021c0: 5f5f 646f 635f 5f72 2700 0000 7229 0000  __doc__r'...r)..
-000021d0: 0072 2c00 0000 724f 0000 0072 1200 0000  .r,...rO...r....
-000021e0: 7212 0000 0072 1200 0000 7213 0000 0072  r....r....r....r
-000021f0: 1b00 0000 6a00 0000 730a 0000 0008 0104  ....j...s.......
-00002200: 200a 1108 1708 1a72 1b00 0000 2901 7202   ......r....).r.
-00002210: 0000 0029 145a 146d 6174 706c 6f74 6c69  ...).Z.matplotli
-00002220: 622e 6f66 6673 6574 626f 785a 096f 6666  b.offsetboxZ.off
-00002230: 7365 7462 6f78 7249 0000 005a 056e 756d  setboxrI...Z.num
-00002240: 7079 7217 0000 005a 1170 7966 6674 772e  pyr....Z.pyfftw.
-00002250: 696e 7465 7266 6163 6573 5a0a 696e 7465  interfacesZ.inte
-00002260: 7266 6163 6573 7204 0000 00da 0873 7465  rfacesr......ste
-00002270: 6d74 6f6f 6c72 0900 0000 5a11 6d61 7470  mtoolr....Z.matp
-00002280: 6c6f 746c 6962 2e70 7970 6c6f 745a 0670  lotlib.pyplotZ.p
-00002290: 7970 6c6f 7472 4700 0000 5a13 6d61 7470  yplotrG...Z.matp
-000022a0: 6c6f 746c 6962 2e67 7269 6473 7065 635a  lotlib.gridspecZ
-000022b0: 0867 7269 6473 7065 6372 4800 0000 7214  .gridspecrH...r.
-000022c0: 0000 0072 1a00 0000 da06 6f62 6a65 6374  ...r......object
-000022d0: 721b 0000 0072 1200 0000 7212 0000 0072  r....r....r....r
-000022e0: 1200 0000 7213 0000 00da 083c 6d6f 6475  ....r......<modu
-000022f0: 6c65 3e01 0000 0073 1000 0000 0c01 0801  le>....s........
-00002300: 0c01 0801 0c01 0c03 0a32 082f            .........2./
+00000690: 0a0a 2020 2020 7201 0000 00e9 0100 0000  ..    r.........
+000006a0: 4e29 0ada 0370 6669 da05 6361 6368 65da  N)...pfi..cache.
+000006b0: 0665 6e61 626c 65da 0572 616e 6765 da03  .enable..range..
+000006c0: 6c65 6eda 0273 74da 0475 7469 6c5a 0f64  len..st..utilZ.d
+000006d0: 6674 7265 6769 7374 7261 7469 6f6e 5a09  ftregistrationZ.
+000006e0: 6e75 6d70 795f 6666 745a 0466 6674 3229  numpy_fftZ.fft2)
+000006f0: 09da 0b69 6d61 6765 5f73 7461 636b da09  ...image_stack..
+00000700: 726f 775f 7374 6163 6bda 0963 6f6c 5f73  row_stack..col_s
+00000710: 7461 636b 5a09 7374 6163 6b5f 706f 73da  tackZ.stack_pos.
+00000720: 0873 616d 706c 696e 67da 0270 70da 0269  .sampling..pp..i
+00000730: 695a 026a 6ada 015f a900 7212 0000 00fa  iZ.jj.._..r.....
+00000740: 3862 7569 6c64 2f62 6469 7374 2e6c 696e  8build/bdist.lin
+00000750: 7578 2d78 3836 5f36 342f 6567 672f 7374  ux-x86_64/egg/st
+00000760: 656d 746f 6f6c 2f61 6669 742f 6472 6966  emtool/afit/drif
+00000770: 745f 636f 7272 2e70 79da 0b73 6869 6674  t_corr.py..shift
+00000780: 5f73 7461 636b 0900 0000 7314 0000 000a  _stack....s.....
+00000790: 2810 010c 010c 0106 011c 011c 0102 0120  (.............. 
+000007a0: fd04 fd72 1400 0000 6304 0000 0000 0000  ...r....c.......
+000007b0: 0000 0000 0007 0000 000a 0000 0043 0000  .............C..
+000007c0: 0073 7400 0000 7400 6a01 7c02 6401 6402  .st...t.j.|.d.d.
+000007d0: 8d02 7d04 7400 6a01 7c03 6401 6402 8d02  ..}.t.j.|.d.d...
+000007e0: 7d05 7402 7403 7c04 8301 8301 4400 5d23  }.t.t.|.....D.]#
+000007f0: 7d06 7400 a004 7405 6a06 a007 7c00 7c06  }.t...t.j...|.|.
+00000800: 6403 6403 8502 6403 6403 8502 6603 1900  d.d...d.d...f...
+00000810: 7c05 7c06 1900 7c04 7c06 1900 a103 a101  |.|...|.|.......
+00000820: 7c01 7c06 6403 6403 8502 6403 6403 8502  |.|.d.d...d.d...
+00000830: 6603 3c00 7114 6403 5300 2904 61d4 0400  f.<.q.d.S.).a...
+00000840: 000a 2020 2020 4765 7420 636f 7272 6563  ..    Get correc
+00000850: 7465 6420 696d 6167 6520 7374 6163 6b0a  ted image stack.
+00000860: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00000870: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00000880: 2020 2069 6d61 6765 5f73 7461 636b 3a20     image_stack: 
+00000890: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+000008a0: 2020 2020 2020 2020 2053 7461 636b 206f           Stack o
+000008b0: 6620 696d 6167 6573 2063 6f6c 6c65 6374  f images collect
+000008c0: 6564 2069 6e20 7261 7069 6420 7375 6363  ed in rapid succ
+000008d0: 6573 7369 6f6e 2c0a 2020 2020 2020 2020  ession,.        
+000008e0: 2020 2020 2020 2020 2077 6865 7265 2074           where t
+000008f0: 6865 2074 6865 2066 6972 7374 2061 7272  he the first arr
+00000900: 6179 2070 6f73 6974 696f 6e20 7265 6665  ay position refe
+00000910: 7273 2074 6f20 7468 650a 2020 2020 2020  rs to the.      
+00000920: 2020 2020 2020 2020 2020 2069 6d61 6765             image
+00000930: 2063 6f6c 6c65 6374 6564 2e20 5468 7573   collected. Thus
+00000940: 2074 6865 206e 7468 2069 6d61 6765 2069   the nth image i
+00000950: 6e20 7468 6520 7374 6163 6b0a 2020 2020  n the stack.    
+00000960: 2020 2020 2020 2020 2020 2020 2069 7320               is 
+00000970: 696d 6167 655f 7374 6163 6b5b 6e2d 312c  image_stack[n-1,
+00000980: 3a2c 3a5d 0a20 2020 206d 6f76 6564 5f73  :,:].    moved_s
+00000990: 7461 636b 3a20 6e64 6172 7261 790a 2020  tack: ndarray.  
+000009a0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+000009b0: 7461 636b 206f 6620 6d6f 7665 6420 696d  tack of moved im
+000009c0: 6167 6573 0a20 2020 2072 6f77 7368 6966  ages.    rowshif
+000009d0: 7473 3a20 2020 6e64 6172 7261 790a 2020  ts:   ndarray.  
+000009e0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000009f0: 6865 2073 697a 6520 6973 206e 586e 2077  he size is nXn w
+00000a00: 6865 7265 206e 2069 7320 7468 6520 6e20  here n is the n 
+00000a10: 6f66 2069 6d61 6765 7320 696e 0a20 2020  of images in.   
+00000a20: 2020 2020 2020 2020 2020 2020 2020 7468                th
+00000a30: 6520 696d 6167 655f 7374 6163 6b0a 2020  e image_stack.  
+00000a40: 2020 636f 6c73 6869 6674 733a 2020 206e    colshifts:   n
+00000a50: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00000a60: 2020 2020 2020 2020 5468 6520 7369 7a65          The size
+00000a70: 2069 7320 6e58 6e20 7768 6572 6520 6e20   is nXn where n 
+00000a80: 6973 2074 6865 206e 206f 6620 696d 6167  is the n of imag
+00000a90: 6573 2069 6e0a 2020 2020 2020 2020 2020  es in.          
+00000aa0: 2020 2020 2020 2074 6865 2069 6d61 6765         the image
+00000ab0: 5f73 7461 636b 0a0a 2020 2020 4e6f 7465  _stack..    Note
+00000ac0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+00000ad0: 5468 6520 6d65 616e 206f 6620 7468 6520  The mean of the 
+00000ae0: 7368 6966 7420 7374 6163 6b73 2066 6f72  shift stacks for
+00000af0: 2065 7665 7279 2069 6d61 6765 2070 6f73   every image pos
+00000b00: 6974 696f 6e20 6172 6520 7468 650a 2020  ition are the.  
+00000b10: 2020 616d 6f75 6e74 2062 7920 7768 6963    amount by whic
+00000b20: 6820 6561 6368 2069 6d61 6765 2069 7320  h each image is 
+00000b30: 746f 2062 6520 7368 6966 7465 642e 2057  to be shifted. W
+00000b40: 6520 6361 6c63 756c 6174 6520 7468 650a  e calculate the.
+00000b50: 2020 2020 6d65 616e 2061 6e64 206d 6f76      mean and mov
+00000b60: 6520 6561 6368 2069 6d61 6765 2062 7920  e each image by 
+00000b70: 7468 6174 2061 6d6f 756e 7420 696e 2074  that amount in t
+00000b80: 6865 2073 7461 636b 2061 6e64 2074 6865  he stack and the
+00000b90: 6e0a 2020 2020 7375 6d20 7468 656d 2075  n.    sum them u
+00000ba0: 702e 0a0a 2020 2020 5365 6520 416c 736f  p...    See Also
+00000bb0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+00000bc0: 2020 7574 696c 2e6d 6f76 655f 6279 5f70    util.move_by_p
+00000bd0: 6861 7365 0a0a 2020 2020 5265 6665 7265  hase..    Refere
+00000be0: 6e63 6573 0a20 2020 202d 2d2d 2d2d 2d2d  nces.    -------
+00000bf0: 2d2d 2d0a 2020 2020 2e2e 205b 325d 2053  ---.    .. [2] S
+00000c00: 6176 6974 7a6b 792c 2042 2e48 2e2c 2045  avitzky, B.H., E
+00000c10: 6c20 4261 6767 6172 692c 2049 2e2c 2043  l Baggari, I., C
+00000c20: 6c65 6d65 6e74 2c20 432e 422e 2c20 5761  lement, C.B., Wa
+00000c30: 6974 652c 2045 2e2c 2047 6f6f 6467 652c  ite, E., Goodge,
+00000c40: 2042 2e48 2e2c 0a20 2020 2020 2020 4261   B.H.,.       Ba
+00000c50: 656b 2c20 442e 4a2e 2c20 5368 6563 6b65  ek, D.J., Shecke
+00000c60: 6c74 6f6e 2c20 4a2e 502e 2c20 5061 7363  lton, J.P., Pasc
+00000c70: 6f2c 2043 2e2c 204e 6169 722c 2048 2e2c  o, C., Nair, H.,
+00000c80: 2053 6368 7265 6962 6572 2c20 4e2e 4a2e   Schreiber, N.J.
+00000c90: 2061 6e64 0a20 2020 2020 2020 486f 6666   and.       Hoff
+00000ca0: 6d61 6e2c 204a 2e2c 2032 3031 382e 2049  man, J., 2018. I
+00000cb0: 6d61 6765 2072 6567 6973 7472 6174 696f  mage registratio
+00000cc0: 6e20 6f66 206c 6f77 2073 6967 6e61 6c2d  n of low signal-
+00000cd0: 746f 2d6e 6f69 7365 2063 7279 6f2d 5354  to-noise cryo-ST
+00000ce0: 454d 2064 6174 612e 0a20 2020 2020 2020  EM data..       
+00000cf0: 556c 7472 616d 6963 726f 7363 6f70 792c  Ultramicroscopy,
+00000d00: 2031 3931 2c20 7070 2e35 362d 3635 2e0a   191, pp.56-65..
+00000d10: 0a20 2020 2072 0100 0000 a901 da04 6178  .    r........ax
+00000d20: 6973 4e29 08da 026e 705a 066d 6564 6961  isN)...npZ.media
+00000d30: 6e72 0700 0000 7208 0000 00da 0361 6273  nr....r......abs
+00000d40: 7209 0000 0072 0a00 0000 5a0d 6d6f 7665  r....r....Z.move
+00000d50: 5f62 795f 7068 6173 6529 0772 0b00 0000  _by_phase).r....
+00000d60: da0b 6d6f 7665 645f 7374 6163 6b5a 0972  ..moved_stackZ.r
+00000d70: 6f77 7368 6966 7473 5a09 636f 6c73 6869  owshiftsZ.colshi
+00000d80: 6674 735a 0872 6f77 5f6d 6561 6e5a 0863  ftsZ.row_meanZ.c
+00000d90: 6f6c 5f6d 6561 6e72 1000 0000 7212 0000  ol_meanr....r...
+00000da0: 0072 1200 0000 7213 0000 00da 0a73 7461  .r....r......sta
+00000db0: 636b 5f63 6f72 723c 0000 0073 0e00 0000  ck_corr<...s....
+00000dc0: 0e27 0e01 1001 0401 2801 18ff 04ff 721a  .'......(.....r.
+00000dd0: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
+00000de0: 0000 0000 0300 0000 4000 0000 7334 0000  ........@...s4..
+00000df0: 0065 005a 0164 005a 0264 015a 0364 0d64  .e.Z.d.Z.d.Z.d.d
+00000e00: 0364 0484 015a 0464 0564 0684 005a 0564  .d...Z.d.d...Z.d
+00000e10: 0764 0884 005a 0664 0e64 0a64 0b84 015a  .d...Z.d.d.d...Z
+00000e20: 0764 0c53 0029 0fda 116d 756c 7469 5f69  .d.S.)...multi_i
+00000e30: 6d61 6765 5f64 7269 6674 61f7 0300 000a  mage_drifta.....
+00000e40: 2020 2020 436f 7272 6563 7420 666f 7220      Correct for 
+00000e50: 7363 616e 2064 7269 6674 2074 6872 6f75  scan drift throu
+00000e60: 6768 2063 726f 7373 2d63 6f72 7265 6c61  gh cross-correla
+00000e70: 7469 6e67 2061 0a20 2020 2072 6170 6964  ting a.    rapid
+00000e80: 6c79 2061 6371 7569 7265 6420 696d 6167  ly acquired imag
+00000e90: 6520 7374 6163 6b0a 0a20 2020 2050 6172  e stack..    Par
+00000ea0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000eb0: 2d2d 2d2d 2d2d 0a20 2020 2069 6d61 6765  ------.    image
+00000ec0: 5f73 7461 636b 3a20 6e64 6172 7261 790a  _stack: ndarray.
+00000ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ee0: 2053 7461 636b 206f 6620 696d 6167 6573   Stack of images
+00000ef0: 2063 6f6c 6c65 6374 6564 2069 6e20 7261   collected in ra
+00000f00: 7069 6420 7375 6363 6573 7369 6f6e 2c0a  pid succession,.
+00000f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f20: 2077 6865 7265 2074 6865 2074 6865 2066   where the the f
+00000f30: 6972 7374 2061 7272 6179 2070 6f73 6974  irst array posit
+00000f40: 696f 6e20 7265 6665 7273 2074 6f20 7468  ion refers to th
+00000f50: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00000f60: 2020 2069 6d61 6765 2063 6f6c 6c65 6374     image collect
+00000f70: 6564 2e20 5468 7573 2074 6865 206e 7468  ed. Thus the nth
+00000f80: 2069 6d61 6765 2069 6e20 7468 6520 7374   image in the st
+00000f90: 6163 6b0a 2020 2020 2020 2020 2020 2020  ack.            
+00000fa0: 2020 2020 2069 7320 696d 6167 655f 7374       is image_st
+00000fb0: 6163 6b5b 6e2d 312c 3a2c 3a5d 0a20 2020  ack[n-1,:,:].   
+00000fc0: 2073 616d 706c 696e 673a 2020 2020 696e   sampling:    in
+00000fd0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00000fe0: 2020 2020 2020 2020 2020 2020 2046 7261               Fra
+00000ff0: 6374 696f 6e20 6f66 2074 6865 2070 6978  ction of the pix
+00001000: 656c 2074 6f20 6361 6c63 756c 6174 6520  el to calculate 
+00001010: 7570 7361 6d70 6c65 640a 2020 2020 2020  upsampled.      
+00001020: 2020 2020 2020 2020 2020 2063 726f 7373             cross
+00001030: 2d63 6f72 7265 6c61 7469 6f6e 2066 6f72  -correlation for
+00001040: 2e20 4465 6661 756c 7420 6973 2035 3030  . Default is 500
+00001050: 0a0a 2020 2020 5265 6665 7265 6e63 6573  ..    References
+00001060: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00001070: 2020 2020 2e2e 205b 315d 2053 6176 6974      .. [1] Savit
+00001080: 7a6b 792c 2042 2e48 2e2c 2045 6c20 4261  zky, B.H., El Ba
+00001090: 6767 6172 692c 2049 2e2c 2043 6c65 6d65  ggari, I., Cleme
+000010a0: 6e74 2c20 432e 422e 2c20 5761 6974 652c  nt, C.B., Waite,
+000010b0: 2045 2e2c 2047 6f6f 6467 652c 2042 2e48   E., Goodge, B.H
+000010c0: 2e2c 0a20 2020 2020 2020 4261 656b 2c20  .,.       Baek, 
+000010d0: 442e 4a2e 2c20 5368 6563 6b65 6c74 6f6e  D.J., Sheckelton
+000010e0: 2c20 4a2e 502e 2c20 5061 7363 6f2c 2043  , J.P., Pasco, C
+000010f0: 2e2c 204e 6169 722c 2048 2e2c 2053 6368  ., Nair, H., Sch
+00001100: 7265 6962 6572 2c20 4e2e 4a2e 2061 6e64  reiber, N.J. and
+00001110: 0a20 2020 2020 2020 486f 6666 6d61 6e2c  .       Hoffman,
+00001120: 204a 2e2c 2032 3031 382e 2049 6d61 6765   J., 2018. Image
+00001130: 2072 6567 6973 7472 6174 696f 6e20 6f66   registration of
+00001140: 206c 6f77 2073 6967 6e61 6c2d 746f 2d6e   low signal-to-n
+00001150: 6f69 7365 2063 7279 6f2d 5354 454d 2064  oise cryo-STEM d
+00001160: 6174 612e 0a20 2020 2020 2020 556c 7472  ata..       Ultr
+00001170: 616d 6963 726f 7363 6f70 792c 2031 3931  amicroscopy, 191
+00001180: 2c20 7070 2e35 362d 3635 2e0a 0a20 2020  , pp.56-65...   
+00001190: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+000011a0: 2d2d 2d2d 2d2d 0a20 2020 2052 756e 2074  ------.    Run t
+000011b0: 6865 2066 756e 6374 696f 6e20 6173 3a0a  he function as:.
+000011c0: 0a20 2020 203e 3e3e 2063 6320 3d20 6472  .    >>> cc = dr
+000011d0: 6966 745f 636f 7272 6563 746f 7228 696d  ift_corrector(im
+000011e0: 6167 655f 7374 6163 6b29 0a20 2020 203e  age_stack).    >
+000011f0: 3e3e 2063 632e 6765 745f 7368 6966 745f  >> cc.get_shift_
+00001200: 7374 6163 6b28 290a 2020 2020 3e3e 3e20  stack().    >>> 
+00001210: 636f 7272 6563 7465 6420 3d20 6363 2e63  corrected = cc.c
+00001220: 6f72 7265 6374 6564 5f73 7461 636b 2829  orrected_stack()
+00001230: 0a0a 2020 2020 7202 0000 0063 0300 0000  ..    r....c....
+00001240: 0000 0000 0000 0000 0400 0000 0400 0000  ................
+00001250: 4300 0000 739c 0000 007c 0264 016b 0072  C...s....|.d.k.r
+00001260: 0874 0064 0283 0182 017c 017c 005f 017c  .t.d.....|.|._.|
+00001270: 016a 0264 0319 007c 005f 037c 016a 0264  .j.d...|._.|.j.d
+00001280: 0319 007d 037c 037c 005f 047c 027c 005f  ...}.|.|._.|.|._
+00001290: 0574 06a0 077c 037c 0366 02a1 017c 005f  .t...|.|.f...|._
+000012a0: 0874 06a0 077c 037c 0366 02a1 017c 005f  .t...|.|.f...|._
+000012b0: 0964 037c 005f 0a74 066a 077c 016a 0264  .d.|._.t.j.|.j.d
+000012c0: 0119 007c 016a 0264 0419 0066 027c 016a  ...|.j.d...f.|.j
+000012d0: 0b64 058d 027c 005f 0c74 066a 0d7c 017c  .d...|._.t.j.|.|
+000012e0: 016a 0b64 058d 027c 005f 0e64 067c 005f  .j.d...|._.d.|._
+000012f0: 0f64 0053 0029 074e 7203 0000 007a 2c53  .d.S.).Nr....z,S
+00001300: 616d 706c 696e 6720 6661 6374 6f72 2073  ampling factor s
+00001310: 686f 756c 6420 6265 2061 2070 6f73 6974  hould be a posit
+00001320: 6976 6520 696e 7465 6765 7272 0100 0000  ive integerr....
+00001330: e902 0000 00a9 01da 0564 7479 7065 4629  .........dtypeF)
+00001340: 10da 0c52 756e 7469 6d65 4572 726f 7272  ...RuntimeErrorr
+00001350: 0b00 0000 da05 7368 6170 655a 0b73 7461  ......shapeZ.sta
+00001360: 636b 5f73 6861 7065 da05 6e6f 5f69 6d72  ck_shape..no_imr
+00001370: 0e00 0000 7217 0000 00da 0565 6d70 7479  ....r......empty
+00001380: 720c 0000 0072 0d00 0000 da09 6d61 785f  r....r......max_
+00001390: 7368 6966 7472 1e00 0000 da0a 636f 7272  shiftr......corr
+000013a0: 5f69 6d61 6765 5a0a 656d 7074 795f 6c69  _imageZ.empty_li
+000013b0: 6b65 7219 0000 00da 0b73 7461 636b 5f63  ker......stack_c
+000013c0: 6865 636b 2904 da04 7365 6c66 720b 0000  heck)...selfr...
+000013d0: 0072 0e00 0000 7221 0000 0072 1200 0000  .r....r!...r....
+000013e0: 7212 0000 0072 1300 0000 da08 5f5f 696e  r....r......__in
+000013f0: 6974 5f5f 8c00 0000 731e 0000 0008 0108  it__....s.......
+00001400: 0106 010c 010a 0106 0106 0110 0110 0106  ................
+00001410: 0104 0116 0108 ff12 030a 017a 1a6d 756c  ...........z.mul
+00001420: 7469 5f69 6d61 6765 5f64 7269 6674 2e5f  ti_image_drift._
+00001430: 5f69 6e69 745f 5f63 0100 0000 0000 0000  _init__c........
+00001440: 0000 0000 0400 0000 0800 0000 4300 0000  ............C...
+00001450: 73b6 0000 0074 006a 01a0 02a1 0001 0074  s....t.j.......t
+00001460: 036a 0464 017c 006a 0585 0264 017c 006a  .j.d.|.j...d.|.j
+00001470: 0585 0266 0219 005c 027d 017d 0274 03a0  ...f...\.}.}.t..
+00001480: 0674 03a0 077c 01a1 0174 03a0 077c 02a1  .t...|...t...|..
+00001490: 0166 02a1 01a0 08a1 007d 0374 097c 006a  .f.......}.t.|.j
+000014a0: 0a7c 006a 0b7c 006a 0c7c 0364 0164 0285  .|.j.|.j.|.d.d..
+000014b0: 0264 0364 0385 0266 0219 007c 006a 0d83  .d.d...f...|.j..
+000014c0: 0501 0074 097c 006a 0a7c 006a 0b7c 006a  ...t.|.j.|.j.|.j
+000014d0: 0c7c 037c 006a 0d83 0501 0074 03a0 0e74  .|.|.j.....t...t
+000014e0: 03a0 0674 03a0 0e7c 006a 0ba1 0174 03a0  ...t...|.j...t..
+000014f0: 0e7c 006a 0ca1 0166 02a1 01a1 017c 005f  .|.j...f.....|._
+00001500: 0f64 047c 005f 1064 0353 0029 0561 4701  .d.|._.d.S.).aG.
+00001510: 0000 0a20 2020 2020 2020 2043 726f 7373  ...        Cross
+00001520: 2d43 6f72 7265 6c61 7465 2073 7461 636b  -Correlate stack
+00001530: 206f 6620 696d 6167 6573 0a0a 2020 2020   of images..    
+00001540: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
+00001550: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
+00001560: 466f 7220 6120 7261 7069 646c 7920 636f  For a rapidly co
+00001570: 6c6c 6563 7465 6420 696d 6167 6520 7374  llected image st
+00001580: 6163 6b2c 2065 6163 6820 696d 6167 6520  ack, each image 
+00001590: 696e 2074 6865 2073 7461 636b 2069 730a  in the stack is.
+000015a0: 2020 2020 2020 2020 6372 6f73 732d 636f          cross-co
+000015b0: 7272 656c 6174 6564 2077 6974 6820 616c  rrelated with al
+000015c0: 6c20 7468 6520 6f74 6865 7220 696d 6167  l the other imag
+000015d0: 6573 206f 6620 7468 6520 7374 6163 6b2c  es of the stack,
+000015e0: 2074 6f20 6765 6e65 7261 7465 0a20 2020   to generate.   
+000015f0: 2020 2020 2061 2073 6b65 7720 6d61 7472       a skew matr
+00001600: 6978 206f 6620 726f 7720 7368 6966 7473  ix of row shifts
+00001610: 2061 6e64 2063 6f6c 756d 6e20 7368 6966   and column shif
+00001620: 7473 2c20 6361 6c63 756c 6174 6564 2077  ts, calculated w
+00001630: 6974 6820 7375 620a 2020 2020 2020 2020  ith sub.        
+00001640: 7069 7865 6c20 7072 6563 6973 696f 6e2e  pixel precision.
+00001650: 0a20 2020 2020 2020 2072 0100 0000 e90a  .        r......
+00001660: 0000 004e 5429 1172 0400 0000 7205 0000  ...NT).r....r...
+00001670: 0072 0600 0000 7217 0000 005a 056d 6772  .r....r....Z.mgr
+00001680: 6964 7221 0000 005a 0761 7361 7272 6179  idr!...Z.asarray
+00001690: 5a05 7261 7665 6c5a 0974 7261 6e73 706f  Z.ravelZ.transpo
+000016a0: 7365 7214 0000 0072 0b00 0000 720c 0000  ser....r....r...
+000016b0: 0072 0d00 0000 720e 0000 005a 0461 6d61  .r....r....Z.ama
+000016c0: 7872 2300 0000 7225 0000 0029 0472 2600  xr#...r%...).r&.
+000016d0: 0000 5a04 726f 7773 da04 636f 6c73 5a09  ..Z.rows..colsZ.
+000016e0: 706f 735f 7374 6163 6b72 1200 0000 7212  pos_stackr....r.
+000016f0: 0000 0072 1300 0000 da0f 6765 745f 7368  ...r......get_sh
+00001700: 6170 655f 7374 6163 6b9d 0000 0073 2200  ape_stack....s".
+00001710: 0000 0a0b 1e01 1e01 0203 0401 0401 0401  ................
+00001720: 1201 0401 04fb 0209 1201 04ff 0404 1c01  ................
+00001730: 06ff 0a03 7a21 6d75 6c74 695f 696d 6167  ....z!multi_imag
+00001740: 655f 6472 6966 742e 6765 745f 7368 6170  e_drift.get_shap
+00001750: 655f 7374 6163 6b63 0100 0000 0000 0000  e_stackc........
+00001760: 0000 0000 0500 0000 0700 0000 4300 0000  ............C...
+00001770: 73cc 0000 007c 006a 0073 0774 0164 0183  s....|.j.s.t.d..
+00001780: 0182 0174 02a0 037c 006a 0464 0264 0385  ...t...|.j.d.d..
+00001790: 0264 0464 0485 0264 0464 0485 0266 0319  .d.d...d.d...f..
+000017a0: 00a1 017d 0174 02a0 037c 006a 0564 0264  ...}.t...|.j.d.d
+000017b0: 0385 0264 0464 0485 0264 0464 0485 0266  ...d.d...d.d...f
+000017c0: 0319 00a1 017d 0274 02a0 037c 006a 0664  .....}.t...|.j.d
+000017d0: 0264 0385 0264 0264 0385 0266 0219 00a1  .d...d.d...f....
+000017e0: 017d 0374 02a0 037c 006a 0764 0264 0385  .}.t...|.j.d.d..
+000017f0: 0264 0264 0385 0266 0219 00a1 017d 0474  .d.d...f.....}.t
+00001800: 087c 017c 027c 037c 0483 0401 0074 087c  .|.|.|.|.....t.|
+00001810: 006a 047c 006a 057c 006a 067c 006a 0783  .j.|.j.|.j.|.j..
+00001820: 0401 0074 026a 097c 006a 0564 0264 058d  ...t.j.|.j.d.d..
+00001830: 027c 006a 0a1b 007c 005f 0b7c 006a 0b53  .|.j...|._.|.j.S
+00001840: 0029 0661 a501 0000 0a20 2020 2020 2020  .).a.....       
+00001850: 2047 6574 2063 6f72 7265 6374 6564 2069   Get corrected i
+00001860: 6d61 6765 2073 7461 636b 0a0a 2020 2020  mage stack..    
+00001870: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00001880: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00001890: 2020 2020 636f 7272 5f73 7461 636b 3a20      corr_stack: 
+000018a0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+000018b0: 2020 2020 2020 2020 2020 2020 436f 7272              Corr
+000018c0: 6563 7465 6420 696d 6167 6520 6672 6f6d  ected image from
+000018d0: 2074 6865 2069 6d61 6765 2073 7461 636b   the image stack
+000018e0: 0a0a 2020 2020 2020 2020 4e6f 7465 730a  ..        Notes.
+000018f0: 2020 2020 2020 2020 2d2d 2d2d 2d0a 2020          -----.  
+00001900: 2020 2020 2020 5468 6520 6d65 616e 206f        The mean o
+00001910: 6620 7468 6520 7368 6966 7420 7374 6163  f the shift stac
+00001920: 6b73 2066 6f72 2065 7665 7279 2069 6d61  ks for every ima
+00001930: 6765 2070 6f73 6974 696f 6e20 6172 6520  ge position are 
+00001940: 7468 650a 2020 2020 2020 2020 616d 6f75  the.        amou
+00001950: 6e74 2062 7920 7768 6963 6820 6561 6368  nt by which each
+00001960: 2069 6d61 6765 2069 7320 746f 2062 6520   image is to be 
+00001970: 7368 6966 7465 642e 2057 6520 6361 6c63  shifted. We calc
+00001980: 756c 6174 6520 7468 650a 2020 2020 2020  ulate the.      
+00001990: 2020 6d65 616e 2061 6e64 206d 6f76 6520    mean and move 
+000019a0: 6561 6368 2069 6d61 6765 2062 7920 7468  each image by th
+000019b0: 6174 2061 6d6f 756e 7420 696e 2074 6865  at amount in the
+000019c0: 2073 7461 636b 2061 6e64 2074 6865 6e0a   stack and then.
+000019d0: 2020 2020 2020 2020 7375 6d20 7468 656d          sum them
+000019e0: 2075 702e 0a20 2020 2020 2020 20fa 3b50   up..        .;P
+000019f0: 6c65 6173 6520 6765 7420 7468 6520 696d  lease get the im
+00001a00: 6167 6573 2063 6f72 7265 6c61 7465 6420  ages correlated 
+00001a10: 6669 7273 7420 6173 2067 6574 5f73 6861  first as get_sha
+00001a20: 7065 5f73 7461 636b 2829 7201 0000 00e9  pe_stack()r.....
+00001a30: 0300 0000 4e72 1500 0000 290c 7225 0000  ....Nr....).r%..
+00001a40: 0072 1f00 0000 7217 0000 00da 0463 6f70  .r....r......cop
+00001a50: 7972 0b00 0000 7219 0000 0072 0c00 0000  yr....r....r....
+00001a60: 720d 0000 0072 1a00 0000 da03 7375 6d72  r....r......sumr
+00001a70: 2100 0000 7224 0000 0029 0572 2600 0000  !...r$...).r&...
+00001a80: 720b 0000 0072 1900 0000 720c 0000 0072  r....r....r....r
+00001a90: 0d00 0000 7212 0000 0072 1200 0000 7213  ....r....r....r.
+00001aa0: 0000 00da 0f63 6f72 7265 6374 6564 5f73  .....corrected_s
+00001ab0: 7461 636b bf00 0000 731c 0000 0006 1002  tack....s.......
+00001ac0: 0102 0104 ff22 0322 011c 011c 010e 0202  ....."."........
+00001ad0: 0310 0104 ff18 0306 017a 216d 756c 7469  .........z!multi
+00001ae0: 5f69 6d61 6765 5f64 7269 6674 2e63 6f72  _image_drift.cor
+00001af0: 7265 6374 6564 5f73 7461 636b e90f 0000  rected_stack....
+00001b00: 0063 0200 0000 0000 0000 0000 0000 1000  .c..............
+00001b10: 0000 0900 0000 4300 0000 73c2 0200 007c  ......C...s....|
+00001b20: 006a 0073 0774 0164 0183 0182 0174 027c  .j.s.t.d.....t.|
+00001b30: 0183 017d 0264 027c 0264 039c 027d 0374  ...}.d.|.d...}.t
+00001b40: 027c 0183 0174 027c 0164 0414 0083 0166  .|...t.|.d.....f
+00001b50: 027d 0474 036a 047c 0464 058d 0101 007c  .}.t.j.|.d.....|
+00001b60: 006a 057d 0574 06a0 0764 0664 07a1 027d  .j.}.t...d.d...}
+00001b70: 0674 03a0 087c 0664 0864 0985 0264 0864  .t...|.d.d...d.d
+00001b80: 0a85 0266 0219 00a1 017d 0774 03a0 087c  ...f.....}.t...|
+00001b90: 0664 0864 0985 0264 0b64 0785 0266 0219  .d.d...d.d...f..
+00001ba0: 00a1 017d 0874 03a0 087c 0664 0964 0685  ...}.t...|.d.d..
+00001bb0: 0264 0c64 0c85 0266 0219 00a1 017d 097c  .d.d...f.....}.|
+00001bc0: 076a 097c 006a 0a7c 050b 007c 0564 0d64  .j.|.j.|...|.d.d
+00001bd0: 0e8d 0401 007c 076a 0b64 2769 007c 03a4  .....|.j.d'i.|..
+00001be0: 018e 0101 007c 076a 0c64 2769 007c 03a4  .....|.j.d'i.|..
+00001bf0: 018e 0101 007c 076a 0d6a 0e64 107c 0114  .....|.j.j.d.|..
+00001c00: 0064 117c 0114 0064 1264 0964 138d 0401  .d.|...d.d.d....
+00001c10: 007c 076a 0f6a 0e64 107c 0114 0064 117c  .|.j.j.d.|...d.|
+00001c20: 0114 0064 1264 0964 138d 0401 0074 106a  ...d.d.d.....t.j
+00001c30: 1164 1474 127c 0264 158d 0164 1664 1764  .d.t.|.d...d.d.d
+00001c40: 188d 047d 0a7c 0a6a 13a0 1464 19a1 0101  ...}.|.j...d....
+00001c50: 007c 07a0 157c 0aa1 0101 007c 086a 097c  .|...|.....|.j.|
+00001c60: 006a 167c 050b 007c 0564 0d64 0e8d 0401  .j.|...|.d.d....
+00001c70: 007c 086a 0b64 2769 007c 03a4 018e 0101  .|.j.d'i.|......
+00001c80: 007c 086a 0c64 2769 007c 03a4 018e 0101  .|.j.d'i.|......
+00001c90: 007c 086a 0d6a 0e64 107c 0114 0064 117c  .|.j.j.d.|...d.|
+00001ca0: 0114 0064 1264 0964 138d 0401 007c 086a  ...d.d.d.....|.j
+00001cb0: 0f6a 0e64 107c 0114 0064 117c 0114 0064  .j.d.|...d.|...d
+00001cc0: 1264 0964 138d 0401 0074 106a 1164 1a74  .d.d.....t.j.d.t
+00001cd0: 127c 0264 158d 0164 1664 1764 188d 047d  .|.d...d.d.d...}
+00001ce0: 0a7c 0a6a 13a0 1464 19a1 0101 007c 08a0  .|.j...d.....|..
+00001cf0: 157c 0aa1 0101 0074 176a 1864 1b74 176a  .|.....t.j.d.t.j
+00001d00: 1964 1c8d 027d 0b74 1a64 0983 0144 005d  .d...}.t.d...D.]
+00001d10: 107d 0c74 17a0 1b7c 050b 007c 0564 1da1  .}.t...|...|.d..
+00001d20: 037c 0b7c 0c64 0c64 0c85 0266 023c 0071  .|.|.d.d...f.<.q
+00001d30: f87c 096a 097c 0b64 0d64 1e8d 0201 007c  .|.j.|.d.d.....|
+00001d40: 096a 0fa0 1c64 1fa1 0101 0064 0a7d 0d74  .j...d.....d.}.t
+00001d50: 17a0 1b64 0864 1d7c 0da1 037d 0e7c 09a0  ...d.d.|...}.|..
+00001d60: 1d7c 0ea1 0101 007c 09a0 1e74 17a0 1f74  .|.....|...t...t
+00001d70: 17a0 1b7c 050b 007c 057c 0da1 0364 20a1  ...|...|.|...d .
+00001d80: 02a1 0101 0064 2144 005d 137d 0f7c 096a  .....d!D.].}.|.j
+00001d90: 207c 0f19 00a0 2164 22a1 0101 007c 096a   |....!d"....|.j
+00001da0: 207c 0f19 00a0 2264 23a1 0101 0090 0171   |...."d#......q
+00001db0: 357c 096a 0d6a 0e64 2264 2464 2564 0964  5|.j.j.d"d$d%d.d
+00001dc0: 138d 0401 007c 096a 2364 2869 007c 03a4  .....|.j#d(i.|..
+00001dd0: 018e 0101 0074 03a0 24a1 0001 0064 0c53  .....t..$....d.S
+00001de0: 0029 297a 600a 2020 2020 2020 2020 4e6f  .))z`.        No
+00001df0: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
+00001e00: 2d0a 2020 2020 2020 2020 506c 6f74 2074  -.        Plot t
+00001e10: 6865 2072 656c 6174 6976 6520 7368 6966  he relative shif
+00001e20: 7473 206f 6620 696d 6167 6573 2077 6974  ts of images wit
+00001e30: 6820 6561 6368 206f 7468 6572 0a20 2020  h each other.   
+00001e40: 2020 2020 2072 2b00 0000 5a04 626f 6c64       r+...Z.bold
+00001e50: 2902 da06 7765 6967 6874 da04 7369 7a65  )...weight..size
+00001e60: 6733 3333 3333 33e3 3f29 015a 0766 6967  g333333.?).Z.fig
+00001e70: 7369 7a65 e90c 0000 00e9 1400 0000 7201  size..........r.
+00001e80: 0000 0072 2800 0000 e909 0000 00e9 0b00  ...r(...........
+00001e90: 0000 4e5a 0652 6442 755f 7229 035a 0476  ..NZ.RdBu_r).Z.v
+00001ea0: 6d69 6e5a 0476 6d61 78da 0463 6d61 70fa  minZ.vmax..cmap.
+00001eb0: 0c53 7461 636b 204e 756d 6265 7267 9a99  .Stack Numberg..
+00001ec0: 9999 9999 b93f 679a 9999 9999 99d9 3fda  .....?g.......?.
+00001ed0: 0269 6e29 04da 0577 6964 7468 da06 6c65  .in)...width..le
+00001ee0: 6e67 7468 da09 6469 7265 6374 696f 6eda  ngth..direction.
+00001ef0: 0370 6164 7a17 5368 6966 7420 616c 6f6e  .padz.Shift alon
+00001f00: 6720 5820 6469 7265 6374 696f 6e29 0172  g X direction).r
+00001f10: 3200 0000 547a 0a75 7070 6572 206c 6566  2...Tz.upper lef
+00001f20: 7429 03da 0470 726f 705a 0766 7261 6d65  t)...propZ.frame
+00001f30: 6f6e da03 6c6f 637a 2272 6f75 6e64 2c20  on..locz"round, 
+00001f40: 7061 643d 2030 2e2c 2072 6f75 6e64 696e  pad= 0., roundin
+00001f50: 675f 7369 7a65 3d20 302e 327a 1753 6869  g_size= 0.2z.Shi
+00001f60: 6674 2061 6c6f 6e67 2059 2064 6972 6563  ft along Y direc
+00001f70: 7469 6f6e 2902 7228 0000 00e9 e803 0000  tion).r(........
+00001f80: 721d 0000 0072 4000 0000 2901 7237 0000  r....r@...).r7..
+00001f90: 0046 e904 0000 0029 04da 0374 6f70 5a06  .F.....)...topZ.
+00001fa0: 626f 7474 6f6d da04 6c65 6674 da05 7269  bottom..left..ri
+00001fb0: 6768 7472 1c00 0000 5a05 626c 6163 6be9  ghtr....Z.black.
+00001fc0: 0600 0000 da03 6f75 74fa 1752 656c 6174  ......out..Relat
+00001fd0: 6976 6520 5368 6966 7420 2870 6978 656c  ive Shift (pixel
+00001fe0: 7329 2901 7238 0000 0029 0172 4700 0000  s)).r8...).rG...
+00001ff0: 2925 7225 0000 0072 1f00 0000 da03 696e  )%r%...r......in
+00002000: 74da 0370 6c74 5a06 6669 6775 7265 7223  t..pltZ.figurer#
+00002010: 0000 00da 046d 7067 735a 0847 7269 6453  .....mpgsZ.GridS
+00002020: 7065 635a 0773 7562 706c 6f74 5a06 696d  pecZ.subplotZ.im
+00002030: 7368 6f77 720c 0000 005a 0a73 6574 5f78  showr....Z.set_x
+00002040: 6c61 6265 6c5a 0a73 6574 5f79 6c61 6265  labelZ.set_ylabe
+00002050: 6c5a 0578 6178 6973 5a0f 7365 745f 7469  lZ.xaxisZ.set_ti
+00002060: 636b 5f70 6172 616d 735a 0579 6178 6973  ck_paramsZ.yaxis
+00002070: da06 6d70 6c6f 6666 5a0c 416e 6368 6f72  ..mploffZ.Anchor
+00002080: 6564 5465 7874 da04 6469 6374 5a05 7061  edText..dictZ.pa
+00002090: 7463 685a 0c73 6574 5f62 6f78 7374 796c  tchZ.set_boxstyl
+000020a0: 655a 0a61 6464 5f61 7274 6973 7472 0d00  eZ.add_artistr..
+000020b0: 0000 7217 0000 005a 057a 6572 6f73 da05  ..r....Z.zeros..
+000020c0: 666c 6f61 7472 0700 0000 5a08 6c69 6e73  floatr....Z.lins
+000020d0: 7061 6365 5a0b 7365 745f 7669 7369 626c  paceZ.set_visibl
+000020e0: 655a 0a73 6574 5f78 7469 636b 735a 0f73  eZ.set_xticksZ.s
+000020f0: 6574 5f78 7469 636b 6c61 6265 6c73 da05  et_xticklabels..
+00002100: 726f 756e 645a 0673 7069 6e65 735a 0d73  roundZ.spinesZ.s
+00002110: 6574 5f6c 696e 6577 6964 7468 5a09 7365  et_linewidthZ.se
+00002120: 745f 636f 6c6f 725a 0973 6574 5f74 6974  t_colorZ.set_tit
+00002130: 6c65 5a09 6175 746f 7363 616c 6529 1072  leZ.autoscale).r
+00002140: 2600 0000 5a07 696d 7769 6474 685a 0866  &...Z.imwidthZ.f
+00002150: 6f6e 7473 697a 655a 0773 635f 666f 6e74  ontsizeZ.sc_font
+00002160: 5a06 696d 7369 7a65 5a02 766d 5a02 6773  Z.imsizeZ.vmZ.gs
+00002170: 5a03 6178 315a 0361 7832 5a03 6178 33da  Z.ax1Z.ax2Z.ax3.
+00002180: 0261 745a 0273 6272 1000 0000 5a09 6e6f  .atZ.sbr....Z.no
+00002190: 5f6c 6162 656c 73da 0278 3172 1600 0000  _labels..x1r....
+000021a0: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
+000021b0: 0b70 6c6f 745f 7368 6966 7473 e100 0000  .plot_shifts....
+000021c0: 737c 0000 0006 0602 0102 0104 ff08 030a  s|..............
+000021d0: 0114 010c 0106 010c 021a 011a 011a 0116  ................
+000021e0: 0210 0110 0106 0110 0106 ff06 0310 0106  ................
+000021f0: ff04 0302 0108 0102 0102 0106 fc0c 060a  ................
+00002200: 0116 0210 0110 0106 0110 0106 ff06 0310  ................
+00002210: 0106 ff04 0302 0108 0102 0102 0106 fc0c  ................
+00002220: 060a 0110 020c 011e 010e 010c 0104 010e  ................
+00002230: 010a 011e 0108 0110 0114 0114 0110 010c  ................
+00002240: 027a 1d6d 756c 7469 5f69 6d61 6765 5f64  .z.multi_image_d
+00002250: 7269 6674 2e70 6c6f 745f 7368 6966 7473  rift.plot_shifts
+00002260: 4ea9 0172 0200 0000 2901 7230 0000 0029  N..r....).r0...)
+00002270: 08da 085f 5f6e 616d 655f 5fda 0a5f 5f6d  ...__name__..__m
+00002280: 6f64 756c 655f 5fda 0c5f 5f71 7561 6c6e  odule__..__qualn
+00002290: 616d 655f 5fda 075f 5f64 6f63 5f5f 7227  ame__..__doc__r'
+000022a0: 0000 0072 2a00 0000 722f 0000 0072 5100  ...r*...r/...rQ.
+000022b0: 0000 7212 0000 0072 1200 0000 7212 0000  ..r....r....r...
+000022c0: 0072 1300 0000 721b 0000 006b 0000 0073  .r....r....k...s
+000022d0: 0c00 0000 0800 0401 0a20 0811 0822 0e22  ......... ..."."
+000022e0: 721b 0000 0072 5200 0000 2914 5a14 6d61  r....rR...).Z.ma
+000022f0: 7470 6c6f 746c 6962 2e6f 6666 7365 7462  tplotlib.offsetb
+00002300: 6f78 5a09 6f66 6673 6574 626f 7872 4b00  oxZ.offsetboxrK.
+00002310: 0000 5a05 6e75 6d70 7972 1700 0000 5a11  ..Z.numpyr....Z.
+00002320: 7079 6666 7477 2e69 6e74 6572 6661 6365  pyfftw.interface
+00002330: 735a 0a69 6e74 6572 6661 6365 7372 0400  sZ.interfacesr..
+00002340: 0000 da08 7374 656d 746f 6f6c 7209 0000  ....stemtoolr...
+00002350: 005a 116d 6174 706c 6f74 6c69 622e 7079  .Z.matplotlib.py
+00002360: 706c 6f74 5a06 7079 706c 6f74 7249 0000  plotZ.pyplotrI..
+00002370: 005a 136d 6174 706c 6f74 6c69 622e 6772  .Z.matplotlib.gr
+00002380: 6964 7370 6563 5a08 6772 6964 7370 6563  idspecZ.gridspec
+00002390: 724a 0000 0072 1400 0000 721a 0000 00da  rJ...r....r.....
+000023a0: 066f 626a 6563 7472 1b00 0000 7212 0000  .objectr....r...
+000023b0: 0072 1200 0000 7212 0000 0072 1300 0000  .r....r....r....
+000023c0: da08 3c6d 6f64 756c 653e 0100 0000 7312  ..<module>....s.
+000023d0: 0000 000c 0008 010c 0108 010c 010c 010a  ................
+000023e0: 0308 3314 2f                             ..3./
```

## Comparing `stemtool/dpc/__pycache__/atomic_dpc.cpython-39.pyc` & `stemtool/dpc/__pycache__/atomic_dpc.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:07:48 2023 UTC, .py size: 22908 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 e433 e163 7c59 0000  a........3.c|Y..
+00000000: 6f0d 0d0a 0000 0000 c07d 3c63 7c59 0000  o........}<c|Y..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 ac00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 6d01 5a02 0100 6400 6401 6c03  d.l.m.Z...d.d.l.
 00000040: 6d04 5a05 0100 6400 6401 6c06 5a07 6400  m.Z...d.d.l.Z.d.
 00000050: 6401 6c08 5a09 6400 6401 6c0a 6d0b 5a0c  d.l.Z.d.d.l.m.Z.
 00000060: 0100 6400 6401 6c0d 6d0e 5a0f 0100 6400  ..d.d.l.m.Z...d.
 00000070: 6401 6c10 6d11 5a12 0100 6400 6401 6c13  d.l.m.Z...d.d.l.
@@ -12,22 +12,22 @@
 000000b0: 6d1f 5a1f 6d20 5a20 6d21 5a21 6d22 5a22  m.Z.m Z m!Z!m"Z"
 000000c0: 6d23 5a23 0100 4700 6404 6405 8400 6405  m#Z#..G.d.d...d.
 000000d0: 6524 8303 5a25 6401 5300 2906 e900 0000  e$..Z%d.S.).....
 000000e0: 004e 2902 da03 416e 79da 0554 7570 6c65  .N)...Any..Tuple
 000000f0: 2905 da07 4e44 4172 7261 79da 0553 6861  )...NDArray..Sha
 00000100: 7065 da03 496e 74da 0546 6c6f 6174 da04  pe..Int..Float..
 00000110: 426f 6f6c 6300 0000 0000 0000 0000 0000  Boolc...........
-00000120: 0000 0000 0004 0000 0040 0000 0073 5e00  .........@...s^.
+00000120: 0000 0000 0003 0000 0040 0000 0073 5e00  .........@...s^.
 00000130: 0000 6500 5a01 6400 5a02 6401 5a03 6402  ..e.Z.d.Z.d.Z.d.
 00000140: 6403 8400 5a04 641c 6405 6406 8401 5a05  d...Z.d.d.d...Z.
 00000150: 641d 6409 640a 8401 5a06 641e 640d 640e  d.d.d...Z.d.d.d.
 00000160: 8401 5a07 641f 640f 6410 8401 5a08 6420  ..Z.d.d.d...Z.d 
-00000170: 6412 6413 8401 5a09 6421 6414 6415 8401  d.d...Z.d!d.d...
-00000180: 5a0a 6422 6419 641a 8401 5a0b 641b 5300  Z.d"d.d...Z.d.S.
-00000190: 2923 da0a 6174 6f6d 6963 5f64 7063 75c1  )#..atomic_dpcu.
+00000170: 6412 6413 8401 5a09 6420 6414 6415 8401  d.d...Z.d d.d...
+00000180: 5a0a 6421 6419 641a 8401 5a0b 641b 5300  Z.d!d.d...Z.d.S.
+00000190: 2922 da0a 6174 6f6d 6963 5f64 7063 75c1  )"..atomic_dpcu.
 000001a0: 0b00 000a 2020 2020 4174 6f6d 6963 2052  ....    Atomic R
 000001b0: 6573 6f6c 7574 696f 6e20 4450 4320 6573  esolution DPC es
 000001c0: 7469 6d61 7469 6f6e 0a0a 2020 2020 5061  timation..    Pa
 000001d0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
 000001e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 4461 7461  -------.    Data
 000001f0: 5f34 443a 2020 6e64 6172 7261 790a 2020  _4D:  ndarray.  
 00000200: 2020 2020 2020 2020 2020 2020 466f 7572              Four
@@ -259,877 +259,876 @@
 00001020: 7274 7572 65da 0670 6c61 6e63 6bda 0865  rture..planck..e
 00001030: 7073 696c 6f6e 30da 0865 5f63 6861 7267  psilon0..e_charg
 00001040: 65da 026e 70da 0270 69da 0573 6967 6d61  e..np..pi..sigma
 00001050: 2908 da04 7365 6c66 5a07 4461 7461 5f34  )...selfZ.Data_4
 00001060: 445a 0844 6174 615f 4144 465a 0863 616c  DZ.Data_ADFZ.cal
 00001070: 6962 5f70 6d72 0f00 0000 7213 0000 005a  ib_pmr....r....Z
 00001080: 0665 5f6d 6173 73da 0163 a900 721c 0000  .e_mass..c..r...
-00001090: 00fa 3d62 7569 6c64 2f62 6469 7374 2e6d  ..=build/bdist.m
-000010a0: 6163 6f73 782d 3130 2e39 2d78 3836 5f36  acosx-10.9-x86_6
-000010b0: 342f 6567 672f 7374 656d 746f 6f6c 2f64  4/egg/stemtool/d
-000010c0: 7063 2f61 746f 6d69 635f 6470 632e 7079  pc/atomic_dpc.py
-000010d0: da08 5f5f 696e 6974 5f5f 6300 0000 7324  ..__init__c...s$
-000010e0: 0000 0000 0c06 0106 0106 010a 010a 0102  ................
-000010f0: ff06 030a 0106 0106 0106 0104 0104 0214  ................
-00001100: 0116 ff02 021a fd7a 1361 746f 6d69 635f  .......z.atomic_
-00001110: 6470 632e 5f5f 696e 6974 5f5f a902 e914  dpc.__init__....
-00001120: 0000 00e9 0a00 0000 6302 0000 0000 0000  ........c.......
-00001130: 0000 0000 0005 0000 0006 0000 0043 0000  .............C..
-00001140: 0073 5601 0000 7400 6a01 7c00 6a02 6401  .sV...t.j.|.j.d.
-00001150: 6402 8d02 7c00 5f03 7404 7400 a005 7400  d...|._.t.t...t.
-00001160: a006 7c01 a101 a101 8301 7d02 7407 6a08  ..|.......}.t.j.
-00001170: 7c01 6403 8d01 0100 7407 a009 6404 6405  |.d.....t...d.d.
-00001180: 6404 a103 0100 7407 6a0a 7c00 6a0b 6406  d.....t.j.|.j.d.
-00001190: 6407 8d02 0100 740c a00d 7c00 6a0e 6408  d.....t...|.j.d.
-000011a0: 1b00 6409 a102 7d03 640a 7c03 5f0f 640b  ..d...}.d.|._.d.
-000011b0: 7c03 5f10 640c 7c03 5f11 7407 a012 a100  |._.d.|._.t.....
-000011c0: a013 7c03 a101 0100 7407 a014 640d a101  ..|.....t...d...
-000011d0: 0100 7415 6a16 640e 7417 7c02 640f 8d01  ..t.j.d.t.|.d...
-000011e0: 6410 6411 6412 8d04 7d04 7c04 6a18 a019  d.d.d...}.|.j...
-000011f0: 6413 a101 0100 7407 a012 a100 a013 7c04  d.....t.......|.
-00001200: a101 0100 7407 a009 6404 6405 6405 a103  ....t...d.d.d...
-00001210: 0100 7407 6a0a 7c00 6a03 6406 6407 8d02  ..t.j.|.j.d.d...
-00001220: 0100 740c a00d 7c00 6a0e 6408 1b00 6409  ..t...|.j.d...d.
-00001230: a102 7d03 640a 7c03 5f0f 640b 7c03 5f10  ..}.d.|._.d.|._.
-00001240: 640c 7c03 5f11 7407 a012 a100 a013 7c03  d.|._.t.......|.
-00001250: a101 0100 7407 a014 640d a101 0100 7415  ....t...d.....t.
-00001260: 6a16 6414 7417 7c02 640f 8d01 6410 6411  j.d.t.|.d...d.d.
-00001270: 6412 8d04 7d04 7c04 6a18 a019 6413 a101  d...}.|.j...d...
-00001280: 0100 7407 a012 a100 a013 7c04 a101 0100  ..t.......|.....
-00001290: 7407 a01a a100 0100 6415 5300 2916 612c  t.......d.S.).a,
-000012a0: 0100 000a 2020 2020 2020 2020 5468 6520  ....        The 
-000012b0: 4144 462d 5354 454d 2069 6d61 6765 2069  ADF-STEM image i
-000012c0: 7320 616c 7265 6164 7920 6c6f 6164 6564  s already loaded
-000012d0: 2c20 7768 696c 6520 7468 6520 6064 6174  , while the `dat
-000012e0: 615f 6266 600a 2020 2020 2020 2020 6174  a_bf`.        at
-000012f0: 7472 6962 7574 6520 6973 206f 6274 6169  tribute is obtai
-00001300: 6e65 6420 6279 2073 756d 6d69 6e67 2075  ned by summing u
-00001310: 7020 7468 6520 3444 2d53 5445 4d20 6461  p the 4D-STEM da
-00001320: 7461 7365 7420 616c 6f6e 6720 6974 2773  taset along it's
-00001330: 0a20 2020 2020 2020 2046 6f75 7269 6572  .        Fourier
-00001340: 2064 696d 656e 7369 6f6e 732e 2054 6869   dimensions. Thi
-00001350: 7320 6973 2061 6c73 6f20 6120 6772 6561  s is also a grea
-00001360: 7420 6368 6563 6b70 6f69 6e74 2074 6f20  t checkpoint to 
-00001370: 7365 6520 7768 6574 6865 720a 2020 2020  see whether.    
-00001380: 2020 2020 7468 6520 4144 462d 5354 454d      the ADF-STEM
-00001390: 2061 6e64 2074 6865 2042 462d 5354 454d   and the BF-STEM
-000013a0: 2069 6d61 6765 7320 6172 6520 7468 6520   images are the 
-000013b0: 696e 7665 7273 6520 6f66 2065 6163 6820  inverse of each 
-000013c0: 6f74 6865 722e 0a20 2020 2020 2020 2029  other..        )
-000013d0: 02e9 ffff ffff e9fe ffff ffa9 01da 0461  ...............a
-000013e0: 7869 73a9 015a 0766 6967 7369 7a65 e901  xis..Z.figsize..
-000013f0: 0000 0072 0b00 0000 da07 696e 6665 726e  ...r......infern
-00001400: 6fa9 01da 0463 6d61 7072 0a00 0000 da02  o....cmapr......
-00001410: 6e6d fa0b 6c6f 7765 7220 7269 6768 7472  nm..lower rightr
-00001420: 0100 0000 da01 77da 036f 6666 7a08 4144  ......w..offz.AD
-00001430: 462d 5354 454d a901 da04 7369 7a65 54fa  F-STEM....sizeT.
-00001440: 0a6c 6f77 6572 206c 6566 74a9 03da 0470  .lower left....p
-00001450: 726f 705a 0766 7261 6d65 6f6e da03 6c6f  ropZ.frameon..lo
-00001460: 63fa 2072 6f75 6e64 2c20 7061 643d 302e  c. round, pad=0.
-00001470: 2c20 726f 756e 6469 6e67 5f73 697a 653d  , rounding_size=
-00001480: 302e 327a 0e53 756d 6d65 6420 3444 2d53  0.2z.Summed 4D-S
-00001490: 5445 4d4e 291b 7217 0000 00da 0373 756d  TEMN).r......sum
-000014a0: 720d 0000 005a 0764 6174 615f 6266 da03  r....Z.data_bf..
-000014b0: 696e 74da 0461 6d61 78da 0761 7361 7272  int..amax..asarr
-000014c0: 6179 da03 706c 74da 0666 6967 7572 65da  ay..plt..figure.
-000014d0: 0773 7562 706c 6f74 da06 696d 7368 6f77  .subplot..imshow
-000014e0: 720c 0000 00da 046d 7073 73da 0853 6361  r......mpss..Sca
-000014f0: 6c65 4261 7272 0e00 0000 da08 6c6f 6361  leBarr......loca
-00001500: 7469 6f6e da09 626f 785f 616c 7068 61da  tion..box_alpha.
-00001510: 0563 6f6c 6f72 da03 6763 61da 0a61 6464  .color..gca..add
-00001520: 5f61 7274 6973 7472 2500 0000 da06 6d70  _artistr%.....mp
-00001530: 6c6f 6666 da0c 416e 6368 6f72 6564 5465  loff..AnchoredTe
-00001540: 7874 da04 6469 6374 da05 7061 7463 68da  xt..dict..patch.
-00001550: 0c73 6574 5f62 6f78 7374 796c 65da 0c74  .set_boxstyle..t
-00001560: 6967 6874 5f6c 6179 6f75 7429 0572 1a00  ight_layout).r..
-00001570: 0000 da06 696d 7369 7a65 da08 666f 6e74  ....imsize..font
-00001580: 7369 7a65 da08 7363 616c 6562 6172 da02  size..scalebar..
-00001590: 6174 721c 0000 0072 1c00 0000 721d 0000  atr....r....r...
-000015a0: 00da 0b73 686f 775f 4144 465f 4246 8100  ...show_ADF_BF..
-000015b0: 0000 733c 0000 0000 0712 0114 010c 010e  ..s<............
-000015c0: 0110 0112 0106 0106 0106 010e 010a 0104  ................
-000015d0: 010e ff06 030c 010e 020e 0110 0112 0106  ................
-000015e0: 0106 0106 010e 010a 0104 010e ff06 030c  ................
-000015f0: 010e 017a 1661 746f 6d69 635f 6470 632e  ...z.atomic_dpc.
-00001600: 7368 6f77 5f41 4446 5f42 46a9 02e9 0f00  show_ADF_BF.....
-00001610: 0000 7251 0000 0046 6303 0000 0000 0000  ..rQ...Fc.......
-00001620: 0000 0000 0004 0000 0005 0000 0043 0000  .............C..
-00001630: 0073 a000 0000 7400 6a01 7c00 6a02 6401  .s....t.j.|.j.d.
-00001640: 6402 8d02 7c00 5f03 7404 6a05 a006 7c00  d...|._.t.j...|.
-00001650: 6a03 a101 5c03 7c00 5f07 7c00 5f08 7c00  j...\.|._.|._.|.
-00001660: 5f09 7c00 6a0a 7c00 6a09 7c00 6a0b 1400  _.|.j.|.j.|.j...
-00001670: 1b00 7c00 5f0c 7c02 729c 740d 6a0e 7c01  ..|._.|.r.t.j.|.
-00001680: 6403 8d01 0100 740d 6a0f 7c00 6a03 6404  d.....t.j.|.j.d.
-00001690: 6405 8d02 0100 7410 a011 7c00 6a0c 6406  d.....t...|.j.d.
-000016a0: 7410 6a12 a103 7d03 6407 7c03 5f13 6408  t.j...}.d.|._.d.
-000016b0: 7c03 5f14 6409 7c03 5f15 740d a016 a100  |._.d.|._.t.....
-000016c0: a017 7c03 a101 0100 740d a018 640a a101  ..|.....t...d...
-000016d0: 0100 640b 5300 290c 61ec 0100 000a 2020  ..d.S.).a.....  
-000016e0: 2020 2020 2020 5765 2063 616c 6375 6c61        We calcula
-000016f0: 7465 2074 6865 206d 6561 6e20 4342 4544  te the mean CBED
-00001700: 2070 6174 7465 726e 2062 7920 6176 6572   pattern by aver
-00001710: 6167 696e 6720 7468 6520 466f 7572 6965  aging the Fourie
-00001720: 7220 6461 7461 2c20 746f 0a20 2020 2020  r data, to.     
-00001730: 2020 2067 6574 2074 6865 206f 626a 6563     get the objec
-00001740: 7420 6174 7472 6962 7574 6520 6063 6265  t attribute `cbe
-00001750: 6460 2e20 5765 2066 6974 2074 6869 7320  d`. We fit this 
-00001760: 7769 7468 2061 2063 6972 636c 6520 6675  with a circle fu
-00001770: 6e63 7469 6f6e 2074 6f0a 2020 2020 2020  nction to.      
-00001780: 2020 6f62 7461 696e 2074 6865 206f 626a    obtain the obj
-00001790: 6563 7420 6174 7472 6962 7574 6573 3a0a  ect attributes:.
-000017a0: 0a20 2020 2020 2020 2060 6265 616d 5f78  .        `beam_x
-000017b0: 603a 2078 2d63 6f6f 7264 696e 6174 6573  `: x-coordinates
-000017c0: 206f 6620 7468 6520 6369 7263 6c65 0a0a   of the circle..
-000017d0: 2020 2020 2020 2020 6062 6561 6d5f 7960          `beam_y`
-000017e0: 3a20 792d 636f 6f72 6469 6e61 7465 7320  : y-coordinates 
-000017f0: 6f66 2074 6865 2063 6972 636c 650a 0a20  of the circle.. 
-00001800: 2020 2020 2020 2060 6265 616d 5f72 603a         `beam_r`:
-00001810: 2072 6164 6975 7320 6f66 2074 6865 2063   radius of the c
-00001820: 6972 636c 650a 0a20 2020 2020 2020 2057  ircle..        W
-00001830: 6520 7573 6520 7468 6520 6361 6c63 756c  e use the calcul
-00001840: 6174 6564 2072 6164 6975 7320 616e 6420  ated radius and 
-00001850: 7468 6520 6b6e 6f77 6e20 6170 6572 7475  the known apertu
-00001860: 7265 2073 697a 6520 746f 2067 6574 2074  re size to get t
-00001870: 6865 2046 6f75 7269 6572 0a20 2020 2020  he Fourier.     
-00001880: 2020 2073 7061 6365 2063 616c 6962 7261     space calibra
-00001890: 7469 6f6e 2c20 7768 6963 6820 6973 2073  tion, which is s
-000018a0: 746f 7265 6420 6173 2074 6865 2060 696e  tored as the `in
-000018b0: 7665 7273 6560 2061 7474 7269 6275 7465  verse` attribute
-000018c0: 0a20 2020 2020 2020 2029 0272 0100 0000  .        ).r....
-000018d0: 7227 0000 0072 2400 0000 7226 0000 0072  r'...r$...r&...r
-000018e0: 2800 0000 7229 0000 007a 0331 2f6d 722c  (...r)...z.1/mr,
-000018f0: 0000 0072 2700 0000 da01 6b72 2e00 0000  ...r'.....kr....
-00001900: 4e29 1972 1700 0000 da04 6d65 616e 720d  N).r......meanr.
-00001910: 0000 005a 0463 6265 6472 1000 0000 da04  ...Z.cbedr......
-00001920: 7574 696c 5a0c 736f 6265 6c5f 6369 7263  utilZ.sobel_circ
-00001930: 6c65 da06 6265 616d 5f78 da06 6265 616d  le..beam_x..beam
-00001940: 5f79 5a06 6265 616d 5f72 7213 0000 0072  _yZ.beam_rr....r
-00001950: 1200 0000 da07 696e 7665 7273 6572 3a00  ......inverser:.
-00001960: 0000 723b 0000 0072 3d00 0000 723e 0000  ..r;...r=...r>..
-00001970: 0072 3f00 0000 5a14 5349 5f4c 454e 4754  .r?...Z.SI_LENGT
-00001980: 485f 5245 4349 5052 4f43 414c 7240 0000  H_RECIPROCALr@..
-00001990: 0072 4100 0000 7242 0000 0072 4300 0000  .rA...rB...rC...
-000019a0: 7244 0000 0072 2500 0000 2904 721a 0000  rD...r%...).r...
-000019b0: 0072 4b00 0000 5a0a 7368 6f77 5f69 6d61  .rK...Z.show_ima
-000019c0: 6765 724d 0000 0072 1c00 0000 721c 0000  gerM...r....r...
-000019d0: 0072 1d00 0000 da08 6765 745f 6362 6564  .r......get_cbed
-000019e0: a800 0000 7318 0000 0000 0f12 011a 0114  ....s...........
-000019f0: 0104 010c 0110 0112 0106 0106 0106 010e  ................
-00001a00: 017a 1361 746f 6d69 635f 6470 632e 6765  .z.atomic_dpc.ge
+00001090: 00fa 3762 7569 6c64 2f62 6469 7374 2e6c  ..7build/bdist.l
+000010a0: 696e 7578 2d78 3836 5f36 342f 6567 672f  inux-x86_64/egg/
+000010b0: 7374 656d 746f 6f6c 2f64 7063 2f61 746f  stemtool/dpc/ato
+000010c0: 6d69 635f 6470 632e 7079 da08 5f5f 696e  mic_dpc.py..__in
+000010d0: 6974 5f5f 6300 0000 7324 0000 0006 0c06  it__c...s$......
+000010e0: 0106 010a 010a 0102 0106 ff0a 0306 0106  ................
+000010f0: 0106 0104 0104 0114 0216 0102 ff1a 020a  ................
+00001100: fd7a 1361 746f 6d69 635f 6470 632e 5f5f  .z.atomic_dpc.__
+00001110: 696e 6974 5f5f a902 e914 0000 00e9 0a00  init__..........
+00001120: 0000 6302 0000 0000 0000 0000 0000 0005  ..c.............
+00001130: 0000 0006 0000 0043 0000 0073 5601 0000  .......C...sV...
+00001140: 7400 6a01 7c00 6a02 6401 6402 8d02 7c00  t.j.|.j.d.d...|.
+00001150: 5f03 7404 7400 a005 7400 a006 7c01 a101  _.t.t...t...|...
+00001160: a101 8301 7d02 7407 6a08 7c01 6403 8d01  ....}.t.j.|.d...
+00001170: 0100 7407 a009 6404 6405 6404 a103 0100  ..t...d.d.d.....
+00001180: 7407 6a0a 7c00 6a0b 6406 6407 8d02 0100  t.j.|.j.d.d.....
+00001190: 740c a00d 7c00 6a0e 6408 1b00 6409 a102  t...|.j.d...d...
+000011a0: 7d03 640a 7c03 5f0f 640b 7c03 5f10 640c  }.d.|._.d.|._.d.
+000011b0: 7c03 5f11 7407 a012 a100 a013 7c03 a101  |._.t.......|...
+000011c0: 0100 7407 a014 640d a101 0100 7415 6a16  ..t...d.....t.j.
+000011d0: 640e 7417 7c02 640f 8d01 6410 6411 6412  d.t.|.d...d.d.d.
+000011e0: 8d04 7d04 7c04 6a18 a019 6413 a101 0100  ..}.|.j...d.....
+000011f0: 7407 a012 a100 a013 7c04 a101 0100 7407  t.......|.....t.
+00001200: a009 6404 6405 6405 a103 0100 7407 6a0a  ..d.d.d.....t.j.
+00001210: 7c00 6a03 6406 6407 8d02 0100 740c a00d  |.j.d.d.....t...
+00001220: 7c00 6a0e 6408 1b00 6409 a102 7d03 640a  |.j.d...d...}.d.
+00001230: 7c03 5f0f 640b 7c03 5f10 640c 7c03 5f11  |._.d.|._.d.|._.
+00001240: 7407 a012 a100 a013 7c03 a101 0100 7407  t.......|.....t.
+00001250: a014 640d a101 0100 7415 6a16 6414 7417  ..d.....t.j.d.t.
+00001260: 7c02 640f 8d01 6410 6411 6412 8d04 7d04  |.d...d.d.d...}.
+00001270: 7c04 6a18 a019 6413 a101 0100 7407 a012  |.j...d.....t...
+00001280: a100 a013 7c04 a101 0100 7407 a01a a100  ....|.....t.....
+00001290: 0100 6415 5300 2916 612c 0100 000a 2020  ..d.S.).a,....  
+000012a0: 2020 2020 2020 5468 6520 4144 462d 5354        The ADF-ST
+000012b0: 454d 2069 6d61 6765 2069 7320 616c 7265  EM image is alre
+000012c0: 6164 7920 6c6f 6164 6564 2c20 7768 696c  ady loaded, whil
+000012d0: 6520 7468 6520 6064 6174 615f 6266 600a  e the `data_bf`.
+000012e0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+000012f0: 6520 6973 206f 6274 6169 6e65 6420 6279  e is obtained by
+00001300: 2073 756d 6d69 6e67 2075 7020 7468 6520   summing up the 
+00001310: 3444 2d53 5445 4d20 6461 7461 7365 7420  4D-STEM dataset 
+00001320: 616c 6f6e 6720 6974 2773 0a20 2020 2020  along it's.     
+00001330: 2020 2046 6f75 7269 6572 2064 696d 656e     Fourier dimen
+00001340: 7369 6f6e 732e 2054 6869 7320 6973 2061  sions. This is a
+00001350: 6c73 6f20 6120 6772 6561 7420 6368 6563  lso a great chec
+00001360: 6b70 6f69 6e74 2074 6f20 7365 6520 7768  kpoint to see wh
+00001370: 6574 6865 720a 2020 2020 2020 2020 7468  ether.        th
+00001380: 6520 4144 462d 5354 454d 2061 6e64 2074  e ADF-STEM and t
+00001390: 6865 2042 462d 5354 454d 2069 6d61 6765  he BF-STEM image
+000013a0: 7320 6172 6520 7468 6520 696e 7665 7273  s are the invers
+000013b0: 6520 6f66 2065 6163 6820 6f74 6865 722e  e of each other.
+000013c0: 0a20 2020 2020 2020 2029 02e9 ffff ffff  .        )......
+000013d0: e9fe ffff ffa9 01da 0461 7869 73a9 015a  .........axis..Z
+000013e0: 0766 6967 7369 7a65 e901 0000 0072 0b00  .figsize.....r..
+000013f0: 0000 da07 696e 6665 726e 6fa9 01da 0463  ....inferno....c
+00001400: 6d61 7072 0a00 0000 da02 6e6d fa0b 6c6f  mapr......nm..lo
+00001410: 7765 7220 7269 6768 7472 0100 0000 da01  wer rightr......
+00001420: 77da 036f 6666 7a08 4144 462d 5354 454d  w..offz.ADF-STEM
+00001430: a901 da04 7369 7a65 54fa 0a6c 6f77 6572  ....sizeT..lower
+00001440: 206c 6566 74a9 03da 0470 726f 705a 0766   left....propZ.f
+00001450: 7261 6d65 6f6e da03 6c6f 63fa 2072 6f75  rameon..loc. rou
+00001460: 6e64 2c20 7061 643d 302e 2c20 726f 756e  nd, pad=0., roun
+00001470: 6469 6e67 5f73 697a 653d 302e 327a 0e53  ding_size=0.2z.S
+00001480: 756d 6d65 6420 3444 2d53 5445 4d4e 291b  ummed 4D-STEMN).
+00001490: 7217 0000 00da 0373 756d 720d 0000 005a  r......sumr....Z
+000014a0: 0764 6174 615f 6266 da03 696e 74da 0461  .data_bf..int..a
+000014b0: 6d61 78da 0761 7361 7272 6179 da03 706c  max..asarray..pl
+000014c0: 74da 0666 6967 7572 65da 0773 7562 706c  t..figure..subpl
+000014d0: 6f74 da06 696d 7368 6f77 720c 0000 00da  ot..imshowr.....
+000014e0: 046d 7073 73da 0853 6361 6c65 4261 7272  .mpss..ScaleBarr
+000014f0: 0e00 0000 da08 6c6f 6361 7469 6f6e da09  ......location..
+00001500: 626f 785f 616c 7068 61da 0563 6f6c 6f72  box_alpha..color
+00001510: da03 6763 61da 0a61 6464 5f61 7274 6973  ..gca..add_artis
+00001520: 7472 2500 0000 da06 6d70 6c6f 6666 da0c  tr%.....mploff..
+00001530: 416e 6368 6f72 6564 5465 7874 da04 6469  AnchoredText..di
+00001540: 6374 da05 7061 7463 68da 0c73 6574 5f62  ct..patch..set_b
+00001550: 6f78 7374 796c 65da 0c74 6967 6874 5f6c  oxstyle..tight_l
+00001560: 6179 6f75 7429 0572 1a00 0000 da06 696d  ayout).r......im
+00001570: 7369 7a65 da08 666f 6e74 7369 7a65 da08  size..fontsize..
+00001580: 7363 616c 6562 6172 da02 6174 721c 0000  scalebar..atr...
+00001590: 0072 1c00 0000 721d 0000 00da 0b73 686f  .r....r......sho
+000015a0: 775f 4144 465f 4246 8100 0000 733c 0000  w_ADF_BF....s<..
+000015b0: 0012 0714 010c 010e 0110 0112 0106 0106  ................
+000015c0: 0106 010e 010a 0104 010e 0106 ff0c 030e  ................
+000015d0: 010e 0210 0112 0106 0106 0106 010e 010a  ................
+000015e0: 0104 010e 0106 ff0c 030e 010c 017a 1661  .............z.a
+000015f0: 746f 6d69 635f 6470 632e 7368 6f77 5f41  tomic_dpc.show_A
+00001600: 4446 5f42 46a9 02e9 0f00 0000 7251 0000  DF_BF.......rQ..
+00001610: 0046 6303 0000 0000 0000 0000 0000 0004  .Fc.............
+00001620: 0000 0005 0000 0043 0000 0073 a400 0000  .......C...s....
+00001630: 7400 6a01 7c00 6a02 6401 6402 8d02 7c00  t.j.|.j.d.d...|.
+00001640: 5f03 7404 6a05 a006 7c00 6a03 a101 5c03  _.t.j...|.j...\.
+00001650: 7c00 5f07 7c00 5f08 7c00 5f09 7c00 6a0a  |._.|._.|._.|.j.
+00001660: 7c00 6a09 7c00 6a0b 1400 1b00 7c00 5f0c  |.j.|.j.....|._.
+00001670: 7c02 7250 740d 6a0e 7c01 6403 8d01 0100  |.rPt.j.|.d.....
+00001680: 740d 6a0f 7c00 6a03 6404 6405 8d02 0100  t.j.|.j.d.d.....
+00001690: 7410 a011 7c00 6a0c 6406 7410 6a12 a103  t...|.j.d.t.j...
+000016a0: 7d03 6407 7c03 5f13 6408 7c03 5f14 6409  }.d.|._.d.|._.d.
+000016b0: 7c03 5f15 740d a016 a100 a017 7c03 a101  |._.t.......|...
+000016c0: 0100 740d a018 640a a101 0100 640b 5300  ..t...d.....d.S.
+000016d0: 640b 5300 290c 61ec 0100 000a 2020 2020  d.S.).a.....    
+000016e0: 2020 2020 5765 2063 616c 6375 6c61 7465      We calculate
+000016f0: 2074 6865 206d 6561 6e20 4342 4544 2070   the mean CBED p
+00001700: 6174 7465 726e 2062 7920 6176 6572 6167  attern by averag
+00001710: 696e 6720 7468 6520 466f 7572 6965 7220  ing the Fourier 
+00001720: 6461 7461 2c20 746f 0a20 2020 2020 2020  data, to.       
+00001730: 2067 6574 2074 6865 206f 626a 6563 7420   get the object 
+00001740: 6174 7472 6962 7574 6520 6063 6265 6460  attribute `cbed`
+00001750: 2e20 5765 2066 6974 2074 6869 7320 7769  . We fit this wi
+00001760: 7468 2061 2063 6972 636c 6520 6675 6e63  th a circle func
+00001770: 7469 6f6e 2074 6f0a 2020 2020 2020 2020  tion to.        
+00001780: 6f62 7461 696e 2074 6865 206f 626a 6563  obtain the objec
+00001790: 7420 6174 7472 6962 7574 6573 3a0a 0a20  t attributes:.. 
+000017a0: 2020 2020 2020 2060 6265 616d 5f78 603a         `beam_x`:
+000017b0: 2078 2d63 6f6f 7264 696e 6174 6573 206f   x-coordinates o
+000017c0: 6620 7468 6520 6369 7263 6c65 0a0a 2020  f the circle..  
+000017d0: 2020 2020 2020 6062 6561 6d5f 7960 3a20        `beam_y`: 
+000017e0: 792d 636f 6f72 6469 6e61 7465 7320 6f66  y-coordinates of
+000017f0: 2074 6865 2063 6972 636c 650a 0a20 2020   the circle..   
+00001800: 2020 2020 2060 6265 616d 5f72 603a 2072       `beam_r`: r
+00001810: 6164 6975 7320 6f66 2074 6865 2063 6972  adius of the cir
+00001820: 636c 650a 0a20 2020 2020 2020 2057 6520  cle..        We 
+00001830: 7573 6520 7468 6520 6361 6c63 756c 6174  use the calculat
+00001840: 6564 2072 6164 6975 7320 616e 6420 7468  ed radius and th
+00001850: 6520 6b6e 6f77 6e20 6170 6572 7475 7265  e known aperture
+00001860: 2073 697a 6520 746f 2067 6574 2074 6865   size to get the
+00001870: 2046 6f75 7269 6572 0a20 2020 2020 2020   Fourier.       
+00001880: 2073 7061 6365 2063 616c 6962 7261 7469   space calibrati
+00001890: 6f6e 2c20 7768 6963 6820 6973 2073 746f  on, which is sto
+000018a0: 7265 6420 6173 2074 6865 2060 696e 7665  red as the `inve
+000018b0: 7273 6560 2061 7474 7269 6275 7465 0a20  rse` attribute. 
+000018c0: 2020 2020 2020 2029 0272 0100 0000 7227         ).r....r'
+000018d0: 0000 0072 2400 0000 7226 0000 0072 2800  ...r$...r&...r(.
+000018e0: 0000 7229 0000 007a 0331 2f6d 722c 0000  ..r)...z.1/mr,..
+000018f0: 0072 2700 0000 da01 6b72 2e00 0000 4e29  .r'.....kr....N)
+00001900: 1972 1700 0000 da04 6d65 616e 720d 0000  .r......meanr...
+00001910: 005a 0463 6265 6472 1000 0000 da04 7574  .Z.cbedr......ut
+00001920: 696c 5a0c 736f 6265 6c5f 6369 7263 6c65  ilZ.sobel_circle
+00001930: da06 6265 616d 5f78 da06 6265 616d 5f79  ..beam_x..beam_y
+00001940: 5a06 6265 616d 5f72 7213 0000 0072 1200  Z.beam_rr....r..
+00001950: 0000 da07 696e 7665 7273 6572 3a00 0000  ....inverser:...
+00001960: 723b 0000 0072 3d00 0000 723e 0000 0072  r;...r=...r>...r
+00001970: 3f00 0000 5a14 5349 5f4c 454e 4754 485f  ?...Z.SI_LENGTH_
+00001980: 5245 4349 5052 4f43 414c 7240 0000 0072  RECIPROCALr@...r
+00001990: 4100 0000 7242 0000 0072 4300 0000 7244  A...rB...rC...rD
+000019a0: 0000 0072 2500 0000 2904 721a 0000 0072  ...r%...).r....r
+000019b0: 4b00 0000 5a0a 7368 6f77 5f69 6d61 6765  K...Z.show_image
+000019c0: 724d 0000 0072 1c00 0000 721c 0000 0072  rM...r....r....r
+000019d0: 1d00 0000 da08 6765 745f 6362 6564 a800  ......get_cbed..
+000019e0: 0000 731a 0000 0012 0f1a 0114 0104 010c  ..s.............
+000019f0: 0110 0112 0106 0106 0106 010e 010e 0104  ................
+00001a00: f87a 1361 746f 6d69 635f 6470 632e 6765  .z.atomic_dpc.ge
 00001a10: 745f 6362 6564 a902 e91e 0000 00e9 1100  t_cbed..........
 00001a20: 0000 5463 0300 0000 0000 0000 0000 0000  ..Tc............
-00001a30: 1500 0000 0900 0000 4300 0000 7318 0400  ........C...s...
+00001a30: 1500 0000 0900 0000 4300 0000 7316 0400  ........C...s...
 00001a40: 0074 006a 0164 017c 006a 026a 0364 0219  .t.j.d.|.j.j.d..
 00001a50: 0085 0264 017c 006a 026a 0364 0319 0085  ...d.|.j.j.d....
 00001a60: 0266 0219 005c 027d 037d 0474 006a 0164  .f...\.}.}.t.j.d
 00001a70: 017c 006a 026a 0364 0119 0085 0264 017c  .|.j.j.d.....d.|
 00001a80: 006a 026a 0364 0419 0085 0266 0219 005c  .j.j.d.....f...\
 00001a90: 027d 057d 0674 00a0 047c 05a1 017d 0574  .}.}.t...|...}.t
 00001aa0: 00a0 047c 06a1 017d 0674 006a 057c 006a  ...|...}.t.j.|.j
 00001ab0: 026a 0364 0164 0585 0219 0074 006a 0664  .j.d.d.....t.j.d
 00001ac0: 068d 027c 005f 0774 006a 057c 006a 026a  ...|._.t.j.|.j.j
 00001ad0: 0364 0164 0585 0219 0074 006a 0664 068d  .d.d.....t.j.d..
 00001ae0: 027c 005f 0874 0974 0a7c 0583 0183 0144  .|._.t.t.|.....D
-00001af0: 005d 9a7d 077c 006a 027c 057c 0719 007c  .].}.|.j.|.|...|
+00001af0: 005d 4d7d 077c 006a 027c 057c 0719 007c  .]M}.|.j.|.|...|
 00001b00: 067c 0719 0064 0764 0785 0264 0764 0785  .|...d.d...d.d..
 00001b10: 0266 0419 007d 087c 006a 0b74 00a0 0c74  .f...}.|.j.t...t
 00001b20: 00a0 0d7c 037c 08a1 02a1 0174 00a0 0c7c  ...|.|.....t...|
 00001b30: 08a1 011b 007c 006a 0e18 0014 007c 006a  .....|.j.....|.j
 00001b40: 077c 057c 0719 007c 067c 0719 0066 023c  .|.|...|.|...f.<
 00001b50: 007c 006a 0b74 00a0 0c74 00a0 0d7c 047c  .|.j.t...t...|.|
 00001b60: 08a1 02a1 0174 00a0 0c7c 08a1 011b 007c  .....t...|.....|
 00001b70: 006a 0f18 0014 007c 006a 087c 057c 0719  .j.....|.j.|.|..
-00001b80: 007c 067c 0719 0066 023c 0071 b07c 0290  .|.|...f.<.q.|..
-00001b90: 0172 7a7c 006a 0774 00a0 107c 006a 07a1  .rz|.j.t...|.j..
-00001ba0: 0118 007c 005f 077c 006a 0874 00a0 107c  ...|._.|.j.t...|
-00001bb0: 006a 08a1 0118 007c 005f 0874 00a0 1174  .j.....|._.t...t
-00001bc0: 00a0 1274 006a 137c 006a 087c 006a 0766  ...t.j.|.j.|.j.f
-00001bd0: 0264 0464 088d 02a1 01a1 0164 091b 007d  .d.d.......d...}
-00001be0: 0974 1464 0a74 00a0 1174 00a0 157c 01a1  .t.d.t...t...|..
-00001bf0: 01a1 0114 0083 017d 0a64 0b7c 0a64 0c9c  .......}.d.|.d..
-00001c00: 027d 0b74 166a 177c 0164 0d8d 0101 0074  .}.t.j.|.d.....t
-00001c10: 18a0 197c 0164 0419 007c 0164 0119 00a1  ...|.d...|.d....
-00001c20: 027d 0c74 16a0 1a7c 0c64 0164 0e85 0264  .}.t...|.d.d...d
-00001c30: 0164 0e85 0266 0219 00a1 017d 0d74 16a0  .d...f.....}.t..
-00001c40: 1a7c 0c64 0164 0e85 0264 0e64 0f85 0266  .|.d.d...d.d...f
-00001c50: 0219 00a1 017d 0e74 16a0 1a7c 0c64 0e64  .....}.t...|.d.d
-00001c60: 1085 0264 0764 0785 0266 0219 00a1 017d  ...d.d...f.....}
-00001c70: 0f7c 0d6a 1b7c 006a 0864 091b 007c 090b  .|.j.|.j.d...|..
-00001c80: 007c 0964 1164 128d 0401 0074 1ca0 1d7c  .|.d.d.....t...|
-00001c90: 006a 1e64 131b 0064 14a1 027d 1064 157c  .j.d...d...}.d.|
-00001ca0: 105f 1f64 047c 105f 2064 167c 105f 217c  ._.d.|._ d.|._!|
-00001cb0: 0da0 227c 10a1 0101 0074 236a 2464 1774  .."|.....t#j$d.t
-00001cc0: 257c 0a64 188d 0164 1964 1a64 1b8d 047d  %|.d...d.d.d...}
-00001cd0: 117c 116a 26a0 2764 1ca1 0101 007c 0da0  .|.j&.'d.....|..
-00001ce0: 227c 11a1 0101 007c 0da0 2864 1da1 0101  "|.....|..(d....
-00001cf0: 007c 0e6a 1b7c 006a 0764 091b 007c 090b  .|.j.|.j.d...|..
-00001d00: 007c 0964 1164 128d 0401 0074 1ca0 1d7c  .|.d.d.....t...|
-00001d10: 006a 1e64 131b 0064 14a1 027d 1064 157c  .j.d...d...}.d.|
-00001d20: 105f 1f64 047c 105f 2064 167c 105f 217c  ._.d.|._ d.|._!|
-00001d30: 0ea0 227c 10a1 0101 0074 236a 2464 1e74  .."|.....t#j$d.t
-00001d40: 257c 0a64 188d 0164 1964 1a64 1b8d 047d  %|.d...d.d.d...}
-00001d50: 117c 116a 26a0 2764 1ca1 0101 007c 0ea0  .|.j&.'d.....|..
-00001d60: 227c 11a1 0101 007c 0ea0 2864 1da1 0101  "|.....|..(d....
-00001d70: 0074 006a 2964 1f74 006a 0664 068d 027d  .t.j)d.t.j.d...}
-00001d80: 1274 0964 2083 0144 005d 227d 0774 00a0  .t.d ..D.]"}.t..
-00001d90: 2a7c 090b 007c 0964 13a1 037c 127c 0764  *|...|.d...|.|.d
-00001da0: 0764 0785 0266 023c 0090 0371 487c 0f6a  .d...f.<...qH|.j
-00001db0: 1b7c 1264 1164 218d 0201 007c 0f6a 2ba0  .|.d.d!....|.j+.
-00001dc0: 2c64 22a1 0101 0074 00a0 2a64 0164 1364  ,d"....t..*d.d.d
-00001dd0: 23a1 037d 137c 0fa0 2d7c 13a1 0101 007c  #..}.|..-|.....|
-00001de0: 0fa0 2e74 00a0 2f74 00a0 2a7c 090b 007c  ...t../t..*|...|
-00001df0: 0964 23a1 0364 05a1 02a1 0101 0064 2444  .d#..d.......d$D
-00001e00: 005d 267d 147c 0f6a 307c 1419 00a0 3164  .]&}.|.j0|....1d
-00001e10: 05a1 0101 007c 0f6a 307c 1419 00a0 3264  .....|.j0|....2d
-00001e20: 25a1 0101 0090 0371 c07c 0f6a 336a 3464  %......q.|.j3j4d
-00001e30: 0564 2664 2764 2064 288d 0401 007c 0f6a  .d&d'd d(....|.j
-00001e40: 3564 2a69 007c 0ba4 018e 0101 0074 16a0  5d*i.|.......t..
-00001e50: 36a1 0001 0064 0753 0029 2b61 0001 0000  6....d.S.)+a....
-00001e60: 0a20 2020 2020 2020 2054 6869 7320 6361  .        This ca
-00001e70: 6c63 756c 6174 6573 2074 6865 2069 6e69  lculates the ini
-00001e80: 7469 616c 2044 5043 2063 656e 7465 7220  tial DPC center 
-00001e90: 6f66 206d 6173 7320 7368 6966 7473 2062  of mass shifts b
-00001ea0: 7920 6d65 6173 7572 696e 670a 2020 2020  y measuring.    
-00001eb0: 2020 2020 7468 6520 6365 6e74 6572 206f      the center o
-00001ec0: 6620 6d61 7373 206f 6620 6561 6368 2069  f mass of each i
-00001ed0: 6d61 6765 2069 6e20 7468 6520 3444 2d53  mage in the 4D-S
-00001ee0: 5445 4d20 6461 7461 7365 742c 2061 6e64  TEM dataset, and
-00001ef0: 2074 6865 6e0a 2020 2020 2020 2020 636f   then.        co
-00001f00: 6d70 6172 696e 6720 7468 6174 2063 656e  mparing that cen
-00001f10: 7465 7220 6f66 206d 6173 7320 7769 7468  ter of mass with
-00001f20: 2074 6865 2061 7665 7261 6765 2064 6973   the average dis
-00001f30: 6b20 6365 6e74 6572 206f 6620 7468 650a  k center of the.
-00001f40: 2020 2020 2020 2020 656e 7469 7265 2064          entire d
-00001f50: 6174 6173 6574 2e0a 2020 2020 2020 2020  ataset..        
-00001f60: 7201 0000 0072 2200 0000 7223 0000 0072  r....r"...r#...r
-00001f70: 2700 0000 720b 0000 00a9 01da 0564 7479  '...r........dty
-00001f80: 7065 4e72 2400 0000 e900 ca9a 3be7 cdcc  peNr$.......;...
-00001f90: cccc cccc ec3f da04 626f 6c64 a902 da06  .....?..bold....
-00001fa0: 7765 6967 6874 7230 0000 0072 2600 0000  weightr0...r&...
-00001fb0: 7251 0000 0072 5a00 0000 725b 0000 00da  rQ...rZ...r[....
-00001fc0: 0652 6442 755f 72a9 035a 0476 6d69 6e5a  .RdBu_r..Z.vminZ
-00001fd0: 0476 6d61 7872 2a00 0000 720a 0000 0072  .vmaxr*...r....r
-00001fe0: 2b00 0000 722c 0000 0072 5200 0000 7a14  +...r,...rR...z.
-00001ff0: 5368 6966 7420 696e 2058 2064 6972 6563  Shift in X direc
-00002000: 7469 6f6e 722f 0000 0054 fa0a 7570 7065  tionr/...T..uppe
-00002010: 7220 6c65 6674 7232 0000 00fa 2272 6f75  r leftr2...."rou
-00002020: 6e64 2c20 7061 643d 2030 2e2c 2072 6f75  nd, pad= 0., rou
-00002030: 6e64 696e 675f 7369 7a65 3d20 302e 3272  nding_size= 0.2r
-00002040: 2e00 0000 7a14 5368 6966 7420 696e 2059  ....z.Shift in Y
-00002050: 2064 6972 6563 7469 6f6e a902 7221 0000   direction..r!..
-00002060: 0072 0a00 0000 7221 0000 0072 2900 0000  .r....r!...r)...
-00002070: 46e9 0800 0000 a904 da03 746f 705a 0662  F.........topZ.b
-00002080: 6f74 746f 6dda 046c 6566 74da 0572 6967  ottom..left..rig
-00002090: 6874 da05 626c 6163 6be9 0600 0000 da03  ht..black.......
-000020a0: 6f75 74a9 04da 0577 6964 7468 da06 6c65  out....width..le
-000020b0: 6e67 7468 da09 6469 7265 6374 696f 6eda  ngth..direction.
-000020c0: 0370 6164 fa2e 245c 6d61 7468 726d 7b42  .pad..$\mathrm{B
-000020d0: 6561 6d5c 3a20 5368 6966 745c 3a20 5c6c  eam\: Shift\: \l
-000020e0: 6566 7428 6e6d 5e7b 2d31 7d5c 7269 6768  eft(nm^{-1}\righ
-000020f0: 7429 7d24 2901 7275 0000 0029 3772 1700  t)}$).ru...)7r..
-00002100: 0000 da05 6d67 7269 6472 0d00 0000 da05  ....mgridr......
-00002110: 7368 6170 655a 0572 6176 656c da05 656d  shapeZ.ravel..em
-00002120: 7074 79da 0566 6c6f 6174 da04 5943 6f6d  pty..float..YCom
-00002130: da04 5843 6f6d da05 7261 6e67 65da 036c  ..XCom..range..l
-00002140: 656e 7257 0000 0072 3600 0000 5a08 6d75  enrW...r6...Z.mu
-00002150: 6c74 6970 6c79 7256 0000 0072 5500 0000  ltiplyrV...rU...
-00002160: 7253 0000 0072 3800 0000 da03 6162 73da  rS...r8.....abs.
-00002170: 0b63 6f6e 6361 7465 6e61 7465 7237 0000  .concatenater7..
-00002180: 0072 3900 0000 723a 0000 0072 3b00 0000  .r9...r:...r;...
-00002190: da04 6d70 6773 da08 4772 6964 5370 6563  ..mpgs..GridSpec
-000021a0: 723c 0000 0072 3d00 0000 723e 0000 0072  r<...r=...r>...r
-000021b0: 3f00 0000 720e 0000 0072 4000 0000 7241  ?...r....r@...rA
-000021c0: 0000 0072 4200 0000 7244 0000 0072 4500  ...rB...rD...rE.
-000021d0: 0000 7246 0000 0072 4700 0000 7248 0000  ..rF...rG...rH..
-000021e0: 0072 4900 0000 7225 0000 00da 057a 6572  .rI...r%.....zer
-000021f0: 6f73 da08 6c69 6e73 7061 6365 da05 7961  os..linspace..ya
-00002200: 7869 73da 0b73 6574 5f76 6973 6962 6c65  xis..set_visible
-00002210: da0a 7365 745f 7874 6963 6b73 da0f 7365  ..set_xticks..se
-00002220: 745f 7874 6963 6b6c 6162 656c 73da 0572  t_xticklabels..r
-00002230: 6f75 6e64 da06 7370 696e 6573 da0d 7365  ound..spines..se
-00002240: 745f 6c69 6e65 7769 6474 68da 0973 6574  t_linewidth..set
-00002250: 5f63 6f6c 6f72 da05 7861 7869 73da 0f73  _color..xaxis..s
-00002260: 6574 5f74 6963 6b5f 7061 7261 6d73 da09  et_tick_params..
-00002270: 7365 745f 7469 746c 6572 4a00 0000 2915  set_titlerJ...).
-00002280: 721a 0000 0072 4b00 0000 da09 6e6f 726d  r....rK.....norm
-00002290: 616c 697a 655a 0271 71da 0270 70da 0279  alizeZ.qq..pp..y
-000022a0: 795a 0278 78da 0269 69da 0770 6174 7465  yZ.xx..ii..patte
-000022b0: 726e da02 766d 724c 0000 00da 0773 635f  rn..vmrL.....sc_
-000022c0: 666f 6e74 da02 6773 da03 6178 31da 0361  font..gs..ax1..a
-000022d0: 7832 da03 6178 3372 4d00 0000 724e 0000  x2..ax3rM...rN..
-000022e0: 00da 0273 62da 0278 3172 2500 0000 721c  ...sb..x1r%...r.
-000022f0: 0000 0072 1c00 0000 721d 0000 00da 0b69  ...r....r......i
-00002300: 6e69 7469 616c 5f64 7063 c400 0000 738e  nitial_dpc....s.
-00002310: 0000 0000 072a 012a 010a 010a 011e 011e  .....*.*........
-00002320: 0110 0122 0104 0120 ff16 0304 0120 ff18  ..."... ..... ..
-00002330: 0306 0114 0114 0220 0102 ff04 0318 010a  ....... ........
-00002340: 020c 0114 011a 011a 011a 021a 0112 0106  ................
-00002350: 0106 0106 010a 0104 0102 0108 0102 0102  ................
-00002360: fc06 060c 010a 010a 021a 0112 0106 0106  ................
-00002370: 0106 010a 0104 0102 0108 0102 0102 fc06  ................
-00002380: 060c 010a 010a 0210 010c 0120 010e 010c  ........... ....
-00002390: 010e 010a 011e 0108 0110 0114 0114 0110  ................
-000023a0: 017a 1661 746f 6d69 635f 6470 632e 696e  .z.atomic_dpc.in
-000023b0: 6974 6961 6c5f 6470 6363 0200 0000 0000  itial_dpcc......
-000023c0: 0000 0000 0000 1b00 0000 0900 0000 4300  ..............C.
-000023d0: 0000 7394 0400 0074 006a 0164 0174 0264  ..s....t.j.d.t.d
-000023e0: 028d 027d 0264 037c 0264 0464 0185 023c  ...}.d.|.d.d...<
-000023f0: 0074 006a 0164 017c 006a 036a 0464 028d  .t.j.d.|.j.j.d..
-00002400: 027d 0374 006a 0164 017c 006a 056a 0464  .}.t.j.d.|.j.j.d
-00002410: 028d 027d 0464 057d 0574 0664 0483 0144  ...}.d.}.t.d...D
-00002420: 005d e87d 067c 0264 047c 0614 0019 007d  .].}.|.d.|.....}
-00002430: 077c 0772 6c74 00a0 077c 006a 03a1 017d  .|.rlt...|.j...}
-00002440: 086e 067c 006a 037d 0874 086a 09a0 0a7c  .n.|.j.}.t.j...|
-00002450: 006a 037c 006a 05a1 025c 027d 097d 0a74  .j.|.j...\.}.}.t
-00002460: 0b6a 0c74 086a 096a 0d7c 057c 097c 0a66  .j.t.j.j.|.|.|.f
-00002470: 0264 068d 037d 0b7c 0b6a 0e7d 0c7c 0c64  .d...}.|.j.}.|.d
-00002480: 0518 007d 0d7c 0c64 0517 007d 0e74 00a0  ...}.|.d...}.t..
-00002490: 0f74 086a 09a0 107c 087c 006a 057c 0da1  .t.j...|.|.j.|..
-000024a0: 037c 006a 1114 00a1 017c 0374 1264 047c  .|.j.....|.t.d.|
-000024b0: 0614 0083 013c 0074 00a0 0f74 086a 09a0  .....<.t...t.j..
-000024c0: 107c 087c 006a 057c 0ea1 037c 006a 1114  .|.|.j.|...|.j..
-000024d0: 00a1 017c 0374 1264 047c 0614 0064 0717  ...|.t.d.|...d..
-000024e0: 0083 013c 007c 0d7c 0474 1264 047c 0614  ...<.|.|.t.d.|..
-000024f0: 0083 013c 007c 0e7c 0474 1264 047c 0614  ...<.|.|.t.d.|..
-00002500: 0064 0717 0083 013c 0071 4a64 087c 047c  .d.....<.qJd.|.|
-00002510: 0374 00a0 137c 03a1 016b 0219 0064 0919  .t...|...k...d..
-00002520: 0014 007c 005f 147c 027c 0374 00a0 137c  ...|._.|.|.t...|
-00002530: 03a1 016b 0219 0064 0919 007c 005f 157c  ...k...d...|._.|
-00002540: 006a 1590 0172 7e74 00a0 167c 006a 03a1  .j...r~t...|.j..
-00002550: 017d 086e 0c74 00a0 177c 006a 03a1 017d  .}.n.t...|.j...}
-00002560: 0874 086a 09a0 0a7c 087c 006a 05a1 025c  .t.j...|.|.j...\
-00002570: 027d 097d 0a74 086a 09a0 187c 097c 0a7c  .}.}.t.j...|.|.|
-00002580: 006a 1474 006a 1964 0a1b 0014 0018 00a1  .j.t.j.d........
-00002590: 025c 027c 005f 1a7c 005f 1b74 00a0 1c74  .\.|._.|._.t...t
-000025a0: 00a0 1d74 006a 1e7c 006a 1a7c 006a 1b66  ...t.j.|.j.|.j.f
-000025b0: 0264 0764 0b8d 02a1 01a1 0164 0c1b 007d  .d.d.......d...}
-000025c0: 0f74 1264 0d74 00a0 1f7c 01a1 0114 0083  .t.d.t...|......
-000025d0: 017d 1064 0e7c 1064 0f9c 027d 1174 206a  .}.d.|.d...}.t j
-000025e0: 217c 0164 108d 0101 0074 22a0 237c 0164  !|.d.....t".#|.d
-000025f0: 0719 007c 0164 0919 00a1 027d 1274 20a0  ...|.d.....}.t .
-00002600: 247c 1264 0964 1185 0264 0964 1185 0266  $|.d.d...d.d...f
-00002610: 0219 00a1 017d 1374 20a0 247c 1264 0964  .....}.t .$|.d.d
-00002620: 1185 0264 1164 1285 0266 0219 00a1 017d  ...d.d...f.....}
-00002630: 1474 20a0 247c 1264 1164 1385 0264 1464  .t .$|.d.d...d.d
-00002640: 1485 0266 0219 00a1 017d 157c 136a 257c  ...f.....}.|.j%|
-00002650: 006a 1a64 0c1b 007c 0f0b 007c 0f64 1564  .j.d...|...|.d.d
-00002660: 168d 0401 0074 26a0 277c 006a 2864 171b  .....t&.'|.j(d..
-00002670: 0064 18a1 027d 1664 197c 165f 2964 077c  .d...}.d.|._)d.|
-00002680: 165f 2a64 1a7c 165f 2b7c 13a0 2c7c 16a1  ._*d.|._+|..,|..
-00002690: 0101 0074 2d6a 2e64 1b74 2f7c 1064 1c8d  ...t-j.d.t/|.d..
-000026a0: 0164 0364 1d64 1e8d 047d 177c 176a 30a0  .d.d.d...}.|.j0.
-000026b0: 3164 1fa1 0101 007c 13a0 2c7c 17a1 0101  1d.....|..,|....
-000026c0: 007c 13a0 3264 20a1 0101 007c 146a 257c  .|..2d ....|.j%|
-000026d0: 006a 1b64 0c1b 007c 0f0b 007c 0f64 1564  .j.d...|...|.d.d
-000026e0: 168d 0401 0074 26a0 277c 006a 2864 171b  .....t&.'|.j(d..
-000026f0: 0064 18a1 027d 1664 197c 165f 2964 077c  .d...}.d.|._)d.|
-00002700: 165f 2a64 1a7c 165f 2b7c 14a0 2c7c 16a1  ._*d.|._+|..,|..
-00002710: 0101 0074 2d6a 2e64 2174 2f7c 1064 1c8d  ...t-j.d!t/|.d..
-00002720: 0164 0364 1d64 1e8d 047d 177c 176a 30a0  .d.d.d...}.|.j0.
-00002730: 3164 1fa1 0101 007c 14a0 2c7c 17a1 0101  1d.....|..,|....
-00002740: 007c 14a0 3264 20a1 0101 0074 006a 0164  .|..2d ....t.j.d
-00002750: 2274 006a 3364 028d 027d 1874 0664 2383  "t.j3d...}.t.d#.
-00002760: 0144 005d 227d 0674 00a0 347c 0f0b 007c  .D.]"}.t..4|...|
-00002770: 0f64 17a1 037c 187c 0664 1464 1485 0266  .d...|.|.d.d...f
-00002780: 023c 0090 0371 8c7c 156a 257c 1864 1564  .<...q.|.j%|.d.d
-00002790: 248d 0201 007c 156a 35a0 3664 25a1 0101  $....|.j5.6d%...
-000027a0: 0074 00a0 3464 0964 1764 26a1 037d 197c  .t..4d.d.d&..}.|
-000027b0: 15a0 377c 19a1 0101 007c 15a0 3874 00a0  ..7|.....|..8t..
-000027c0: 3974 00a0 347c 0f0b 007c 0f64 26a1 0364  9t..4|...|.d&..d
-000027d0: 04a1 02a1 0101 0064 2744 005d 267d 1a7c  .......d'D.]&}.|
-000027e0: 156a 3a7c 1a19 00a0 3b64 04a1 0101 007c  .j:|....;d.....|
-000027f0: 156a 3a7c 1a19 00a0 3c64 28a1 0101 0090  .j:|....<d(.....
-00002800: 0471 047c 156a 3d6a 3e64 0464 2964 2a64  .q.|.j=j>d.d)d*d
-00002810: 2364 2b8d 0401 007c 156a 3f64 2d69 007c  #d+....|.j?d-i.|
-00002820: 11a4 018e 0101 0074 20a0 40a1 0001 007c  .......t .@....|
-00002830: 006a 417c 006a 1a14 007c 005f 427c 006a  .jA|.j...|._B|.j
-00002840: 417c 006a 1b14 007c 005f 437c 006a 427c  A|.j...|._C|.jB|
-00002850: 006a 441b 007c 005f 457c 006a 437c 006a  .jD..|._E|.jC|.j
-00002860: 441b 007c 005f 4664 1453 0029 2e61 f501  D..|._Fd.S.).a..
-00002870: 0000 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00002880: 636f 7272 6563 7473 2066 6f72 2074 6865  corrects for the
-00002890: 2072 6f74 6174 696f 6e20 616e 676c 6520   rotation angle 
-000028a0: 6f66 2074 6865 2070 6978 656c 6c61 7465  of the pixellate
-000028b0: 6420 6465 7465 6374 6f72 0a20 2020 2020  d detector.     
-000028c0: 2020 2077 6974 6820 7265 7370 6563 7420     with respect 
-000028d0: 746f 2074 6865 206f 7074 6963 2061 7869  to the optic axi
-000028e0: 732e 2053 6f6d 6520 7069 7865 6c6c 6174  s. Some pixellat
-000028f0: 6564 2064 6574 6563 746f 7273 2066 6c69  ed detectors fli
-00002900: 700a 2020 2020 2020 2020 7468 6520 696d  p.        the im
-00002910: 6167 652c 2061 6e64 2069 6620 7468 6572  age, and if ther
-00002920: 6520 6973 2061 6e20 696d 6167 6520 666c  e is an image fl
-00002930: 6970 2c20 6974 2063 6f72 7265 6374 7320  ip, it corrects 
-00002940: 6974 2074 6f6f 2e0a 2020 2020 2020 2020  it too..        
-00002950: 5468 6520 6d65 6368 616e 6973 6d20 6f66  The mechanism of
-00002960: 2074 6869 732c 2077 6520 636f 6d70 6172   this, we compar
-00002970: 6520 7468 6520 6772 6164 6965 6e74 206f  e the gradient o
-00002980: 6620 626f 7468 2074 6865 2066 6c69 7070  f both the flipp
-00002990: 6564 0a20 2020 2020 2020 2061 6e64 2074  ed.        and t
-000029a0: 6865 2075 6e66 6c69 7070 6564 2044 5043  he unflipped DPC
-000029b0: 2064 6174 6120 6174 206d 756c 7469 706c   data at multipl
-000029c0: 6520 726f 7461 7469 6f6e 2061 6e67 6c65  e rotation angle
-000029d0: 732c 2061 6e64 2074 6865 2076 616c 7565  s, and the value
-000029e0: 0a20 2020 2020 2020 2074 6861 7420 6861  .        that ha
-000029f0: 7320 7468 6520 6869 6768 6573 7420 7265  s the highest re
-00002a00: 6c61 7469 7665 2063 6f6e 7472 6173 7420  lative contrast 
-00002a10: 7769 7468 2074 6865 2041 4446 2d53 5445  with the ADF-STE
-00002a20: 4d20 696d 6167 6520 6973 2074 616b 656e  M image is taken
-00002a30: 0a20 2020 2020 2020 2061 7320 3930 2064  .        as 90 d
-00002a40: 6567 7265 6573 2066 726f 6d20 7468 6520  egrees from the 
-00002a50: 636f 7272 6563 7420 616e 676c 652e 0a20  correct angle.. 
-00002a60: 2020 2020 2020 20e9 0400 0000 725c 0000         .....r\..
-00002a70: 0054 720b 0000 00e9 5a00 0000 2901 da04  .Tr.....Z...)...
-00002a80: 6172 6773 7227 0000 0072 2200 0000 7201  argsr'...r"...r.
-00002a90: 0000 00e9 b400 0000 7224 0000 0072 5e00  ........r$...r^.
-00002aa0: 0000 725f 0000 0072 6000 0000 7261 0000  ..r_...r`...ra..
-00002ab0: 0072 2600 0000 7251 0000 0072 5a00 0000  .r&...rQ...rZ...
-00002ac0: 725b 0000 004e 7263 0000 0072 6400 0000  r[...Nrc...rd...
-00002ad0: 720a 0000 0072 2b00 0000 722c 0000 0072  r....r+...r,...r
-00002ae0: 5200 0000 7a1e 436f 7272 6563 7465 6420  R...z.Corrected 
-00002af0: 7368 6966 7420 696e 2058 2064 6972 6563  shift in X direc
-00002b00: 7469 6f6e 722f 0000 0072 6500 0000 7232  tionr/...re...r2
-00002b10: 0000 0072 6600 0000 722e 0000 007a 1e43  ...rf...r....z.C
-00002b20: 6f72 7265 6374 6564 2073 6869 6674 2069  orrected shift i
-00002b30: 6e20 5920 6469 7265 6374 696f 6e72 6700  n Y directionrg.
-00002b40: 0000 7221 0000 0072 2900 0000 4672 6800  ..r!...r)...Frh.
-00002b50: 0000 7269 0000 0072 6d00 0000 726e 0000  ..ri...rm...rn..
-00002b60: 0072 6f00 0000 7270 0000 0072 7500 0000  .ro...rp...ru...
-00002b70: 2901 7275 0000 0029 4772 1700 0000 7282  ).ru...)Gr....r.
-00002b80: 0000 00da 0462 6f6f 6c72 7b00 0000 725d  .....boolr{...r]
-00002b90: 0000 0072 7a00 0000 727c 0000 005a 0466  ...rz...r|...Z.f
-00002ba0: 6c69 7072 1000 0000 da03 6470 635a 0863  lipr......dpcZ.c
-00002bb0: 6172 7432 706f 6cda 0373 696f 5a08 6d69  art2pol..sioZ.mi
-00002bc0: 6e69 6d69 7a65 5a09 616e 676c 655f 6675  nimizeZ.angle_fu
-00002bd0: 6eda 0178 7236 0000 005a 0a63 6861 7267  n..xr6...Z.charg
-00002be0: 655f 6470 6372 0c00 0000 7237 0000 005a  e_dpcr....r7...Z
-00002bf0: 0461 6d69 6e5a 0561 6e67 6c65 5a0a 6669  .aminZ.angleZ.fi
-00002c00: 6e61 6c5f 666c 6970 5a06 666c 6970 6c72  nal_flipZ.fliplr
-00002c10: da04 636f 7079 5a08 706f 6c32 6361 7274  ..copyZ.pol2cart
-00002c20: 7218 0000 00da 0558 436f 6d43 da05 5943  r......XComC..YC
-00002c30: 6f6d 4372 3800 0000 727e 0000 0072 7f00  omCr8...r~...r..
-00002c40: 0000 da03 6d61 7872 3a00 0000 723b 0000  ....maxr:...r;..
-00002c50: 0072 8000 0000 7281 0000 0072 3c00 0000  .r....r....r<...
-00002c60: 723d 0000 0072 3e00 0000 723f 0000 0072  r=...r>...r?...r
-00002c70: 0e00 0000 7240 0000 0072 4100 0000 7242  ....r@...rA...rB
-00002c80: 0000 0072 4400 0000 7245 0000 0072 4600  ...rD...rE...rF.
-00002c90: 0000 7247 0000 0072 4800 0000 7249 0000  ..rG...rH...rI..
-00002ca0: 0072 2500 0000 7279 0000 0072 8300 0000  .r%...ry...r....
-00002cb0: 7284 0000 0072 8500 0000 7286 0000 0072  r....r....r....r
-00002cc0: 8700 0000 7288 0000 0072 8900 0000 728a  ....r....r....r.
-00002cd0: 0000 0072 8b00 0000 728c 0000 0072 8d00  ...r....r....r..
-00002ce0: 0000 728e 0000 0072 4a00 0000 7214 0000  ..r....rJ...r...
-00002cf0: 005a 094d 6f6d 656e 7475 6d58 5a09 4d6f  .Z.MomentumXZ.Mo
-00002d00: 6d65 6e74 756d 5972 1600 0000 da08 655f  mentumYr......e_
-00002d10: 6669 656c 6458 da08 655f 6669 656c 6459  fieldX..e_fieldY
-00002d20: 291b 721a 0000 0072 4b00 0000 5a05 666c  ).r....rK...Z.fl
-00002d30: 6970 735a 0863 6867 5f73 756d 735a 0661  ipsZ.chg_sumsZ.a
-00002d40: 6e67 6c65 735a 0278 3072 9200 0000 5a07  nglesZ.x0r....Z.
-00002d50: 746f 5f66 6c69 705a 0578 6470 6366 5a07  to_flipZ.xdpcfZ.
-00002d60: 7268 6f5f 6470 635a 0770 6869 5f64 7063  rho_dpcZ.phi_dpc
-00002d70: 72a4 0000 005a 056d 696e 5f78 5a04 736f  r....Z.min_xZ.so
-00002d80: 6c31 5a04 736f 6c32 7294 0000 0072 4c00  l1Z.sol2r....rL.
-00002d90: 0000 7295 0000 0072 9600 0000 7297 0000  ..r....r....r...
-00002da0: 0072 9800 0000 7299 0000 0072 4d00 0000  .r....r....rM...
-00002db0: 724e 0000 0072 9a00 0000 729b 0000 0072  rN...r....r....r
-00002dc0: 2500 0000 721c 0000 0072 1c00 0000 721d  %...r....r....r.
-00002dd0: 0000 00da 0b63 6f72 7265 6374 5f64 7063  .....correct_dpc
-00002de0: 1801 0000 73b4 0000 0000 0a0e 010c 0112  ....s...........
-00002df0: 0112 0104 010c 010c 0104 010e 0206 0116  ................
-00002e00: 0118 0106 0108 0108 0104 0116 ff10 0304  ................
-00002e10: 0116 ff14 0310 0116 011c 0118 0208 010e  ................
-00002e20: 020c 0114 0106 0114 ff0c 0420 0102 ff04  ........... ....
-00002e30: 0312 010a 020c 0214 011a 011a 011a 021a  ................
-00002e40: 0112 0106 0106 0106 010a 0104 0102 0108  ................
-00002e50: 0102 0102 fc06 060c 010a 010a 021a 0112  ................
-00002e60: 0106 0106 0106 010a 0104 0102 0108 0102  ................
-00002e70: 0102 fc06 060c 010a 010a 0210 010c 0120  ............... 
-00002e80: 010e 010c 010e 010a 011e 0108 0110 0114  ................
-00002e90: 0114 0110 0108 020e 010e 020e 017a 1661  .............z.a
-00002ea0: 746f 6d69 635f 6470 632e 636f 7272 6563  tomic_dpc.correc
-00002eb0: 745f 6470 63a9 0272 5100 0000 725b 0000  t_dpc..rQ...r[..
-00002ec0: 0063 0200 0000 0000 0000 0000 0000 0f00  .c..............
-00002ed0: 0000 0900 0000 4300 0000 7352 0200 0074  ......C...sR...t
-00002ee0: 0074 01a0 0274 01a0 037c 01a1 01a1 0183  .t...t...|......
-00002ef0: 017d 0274 01a0 047c 006a 05a1 0164 0119  .}.t...|.j...d..
-00002f00: 0074 01a0 047c 006a 06a1 0164 0219 0017  .t...|.j...d....
-00002f10: 007c 006a 0764 0314 0014 007c 006a 0814  .|.j.d.....|.j..
-00002f20: 0064 0414 0074 016a 0914 007c 005f 0a74  .d...t.j...|._.t
-00002f30: 01a0 0274 01a0 0b7c 006a 0aa1 01a1 017d  ...t...|.j.....}
-00002f40: 0374 0c6a 0d7c 0164 058d 0101 0074 0064  .t.j.|.d.....t.d
-00002f50: 0674 01a0 0e7c 01a1 0114 0083 017d 0264  .t...|.......}.d
-00002f60: 077c 0264 089c 027d 0474 0fa0 107c 0164  .|.d...}.t...|.d
-00002f70: 0119 007c 0164 0219 00a1 027d 0574 0ca0  ...|.d.....}.t..
-00002f80: 117c 0564 0264 0985 0264 0264 0985 0266  .|.d.d...d.d...f
-00002f90: 0219 00a1 017d 0674 0ca0 117c 0564 0964  .....}.t...|.d.d
-00002fa0: 0a85 0264 0b64 0b85 0266 0219 00a1 017d  ...d.d...f.....}
-00002fb0: 077c 066a 127c 006a 0a7c 030b 007c 0364  .|.j.|.j.|...|.d
-00002fc0: 0c64 0d8d 0401 0074 13a0 147c 006a 0764  .d.....t...|.j.d
-00002fd0: 0e1b 0064 0fa1 027d 0864 107c 085f 1564  ...d...}.d.|._.d
-00002fe0: 017c 085f 1664 117c 085f 177c 06a0 187c  .|._.d.|._.|...|
-00002ff0: 08a1 0101 007c 06a0 1964 12a1 0101 0074  .....|...d.....t
-00003000: 1a6a 1b64 1374 1c7c 0264 148d 0164 1564  .j.d.t.|.d...d.d
-00003010: 1664 178d 047d 097c 096a 1da0 1e64 18a1  .d...}.|.j...d..
-00003020: 0101 007c 06a0 187c 09a1 0101 0074 016a  ...|...|.....t.j
-00003030: 1f64 1974 016a 2064 1a8d 027d 0a74 2164  .d.t.j d...}.t!d
-00003040: 1b83 0144 005d 2e7d 0b74 01a0 227c 037c  ...D.].}.t.."|.|
-00003050: 006a 231b 007c 037c 006a 231b 000b 0064  .j#..|.|.j#....d
-00003060: 0ea1 037c 0a7c 0b64 0b64 0b85 0266 023c  ...|.|.d.d...f.<
-00003070: 0090 0171 667c 076a 127c 0a64 0c64 1c8d  ...qf|.j.|.d.d..
-00003080: 0201 007c 076a 24a0 2564 1da1 0101 0064  ...|.j$.%d.....d
-00003090: 1e7d 0c74 01a0 2264 0264 0e7c 0ca1 037d  .}.t.."d.d.|...}
-000030a0: 0d7c 07a0 267c 0da1 0101 007c 07a0 2774  .|..&|.....|..'t
-000030b0: 01a0 2874 01a0 227c 037c 006a 231b 007c  ..(t.."|.|.j#..|
-000030c0: 037c 006a 231b 000b 007c 0ca1 0364 1fa1  .|.j#....|...d..
-000030d0: 02a1 0101 0064 2044 005d 267d 0e7c 076a  .....d D.]&}.|.j
-000030e0: 297c 0e19 00a0 2a64 21a1 0101 007c 076a  )|....*d!....|.j
-000030f0: 297c 0e19 00a0 2b64 22a1 0101 0090 0171  )|....+d"......q
-00003100: fa7c 076a 2c6a 2d64 2164 1f64 2364 1b64  .|.j,j-d!d.d#d.d
-00003110: 248d 0401 007c 076a 2e64 2669 007c 04a4  $....|.j.d&i.|..
-00003120: 018e 0101 0074 0ca0 2fa1 0001 0064 0b53  .....t../....d.S
-00003130: 0029 277a 920a 2020 2020 2020 2020 5765  .)'z..        We
-00003140: 2063 616c 6375 6c61 7465 2074 6865 2063   calculate the c
-00003150: 6861 7267 6520 6672 6f6d 2074 6865 2063  harge from the c
-00003160: 6f72 7265 6374 6564 2044 5043 0a20 2020  orrected DPC.   
-00003170: 2020 2020 2063 656e 7465 7220 6f66 206d       center of m
-00003180: 6173 7320 6461 7461 7365 7473 2e20 5468  ass datasets. Th
-00003190: 6973 2069 7320 646f 6e65 2074 6872 6f75  is is done throu
-000031a0: 6768 0a20 2020 2020 2020 2050 6f69 7373  gh.        Poiss
-000031b0: 6f6e 2773 2065 7175 6174 696f 6e2e 0a20  on's equation.. 
-000031c0: 2020 2020 2020 2072 2700 0000 7201 0000         r'...r...
-000031d0: 0067 11ea 2d81 9997 713d 729d 0000 0072  .g..-...q=r....r
-000031e0: 2600 0000 725f 0000 0072 6000 0000 7261  &...r_...r`...ra
-000031f0: 0000 0072 5100 0000 725b 0000 004e 7263  ...rQ...r[...Nrc
-00003200: 0000 0072 6400 0000 720a 0000 0072 2b00  ...rd...r....r+.
-00003210: 0000 722c 0000 0072 5200 0000 722e 0000  ..r,...rR...r...
-00003220: 007a 0f43 6861 7267 6520 6672 6f6d 2044  .z.Charge from D
-00003230: 5043 722f 0000 0054 7231 0000 0072 3200  PCr/...Tr1...r2.
-00003240: 0000 fa1e 726f 756e 642c 7061 643d 302e  ....round,pad=0.
-00003250: 2c72 6f75 6e64 696e 675f 7369 7a65 3d30  ,rounding_size=0
-00003260: 2e32 7267 0000 0072 5c00 0000 7221 0000  .2rg...r\...r!..
-00003270: 0072 2900 0000 46e9 0700 0000 726e 0000  .r)...F.....rn..
-00003280: 0072 6900 0000 720b 0000 0072 6d00 0000  .ri...r....rm...
-00003290: 726f 0000 0072 7000 0000 fa31 245c 6d61  ro...rp....1$\ma
-000032a0: 7468 726d 7b43 6861 7267 655c 3a20 4465  thrm{Charge\: De
-000032b0: 6e73 6974 795c 3a20 5c6c 6566 7428 655e  nsity\: \left(e^
-000032c0: 7b2d 7d20 5c72 6967 6874 297d 2429 0172  {-} \right)}$).r
-000032d0: af00 0000 2930 7237 0000 0072 1700 0000  ....)0r7...r....
-000032e0: 7238 0000 0072 3900 0000 5a08 6772 6164  r8...r9...Z.grad
-000032f0: 6965 6e74 72a9 0000 0072 aa00 0000 720e  ientr....r....r.
-00003300: 0000 0072 1500 0000 7218 0000 005a 0663  ...r....r....Z.c
-00003310: 6861 7267 6572 7e00 0000 723a 0000 0072  harger~...r:...r
-00003320: 3b00 0000 72a8 0000 0072 8000 0000 7281  ;...r....r....r.
-00003330: 0000 0072 3c00 0000 723d 0000 0072 3e00  ...r<...r=...r>.
-00003340: 0000 723f 0000 0072 4000 0000 7241 0000  ..r?...r@...rA..
-00003350: 0072 4200 0000 7244 0000 0072 2500 0000  .rB...rD...r%...
-00003360: 7245 0000 0072 4600 0000 7247 0000 0072  rE...rF...rG...r
-00003370: 4800 0000 7249 0000 0072 8200 0000 7279  H...rI...r....ry
-00003380: 0000 0072 7c00 0000 7283 0000 0072 1600  ...r|...r....r..
-00003390: 0000 7284 0000 0072 8500 0000 7286 0000  ..r....r....r...
-000033a0: 0072 8700 0000 7288 0000 0072 8900 0000  .r....r....r....
-000033b0: 728a 0000 0072 8b00 0000 728c 0000 0072  r....r....r....r
-000033c0: 8d00 0000 728e 0000 0072 4a00 0000 290f  ....r....rJ...).
-000033d0: 721a 0000 0072 4b00 0000 724c 0000 00da  r....rK...rL....
-000033e0: 0263 6d72 9500 0000 7296 0000 0072 9700  .cmr....r....r..
-000033f0: 0000 7298 0000 0072 4d00 0000 724e 0000  ..r....rM...rN..
-00003400: 0072 9a00 0000 7292 0000 00da 096e 6f5f  .r....r......no_
-00003410: 6c61 6265 6c73 729b 0000 0072 2500 0000  labelsr....r%...
-00003420: 721c 0000 0072 1c00 0000 721d 0000 00da  r....r....r.....
-00003430: 0b73 686f 775f 6368 6172 6765 8801 0000  .show_charge....
-00003440: 7362 0000 0000 0614 051e 0108 ff02 0304  sb..............
-00003450: fc02 0502 fb02 0604 fa02 ff04 0912 010c  ................
-00003460: 0112 010a 0214 011a 011a 0216 0112 0106  ................
-00003470: 0106 0106 010a 010a 0104 010e ff06 030c  ................
-00003480: 010a 0210 010c 012c 010e 010c 0104 010e  .......,........
-00003490: 010a 0104 0104 011c ff02 ff04 0508 0110  ................
-000034a0: 0114 0114 0110 027a 1661 746f 6d69 635f  .......z.atomic_
-000034b0: 6470 632e 7368 6f77 5f63 6861 7267 6563  dpc.show_chargec
-000034c0: 0200 0000 0000 0000 0000 0000 0f00 0000  ................
-000034d0: 0900 0000 4300 0000 7334 0200 0074 0074  ....C...s4...t.t
-000034e0: 01a0 0274 01a0 037c 01a1 01a1 0183 017d  ...t...|.......}
-000034f0: 0274 046a 05a0 067c 006a 077c 006a 0814  .t.j...|.j.|.j..
-00003500: 007c 006a 097c 006a 0814 00a1 027c 005f  .|.j.|.j.....|._
-00003510: 0a7c 006a 0a7c 006a 0b1b 007c 005f 0c74  .|.j.|.j...|._.t
-00003520: 01a0 0274 01a0 0d7c 006a 0ca1 01a1 0164  ...t...|.j.....d
-00003530: 0114 007d 0374 0e6a 0f7c 0164 028d 0101  ...}.t.j.|.d....
-00003540: 0074 0064 0374 01a0 107c 01a1 0114 0083  .t.d.t...|......
-00003550: 017d 0264 047c 0264 059c 027d 0474 11a0  .}.d.|.d...}.t..
-00003560: 127c 0164 0619 007c 0164 0719 00a1 027d  .|.d...|.d.....}
-00003570: 0574 0ea0 137c 0564 0764 0885 0264 0764  .t...|.d.d...d.d
-00003580: 0885 0266 0219 00a1 017d 0674 0ea0 137c  ...f.....}.t...|
-00003590: 0564 0864 0985 0264 0a64 0a85 0266 0219  .d.d...d.d...f..
-000035a0: 00a1 017d 077c 066a 147c 006a 0c64 0114  ...}.|.j.|.j.d..
-000035b0: 007c 030b 007c 0364 0b64 0c8d 0401 0074  .|...|.d.d.....t
-000035c0: 15a0 167c 006a 1764 0d1b 0064 0ea1 027d  ...|.j.d...d...}
-000035d0: 0864 0f7c 085f 1864 067c 085f 1964 107c  .d.|._.d.|._.d.|
-000035e0: 085f 1a7c 06a0 1b7c 08a1 0101 007c 06a0  ._.|...|.....|..
-000035f0: 1c64 11a1 0101 0074 1d6a 1e64 1274 1f7c  .d.....t.j.d.t.|
-00003600: 0264 138d 0164 1464 1564 168d 047d 097c  .d...d.d.d...}.|
-00003610: 096a 20a0 2164 17a1 0101 007c 06a0 1b7c  .j .!d.....|...|
-00003620: 09a1 0101 0074 016a 2264 1874 016a 2364  .....t.j"d.t.j#d
-00003630: 198d 027d 0a74 2464 1a83 0144 005d 227d  ...}.t$d...D.]"}
-00003640: 0b74 01a0 257c 030b 007c 0364 0da1 037c  .t..%|...|.d...|
-00003650: 0a7c 0b64 0a64 0a85 0266 023c 0090 0171  .|.d.d...f.<...q
-00003660: 607c 076a 147c 0a64 0b64 1b8d 0201 007c  `|.j.|.d.d.....|
-00003670: 076a 26a0 2764 1ca1 0101 0064 1d7d 0c74  .j&.'d.....d.}.t
-00003680: 01a0 2564 0764 0d7c 0ca1 037d 0d7c 07a0  ..%d.d.|...}.|..
-00003690: 287c 0da1 0101 007c 07a0 2974 01a0 2a74  (|.....|..)t..*t
-000036a0: 01a0 257c 030b 007c 037c 0ca1 0364 1ea1  ..%|...|.|...d..
-000036b0: 02a1 0101 0064 1f44 005d 267d 0e7c 076a  .....d.D.]&}.|.j
-000036c0: 2b7c 0e19 00a0 2c64 20a1 0101 007c 076a  +|....,d ....|.j
-000036d0: 2b7c 0e19 00a0 2d64 21a1 0101 0090 0171  +|....-d!......q
-000036e0: dc7c 076a 2e6a 2f64 2064 1e64 2264 1a64  .|.j.j/d d.d"d.d
-000036f0: 238d 0401 007c 076a 3064 2569 007c 04a4  #....|.j0d%i.|..
-00003700: 018e 0101 0074 0ea0 31a1 0001 0064 0a53  .....t..1....d.S
-00003710: 0029 2661 2e02 0000 0a20 2020 2020 2020  .)&a.....       
-00003720: 2043 616c 6375 6c61 7465 2074 6865 2070   Calculate the p
-00003730: 726f 6a65 6374 6564 2070 6f74 656e 7469  rojected potenti
-00003740: 616c 2066 726f 6d20 7468 6520 4450 4320  al from the DPC 
-00003750: 6d65 6173 7572 656d 656e 7473 2e0a 2020  measurements..  
-00003760: 2020 2020 2020 5468 6973 2069 7320 6163        This is ac
-00003770: 636f 6d70 6c69 7368 6564 2062 7920 6361  complished by ca
-00003780: 6c63 756c 6174 696e 6720 7468 6520 7068  lculating the ph
-00003790: 6173 6520 7368 6966 7420 6974 6572 6174  ase shift iterat
-000037a0: 6976 656c 790a 2020 2020 2020 2020 6672  ively.        fr
-000037b0: 6f6d 2074 6865 206e 6f72 6d61 6c69 7a65  om the normalize
-000037c0: 6420 6365 6e74 6572 206f 6620 6d61 7373  d center of mass
-000037d0: 2073 6869 6674 732e 204e 6f72 6d61 6c69   shifts. Normali
-000037e0: 7a61 7469 6f6e 206d 6561 6e73 0a20 2020  zation means.   
-000037f0: 2020 2020 2063 616c 6375 6c61 7469 6e67       calculating
-00003800: 2043 4f4d 2073 6869 6674 7320 696e 2069   COM shifts in i
-00003810: 6e76 6572 7365 206c 656e 6774 6820 756e  nverse length un
-00003820: 6974 7320 616e 6420 7468 656e 206d 756c  its and then mul
-00003830: 7469 706c 7969 6e67 0a20 2020 2020 2020  tiplying.       
-00003840: 2074 6865 6d20 7769 7468 2074 6865 2065   them with the e
-00003850: 6c65 6374 726f 6e20 7761 7665 6c65 6e67  lectron waveleng
-00003860: 7468 2074 6f20 6765 7420 616e 2065 6c65  th to get an ele
-00003870: 6374 726f 6e20 696e 6465 7065 6e64 656e  ctron independen
-00003880: 740a 2020 2020 2020 2020 6d72 6164 2073  t.        mrad s
-00003890: 6869 6674 2c20 7768 6963 6820 6973 2075  hift, which is u
-000038a0: 7365 6420 746f 2067 656e 6572 6174 6520  sed to generate 
-000038b0: 7468 6520 7068 6173 652e 2054 6869 7320  the phase. This 
-000038c0: 7068 6173 6520 6973 0a20 2020 2020 2020  phase is.       
-000038d0: 2070 726f 706f 7274 696f 6e61 6c20 746f   proportional to
-000038e0: 2074 6865 2070 726f 6a65 6374 6564 2070   the projected p
-000038f0: 6f74 656e 7469 616c 2066 6f72 2077 6561  otential for wea
-00003900: 6b20 7068 6173 6520 6f62 6a65 6374 0a20  k phase object. 
-00003910: 2020 2020 2020 206d 6174 6572 6961 6c73         materials
-00003920: 2028 7769 7468 202a 6c6f 7473 2a20 6f66   (with *lots* of
-00003930: 2061 7373 756d 7074 696f 6e73 290a 2020   assumptions).  
-00003940: 2020 2020 2020 6c03 0000 0000 6417 2809        l.....d.(.
-00003950: 0072 2600 0000 725f 0000 0072 6000 0000  .r&...r_...r`...
-00003960: 7261 0000 0072 2700 0000 7201 0000 0072  ra...r'...r....r
-00003970: 5100 0000 725b 0000 004e 7263 0000 0072  Q...r[...Nrc...r
-00003980: 6400 0000 720a 0000 0072 2b00 0000 722c  d...r....r+...r,
-00003990: 0000 0072 5200 0000 722e 0000 007a 2d43  ...rR...r....z-C
-000039a0: 616c 6375 6c61 7465 6420 7072 6f6a 6563  alculated projec
-000039b0: 7465 6420 706f 7465 6e74 6961 6c20 6672  ted potential fr
-000039c0: 6f6d 2044 5043 2070 6861 7365 722f 0000  om DPC phaser/..
-000039d0: 0054 7231 0000 0072 3200 0000 72ad 0000  .Tr1...r2...r...
-000039e0: 0072 6700 0000 725c 0000 0072 2100 0000  .rg...r\...r!...
-000039f0: 7229 0000 0046 72ae 0000 0072 6e00 0000  r)...Fr....rn...
-00003a00: 7269 0000 0072 0b00 0000 726d 0000 0072  ri...r....rm...r
-00003a10: 6f00 0000 7270 0000 00f5 1900 0000 5072  o...rp........Pr
-00003a20: 6f6a 6563 7465 6420 506f 7465 6e74 6961  ojected Potentia
-00003a30: 6c20 2856 c385 2929 0172 b300 0000 2932  l (V..)).r....)2
-00003a40: 7237 0000 0072 1700 0000 7238 0000 0072  r7...r....r8...r
-00003a50: 3900 0000 7210 0000 0072 a200 0000 5a0d  9...r....r....Z.
-00003a60: 696e 7465 6772 6174 655f 6470 6372 a600  integrate_dpcr..
-00003a70: 0000 7212 0000 0072 a700 0000 5a05 7068  ..r....r....Z.ph
-00003a80: 6173 6572 1900 0000 5a09 706f 7465 6e74  aser....Z.potent
-00003a90: 6961 6c72 7e00 0000 723a 0000 0072 3b00  ialr~...r:...r;.
-00003aa0: 0000 72a8 0000 0072 8000 0000 7281 0000  ..r....r....r...
-00003ab0: 0072 3c00 0000 723d 0000 0072 3e00 0000  .r<...r=...r>...
-00003ac0: 723f 0000 0072 0e00 0000 7240 0000 0072  r?...r....r@...r
-00003ad0: 4100 0000 7242 0000 0072 4400 0000 7225  A...rB...rD...r%
-00003ae0: 0000 0072 4500 0000 7246 0000 0072 4700  ...rE...rF...rG.
-00003af0: 0000 7248 0000 0072 4900 0000 7282 0000  ..rH...rI...r...
-00003b00: 0072 7900 0000 727c 0000 0072 8300 0000  .ry...r|...r....
-00003b10: 7284 0000 0072 8500 0000 7286 0000 0072  r....r....r....r
-00003b20: 8700 0000 7288 0000 0072 8900 0000 728a  ....r....r....r.
-00003b30: 0000 0072 8b00 0000 728c 0000 0072 8d00  ...r....r....r..
-00003b40: 0000 728e 0000 0072 4a00 0000 290f 721a  ..r....rJ...).r.
-00003b50: 0000 0072 4b00 0000 724c 0000 00da 0270  ...rK...rL.....p
-00003b60: 6d72 9500 0000 7296 0000 0072 9700 0000  mr....r....r....
-00003b70: 7298 0000 0072 4d00 0000 724e 0000 0072  r....rM...rN...r
-00003b80: 9a00 0000 7292 0000 0072 b100 0000 729b  ....r....r....r.
-00003b90: 0000 0072 2500 0000 721c 0000 0072 1c00  ...r%...r....r..
-00003ba0: 0000 721d 0000 00da 0e73 686f 775f 706f  ..r......show_po
-00003bb0: 7465 6e74 6961 6cc5 0100 0073 5400 0000  tential....sT...
-00003bc0: 000b 1401 0601 14ff 0603 0e02 1601 0c01  ................
-00003bd0: 1201 0a02 1401 1a01 1a02 1a01 1201 0601  ................
-00003be0: 0601 0601 0a01 0a01 0401 0201 0801 0201  ................
-00003bf0: 02fc 0606 0c01 0a02 1001 0c01 2001 0e01  ............ ...
-00003c00: 0c01 0401 0e01 0a01 1e01 0801 1001 1401  ................
-00003c10: 1401 1002 7a19 6174 6f6d 6963 5f64 7063  ....z.atomic_dpc
-00003c20: 2e73 686f 775f 706f 7465 6e74 6961 6c72  .show_potentialr
-00003c30: 0100 0000 7227 0000 0072 0b00 0000 6305  ....r'...r....c.
-00003c40: 0000 0000 0000 0000 0000 0015 0000 0009  ................
-00003c50: 0000 0043 0000 0073 1003 0000 7400 7401  ...C...s....t.t.
-00003c60: a002 7401 a003 7c04 a101 a101 8301 7d05  ..t...|.......}.
-00003c70: 6401 7c05 6402 9c02 7d06 7404 6a05 6419  d.|.d...}.t.j.d.
-00003c80: 6900 7c06 a401 8e01 0100 7c00 6a06 6404  i.|.......|.j.d.
-00003c90: 7c00 6a07 1400 1700 7d07 7408 6a09 a00a  |.j.....}.t.j...
-00003ca0: 7c07 a101 7d08 7401 a003 7c00 6a06 6a0b  |...}.t...|.j.j.
-00003cb0: a101 7c01 1400 a00c 7400 a101 7d09 7401  ..|.....t...}.t.
-00003cc0: a003 7c00 6a06 6a0b a101 7c01 7c02 1700  ..|.j.j...|.|...
-00003cd0: 1400 a00c 7400 a101 7d0a 7401 6a0d 6405  ....t...}.t.j.d.
-00003ce0: 7c00 6a07 6a0b 6405 1900 8502 6405 7c00  |.j.j.d.....d.|.
-00003cf0: 6a06 6a0b 6406 1900 8502 6602 1900 5c02  j.j.d.....f...\.
-00003d00: 7d0b 7d0c 7c0b 7d0b 7c0c 7c09 6405 1900  }.}.|.}.|.|.d...
-00003d10: 7c0a 6405 1900 8502 7c09 6406 1900 7c0a  |.d.....|.d...|.
-00003d20: 6406 1900 8502 6602 1900 7d0d 7401 a00e  d.....f...}.t...
-00003d30: 7c0b 7c09 6405 1900 7c0a 6405 1900 8502  |.|.d...|.d.....
-00003d40: 7c09 6406 1900 7c0a 6406 1900 8502 6602  |.d...|.d.....f.
-00003d50: 1900 a101 7d0e 7c00 6a06 7c09 6405 1900  ....}.|.j.|.d...
-00003d60: 7c0a 6405 1900 8502 7c09 6406 1900 7c0a  |.d.....|.d...|.
-00003d70: 6406 1900 8502 6602 1900 7d0f 7c00 6a07  d.....f...}.|.j.
-00003d80: 7c09 6405 1900 7c0a 6405 1900 8502 7c09  |.d...|.d.....|.
-00003d90: 6406 1900 7c0a 6406 1900 8502 6602 1900  d...|.d.....f...
-00003da0: 7d10 7c08 7c09 6405 1900 7c0a 6405 1900  }.|.|.d...|.d...
-00003db0: 8502 7c09 6406 1900 7c0a 6406 1900 8502  ..|.d...|.d.....
-00003dc0: 6602 1900 7d11 7404 6a0f 6a10 7c09 6405  f...}.t.j.j.|.d.
-00003dd0: 6407 8502 1900 7c0a 6405 1900 7c09 6405  d.....|.d...|.d.
-00003de0: 1900 1800 7c0a 6406 1900 7c09 6406 1900  ....|.d...|.d...
-00003df0: 1800 6408 6409 640a 640b 8d06 7d12 7411  ..d.d.d.d...}.t.
-00003e00: 6a12 7c04 640c 8d01 0100 7411 a013 6406  j.|.d.....t...d.
-00003e10: 6407 6406 a103 0100 7411 a014 7c08 a101  d.d.....t...|...
-00003e20: 0100 7415 a016 7c00 6a17 640d a102 7d13  ..t...|.j.d...}.
-00003e30: 640e 7c13 5f18 6405 7c13 5f19 6409 7c13  d.|._.d.|._.d.|.
-00003e40: 5f1a 7411 a01b a100 a01c 7c13 a101 0100  _.t.......|.....
-00003e50: 7411 a01d 640f a101 0100 741e 6a1f 6410  t...d.....t.j.d.
-00003e60: 7420 7c05 6411 8d01 6412 6413 6414 8d04  t |.d...d.d.d...
-00003e70: 7d14 7c14 6a21 a022 6415 a101 0100 7411  }.|.j!."d.....t.
-00003e80: a01b a100 a01c 7c14 a101 0100 7411 a01b  ......|.....t...
-00003e90: a100 a023 7c12 a101 0100 7411 a013 6406  ...#|.....t...d.
-00003ea0: 6407 6407 a103 0100 7411 a014 7c11 a101  d.d.....t...|...
-00003eb0: 0100 7411 6a24 7c0d 6416 6416 7c03 8503  ..t.j$|.d.d.|...
-00003ec0: 6416 6416 7c03 8503 6602 1900 7c09 6406  d.d.|...f...|.d.
-00003ed0: 1900 1800 7c0e 6416 6416 7c03 8503 6416  ....|.d.d.|...d.
-00003ee0: 6416 7c03 8503 6602 1900 7c09 6405 1900  d.|...f...|.d...
-00003ef0: 1800 7c0f 6416 6416 7c03 8503 6416 6416  ..|.d.d.|...d.d.
-00003f00: 7c03 8503 6602 1900 7c10 6416 6416 7c03  |...f...|.d.d.|.
-00003f10: 8503 6416 6416 7c03 8503 6602 1900 6417  ..d.d.|...f...d.
-00003f20: 6409 6418 8d06 0100 7415 a016 7c00 6a17  d.d.....t...|.j.
-00003f30: 640d a102 7d13 640e 7c13 5f18 6405 7c13  d...}.d.|._.d.|.
-00003f40: 5f19 6409 7c13 5f1a 7411 a01b a100 a01c  _.d.|._.t.......
-00003f50: 7c13 a101 0100 7411 a01d 640f a101 0100  |.....t...d.....
-00003f60: 7411 a025 a100 0100 6416 5300 291a 6125  t..%....d.S.).a%
-00003f70: 0200 000a 2020 2020 2020 2020 5573 6520  ....        Use 
-00003f80: 7468 6973 2074 6f20 706c 6f74 2074 6865  this to plot the
-00003f90: 2063 6f72 7265 6374 6564 2044 5043 2063   corrected DPC c
-00003fa0: 656e 7465 7220 6f66 206d 6173 7320 7368  enter of mass sh
-00003fb0: 6966 7473 2e20 4966 206e 6f20 7661 7269  ifts. If no vari
-00003fc0: 6162 6c65 730a 2020 2020 2020 2020 6172  ables.        ar
-00003fd0: 6520 7061 7373 6564 2c20 7468 6520 6172  e passed, the ar
-00003fe0: 726f 7773 2061 7265 206f 7665 726c 6169  rows are overlai
-00003ff0: 6420 6f6e 2074 6865 2065 6e74 6972 6520  d on the entire 
-00004000: 696d 6167 652e 0a0a 2020 2020 2020 2020  image...        
-00004010: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00004020: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00004030: 2020 2020 2020 7374 6172 745f 6672 6163        start_frac
-00004040: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-00004050: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
-00004060: 2020 2020 2020 5468 6520 7374 6172 7469        The starti
-00004070: 6e67 2066 7261 6374 696f 6e20 6f66 2074  ng fraction of t
-00004080: 6865 2069 6d61 6765 2c20 7768 6572 6520  he image, where 
-00004090: 796f 7520 7769 6c6c 2063 7574 2066 726f  you will cut fro
-000040a0: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-000040b0: 2020 2020 2020 746f 2073 686f 7720 7468        to show th
-000040c0: 6520 6f76 6572 6c61 6964 2061 7272 6f77  e overlaid arrow
-000040d0: 732e 2044 6566 6175 6c74 2069 7320 300a  s. Default is 0.
-000040e0: 2020 2020 2020 2020 7374 6f70 5f66 7261          stop_fra
-000040f0: 633a 2020 666c 6f61 742c 206f 7074 696f  c:  float, optio
-00004100: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00004110: 2020 2020 2020 2020 5468 6520 656e 6469          The endi
-00004120: 6e67 2066 7261 6374 696f 6e20 6f66 2074  ng fraction of t
-00004130: 6865 2069 6d61 6765 2c20 7768 6572 6520  he image, where 
-00004140: 796f 7520 7769 6c6c 2063 7574 2066 726f  you will cut fro
-00004150: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-00004160: 2020 2020 2020 746f 2073 686f 7720 7468        to show th
-00004170: 6520 6f76 6572 6c61 6964 2061 7272 6f77  e overlaid arrow
-00004180: 732e 2044 6566 6175 6c74 2069 7320 310a  s. Default is 1.
-00004190: 2020 2020 2020 2020 7260 0000 0072 6100          r`...ra.
-000041a0: 0000 da04 666f 6e74 7900 0000 0000 0000  ....fonty.......
-000041b0: 0000 0000 0000 00f0 3f72 0100 0000 7227  ........?r....r'
-000041c0: 0000 0072 0b00 0000 6700 0000 0000 00f8  ...r....g.......
-000041d0: 3f72 2d00 0000 da04 6e6f 6e65 2903 5a09  ?r-.....none).Z.
-000041e0: 6c69 6e65 7769 6474 685a 0965 6467 6563  linewidthZ.edgec
-000041f0: 6f6c 6f72 5a09 6661 6365 636f 6c6f 7272  olorZ.facecolorr
-00004200: 2600 0000 72b4 0000 0072 2c00 0000 722e  &...r....r,...r.
-00004210: 0000 007a 1443 656e 7465 7220 6f66 204d  ...z.Center of M
-00004220: 6173 7320 5368 6966 7472 2f00 0000 5472  ass Shiftr/...Tr
-00004230: 3100 0000 7232 0000 0072 3500 0000 4e5a  1...r2...r5...NZ
-00004240: 036d 6964 2902 da05 7069 766f 7472 4200  .mid)...pivotrB.
-00004250: 0000 2901 72b6 0000 0029 2672 3700 0000  ..).r....)&r7...
-00004260: 7217 0000 0072 3800 0000 7239 0000 00da  r....r8...r9....
-00004270: 036d 706c da02 7263 72a6 0000 0072 a700  .mpl..rcr....r..
-00004280: 0000 7210 0000 0072 5400 0000 5a0c 6370  ..r....rT...Z.cp
-00004290: 5f69 6d61 6765 5f76 616c 7277 0000 005a  _image_valrw...Z
-000042a0: 0661 7374 7970 6572 7600 0000 5a06 666c  .astyperv...Z.fl
-000042b0: 6970 7564 5a07 7061 7463 6865 735a 0952  ipudZ.patchesZ.R
-000042c0: 6563 7461 6e67 6c65 723a 0000 0072 3b00  ectangler:...r;.
-000042d0: 0000 723c 0000 0072 3d00 0000 723e 0000  ..r<...r=...r>..
-000042e0: 0072 3f00 0000 720e 0000 0072 4000 0000  .r?...r....r@...
-000042f0: 7241 0000 0072 4200 0000 7243 0000 0072  rA...rB...rC...r
-00004300: 4400 0000 7225 0000 0072 4500 0000 7246  D...r%...rE...rF
-00004310: 0000 0072 4700 0000 7248 0000 0072 4900  ...rG...rH...rI.
-00004320: 0000 5a09 6164 645f 7061 7463 685a 0671  ..Z.add_patchZ.q
-00004330: 7569 7665 7272 4a00 0000 2915 721a 0000  uiverrJ...).r...
-00004340: 005a 0a73 7461 7274 5f66 7261 635a 0973  .Z.start_fracZ.s
-00004350: 697a 655f 6672 6163 da04 736b 6970 724b  ize_frac..skiprK
-00004360: 0000 0072 4c00 0000 7295 0000 00da 0263  ...rL...r......c
-00004370: 635a 0863 635f 636f 6c6f 725a 0863 7574  cZ.cc_colorZ.cut
-00004380: 7374 6172 745a 0863 7574 5f73 746f 705a  startZ.cut_stopZ
-00004390: 0479 706f 735a 0478 706f 735a 0478 6375  .yposZ.xposZ.xcu
-000043a0: 745a 0479 6375 745a 0264 785a 0264 795a  tZ.ycutZ.dxZ.dyZ
-000043b0: 0663 635f 6375 745a 076f 7665 726c 6179  .cc_cutZ.overlay
-000043c0: 724d 0000 0072 4e00 0000 721c 0000 0072  rM...rN...r....r
-000043d0: 1c00 0000 721d 0000 00da 0e70 6c6f 745f  ....r......plot_
-000043e0: 636f 6c6f 725f 6470 6300 0200 0073 7200  color_dpc....sr.
-000043f0: 0000 000e 1401 0a01 1001 1001 0c01 1801  ................
-00004400: 1c01 2a01 0401 2401 2a01 2601 2601 2402  ..*...$.*.&.&.$.
-00004410: 0601 0a01 0e01 0e01 0201 0201 02fa 0609  ................
-00004420: 0c01 0e01 0a01 0e01 0601 0601 0601 0e01  ................
-00004430: 0a01 0401 0201 0801 0201 02fc 0606 0c01  ................
-00004440: 0e01 0e02 0e01 0a01 0401 1e01 1e01 1601  ................
-00004450: 1601 0201 02fa 0608 0e01 0601 0601 0601  ................
-00004460: 0e01 0a01 7a19 6174 6f6d 6963 5f64 7063  ....z.atomic_dpc
-00004470: 2e70 6c6f 745f 636f 6c6f 725f 6470 634e  .plot_color_dpcN
-00004480: 2901 721f 0000 0029 0272 5000 0000 4629  ).r....).rP...F)
-00004490: 0272 5900 0000 5429 0172 5900 0000 2901  .rY...T).rY...).
-000044a0: 72ac 0000 0029 0172 ac00 0000 2904 7201  r....).r....).r.
-000044b0: 0000 0072 2700 0000 720b 0000 0072 1f00  ...r'...r....r..
-000044c0: 0000 290c da08 5f5f 6e61 6d65 5f5f da0a  ..)...__name__..
-000044d0: 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f 7175  __module__..__qu
-000044e0: 616c 6e61 6d65 5f5f da07 5f5f 646f 635f  alname__..__doc_
-000044f0: 5f72 1e00 0000 724f 0000 0072 5800 0000  _r....rO...rX...
-00004500: 729c 0000 0072 ab00 0000 72b2 0000 0072  r....r....r....r
-00004510: b500 0000 72bd 0000 0072 1c00 0000 721c  ....r....r....r.
-00004520: 0000 0072 1c00 0000 721d 0000 0072 0900  ...r....r....r..
-00004530: 0000 0f00 0000 7312 0000 0008 0104 5308  ......s.......S.
-00004540: 1e0a 270a 1c0a 540a 700a 3d0a 3b72 0900  ..'...T.p.=.;r..
-00004550: 0000 2926 5a0d 7363 6970 792e 6e64 696d  ..)&Z.scipy.ndim
-00004560: 6167 655a 076e 6469 6d61 6765 5a04 7363  ageZ.ndimageZ.sc
-00004570: 6e64 5a0e 7363 6970 792e 6f70 7469 6d69  ndZ.scipy.optimi
-00004580: 7a65 da08 6f70 7469 6d69 7a65 72a3 0000  ze..optimizer...
-00004590: 005a 056e 756d 7079 7217 0000 00da 0873  .Z.numpyr......s
-000045a0: 7465 6d74 6f6f 6c72 1000 0000 5a11 6d61  temtoolr....Z.ma
-000045b0: 7470 6c6f 746c 6962 2e70 7970 6c6f 745a  tplotlib.pyplotZ
-000045c0: 0670 7970 6c6f 7472 3a00 0000 5a10 6d61  .pyplotr:...Z.ma
-000045d0: 7470 6c6f 746c 6962 2e69 6d61 6765 da05  tplotlib.image..
-000045e0: 696d 6167 655a 056d 7069 6d67 5a1c 6d61  imageZ.mpimgZ.ma
-000045f0: 7470 6c6f 746c 6962 5f73 6361 6c65 6261  tplotlib_scaleba
-00004600: 722e 7363 616c 6562 6172 724d 0000 0072  r.scalebarrM...r
-00004610: 3e00 0000 5a14 6d61 7470 6c6f 746c 6962  >...Z.matplotlib
-00004620: 2e6f 6666 7365 7462 6f78 5a09 6f66 6673  .offsetboxZ.offs
-00004630: 6574 626f 7872 4500 0000 5a13 6d61 7470  etboxrE...Z.matp
-00004640: 6c6f 746c 6962 2e67 7269 6473 7065 635a  lotlib.gridspecZ
-00004650: 0867 7269 6473 7065 6372 8000 0000 5a0a  .gridspecr....Z.
-00004660: 6d61 7470 6c6f 746c 6962 72b9 0000 00da  matplotlibr.....
-00004670: 0674 7970 696e 6772 0200 0000 7203 0000  .typingr....r...
-00004680: 005a 086e 7074 7970 696e 6772 0400 0000  .Z.nptypingr....
-00004690: 7205 0000 0072 0600 0000 7207 0000 0072  r....r....r....r
-000046a0: 0800 0000 da06 6f62 6a65 6374 7209 0000  ......objectr...
-000046b0: 0072 1c00 0000 721c 0000 0072 1c00 0000  .r....r....r....
-000046c0: 721d 0000 00da 083c 6d6f 6475 6c65 3e01  r......<module>.
-000046d0: 0000 0073 1800 0000 0c01 0c01 0801 0801  ...s............
-000046e0: 0c01 0c01 0c01 0c01 0c01 0801 1001 1c03  ................
+00001b80: 007c 067c 0719 0066 023c 0071 587c 0272  .|.|...f.<.qX|.r
+00001b90: bc7c 006a 0774 00a0 107c 006a 07a1 0118  .|.j.t...|.j....
+00001ba0: 007c 005f 077c 006a 0874 00a0 107c 006a  .|._.|.j.t...|.j
+00001bb0: 08a1 0118 007c 005f 0874 00a0 1174 00a0  .....|._.t...t..
+00001bc0: 1274 006a 137c 006a 087c 006a 0766 0264  .t.j.|.j.|.j.f.d
+00001bd0: 0464 088d 02a1 01a1 0164 091b 007d 0974  .d.......d...}.t
+00001be0: 1464 0a74 00a0 1174 00a0 157c 01a1 01a1  .d.t...t...|....
+00001bf0: 0114 0083 017d 0a64 0b7c 0a64 0c9c 027d  .....}.d.|.d...}
+00001c00: 0b74 166a 177c 0164 0d8d 0101 0074 18a0  .t.j.|.d.....t..
+00001c10: 197c 0164 0419 007c 0164 0119 00a1 027d  .|.d...|.d.....}
+00001c20: 0c74 16a0 1a7c 0c64 0164 0e85 0264 0164  .t...|.d.d...d.d
+00001c30: 0e85 0266 0219 00a1 017d 0d74 16a0 1a7c  ...f.....}.t...|
+00001c40: 0c64 0164 0e85 0264 0e64 0f85 0266 0219  .d.d...d.d...f..
+00001c50: 00a1 017d 0e74 16a0 1a7c 0c64 0e64 1085  ...}.t...|.d.d..
+00001c60: 0264 0764 0785 0266 0219 00a1 017d 0f7c  .d.d...f.....}.|
+00001c70: 0d6a 1b7c 006a 0864 091b 007c 090b 007c  .j.|.j.d...|...|
+00001c80: 0964 1164 128d 0401 0074 1ca0 1d7c 006a  .d.d.....t...|.j
+00001c90: 1e64 131b 0064 14a1 027d 1064 157c 105f  .d...d...}.d.|._
+00001ca0: 1f64 047c 105f 2064 167c 105f 217c 0da0  .d.|._ d.|._!|..
+00001cb0: 227c 10a1 0101 0074 236a 2464 1774 257c  "|.....t#j$d.t%|
+00001cc0: 0a64 188d 0164 1964 1a64 1b8d 047d 117c  .d...d.d.d...}.|
+00001cd0: 116a 26a0 2764 1ca1 0101 007c 0da0 227c  .j&.'d.....|.."|
+00001ce0: 11a1 0101 007c 0da0 2864 1da1 0101 007c  .....|..(d.....|
+00001cf0: 0e6a 1b7c 006a 0764 091b 007c 090b 007c  .j.|.j.d...|...|
+00001d00: 0964 1164 128d 0401 0074 1ca0 1d7c 006a  .d.d.....t...|.j
+00001d10: 1e64 131b 0064 14a1 027d 1064 157c 105f  .d...d...}.d.|._
+00001d20: 1f64 047c 105f 2064 167c 105f 217c 0ea0  .d.|._ d.|._!|..
+00001d30: 227c 10a1 0101 0074 236a 2464 1e74 257c  "|.....t#j$d.t%|
+00001d40: 0a64 188d 0164 1964 1a64 1b8d 047d 117c  .d...d.d.d...}.|
+00001d50: 116a 26a0 2764 1ca1 0101 007c 0ea0 227c  .j&.'d.....|.."|
+00001d60: 11a1 0101 007c 0ea0 2864 1da1 0101 0074  .....|..(d.....t
+00001d70: 006a 2964 1f74 006a 0664 068d 027d 1274  .j)d.t.j.d...}.t
+00001d80: 0964 2083 0144 005d 117d 0774 00a0 2a7c  .d ..D.].}.t..*|
+00001d90: 090b 007c 0964 13a1 037c 127c 0764 0764  ...|.d...|.|.d.d
+00001da0: 0785 0266 023c 0090 0171 a37c 0f6a 1b7c  ...f.<...q.|.j.|
+00001db0: 1264 1164 218d 0201 007c 0f6a 2ba0 2c64  .d.d!....|.j+.,d
+00001dc0: 22a1 0101 0074 00a0 2a64 0164 1364 23a1  "....t..*d.d.d#.
+00001dd0: 037d 137c 0fa0 2d7c 13a1 0101 007c 0fa0  .}.|..-|.....|..
+00001de0: 2e74 00a0 2f74 00a0 2a7c 090b 007c 0964  .t../t..*|...|.d
+00001df0: 23a1 0364 05a1 02a1 0101 0064 2444 005d  #..d.......d$D.]
+00001e00: 137d 147c 0f6a 307c 1419 00a0 3164 05a1  .}.|.j0|....1d..
+00001e10: 0101 007c 0f6a 307c 1419 00a0 3264 25a1  ...|.j0|....2d%.
+00001e20: 0101 0090 0171 df7c 0f6a 336a 3464 0564  .....q.|.j3j4d.d
+00001e30: 2664 2764 2064 288d 0401 007c 0f6a 3564  &d'd d(....|.j5d
+00001e40: 2a69 007c 0ba4 018e 0101 0074 16a0 36a1  *i.|.......t..6.
+00001e50: 0001 0064 0753 0029 2b61 0001 0000 0a20  ...d.S.)+a..... 
+00001e60: 2020 2020 2020 2054 6869 7320 6361 6c63         This calc
+00001e70: 756c 6174 6573 2074 6865 2069 6e69 7469  ulates the initi
+00001e80: 616c 2044 5043 2063 656e 7465 7220 6f66  al DPC center of
+00001e90: 206d 6173 7320 7368 6966 7473 2062 7920   mass shifts by 
+00001ea0: 6d65 6173 7572 696e 670a 2020 2020 2020  measuring.      
+00001eb0: 2020 7468 6520 6365 6e74 6572 206f 6620    the center of 
+00001ec0: 6d61 7373 206f 6620 6561 6368 2069 6d61  mass of each ima
+00001ed0: 6765 2069 6e20 7468 6520 3444 2d53 5445  ge in the 4D-STE
+00001ee0: 4d20 6461 7461 7365 742c 2061 6e64 2074  M dataset, and t
+00001ef0: 6865 6e0a 2020 2020 2020 2020 636f 6d70  hen.        comp
+00001f00: 6172 696e 6720 7468 6174 2063 656e 7465  aring that cente
+00001f10: 7220 6f66 206d 6173 7320 7769 7468 2074  r of mass with t
+00001f20: 6865 2061 7665 7261 6765 2064 6973 6b20  he average disk 
+00001f30: 6365 6e74 6572 206f 6620 7468 650a 2020  center of the.  
+00001f40: 2020 2020 2020 656e 7469 7265 2064 6174        entire dat
+00001f50: 6173 6574 2e0a 2020 2020 2020 2020 7201  aset..        r.
+00001f60: 0000 0072 2200 0000 7223 0000 0072 2700  ...r"...r#...r'.
+00001f70: 0000 720b 0000 00a9 01da 0564 7479 7065  ..r........dtype
+00001f80: 4e72 2400 0000 e900 ca9a 3be7 cdcc cccc  Nr$.......;.....
+00001f90: cccc ec3f da04 626f 6c64 a902 da06 7765  ...?..bold....we
+00001fa0: 6967 6874 7230 0000 0072 2600 0000 7251  ightr0...r&...rQ
+00001fb0: 0000 0072 5a00 0000 725b 0000 00da 0652  ...rZ...r[.....R
+00001fc0: 6442 755f 72a9 035a 0476 6d69 6e5a 0476  dBu_r..Z.vminZ.v
+00001fd0: 6d61 7872 2a00 0000 720a 0000 0072 2b00  maxr*...r....r+.
+00001fe0: 0000 722c 0000 0072 5200 0000 7a14 5368  ..r,...rR...z.Sh
+00001ff0: 6966 7420 696e 2058 2064 6972 6563 7469  ift in X directi
+00002000: 6f6e 722f 0000 0054 fa0a 7570 7065 7220  onr/...T..upper 
+00002010: 6c65 6674 7232 0000 00fa 2272 6f75 6e64  leftr2...."round
+00002020: 2c20 7061 643d 2030 2e2c 2072 6f75 6e64  , pad= 0., round
+00002030: 696e 675f 7369 7a65 3d20 302e 3272 2e00  ing_size= 0.2r..
+00002040: 0000 7a14 5368 6966 7420 696e 2059 2064  ..z.Shift in Y d
+00002050: 6972 6563 7469 6f6e a902 7221 0000 0072  irection..r!...r
+00002060: 0a00 0000 7221 0000 0072 2900 0000 46e9  ....r!...r)...F.
+00002070: 0800 0000 a904 da03 746f 705a 0662 6f74  ........topZ.bot
+00002080: 746f 6dda 046c 6566 74da 0572 6967 6874  tom..left..right
+00002090: da05 626c 6163 6be9 0600 0000 da03 6f75  ..black.......ou
+000020a0: 74a9 04da 0577 6964 7468 da06 6c65 6e67  t....width..leng
+000020b0: 7468 da09 6469 7265 6374 696f 6eda 0370  th..direction..p
+000020c0: 6164 fa2e 245c 6d61 7468 726d 7b42 6561  ad..$\mathrm{Bea
+000020d0: 6d5c 3a20 5368 6966 745c 3a20 5c6c 6566  m\: Shift\: \lef
+000020e0: 7428 6e6d 5e7b 2d31 7d5c 7269 6768 7429  t(nm^{-1}\right)
+000020f0: 7d24 a901 7275 0000 0029 3772 1700 0000  }$..ru...)7r....
+00002100: da05 6d67 7269 6472 0d00 0000 da05 7368  ..mgridr......sh
+00002110: 6170 655a 0572 6176 656c da05 656d 7074  apeZ.ravel..empt
+00002120: 79da 0566 6c6f 6174 da04 5943 6f6d da04  y..float..YCom..
+00002130: 5843 6f6d da05 7261 6e67 65da 036c 656e  XCom..range..len
+00002140: 7257 0000 0072 3600 0000 5a08 6d75 6c74  rW...r6...Z.mult
+00002150: 6970 6c79 7256 0000 0072 5500 0000 7253  iplyrV...rU...rS
+00002160: 0000 0072 3800 0000 da03 6162 73da 0b63  ...r8.....abs..c
+00002170: 6f6e 6361 7465 6e61 7465 7237 0000 0072  oncatenater7...r
+00002180: 3900 0000 723a 0000 0072 3b00 0000 da04  9...r:...r;.....
+00002190: 6d70 6773 da08 4772 6964 5370 6563 723c  mpgs..GridSpecr<
+000021a0: 0000 0072 3d00 0000 723e 0000 0072 3f00  ...r=...r>...r?.
+000021b0: 0000 720e 0000 0072 4000 0000 7241 0000  ..r....r@...rA..
+000021c0: 0072 4200 0000 7244 0000 0072 4500 0000  .rB...rD...rE...
+000021d0: 7246 0000 0072 4700 0000 7248 0000 0072  rF...rG...rH...r
+000021e0: 4900 0000 7225 0000 00da 057a 6572 6f73  I...r%.....zeros
+000021f0: da08 6c69 6e73 7061 6365 da05 7961 7869  ..linspace..yaxi
+00002200: 73da 0b73 6574 5f76 6973 6962 6c65 da0a  s..set_visible..
+00002210: 7365 745f 7874 6963 6b73 da0f 7365 745f  set_xticks..set_
+00002220: 7874 6963 6b6c 6162 656c 73da 0572 6f75  xticklabels..rou
+00002230: 6e64 da06 7370 696e 6573 da0d 7365 745f  nd..spines..set_
+00002240: 6c69 6e65 7769 6474 68da 0973 6574 5f63  linewidth..set_c
+00002250: 6f6c 6f72 da05 7861 7869 73da 0f73 6574  olor..xaxis..set
+00002260: 5f74 6963 6b5f 7061 7261 6d73 da09 7365  _tick_params..se
+00002270: 745f 7469 746c 6572 4a00 0000 2915 721a  t_titlerJ...).r.
+00002280: 0000 0072 4b00 0000 da09 6e6f 726d 616c  ...rK.....normal
+00002290: 697a 655a 0271 71da 0270 70da 0279 795a  izeZ.qq..pp..yyZ
+000022a0: 0278 78da 0269 69da 0770 6174 7465 726e  .xx..ii..pattern
+000022b0: da02 766d 724c 0000 00da 0773 635f 666f  ..vmrL.....sc_fo
+000022c0: 6e74 da02 6773 da03 6178 31da 0361 7832  nt..gs..ax1..ax2
+000022d0: da03 6178 3372 4d00 0000 724e 0000 00da  ..ax3rM...rN....
+000022e0: 0273 62da 0278 3172 2500 0000 721c 0000  .sb..x1r%...r...
+000022f0: 0072 1c00 0000 721d 0000 00da 0b69 6e69  .r....r......ini
+00002300: 7469 616c 5f64 7063 c400 0000 738e 0000  tial_dpc....s...
+00002310: 002a 072a 010a 010a 011e 011e 0110 0122  .*.*..........."
+00002320: 0104 0120 0116 ff04 0320 0118 ff04 0314  ... ..... ......
+00002330: 0114 0120 0202 0104 ff18 030a 010c 0214  ... ............
+00002340: 011a 011a 011a 011a 0212 0106 0106 0106  ................
+00002350: 010a 0104 0102 0108 0102 0102 0106 fc0c  ................
+00002360: 060a 010a 011a 0212 0106 0106 0106 010a  ................
+00002370: 0104 0102 0108 0102 0102 0106 fc0c 060a  ................
+00002380: 010a 0110 020c 0120 010e 010c 010e 010a  ....... ........
+00002390: 011e 0108 0110 0114 0114 0110 010c 017a  ...............z
+000023a0: 1661 746f 6d69 635f 6470 632e 696e 6974  .atomic_dpc.init
+000023b0: 6961 6c5f 6470 6363 0200 0000 0000 0000  ial_dpcc........
+000023c0: 0000 0000 1b00 0000 0900 0000 4300 0000  ............C...
+000023d0: 7392 0400 0074 006a 0164 0174 0264 028d  s....t.j.d.t.d..
+000023e0: 027d 0264 037c 0264 0464 0185 023c 0074  .}.d.|.d.d...<.t
+000023f0: 006a 0164 017c 006a 036a 0464 028d 027d  .j.d.|.j.j.d...}
+00002400: 0374 006a 0164 017c 006a 056a 0464 028d  .t.j.d.|.j.j.d..
+00002410: 027d 0464 057d 0574 0664 0483 0144 005d  .}.d.}.t.d...D.]
+00002420: 747d 067c 0264 047c 0614 0019 007d 077c  t}.|.d.|.....}.|
+00002430: 0772 3674 00a0 077c 006a 03a1 017d 086e  .r6t...|.j...}.n
+00002440: 037c 006a 037d 0874 086a 09a0 0a7c 006a  .|.j.}.t.j...|.j
+00002450: 037c 006a 05a1 025c 027d 097d 0a74 0b6a  .|.j...\.}.}.t.j
+00002460: 0c74 086a 096a 0d7c 057c 097c 0a66 0264  .t.j.j.|.|.|.f.d
+00002470: 068d 037d 0b7c 0b6a 0e7d 0c7c 0c64 0518  ...}.|.j.}.|.d..
+00002480: 007d 0d7c 0c64 0517 007d 0e74 00a0 0f74  .}.|.d...}.t...t
+00002490: 086a 09a0 107c 087c 006a 057c 0da1 037c  .j...|.|.j.|...|
+000024a0: 006a 1114 00a1 017c 0374 1264 047c 0614  .j.....|.t.d.|..
+000024b0: 0083 013c 0074 00a0 0f74 086a 09a0 107c  ...<.t...t.j...|
+000024c0: 087c 006a 057c 0ea1 037c 006a 1114 00a1  .|.j.|...|.j....
+000024d0: 017c 0374 1264 047c 0614 0064 0717 0083  .|.t.d.|...d....
+000024e0: 013c 007c 0d7c 0474 1264 047c 0614 0083  .<.|.|.t.d.|....
+000024f0: 013c 007c 0e7c 0474 1264 047c 0614 0064  .<.|.|.t.d.|...d
+00002500: 0717 0083 013c 0071 2564 087c 047c 0374  .....<.q%d.|.|.t
+00002510: 00a0 137c 03a1 016b 0219 0064 0919 0014  ...|...k...d....
+00002520: 007c 005f 147c 027c 0374 00a0 137c 03a1  .|._.|.|.t...|..
+00002530: 016b 0219 0064 0919 007c 005f 157c 006a  .k...d...|._.|.j
+00002540: 1572 be74 00a0 167c 006a 03a1 017d 086e  .r.t...|.j...}.n
+00002550: 0674 00a0 177c 006a 03a1 017d 0874 086a  .t...|.j...}.t.j
+00002560: 09a0 0a7c 087c 006a 05a1 025c 027d 097d  ...|.|.j...\.}.}
+00002570: 0a74 086a 09a0 187c 097c 0a7c 006a 1474  .t.j...|.|.|.j.t
+00002580: 006a 1964 0a1b 0014 0018 00a1 025c 027c  .j.d.........\.|
+00002590: 005f 1a7c 005f 1b74 00a0 1c74 00a0 1d74  ._.|._.t...t...t
+000025a0: 006a 1e7c 006a 1a7c 006a 1b66 0264 0764  .j.|.j.|.j.f.d.d
+000025b0: 0b8d 02a1 01a1 0164 0c1b 007d 0f74 1264  .......d...}.t.d
+000025c0: 0d74 00a0 1f7c 01a1 0114 0083 017d 1064  .t...|.......}.d
+000025d0: 0e7c 1064 0f9c 027d 1174 206a 217c 0164  .|.d...}.t j!|.d
+000025e0: 108d 0101 0074 22a0 237c 0164 0719 007c  .....t".#|.d...|
+000025f0: 0164 0919 00a1 027d 1274 20a0 247c 1264  .d.....}.t .$|.d
+00002600: 0964 1185 0264 0964 1185 0266 0219 00a1  .d...d.d...f....
+00002610: 017d 1374 20a0 247c 1264 0964 1185 0264  .}.t .$|.d.d...d
+00002620: 1164 1285 0266 0219 00a1 017d 1474 20a0  .d...f.....}.t .
+00002630: 247c 1264 1164 1385 0264 1464 1485 0266  $|.d.d...d.d...f
+00002640: 0219 00a1 017d 157c 136a 257c 006a 1a64  .....}.|.j%|.j.d
+00002650: 0c1b 007c 0f0b 007c 0f64 1564 168d 0401  ...|...|.d.d....
+00002660: 0074 26a0 277c 006a 2864 171b 0064 18a1  .t&.'|.j(d...d..
+00002670: 027d 1664 197c 165f 2964 077c 165f 2a64  .}.d.|._)d.|._*d
+00002680: 1a7c 165f 2b7c 13a0 2c7c 16a1 0101 0074  .|._+|..,|.....t
+00002690: 2d6a 2e64 1b74 2f7c 1064 1c8d 0164 0364  -j.d.t/|.d...d.d
+000026a0: 1d64 1e8d 047d 177c 176a 30a0 3164 1fa1  .d...}.|.j0.1d..
+000026b0: 0101 007c 13a0 2c7c 17a1 0101 007c 13a0  ...|..,|.....|..
+000026c0: 3264 20a1 0101 007c 146a 257c 006a 1b64  2d ....|.j%|.j.d
+000026d0: 0c1b 007c 0f0b 007c 0f64 1564 168d 0401  ...|...|.d.d....
+000026e0: 0074 26a0 277c 006a 2864 171b 0064 18a1  .t&.'|.j(d...d..
+000026f0: 027d 1664 197c 165f 2964 077c 165f 2a64  .}.d.|._)d.|._*d
+00002700: 1a7c 165f 2b7c 14a0 2c7c 16a1 0101 0074  .|._+|..,|.....t
+00002710: 2d6a 2e64 2174 2f7c 1064 1c8d 0164 0364  -j.d!t/|.d...d.d
+00002720: 1d64 1e8d 047d 177c 176a 30a0 3164 1fa1  .d...}.|.j0.1d..
+00002730: 0101 007c 14a0 2c7c 17a1 0101 007c 14a0  ...|..,|.....|..
+00002740: 3264 20a1 0101 0074 006a 0164 2274 006a  2d ....t.j.d"t.j
+00002750: 3364 028d 027d 1874 0664 2383 0144 005d  3d...}.t.d#..D.]
+00002760: 117d 0674 00a0 347c 0f0b 007c 0f64 17a1  .}.t..4|...|.d..
+00002770: 037c 187c 0664 1464 1485 0266 023c 0090  .|.|.d.d...f.<..
+00002780: 0171 c57c 156a 257c 1864 1564 248d 0201  .q.|.j%|.d.d$...
+00002790: 007c 156a 35a0 3664 25a1 0101 0074 00a0  .|.j5.6d%....t..
+000027a0: 3464 0964 1764 26a1 037d 197c 15a0 377c  4d.d.d&..}.|..7|
+000027b0: 19a1 0101 007c 15a0 3874 00a0 3974 00a0  .....|..8t..9t..
+000027c0: 347c 0f0b 007c 0f64 26a1 0364 04a1 02a1  4|...|.d&..d....
+000027d0: 0101 0064 2744 005d 137d 1a7c 156a 3a7c  ...d'D.].}.|.j:|
+000027e0: 1a19 00a0 3b64 04a1 0101 007c 156a 3a7c  ....;d.....|.j:|
+000027f0: 1a19 00a0 3c64 28a1 0101 0090 0271 017c  ....<d(......q.|
+00002800: 156a 3d6a 3e64 0464 2964 2a64 2364 2b8d  .j=j>d.d)d*d#d+.
+00002810: 0401 007c 156a 3f64 2d69 007c 11a4 018e  ...|.j?d-i.|....
+00002820: 0101 0074 20a0 40a1 0001 007c 006a 417c  ...t .@....|.jA|
+00002830: 006a 1a14 007c 005f 427c 006a 417c 006a  .j...|._B|.jA|.j
+00002840: 1b14 007c 005f 437c 006a 427c 006a 441b  ...|._C|.jB|.jD.
+00002850: 007c 005f 457c 006a 437c 006a 441b 007c  .|._E|.jC|.jD..|
+00002860: 005f 4664 1453 0029 2e61 f501 0000 0a20  ._Fd.S.).a..... 
+00002870: 2020 2020 2020 2054 6869 7320 636f 7272         This corr
+00002880: 6563 7473 2066 6f72 2074 6865 2072 6f74  ects for the rot
+00002890: 6174 696f 6e20 616e 676c 6520 6f66 2074  ation angle of t
+000028a0: 6865 2070 6978 656c 6c61 7465 6420 6465  he pixellated de
+000028b0: 7465 6374 6f72 0a20 2020 2020 2020 2077  tector.        w
+000028c0: 6974 6820 7265 7370 6563 7420 746f 2074  ith respect to t
+000028d0: 6865 206f 7074 6963 2061 7869 732e 2053  he optic axis. S
+000028e0: 6f6d 6520 7069 7865 6c6c 6174 6564 2064  ome pixellated d
+000028f0: 6574 6563 746f 7273 2066 6c69 700a 2020  etectors flip.  
+00002900: 2020 2020 2020 7468 6520 696d 6167 652c        the image,
+00002910: 2061 6e64 2069 6620 7468 6572 6520 6973   and if there is
+00002920: 2061 6e20 696d 6167 6520 666c 6970 2c20   an image flip, 
+00002930: 6974 2063 6f72 7265 6374 7320 6974 2074  it corrects it t
+00002940: 6f6f 2e0a 2020 2020 2020 2020 5468 6520  oo..        The 
+00002950: 6d65 6368 616e 6973 6d20 6f66 2074 6869  mechanism of thi
+00002960: 732c 2077 6520 636f 6d70 6172 6520 7468  s, we compare th
+00002970: 6520 6772 6164 6965 6e74 206f 6620 626f  e gradient of bo
+00002980: 7468 2074 6865 2066 6c69 7070 6564 0a20  th the flipped. 
+00002990: 2020 2020 2020 2061 6e64 2074 6865 2075         and the u
+000029a0: 6e66 6c69 7070 6564 2044 5043 2064 6174  nflipped DPC dat
+000029b0: 6120 6174 206d 756c 7469 706c 6520 726f  a at multiple ro
+000029c0: 7461 7469 6f6e 2061 6e67 6c65 732c 2061  tation angles, a
+000029d0: 6e64 2074 6865 2076 616c 7565 0a20 2020  nd the value.   
+000029e0: 2020 2020 2074 6861 7420 6861 7320 7468       that has th
+000029f0: 6520 6869 6768 6573 7420 7265 6c61 7469  e highest relati
+00002a00: 7665 2063 6f6e 7472 6173 7420 7769 7468  ve contrast with
+00002a10: 2074 6865 2041 4446 2d53 5445 4d20 696d   the ADF-STEM im
+00002a20: 6167 6520 6973 2074 616b 656e 0a20 2020  age is taken.   
+00002a30: 2020 2020 2061 7320 3930 2064 6567 7265       as 90 degre
+00002a40: 6573 2066 726f 6d20 7468 6520 636f 7272  es from the corr
+00002a50: 6563 7420 616e 676c 652e 0a20 2020 2020  ect angle..     
+00002a60: 2020 20e9 0400 0000 725c 0000 0054 720b     .....r\...Tr.
+00002a70: 0000 00e9 5a00 0000 2901 da04 6172 6773  ....Z...)...args
+00002a80: 7227 0000 0072 2200 0000 7201 0000 00e9  r'...r"...r.....
+00002a90: b400 0000 7224 0000 0072 5e00 0000 725f  ....r$...r^...r_
+00002aa0: 0000 0072 6000 0000 7261 0000 0072 2600  ...r`...ra...r&.
+00002ab0: 0000 7251 0000 0072 5a00 0000 725b 0000  ..rQ...rZ...r[..
+00002ac0: 004e 7263 0000 0072 6400 0000 720a 0000  .Nrc...rd...r...
+00002ad0: 0072 2b00 0000 722c 0000 0072 5200 0000  .r+...r,...rR...
+00002ae0: 7a1e 436f 7272 6563 7465 6420 7368 6966  z.Corrected shif
+00002af0: 7420 696e 2058 2064 6972 6563 7469 6f6e  t in X direction
+00002b00: 722f 0000 0072 6500 0000 7232 0000 0072  r/...re...r2...r
+00002b10: 6600 0000 722e 0000 007a 1e43 6f72 7265  f...r....z.Corre
+00002b20: 6374 6564 2073 6869 6674 2069 6e20 5920  cted shift in Y 
+00002b30: 6469 7265 6374 696f 6e72 6700 0000 7221  directionrg...r!
+00002b40: 0000 0072 2900 0000 4672 6800 0000 7269  ...r)...Frh...ri
+00002b50: 0000 0072 6d00 0000 726e 0000 0072 6f00  ...rm...rn...ro.
+00002b60: 0000 7270 0000 0072 7500 0000 7276 0000  ..rp...ru...rv..
+00002b70: 0029 4772 1700 0000 7283 0000 00da 0462  .)Gr....r......b
+00002b80: 6f6f 6c72 7c00 0000 725d 0000 0072 7b00  oolr|...r]...r{.
+00002b90: 0000 727d 0000 005a 0466 6c69 7072 1000  ..r}...Z.flipr..
+00002ba0: 0000 da03 6470 635a 0863 6172 7432 706f  ....dpcZ.cart2po
+00002bb0: 6cda 0373 696f 5a08 6d69 6e69 6d69 7a65  l..sioZ.minimize
+00002bc0: 5a09 616e 676c 655f 6675 6eda 0178 7236  Z.angle_fun..xr6
+00002bd0: 0000 005a 0a63 6861 7267 655f 6470 6372  ...Z.charge_dpcr
+00002be0: 0c00 0000 7237 0000 005a 0461 6d69 6e5a  ....r7...Z.aminZ
+00002bf0: 0561 6e67 6c65 5a0a 6669 6e61 6c5f 666c  .angleZ.final_fl
+00002c00: 6970 5a06 666c 6970 6c72 da04 636f 7079  ipZ.fliplr..copy
+00002c10: 5a08 706f 6c32 6361 7274 7218 0000 00da  Z.pol2cartr.....
+00002c20: 0558 436f 6d43 da05 5943 6f6d 4372 3800  .XComC..YComCr8.
+00002c30: 0000 727f 0000 0072 8000 0000 da03 6d61  ..r....r......ma
+00002c40: 7872 3a00 0000 723b 0000 0072 8100 0000  xr:...r;...r....
+00002c50: 7282 0000 0072 3c00 0000 723d 0000 0072  r....r<...r=...r
+00002c60: 3e00 0000 723f 0000 0072 0e00 0000 7240  >...r?...r....r@
+00002c70: 0000 0072 4100 0000 7242 0000 0072 4400  ...rA...rB...rD.
+00002c80: 0000 7245 0000 0072 4600 0000 7247 0000  ..rE...rF...rG..
+00002c90: 0072 4800 0000 7249 0000 0072 2500 0000  .rH...rI...r%...
+00002ca0: 727a 0000 0072 8400 0000 7285 0000 0072  rz...r....r....r
+00002cb0: 8600 0000 7287 0000 0072 8800 0000 7289  ....r....r....r.
+00002cc0: 0000 0072 8a00 0000 728b 0000 0072 8c00  ...r....r....r..
+00002cd0: 0000 728d 0000 0072 8e00 0000 728f 0000  ..r....r....r...
+00002ce0: 0072 4a00 0000 7214 0000 005a 094d 6f6d  .rJ...r....Z.Mom
+00002cf0: 656e 7475 6d58 5a09 4d6f 6d65 6e74 756d  entumXZ.Momentum
+00002d00: 5972 1600 0000 da08 655f 6669 656c 6458  Yr......e_fieldX
+00002d10: da08 655f 6669 656c 6459 291b 721a 0000  ..e_fieldY).r...
+00002d20: 0072 4b00 0000 5a05 666c 6970 735a 0863  .rK...Z.flipsZ.c
+00002d30: 6867 5f73 756d 735a 0661 6e67 6c65 735a  hg_sumsZ.anglesZ
+00002d40: 0278 3072 9300 0000 5a07 746f 5f66 6c69  .x0r....Z.to_fli
+00002d50: 705a 0578 6470 6366 5a07 7268 6f5f 6470  pZ.xdpcfZ.rho_dp
+00002d60: 635a 0770 6869 5f64 7063 72a5 0000 005a  cZ.phi_dpcr....Z
+00002d70: 056d 696e 5f78 5a04 736f 6c31 5a04 736f  .min_xZ.sol1Z.so
+00002d80: 6c32 7295 0000 0072 4c00 0000 7296 0000  l2r....rL...r...
+00002d90: 0072 9700 0000 7298 0000 0072 9900 0000  .r....r....r....
+00002da0: 729a 0000 0072 4d00 0000 724e 0000 0072  r....rM...rN...r
+00002db0: 9b00 0000 729c 0000 0072 2500 0000 721c  ....r....r%...r.
+00002dc0: 0000 0072 1c00 0000 721d 0000 00da 0b63  ...r....r......c
+00002dd0: 6f72 7265 6374 5f64 7063 1801 0000 73b4  orrect_dpc....s.
+00002de0: 0000 000e 0a0c 0112 0112 0104 010c 010c  ................
+00002df0: 0104 010e 0106 0216 0118 0106 0108 0108  ................
+00002e00: 0104 0116 0110 ff04 0316 0114 ff10 0316  ................
+00002e10: 011c 0118 0106 020e 010c 0214 0106 0114  ................
+00002e20: 010c ff20 0402 0104 ff12 030a 010c 0214  ... ............
+00002e30: 021a 011a 011a 011a 0212 0106 0106 0106  ................
+00002e40: 010a 0104 0102 0108 0102 0102 0106 fc0c  ................
+00002e50: 060a 010a 011a 0212 0106 0106 0106 010a  ................
+00002e60: 0104 0102 0108 0102 0102 0106 fc0c 060a  ................
+00002e70: 010a 0110 020c 0120 010e 010c 010e 010a  ....... ........
+00002e80: 011e 0108 0110 0114 0114 0110 0108 010e  ................
+00002e90: 020e 010e 0212 017a 1661 746f 6d69 635f  .......z.atomic_
+00002ea0: 6470 632e 636f 7272 6563 745f 6470 63a9  dpc.correct_dpc.
+00002eb0: 0272 5100 0000 725b 0000 0063 0200 0000  .rQ...r[...c....
+00002ec0: 0000 0000 0000 0000 0f00 0000 0900 0000  ................
+00002ed0: 4300 0000 734e 0200 0074 0074 01a0 0274  C...sN...t.t...t
+00002ee0: 01a0 037c 01a1 01a1 0183 017d 0274 01a0  ...|.......}.t..
+00002ef0: 047c 006a 05a1 0164 0119 0074 01a0 047c  .|.j...d...t...|
+00002f00: 006a 06a1 0164 0219 0017 007c 006a 0764  .j...d.....|.j.d
+00002f10: 0314 0014 007c 006a 0814 0064 0414 0074  .....|.j...d...t
+00002f20: 016a 0914 007c 005f 0a74 01a0 0274 01a0  .j...|._.t...t..
+00002f30: 0b7c 006a 0aa1 01a1 017d 0374 0c6a 0d7c  .|.j.....}.t.j.|
+00002f40: 0164 058d 0101 0074 0064 0674 01a0 0e7c  .d.....t.d.t...|
+00002f50: 01a1 0114 0083 017d 0264 077c 0264 089c  .......}.d.|.d..
+00002f60: 027d 0474 0fa0 107c 0164 0119 007c 0164  .}.t...|.d...|.d
+00002f70: 0219 00a1 027d 0574 0ca0 117c 0564 0264  .....}.t...|.d.d
+00002f80: 0985 0264 0264 0985 0266 0219 00a1 017d  ...d.d...f.....}
+00002f90: 0674 0ca0 117c 0564 0964 0a85 0264 0b64  .t...|.d.d...d.d
+00002fa0: 0b85 0266 0219 00a1 017d 077c 066a 127c  ...f.....}.|.j.|
+00002fb0: 006a 0a7c 030b 007c 0364 0c64 0d8d 0401  .j.|...|.d.d....
+00002fc0: 0074 13a0 147c 006a 0764 0e1b 0064 0fa1  .t...|.j.d...d..
+00002fd0: 027d 0864 107c 085f 1564 017c 085f 1664  .}.d.|._.d.|._.d
+00002fe0: 117c 085f 177c 06a0 187c 08a1 0101 007c  .|._.|...|.....|
+00002ff0: 06a0 1964 12a1 0101 0074 1a6a 1b64 1374  ...d.....t.j.d.t
+00003000: 1c7c 0264 148d 0164 1564 1664 178d 047d  .|.d...d.d.d...}
+00003010: 097c 096a 1da0 1e64 18a1 0101 007c 06a0  .|.j...d.....|..
+00003020: 187c 09a1 0101 0074 016a 1f64 1974 016a  .|.....t.j.d.t.j
+00003030: 2064 1a8d 027d 0a74 2164 1b83 0144 005d   d...}.t!d...D.]
+00003040: 167d 0b74 01a0 227c 037c 006a 231b 007c  .}.t.."|.|.j#..|
+00003050: 037c 006a 231b 000b 0064 0ea1 037c 0a7c  .|.j#....d...|.|
+00003060: 0b64 0b64 0b85 0266 023c 0071 b37c 076a  .d.d...f.<.q.|.j
+00003070: 127c 0a64 0c64 1c8d 0201 007c 076a 24a0  .|.d.d.....|.j$.
+00003080: 2564 1da1 0101 0064 1e7d 0c74 01a0 2264  %d.....d.}.t.."d
+00003090: 0264 0e7c 0ca1 037d 0d7c 07a0 267c 0da1  .d.|...}.|..&|..
+000030a0: 0101 007c 07a0 2774 01a0 2874 01a0 227c  ...|..'t..(t.."|
+000030b0: 037c 006a 231b 007c 037c 006a 231b 000b  .|.j#..|.|.j#...
+000030c0: 007c 0ca1 0364 1fa1 02a1 0101 0064 2044  .|...d.......d D
+000030d0: 005d 127d 0e7c 076a 297c 0e19 00a0 2a64  .].}.|.j)|....*d
+000030e0: 21a1 0101 007c 076a 297c 0e19 00a0 2b64  !....|.j)|....+d
+000030f0: 22a1 0101 0071 fc7c 076a 2c6a 2d64 2164  "....q.|.j,j-d!d
+00003100: 1f64 2364 1b64 248d 0401 007c 076a 2e64  .d#d.d$....|.j.d
+00003110: 2669 007c 04a4 018e 0101 0074 0ca0 2fa1  &i.|.......t../.
+00003120: 0001 0064 0b53 0029 277a 920a 2020 2020  ...d.S.)'z..    
+00003130: 2020 2020 5765 2063 616c 6375 6c61 7465      We calculate
+00003140: 2074 6865 2063 6861 7267 6520 6672 6f6d   the charge from
+00003150: 2074 6865 2063 6f72 7265 6374 6564 2044   the corrected D
+00003160: 5043 0a20 2020 2020 2020 2063 656e 7465  PC.        cente
+00003170: 7220 6f66 206d 6173 7320 6461 7461 7365  r of mass datase
+00003180: 7473 2e20 5468 6973 2069 7320 646f 6e65  ts. This is done
+00003190: 2074 6872 6f75 6768 0a20 2020 2020 2020   through.       
+000031a0: 2050 6f69 7373 6f6e 2773 2065 7175 6174   Poisson's equat
+000031b0: 696f 6e2e 0a20 2020 2020 2020 2072 2700  ion..        r'.
+000031c0: 0000 7201 0000 0067 11ea 2d81 9997 713d  ..r....g..-...q=
+000031d0: 729e 0000 0072 2600 0000 725f 0000 0072  r....r&...r_...r
+000031e0: 6000 0000 7261 0000 0072 5100 0000 725b  `...ra...rQ...r[
+000031f0: 0000 004e 7263 0000 0072 6400 0000 720a  ...Nrc...rd...r.
+00003200: 0000 0072 2b00 0000 722c 0000 0072 5200  ...r+...r,...rR.
+00003210: 0000 722e 0000 007a 0f43 6861 7267 6520  ..r....z.Charge 
+00003220: 6672 6f6d 2044 5043 722f 0000 0054 7231  from DPCr/...Tr1
+00003230: 0000 0072 3200 0000 fa1e 726f 756e 642c  ...r2.....round,
+00003240: 7061 643d 302e 2c72 6f75 6e64 696e 675f  pad=0.,rounding_
+00003250: 7369 7a65 3d30 2e32 7267 0000 0072 5c00  size=0.2rg...r\.
+00003260: 0000 7221 0000 0072 2900 0000 46e9 0700  ..r!...r)...F...
+00003270: 0000 726e 0000 0072 6900 0000 720b 0000  ..rn...ri...r...
+00003280: 0072 6d00 0000 726f 0000 0072 7000 0000  .rm...ro...rp...
+00003290: fa31 245c 6d61 7468 726d 7b43 6861 7267  .1$\mathrm{Charg
+000032a0: 655c 3a20 4465 6e73 6974 795c 3a20 5c6c  e\: Density\: \l
+000032b0: 6566 7428 655e 7b2d 7d20 5c72 6967 6874  eft(e^{-} \right
+000032c0: 297d 2429 0172 b000 0000 2930 7237 0000  )}$).r....)0r7..
+000032d0: 0072 1700 0000 7238 0000 0072 3900 0000  .r....r8...r9...
+000032e0: 5a08 6772 6164 6965 6e74 72aa 0000 0072  Z.gradientr....r
+000032f0: ab00 0000 720e 0000 0072 1500 0000 7218  ....r....r....r.
+00003300: 0000 005a 0663 6861 7267 6572 7f00 0000  ...Z.charger....
+00003310: 723a 0000 0072 3b00 0000 72a9 0000 0072  r:...r;...r....r
+00003320: 8100 0000 7282 0000 0072 3c00 0000 723d  ....r....r<...r=
+00003330: 0000 0072 3e00 0000 723f 0000 0072 4000  ...r>...r?...r@.
+00003340: 0000 7241 0000 0072 4200 0000 7244 0000  ..rA...rB...rD..
+00003350: 0072 2500 0000 7245 0000 0072 4600 0000  .r%...rE...rF...
+00003360: 7247 0000 0072 4800 0000 7249 0000 0072  rG...rH...rI...r
+00003370: 8300 0000 727a 0000 0072 7d00 0000 7284  ....rz...r}...r.
+00003380: 0000 0072 1600 0000 7285 0000 0072 8600  ...r....r....r..
+00003390: 0000 7287 0000 0072 8800 0000 7289 0000  ..r....r....r...
+000033a0: 0072 8a00 0000 728b 0000 0072 8c00 0000  .r....r....r....
+000033b0: 728d 0000 0072 8e00 0000 728f 0000 0072  r....r....r....r
+000033c0: 4a00 0000 290f 721a 0000 0072 4b00 0000  J...).r....rK...
+000033d0: 724c 0000 00da 0263 6d72 9600 0000 7297  rL.....cmr....r.
+000033e0: 0000 0072 9800 0000 7299 0000 0072 4d00  ...r....r....rM.
+000033f0: 0000 724e 0000 0072 9b00 0000 7293 0000  ..rN...r....r...
+00003400: 00da 096e 6f5f 6c61 6265 6c73 729c 0000  ...no_labelsr...
+00003410: 0072 2500 0000 721c 0000 0072 1c00 0000  .r%...r....r....
+00003420: 721d 0000 00da 0b73 686f 775f 6368 6172  r......show_char
+00003430: 6765 8801 0000 7362 0000 0014 061e 0508  ge....sb........
+00003440: 0102 ff04 0302 fc02 0502 fb04 0602 fa04  ................
+00003450: ff12 090c 0112 010a 0114 021a 011a 0116  ................
+00003460: 0212 0106 0106 0106 010a 010a 0104 010e  ................
+00003470: 0106 ff0c 030a 0110 020c 012a 010e 010c  ...........*....
+00003480: 0104 010e 010a 0104 0104 011c 0102 ff04  ................
+00003490: ff08 0510 0112 0114 0110 010c 027a 1661  .............z.a
+000034a0: 746f 6d69 635f 6470 632e 7368 6f77 5f63  tomic_dpc.show_c
+000034b0: 6861 7267 6563 0200 0000 0000 0000 0000  hargec..........
+000034c0: 0000 0f00 0000 0900 0000 4300 0000 7330  ..........C...s0
+000034d0: 0200 0074 0074 01a0 0274 01a0 037c 01a1  ...t.t...t...|..
+000034e0: 01a1 0183 017d 0274 046a 05a0 067c 006a  .....}.t.j...|.j
+000034f0: 077c 006a 0814 007c 006a 097c 006a 0814  .|.j...|.j.|.j..
+00003500: 00a1 027c 005f 0a7c 006a 0a7c 006a 0b1b  ...|._.|.j.|.j..
+00003510: 007c 005f 0c74 01a0 0274 01a0 0d7c 006a  .|._.t...t...|.j
+00003520: 0ca1 01a1 0164 0114 007d 0374 0e6a 0f7c  .....d...}.t.j.|
+00003530: 0164 028d 0101 0074 0064 0374 01a0 107c  .d.....t.d.t...|
+00003540: 01a1 0114 0083 017d 0264 047c 0264 059c  .......}.d.|.d..
+00003550: 027d 0474 11a0 127c 0164 0619 007c 0164  .}.t...|.d...|.d
+00003560: 0719 00a1 027d 0574 0ea0 137c 0564 0764  .....}.t...|.d.d
+00003570: 0885 0264 0764 0885 0266 0219 00a1 017d  ...d.d...f.....}
+00003580: 0674 0ea0 137c 0564 0864 0985 0264 0a64  .t...|.d.d...d.d
+00003590: 0a85 0266 0219 00a1 017d 077c 066a 147c  ...f.....}.|.j.|
+000035a0: 006a 0c64 0114 007c 030b 007c 0364 0b64  .j.d...|...|.d.d
+000035b0: 0c8d 0401 0074 15a0 167c 006a 1764 0d1b  .....t...|.j.d..
+000035c0: 0064 0ea1 027d 0864 0f7c 085f 1864 067c  .d...}.d.|._.d.|
+000035d0: 085f 1964 107c 085f 1a7c 06a0 1b7c 08a1  ._.d.|._.|...|..
+000035e0: 0101 007c 06a0 1c64 11a1 0101 0074 1d6a  ...|...d.....t.j
+000035f0: 1e64 1274 1f7c 0264 138d 0164 1464 1564  .d.t.|.d...d.d.d
+00003600: 168d 047d 097c 096a 20a0 2164 17a1 0101  ...}.|.j .!d....
+00003610: 007c 06a0 1b7c 09a1 0101 0074 016a 2264  .|...|.....t.j"d
+00003620: 1874 016a 2364 198d 027d 0a74 2464 1a83  .t.j#d...}.t$d..
+00003630: 0144 005d 107d 0b74 01a0 257c 030b 007c  .D.].}.t..%|...|
+00003640: 0364 0da1 037c 0a7c 0b64 0a64 0a85 0266  .d...|.|.d.d...f
+00003650: 023c 0071 b07c 076a 147c 0a64 0b64 1b8d  .<.q.|.j.|.d.d..
+00003660: 0201 007c 076a 26a0 2764 1ca1 0101 0064  ...|.j&.'d.....d
+00003670: 1d7d 0c74 01a0 2564 0764 0d7c 0ca1 037d  .}.t..%d.d.|...}
+00003680: 0d7c 07a0 287c 0da1 0101 007c 07a0 2974  .|..(|.....|..)t
+00003690: 01a0 2a74 01a0 257c 030b 007c 037c 0ca1  ..*t..%|...|.|..
+000036a0: 0364 1ea1 02a1 0101 0064 1f44 005d 127d  .d.......d.D.].}
+000036b0: 0e7c 076a 2b7c 0e19 00a0 2c64 20a1 0101  .|.j+|....,d ...
+000036c0: 007c 076a 2b7c 0e19 00a0 2d64 21a1 0101  .|.j+|....-d!...
+000036d0: 0071 ed7c 076a 2e6a 2f64 2064 1e64 2264  .q.|.j.j/d d.d"d
+000036e0: 1a64 238d 0401 007c 076a 3064 2569 007c  .d#....|.j0d%i.|
+000036f0: 04a4 018e 0101 0074 0ea0 31a1 0001 0064  .......t..1....d
+00003700: 0a53 0029 2661 2e02 0000 0a20 2020 2020  .S.)&a.....     
+00003710: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
+00003720: 2070 726f 6a65 6374 6564 2070 6f74 656e   projected poten
+00003730: 7469 616c 2066 726f 6d20 7468 6520 4450  tial from the DP
+00003740: 4320 6d65 6173 7572 656d 656e 7473 2e0a  C measurements..
+00003750: 2020 2020 2020 2020 5468 6973 2069 7320          This is 
+00003760: 6163 636f 6d70 6c69 7368 6564 2062 7920  accomplished by 
+00003770: 6361 6c63 756c 6174 696e 6720 7468 6520  calculating the 
+00003780: 7068 6173 6520 7368 6966 7420 6974 6572  phase shift iter
+00003790: 6174 6976 656c 790a 2020 2020 2020 2020  atively.        
+000037a0: 6672 6f6d 2074 6865 206e 6f72 6d61 6c69  from the normali
+000037b0: 7a65 6420 6365 6e74 6572 206f 6620 6d61  zed center of ma
+000037c0: 7373 2073 6869 6674 732e 204e 6f72 6d61  ss shifts. Norma
+000037d0: 6c69 7a61 7469 6f6e 206d 6561 6e73 0a20  lization means. 
+000037e0: 2020 2020 2020 2063 616c 6375 6c61 7469         calculati
+000037f0: 6e67 2043 4f4d 2073 6869 6674 7320 696e  ng COM shifts in
+00003800: 2069 6e76 6572 7365 206c 656e 6774 6820   inverse length 
+00003810: 756e 6974 7320 616e 6420 7468 656e 206d  units and then m
+00003820: 756c 7469 706c 7969 6e67 0a20 2020 2020  ultiplying.     
+00003830: 2020 2074 6865 6d20 7769 7468 2074 6865     them with the
+00003840: 2065 6c65 6374 726f 6e20 7761 7665 6c65   electron wavele
+00003850: 6e67 7468 2074 6f20 6765 7420 616e 2065  ngth to get an e
+00003860: 6c65 6374 726f 6e20 696e 6465 7065 6e64  lectron independ
+00003870: 656e 740a 2020 2020 2020 2020 6d72 6164  ent.        mrad
+00003880: 2073 6869 6674 2c20 7768 6963 6820 6973   shift, which is
+00003890: 2075 7365 6420 746f 2067 656e 6572 6174   used to generat
+000038a0: 6520 7468 6520 7068 6173 652e 2054 6869  e the phase. Thi
+000038b0: 7320 7068 6173 6520 6973 0a20 2020 2020  s phase is.     
+000038c0: 2020 2070 726f 706f 7274 696f 6e61 6c20     proportional 
+000038d0: 746f 2074 6865 2070 726f 6a65 6374 6564  to the projected
+000038e0: 2070 6f74 656e 7469 616c 2066 6f72 2077   potential for w
+000038f0: 6561 6b20 7068 6173 6520 6f62 6a65 6374  eak phase object
+00003900: 0a20 2020 2020 2020 206d 6174 6572 6961  .        materia
+00003910: 6c73 2028 7769 7468 202a 6c6f 7473 2a20  ls (with *lots* 
+00003920: 6f66 2061 7373 756d 7074 696f 6e73 290a  of assumptions).
+00003930: 2020 2020 2020 2020 6c03 0000 0000 6417          l.....d.
+00003940: 2809 0072 2600 0000 725f 0000 0072 6000  (..r&...r_...r`.
+00003950: 0000 7261 0000 0072 2700 0000 7201 0000  ..ra...r'...r...
+00003960: 0072 5100 0000 725b 0000 004e 7263 0000  .rQ...r[...Nrc..
+00003970: 0072 6400 0000 720a 0000 0072 2b00 0000  .rd...r....r+...
+00003980: 722c 0000 0072 5200 0000 722e 0000 007a  r,...rR...r....z
+00003990: 2d43 616c 6375 6c61 7465 6420 7072 6f6a  -Calculated proj
+000039a0: 6563 7465 6420 706f 7465 6e74 6961 6c20  ected potential 
+000039b0: 6672 6f6d 2044 5043 2070 6861 7365 722f  from DPC phaser/
+000039c0: 0000 0054 7231 0000 0072 3200 0000 72ae  ...Tr1...r2...r.
+000039d0: 0000 0072 6700 0000 725c 0000 0072 2100  ...rg...r\...r!.
+000039e0: 0000 7229 0000 0046 72af 0000 0072 6e00  ..r)...Fr....rn.
+000039f0: 0000 7269 0000 0072 0b00 0000 726d 0000  ..ri...r....rm..
+00003a00: 0072 6f00 0000 7270 0000 00f5 1900 0000  .ro...rp........
+00003a10: 5072 6f6a 6563 7465 6420 506f 7465 6e74  Projected Potent
+00003a20: 6961 6c20 2856 c385 2929 0172 b400 0000  ial (V..)).r....
+00003a30: 2932 7237 0000 0072 1700 0000 7238 0000  )2r7...r....r8..
+00003a40: 0072 3900 0000 7210 0000 0072 a300 0000  .r9...r....r....
+00003a50: 5a0d 696e 7465 6772 6174 655f 6470 6372  Z.integrate_dpcr
+00003a60: a700 0000 7212 0000 0072 a800 0000 5a05  ....r....r....Z.
+00003a70: 7068 6173 6572 1900 0000 5a09 706f 7465  phaser....Z.pote
+00003a80: 6e74 6961 6c72 7f00 0000 723a 0000 0072  ntialr....r:...r
+00003a90: 3b00 0000 72a9 0000 0072 8100 0000 7282  ;...r....r....r.
+00003aa0: 0000 0072 3c00 0000 723d 0000 0072 3e00  ...r<...r=...r>.
+00003ab0: 0000 723f 0000 0072 0e00 0000 7240 0000  ..r?...r....r@..
+00003ac0: 0072 4100 0000 7242 0000 0072 4400 0000  .rA...rB...rD...
+00003ad0: 7225 0000 0072 4500 0000 7246 0000 0072  r%...rE...rF...r
+00003ae0: 4700 0000 7248 0000 0072 4900 0000 7283  G...rH...rI...r.
+00003af0: 0000 0072 7a00 0000 727d 0000 0072 8400  ...rz...r}...r..
+00003b00: 0000 7285 0000 0072 8600 0000 7287 0000  ..r....r....r...
+00003b10: 0072 8800 0000 7289 0000 0072 8a00 0000  .r....r....r....
+00003b20: 728b 0000 0072 8c00 0000 728d 0000 0072  r....r....r....r
+00003b30: 8e00 0000 728f 0000 0072 4a00 0000 290f  ....r....rJ...).
+00003b40: 721a 0000 0072 4b00 0000 724c 0000 00da  r....rK...rL....
+00003b50: 0270 6d72 9600 0000 7297 0000 0072 9800  .pmr....r....r..
+00003b60: 0000 7299 0000 0072 4d00 0000 724e 0000  ..r....rM...rN..
+00003b70: 0072 9b00 0000 7293 0000 0072 b200 0000  .r....r....r....
+00003b80: 729c 0000 0072 2500 0000 721c 0000 0072  r....r%...r....r
+00003b90: 1c00 0000 721d 0000 00da 0e73 686f 775f  ....r......show_
+00003ba0: 706f 7465 6e74 6961 6cc5 0100 0073 5400  potential....sT.
+00003bb0: 0000 140b 0601 1401 06ff 0e03 1602 0c01  ................
+00003bc0: 1201 0a01 1402 1a01 1a01 1a02 1201 0601  ................
+00003bd0: 0601 0601 0a01 0a01 0401 0201 0801 0201  ................
+00003be0: 0201 06fc 0c06 0a01 1002 0c01 1e01 0e01  ................
+00003bf0: 0c01 0401 0e01 0a01 1e01 0801 1001 1201  ................
+00003c00: 1401 1001 0c02 7a19 6174 6f6d 6963 5f64  ......z.atomic_d
+00003c10: 7063 2e73 686f 775f 706f 7465 6e74 6961  pc.show_potentia
+00003c20: 6c72 0100 0000 7227 0000 0072 0b00 0000  lr....r'...r....
+00003c30: 6305 0000 0000 0000 0000 0000 0015 0000  c...............
+00003c40: 0009 0000 0043 0000 0073 1003 0000 7400  .....C...s....t.
+00003c50: 7401 a002 7401 a003 7c04 a101 a101 8301  t...t...|.......
+00003c60: 7d05 6401 7c05 6402 9c02 7d06 7404 6a05  }.d.|.d...}.t.j.
+00003c70: 6419 6900 7c06 a401 8e01 0100 7c00 6a06  d.i.|.......|.j.
+00003c80: 6404 7c00 6a07 1400 1700 7d07 7408 6a09  d.|.j.....}.t.j.
+00003c90: a00a 7c07 a101 7d08 7401 a003 7c00 6a06  ..|...}.t...|.j.
+00003ca0: 6a0b a101 7c01 1400 a00c 7400 a101 7d09  j...|.....t...}.
+00003cb0: 7401 a003 7c00 6a06 6a0b a101 7c01 7c02  t...|.j.j...|.|.
+00003cc0: 1700 1400 a00c 7400 a101 7d0a 7401 6a0d  ......t...}.t.j.
+00003cd0: 6405 7c00 6a07 6a0b 6405 1900 8502 6405  d.|.j.j.d.....d.
+00003ce0: 7c00 6a06 6a0b 6406 1900 8502 6602 1900  |.j.j.d.....f...
+00003cf0: 5c02 7d0b 7d0c 7c0b 7d0b 7c0c 7c09 6405  \.}.}.|.}.|.|.d.
+00003d00: 1900 7c0a 6405 1900 8502 7c09 6406 1900  ..|.d.....|.d...
+00003d10: 7c0a 6406 1900 8502 6602 1900 7d0d 7401  |.d.....f...}.t.
+00003d20: a00e 7c0b 7c09 6405 1900 7c0a 6405 1900  ..|.|.d...|.d...
+00003d30: 8502 7c09 6406 1900 7c0a 6406 1900 8502  ..|.d...|.d.....
+00003d40: 6602 1900 a101 7d0e 7c00 6a06 7c09 6405  f.....}.|.j.|.d.
+00003d50: 1900 7c0a 6405 1900 8502 7c09 6406 1900  ..|.d.....|.d...
+00003d60: 7c0a 6406 1900 8502 6602 1900 7d0f 7c00  |.d.....f...}.|.
+00003d70: 6a07 7c09 6405 1900 7c0a 6405 1900 8502  j.|.d...|.d.....
+00003d80: 7c09 6406 1900 7c0a 6406 1900 8502 6602  |.d...|.d.....f.
+00003d90: 1900 7d10 7c08 7c09 6405 1900 7c0a 6405  ..}.|.|.d...|.d.
+00003da0: 1900 8502 7c09 6406 1900 7c0a 6406 1900  ....|.d...|.d...
+00003db0: 8502 6602 1900 7d11 7404 6a0f 6a10 7c09  ..f...}.t.j.j.|.
+00003dc0: 6405 6407 8502 1900 7c0a 6405 1900 7c09  d.d.....|.d...|.
+00003dd0: 6405 1900 1800 7c0a 6406 1900 7c09 6406  d.....|.d...|.d.
+00003de0: 1900 1800 6408 6409 640a 640b 8d06 7d12  ....d.d.d.d...}.
+00003df0: 7411 6a12 7c04 640c 8d01 0100 7411 a013  t.j.|.d.....t...
+00003e00: 6406 6407 6406 a103 0100 7411 a014 7c08  d.d.d.....t...|.
+00003e10: a101 0100 7415 a016 7c00 6a17 640d a102  ....t...|.j.d...
+00003e20: 7d13 640e 7c13 5f18 6405 7c13 5f19 6409  }.d.|._.d.|._.d.
+00003e30: 7c13 5f1a 7411 a01b a100 a01c 7c13 a101  |._.t.......|...
+00003e40: 0100 7411 a01d 640f a101 0100 741e 6a1f  ..t...d.....t.j.
+00003e50: 6410 7420 7c05 6411 8d01 6412 6413 6414  d.t |.d...d.d.d.
+00003e60: 8d04 7d14 7c14 6a21 a022 6415 a101 0100  ..}.|.j!."d.....
+00003e70: 7411 a01b a100 a01c 7c14 a101 0100 7411  t.......|.....t.
+00003e80: a01b a100 a023 7c12 a101 0100 7411 a013  .....#|.....t...
+00003e90: 6406 6407 6407 a103 0100 7411 a014 7c11  d.d.d.....t...|.
+00003ea0: a101 0100 7411 6a24 7c0d 6416 6416 7c03  ....t.j$|.d.d.|.
+00003eb0: 8503 6416 6416 7c03 8503 6602 1900 7c09  ..d.d.|...f...|.
+00003ec0: 6406 1900 1800 7c0e 6416 6416 7c03 8503  d.....|.d.d.|...
+00003ed0: 6416 6416 7c03 8503 6602 1900 7c09 6405  d.d.|...f...|.d.
+00003ee0: 1900 1800 7c0f 6416 6416 7c03 8503 6416  ....|.d.d.|...d.
+00003ef0: 6416 7c03 8503 6602 1900 7c10 6416 6416  d.|...f...|.d.d.
+00003f00: 7c03 8503 6416 6416 7c03 8503 6602 1900  |...d.d.|...f...
+00003f10: 6417 6409 6418 8d06 0100 7415 a016 7c00  d.d.d.....t...|.
+00003f20: 6a17 640d a102 7d13 640e 7c13 5f18 6405  j.d...}.d.|._.d.
+00003f30: 7c13 5f19 6409 7c13 5f1a 7411 a01b a100  |._.d.|._.t.....
+00003f40: a01c 7c13 a101 0100 7411 a01d 640f a101  ..|.....t...d...
+00003f50: 0100 7411 a025 a100 0100 6416 5300 291a  ..t..%....d.S.).
+00003f60: 6125 0200 000a 2020 2020 2020 2020 5573  a%....        Us
+00003f70: 6520 7468 6973 2074 6f20 706c 6f74 2074  e this to plot t
+00003f80: 6865 2063 6f72 7265 6374 6564 2044 5043  he corrected DPC
+00003f90: 2063 656e 7465 7220 6f66 206d 6173 7320   center of mass 
+00003fa0: 7368 6966 7473 2e20 4966 206e 6f20 7661  shifts. If no va
+00003fb0: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
+00003fc0: 6172 6520 7061 7373 6564 2c20 7468 6520  are passed, the 
+00003fd0: 6172 726f 7773 2061 7265 206f 7665 726c  arrows are overl
+00003fe0: 6169 6420 6f6e 2074 6865 2065 6e74 6972  aid on the entir
+00003ff0: 6520 696d 6167 652e 0a0a 2020 2020 2020  e image...      
+00004000: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00004010: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00004020: 2020 2020 2020 2020 7374 6172 745f 6672          start_fr
+00004030: 6163 3a20 666c 6f61 742c 206f 7074 696f  ac: float, optio
+00004040: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00004050: 2020 2020 2020 2020 5468 6520 7374 6172          The star
+00004060: 7469 6e67 2066 7261 6374 696f 6e20 6f66  ting fraction of
+00004070: 2074 6865 2069 6d61 6765 2c20 7768 6572   the image, wher
+00004080: 6520 796f 7520 7769 6c6c 2063 7574 2066  e you will cut f
+00004090: 726f 6d0a 2020 2020 2020 2020 2020 2020  rom.            
+000040a0: 2020 2020 2020 2020 746f 2073 686f 7720          to show 
+000040b0: 7468 6520 6f76 6572 6c61 6964 2061 7272  the overlaid arr
+000040c0: 6f77 732e 2044 6566 6175 6c74 2069 7320  ows. Default is 
+000040d0: 300a 2020 2020 2020 2020 7374 6f70 5f66  0.        stop_f
+000040e0: 7261 633a 2020 666c 6f61 742c 206f 7074  rac:  float, opt
+000040f0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00004100: 2020 2020 2020 2020 2020 5468 6520 656e            The en
+00004110: 6469 6e67 2066 7261 6374 696f 6e20 6f66  ding fraction of
+00004120: 2074 6865 2069 6d61 6765 2c20 7768 6572   the image, wher
+00004130: 6520 796f 7520 7769 6c6c 2063 7574 2066  e you will cut f
+00004140: 726f 6d0a 2020 2020 2020 2020 2020 2020  rom.            
+00004150: 2020 2020 2020 2020 746f 2073 686f 7720          to show 
+00004160: 7468 6520 6f76 6572 6c61 6964 2061 7272  the overlaid arr
+00004170: 6f77 732e 2044 6566 6175 6c74 2069 7320  ows. Default is 
+00004180: 310a 2020 2020 2020 2020 7260 0000 0072  1.        r`...r
+00004190: 6100 0000 da04 666f 6e74 7900 0000 0000  a.....fonty.....
+000041a0: 0000 0000 0000 0000 00f0 3f72 0100 0000  ..........?r....
+000041b0: 7227 0000 0072 0b00 0000 6700 0000 0000  r'...r....g.....
+000041c0: 00f8 3f72 2d00 0000 da04 6e6f 6e65 2903  ..?r-.....none).
+000041d0: 5a09 6c69 6e65 7769 6474 685a 0965 6467  Z.linewidthZ.edg
+000041e0: 6563 6f6c 6f72 5a09 6661 6365 636f 6c6f  ecolorZ.facecolo
+000041f0: 7272 2600 0000 72b5 0000 0072 2c00 0000  rr&...r....r,...
+00004200: 722e 0000 007a 1443 656e 7465 7220 6f66  r....z.Center of
+00004210: 204d 6173 7320 5368 6966 7472 2f00 0000   Mass Shiftr/...
+00004220: 5472 3100 0000 7232 0000 0072 3500 0000  Tr1...r2...r5...
+00004230: 4e5a 036d 6964 2902 da05 7069 766f 7472  NZ.mid)...pivotr
+00004240: 4200 0000 2901 72b7 0000 0029 2672 3700  B...).r....)&r7.
+00004250: 0000 7217 0000 0072 3800 0000 7239 0000  ..r....r8...r9..
+00004260: 00da 036d 706c da02 7263 72a7 0000 0072  ...mpl..rcr....r
+00004270: a800 0000 7210 0000 0072 5400 0000 5a0c  ....r....rT...Z.
+00004280: 6370 5f69 6d61 6765 5f76 616c 7278 0000  cp_image_valrx..
+00004290: 005a 0661 7374 7970 6572 7700 0000 5a06  .Z.astyperw...Z.
+000042a0: 666c 6970 7564 5a07 7061 7463 6865 735a  flipudZ.patchesZ
+000042b0: 0952 6563 7461 6e67 6c65 723a 0000 0072  .Rectangler:...r
+000042c0: 3b00 0000 723c 0000 0072 3d00 0000 723e  ;...r<...r=...r>
+000042d0: 0000 0072 3f00 0000 720e 0000 0072 4000  ...r?...r....r@.
+000042e0: 0000 7241 0000 0072 4200 0000 7243 0000  ..rA...rB...rC..
+000042f0: 0072 4400 0000 7225 0000 0072 4500 0000  .rD...r%...rE...
+00004300: 7246 0000 0072 4700 0000 7248 0000 0072  rF...rG...rH...r
+00004310: 4900 0000 5a09 6164 645f 7061 7463 685a  I...Z.add_patchZ
+00004320: 0671 7569 7665 7272 4a00 0000 2915 721a  .quiverrJ...).r.
+00004330: 0000 005a 0a73 7461 7274 5f66 7261 635a  ...Z.start_fracZ
+00004340: 0973 697a 655f 6672 6163 da04 736b 6970  .size_frac..skip
+00004350: 724b 0000 0072 4c00 0000 7296 0000 00da  rK...rL...r.....
+00004360: 0263 635a 0863 635f 636f 6c6f 725a 0863  .ccZ.cc_colorZ.c
+00004370: 7574 7374 6172 745a 0863 7574 5f73 746f  utstartZ.cut_sto
+00004380: 705a 0479 706f 735a 0478 706f 735a 0478  pZ.yposZ.xposZ.x
+00004390: 6375 745a 0479 6375 745a 0264 785a 0264  cutZ.ycutZ.dxZ.d
+000043a0: 795a 0663 635f 6375 745a 076f 7665 726c  yZ.cc_cutZ.overl
+000043b0: 6179 724d 0000 0072 4e00 0000 721c 0000  ayrM...rN...r...
+000043c0: 0072 1c00 0000 721d 0000 00da 0e70 6c6f  .r....r......plo
+000043d0: 745f 636f 6c6f 725f 6470 6300 0200 0073  t_color_dpc....s
+000043e0: 7200 0000 140e 0a01 1001 1001 0c01 1801  r...............
+000043f0: 1c01 2a01 0401 2401 2a01 2601 2601 2401  ..*...$.*.&.&.$.
+00004400: 0602 0a01 0e01 0e01 0201 0201 0201 06fa  ................
+00004410: 0c09 0e01 0a01 0e01 0601 0601 0601 0e01  ................
+00004420: 0a01 0401 0201 0801 0201 0201 06fc 0c06  ................
+00004430: 0e01 0e01 0e02 0a01 0401 1e01 1e01 1601  ................
+00004440: 1601 0201 0201 06fa 0e08 0601 0601 0601  ................
+00004450: 0e01 0a01 0c01 7a19 6174 6f6d 6963 5f64  ......z.atomic_d
+00004460: 7063 2e70 6c6f 745f 636f 6c6f 725f 6470  pc.plot_color_dp
+00004470: 634e 2901 721f 0000 0029 0272 5000 0000  cN).r....).rP...
+00004480: 4629 0272 5900 0000 5429 0172 5900 0000  F).rY...T).rY...
+00004490: 2901 72ad 0000 0029 0472 0100 0000 7227  ).r....).r....r'
+000044a0: 0000 0072 0b00 0000 721f 0000 0029 0cda  ...r....r....)..
+000044b0: 085f 5f6e 616d 655f 5fda 0a5f 5f6d 6f64  .__name__..__mod
+000044c0: 756c 655f 5fda 0c5f 5f71 7561 6c6e 616d  ule__..__qualnam
+000044d0: 655f 5fda 075f 5f64 6f63 5f5f 721e 0000  e__..__doc__r...
+000044e0: 0072 4f00 0000 7258 0000 0072 9d00 0000  .rO...rX...r....
+000044f0: 72ac 0000 0072 b300 0000 72b6 0000 0072  r....r....r....r
+00004500: be00 0000 721c 0000 0072 1c00 0000 721c  ....r....r....r.
+00004510: 0000 0072 1d00 0000 7209 0000 000f 0000  ...r....r.......
+00004520: 0073 1400 0000 0800 0401 0853 0a1e 0a27  .s.........S...'
+00004530: 0a1c 0a54 0a70 0a3d 0e3b 7209 0000 0029  ...T.p.=.;r....)
+00004540: 265a 0d73 6369 7079 2e6e 6469 6d61 6765  &Z.scipy.ndimage
+00004550: 5a07 6e64 696d 6167 655a 0473 636e 645a  Z.ndimageZ.scndZ
+00004560: 0e73 6369 7079 2e6f 7074 696d 697a 65da  .scipy.optimize.
+00004570: 086f 7074 696d 697a 6572 a400 0000 5a05  .optimizer....Z.
+00004580: 6e75 6d70 7972 1700 0000 da08 7374 656d  numpyr......stem
+00004590: 746f 6f6c 7210 0000 005a 116d 6174 706c  toolr....Z.matpl
+000045a0: 6f74 6c69 622e 7079 706c 6f74 5a06 7079  otlib.pyplotZ.py
+000045b0: 706c 6f74 723a 0000 005a 106d 6174 706c  plotr:...Z.matpl
+000045c0: 6f74 6c69 622e 696d 6167 65da 0569 6d61  otlib.image..ima
+000045d0: 6765 5a05 6d70 696d 675a 1c6d 6174 706c  geZ.mpimgZ.matpl
+000045e0: 6f74 6c69 625f 7363 616c 6562 6172 2e73  otlib_scalebar.s
+000045f0: 6361 6c65 6261 7272 4d00 0000 723e 0000  calebarrM...r>..
+00004600: 005a 146d 6174 706c 6f74 6c69 622e 6f66  .Z.matplotlib.of
+00004610: 6673 6574 626f 785a 096f 6666 7365 7462  fsetboxZ.offsetb
+00004620: 6f78 7245 0000 005a 136d 6174 706c 6f74  oxrE...Z.matplot
+00004630: 6c69 622e 6772 6964 7370 6563 5a08 6772  lib.gridspecZ.gr
+00004640: 6964 7370 6563 7281 0000 005a 0a6d 6174  idspecr....Z.mat
+00004650: 706c 6f74 6c69 6272 ba00 0000 da06 7479  plotlibr......ty
+00004660: 7069 6e67 7202 0000 0072 0300 0000 5a08  pingr....r....Z.
+00004670: 6e70 7479 7069 6e67 7204 0000 0072 0500  nptypingr....r..
+00004680: 0000 7206 0000 0072 0700 0000 7208 0000  ..r....r....r...
+00004690: 00da 066f 626a 6563 7472 0900 0000 721c  ...objectr....r.
+000046a0: 0000 0072 1c00 0000 721c 0000 0072 1d00  ...r....r....r..
+000046b0: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
+000046c0: 731a 0000 000c 000c 0108 0108 010c 010c  s...............
+000046d0: 010c 010c 010c 0108 0110 011c 0114 03    ...............
```

## Comparing `stemtool/dpc/__pycache__/dpc_utils.cpython-39.pyc` & `stemtool/dpc/__pycache__/dpc_utils.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:07:48 2023 UTC, .py size: 8339 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 16% similar despite different names*

```diff
@@ -1,413 +1,418 @@
-00000000: 610d 0d0a 0000 0000 e433 e163 9320 0000  a........3.c. ..
+00000000: 6f0d 0d0a 0000 0000 0b96 3c63 9320 0000  o.........<c. ..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 000b 0000 0040 0000 0073 4002 0000 6400  .....@...s@...d.
+00000020: 0013 0000 0040 0000 0073 8402 0000 6400  .....@...s....d.
 00000030: 6401 6c00 6d01 5a02 0100 6400 6401 6c03  d.l.m.Z...d.d.l.
 00000040: 6d04 5a05 0100 6400 6401 6c06 5a07 6400  m.Z...d.d.l.Z.d.
 00000050: 6401 6c08 5a09 6400 6402 6c0a 6d0b 5a0b  d.l.Z.d.d.l.m.Z.
 00000060: 0100 6400 6403 6c0c 6d0d 5a0d 6d0e 5a0e  ..d.d.l.m.Z.m.Z.
 00000070: 0100 6400 6404 6c0f 6d10 5a10 6d11 5a11  ..d.d.l.m.Z.m.Z.
 00000080: 6d12 5a12 6d13 5a13 6d14 5a14 6d15 5a15  m.Z.m.Z.m.Z.m.Z.
-00000090: 0100 6510 6511 6405 1900 650d 6602 1900  ..e.e.d...e.f...
-000000a0: 6510 6511 6405 1900 650d 6602 1900 650e  e.e.d...e.f...e.
-000000b0: 6510 6511 6405 1900 6513 6602 1900 6510  e.e.d...e.f...e.
-000000c0: 6511 6405 1900 6513 6602 1900 6602 1900  e.d...e.f...f...
-000000d0: 6406 9c03 6407 6408 8404 5a16 6510 6511  d...d.d...Z.e.e.
-000000e0: 6405 1900 650d 6602 1900 6510 6511 6405  d...e.f...e.e.d.
-000000f0: 1900 650d 6602 1900 650e 6510 6511 6405  ..e.f...e.e.e.d.
-00000100: 1900 6513 6602 1900 6510 6511 6405 1900  ..e.f...e.e.d...
-00000110: 6513 6602 1900 6602 1900 6409 9c03 640a  e.f...f...d...d.
-00000120: 640b 8404 5a17 6513 6510 6511 640c 1900  d...Z.e.e.e.d...
-00000130: 6513 6602 1900 6510 6511 640c 1900 6513  e.f...e.e.d...e.
-00000140: 6602 1900 6513 640d 9c04 640e 640f 8404  f...e.d...d.d...
-00000150: 5a18 6510 6511 640c 1900 6513 6602 1900  Z.e.e.d...e.f...
-00000160: 6510 6511 640c 1900 6513 6602 1900 650e  e.e.d...e.f...e.
-00000170: 6513 6513 6602 1900 6410 9c03 6411 6412  e.e.f...d...d.d.
-00000180: 8404 5a19 6510 6511 640c 1900 650d 6602  ..Z.e.e.d...e.f.
-00000190: 1900 6513 6513 6513 6513 6510 6511 640c  ..e.e.e.e.e.e.d.
-000001a0: 1900 6513 6602 1900 6413 9c06 6414 6415  ..e.f...d...d.d.
-000001b0: 8404 5a1a 6422 6510 6511 640c 1900 6513  ..Z.d"e.e.d...e.
-000001c0: 6602 1900 6510 6511 640c 1900 6513 6602  f...e.e.d...e.f.
-000001d0: 1900 6512 6513 6513 6513 6512 6510 6511  ..e.e.e.e.e.e.e.
-000001e0: 640c 1900 6513 6602 1900 641a 9c08 641b  d...e.f...d...d.
-000001f0: 641c 8405 5a1b 6423 6510 6511 640c 1900  d...Z.d#e.e.d...
-00000200: 6513 6602 1900 6510 6511 640c 1900 6513  e.f...e.e.d...e.
-00000210: 6602 1900 6513 6510 6511 640c 1900 6513  f...e.e.e.d...e.
-00000220: 6602 1900 641d 9c04 641e 641f 8405 5a1c  f...d...d.d...Z.
-00000230: 6424 6510 6511 640c 1900 6513 6602 1900  d$e.e.d...e.f...
-00000240: 6510 6511 640c 1900 6513 6602 1900 6513  e.e.d...e.f...e.
-00000250: 6510 6511 640c 1900 6513 6602 1900 641d  e.e.d...e.f...d.
-00000260: 9c04 6420 6421 8405 5a1d 6401 5300 2925  ..d d!..Z.d.S.)%
-00000270: e900 0000 004e 2901 da06 7472 616e 6765  .....N)...trange
-00000280: 2902 da03 416e 79da 0554 7570 6c65 2906  )...Any..Tuple).
-00000290: da07 4e44 4172 7261 79da 0553 6861 7065  ..NDArray..Shape
-000002a0: da03 496e 74da 0546 6c6f 6174 da04 426f  ..Int..Float..Bo
-000002b0: 6f6c da07 436f 6d70 6c65 78da 012a 2903  ol..Complex..*).
-000002c0: da01 78da 0179 da06 7265 7475 726e 6302  ..x..y..returnc.
-000002d0: 0000 0000 0000 0000 0000 0004 0000 0004  ................
-000002e0: 0000 0043 0000 0073 2800 0000 7c00 6401  ...C...s(...|.d.
-000002f0: 1300 7c01 6401 1300 1700 6402 1300 7d02  ..|.d.....d...}.
-00000300: 7400 a001 7c01 7c00 a102 7d03 7c02 7c03  t...|.|...}.|.|.
-00000310: 6602 5300 2903 4ee9 0200 0000 e700 0000  f.S.).N.........
-00000320: 0000 00e0 3f29 02da 026e 705a 0761 7263  ....?)...npZ.arc
-00000330: 7461 6e32 2904 720c 0000 0072 0d00 0000  tan2).r....r....
-00000340: da03 7268 6fda 0370 6869 a900 7214 0000  ..rho..phi..r...
-00000350: 00fa 3c62 7569 6c64 2f62 6469 7374 2e6d  ..<build/bdist.m
-00000360: 6163 6f73 782d 3130 2e39 2d78 3836 5f36  acosx-10.9-x86_6
-00000370: 342f 6567 672f 7374 656d 746f 6f6c 2f64  4/egg/stemtool/d
-00000380: 7063 2f64 7063 5f75 7469 6c73 2e70 79da  pc/dpc_utils.py.
-00000390: 0863 6172 7432 706f 6c0a 0000 0073 0600  .cart2pol....s..
-000003a0: 0000 0003 1401 0c01 7216 0000 0029 0372  ........r....).r
-000003b0: 1200 0000 7213 0000 0072 0e00 0000 6302  ....r....r....c.
-000003c0: 0000 0000 0000 0000 0000 0004 0000 0004  ................
-000003d0: 0000 0043 0000 0073 2400 0000 7c00 7400  ...C...s$...|.t.
-000003e0: a001 7c01 a101 1400 7d02 7c00 7400 a002  ..|.....}.|.t...
-000003f0: 7c01 a101 1400 7d03 7c02 7c03 6602 5300  |.....}.|.|.f.S.
-00000400: 2901 4e29 0372 1100 0000 da03 636f 73da  ).N).r......cos.
-00000410: 0373 696e 2904 7212 0000 0072 1300 0000  .sin).r....r....
-00000420: 720c 0000 0072 0d00 0000 7214 0000 0072  r....r....r....r
-00000430: 1400 0000 7215 0000 00da 0870 6f6c 3263  ....r......pol2c
-00000440: 6172 7412 0000 0073 0600 0000 0003 0e01  art....s........
-00000450: 0e01 7219 0000 007a 042a 2c20 2a29 04da  ..r....z.*, *)..
-00000460: 0761 6e67 6c65 5f64 da07 7268 6f5f 6470  .angle_d..rho_dp
-00000470: 63da 0770 6869 5f64 7063 720e 0000 0063  c..phi_dpcr....c
-00000480: 0300 0000 0000 0000 0000 0000 0b00 0000  ................
-00000490: 0500 0000 4300 0000 7380 0000 007c 0074  ....C...s....|.t
-000004a0: 006a 0164 011b 0014 007d 037c 027c 0317  .j.d.....}.|.|..
-000004b0: 007d 0474 026a 03a0 047c 01a0 05a1 007c  .}.t.j...|.....|
-000004c0: 04a0 05a1 00a1 025c 027d 057d 0674 006a  .......\.}.}.t.j
-000004d0: 067c 057c 016a 0764 028d 027d 0774 006a  .|.|.j.d...}.t.j
-000004e0: 067c 067c 016a 0764 028d 027d 0874 00a0  .|.|.j.d...}.t..
-000004f0: 087c 07a1 0164 0319 0074 00a0 087c 08a1  .|...d...t...|..
-00000500: 0164 0419 0017 007d 0974 00a0 0974 00a0  .d.....}.t...t..
-00000510: 0a7c 09a1 01a1 017d 0a7c 0a53 0029 054e  .|.....}.|.S.).N
-00000520: e9b4 0000 00a9 015a 086e 6577 7368 6170  .......Z.newshap
-00000530: 65e9 0100 0000 7201 0000 0029 0b72 1100  e.....r....).r..
-00000540: 0000 da02 7069 da02 7374 da03 6470 6372  ....pi..st..dpcr
-00000550: 1900 0000 da05 7261 7665 6cda 0772 6573  ......ravel..res
-00000560: 6861 7065 da05 7368 6170 65da 0867 7261  hape..shape..gra
-00000570: 6469 656e 74da 0373 756d da03 6162 7329  dient..sum..abs)
-00000580: 0b72 1a00 0000 721b 0000 0072 1c00 0000  .r....r....r....
-00000590: 5a07 616e 676c 655f 725a 076e 6577 5f70  Z.angle_rZ.new_p
-000005a0: 6869 5a09 785f 6470 635f 7276 6c5a 0979  hiZ.x_dpc_rvlZ.y
-000005b0: 5f64 7063 5f72 766c da05 785f 6470 63da  _dpc_rvl..x_dpc.
-000005c0: 0579 5f64 7063 da06 6368 6172 6765 5a09  .y_dpc..chargeZ.
-000005d0: 616e 676c 655f 7375 6d72 1400 0000 7214  angle_sumr....r.
-000005e0: 0000 0072 1500 0000 da09 616e 676c 655f  ...r......angle_
-000005f0: 6675 6e1a 0000 0073 1200 0000 0005 0e01  fun....s........
-00000600: 0801 1a01 1001 1002 1aff 0203 1001 722c  ..............r,
-00000610: 0000 0029 0372 1b00 0000 721c 0000 0072  ...).r....r....r
-00000620: 0e00 0000 6302 0000 0000 0000 0000 0000  ....c...........
-00000630: 0007 0000 0005 0000 0043 0000 0073 3600  .........C...s6.
-00000640: 0000 6401 7d02 7400 6a01 7402 7c02 7c00  ..d.}.t.j.t.|.|.
-00000650: 7c01 6602 6402 8d03 7d03 7c03 6a03 7d04  |.f.d...}.|.j.}.
-00000660: 7c04 6401 1800 7d05 7c04 6401 1700 7d06  |.d...}.|.d...}.
-00000670: 7c05 7c06 6602 5300 2903 4ee9 5a00 0000  |.|.f.S.).N.Z...
-00000680: 2901 da04 6172 6773 2904 da03 7369 6f5a  )...args)...sioZ
-00000690: 086d 696e 696d 697a 6572 2c00 0000 720c  .minimizer,...r.
-000006a0: 0000 0029 0772 1b00 0000 721c 0000 005a  ...).r....r....Z
-000006b0: 0278 3072 0c00 0000 5a05 6d69 6e5f 785a  .x0r....Z.min_xZ
-000006c0: 0473 6f6c 315a 0473 6f6c 3272 1400 0000  .sol1Z.sol2r....
-000006d0: 7214 0000 0072 1500 0000 da0e 6f70 7469  r....r......opti
-000006e0: 6d69 7a65 5f61 6e67 6c65 2b00 0000 730c  mize_angle+...s.
-000006f0: 0000 0000 0304 0114 0106 0108 0108 0172  ...............r
-00000700: 3000 0000 2906 da0c 6362 6564 5f70 6174  0...)...cbed_pat
-00000710: 7465 726e da08 726f 7461 6e67 6c65 da07  tern..rotangle..
-00000720: 7863 656e 7465 72da 0779 6365 6e74 6572  xcenter..ycenter
-00000730: da0b 6461 7461 5f72 6164 6975 7372 0e00  ..data_radiusr..
-00000740: 0000 6305 0000 0000 0000 0000 0000 000c  ..c.............
-00000750: 0000 000a 0000 0043 0000 0073 ae00 0000  .......C...s....
-00000760: 7400 a001 7c00 a101 7d05 7400 6a02 6401  t...|...}.t.j.d.
-00000770: 7c05 6401 1900 8502 6401 7c05 6402 1900  |.d.....d.|.d...
-00000780: 8502 6602 1900 5c02 7d06 7d07 7c06 7c03  ..f...\.}.}.|.|.
-00000790: 1800 6403 1300 7c07 7c02 1800 6403 1300  ..d...|.|...d...
-000007a0: 1700 6404 1300 6405 7c04 1400 6b04 7d08  ..d...d.|...k.}.
-000007b0: 7400 a003 7404 a005 7c00 6406 a102 a101  t...t...|.d.....
-000007c0: 7d09 7400 a006 7407 6a08 a009 7c00 7c02  }.t...t.j...|.|.
-000007d0: 6404 7c05 6402 1900 1400 1800 7c03 6404  d.|.d.......|.d.
-000007e0: 7c05 6401 1900 1400 1800 a103 a101 7d0a  |.d...........}.
-000007f0: 7404 6a0a 7c0a 7c01 6407 6408 6409 8d04  t.j.|.|.d.d.d...
-00000800: 7d0b 7c09 7c0b 7c08 3c00 7c0b 5300 290a  }.|.|.|.<.|.S.).
-00000810: 4e72 0100 0000 721f 0000 0072 0f00 0000  Nr....r....r....
-00000820: 7210 0000 0067 a470 3d0a d7a3 f03f e90f  r....g.p=....?..
-00000830: 0000 00e9 0500 0000 4629 02da 056f 7264  ........F)...ord
-00000840: 6572 7224 0000 0029 0b72 1100 0000 7225  err$...).r....r%
-00000850: 0000 005a 056d 6772 6964 5a04 616d 696e  ...Z.mgridZ.amin
-00000860: da04 7363 6e64 5a0d 6d65 6469 616e 5f66  ..scndZ.median_f
-00000870: 696c 7465 7272 2800 0000 7221 0000 00da  ilterr(...r!....
-00000880: 0475 7469 6c5a 0d6d 6f76 655f 6279 5f70  .utilZ.move_by_p
-00000890: 6861 7365 da06 726f 7461 7465 290c 7231  hase..rotate).r1
-000008a0: 0000 0072 3200 0000 7233 0000 0072 3400  ...r2...r3...r4.
-000008b0: 0000 7235 0000 00da 0964 6174 615f 7369  ..r5.....data_si
-000008c0: 7a65 5a02 7956 5a02 7856 da04 6d61 736b  zeZ.yVZ.xV..mask
-000008d0: 5a08 6362 6564 5f6d 696e 5a0a 6d6f 7665  Z.cbed_minZ.move
-000008e0: 645f 6362 6564 5a0c 726f 7461 7465 645f  d_cbedZ.rotated_
-000008f0: 6362 6564 7214 0000 0072 1400 0000 7215  cbedr....r....r.
-00000900: 0000 00da 0c64 6174 615f 726f 7461 746f  .....data_rotato
-00000910: 7236 0000 0073 2400 0000 0007 0a01 2202  r6...s$.......".
-00000920: 1a01 06fe 0403 1201 0401 0601 0201 0e01  ................
-00000930: 0efd 02ff 0407 0401 08ff 0603 0801 723e  ..............r>
-00000940: 0000 00e9 0400 0000 7210 0000 00e9 6400  ........r.....d.
-00000950: 0000 e79a 9999 9999 99c9 3f29 08da 0678  ..........?)...x
-00000960: 7368 6966 74da 0679 7368 6966 74da 0470  shift..yshift..p
-00000970: 6164 66da 026c 50da 0268 50da 0873 7465  adf..lP..hP..ste
-00000980: 7073 697a 65da 0a69 7465 725f 636f 756e  psize..iter_coun
-00000990: 7472 0e00 0000 6307 0000 0000 0000 0000  tr....c.........
-000009a0: 0000 001c 0000 000a 0000 0043 0000 0073  ...........C...s
-000009b0: ec02 0000 7400 a001 7c00 6a02 a101 7d07  ....t...|.j...}.
-000009c0: 7c07 7c02 1400 a003 7404 a101 7d08 7400  |.|.....t...}.t.
-000009d0: 6a05 a006 7c08 6401 1900 a101 7d09 7400  j...|.d.....}.t.
-000009e0: 6a05 a007 7c08 6402 1900 a101 7d0a 7c09  j...|.d.....}.|.
-000009f0: 6403 6403 8502 6403 6602 1900 6404 1300  d.d...d.f...d...
-00000a00: 7c0a 6403 6403 6403 8502 6602 1900 6404  |.d.d.d...f...d.
-00000a10: 1300 1700 7d0b 7c0b 7c04 1700 7c0b 6404  ....}.|.|...|.d.
-00000a20: 1300 7c03 1400 1700 7d0c 7400 6a08 6405  ..|.....}.t.j.d.
-00000a30: 6406 8d01 7d0d 6407 7c0c 1b00 7d0c 6401  d...}.d.|...}.d.
-00000a40: 7c0c 6408 3c00 7400 6a08 6409 6406 8d01  |.d.<.t.j.d.d...
-00000a50: 7d0d 640a 7c05 1400 7d0e 7c0e 7c09 6403  }.d.|...}.|.|.d.
-00000a60: 6403 8502 6403 6602 1900 1400 7c0c 1400  d...d.f.....|...
-00000a70: 7d0f 7c0e 7c0a 6403 6403 6403 8502 6602  }.|.|.d.d.d...f.
-00000a80: 1900 1400 7c0c 1400 7d10 7400 6a09 7c08  ....|...}.t.j.|.
-00000a90: 7400 6a0a 640b 8d02 7d11 7400 a00b 7c11  t.j.d...}.t...|.
-00000aa0: a101 7d12 7400 a00b 7c11 a101 7d13 7400  ..}.t...|...}.t.
-00000ab0: a00b 7c11 a101 7d14 7400 a009 7c06 a101  ..|...}.t...|...
-00000ac0: 7d15 7400 6a0b 7c11 740c 640c 8d02 7d16  }.t.j.|.t.d...}.
-00000ad0: 640d 7c16 7404 640e 7c08 6401 1900 7c07  d.|.t.d.|.d...|.
-00000ae0: 6401 1900 1800 1400 8301 7404 640e 7c08  d.........t.d.|.
-00000af0: 6401 1900 7c07 6401 1900 1700 1400 8301  d...|.d.........
-00000b00: 8502 7404 640e 7c08 6402 1900 7c07 6402  ..t.d.|.d...|.d.
-00000b10: 1900 1800 1400 8301 7404 640e 7c08 6402  ........t.d.|.d.
-00000b20: 1900 7c07 6402 1900 1700 1400 8301 8502  ..|.d...........
-00000b30: 6602 3c00 7c16 640f 6b02 7d17 740d 7c06  f.<.|.d.k.}.t.|.
-00000b40: 8301 4400 9001 5d42 7d18 7c13 7c16 0500  ..D...]B}.|.|...
-00000b50: 1900 7c00 a00e a100 3800 0300 3c00 7c14  ..|.....8...<.|.
-00000b60: 7c16 0500 1900 7c01 a00e a100 3800 0300  |.....|.....8...
-00000b70: 3c00 6401 7c13 7c17 3c00 6401 7c14 7c17  <.d.|.|.<.d.|.|.
-00000b80: 3c00 7c12 7400 6a05 a00f 7400 6a05 a010  <.|.t.j...t.j...
-00000b90: 7c13 a101 7c0f 1400 7400 6a05 a010 7c14  |...|...t.j...|.
-00000ba0: a101 7c10 1400 1700 a101 3700 7d12 7c11  ..|.......7.}.|.
-00000bb0: 7411 a012 7c05 7c12 1400 6402 a102 3700  t...|.|...d...7.
-00000bc0: 7d11 7400 6a13 7c11 6410 6411 6412 8d03  }.t.j.|.d.d.d...
-00000bd0: 7400 6a13 7c11 6413 6411 6412 8d03 1800  t.j.|.d.d.d.....
-00000be0: 6414 1b00 7d13 7400 6a13 7c11 6415 6411  d...}.t.j.|.d.d.
-00000bf0: 6412 8d03 7400 6a13 7c11 6411 6411 6412  d...t.j.|.d.d.d.
-00000c00: 8d03 1800 6414 1b00 7d14 7c13 7c16 1900  ....d...}.|.|...
-00000c10: 7c00 a00e a100 1800 7d19 7c14 7c16 1900  |.......}.|.|...
-00000c20: 7c01 a00e a100 1800 7d1a 7400 a014 7400  |.......}.t...t.
-00000c30: a015 7c19 7400 a015 7c19 a101 1800 6404  ..|.t...|.....d.
-00000c40: 1300 7c1a 7400 a015 7c1a a101 1800 6404  ..|.t...|.....d.
-00000c50: 1300 1700 a101 a101 7c15 7c18 3c00 7c18  ........|.|.<.|.
-00000c60: 6401 6b04 9001 7290 7c15 7c18 1900 7c15  d.k...r.|.|...|.
-00000c70: 7c18 6402 1800 1900 6b04 9001 7290 7c05  |.d.....k...r.|.
-00000c80: 6404 1d00 7d05 9001 7190 7400 6a16 7c11  d...}...q.t.j.|.
-00000c90: 7c16 1900 7c07 6416 8d02 7d1b 7c1b 5300  |...|.d...}.|.S.
-00000ca0: 2917 61f1 0500 000a 2020 2020 496e 7465  ).a.....    Inte
-00000cb0: 6772 6174 6520 4450 4320 7368 6966 7473  grate DPC shifts
-00000cc0: 2075 7369 6e67 2046 6f75 7269 6572 2074   using Fourier t
-00000cd0: 7261 6e73 666f 726d 7320 616e 640a 2020  ransforms and.  
-00000ce0: 2020 7072 6576 656e 7469 6e67 2065 6467    preventing edg
-00000cf0: 6520 6566 6665 6374 730a 0a20 2020 2050  e effects..    P
-00000d00: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000d10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078 7368  --------.    xsh
-00000d20: 6966 743a 2020 2020 2042 6561 6d20 7368  ift:     Beam sh
-00000d30: 6966 7420 696e 2074 6865 2058 2064 696d  ift in the X dim
-00000d40: 656e 7369 6f6e 0a20 2020 2079 7368 6966  ension.    yshif
-00000d50: 743a 2020 2020 2042 6561 6d20 7368 6966  t:     Beam shif
-00000d60: 7420 696e 2074 6865 2058 2064 696d 656e  t in the X dimen
-00000d70: 7369 6f6e 730a 2020 2020 7061 6466 3a20  sions.    padf: 
-00000d80: 2020 2020 2020 7061 6464 696e 6720 6661        padding fa
-00000d90: 6374 6f72 2066 6f72 2061 6363 7572 6174  ctor for accurat
-00000da0: 6520 4646 542c 0a20 2020 2020 2020 2020  e FFT,.         
-00000db0: 2020 2020 2020 2064 6566 6175 6c74 2069         default i
-00000dc0: 7320 340a 2020 2020 6c50 3a20 2020 2020  s 4.    lP:     
-00000dd0: 2020 2020 6c6f 7720 7061 7373 2066 696c      low pass fil
-00000de0: 7465 722c 2064 6566 6175 6c74 2069 7320  ter, default is 
-00000df0: 302e 350a 2020 2020 6850 3a20 2020 2020  0.5.    hP:     
-00000e00: 2020 2020 6869 6768 2070 6173 7320 6669      high pass fi
-00000e10: 6c74 6572 2c20 6465 6661 756c 7420 6973  lter, default is
-00000e20: 2031 3030 0a20 2020 2073 7465 7073 697a   100.    stepsiz
-00000e30: 653a 2020 2066 7261 6374 696f 6e20 6f66  e:   fraction of
-00000e40: 2070 6861 7365 2064 6966 6665 726e 6365   phase differnce
-00000e50: 2074 6f20 7570 6461 7465 2065 7665 7279   to update every
-00000e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000e70: 2069 7465 7261 7469 6f6e 2e20 4465 6661   iteration. Defa
-00000e80: 756c 7420 6973 2030 2e35 2e20 5468 6973  ult is 0.5. This
-00000e90: 2069 7320 6120 6479 6e61 6d69 630a 2020   is a dynamic.  
-00000ea0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-00000eb0: 6374 6f72 2c20 616e 6420 6973 2072 6564  ctor, and is red
-00000ec0: 7563 6564 2069 6620 7468 6520 6572 726f  uced if the erro
-00000ed0: 7220 7374 6172 7473 0a20 2020 2020 2020  r starts.       
-00000ee0: 2020 2020 2020 2020 2069 6e63 7265 6173           increas
-00000ef0: 696e 670a 2020 2020 6974 6572 5f63 6f75  ing.    iter_cou
-00000f00: 6e74 3a20 4e75 6d62 6572 206f 6620 6974  nt: Number of it
-00000f10: 6572 6174 696f 6e73 2074 6f20 7275 6e2e  erations to run.
-00000f20: 2044 6566 6175 6c74 2069 7320 3130 300a   Default is 100.
-00000f30: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00000f40: 202d 2d2d 2d2d 2d2d 0a20 2020 2070 6861   -------.    pha
-00000f50: 7365 5f66 696e 616c 3a20 5068 6173 6520  se_final: Phase 
-00000f60: 6f66 2074 6865 206d 6174 7269 7820 7468  of the matrix th
-00000f70: 6174 206c 6561 6473 2074 6f20 7468 6520  at leads to the 
-00000f80: 6469 7370 6c61 6365 6d65 6e74 0a0a 2020  displacement..  
-00000f90: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00000fa0: 2d0a 2020 2020 5468 6973 2069 7320 6261  -.    This is ba
-00000fb0: 7365 6420 6f6e 2074 776f 2069 6465 6173  sed on two ideas
-00000fc0: 202d 2069 7465 7261 7469 7665 2063 6f6d   - iterative com
-00000fd0: 706c 6578 2070 6c61 6e65 0a20 2020 2069  plex plane.    i
-00000fe0: 6e74 6567 7261 7469 6f6e 2061 6e64 2061  ntegration and a
-00000ff0: 6e74 6973 796d 6d65 7472 6963 206d 6972  ntisymmetric mir
-00001000: 726f 7220 696e 7465 6772 6174 696f 6e2e  ror integration.
-00001010: 2046 6972 7374 0a20 2020 2074 776f 2061   First.    two a
-00001020: 6e74 6973 796d 6d65 7472 6963 206d 6174  ntisymmetric mat
-00001030: 7269 6365 7320 6172 6520 6765 6e65 7261  rices are genera
-00001040: 7465 6420 666f 7220 6561 6368 206f 6620  ted for each of 
-00001050: 7468 650a 2020 2020 7820 7368 6966 7420  the.    x shift 
-00001060: 616e 6420 7920 7368 6966 7473 2e20 5468  and y shifts. Th
-00001070: 656e 2074 6865 7920 6172 6520 696e 7465  en they are inte
-00001080: 6772 6174 6564 2069 6e20 466f 7572 6965  grated in Fourie
-00001090: 720a 2020 2020 7370 6163 6520 6173 2070  r.    space as p
-000010a0: 6572 2074 6865 2069 6465 6120 6f66 2063  er the idea of c
-000010b0: 6f6d 706c 6578 2069 6e74 6567 7261 7469  omplex integrati
-000010c0: 6f6e 2e20 4669 6e61 6c6c 792c 2061 0a20  on. Finally, a. 
-000010d0: 2020 2073 7562 2d6d 6174 7269 7820 6973     sub-matrix is
-000010e0: 2074 616b 656e 206f 7574 2066 726f 6d20   taken out from 
-000010f0: 7468 6520 616e 7469 7379 6d6d 6574 7269  the antisymmetri
-00001100: 6320 696e 7465 6772 616e 640a 2020 2020  c integrand.    
-00001110: 6d61 7472 6978 2074 6f20 6769 7665 2074  matrix to give t
-00001120: 6865 2064 7063 2069 6e74 6567 7261 6e64  he dpc integrand
-00001130: 0a0a 2020 2020 5265 6665 7265 6e63 6573  ..    References
-00001140: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00001150: 2020 2020 2e2e 205b 315d 2049 7368 697a      .. [1] Ishiz
-00001160: 756b 612c 2041 6b69 6d69 7473 752c 204d  uka, Akimitsu, M
-00001170: 6173 6161 6b69 204f 6b61 2c20 5461 6b65  asaaki Oka, Take
-00001180: 6869 746f 2053 656b 692c 204e 616f 7961  hito Seki, Naoya
-00001190: 2053 6869 6261 7461 2c0a 2020 2020 2020   Shibata,.      
-000011a0: 2020 616e 6420 4b61 7a75 6f20 4973 6869    and Kazuo Ishi
-000011b0: 7a75 6b61 2e20 2242 6f75 6e64 6172 792d  zuka. "Boundary-
-000011c0: 6172 7469 6661 6374 2d66 7265 6520 6465  artifact-free de
-000011d0: 7465 726d 696e 6174 696f 6e20 6f66 0a20  termination of. 
-000011e0: 2020 2020 2020 2070 6f74 656e 7469 616c         potential
-000011f0: 2064 6973 7472 6962 7574 696f 6e20 6672   distribution fr
-00001200: 6f6d 2064 6966 6665 7265 6e74 6961 6c20  om differential 
-00001210: 7068 6173 6520 636f 6e74 7261 7374 2073  phase contrast s
-00001220: 6967 6e61 6c73 2e22 0a20 2020 2020 2020  ignals.".       
-00001230: 204d 6963 726f 7363 6f70 7920 3636 2c20   Microscopy 66, 
-00001240: 6e6f 2e20 3620 2832 3031 3729 3a20 3339  no. 6 (2017): 39
-00001250: 372d 3430 352e 0a0a 2020 2020 3a41 7574  7-405...    :Aut
-00001260: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
-00001270: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
-00001280: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
-00001290: 6f76 3e0a 2020 2020 7201 0000 0072 1f00  ov>.    r....r..
-000012a0: 0000 4e72 0f00 0000 da06 6967 6e6f 7265  ..Nr......ignore
-000012b0: 2901 da06 6469 7669 6465 6700 0000 0000  )...divideg.....
-000012c0: 00f0 3f29 0272 0100 0000 7201 0000 00da  ..?).r....r.....
-000012d0: 0477 6172 6e79 0000 0000 0000 0000 0000  .warny..........
-000012e0: 0000 0000 d03f 2902 7225 0000 00da 0564  .....?).r%.....d
-000012f0: 7479 7065 2901 724c 0000 0054 7210 0000  type).rL...Tr...
-00001300: 0046 2902 e9ff ffff ff72 0100 0000 2902  .F)......r....).
-00001310: 7201 0000 0072 1f00 0000 2901 5a04 6178  r....r....).Z.ax
-00001320: 6973 2902 721f 0000 0072 0100 0000 6700  is).r....r....g.
-00001330: 0000 0000 0000 4029 0272 0100 0000 724d  ......@).r....rM
-00001340: 0000 0072 1e00 0000 2917 7211 0000 005a  ...r....).r....Z
-00001350: 0761 7361 7272 6179 7225 0000 005a 0661  .asarrayr%...Z.a
-00001360: 7374 7970 65da 0369 6e74 5a03 6666 745a  stype..intZ.fftZ
-00001370: 0766 6674 6672 6571 5a08 7266 6674 6672  .fftfreqZ.rfftfr
-00001380: 6571 5a06 7365 7465 7272 5a05 7a65 726f  eqZ.seterrZ.zero
-00001390: 735a 0766 6c6f 6174 3634 da0a 7a65 726f  sZ.float64..zero
-000013a0: 735f 6c69 6b65 da04 626f 6f6c 7202 0000  s_like..boolr...
-000013b0: 0072 2300 0000 5a06 6972 6666 7432 5a05  .r#...Z.irfft2Z.
-000013c0: 7266 6674 3272 3900 0000 5a0f 6761 7573  rfft2r9...Z.gaus
-000013d0: 7369 616e 5f66 696c 7465 725a 0472 6f6c  sian_filterZ.rol
-000013e0: 6cda 0473 7172 74da 046d 6561 6e72 2400  l..sqrt..meanr$.
-000013f0: 0000 291c 7242 0000 0072 4300 0000 7244  ..).rB...rC...rD
-00001400: 0000 0072 4500 0000 7246 0000 0072 4700  ...rE...rF...rG.
-00001410: 0000 7248 0000 005a 0769 6d73 6861 7065  ..rH...Z.imshape
-00001420: 5a08 7061 6473 6861 7065 5a02 7178 5a02  Z.padshapeZ.qxZ.
-00001430: 7179 5a03 7172 32da 0b64 656e 6f6d 696e  qyZ.qr2..denomin
-00001440: 6174 6f72 da01 5fda 0166 5a0a 7178 4f70  ator.._..fZ.qxOp
-00001450: 6572 6174 6f72 5a0a 7179 4f70 6572 6174  eratorZ.qyOperat
-00001460: 6f72 5a0c 7061 6464 6564 5f70 6861 7365  orZ.padded_phase
-00001470: da06 7570 6461 7465 5a02 6478 5a02 6479  ..updateZ.dxZ.dy
-00001480: da05 6572 726f 7272 3d00 0000 5a07 6d61  ..errorr=...Z.ma
-00001490: 736b 496e 76da 0269 695a 0578 4469 6666  skInv..iiZ.xDiff
-000014a0: 5a05 7944 6966 665a 0b70 6861 7365 5f66  Z.yDiffZ.phase_f
-000014b0: 696e 616c 7214 0000 0072 1400 0000 7215  inalr....r....r.
-000014c0: 0000 00da 0d69 6e74 6567 7261 7465 5f64  .....integrate_d
-000014d0: 7063 5100 0000 7372 0000 0000 330c 010e  pcQ...sr....3...
-000014e0: 0110 0110 0128 0214 010c 0108 0108 010c  .....(..........
-000014f0: 0108 0118 0118 0204 0106 ff06 030a 010a  ................
-00001500: 010a 010a 010e 0402 fd02 012e 012e ff02  ................
-00001510: ff02 0408 010e 0114 0114 0108 0108 012c  ...............,
-00001520: 0114 020e 010e ff02 0202 fd04 050e 010e  ................
-00001530: ff02 0202 fd04 0410 0110 0104 0128 ff08  .............(..
-00001540: 030a 0116 010c 0104 0108 ff06 0372 5900  .............rY.
-00001550: 0000 2904 7229 0000 0072 2a00 0000 da05  ..).r)...r*.....
-00001560: 616e 676c 6572 0e00 0000 6303 0000 0000  angler....c.....
-00001570: 0000 0000 0000 0006 0000 0006 0000 0043  ...............C
-00001580: 0000 0073 5e00 0000 7400 a001 7c00 a101  ...s^...t...|...
-00001590: 7d03 7c02 6401 6b02 7222 7402 6a03 a004  }.|.d.k.r"t.j...
-000015a0: 7c00 7c01 a102 7d03 6e38 7405 7c00 7c01  |.|...}.n8t.|.|.
-000015b0: 8302 5c02 7d04 7d05 7406 7c04 7c05 7c02  ..\.}.}.t.|.|.|.
-000015c0: 7400 6a07 6402 1b00 1400 1700 8302 5c02  t.j.d.........\.
-000015d0: 7d00 7d01 7402 6a03 a004 7c00 7c01 a102  }.}.t.j...|.|...
-000015e0: 7d03 7c03 5300 2903 4e72 0100 0000 721d  }.|.S.).Nr....r.
-000015f0: 0000 0029 0872 1100 0000 724f 0000 0072  ...).r....rO...r
-00001600: 2100 0000 7222 0000 0072 5900 0000 7216  !...r"...rY...r.
-00001610: 0000 0072 1900 0000 7220 0000 0029 0672  ...r....r ...).r
-00001620: 2900 0000 722a 0000 0072 5a00 0000 5a09  )...r*...rZ...Z.
-00001630: 706f 7465 6e74 6961 6c72 1b00 0000 721c  potentialr....r.
-00001640: 0000 0072 1400 0000 7214 0000 0072 1500  ...r....r....r..
-00001650: 0000 da0d 706f 7465 6e74 6961 6c5f 6470  ....potential_dp
-00001660: 63bd 0000 0073 0e00 0000 0005 0a01 0801  c....s..........
-00001670: 1002 0e01 1c01 0e01 725b 0000 0063 0300  ........r[...c..
-00001680: 0000 0000 0000 0000 0000 0a00 0000 0700  ................
-00001690: 0000 4300 0000 73b2 0000 0074 00a0 017c  ..C...s....t...|
-000016a0: 00a1 017d 037c 0264 016b 0272 347c 0374  ...}.|.d.k.r4|.t
-000016b0: 00a0 027c 00a1 0164 0219 0074 00a0 027c  ...|...d...t...|
-000016c0: 01a1 0164 0119 0017 0037 007d 036e 7a74  ...d.....7.}.nzt
-000016d0: 036a 04a0 057c 00a0 06a1 007c 01a0 06a1  .j...|.....|....
-000016e0: 00a1 025c 027d 047d 0574 036a 04a0 077c  ...\.}.}.t.j...|
-000016f0: 047c 057c 0274 006a 0864 031b 0014 0017  .|.|.t.j.d......
-00001700: 00a1 025c 027d 067d 0774 006a 097c 067c  ...\.}.}.t.j.|.|
-00001710: 006a 0a64 048d 027d 0874 006a 097c 077c  .j.d...}.t.j.|.|
-00001720: 016a 0a64 048d 027d 097c 0374 00a0 027c  .j.d...}.|.t...|
-00001730: 08a1 0164 0219 0074 00a0 027c 09a1 0164  ...d...t...|...d
-00001740: 0119 0017 0037 007d 037c 0353 0029 054e  .....7.}.|.S.).N
-00001750: 7201 0000 0072 1f00 0000 721d 0000 0072  r....r....r....r
-00001760: 1e00 0000 290b 7211 0000 0072 4f00 0000  ....).r....rO...
-00001770: 7226 0000 0072 2100 0000 7222 0000 0072  r&...r!...r"...r
-00001780: 1600 0000 7223 0000 0072 1900 0000 7220  ....r#...r....r 
-00001790: 0000 0072 2400 0000 7225 0000 0029 0a72  ...r$...r%...).r
-000017a0: 2900 0000 722a 0000 0072 5a00 0000 722b  )...r*...rZ...r+
-000017b0: 0000 005a 0a72 686f 5f64 7063 5f72 765a  ...Z.rho_dpc_rvZ
-000017c0: 0a70 6869 5f64 7063 5f72 765a 0878 5f64  .phi_dpc_rvZ.x_d
-000017d0: 7063 5f72 765a 0879 5f64 7063 5f72 765a  pc_rvZ.y_dpc_rvZ
-000017e0: 0978 5f64 7063 5f72 6f74 5a09 795f 6470  .x_dpc_rotZ.y_dp
-000017f0: 635f 726f 7472 1400 0000 7214 0000 0072  c_rotr....r....r
-00001800: 1500 0000 da0a 6368 6172 6765 5f64 7063  ......charge_dpc
-00001810: cc00 0000 731e 0000 0000 050a 0108 0122  ....s.........."
-00001820: 021a 0106 0112 ff08 0304 0106 ff06 0304  ................
-00001830: 0106 ff06 0320 0172 5c00 0000 2905 723f  ..... .r\...).r?
-00001840: 0000 0072 1000 0000 7240 0000 0072 4100  ...r....r@...rA.
-00001850: 0000 7240 0000 0029 0172 0100 0000 2901  ..r@...).r....).
-00001860: 7201 0000 0029 1e5a 0d73 6369 7079 2e6e  r....).Z.scipy.n
-00001870: 6469 6d61 6765 5a07 6e64 696d 6167 6572  dimageZ.ndimager
-00001880: 3900 0000 5a0e 7363 6970 792e 6f70 7469  9...Z.scipy.opti
-00001890: 6d69 7a65 da08 6f70 7469 6d69 7a65 722f  mize..optimizer/
-000018a0: 0000 005a 056e 756d 7079 7211 0000 00da  ...Z.numpyr.....
-000018b0: 0873 7465 6d74 6f6f 6c72 2100 0000 5a09  .stemtoolr!...Z.
-000018c0: 7471 646d 2e61 7574 6f72 0200 0000 da06  tqdm.autor......
-000018d0: 7479 7069 6e67 7203 0000 0072 0400 0000  typingr....r....
-000018e0: 5a08 6e70 7479 7069 6e67 7205 0000 0072  Z.nptypingr....r
-000018f0: 0600 0000 7207 0000 0072 0800 0000 7209  ....r....r....r.
-00001900: 0000 0072 0a00 0000 7216 0000 0072 1900  ...r....r....r..
-00001910: 0000 722c 0000 0072 3000 0000 723e 0000  ..r,...r0...r>..
-00001920: 0072 5900 0000 725b 0000 0072 5c00 0000  .rY...r[...r\...
-00001930: 7214 0000 0072 1400 0000 7214 0000 0072  r....r....r....r
-00001940: 1500 0000 da08 3c6d 6f64 756c 653e 0100  ......<module>..
-00001950: 0000 7370 0000 000c 010c 0108 0108 010c  ..sp............
-00001960: 0110 0120 041c 0122 fe0c 091c 0122 fe0c  ... ..."....."..
-00001970: 0902 010e 010e 0102 fc0c 121c 010a fe0c  ................
-00001980: 0c0e 0102 0102 0102 0102 010e fa0c 1e00  ................
-00001990: 0100 0100 0100 0100 f902 010e 010e 0102  ................
-000019a0: 0102 0102 0102 0102 010e f80c 6f00 fd02  ............o...
-000019b0: 010e 010e 0102 010e fc0c 1200 fd02 010e  ................
-000019c0: 010e 0102 010e fc                        .......
+00000090: 0100 6405 6510 6511 6406 1900 650d 6602  ..d.e.e.d...e.f.
+000000a0: 1900 6407 6510 6511 6406 1900 650d 6602  ..d.e.e.d...e.f.
+000000b0: 1900 6408 650e 6510 6511 6406 1900 6513  ..d.e.e.e.d...e.
+000000c0: 6602 1900 6510 6511 6406 1900 6513 6602  f...e.e.d...e.f.
+000000d0: 1900 6602 1900 6606 6409 640a 8404 5a16  ..f...f.d.d...Z.
+000000e0: 640b 6510 6511 6406 1900 650d 6602 1900  d.e.e.d...e.f...
+000000f0: 640c 6510 6511 6406 1900 650d 6602 1900  d.e.e.d...e.f...
+00000100: 6408 650e 6510 6511 6406 1900 6513 6602  d.e.e.e.d...e.f.
+00000110: 1900 6510 6511 6406 1900 6513 6602 1900  ..e.e.d...e.f...
+00000120: 6602 1900 6606 640d 640e 8404 5a17 640f  f...f.d.d...Z.d.
+00000130: 6513 6410 6510 6511 6411 1900 6513 6602  e.d.e.e.d...e.f.
+00000140: 1900 6412 6510 6511 6411 1900 6513 6602  ..d.e.e.d...e.f.
+00000150: 1900 6408 6513 6608 6413 6414 8404 5a18  ..d.e.f.d.d...Z.
+00000160: 6410 6510 6511 6411 1900 6513 6602 1900  d.e.e.d...e.f...
+00000170: 6412 6510 6511 6411 1900 6513 6602 1900  d.e.e.d...e.f...
+00000180: 6408 650e 6513 6513 6602 1900 6606 6415  d.e.e.e.f...f.d.
+00000190: 6416 8404 5a19 6417 6510 6511 6411 1900  d...Z.d.e.e.d...
+000001a0: 650d 6602 1900 6418 6513 6419 6513 641a  e.f...d.e.d.e.d.
+000001b0: 6513 641b 6513 6408 6510 6511 6411 1900  e.d.e.d.e.e.d...
+000001c0: 6513 6602 1900 660c 641c 641d 8404 5a1a  e.f...f.d.d...Z.
+000001d0: 091e 091f 0920 0921 0920 6432 6422 6510  ..... .!. d2d"e.
+000001e0: 6511 6411 1900 6513 6602 1900 6423 6510  e.d...e.f...d#e.
+000001f0: 6511 6411 1900 6513 6602 1900 6424 6512  e.d...e.f...d$e.
+00000200: 6425 6513 6426 6513 6427 6513 6428 6512  d%e.d&e.d'e.d(e.
+00000210: 6408 6510 6511 6411 1900 6513 6602 1900  d.e.e.d...e.f...
+00000220: 6610 6429 642a 8405 5a1b 0900 6433 642b  f.d)d*..Z...d3d+
+00000230: 6510 6511 6411 1900 6513 6602 1900 642c  e.e.d...e.f...d,
+00000240: 6510 6511 6411 1900 6513 6602 1900 642d  e.e.d...e.f...d-
+00000250: 6513 6408 6510 6511 6411 1900 6513 6602  e.d.e.e.d...e.f.
+00000260: 1900 6608 642e 642f 8405 5a1c 0900 6433  ..f.d.d/..Z...d3
+00000270: 642b 6510 6511 6411 1900 6513 6602 1900  d+e.e.d...e.f...
+00000280: 642c 6510 6511 6411 1900 6513 6602 1900  d,e.e.d...e.f...
+00000290: 642d 6513 6408 6510 6511 6411 1900 6513  d-e.d.e.e.d...e.
+000002a0: 6602 1900 6608 6430 6431 8405 5a1d 6401  f...f.d0d1..Z.d.
+000002b0: 5300 2934 e900 0000 004e 2901 da06 7472  S.)4.....N)...tr
+000002c0: 616e 6765 2902 da03 416e 79da 0554 7570  ange)...Any..Tup
+000002d0: 6c65 2906 da07 4e44 4172 7261 79da 0553  le)...NDArray..S
+000002e0: 6861 7065 da03 496e 74da 0546 6c6f 6174  hape..Int..Float
+000002f0: da04 426f 6f6c da07 436f 6d70 6c65 78da  ..Bool..Complex.
+00000300: 0178 da01 2ada 0179 da06 7265 7475 726e  .x..*..y..return
+00000310: 6302 0000 0000 0000 0000 0000 0004 0000  c...............
+00000320: 0004 0000 0043 0000 0073 2800 0000 7c00  .....C...s(...|.
+00000330: 6401 1300 7c01 6401 1300 1700 6402 1300  d...|.d.....d...
+00000340: 7d02 7400 a001 7c01 7c00 a102 7d03 7c02  }.t...|.|...}.|.
+00000350: 7c03 6602 5300 2903 4ee9 0200 0000 e700  |.f.S.).N.......
+00000360: 0000 0000 00e0 3f29 02da 026e 705a 0761  ......?)...npZ.a
+00000370: 7263 7461 6e32 2904 720b 0000 0072 0d00  rctan2).r....r..
+00000380: 0000 da03 7268 6fda 0370 6869 a900 7214  ....rho..phi..r.
+00000390: 0000 00fa 3662 7569 6c64 2f62 6469 7374  ....6build/bdist
+000003a0: 2e6c 696e 7578 2d78 3836 5f36 342f 6567  .linux-x86_64/eg
+000003b0: 672f 7374 656d 746f 6f6c 2f64 7063 2f64  g/stemtool/dpc/d
+000003c0: 7063 5f75 7469 6c73 2e70 79da 0863 6172  pc_utils.py..car
+000003d0: 7432 706f 6c0a 0000 0073 0600 0000 1403  t2pol....s......
+000003e0: 0c01 0801 7216 0000 0072 1200 0000 7213  ....r....r....r.
+000003f0: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
+00000400: 0400 0000 0400 0000 4300 0000 7324 0000  ........C...s$..
+00000410: 007c 0074 00a0 017c 01a1 0114 007d 027c  .|.t...|.....}.|
+00000420: 0074 00a0 027c 01a1 0114 007d 037c 027c  .t...|.....}.|.|
+00000430: 0366 0253 0029 014e 2903 7211 0000 00da  .f.S.).N).r.....
+00000440: 0363 6f73 da03 7369 6e29 0472 1200 0000  .cos..sin).r....
+00000450: 7213 0000 0072 0b00 0000 720d 0000 0072  r....r....r....r
+00000460: 1400 0000 7214 0000 0072 1500 0000 da08  ....r....r......
+00000470: 706f 6c32 6361 7274 1200 0000 7306 0000  pol2cart....s...
+00000480: 000e 030e 0108 0172 1900 0000 da07 616e  .......r......an
+00000490: 676c 655f 64da 0772 686f 5f64 7063 7a04  gle_d..rho_dpcz.
+000004a0: 2a2c 202a da07 7068 695f 6470 6363 0300  *, *..phi_dpcc..
+000004b0: 0000 0000 0000 0000 0000 0b00 0000 0500  ................
+000004c0: 0000 4300 0000 7380 0000 007c 0074 006a  ..C...s....|.t.j
+000004d0: 0164 011b 0014 007d 037c 027c 0317 007d  .d.....}.|.|...}
+000004e0: 0474 026a 03a0 047c 01a0 05a1 007c 04a0  .t.j...|.....|..
+000004f0: 05a1 00a1 025c 027d 057d 0674 006a 067c  .....\.}.}.t.j.|
+00000500: 057c 016a 0764 028d 027d 0774 006a 067c  .|.j.d...}.t.j.|
+00000510: 067c 016a 0764 028d 027d 0874 00a0 087c  .|.j.d...}.t...|
+00000520: 07a1 0164 0319 0074 00a0 087c 08a1 0164  ...d...t...|...d
+00000530: 0419 0017 007d 0974 00a0 0974 00a0 0a7c  .....}.t...t...|
+00000540: 09a1 01a1 017d 0a7c 0a53 0029 054e e9b4  .....}.|.S.).N..
+00000550: 0000 00a9 015a 086e 6577 7368 6170 65e9  .....Z.newshape.
+00000560: 0100 0000 7201 0000 0029 0b72 1100 0000  ....r....).r....
+00000570: da02 7069 da02 7374 da03 6470 6372 1900  ..pi..st..dpcr..
+00000580: 0000 da05 7261 7665 6cda 0772 6573 6861  ....ravel..resha
+00000590: 7065 da05 7368 6170 65da 0867 7261 6469  pe..shape..gradi
+000005a0: 656e 74da 0373 756d da03 6162 7329 0b72  ent..sum..abs).r
+000005b0: 1a00 0000 721b 0000 0072 1c00 0000 5a07  ....r....r....Z.
+000005c0: 616e 676c 655f 725a 076e 6577 5f70 6869  angle_rZ.new_phi
+000005d0: 5a09 785f 6470 635f 7276 6c5a 0979 5f64  Z.x_dpc_rvlZ.y_d
+000005e0: 7063 5f72 766c da05 785f 6470 63da 0579  pc_rvl..x_dpc..y
+000005f0: 5f64 7063 da06 6368 6172 6765 5a09 616e  _dpc..chargeZ.an
+00000600: 676c 655f 7375 6d72 1400 0000 7214 0000  gle_sumr....r...
+00000610: 0072 1500 0000 da09 616e 676c 655f 6675  .r......angle_fu
+00000620: 6e1a 0000 0073 1200 0000 0e05 0801 1a01  n....s..........
+00000630: 1001 1001 1a02 02ff 1003 0401 722c 0000  ............r,..
+00000640: 0063 0200 0000 0000 0000 0000 0000 0700  .c..............
+00000650: 0000 0500 0000 4300 0000 7336 0000 0064  ......C...s6...d
+00000660: 017d 0274 006a 0174 027c 027c 007c 0166  .}.t.j.t.|.|.|.f
+00000670: 0264 028d 037d 037c 036a 037d 047c 0464  .d...}.|.j.}.|.d
+00000680: 0118 007d 057c 0464 0117 007d 067c 057c  ...}.|.d...}.|.|
+00000690: 0666 0253 0029 034e e95a 0000 0029 01da  .f.S.).N.Z...)..
+000006a0: 0461 7267 7329 04da 0373 696f 5a08 6d69  .args)...sioZ.mi
+000006b0: 6e69 6d69 7a65 722c 0000 0072 0b00 0000  nimizer,...r....
+000006c0: 2907 721b 0000 0072 1c00 0000 5a02 7830  ).r....r....Z.x0
+000006d0: 720b 0000 005a 056d 696e 5f78 5a04 736f  r....Z.min_xZ.so
+000006e0: 6c31 5a04 736f 6c32 7214 0000 0072 1400  l1Z.sol2r....r..
+000006f0: 0000 7215 0000 00da 0e6f 7074 696d 697a  ..r......optimiz
+00000700: 655f 616e 676c 652b 0000 0073 0c00 0000  e_angle+...s....
+00000710: 0403 1401 0601 0801 0801 0801 7230 0000  ............r0..
+00000720: 00da 0c63 6265 645f 7061 7474 6572 6eda  ...cbed_pattern.
+00000730: 0872 6f74 616e 676c 65da 0778 6365 6e74  .rotangle..xcent
+00000740: 6572 da07 7963 656e 7465 72da 0b64 6174  er..ycenter..dat
+00000750: 615f 7261 6469 7573 6305 0000 0000 0000  a_radiusc.......
+00000760: 0000 0000 000c 0000 000a 0000 0043 0000  .............C..
+00000770: 0073 ae00 0000 7400 a001 7c00 a101 7d05  .s....t...|...}.
+00000780: 7400 6a02 6401 7c05 6401 1900 8502 6401  t.j.d.|.d.....d.
+00000790: 7c05 6402 1900 8502 6602 1900 5c02 7d06  |.d.....f...\.}.
+000007a0: 7d07 7c06 7c03 1800 6403 1300 7c07 7c02  }.|.|...d...|.|.
+000007b0: 1800 6403 1300 1700 6404 1300 6405 7c04  ..d.....d...d.|.
+000007c0: 1400 6b04 7d08 7400 a003 7404 a005 7c00  ..k.}.t...t...|.
+000007d0: 6406 a102 a101 7d09 7400 a006 7407 6a08  d.....}.t...t.j.
+000007e0: a009 7c00 7c02 6404 7c05 6402 1900 1400  ..|.|.d.|.d.....
+000007f0: 1800 7c03 6404 7c05 6401 1900 1400 1800  ..|.d.|.d.......
+00000800: a103 a101 7d0a 7404 6a0a 7c0a 7c01 6407  ....}.t.j.|.|.d.
+00000810: 6408 6409 8d04 7d0b 7c09 7c0b 7c08 3c00  d.d...}.|.|.|.<.
+00000820: 7c0b 5300 290a 4e72 0100 0000 721f 0000  |.S.).Nr....r...
+00000830: 0072 0f00 0000 7210 0000 0067 a470 3d0a  .r....r....g.p=.
+00000840: d7a3 f03f e90f 0000 00e9 0500 0000 4629  ...?..........F)
+00000850: 02da 056f 7264 6572 7224 0000 0029 0b72  ...orderr$...).r
+00000860: 1100 0000 7225 0000 005a 056d 6772 6964  ....r%...Z.mgrid
+00000870: 5a04 616d 696e da04 7363 6e64 5a0d 6d65  Z.amin..scndZ.me
+00000880: 6469 616e 5f66 696c 7465 7272 2800 0000  dian_filterr(...
+00000890: 7221 0000 00da 0475 7469 6c5a 0d6d 6f76  r!.....utilZ.mov
+000008a0: 655f 6279 5f70 6861 7365 da06 726f 7461  e_by_phase..rota
+000008b0: 7465 290c 7231 0000 0072 3200 0000 7233  te).r1...r2...r3
+000008c0: 0000 0072 3400 0000 7235 0000 00da 0964  ...r4...r5.....d
+000008d0: 6174 615f 7369 7a65 5a02 7956 5a02 7856  ata_sizeZ.yVZ.xV
+000008e0: da04 6d61 736b 5a08 6362 6564 5f6d 696e  ..maskZ.cbed_min
+000008f0: 5a0a 6d6f 7665 645f 6362 6564 5a0c 726f  Z.moved_cbedZ.ro
+00000900: 7461 7465 645f 6362 6564 7214 0000 0072  tated_cbedr....r
+00000910: 1400 0000 7215 0000 00da 0c64 6174 615f  ....r......data_
+00000920: 726f 7461 746f 7236 0000 0073 2400 0000  rotator6...s$...
+00000930: 0a07 2201 1a02 0601 04fe 1203 0401 0601  ..".............
+00000940: 0201 0e01 0e01 02fd 04ff 0407 0801 06ff  ................
+00000950: 0803 0401 723e 0000 00e9 0400 0000 7210  ....r>........r.
+00000960: 0000 00e9 6400 0000 e79a 9999 9999 99c9  ....d...........
+00000970: 3fda 0678 7368 6966 74da 0679 7368 6966  ?..xshift..yshif
+00000980: 74da 0470 6164 66da 026c 50da 0268 50da  t..padf..lP..hP.
+00000990: 0873 7465 7073 697a 65da 0a69 7465 725f  .stepsize..iter_
+000009a0: 636f 756e 7463 0700 0000 0000 0000 0000  countc..........
+000009b0: 0000 1c00 0000 0a00 0000 4300 0000 73e8  ..........C...s.
+000009c0: 0200 0074 00a0 017c 006a 02a1 017d 077c  ...t...|.j...}.|
+000009d0: 077c 0214 00a0 0374 04a1 017d 0874 006a  .|.....t...}.t.j
+000009e0: 05a0 067c 0864 0119 00a1 017d 0974 006a  ...|.d.....}.t.j
+000009f0: 05a0 077c 0864 0219 00a1 017d 0a7c 0964  ...|.d.....}.|.d
+00000a00: 0364 0385 0264 0366 0219 0064 0413 007c  .d...d.f...d...|
+00000a10: 0a64 0364 0364 0385 0266 0219 0064 0413  .d.d.d...f...d..
+00000a20: 0017 007d 0b7c 0b7c 0417 007c 0b64 0413  ...}.|.|...|.d..
+00000a30: 007c 0314 0017 007d 0c74 006a 0864 0564  .|.....}.t.j.d.d
+00000a40: 068d 017d 0d64 077c 0c1b 007d 0c64 017c  ...}.d.|...}.d.|
+00000a50: 0c64 083c 0074 006a 0864 0964 068d 017d  .d.<.t.j.d.d...}
+00000a60: 0d64 0a7c 0514 007d 0e7c 0e7c 0964 0364  .d.|...}.|.|.d.d
+00000a70: 0385 0264 0366 0219 0014 007c 0c14 007d  ...d.f.....|...}
+00000a80: 0f7c 0e7c 0a64 0364 0364 0385 0266 0219  .|.|.d.d.d...f..
+00000a90: 0014 007c 0c14 007d 1074 006a 097c 0874  ...|...}.t.j.|.t
+00000aa0: 006a 0a64 0b8d 027d 1174 00a0 0b7c 11a1  .j.d...}.t...|..
+00000ab0: 017d 1274 00a0 0b7c 11a1 017d 1374 00a0  .}.t...|...}.t..
+00000ac0: 0b7c 11a1 017d 1474 00a0 097c 06a1 017d  .|...}.t...|...}
+00000ad0: 1574 006a 0b7c 1174 0c64 0c8d 027d 1664  .t.j.|.t.d...}.d
+00000ae0: 0d7c 1674 0464 0e7c 0864 0119 007c 0764  .|.t.d.|.d...|.d
+00000af0: 0119 0018 0014 0083 0174 0464 0e7c 0864  .........t.d.|.d
+00000b00: 0119 007c 0764 0119 0017 0014 0083 0185  ...|.d..........
+00000b10: 0274 0464 0e7c 0864 0219 007c 0764 0219  .t.d.|.d...|.d..
+00000b20: 0018 0014 0083 0174 0464 0e7c 0864 0219  .......t.d.|.d..
+00000b30: 007c 0764 0219 0017 0014 0083 0185 0266  .|.d...........f
+00000b40: 023c 007c 1664 0f6b 027d 1774 0d7c 0683  .<.|.d.k.}.t.|..
+00000b50: 0144 005d a07d 187c 137c 1605 0019 007c  .D.].}.|.|.....|
+00000b60: 00a0 0ea1 0038 0003 003c 007c 147c 1605  .....8...<.|.|..
+00000b70: 0019 007c 01a0 0ea1 0038 0003 003c 0064  ...|.....8...<.d
+00000b80: 017c 137c 173c 0064 017c 147c 173c 007c  .|.|.<.d.|.|.<.|
+00000b90: 1274 006a 05a0 0f74 006a 05a0 107c 13a1  .t.j...t.j...|..
+00000ba0: 017c 0f14 0074 006a 05a0 107c 14a1 017c  .|...t.j...|...|
+00000bb0: 1014 0017 00a1 0137 007d 127c 1174 11a0  .......7.}.|.t..
+00000bc0: 127c 057c 1214 0064 02a1 0237 007d 1174  .|.|...d...7.}.t
+00000bd0: 006a 137c 1164 1064 1164 128d 0374 006a  .j.|.d.d.d...t.j
+00000be0: 137c 1164 1364 1164 128d 0318 0064 141b  .|.d.d.d.....d..
+00000bf0: 007d 1374 006a 137c 1164 1564 1164 128d  .}.t.j.|.d.d.d..
+00000c00: 0374 006a 137c 1164 1164 1164 128d 0318  .t.j.|.d.d.d....
+00000c10: 0064 141b 007d 147c 137c 1619 007c 00a0  .d...}.|.|...|..
+00000c20: 0ea1 0018 007d 197c 147c 1619 007c 01a0  .....}.|.|...|..
+00000c30: 0ea1 0018 007d 1a74 00a0 1474 00a0 157c  .....}.t...t...|
+00000c40: 1974 00a0 157c 19a1 0118 0064 0413 007c  .t...|.....d...|
+00000c50: 1a74 00a0 157c 1aa1 0118 0064 0413 0017  .t...|.....d....
+00000c60: 00a1 01a1 017c 157c 183c 007c 1864 016b  .....|.|.<.|.d.k
+00000c70: 0490 0172 687c 157c 1819 007c 157c 1864  ...rh|.|...|.|.d
+00000c80: 0218 0019 006b 0490 0172 687c 0564 041d  .....k...rh|.d..
+00000c90: 007d 0571 c874 006a 167c 117c 1619 007c  .}.q.t.j.|.|...|
+00000ca0: 0764 168d 027d 1b7c 1b53 0029 1761 f105  .d...}.|.S.).a..
+00000cb0: 0000 0a20 2020 2049 6e74 6567 7261 7465  ...    Integrate
+00000cc0: 2044 5043 2073 6869 6674 7320 7573 696e   DPC shifts usin
+00000cd0: 6720 466f 7572 6965 7220 7472 616e 7366  g Fourier transf
+00000ce0: 6f72 6d73 2061 6e64 0a20 2020 2070 7265  orms and.    pre
+00000cf0: 7665 6e74 696e 6720 6564 6765 2065 6666  venting edge eff
+00000d00: 6563 7473 0a0a 2020 2020 5061 7261 6d65  ects..    Parame
+00000d10: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00000d20: 2d2d 2d0a 2020 2020 7873 6869 6674 3a20  ---.    xshift: 
+00000d30: 2020 2020 4265 616d 2073 6869 6674 2069      Beam shift i
+00000d40: 6e20 7468 6520 5820 6469 6d65 6e73 696f  n the X dimensio
+00000d50: 6e0a 2020 2020 7973 6869 6674 3a20 2020  n.    yshift:   
+00000d60: 2020 4265 616d 2073 6869 6674 2069 6e20    Beam shift in 
+00000d70: 7468 6520 5820 6469 6d65 6e73 696f 6e73  the X dimensions
+00000d80: 0a20 2020 2070 6164 663a 2020 2020 2020  .    padf:      
+00000d90: 2070 6164 6469 6e67 2066 6163 746f 7220   padding factor 
+00000da0: 666f 7220 6163 6375 7261 7465 2046 4654  for accurate FFT
+00000db0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00000dc0: 2020 6465 6661 756c 7420 6973 2034 0a20    default is 4. 
+00000dd0: 2020 206c 503a 2020 2020 2020 2020 206c     lP:         l
+00000de0: 6f77 2070 6173 7320 6669 6c74 6572 2c20  ow pass filter, 
+00000df0: 6465 6661 756c 7420 6973 2030 2e35 0a20  default is 0.5. 
+00000e00: 2020 2068 503a 2020 2020 2020 2020 2068     hP:         h
+00000e10: 6967 6820 7061 7373 2066 696c 7465 722c  igh pass filter,
+00000e20: 2064 6566 6175 6c74 2069 7320 3130 300a   default is 100.
+00000e30: 2020 2020 7374 6570 7369 7a65 3a20 2020      stepsize:   
+00000e40: 6672 6163 7469 6f6e 206f 6620 7068 6173  fraction of phas
+00000e50: 6520 6469 6666 6572 6e63 6520 746f 2075  e differnce to u
+00000e60: 7064 6174 6520 6576 6572 790a 2020 2020  pdate every.    
+00000e70: 2020 2020 2020 2020 2020 2020 6974 6572              iter
+00000e80: 6174 696f 6e2e 2044 6566 6175 6c74 2069  ation. Default i
+00000e90: 7320 302e 352e 2054 6869 7320 6973 2061  s 0.5. This is a
+00000ea0: 2064 796e 616d 6963 0a20 2020 2020 2020   dynamic.       
+00000eb0: 2020 2020 2020 2020 2066 6163 746f 722c           factor,
+00000ec0: 2061 6e64 2069 7320 7265 6475 6365 6420   and is reduced 
+00000ed0: 6966 2074 6865 2065 7272 6f72 2073 7461  if the error sta
+00000ee0: 7274 730a 2020 2020 2020 2020 2020 2020  rts.            
+00000ef0: 2020 2020 696e 6372 6561 7369 6e67 0a20      increasing. 
+00000f00: 2020 2069 7465 725f 636f 756e 743a 204e     iter_count: N
+00000f10: 756d 6265 7220 6f66 2069 7465 7261 7469  umber of iterati
+00000f20: 6f6e 7320 746f 2072 756e 2e20 4465 6661  ons to run. Defa
+00000f30: 756c 7420 6973 2031 3030 0a0a 2020 2020  ult is 100..    
+00000f40: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00000f50: 2d2d 2d0a 2020 2020 7068 6173 655f 6669  ---.    phase_fi
+00000f60: 6e61 6c3a 2050 6861 7365 206f 6620 7468  nal: Phase of th
+00000f70: 6520 6d61 7472 6978 2074 6861 7420 6c65  e matrix that le
+00000f80: 6164 7320 746f 2074 6865 2064 6973 706c  ads to the displ
+00000f90: 6163 656d 656e 740a 0a20 2020 204e 6f74  acement..    Not
+00000fa0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+00000fb0: 2054 6869 7320 6973 2062 6173 6564 206f   This is based o
+00000fc0: 6e20 7477 6f20 6964 6561 7320 2d20 6974  n two ideas - it
+00000fd0: 6572 6174 6976 6520 636f 6d70 6c65 7820  erative complex 
+00000fe0: 706c 616e 650a 2020 2020 696e 7465 6772  plane.    integr
+00000ff0: 6174 696f 6e20 616e 6420 616e 7469 7379  ation and antisy
+00001000: 6d6d 6574 7269 6320 6d69 7272 6f72 2069  mmetric mirror i
+00001010: 6e74 6567 7261 7469 6f6e 2e20 4669 7273  ntegration. Firs
+00001020: 740a 2020 2020 7477 6f20 616e 7469 7379  t.    two antisy
+00001030: 6d6d 6574 7269 6320 6d61 7472 6963 6573  mmetric matrices
+00001040: 2061 7265 2067 656e 6572 6174 6564 2066   are generated f
+00001050: 6f72 2065 6163 6820 6f66 2074 6865 0a20  or each of the. 
+00001060: 2020 2078 2073 6869 6674 2061 6e64 2079     x shift and y
+00001070: 2073 6869 6674 732e 2054 6865 6e20 7468   shifts. Then th
+00001080: 6579 2061 7265 2069 6e74 6567 7261 7465  ey are integrate
+00001090: 6420 696e 2046 6f75 7269 6572 0a20 2020  d in Fourier.   
+000010a0: 2073 7061 6365 2061 7320 7065 7220 7468   space as per th
+000010b0: 6520 6964 6561 206f 6620 636f 6d70 6c65  e idea of comple
+000010c0: 7820 696e 7465 6772 6174 696f 6e2e 2046  x integration. F
+000010d0: 696e 616c 6c79 2c20 610a 2020 2020 7375  inally, a.    su
+000010e0: 622d 6d61 7472 6978 2069 7320 7461 6b65  b-matrix is take
+000010f0: 6e20 6f75 7420 6672 6f6d 2074 6865 2061  n out from the a
+00001100: 6e74 6973 796d 6d65 7472 6963 2069 6e74  ntisymmetric int
+00001110: 6567 7261 6e64 0a20 2020 206d 6174 7269  egrand.    matri
+00001120: 7820 746f 2067 6976 6520 7468 6520 6470  x to give the dp
+00001130: 6320 696e 7465 6772 616e 640a 0a20 2020  c integrand..   
+00001140: 2052 6566 6572 656e 6365 730a 2020 2020   References.    
+00001150: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 202e  ----------.    .
+00001160: 2e20 5b31 5d20 4973 6869 7a75 6b61 2c20  . [1] Ishizuka, 
+00001170: 416b 696d 6974 7375 2c20 4d61 7361 616b  Akimitsu, Masaak
+00001180: 6920 4f6b 612c 2054 616b 6568 6974 6f20  i Oka, Takehito 
+00001190: 5365 6b69 2c20 4e61 6f79 6120 5368 6962  Seki, Naoya Shib
+000011a0: 6174 612c 0a20 2020 2020 2020 2061 6e64  ata,.        and
+000011b0: 204b 617a 756f 2049 7368 697a 756b 612e   Kazuo Ishizuka.
+000011c0: 2022 426f 756e 6461 7279 2d61 7274 6966   "Boundary-artif
+000011d0: 6163 742d 6672 6565 2064 6574 6572 6d69  act-free determi
+000011e0: 6e61 7469 6f6e 206f 660a 2020 2020 2020  nation of.      
+000011f0: 2020 706f 7465 6e74 6961 6c20 6469 7374    potential dist
+00001200: 7269 6275 7469 6f6e 2066 726f 6d20 6469  ribution from di
+00001210: 6666 6572 656e 7469 616c 2070 6861 7365  fferential phase
+00001220: 2063 6f6e 7472 6173 7420 7369 676e 616c   contrast signal
+00001230: 732e 220a 2020 2020 2020 2020 4d69 6372  s.".        Micr
+00001240: 6f73 636f 7079 2036 362c 206e 6f2e 2036  oscopy 66, no. 6
+00001250: 2028 3230 3137 293a 2033 3937 2d34 3035   (2017): 397-405
+00001260: 2e0a 0a20 2020 203a 4175 7468 6f72 733a  ...    :Authors:
+00001270: 0a20 2020 2044 6562 616e 6773 6875 204d  .    Debangshu M
+00001280: 756b 6865 726a 6565 203c 6d75 6b68 6572  ukherjee <mukher
+00001290: 6a65 6564 406f 726e 6c2e 676f 763e 0a20  jeed@ornl.gov>. 
+000012a0: 2020 2072 0100 0000 721f 0000 004e 720f     r....r....Nr.
+000012b0: 0000 00da 0669 676e 6f72 6529 01da 0664  .....ignore)...d
+000012c0: 6976 6964 6567 0000 0000 0000 f03f 2902  ivideg.......?).
+000012d0: 7201 0000 0072 0100 0000 da04 7761 726e  r....r......warn
+000012e0: 7900 0000 0000 0000 0000 0000 0000 00d0  y...............
+000012f0: 3f29 0272 2500 0000 da05 6474 7970 6529  ?).r%.....dtype)
+00001300: 0172 4c00 0000 5472 1000 0000 4629 02e9  .rL...Tr....F)..
+00001310: ffff ffff 7201 0000 0029 0272 0100 0000  ....r....).r....
+00001320: 721f 0000 0029 015a 0461 7869 7329 0272  r....).Z.axis).r
+00001330: 1f00 0000 7201 0000 0067 0000 0000 0000  ....r....g......
+00001340: 0040 2902 7201 0000 0072 4d00 0000 721e  .@).r....rM...r.
+00001350: 0000 0029 1772 1100 0000 5a07 6173 6172  ...).r....Z.asar
+00001360: 7261 7972 2500 0000 5a06 6173 7479 7065  rayr%...Z.astype
+00001370: da03 696e 745a 0366 6674 5a07 6666 7466  ..intZ.fftZ.fftf
+00001380: 7265 715a 0872 6666 7466 7265 715a 0673  reqZ.rfftfreqZ.s
+00001390: 6574 6572 725a 057a 6572 6f73 5a07 666c  eterrZ.zerosZ.fl
+000013a0: 6f61 7436 34da 0a7a 6572 6f73 5f6c 696b  oat64..zeros_lik
+000013b0: 65da 0462 6f6f 6c72 0200 0000 7223 0000  e..boolr....r#..
+000013c0: 005a 0669 7266 6674 325a 0572 6666 7432  .Z.irfft2Z.rfft2
+000013d0: 7239 0000 005a 0f67 6175 7373 6961 6e5f  r9...Z.gaussian_
+000013e0: 6669 6c74 6572 5a04 726f 6c6c da04 7371  filterZ.roll..sq
+000013f0: 7274 da04 6d65 616e 7224 0000 0029 1c72  rt..meanr$...).r
+00001400: 4200 0000 7243 0000 0072 4400 0000 7245  B...rC...rD...rE
+00001410: 0000 0072 4600 0000 7247 0000 0072 4800  ...rF...rG...rH.
+00001420: 0000 5a07 696d 7368 6170 655a 0870 6164  ..Z.imshapeZ.pad
+00001430: 7368 6170 655a 0271 785a 0271 795a 0371  shapeZ.qxZ.qyZ.q
+00001440: 7232 da0b 6465 6e6f 6d69 6e61 746f 72da  r2..denominator.
+00001450: 015f da01 665a 0a71 784f 7065 7261 746f  ._..fZ.qxOperato
+00001460: 725a 0a71 794f 7065 7261 746f 725a 0c70  rZ.qyOperatorZ.p
+00001470: 6164 6465 645f 7068 6173 65da 0675 7064  added_phase..upd
+00001480: 6174 655a 0264 785a 0264 79da 0565 7272  ateZ.dxZ.dy..err
+00001490: 6f72 723d 0000 005a 076d 6173 6b49 6e76  orr=...Z.maskInv
+000014a0: da02 6969 5a05 7844 6966 665a 0579 4469  ..iiZ.xDiffZ.yDi
+000014b0: 6666 5a0b 7068 6173 655f 6669 6e61 6c72  ffZ.phase_finalr
+000014c0: 1400 0000 7214 0000 0072 1500 0000 da0d  ....r....r......
+000014d0: 696e 7465 6772 6174 655f 6470 6351 0000  integrate_dpcQ..
+000014e0: 0073 7400 0000 0c33 0e01 1001 1001 2801  .st....3......(.
+000014f0: 1402 0c01 0801 0801 0c01 0801 1801 1801  ................
+00001500: 0402 0601 06ff 0a03 0a01 0a01 0a01 0e01  ................
+00001510: 0204 02fd 2e01 2e01 02ff 02ff 0804 0c01  ................
+00001520: 1401 1401 0801 0801 2c01 1401 0e02 0e01  ........,.......
+00001530: 02ff 0202 04fd 0e05 0e01 02ff 0202 04fd  ................
+00001540: 1004 1001 0401 2801 08ff 0a03 1601 0801  ......(.........
+00001550: 0280 0401 0801 06ff 0403 7259 0000 0072  ..........rY...r
+00001560: 2900 0000 722a 0000 00da 0561 6e67 6c65  )...r*.....angle
+00001570: 6303 0000 0000 0000 0000 0000 0006 0000  c...............
+00001580: 0006 0000 0043 0000 0073 6000 0000 7400  .....C...s`...t.
+00001590: a001 7c00 a101 7d03 7c02 6401 6b02 7212  ..|...}.|.d.k.r.
+000015a0: 7402 6a03 a004 7c00 7c01 a102 7d03 7c03  t.j...|.|...}.|.
+000015b0: 5300 7405 7c00 7c01 8302 5c02 7d04 7d05  S.t.|.|...\.}.}.
+000015c0: 7406 7c04 7c05 7c02 7400 6a07 6402 1b00  t.|.|.|.t.j.d...
+000015d0: 1400 1700 8302 5c02 7d00 7d01 7402 6a03  ......\.}.}.t.j.
+000015e0: a004 7c00 7c01 a102 7d03 7c03 5300 2903  ..|.|...}.|.S.).
+000015f0: 4e72 0100 0000 721d 0000 0029 0872 1100  Nr....r....).r..
+00001600: 0000 724f 0000 0072 2100 0000 7222 0000  ..rO...r!...r"..
+00001610: 0072 5900 0000 7216 0000 0072 1900 0000  .rY...r....r....
+00001620: 7220 0000 0029 0672 2900 0000 722a 0000  r ...).r)...r*..
+00001630: 0072 5a00 0000 5a09 706f 7465 6e74 6961  .rZ...Z.potentia
+00001640: 6c72 1b00 0000 721c 0000 0072 1400 0000  lr....r....r....
+00001650: 7214 0000 0072 1500 0000 da0d 706f 7465  r....r......pote
+00001660: 6e74 6961 6c5f 6470 63bd 0000 0073 1000  ntial_dpc....s..
+00001670: 0000 0a05 0801 0e01 0405 0efd 1c01 0e01  ................
+00001680: 0401 725b 0000 0063 0300 0000 0000 0000  ..r[...c........
+00001690: 0000 0000 0a00 0000 0700 0000 4300 0000  ............C...
+000016a0: 73b4 0000 0074 00a0 017c 00a1 017d 037c  s....t...|...}.|
+000016b0: 0264 016b 0272 1b7c 0374 00a0 027c 00a1  .d.k.r.|.t...|..
+000016c0: 0164 0219 0074 00a0 027c 01a1 0164 0119  .d...t...|...d..
+000016d0: 0017 0037 007d 037c 0353 0074 036a 04a0  ...7.}.|.S.t.j..
+000016e0: 057c 00a0 06a1 007c 01a0 06a1 00a1 025c  .|.....|.......\
+000016f0: 027d 047d 0574 036a 04a0 077c 047c 057c  .}.}.t.j...|.|.|
+00001700: 0274 006a 0864 031b 0014 0017 00a1 025c  .t.j.d.........\
+00001710: 027d 067d 0774 006a 097c 067c 006a 0a64  .}.}.t.j.|.|.j.d
+00001720: 048d 027d 0874 006a 097c 077c 016a 0a64  ...}.t.j.|.|.j.d
+00001730: 048d 027d 097c 0374 00a0 027c 08a1 0164  ...}.|.t...|...d
+00001740: 0219 0074 00a0 027c 09a1 0164 0119 0017  ...t...|...d....
+00001750: 0037 007d 037c 0353 0029 054e 7201 0000  .7.}.|.S.).Nr...
+00001760: 0072 1f00 0000 721d 0000 0072 1e00 0000  .r....r....r....
+00001770: 290b 7211 0000 0072 4f00 0000 7226 0000  ).r....rO...r&..
+00001780: 0072 2100 0000 7222 0000 0072 1600 0000  .r!...r"...r....
+00001790: 7223 0000 0072 1900 0000 7220 0000 0072  r#...r....r ...r
+000017a0: 2400 0000 7225 0000 0029 0a72 2900 0000  $...r%...).r)...
+000017b0: 722a 0000 0072 5a00 0000 722b 0000 005a  r*...rZ...r+...Z
+000017c0: 0a72 686f 5f64 7063 5f72 765a 0a70 6869  .rho_dpc_rvZ.phi
+000017d0: 5f64 7063 5f72 765a 0878 5f64 7063 5f72  _dpc_rvZ.x_dpc_r
+000017e0: 765a 0879 5f64 7063 5f72 765a 0978 5f64  vZ.y_dpc_rvZ.x_d
+000017f0: 7063 5f72 6f74 5a09 795f 6470 635f 726f  pc_rotZ.y_dpc_ro
+00001800: 7472 1400 0000 7214 0000 0072 1500 0000  tr....r....r....
+00001810: da0a 6368 6172 6765 5f64 7063 cc00 0000  ..charge_dpc....
+00001820: 7320 0000 000a 0508 0120 0104 0d1a f506  s ....... ......
+00001830: 0112 0108 ff04 0306 0106 ff04 0306 0106  ................
+00001840: ff20 0304 0172 5c00 0000 2905 723f 0000  . ...r\...).r?..
+00001850: 0072 1000 0000 7240 0000 0072 4100 0000  .r....r@...rA...
+00001860: 7240 0000 0029 0172 0100 0000 291e 5a0d  r@...).r....).Z.
+00001870: 7363 6970 792e 6e64 696d 6167 655a 076e  scipy.ndimageZ.n
+00001880: 6469 6d61 6765 7239 0000 005a 0e73 6369  dimager9...Z.sci
+00001890: 7079 2e6f 7074 696d 697a 65da 086f 7074  py.optimize..opt
+000018a0: 696d 697a 6572 2f00 0000 5a05 6e75 6d70  imizer/...Z.nump
+000018b0: 7972 1100 0000 da08 7374 656d 746f 6f6c  yr......stemtool
+000018c0: 7221 0000 005a 0974 7164 6d2e 6175 746f  r!...Z.tqdm.auto
+000018d0: 7202 0000 00da 0674 7970 696e 6772 0300  r......typingr..
+000018e0: 0000 7204 0000 005a 086e 7074 7970 696e  ..r....Z.nptypin
+000018f0: 6772 0500 0000 7206 0000 0072 0700 0000  gr....r....r....
+00001900: 7208 0000 0072 0900 0000 720a 0000 0072  r....r....r....r
+00001910: 1600 0000 7219 0000 0072 2c00 0000 7230  ....r....r,...r0
+00001920: 0000 0072 3e00 0000 7259 0000 0072 5b00  ...r>...rY...r[.
+00001930: 0000 725c 0000 0072 1400 0000 7214 0000  ..r\...r....r...
+00001940: 0072 1400 0000 7215 0000 00da 083c 6d6f  .r....r......<mo
+00001950: 6475 6c65 3e01 0000 0073 b800 0000 0c00  dule>....s......
+00001960: 0c01 0801 0801 0c01 1001 2001 0203 0e01  .......... .....
+00001970: 02ff 0e01 02ff 2202 0afe 0208 0e01 02ff  ......".........
+00001980: 0e01 02ff 2202 0afe 0208 0201 02ff 0e02  ...."...........
+00001990: 02fe 0e03 02fd 0204 0afc 0211 0e01 02ff  ................
+000019a0: 0e01 02ff 0a02 0afe 020b 0e01 02ff 0202  ................
+000019b0: 02fe 0203 02fd 0204 02fc 0205 02fb 0e06  ................
+000019c0: 0afa 021e 0201 0201 0201 0201 04f9 0e01  ................
+000019d0: 02ff 0e02 02fe 0203 02fd 0204 02fc 0205  ................
+000019e0: 02fb 0206 02fa 0207 02f9 0e08 0af8 026f  ...............o
+000019f0: 04fd 0e01 02ff 0e02 02fe 0203 02fd 0e04  ................
+00001a00: 0afc 0212 04fd 0e01 02ff 0e02 02fe 0203  ................
+00001a10: 02fd 0e04 0efc                           ......
```

## Comparing `stemtool/dpc/__pycache__/nbed_dpc.cpython-39.pyc` & `stemtool/dpc/__pycache__/nbed_dpc.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:27:27 2023 UTC, .py size: 10890 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 15% similar despite different names*

```diff
@@ -1,524 +1,526 @@
-00000000: 610d 0d0a 0000 0000 7f38 e163 8a2a 0000  a........8.c.*..
+00000000: 6f0d 0d0a 0000 0000 5774 6f64 b62a 0000  o.......Wtod.*..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 7000 0000 6400  .....@...sp...d.
+00000020: 0003 0000 0040 0000 0073 7400 0000 6400  .....@...st...d.
 00000030: 6401 6c00 6d01 5a02 0100 6400 6401 6c03  d.l.m.Z...d.d.l.
 00000040: 6d04 5a05 0100 6400 6401 6c06 5a07 6400  m.Z...d.d.l.Z.d.
 00000050: 6401 6c08 5a08 6400 6401 6c09 5a0a 6400  d.l.Z.d.d.l.Z.d.
-00000060: 6402 6c0b 6d0c 5a0c 0100 6403 6404 8400  d.l.m.Z...d.d...
-00000070: 5a0d 6412 6406 6407 8401 5a0e 6413 6409  Z.d.d.d...Z.d.d.
-00000080: 640a 8401 5a0f 6414 640c 640d 8401 5a10  d...Z.d.d.d...Z.
-00000090: 6415 6410 6411 8401 5a11 6401 5300 2916  d.d.d...Z.d.S.).
-000000a0: e900 0000 004e 2901 da06 7472 616e 6765  .....N)...trange
-000000b0: 6304 0000 0000 0000 0000 0000 000f 0000  c...............
-000000c0: 0007 0000 0043 0000 0073 8a01 0000 7400  .....C...s....t.
-000000d0: a001 6401 a101 0100 7402 6a03 7c02 7402  ..d.....t.j.|.t.
-000000e0: 6a04 6402 8d02 7d02 7402 6a03 7c03 7402  j.d...}.t.j.|.t.
-000000f0: 6a04 6402 8d02 7d03 7402 a005 7c02 a101  j.d...}.t...|...
-00000100: 7d04 7402 a005 7c02 a101 7d05 7406 7407  }.t...|...}.t.t.
-00000110: 7402 a008 7c02 a101 6403 1900 8301 8301  t...|...d.......
-00000120: 4400 5d4e 7d06 7c02 7c06 6403 6602 1900  D.]N}.|.|.d.f...
-00000130: 7d07 7c02 7c06 6404 6602 1900 7d08 7409  }.|.|.d.f...}.t.
-00000140: 6a0a a00b 7c00 7c07 7c08 7c01 a104 7d09  j...|.|.|.|...}.
-00000150: 7c09 6403 1900 7c04 7c06 6403 6602 3c00  |.d...|.|.d.f.<.
-00000160: 7c09 6404 1900 7c04 7c06 6404 6602 3c00  |.d...|.|.d.f.<.
-00000170: 7154 7402 a00c 7c04 a101 7d05 6403 7c05  qTt...|...}.d.|.
-00000180: 6400 6400 8502 6404 6602 1900 1800 7c05  d.d...d.f.....|.
-00000190: 6400 6400 8502 6404 6602 3c00 7c05 7402  d.d...d.f.<.|.t.
-000001a0: a00d 7c03 6400 6400 8502 6403 6602 1900  ..|.d.d...d.f...
-000001b0: 6403 6b02 7c03 6400 6400 8502 6404 6602  d.k.|.d.d...d.f.
-000001c0: 1900 6403 6b02 a102 6400 6400 8502 6602  ..d.k...d.d...f.
-000001d0: 1900 7d0a 7c0a 6405 1900 7d0b 7c0a 6406  ..}.|.d...}.|.d.
-000001e0: 1900 7d0c 7c05 6400 6400 8502 6403 6407  ..}.|.d.d...d.d.
-000001f0: 8502 6602 1900 7402 6a03 7c0b 7c0c 6602  ..f...t.j.|.|.f.
-00000200: 7402 6a04 6402 8d02 1800 7c05 6400 6400  t.j.d.....|.d.d.
-00000210: 8502 6403 6407 8502 6602 3c00 7402 6a0e  ..d.d...f.<.t.j.
-00000220: 6a0f 7c03 7c05 6400 6408 8d03 5c04 7d0d  j.|.|.d.d...\.}.
-00000230: 7d0e 7d0e 7d0e 6409 7c0c 1400 7d0c 7c04  }.}.}.d.|...}.|.
-00000240: 7402 6a03 7c0b 7c0c 6602 7402 6a04 6402  t.j.|.|.f.t.j.d.
-00000250: 8d02 7c0d 6603 5300 290a 4eda 0669 676e  ..|.f.S.).N..ign
-00000260: 6f72 65a9 01da 0564 7479 7065 7201 0000  ore....dtyper...
-00000270: 00e9 0100 0000 a902 7201 0000 0072 0100  ........r....r..
-00000280: 0000 a902 7201 0000 0072 0600 0000 e902  ....r....r......
-00000290: 0000 0029 015a 0572 636f 6e64 e9ff ffff  ...).Z.rcond....
-000002a0: ff29 10da 0877 6172 6e69 6e67 73da 0e66  .)...warnings..f
-000002b0: 696c 7465 7277 6172 6e69 6e67 73da 026e  ilterwarnings..n
-000002c0: 70da 0761 7361 7272 6179 da07 666c 6f61  p..asarray..floa
-000002d0: 7436 345a 0a7a 6572 6f73 5f6c 696b 65da  t64Z.zeros_like.
-000002e0: 0572 616e 6765 da03 696e 74da 0573 6861  .range..int..sha
-000002f0: 7065 da02 7374 da04 7574 696c da13 6669  pe..st..util..fi
-00000300: 745f 6761 7573 7369 616e 3244 5f6d 6173  t_gaussian2D_mas
-00000310: 6bda 0463 6f70 795a 0b6c 6f67 6963 616c  k..copyZ.logical
-00000320: 5f61 6e64 da06 6c69 6e61 6c67 5a05 6c73  _and..linalgZ.ls
-00000330: 7473 7129 0fda 0a63 6f72 725f 696d 6167  tsq)...corr_imag
-00000340: 65da 0964 6973 6b5f 7369 7a65 5a09 706f  e..disk_sizeZ.po
-00000350: 7369 7469 6f6e 735a 0a64 6966 665f 7370  sitionsZ.diff_sp
-00000360: 6f74 73da 1066 6974 7465 645f 6469 736b  ots..fitted_disk
-00000370: 5f6c 6973 745a 0e64 6973 6b5f 6c6f 6361  _listZ.disk_loca
-00000380: 7469 6f6e 73da 0269 695a 0470 6f73 785a  tions..iiZ.posxZ
-00000390: 0470 6f73 795a 0370 6172 da06 6365 6e74  .posyZ.par..cent
-000003a0: 6572 5a02 6378 da02 6379 5a05 6c63 6265  erZ.cx..cyZ.lcbe
-000003b0: 64da 015f a900 721f 0000 00fa 3b62 7569  d.._..r.....;bui
-000003c0: 6c64 2f62 6469 7374 2e6d 6163 6f73 782d  ld/bdist.macosx-
-000003d0: 3130 2e39 2d78 3836 5f36 342f 6567 672f  10.9-x86_64/egg/
-000003e0: 7374 656d 746f 6f6c 2f64 7063 2f6e 6265  stemtool/dpc/nbe
-000003f0: 645f 6470 632e 7079 da0e 6669 745f 6e62  d_dpc.py..fit_nb
-00000400: 6564 5f64 6973 6b73 0900 0000 7330 0000  ed_disks....s0..
-00000410: 0000 010a 0110 0110 010a 010a 011a 010c  ................
-00000420: 010c 0112 0110 0112 010a 0120 0102 0132  ........... ...2
-00000430: ff04 0308 0108 0116 010a ff18 031a 0108  ................
-00000440: 0172 2100 0000 e932 0000 0063 0200 0000  .r!....2...c....
-00000450: 0000 0000 0000 0000 0400 0000 0700 0000  ................
-00000460: 4300 0000 735c 0000 0074 006a 01a0 0274  C...s\...t.j...t
-00000470: 006a 01a0 037c 00a1 01a1 015c 027d 027d  .j...|.....\.}.}
-00000480: 037c 0174 04a0 057c 02a1 0114 007c 027c  .|.t...|.....|.|
-00000490: 027c 0174 04a0 057c 02a1 0114 006b 043c  .|.t...|.....k.<
-000004a0: 0074 04a0 057c 02a1 017c 011b 007c 027c  .t...|...|...|.|
-000004b0: 0274 04a0 057c 02a1 017c 011b 006b 003c  .t...|...|...k.<
-000004c0: 007c 0253 0029 014e 2906 7213 0000 0072  .|.S.).N).r....r
-000004d0: 1400 0000 da05 736f 6265 6cda 0f69 6d61  ......sobel..ima
-000004e0: 6765 5f6c 6f67 6172 697a 6572 720d 0000  ge_logarizerr...
-000004f0: 00da 066d 6564 6961 6e29 04da 0569 6d61  ...median)...ima
-00000500: 6765 5a0a 6d65 645f 6669 6c74 6572 5a08  geZ.med_filterZ.
-00000510: 6c73 5f69 6d61 6765 721e 0000 0072 1f00  ls_imager....r..
-00000520: 0000 721f 0000 0072 2000 0000 da0c 736f  ..r....r .....so
-00000530: 6265 6c5f 6669 6c74 6572 2400 0000 730e  bel_filter$...s.
-00000540: 0000 0000 0118 0106 0102 ff18 040c ff14  ................
-00000550: 0372 2700 0000 7206 0000 0063 0600 0000  .r'...r....c....
-00000560: 0000 0000 0000 0000 2e00 0000 0800 0000  ................
-00000570: 4300 0000 7340 0400 0074 00a0 0164 01a1  C...s@...t...d..
-00000580: 0101 0074 02a0 037c 04a1 0164 026b 0072  ...t...|...d.k.r
-00000590: 3674 026a 047c 006a 0564 0219 007c 006a  6t.j.|.j.d...|.j
-000005a0: 0564 0319 0066 0274 0664 048d 027d 0474  .d...f.t.d...}.t
-000005b0: 02a0 077c 006a 05a1 0164 0264 0585 0219  ...|.j...d.d....
-000005c0: 007d 0674 026a 0864 067c 0664 0619 0085  .}.t.j.d.|.d....
-000005d0: 0264 067c 0664 0719 0085 0266 0219 005c  .d.|.d.....f...\
-000005e0: 027d 077d 0874 02a0 0774 02a0 097c 07a1  .}.}.t...t...|..
-000005f0: 0174 02a0 097c 08a1 0166 02a1 01a0 0a74  .t...|...f.....t
-00000600: 0ba1 017d 0974 02a0 077c 006a 05a1 0164  ...}.t...|.j...d
-00000610: 0664 0285 0219 007d 0a74 026a 0864 067c  .d.....}.t.j.d.|
-00000620: 0a64 0619 0085 0264 067c 0a64 0719 0085  .d.....d.|.d....
-00000630: 0266 0219 005c 027d 0b7d 0c74 0c6a 0da0  .f...\.}.}.t.j..
-00000640: 0e7c 0a7c 0a64 0719 0064 021b 007c 0a64  .|.|.d...d...|.d
-00000650: 0619 0064 021b 007c 01a1 04a0 0a74 026a  ...d...|.....t.j
-00000660: 0fa1 017d 0d74 02a0 1064 02a1 01a0 0a74  ...}.t...d.....t
-00000670: 026a 0fa1 017d 0e74 0c6a 0da0 117c 0da1  .j...}.t.j...|..
-00000680: 015c 027d 0f7d 1074 026a 127c 0674 026a  .\.}.}.t.j.|.t.j
-00000690: 0f64 048d 027d 1174 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006a0: 0f64 048d 027d 1274 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006b0: 0f64 048d 027d 1374 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006c0: 0f64 048d 027d 1474 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006d0: 0f64 048d 027d 1574 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006e0: 0f64 048d 027d 1674 026a 127c 0674 026a  .d...}.t.j.|.t.j
-000006f0: 0f64 048d 027d 1774 026a 127c 0674 026a  .d...}.t.j.|.t.j
-00000700: 0f64 048d 027d 1874 026a 137c 0064 0874  .d...}.t.j.|.d.t
-00000710: 026a 0f64 098d 037d 1974 0c6a 0da0 1174  .j.d...}.t.j...t
-00000720: 0c6a 0da0 147c 19a1 01a1 015c 027d 1a7d  .j...|.....\.}.}
-00000730: 107c 0574 02a0 157c 1aa1 0114 007c 1a7c  .|.t...|.....|.|
-00000740: 1a7c 0574 02a0 157c 1aa1 0114 006b 043c  .|.t...|.....k.<
-00000750: 0074 02a0 157c 1aa1 017c 051b 007c 1a7c  .t...|...|...|.|
-00000760: 1a74 02a0 157c 1aa1 017c 051b 006b 003c  .t...|...|...k.<
-00000770: 0074 0c6a 0da0 167c 1a7c 0fa1 027d 1b74  .t.j...|.|...}.t
-00000780: 177c 1b7c 017c 027c 0383 045c 037d 107d  .|.|.|.|...\.}.}
-00000790: 1c7d 1d7c 1d64 0064 0085 0264 0666 0219  .}.|.d.d...d.f..
-000007a0: 0064 0213 007c 1d64 0064 0085 0264 0766  .d...|.d.d...d.f
-000007b0: 0219 0064 0213 0017 0064 0a13 007d 1e7c  ...d.....d...}.|
-000007c0: 1e64 0719 007d 1f74 026a 18a0 197c 1da1  .d...}.t.j...|..
-000007d0: 017d 2074 1a74 02a0 037c 07a1 0183 0144  .} t.t...|.....D
-000007e0: 0090 015d c07d 217c 0964 067c 2166 0219  ...].}!|.d.|!f..
-000007f0: 007d 227c 0964 077c 2166 0219 007d 237c  .}"|.d.|!f...}#|
-00000800: 0064 0064 0085 0264 0064 0085 027c 227c  .d.d...d.d...|"|
-00000810: 2366 0419 007d 2474 0c6a 0da0 1174 0c6a  #f...}$t.j...t.j
-00000820: 0da0 147c 24a1 01a1 015c 027d 257d 1074  ...|$....\.}%}.t
-00000830: 02a0 157c 25a1 017c 257c 257c 0574 02a0  ...|%..|%|%|.t..
-00000840: 157c 25a1 0114 006b 043c 0074 0c6a 0da0  .|%....k.<.t.j..
-00000850: 167c 257c 0fa1 027d 2674 177c 267c 017c  .|%|...}&t.|&|.|
-00000860: 027c 0383 045c 037d 107d 277d 287c 0b7c  .|...\.}.}'}(|.|
-00000870: 2764 0719 0018 0064 0213 007c 0c7c 2764  'd.....d...|.|'d
-00000880: 0619 0018 0064 0213 0017 0064 0a13 007c  .....d.....d...|
-00000890: 1f6b 017d 2974 02a0 1b7c 247c 2919 007c  .k.})t...|$|)..|
-000008a0: 0c7c 2919 0014 00a1 0174 02a0 1b7c 247c  .|)......t...|$|
-000008b0: 2919 00a1 011b 007d 2a74 02a0 1b7c 247c  )......}*t...|$|
-000008c0: 2919 007c 0b7c 2919 0014 00a1 0174 02a0  )..|.|)......t..
-000008d0: 1b7c 247c 2919 00a1 011b 007d 2b74 02a0  .|$|)......}+t..
-000008e0: 1c7c 287c 20a1 027d 2c7c 2c7c 0e18 007d  .|(| ..},|,|...}
-000008f0: 2d7c 2d64 0b19 000b 007c 117c 227c 2366  -|-d.....|.|"|#f
-00000900: 023c 007c 2d64 0c19 007c 2d64 0d19 0017  .<.|-d...|-d....
-00000910: 000b 007c 127c 227c 2366 023c 007c 2d64  ...|.|"|#f.<.|-d
-00000920: 0c19 007c 2d64 0d19 0018 000b 007c 137c  ...|-d.......|.|
-00000930: 227c 2366 023c 007c 2d64 0e19 000b 007c  "|#f.<.|-d.....|
-00000940: 147c 227c 2366 023c 007c 2764 0619 007c  .|"|#f.<.|'d...|
-00000950: 1c64 0619 0018 007c 157c 227c 2366 023c  .d.....|.|"|#f.<
-00000960: 007c 2764 0719 007c 1c64 0719 0018 007c  .|'d...|.d.....|
-00000970: 167c 227c 2366 023c 007c 2a7c 1c64 0619  .|"|#f.<.|*|.d..
-00000980: 0018 007c 177c 227c 2366 023c 007c 2b7c  ...|.|"|#f.<.|+|
-00000990: 1c64 0719 0018 007c 187c 227c 2366 023c  .d.....|.|"|#f.<
-000009a0: 0090 0271 687c 117c 127c 137c 147c 157c  ...qh|.|.|.|.|.|
-000009b0: 167c 177c 1866 0853 0029 0f4e 7203 0000  .|.|.f.S.).Nr...
-000009c0: 0072 0900 0000 e903 0000 0072 0400 0000  .r.........r....
-000009d0: e904 0000 0072 0100 0000 7206 0000 0029  .....r....r....)
-000009e0: 0272 0a00 0000 e9fe ffff ff29 025a 0461  .r.........).Z.a
-000009f0: 7869 7372 0500 0000 e700 0000 0000 00e0  xisr............
-00000a00: 3f72 0700 0000 7208 0000 0029 0272 0600  ?r....r....).r..
-00000a10: 0000 7201 0000 0029 0272 0600 0000 7206  ..r....).r....r.
-00000a20: 0000 0029 1d72 0b00 0000 720c 0000 0072  ...).r....r....r
-00000a30: 0d00 0000 da04 7369 7a65 da04 6f6e 6573  ......size..ones
-00000a40: 7212 0000 00da 0462 6f6f 6c72 0e00 0000  r......boolr....
-00000a50: da05 6d67 7269 645a 0572 6176 656c da06  ..mgridZ.ravel..
-00000a60: 6173 7479 7065 7211 0000 0072 1300 0000  astyper....r....
-00000a70: 7214 0000 00da 0b6d 616b 655f 6369 7263  r......make_circ
-00000a80: 6c65 720f 0000 005a 0365 7965 7223 0000  ler....Z.eyer#..
-00000a90: 00da 057a 6572 6f73 da04 6d65 616e 7224  ...zeros..meanr$
-00000aa0: 0000 0072 2500 0000 5a13 6372 6f73 735f  ...r%...Z.cross_
-00000ab0: 636f 7272 5f75 6e70 6164 6465 6472 2100  corr_unpaddedr!.
-00000ac0: 0000 7217 0000 00da 0369 6e76 7210 0000  ..r......invr...
-00000ad0: 00da 0373 756d da06 6d61 746d 756c 292e  ...sum..matmul).
-00000ae0: da06 6461 7461 3444 7219 0000 005a 0d70  ..data4Dr....Z.p
-00000af0: 6978 656c 5f6c 6973 745f 7879 5a09 6469  ixel_list_xyZ.di
-00000b00: 736b 5f6c 6973 74da 0352 4f49 da0a 6d65  sk_list..ROI..me
-00000b10: 645f 6661 6374 6f72 5a09 7363 616e 5f73  d_factorZ.scan_s
-00000b20: 697a 655a 0273 795a 0273 785a 0e73 6361  izeZ.syZ.sxZ.sca
-00000b30: 6e5f 706f 7369 7469 6f6e 735a 0963 6265  n_positionsZ.cbe
-00000b40: 645f 7369 7a65 da02 7979 da02 7878 5a0b  d_size..yy..xxZ.
-00000b50: 6365 6e74 6572 5f64 6973 6b5a 0869 5f6d  center_diskZ.i_m
-00000b60: 6174 7269 785a 1173 6f62 656c 5f63 656e  atrixZ.sobel_cen
-00000b70: 7465 725f 6469 736b 721e 0000 005a 0465  ter_diskr....Z.e
-00000b80: 5f78 785a 0465 5f78 795a 0465 5f74 685a  _xxZ.e_xyZ.e_thZ
-00000b90: 0465 5f79 795a 0664 6973 6b5f 785a 0664  .e_yyZ.disk_xZ.d
-00000ba0: 6973 6b5f 795a 0543 4f4d 5f78 5a05 434f  isk_yZ.COM_xZ.CO
-00000bb0: 4d5f 795a 096d 6561 6e5f 6362 6564 5a0c  M_yZ.mean_cbedZ.
-00000bc0: 6d65 616e 5f6c 735f 6362 6564 5a08 6d65  mean_ls_cbedZ.me
-00000bd0: 616e 5f6c 7363 5a0b 6d65 616e 5f63 656e  an_lscZ.mean_cen
-00000be0: 7465 725a 096d 6561 6e5f 6178 6573 5a0c  terZ.mean_axesZ.
-00000bf0: 6178 6573 5f6c 656e 6774 6873 5a06 6265  axes_lengthsZ.be
-00000c00: 616d 5f72 5a0c 696e 7665 7273 655f 6178  am_rZ.inverse_ax
-00000c10: 6573 da02 7070 721b 0000 005a 026a 6ada  es..ppr....Z.jj.
-00000c20: 0770 6174 7465 726e 5a0a 7061 7474 6572  .patternZ.patter
-00000c30: 6e5f 6c73 5a0b 7061 7474 6572 6e5f 6c73  n_lsZ.pattern_ls
-00000c40: 635a 0e70 6174 7465 726e 5f63 656e 7465  cZ.pattern_cente
-00000c50: 725a 0c70 6174 7465 726e 5f61 7865 735a  rZ.pattern_axesZ
-00000c60: 0570 6369 7263 5a09 7061 7474 6572 6e5f  .pcircZ.pattern_
-00000c70: 785a 0970 6174 7465 726e 5f79 5a09 745f  xZ.pattern_yZ.t_
-00000c80: 7061 7474 6572 6e5a 0973 5f70 6174 7465  patternZ.s_patte
-00000c90: 726e 721f 0000 0072 1f00 0000 7220 0000  rnr....r....r ..
-00000ca0: 00da 0f73 7472 6169 6e5f 616e 645f 6469  ...strain_and_di
-00000cb0: 736b 2f00 0000 7382 0000 0000 010a 020e  sk/...s.........
-00000cc0: 011e 0314 0122 0120 0114 0122 0220 ff02  .....". ...". ..
-00000cd0: 0204 fe04 0312 0110 0310 0110 0110 0110  ................
-00000ce0: 0110 0110 0110 0110 0312 0118 030c fe02  ................
-00000cf0: 0110 ff02 040c ff14 030e 0102 0108 ff0a  ................
-00000d00: 032c 0108 010c 0214 010c 010c 0118 0118  .,..............
-00000d10: 0104 0102 ff16 030e 0102 0108 ff0a 0422  ..............."
-00000d20: 0102 fe04 0324 0124 010c 0108 0112 011a  .....$.$........
-00000d30: 011a 0112 0118 0118 0114 0118 0172 3e00  .............r>.
+00000060: 6402 6c0b 6d0c 5a0c 6d0d 5a0d 0100 6403  d.l.m.Z.m.Z...d.
+00000070: 6404 8400 5a0e 6412 6406 6407 8401 5a0f  d...Z.d.d.d...Z.
+00000080: 6413 6409 640a 8401 5a10 6414 640c 640d  d.d.d...Z.d.d.d.
+00000090: 8401 5a11 6415 6410 6411 8401 5a12 6401  ..Z.d.d.d...Z.d.
+000000a0: 5300 2916 e900 0000 004e 2902 da04 7471  S.)......N)...tq
+000000b0: 646d da06 7472 616e 6765 6304 0000 0000  dm..trangec.....
+000000c0: 0000 0000 0000 000f 0000 0007 0000 0043  ...............C
+000000d0: 0000 0073 8a01 0000 7400 a001 6401 a101  ...s....t...d...
+000000e0: 0100 7402 6a03 7c02 7402 6a04 6402 8d02  ..t.j.|.t.j.d...
+000000f0: 7d02 7402 6a03 7c03 7402 6a04 6402 8d02  }.t.j.|.t.j.d...
+00000100: 7d03 7402 a005 7c02 a101 7d04 7402 a005  }.t...|...}.t...
+00000110: 7c02 a101 7d05 7406 7407 7402 a008 7c02  |...}.t.t.t...|.
+00000120: a101 6403 1900 8301 8301 4400 5d27 7d06  ..d.......D.]'}.
+00000130: 7c02 7c06 6403 6602 1900 7d07 7c02 7c06  |.|.d.f...}.|.|.
+00000140: 6404 6602 1900 7d08 7409 6a0a a00b 7c00  d.f...}.t.j...|.
+00000150: 7c07 7c08 7c01 a104 7d09 7c09 6403 1900  |.|.|...}.|.d...
+00000160: 7c04 7c06 6403 6602 3c00 7c09 6404 1900  |.|.d.f.<.|.d...
+00000170: 7c04 7c06 6404 6602 3c00 712a 7402 a00c  |.|.d.f.<.q*t...
+00000180: 7c04 a101 7d05 6403 7c05 6400 6400 8502  |...}.d.|.d.d...
+00000190: 6404 6602 1900 1800 7c05 6400 6400 8502  d.f.....|.d.d...
+000001a0: 6404 6602 3c00 7c05 7402 a00d 7c03 6400  d.f.<.|.t...|.d.
+000001b0: 6400 8502 6403 6602 1900 6403 6b02 7c03  d...d.f...d.k.|.
+000001c0: 6400 6400 8502 6404 6602 1900 6403 6b02  d.d...d.f...d.k.
+000001d0: a102 6400 6400 8502 6602 1900 7d0a 7c0a  ..d.d...f...}.|.
+000001e0: 6405 1900 7d0b 7c0a 6406 1900 7d0c 7c05  d...}.|.d...}.|.
+000001f0: 6400 6400 8502 6403 6407 8502 6602 1900  d.d...d.d...f...
+00000200: 7402 6a03 7c0b 7c0c 6602 7402 6a04 6402  t.j.|.|.f.t.j.d.
+00000210: 8d02 1800 7c05 6400 6400 8502 6403 6407  ....|.d.d...d.d.
+00000220: 8502 6602 3c00 7402 6a0e 6a0f 7c03 7c05  ..f.<.t.j.j.|.|.
+00000230: 6400 6408 8d03 5c04 7d0d 7d0e 7d0e 7d0e  d.d...\.}.}.}.}.
+00000240: 6409 7c0c 1400 7d0c 7c04 7402 6a03 7c0b  d.|...}.|.t.j.|.
+00000250: 7c0c 6602 7402 6a04 6402 8d02 7c0d 6603  |.f.t.j.d...|.f.
+00000260: 5300 290a 4eda 0669 676e 6f72 65a9 01da  S.).N..ignore...
+00000270: 0564 7479 7065 7201 0000 00e9 0100 0000  .dtyper.........
+00000280: a902 7201 0000 0072 0100 0000 a902 7201  ..r....r......r.
+00000290: 0000 0072 0700 0000 e902 0000 0029 015a  ...r.........).Z
+000002a0: 0572 636f 6e64 e9ff ffff ff29 10da 0877  .rcond.....)...w
+000002b0: 6172 6e69 6e67 73da 0e66 696c 7465 7277  arnings..filterw
+000002c0: 6172 6e69 6e67 73da 026e 70da 0761 7361  arnings..np..asa
+000002d0: 7272 6179 da07 666c 6f61 7436 345a 0a7a  rray..float64Z.z
+000002e0: 6572 6f73 5f6c 696b 65da 0572 616e 6765  eros_like..range
+000002f0: da03 696e 74da 0573 6861 7065 da02 7374  ..int..shape..st
+00000300: da04 7574 696c da13 6669 745f 6761 7573  ..util..fit_gaus
+00000310: 7369 616e 3244 5f6d 6173 6bda 0463 6f70  sian2D_mask..cop
+00000320: 795a 0b6c 6f67 6963 616c 5f61 6e64 da06  yZ.logical_and..
+00000330: 6c69 6e61 6c67 5a05 6c73 7473 7129 0fda  linalgZ.lstsq)..
+00000340: 0a63 6f72 725f 696d 6167 65da 0964 6973  .corr_image..dis
+00000350: 6b5f 7369 7a65 5a09 706f 7369 7469 6f6e  k_sizeZ.position
+00000360: 735a 0a64 6966 665f 7370 6f74 73da 1066  sZ.diff_spots..f
+00000370: 6974 7465 645f 6469 736b 5f6c 6973 745a  itted_disk_listZ
+00000380: 0e64 6973 6b5f 6c6f 6361 7469 6f6e 73da  .disk_locations.
+00000390: 0269 695a 0470 6f73 785a 0470 6f73 795a  .iiZ.posxZ.posyZ
+000003a0: 0370 6172 da06 6365 6e74 6572 5a02 6378  .par..centerZ.cx
+000003b0: da02 6379 5a05 6c63 6265 64da 015f a900  ..cyZ.lcbed.._..
+000003c0: 7220 0000 00fa 3562 7569 6c64 2f62 6469  r ....5build/bdi
+000003d0: 7374 2e6c 696e 7578 2d78 3836 5f36 342f  st.linux-x86_64/
+000003e0: 6567 672f 7374 656d 746f 6f6c 2f64 7063  egg/stemtool/dpc
+000003f0: 2f6e 6265 645f 6470 632e 7079 da0e 6669  /nbed_dpc.py..fi
+00000400: 745f 6e62 6564 5f64 6973 6b73 0900 0000  t_nbed_disks....
+00000410: 7330 0000 000a 0110 0110 010a 010a 011a  s0..............
+00000420: 010c 010c 0112 0110 0112 010a 0120 0102  ............. ..
+00000430: 0132 0104 ff08 0308 0116 010a 0118 ff1a  .2..............
+00000440: 0308 011a 0172 2200 0000 e932 0000 0063  .....r"....2...c
+00000450: 0200 0000 0000 0000 0000 0000 0400 0000  ................
+00000460: 0700 0000 4300 0000 735c 0000 0074 006a  ....C...s\...t.j
+00000470: 01a0 0274 006a 01a0 037c 00a1 01a1 015c  ...t.j...|.....\
+00000480: 027d 027d 037c 0174 04a0 057c 02a1 0114  .}.}.|.t...|....
+00000490: 007c 027c 027c 0174 04a0 057c 02a1 0114  .|.|.|.t...|....
+000004a0: 006b 043c 0074 04a0 057c 02a1 017c 011b  .k.<.t...|...|..
+000004b0: 007c 027c 0274 04a0 057c 02a1 017c 011b  .|.|.t...|...|..
+000004c0: 006b 003c 007c 0253 0029 014e 2906 7214  .k.<.|.S.).N).r.
+000004d0: 0000 0072 1500 0000 da05 736f 6265 6cda  ...r......sobel.
+000004e0: 0f69 6d61 6765 5f6c 6f67 6172 697a 6572  .image_logarizer
+000004f0: 720e 0000 00da 066d 6564 6961 6e29 04da  r......median)..
+00000500: 0569 6d61 6765 5a0a 6d65 645f 6669 6c74  .imageZ.med_filt
+00000510: 6572 5a08 6c73 5f69 6d61 6765 721f 0000  erZ.ls_imager...
+00000520: 0072 2000 0000 7220 0000 0072 2100 0000  .r ...r ...r!...
+00000530: da0c 736f 6265 6c5f 6669 6c74 6572 2400  ..sobel_filter$.
+00000540: 0000 730e 0000 0018 0106 0102 0118 ff0c  ..s.............
+00000550: 0414 ff04 0372 2800 0000 7207 0000 0063  .....r(...r....c
+00000560: 0600 0000 0000 0000 0000 0000 2e00 0000  ................
+00000570: 0800 0000 4300 0000 733e 0400 0074 00a0  ....C...s>...t..
+00000580: 0164 01a1 0101 0074 02a0 037c 04a1 0164  .d.....t...|...d
+00000590: 026b 0072 1b74 026a 047c 006a 0564 0219  .k.r.t.j.|.j.d..
+000005a0: 007c 006a 0564 0319 0066 0274 0664 048d  .|.j.d...f.t.d..
+000005b0: 027d 0474 02a0 077c 006a 05a1 0164 0264  .}.t...|.j...d.d
+000005c0: 0585 0219 007d 0674 026a 0864 067c 0664  .....}.t.j.d.|.d
+000005d0: 0619 0085 0264 067c 0664 0719 0085 0266  .....d.|.d.....f
+000005e0: 0219 005c 027d 077d 0874 02a0 0774 02a0  ...\.}.}.t...t..
+000005f0: 097c 07a1 0174 02a0 097c 08a1 0166 02a1  .|...t...|...f..
+00000600: 01a0 0a74 0ba1 017d 0974 02a0 077c 006a  ...t...}.t...|.j
+00000610: 05a1 0164 0664 0285 0219 007d 0a74 026a  ...d.d.....}.t.j
+00000620: 0864 067c 0a64 0619 0085 0264 067c 0a64  .d.|.d.....d.|.d
+00000630: 0719 0085 0266 0219 005c 027d 0b7d 0c74  .....f...\.}.}.t
+00000640: 0c6a 0da0 0e7c 0a7c 0a64 0719 0064 021b  .j...|.|.d...d..
+00000650: 007c 0a64 0619 0064 021b 007c 01a1 04a0  .|.d...d...|....
+00000660: 0a74 026a 0fa1 017d 0d74 02a0 1064 02a1  .t.j...}.t...d..
+00000670: 01a0 0a74 026a 0fa1 017d 0e74 0c6a 0da0  ...t.j...}.t.j..
+00000680: 117c 0da1 015c 027d 0f7d 1074 026a 127c  .|...\.}.}.t.j.|
+00000690: 0674 026a 0f64 048d 027d 1174 026a 127c  .t.j.d...}.t.j.|
+000006a0: 0674 026a 0f64 048d 027d 1274 026a 127c  .t.j.d...}.t.j.|
+000006b0: 0674 026a 0f64 048d 027d 1374 026a 127c  .t.j.d...}.t.j.|
+000006c0: 0674 026a 0f64 048d 027d 1474 026a 127c  .t.j.d...}.t.j.|
+000006d0: 0674 026a 0f64 048d 027d 1574 026a 127c  .t.j.d...}.t.j.|
+000006e0: 0674 026a 0f64 048d 027d 1674 026a 127c  .t.j.d...}.t.j.|
+000006f0: 0674 026a 0f64 048d 027d 1774 026a 127c  .t.j.d...}.t.j.|
+00000700: 0674 026a 0f64 048d 027d 1874 026a 137c  .t.j.d...}.t.j.|
+00000710: 0064 0874 026a 0f64 098d 037d 1974 0c6a  .d.t.j.d...}.t.j
+00000720: 0da0 1174 0c6a 0da0 147c 19a1 01a1 015c  ...t.j...|.....\
+00000730: 027d 1a7d 107c 0574 02a0 157c 1aa1 0114  .}.}.|.t...|....
+00000740: 007c 1a7c 1a7c 0574 02a0 157c 1aa1 0114  .|.|.|.t...|....
+00000750: 006b 043c 0074 02a0 157c 1aa1 017c 051b  .k.<.t...|...|..
+00000760: 007c 1a7c 1a74 02a0 157c 1aa1 017c 051b  .|.|.t...|...|..
+00000770: 006b 003c 0074 0c6a 0da0 167c 1a7c 0fa1  .k.<.t.j...|.|..
+00000780: 027d 1b74 177c 1b7c 017c 027c 0383 045c  .}.t.|.|.|.|...\
+00000790: 037d 107d 1c7d 1d7c 1d64 0064 0085 0264  .}.}.}.|.d.d...d
+000007a0: 0666 0219 0064 0213 007c 1d64 0064 0085  .f...d...|.d.d..
+000007b0: 0264 0766 0219 0064 0213 0017 0064 0a13  .d.f...d.....d..
+000007c0: 007d 1e7c 1e64 0719 007d 1f74 026a 18a0  .}.|.d...}.t.j..
+000007d0: 197c 1da1 017d 2074 1a74 02a0 037c 07a1  .|...} t.t...|..
+000007e0: 0183 0144 005d e07d 217c 0964 067c 2166  ...D.].}!|.d.|!f
+000007f0: 0219 007d 227c 0964 077c 2166 0219 007d  ...}"|.d.|!f...}
+00000800: 237c 0064 0064 0085 0264 0064 0085 027c  #|.d.d...d.d...|
+00000810: 227c 2366 0419 007d 2474 0c6a 0da0 1174  "|#f...}$t.j...t
+00000820: 0c6a 0da0 147c 24a1 01a1 015c 027d 257d  .j...|$....\.}%}
+00000830: 1074 02a0 157c 25a1 017c 257c 257c 0574  .t...|%..|%|%|.t
+00000840: 02a0 157c 25a1 0114 006b 043c 0074 0c6a  ...|%....k.<.t.j
+00000850: 0da0 167c 257c 0fa1 027d 2674 177c 267c  ...|%|...}&t.|&|
+00000860: 017c 027c 0383 045c 037d 107d 277d 287c  .|.|...\.}.}'}(|
+00000870: 0b7c 2764 0719 0018 0064 0213 007c 0c7c  .|'d.....d...|.|
+00000880: 2764 0619 0018 0064 0213 0017 0064 0a13  'd.....d.....d..
+00000890: 007c 1f6b 017d 2974 02a0 1b7c 247c 2919  .|.k.})t...|$|).
+000008a0: 007c 0c7c 2919 0014 00a1 0174 02a0 1b7c  .|.|)......t...|
+000008b0: 247c 2919 00a1 011b 007d 2a74 02a0 1b7c  $|)......}*t...|
+000008c0: 247c 2919 007c 0b7c 2919 0014 00a1 0174  $|)..|.|)......t
+000008d0: 02a0 1b7c 247c 2919 00a1 011b 007d 2b74  ...|$|)......}+t
+000008e0: 02a0 1c7c 287c 20a1 027d 2c7c 2c7c 0e18  ...|(| ..},|,|..
+000008f0: 007d 2d7c 2d64 0b19 000b 007c 117c 227c  .}-|-d.....|.|"|
+00000900: 2366 023c 007c 2d64 0c19 007c 2d64 0d19  #f.<.|-d...|-d..
+00000910: 0017 000b 007c 127c 227c 2366 023c 007c  .....|.|"|#f.<.|
+00000920: 2d64 0c19 007c 2d64 0d19 0018 000b 007c  -d...|-d.......|
+00000930: 137c 227c 2366 023c 007c 2d64 0e19 000b  .|"|#f.<.|-d....
+00000940: 007c 147c 227c 2366 023c 007c 2764 0619  .|.|"|#f.<.|'d..
+00000950: 007c 1c64 0619 0018 007c 157c 227c 2366  .|.d.....|.|"|#f
+00000960: 023c 007c 2764 0719 007c 1c64 0719 0018  .<.|'d...|.d....
+00000970: 007c 167c 227c 2366 023c 007c 2a7c 1c64  .|.|"|#f.<.|*|.d
+00000980: 0619 0018 007c 177c 227c 2366 023c 007c  .....|.|"|#f.<.|
+00000990: 2b7c 1c64 0719 0018 007c 187c 227c 2366  +|.d.....|.|"|#f
+000009a0: 023c 0090 0171 347c 117c 127c 137c 147c  .<...q4|.|.|.|.|
+000009b0: 157c 167c 177c 1866 0853 0029 0f4e 7204  .|.|.|.f.S.).Nr.
+000009c0: 0000 0072 0a00 0000 e903 0000 0072 0500  ...r.........r..
+000009d0: 0000 e904 0000 0072 0100 0000 7207 0000  .......r....r...
+000009e0: 0029 0272 0b00 0000 e9fe ffff ff29 025a  .).r.........).Z
+000009f0: 0461 7869 7372 0600 0000 e700 0000 0000  .axisr..........
+00000a00: 00e0 3f72 0800 0000 7209 0000 0029 0272  ..?r....r....).r
+00000a10: 0700 0000 7201 0000 0029 0272 0700 0000  ....r....).r....
+00000a20: 7207 0000 0029 1d72 0c00 0000 720d 0000  r....).r....r...
+00000a30: 0072 0e00 0000 da04 7369 7a65 da04 6f6e  .r......size..on
+00000a40: 6573 7213 0000 00da 0462 6f6f 6c72 0f00  esr......boolr..
+00000a50: 0000 da05 6d67 7269 645a 0572 6176 656c  ....mgridZ.ravel
+00000a60: da06 6173 7479 7065 7212 0000 0072 1400  ..astyper....r..
+00000a70: 0000 7215 0000 00da 0b6d 616b 655f 6369  ..r......make_ci
+00000a80: 7263 6c65 7210 0000 005a 0365 7965 7224  rcler....Z.eyer$
+00000a90: 0000 00da 057a 6572 6f73 da04 6d65 616e  .....zeros..mean
+00000aa0: 7225 0000 0072 2600 0000 5a13 6372 6f73  r%...r&...Z.cros
+00000ab0: 735f 636f 7272 5f75 6e70 6164 6465 6472  s_corr_unpaddedr
+00000ac0: 2200 0000 7218 0000 00da 0369 6e76 7211  "...r......invr.
+00000ad0: 0000 00da 0373 756d da06 6d61 746d 756c  .....sum..matmul
+00000ae0: 292e da06 6461 7461 3444 721a 0000 005a  )...data4Dr....Z
+00000af0: 0d70 6978 656c 5f6c 6973 745f 7879 5a09  .pixel_list_xyZ.
+00000b00: 6469 736b 5f6c 6973 74da 0352 4f49 da0a  disk_list..ROI..
+00000b10: 6d65 645f 6661 6374 6f72 5a09 7363 616e  med_factorZ.scan
+00000b20: 5f73 697a 655a 0273 795a 0273 785a 0e73  _sizeZ.syZ.sxZ.s
+00000b30: 6361 6e5f 706f 7369 7469 6f6e 735a 0963  can_positionsZ.c
+00000b40: 6265 645f 7369 7a65 da02 7979 da02 7878  bed_size..yy..xx
+00000b50: 5a0b 6365 6e74 6572 5f64 6973 6b5a 0869  Z.center_diskZ.i
+00000b60: 5f6d 6174 7269 785a 1173 6f62 656c 5f63  _matrixZ.sobel_c
+00000b70: 656e 7465 725f 6469 736b 721f 0000 005a  enter_diskr....Z
+00000b80: 0465 5f78 785a 0465 5f78 795a 0465 5f74  .e_xxZ.e_xyZ.e_t
+00000b90: 685a 0465 5f79 795a 0664 6973 6b5f 785a  hZ.e_yyZ.disk_xZ
+00000ba0: 0664 6973 6b5f 795a 0543 4f4d 5f78 5a05  .disk_yZ.COM_xZ.
+00000bb0: 434f 4d5f 795a 096d 6561 6e5f 6362 6564  COM_yZ.mean_cbed
+00000bc0: 5a0c 6d65 616e 5f6c 735f 6362 6564 5a08  Z.mean_ls_cbedZ.
+00000bd0: 6d65 616e 5f6c 7363 5a0b 6d65 616e 5f63  mean_lscZ.mean_c
+00000be0: 656e 7465 725a 096d 6561 6e5f 6178 6573  enterZ.mean_axes
+00000bf0: 5a0c 6178 6573 5f6c 656e 6774 6873 5a06  Z.axes_lengthsZ.
+00000c00: 6265 616d 5f72 5a0c 696e 7665 7273 655f  beam_rZ.inverse_
+00000c10: 6178 6573 da02 7070 721c 0000 005a 026a  axes..ppr....Z.j
+00000c20: 6ada 0770 6174 7465 726e 5a0a 7061 7474  j..patternZ.patt
+00000c30: 6572 6e5f 6c73 5a0b 7061 7474 6572 6e5f  ern_lsZ.pattern_
+00000c40: 6c73 635a 0e70 6174 7465 726e 5f63 656e  lscZ.pattern_cen
+00000c50: 7465 725a 0c70 6174 7465 726e 5f61 7865  terZ.pattern_axe
+00000c60: 735a 0570 6369 7263 5a09 7061 7474 6572  sZ.pcircZ.patter
+00000c70: 6e5f 785a 0970 6174 7465 726e 5f79 5a09  n_xZ.pattern_yZ.
+00000c80: 745f 7061 7474 6572 6e5a 0973 5f70 6174  t_patternZ.s_pat
+00000c90: 7465 726e 7220 0000 0072 2000 0000 7221  ternr ...r ...r!
+00000ca0: 0000 00da 0f73 7472 6169 6e5f 616e 645f  .....strain_and_
+00000cb0: 6469 736b 2f00 0000 7380 0000 000a 010e  disk/...s.......
+00000cc0: 021e 0114 0322 0120 0114 0122 0120 0208  .....". ...". ..
+00000cd0: 0102 fe12 0310 0110 0310 0110 0110 0110  ................
+00000ce0: 0110 0110 0110 0112 0318 010c 0302 fe10  ................
+00000cf0: 0102 ff0c 0414 ff0e 0302 0108 010a ff2c  ...............,
+00000d00: 0308 010c 0112 020c 010c 0118 0118 0104  ................
+00000d10: 0102 0116 ff0e 0302 0108 010a ff22 0402  ............."..
+00000d20: 0104 fe24 0324 010c 0108 0112 011a 011a  ...$.$..........
+00000d30: 0112 0118 0118 0114 0118 0114 0172 3f00  .............r?.
 00000d40: 0000 e914 0000 0063 0500 0000 0000 0000  .......c........
 00000d50: 0000 0000 2000 0000 0b00 0000 4300 0000  .... .......C...
-00000d60: 7394 0300 0074 00a0 017c 03a1 0164 016b  s....t...|...d.k
-00000d70: 0072 2c74 006a 027c 006a 0364 0119 007c  .r,t.j.|.j.d...|
-00000d80: 006a 0364 0219 0066 0274 0464 038d 027d  .j.d...f.t.d...}
-00000d90: 0374 006a 0564 047c 006a 0364 0119 0085  .t.j.d.|.j.d....
-00000da0: 0264 047c 006a 0364 0219 0085 0266 0219  .d.|.j.d.....f..
-00000db0: 005c 027d 057d 067c 0064 0564 0585 0264  .\.}.}.|.d.d...d
-00000dc0: 0564 0585 027c 057c 0319 007c 067c 0319  .d...|.|...|.|..
-00000dd0: 0066 0419 007d 0774 006a 0564 047c 006a  .f...}.t.j.d.|.j
-00000de0: 0364 0419 0085 0264 047c 006a 0364 0619  .d.....d.|.j.d..
-00000df0: 0085 0266 0219 005c 027d 087d 0974 00a0  ...f...\.}.}.t..
-00000e00: 067c 03a1 017d 0a74 006a 0764 017c 0a66  .|...}.t.j.d.|.f
-00000e10: 0274 006a 0864 038d 027d 0b74 006a 0764  .t.j.d...}.t.j.d
-00000e20: 017c 0a66 0274 006a 0864 038d 027d 0c7c  .|.f.t.j.d...}.|
-00000e30: 0264 0419 007d 0d7c 0264 0619 007d 0e74  .d...}.|.d...}.t
-00000e40: 096a 0aa0 0b74 00a0 0c7c 006a 0364 0464  .j...t...|.j.d.d
-00000e50: 0185 0219 00a1 017c 0d7c 0e7c 01a1 047d  .......|.|.|...}
-00000e60: 0f74 096a 0aa0 0d7c 0fa1 015c 027d 107d  .t.j...|...\.}.}
-00000e70: 1174 006a 077c 006a 0364 0119 007c 006a  .t.j.|.j.d...|.j
-00000e80: 0364 0219 0066 0274 006a 0864 038d 027d  .d...f.t.j.d...}
-00000e90: 1274 006a 077c 006a 0364 0119 007c 006a  .t.j.|.j.d...|.j
-00000ea0: 0364 0219 0066 0274 006a 0864 038d 027d  .d...f.t.j.d...}
-00000eb0: 1374 006a 077c 006a 0364 0119 007c 006a  .t.j.|.j.d...|.j
-00000ec0: 0364 0219 0066 0274 006a 0864 038d 027d  .d...f.t.j.d...}
-00000ed0: 1474 006a 077c 006a 0364 0119 007c 006a  .t.j.|.j.d...|.j
-00000ee0: 0364 0219 0066 0274 006a 0864 038d 027d  .d...f.t.j.d...}
-00000ef0: 1574 0e74 0f7c 0a83 0183 0144 0090 015d  .t.t.|.....D...]
-00000f00: 6c7d 167c 0764 0564 0585 0264 0564 0585  l}.|.d.d...d.d..
-00000f10: 027c 1666 0319 007d 1774 096a 0aa0 0d74  .|.f...}.t.j...t
-00000f20: 10a0 1174 096a 0aa0 127c 17a1 0164 02a1  ...t.j...|...d..
-00000f30: 02a1 015c 027d 187d 117c 0474 00a0 137c  ...\.}.}.|.t...|
-00000f40: 18a1 0114 007c 187c 187c 0474 00a0 137c  .....|.|.|.t...|
-00000f50: 18a1 0114 006b 043c 0074 00a0 137c 18a1  .....k.<.t...|..
-00000f60: 017c 041b 007c 187c 1874 00a0 137c 18a1  .|...|.|.t...|..
-00000f70: 017c 041b 006b 003c 0074 096a 0a6a 147c  .|...k.<.t.j.j.|
-00000f80: 187c 1064 0764 088d 037d 1974 096a 0aa0  .|.d.d...}.t.j..
-00000f90: 157c 197c 0d7c 0e7c 01a1 047d 1a7c 1a64  .|.|.|.|...}.|.d
-00000fa0: 0464 0185 0219 0074 00a0 0c7c 0d7c 0e66  .d.....t...|.|.f
-00000fb0: 02a1 0164 0974 00a0 1674 00a0 0c74 00a0  ...d.t...t...t..
-00000fc0: 037c 17a1 01a1 01a1 0114 0018 0017 007d  .|.............}
-00000fd0: 1b7c 1b7c 0b64 0464 0185 027c 1666 023c  .|.|.d.d...|.f.<
-00000fe0: 0074 096a 0aa0 0b74 00a0 0c7c 176a 03a1  .t.j...t...|.j..
-00000ff0: 017c 1b64 0419 007c 1b64 0619 007c 01a1  .|.d...|.d...|..
-00001000: 047d 1c7c 1ca0 1774 04a1 017d 1c74 00a0  .}.|...t...}.t..
-00001010: 067c 177c 1c19 00a1 017d 1d74 00a0 067c  .|.|.....}.t...|
-00001020: 177c 1c19 007c 087c 1c19 0014 00a1 017c  .|...|.|.......|
-00001030: 1d1b 007d 1e74 00a0 067c 177c 1c19 007c  ...}.t...|.|...|
-00001040: 097c 1c19 0014 00a1 017c 1d1b 007d 1f74  .|.......|...}.t
-00001050: 00a0 0c7c 1e7c 1f66 02a1 017c 0c64 0464  ...|.|.f...|.d.d
-00001060: 0185 027c 1666 023c 0090 0171 987c 0b64  ...|.f.<...q.|.d
-00001070: 0464 0564 0585 0266 0219 007c 127c 057c  .d.d...f...|.|.|
-00001080: 0319 007c 067c 0319 0066 023c 007c 0b64  ...|.|...f.<.|.d
-00001090: 0664 0564 0585 0266 0219 007c 137c 057c  .d.d...f...|.|.|
-000010a0: 0319 007c 067c 0319 0066 023c 007c 0c64  ...|.|...f.<.|.d
-000010b0: 0464 0564 0585 0266 0219 007c 147c 057c  .d.d...f...|.|.|
-000010c0: 0319 007c 067c 0319 0066 023c 007c 0c64  ...|.|...f.<.|.d
-000010d0: 0664 0564 0585 0266 0219 007c 157c 057c  .d.d...f...|.|.|
-000010e0: 0319 007c 067c 0319 0066 023c 007c 127c  ...|.|...f.<.|.|
-000010f0: 137c 147c 1566 0453 0029 0a61 e006 0000  .|.|.f.S.).a....
-00001100: 0a20 2020 2044 5043 2072 6f75 7469 6e65  .    DPC routine
-00001110: 206f 6e20 6f6e 6c79 2074 6865 2063 656e   on only the cen
-00001120: 7472 616c 2064 6973 6b0a 0a20 2020 2050  tral disk..    P
-00001130: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00001140: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064 6174  --------.    dat
-00001150: 6134 443a 2020 2020 206e 6461 7272 6179  a4D:     ndarray
-00001160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001170: 2054 6865 2034 2064 696d 656e 7369 6f6e   The 4 dimension
-00001180: 616c 2064 6174 6173 6574 2074 6861 7420  al dataset that 
-00001190: 7769 6c6c 2062 6520 616e 616c 797a 6564  will be analyzed
-000011a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000011b0: 2054 6865 2066 6972 7374 2074 776f 2064   The first two d
-000011c0: 696d 656e 7369 6f6e 7320 6172 6520 7468  imensions are th
-000011d0: 6520 466f 7572 6965 7220 7370 6163 650a  e Fourier space.
-000011e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000011f0: 6469 6666 7261 6374 696f 6e20 6469 6d65  diffraction dime
-00001200: 6e73 696f 6e73 2061 6e64 2074 6865 206c  nsions and the l
-00001210: 6173 7420 7477 6f20 6469 6d65 6e73 696f  ast two dimensio
-00001220: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
-00001230: 2020 2061 7265 2074 6865 2072 6561 6c20     are the real 
-00001240: 7370 6163 6520 7363 616e 6e69 6e67 2064  space scanning d
-00001250: 696d 656e 7369 6f6e 730a 2020 2020 6469  imensions.    di
-00001260: 736b 5f73 697a 653a 2020 666c 6f61 740a  sk_size:  float.
-00001270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001280: 5369 7a65 206f 6620 7468 6520 6365 6e74  Size of the cent
-00001290: 7261 6c20 6469 736b 0a20 2020 2070 6f73  ral disk.    pos
-000012a0: 6974 696f 6e3a 2020 206e 6461 7272 6179  ition:   ndarray
-000012b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000012c0: 2058 2061 6e64 2059 2070 6f73 6974 696f   X and Y positio
-000012d0: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
-000012e0: 2020 2054 6869 7320 6973 2074 6865 2069     This is the i
-000012f0: 6e69 7469 616c 2067 7565 7373 2074 6861  nitial guess tha
-00001300: 7420 7769 6c6c 2062 6520 7265 6669 6e65  t will be refine
-00001310: 640a 2020 2020 524f 493a 2020 2020 2020  d.    ROI:      
-00001320: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-00001330: 2020 2020 2020 2020 2020 5468 6520 7265            The re
-00001340: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
-00001350: 2066 6f72 2074 6865 2073 6361 6e6e 696e   for the scannin
-00001360: 6720 7265 6769 6f6e 0a20 2020 2020 2020  g region.       
-00001370: 2020 2020 2020 2020 2074 6861 7420 7769           that wi
-00001380: 6c6c 2062 6520 616e 616c 797a 6564 2e20  ll be analyzed. 
-00001390: 4966 206e 6f20 524f 4920 6973 2067 6976  If no ROI is giv
-000013a0: 656e 2074 6865 6e0a 2020 2020 2020 2020  en then.        
-000013b0: 2020 2020 2020 2020 7468 6520 656e 7469          the enti
-000013c0: 7265 2073 6361 6e6e 6564 2061 7265 6120  re scanned area 
-000013d0: 7769 6c6c 2062 6520 616e 616c 797a 6564  will be analyzed
-000013e0: 0a20 2020 206d 6564 5f76 616c 3a20 2020  .    med_val:   
-000013f0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
-00001400: 2020 2020 2020 2053 6f6d 6574 696d 6573         Sometimes
-00001410: 2073 6f6d 6520 7069 7865 6c73 2061 7265   some pixels are
-00001420: 2065 6974 6865 7220 746f 6f20 6272 6967   either too brig
-00001430: 6874 2069 6e0a 2020 2020 2020 2020 2020  ht in.          
-00001440: 2020 2020 2020 7468 6520 6469 6966 7261        the diifra
-00001450: 6374 696f 6e20 7061 7474 6572 6e73 2064  ction patterns d
-00001460: 7565 2074 6f20 7374 7261 7920 6d75 6f6e  ue to stray muon
-00001470: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
-00001480: 2020 2020 2061 7265 207a 6572 6f20 6475       are zero du
-00001490: 6520 746f 2064 6561 6420 6465 7465 6374  e to dead detect
-000014a0: 6f72 2070 6978 656c 732e 2054 6869 7320  or pixels. This 
-000014b0: 7265 6d6f 7665 730a 2020 2020 2020 2020  removes.        
-000014c0: 2020 2020 2020 2020 7468 6520 6566 6665          the effe
-000014d0: 6374 206f 6620 7375 6368 2070 6978 656c  ct of such pixel
-000014e0: 7320 6265 666f 7265 2053 6f62 656c 2066  s before Sobel f
-000014f0: 696c 7465 7269 6e67 0a0a 2020 2020 5265  iltering..    Re
-00001500: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00001510: 2d0a 2020 2020 705f 6365 6e3a 206e 6461  -.    p_cen: nda
-00001520: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00001530: 5020 706f 7369 7469 6f6e 7320 6f66 2074  P positions of t
-00001540: 6865 2063 656e 7472 616c 2064 6973 6b0a  he central disk.
-00001550: 2020 2020 715f 6365 6e3a 206e 6461 7272      q_cen: ndarr
-00001560: 6179 0a20 2020 2020 2020 2020 2020 5120  ay.           Q 
-00001570: 706f 7369 7469 6f6e 7320 6f66 2074 6865  positions of the
-00001580: 2063 656e 7472 616c 2064 6973 6b0a 2020   central disk.  
-00001590: 2020 705f 636f 6d3a 206e 6461 7272 6179    p_com: ndarray
-000015a0: 0a20 2020 2020 2020 2020 2020 5020 706f  .           P po
-000015b0: 7369 7469 6f6e 7320 6f66 2074 6865 2063  sitions of the c
-000015c0: 656e 7465 7220 6f66 206d 6173 730a 2020  enter of mass.  
-000015d0: 2020 2020 2020 2020 206f 6620 7468 6520           of the 
-000015e0: 6365 6e74 7261 6c20 6469 736b 0a20 2020  central disk.   
-000015f0: 2071 5f63 6f6d 3a20 6e64 6172 7261 790a   q_com: ndarray.
-00001600: 2020 2020 2020 2020 2020 2051 2070 6f73             Q pos
-00001610: 6974 696f 6e73 206f 6620 7468 6520 6365  itions of the ce
-00001620: 6e74 6572 206f 6620 6d61 7373 0a20 2020  nter of mass.   
-00001630: 2020 2020 2020 2020 6f66 2074 6865 2063          of the c
-00001640: 656e 7472 616c 2064 6973 6b0a 0a20 2020  entral disk..   
-00001650: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00001660: 0a20 2020 2054 6869 7320 6973 2077 6865  .    This is whe
-00001670: 6e20 7765 2077 616e 7420 746f 2070 6572  n we want to per
-00001680: 666f 726d 2044 5043 2077 6974 686f 7574  form DPC without
-00001690: 2062 6f74 6865 7269 6e67 0a20 2020 2061   bothering.    a
-000016a0: 626f 7574 2074 6865 2068 6967 6865 7220  bout the higher 
-000016b0: 6f72 6465 7220 6469 736b 732e 2054 6865  order disks. The
-000016c0: 2052 4f49 206f 6620 7468 6520 3444 2064   ROI of the 4D d
-000016d0: 6174 6173 6574 0a20 2020 2069 7320 6361  ataset.    is ca
-000016e0: 6c63 756c 6174 6564 2c20 616e 6420 7468  lculated, and th
-000016f0: 6520 6365 6e74 7261 6c20 6469 736b 2069  e central disk i
-00001700: 7320 6669 7474 6564 2069 6e20 6561 6368  s fitted in each
-00001710: 2052 4f49 0a20 2020 2070 6f69 6e74 2c20   ROI.    point, 
-00001720: 616e 6420 7468 656e 2061 2064 6973 6b20  and then a disk 
-00001730: 6973 2063 616c 6375 6c61 7465 6420 6365  is calculated ce
-00001740: 6e74 6572 6564 206f 6e20 7468 6520 6564  ntered on the ed
-00001750: 6765 0a20 2020 2066 6974 7465 6420 6365  ge.    fitted ce
-00001760: 6e74 6572 2061 6e64 2074 6865 6e20 7468  nter and then th
-00001770: 6520 434f 4d20 696e 7369 6465 2074 6861  e COM inside tha
-00001780: 7420 6469 736b 2069 7320 616c 736f 0a20  t disk is also. 
-00001790: 2020 2063 616c 6375 6c61 7465 642e 0a0a     calculated...
-000017a0: 2020 2020 3a41 7574 686f 7273 3a0a 2020      :Authors:.  
-000017b0: 2020 4465 6261 6e67 7368 7520 4d75 6b68    Debangshu Mukh
-000017c0: 6572 6a65 6520 3c6d 756b 6865 726a 6565  erjee <mukherjee
-000017d0: 6440 6f72 6e6c 2e67 6f76 3e0a 2020 2020  d@ornl.gov>.    
-000017e0: 7209 0000 0072 2800 0000 7204 0000 0072  r....r(...r....r
-000017f0: 0100 0000 4e72 0600 0000 6700 0000 0000  ....Nr....g.....
-00001800: 00d0 3f29 015a 0a68 7962 7269 6469 7a65  ..?).Z.hybridize
-00001810: 7272 2b00 0000 2918 720d 0000 0072 2c00  rr+...).r....r,.
-00001820: 0000 722d 0000 0072 1200 0000 722e 0000  ..r-...r....r...
-00001830: 0072 2f00 0000 7235 0000 0072 3200 0000  .r/...r5...r2...
-00001840: 720f 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
-00001850: 3100 0000 720e 0000 0072 2300 0000 7202  1...r....r#...r.
-00001860: 0000 0072 1100 0000 da04 7363 6e64 da0f  ...r......scnd..
-00001870: 6761 7573 7369 616e 5f66 696c 7465 7272  gaussian_filterr
-00001880: 2400 0000 7225 0000 005a 0a63 726f 7373  $...r%...Z.cross
-00001890: 5f63 6f72 7272 1500 0000 5a04 666c 6970  _corrr....Z.flip
-000018a0: 7230 0000 0029 2072 3700 0000 7219 0000  r0...) r7...r...
-000018b0: 00da 0870 6f73 6974 696f 6e72 3800 0000  ...positionr8...
-000018c0: 5a07 6d65 645f 7661 6c72 3a00 0000 723b  Z.med_valr:...r;
-000018d0: 0000 005a 0a64 6174 6134 445f 524f 4972  ...Z.data4D_ROIr
-000018e0: 3c00 0000 5a02 7171 5a09 6e6f 5f70 6f69  <...Z.qqZ.no_poi
-000018f0: 6e74 735a 0a66 6974 7465 645f 706f 735a  ntsZ.fitted_posZ
-00001900: 0a66 6974 7465 645f 636f 6d5a 0570 6f73  .fitted_comZ.pos
-00001910: 5f70 5a05 706f 735f 715a 0963 6f72 725f  _pZ.pos_qZ.corr_
-00001920: 6469 736b 5a0f 736f 6265 6c5f 636f 7272  diskZ.sobel_corr
-00001930: 5f64 6973 6b72 1e00 0000 5a05 705f 6365  _diskr....Z.p_ce
-00001940: 6e5a 0571 5f63 656e 5a05 705f 636f 6d5a  nZ.q_cenZ.p_comZ
-00001950: 0571 5f63 6f6d 721b 0000 005a 0a63 6265  .q_comr....Z.cbe
-00001960: 645f 696d 6167 655a 0973 6c6d 5f69 6d61  d_imageZ.slm_ima
-00001970: 6765 7218 0000 0072 1a00 0000 5a0d 6669  ger....r....Z.fi
-00001980: 7474 6564 5f63 656e 7465 725a 0d66 6974  tted_centerZ.fit
-00001990: 7465 645f 6369 7263 6c65 5a09 696d 6167  ted_circleZ.imag
-000019a0: 655f 7375 6d5a 0963 6f6d 5f70 6f73 5f70  e_sumZ.com_pos_p
-000019b0: 5a09 636f 6d5f 706f 735f 7172 1f00 0000  Z.com_pos_qr....
-000019c0: 721f 0000 0072 2000 0000 da10 6470 635f  r....r .....dpc_
-000019d0: 6365 6e74 7261 6c5f 6469 736b 7a00 0000  central_diskz...
-000019e0: 7366 0000 0000 340e 011e 0226 0120 0126  sf....4....&. .&
-000019f0: 010a 0114 0114 0208 0108 0106 0118 ff04  ................
-00001a00: 0310 0220 0120 0120 0120 0212 0116 0106  ... . . . ......
-00001a10: 0112 ff08 0306 0102 ff18 040c ff14 0312  ................
-00001a20: 0206 0108 ff04 030a 010c 0118 ff02 ff04  ................
-00001a30: 0410 0206 0118 ff04 030a 010e 011a 011a  ................
-00001a40: 021e 0220 0120 0120 0120 0272 4300 0000  ... . . . .rC...
-00001a50: e91e 0000 0072 2800 0000 6303 0000 0000  .....r(...c.....
-00001a60: 0000 0000 0000 0005 0000 0007 0000 0043  ...............C
-00001a70: 0000 0073 7400 0000 6401 7400 6a01 a002  ...st...d.t.j...
-00001a80: 7c00 a101 1700 7d00 7400 6a01 a003 7404  |.....}.t.j...t.
-00001a90: a005 7400 6a01 a006 7c00 a101 7c02 a102  ..t.j...|...|...
-00001aa0: a101 5c02 7d03 7d04 7407 a008 7c03 a101  ..\.}.}.t...|...
-00001ab0: 7c01 1400 7c03 7c03 7c01 7407 a008 7c03  |...|.|.|.t...|.
-00001ac0: a101 1400 6b04 3c00 7407 a008 7c03 a101  ....k.<.t...|...
-00001ad0: 7c01 1b00 7c03 7c03 7407 a008 7c03 a101  |...|.|.t...|...
-00001ae0: 7c01 1b00 6b00 3c00 7c03 5300 2902 613b  |...k.<.|.S.).a;
-00001af0: 0400 000a 2020 2020 5461 6b65 2074 6865  ....    Take the
-00001b00: 204c 6f67 2d53 6f62 656c 206f 6620 6120   Log-Sobel of a 
-00001b10: 7061 7474 6572 6e2e 0a0a 2020 2020 5061  pattern...    Pa
-00001b20: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00001b30: 2d2d 2d2d 2d2d 2d0a 2020 2020 7061 7474  -------.    patt
-00001b40: 6572 6e3a 2020 2020 6e64 6172 7261 790a  ern:    ndarray.
-00001b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001b60: 496d 6167 6520 6f6e 2077 6869 6368 204c  Image on which L
-00001b70: 6f67 2d53 6f62 656c 2069 7320 746f 2062  og-Sobel is to b
-00001b80: 6520 7065 7266 6f72 6d65 640a 2020 2020  e performed.    
-00001b90: 6d65 645f 6661 6374 6f72 3a20 666c 6f61  med_factor: floa
-00001ba0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00001bb0: 2020 4475 6520 746f 2064 6574 6563 746f    Due to detecto
-00001bc0: 7220 6e6f 6973 652c 2073 6f6d 6520 7374  r noise, some st
-00001bd0: 7261 7920 7069 7865 6c73 206d 6179 206f  ray pixels may o
-00001be0: 6674 656e 2062 6520 6272 6967 6874 6572  ften be brighter
-00001bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001c00: 2074 6861 6e20 7468 6520 6261 636b 6772   than the backgr
-00001c10: 6f75 6e64 2e20 5468 6973 2069 7320 7573  ound. This is us
-00001c20: 6564 2066 6f72 2064 616d 7069 6e67 2061  ed for damping a
-00001c30: 6e79 2073 7563 6820 7069 7865 6c73 2e0a  ny such pixels..
-00001c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c50: 4465 6661 756c 7420 6973 2033 300a 2020  Default is 30.  
-00001c60: 2020 6761 7573 735f 7661 6c3a 2020 666c    gauss_val:  fl
-00001c70: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-00001c80: 2020 2020 5468 6520 7374 616e 6461 7264      The standard
-00001c90: 2064 6576 6961 7469 6f6e 206f 6620 7468   deviation of th
-00001ca0: 6520 4761 7573 7369 616e 2066 696c 7465  e Gaussian filte
-00001cb0: 7220 6170 706c 6965 6420 746f 2074 6865  r applied to the
-00001cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001cd0: 206c 6f67 6172 6974 686d 206f 6620 7468   logarithm of th
-00001ce0: 6520 4342 4544 2070 6174 7465 726e 2e20  e CBED pattern. 
-00001cf0: 4465 6661 756c 7420 6973 2033 0a0a 2020  Default is 3..  
-00001d00: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
-00001d10: 2d2d 2d2d 2d0a 2020 2020 6c73 625f 7061  -----.    lsb_pa
-00001d20: 7474 6572 6e3a 206e 6461 7272 6179 0a20  ttern: ndarray. 
-00001d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d40: 4c6f 672d 536f 6265 6c20 4669 6c74 6572  Log-Sobel Filter
-00001d50: 6564 2070 6174 7465 726e 0a0a 2020 2020  ed pattern..    
-00001d60: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-00001d70: 2020 2020 4765 6e65 7261 7465 2074 6865      Generate the
-00001d80: 2053 6f62 656c 2066 696c 7465 7265 6420   Sobel filtered 
-00001d90: 7061 7474 6572 6e20 6f66 2074 6865 206c  pattern of the l
-00001da0: 6f67 6172 6974 686d 206f 660a 2020 2020  ogarithm of.    
-00001db0: 6120 6461 7461 7365 742e 2043 6f6d 7061  a dataset. Compa
-00001dc0: 7265 6420 746f 2072 756e 6e69 6e67 2074  red to running t
-00001dd0: 6865 2053 6f62 656c 2066 696c 7465 7220  he Sobel filter 
-00001de0: 6261 636b 206f 6e0a 2020 2020 6120 6c6f  back on.    a lo
-00001df0: 6720 6461 7461 7365 742c 2074 6869 7320  g dataset, this 
-00001e00: 7461 6b65 7320 6361 7265 206f 6620 736f  takes care of so
-00001e10: 6d65 7468 696e 6773 202d 206e 6f74 6162  methings - notab
-00001e20: 6c79 0a20 2020 2061 2047 6175 7373 6961  ly.    a Gaussia
-00001e30: 6e20 626c 7572 2069 7320 6170 706c 6965  n blur is applie
-00001e40: 6420 746f 2074 6865 2069 6d61 6765 2c20  d to the image, 
-00001e50: 616e 6420 536f 6265 6c20 7370 696b 6573  and Sobel spikes
-00001e60: 0a20 2020 2061 7265 2072 656d 6f76 6564  .    are removed
-00001e70: 2077 6865 6e20 616e 7920 7661 6c75 6573   when any values
-00001e80: 2061 7265 2074 6f6f 2068 6967 6865 7220   are too higher 
-00001e90: 6f72 206c 6f77 6572 2074 6861 6e0a 2020  or lower than.  
-00001ea0: 2020 7468 6520 6d65 6469 616e 206f 6620    the median of 
-00001eb0: 7468 6520 696d 6167 652e 2054 6869 7320  the image. This 
-00001ec0: 6973 2062 6563 6175 7365 2072 6561 6c20  is because real 
-00001ed0: 6465 7465 6374 6f72 0a20 2020 2069 6d61  detector.    ima
-00001ee0: 6765 7320 6f66 7465 6e20 6172 6520 7665  ges often are ve
-00001ef0: 7279 206e 6f69 7379 2e0a 0a20 2020 2053  ry noisy...    S
-00001f00: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
-00001f10: 2d2d 2d2d 0a20 2020 206e 6265 642e 6c6f  ----.    nbed.lo
-00001f20: 675f 736f 6265 6c34 440a 2020 2020 7206  g_sobel4D.    r.
-00001f30: 0000 0029 0972 1300 0000 7214 0000 005a  ...).r....r....Z
-00001f40: 1069 6d61 6765 5f6e 6f72 6d61 6c69 7a65  .image_normalize
-00001f50: 7272 2300 0000 7240 0000 0072 4100 0000  rr#...r@...rA...
-00001f60: 7224 0000 0072 0d00 0000 7225 0000 0029  r$...r....r%...)
-00001f70: 0572 3d00 0000 7239 0000 005a 0967 6175  .r=...r9...Z.gau
-00001f80: 7373 5f76 616c 5a0b 6c73 625f 7061 7474  ss_valZ.lsb_patt
-00001f90: 6572 6e72 1e00 0000 721f 0000 0072 1f00  ernr....r....r..
-00001fa0: 0000 7220 0000 00da 096c 6f67 5f73 6f62  ..r .....log_sob
-00001fb0: 656c ec00 0000 7312 0000 0000 2310 0106  el....s.....#...
-00001fc0: 0112 ff08 040c ff14 040c ff14 0372 4500  .............rE.
-00001fd0: 0000 2901 7222 0000 0029 0272 0600 0000  ..).r"...).r....
-00001fe0: 7222 0000 0029 0272 0600 0000 723f 0000  r"...).r....r?..
-00001ff0: 0029 0272 4400 0000 7228 0000 0029 125a  .).rD...r(...).Z
-00002000: 0d73 6369 7079 2e6e 6469 6d61 6765 5a07  .scipy.ndimageZ.
-00002010: 6e64 696d 6167 6572 4000 0000 5a0e 7363  ndimager@...Z.sc
-00002020: 6970 792e 6f70 7469 6d69 7a65 da08 6f70  ipy.optimize..op
-00002030: 7469 6d69 7a65 da03 7369 6f5a 056e 756d  timize..sioZ.num
-00002040: 7079 720d 0000 0072 0b00 0000 da08 7374  pyr....r......st
-00002050: 656d 746f 6f6c 7213 0000 005a 0974 7164  emtoolr....Z.tqd
-00002060: 6d2e 6175 746f 7202 0000 0072 2100 0000  m.autor....r!...
-00002070: 7227 0000 0072 3e00 0000 7243 0000 0072  r'...r>...rC...r
-00002080: 4500 0000 721f 0000 0072 1f00 0000 721f  E...r....r....r.
-00002090: 0000 0072 2000 0000 da08 3c6d 6f64 756c  ...r .....<modul
-000020a0: 653e 0100 0000 7314 0000 000c 010c 0108  e>....s.........
-000020b0: 0108 0108 010c 0308 1b0a 0b0a 4b0a 72    ............K.r
+00000d60: 739a 0300 0074 00a0 0164 01a1 0101 0074  s....t...d.....t
+00000d70: 02a0 037c 03a1 0164 026b 0072 1b74 026a  ...|...d.k.r.t.j
+00000d80: 047c 006a 0564 0219 007c 006a 0564 0319  .|.j.d...|.j.d..
+00000d90: 0066 0274 0664 048d 027d 0374 026a 0764  .f.t.d...}.t.j.d
+00000da0: 057c 006a 0564 0219 0085 0264 057c 006a  .|.j.d.....d.|.j
+00000db0: 0564 0319 0085 0266 0219 005c 027d 057d  .d.....f...\.}.}
+00000dc0: 067c 0064 0664 0685 0264 0664 0685 027c  .|.d.d...d.d...|
+00000dd0: 057c 0319 007c 067c 0319 0066 0419 007d  .|...|.|...f...}
+00000de0: 0774 026a 0764 057c 006a 0564 0519 0085  .t.j.d.|.j.d....
+00000df0: 0264 057c 006a 0564 0719 0085 0266 0219  .d.|.j.d.....f..
+00000e00: 005c 027d 087d 0974 02a0 087c 03a1 017d  .\.}.}.t...|...}
+00000e10: 0a74 026a 0964 027c 0a66 0274 026a 0a64  .t.j.d.|.f.t.j.d
+00000e20: 048d 027d 0b74 026a 0964 027c 0a66 0274  ...}.t.j.d.|.f.t
+00000e30: 026a 0a64 048d 027d 0c7c 0264 0519 007d  .j.d...}.|.d...}
+00000e40: 0d7c 0264 0719 007d 0e74 0b6a 0ca0 0d74  .|.d...}.t.j...t
+00000e50: 02a0 0e7c 006a 0564 0564 0285 0219 00a1  ...|.j.d.d......
+00000e60: 017c 0d7c 0e7c 01a1 047d 0f74 0b6a 0ca0  .|.|.|...}.t.j..
+00000e70: 0f7c 0fa1 015c 027d 107d 1174 026a 097c  .|...\.}.}.t.j.|
+00000e80: 006a 0564 0219 007c 006a 0564 0319 0066  .j.d...|.j.d...f
+00000e90: 0274 026a 0a64 048d 027d 1274 026a 097c  .t.j.d...}.t.j.|
+00000ea0: 006a 0564 0219 007c 006a 0564 0319 0066  .j.d...|.j.d...f
+00000eb0: 0274 026a 0a64 048d 027d 1374 026a 097c  .t.j.d...}.t.j.|
+00000ec0: 006a 0564 0219 007c 006a 0564 0319 0066  .j.d...|.j.d...f
+00000ed0: 0274 026a 0a64 048d 027d 1474 026a 097c  .t.j.d...}.t.j.|
+00000ee0: 006a 0564 0219 007c 006a 0564 0319 0066  .j.d...|.j.d...f
+00000ef0: 0274 026a 0a64 048d 027d 1574 1074 117c  .t.j.d...}.t.t.|
+00000f00: 0a83 0183 0144 005d b57d 167c 0764 0664  .....D.].}.|.d.d
+00000f10: 0685 0264 0664 0685 027c 1666 0319 007d  ...d.d...|.f...}
+00000f20: 1774 0b6a 0ca0 0f74 12a0 1374 0b6a 0ca0  .t.j...t...t.j..
+00000f30: 147c 17a1 0164 03a1 02a1 015c 027d 187d  .|...d.....\.}.}
+00000f40: 117c 0474 02a0 157c 18a1 0114 007c 187c  .|.t...|.....|.|
+00000f50: 187c 0474 02a0 157c 18a1 0114 006b 043c  .|.t...|.....k.<
+00000f60: 0074 02a0 157c 18a1 017c 041b 007c 187c  .t...|...|...|.|
+00000f70: 1874 02a0 157c 18a1 017c 041b 006b 003c  .t...|...|...k.<
+00000f80: 0074 0b6a 0c6a 167c 187c 1064 0864 098d  .t.j.j.|.|.d.d..
+00000f90: 037d 1974 0b6a 0ca0 177c 197c 0d7c 0e7c  .}.t.j...|.|.|.|
+00000fa0: 01a1 047d 1a7c 1a64 0564 0285 0219 0074  ...}.|.d.d.....t
+00000fb0: 02a0 0e7c 0d7c 0e66 02a1 0164 0a74 02a0  ...|.|.f...d.t..
+00000fc0: 1874 02a0 0e74 02a0 057c 17a1 01a1 01a1  .t...t...|......
+00000fd0: 0114 0018 0017 007d 1b7c 1b7c 0b64 0564  .......}.|.|.d.d
+00000fe0: 0285 027c 1666 023c 0074 0b6a 0ca0 0d74  ...|.f.<.t.j...t
+00000ff0: 02a0 0e7c 176a 05a1 017c 1b64 0519 007c  ...|.j...|.d...|
+00001000: 1b64 0719 007c 01a1 047d 1c7c 1ca0 1974  .d...|...}.|...t
+00001010: 06a1 017d 1c74 02a0 087c 177c 1c19 00a1  ...}.t...|.|....
+00001020: 017d 1d74 02a0 087c 177c 1c19 007c 087c  .}.t...|.|...|.|
+00001030: 1c19 0014 00a1 017c 1d1b 007d 1e74 02a0  .......|...}.t..
+00001040: 087c 177c 1c19 007c 097c 1c19 0014 00a1  .|.|...|.|......
+00001050: 017c 1d1b 007d 1f74 02a0 0e7c 1e7c 1f66  .|...}.t...|.|.f
+00001060: 02a1 017c 0c64 0564 0285 027c 1666 023c  ...|.d.d...|.f.<
+00001070: 0071 d17c 0b64 0564 0664 0685 0266 0219  .q.|.d.d.d...f..
+00001080: 007c 127c 057c 0319 007c 067c 0319 0066  .|.|.|...|.|...f
+00001090: 023c 007c 0b64 0764 0664 0685 0266 0219  .<.|.d.d.d...f..
+000010a0: 007c 137c 057c 0319 007c 067c 0319 0066  .|.|.|...|.|...f
+000010b0: 023c 007c 0c64 0564 0664 0685 0266 0219  .<.|.d.d.d...f..
+000010c0: 007c 147c 057c 0319 007c 067c 0319 0066  .|.|.|...|.|...f
+000010d0: 023c 007c 0c64 0764 0664 0685 0266 0219  .<.|.d.d.d...f..
+000010e0: 007c 157c 057c 0319 007c 067c 0319 0066  .|.|.|...|.|...f
+000010f0: 023c 007c 127c 137c 147c 1566 0453 0029  .<.|.|.|.|.f.S.)
+00001100: 0b61 e006 0000 0a20 2020 2044 5043 2072  .a.....    DPC r
+00001110: 6f75 7469 6e65 206f 6e20 6f6e 6c79 2074  outine on only t
+00001120: 6865 2063 656e 7472 616c 2064 6973 6b0a  he central disk.
+00001130: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00001140: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00001150: 2020 2064 6174 6134 443a 2020 2020 206e     data4D:     n
+00001160: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00001170: 2020 2020 2020 2054 6865 2034 2064 696d         The 4 dim
+00001180: 656e 7369 6f6e 616c 2064 6174 6173 6574  ensional dataset
+00001190: 2074 6861 7420 7769 6c6c 2062 6520 616e   that will be an
+000011a0: 616c 797a 6564 0a20 2020 2020 2020 2020  alyzed.         
+000011b0: 2020 2020 2020 2054 6865 2066 6972 7374         The first
+000011c0: 2074 776f 2064 696d 656e 7369 6f6e 7320   two dimensions 
+000011d0: 6172 6520 7468 6520 466f 7572 6965 7220  are the Fourier 
+000011e0: 7370 6163 650a 2020 2020 2020 2020 2020  space.          
+000011f0: 2020 2020 2020 6469 6666 7261 6374 696f        diffractio
+00001200: 6e20 6469 6d65 6e73 696f 6e73 2061 6e64  n dimensions and
+00001210: 2074 6865 206c 6173 7420 7477 6f20 6469   the last two di
+00001220: 6d65 6e73 696f 6e73 0a20 2020 2020 2020  mensions.       
+00001230: 2020 2020 2020 2020 2061 7265 2074 6865           are the
+00001240: 2072 6561 6c20 7370 6163 6520 7363 616e   real space scan
+00001250: 6e69 6e67 2064 696d 656e 7369 6f6e 730a  ning dimensions.
+00001260: 2020 2020 6469 736b 5f73 697a 653a 2020      disk_size:  
+00001270: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+00001280: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
+00001290: 6520 6365 6e74 7261 6c20 6469 736b 0a20  e central disk. 
+000012a0: 2020 2070 6f73 6974 696f 6e3a 2020 206e     position:   n
+000012b0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+000012c0: 2020 2020 2020 2058 2061 6e64 2059 2070         X and Y p
+000012d0: 6f73 6974 696f 6e73 0a20 2020 2020 2020  ositions.       
+000012e0: 2020 2020 2020 2020 2054 6869 7320 6973           This is
+000012f0: 2074 6865 2069 6e69 7469 616c 2067 7565   the initial gue
+00001300: 7373 2074 6861 7420 7769 6c6c 2062 6520  ss that will be 
+00001310: 7265 6669 6e65 640a 2020 2020 524f 493a  refined.    ROI:
+00001320: 2020 2020 2020 2020 6e64 6172 7261 790a          ndarray.
+00001330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001340: 5468 6520 7265 6769 6f6e 206f 6620 696e  The region of in
+00001350: 7465 7265 7374 2066 6f72 2074 6865 2073  terest for the s
+00001360: 6361 6e6e 696e 6720 7265 6769 6f6e 0a20  canning region. 
+00001370: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00001380: 6861 7420 7769 6c6c 2062 6520 616e 616c  hat will be anal
+00001390: 797a 6564 2e20 4966 206e 6f20 524f 4920  yzed. If no ROI 
+000013a0: 6973 2067 6976 656e 2074 6865 6e0a 2020  is given then.  
+000013b0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+000013c0: 6520 656e 7469 7265 2073 6361 6e6e 6564  e entire scanned
+000013d0: 2061 7265 6120 7769 6c6c 2062 6520 616e   area will be an
+000013e0: 616c 797a 6564 0a20 2020 206d 6564 5f76  alyzed.    med_v
+000013f0: 616c 3a20 2020 2066 6c6f 6174 0a20 2020  al:    float.   
+00001400: 2020 2020 2020 2020 2020 2020 2053 6f6d               Som
+00001410: 6574 696d 6573 2073 6f6d 6520 7069 7865  etimes some pixe
+00001420: 6c73 2061 7265 2065 6974 6865 7220 746f  ls are either to
+00001430: 6f20 6272 6967 6874 2069 6e0a 2020 2020  o bright in.    
+00001440: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00001450: 6469 6966 7261 6374 696f 6e20 7061 7474  diifraction patt
+00001460: 6572 6e73 2064 7565 2074 6f20 7374 7261  erns due to stra
+00001470: 7920 6d75 6f6e 7320 6f72 0a20 2020 2020  y muons or.     
+00001480: 2020 2020 2020 2020 2020 2061 7265 207a             are z
+00001490: 6572 6f20 6475 6520 746f 2064 6561 6420  ero due to dead 
+000014a0: 6465 7465 6374 6f72 2070 6978 656c 732e  detector pixels.
+000014b0: 2054 6869 7320 7265 6d6f 7665 730a 2020   This removes.  
+000014c0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+000014d0: 6520 6566 6665 6374 206f 6620 7375 6368  e effect of such
+000014e0: 2070 6978 656c 7320 6265 666f 7265 2053   pixels before S
+000014f0: 6f62 656c 2066 696c 7465 7269 6e67 0a0a  obel filtering..
+00001500: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00001510: 2d2d 2d2d 2d2d 2d0a 2020 2020 705f 6365  -------.    p_ce
+00001520: 6e3a 206e 6461 7272 6179 0a20 2020 2020  n: ndarray.     
+00001530: 2020 2020 2020 5020 706f 7369 7469 6f6e        P position
+00001540: 7320 6f66 2074 6865 2063 656e 7472 616c  s of the central
+00001550: 2064 6973 6b0a 2020 2020 715f 6365 6e3a   disk.    q_cen:
+00001560: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00001570: 2020 2020 5120 706f 7369 7469 6f6e 7320      Q positions 
+00001580: 6f66 2074 6865 2063 656e 7472 616c 2064  of the central d
+00001590: 6973 6b0a 2020 2020 705f 636f 6d3a 206e  isk.    p_com: n
+000015a0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+000015b0: 2020 5020 706f 7369 7469 6f6e 7320 6f66    P positions of
+000015c0: 2074 6865 2063 656e 7465 7220 6f66 206d   the center of m
+000015d0: 6173 730a 2020 2020 2020 2020 2020 206f  ass.           o
+000015e0: 6620 7468 6520 6365 6e74 7261 6c20 6469  f the central di
+000015f0: 736b 0a20 2020 2071 5f63 6f6d 3a20 6e64  sk.    q_com: nd
+00001600: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00001610: 2051 2070 6f73 6974 696f 6e73 206f 6620   Q positions of 
+00001620: 7468 6520 6365 6e74 6572 206f 6620 6d61  the center of ma
+00001630: 7373 0a20 2020 2020 2020 2020 2020 6f66  ss.           of
+00001640: 2074 6865 2063 656e 7472 616c 2064 6973   the central dis
+00001650: 6b0a 0a20 2020 204e 6f74 6573 0a20 2020  k..    Notes.   
+00001660: 202d 2d2d 2d2d 0a20 2020 2054 6869 7320   -----.    This 
+00001670: 6973 2077 6865 6e20 7765 2077 616e 7420  is when we want 
+00001680: 746f 2070 6572 666f 726d 2044 5043 2077  to perform DPC w
+00001690: 6974 686f 7574 2062 6f74 6865 7269 6e67  ithout bothering
+000016a0: 0a20 2020 2061 626f 7574 2074 6865 2068  .    about the h
+000016b0: 6967 6865 7220 6f72 6465 7220 6469 736b  igher order disk
+000016c0: 732e 2054 6865 2052 4f49 206f 6620 7468  s. The ROI of th
+000016d0: 6520 3444 2064 6174 6173 6574 0a20 2020  e 4D dataset.   
+000016e0: 2069 7320 6361 6c63 756c 6174 6564 2c20   is calculated, 
+000016f0: 616e 6420 7468 6520 6365 6e74 7261 6c20  and the central 
+00001700: 6469 736b 2069 7320 6669 7474 6564 2069  disk is fitted i
+00001710: 6e20 6561 6368 2052 4f49 0a20 2020 2070  n each ROI.    p
+00001720: 6f69 6e74 2c20 616e 6420 7468 656e 2061  oint, and then a
+00001730: 2064 6973 6b20 6973 2063 616c 6375 6c61   disk is calcula
+00001740: 7465 6420 6365 6e74 6572 6564 206f 6e20  ted centered on 
+00001750: 7468 6520 6564 6765 0a20 2020 2066 6974  the edge.    fit
+00001760: 7465 6420 6365 6e74 6572 2061 6e64 2074  ted center and t
+00001770: 6865 6e20 7468 6520 434f 4d20 696e 7369  hen the COM insi
+00001780: 6465 2074 6861 7420 6469 736b 2069 7320  de that disk is 
+00001790: 616c 736f 0a20 2020 2063 616c 6375 6c61  also.    calcula
+000017a0: 7465 642e 0a0a 2020 2020 3a41 7574 686f  ted...    :Autho
+000017b0: 7273 3a0a 2020 2020 4465 6261 6e67 7368  rs:.    Debangsh
+000017c0: 7520 4d75 6b68 6572 6a65 6520 3c6d 756b  u Mukherjee <muk
+000017d0: 6865 726a 6565 6440 6f72 6e6c 2e67 6f76  herjeed@ornl.gov
+000017e0: 3e0a 2020 2020 7204 0000 0072 0a00 0000  >.    r....r....
+000017f0: 7229 0000 0072 0500 0000 7201 0000 004e  r)...r....r....N
+00001800: 7207 0000 0067 0000 0000 0000 d03f 2901  r....g.......?).
+00001810: 5a0a 6879 6272 6964 697a 6572 722c 0000  Z.hybridizerr,..
+00001820: 0029 1a72 0c00 0000 720d 0000 0072 0e00  .).r....r....r..
+00001830: 0000 722d 0000 0072 2e00 0000 7213 0000  ..r-...r....r...
+00001840: 0072 2f00 0000 7230 0000 0072 3600 0000  .r/...r0...r6...
+00001850: 7233 0000 0072 1000 0000 7214 0000 0072  r3...r....r....r
+00001860: 1500 0000 7232 0000 0072 0f00 0000 7224  ....r2...r....r$
+00001870: 0000 0072 0300 0000 7212 0000 00da 0473  ...r....r......s
+00001880: 636e 64da 0f67 6175 7373 6961 6e5f 6669  cnd..gaussian_fi
+00001890: 6c74 6572 7225 0000 0072 2600 0000 5a0a  lterr%...r&...Z.
+000018a0: 6372 6f73 735f 636f 7272 7216 0000 005a  cross_corrr....Z
+000018b0: 0466 6c69 7072 3100 0000 2920 7238 0000  .flipr1...) r8..
+000018c0: 0072 1a00 0000 da08 706f 7369 7469 6f6e  .r......position
+000018d0: 7239 0000 005a 076d 6564 5f76 616c 723b  r9...Z.med_valr;
+000018e0: 0000 0072 3c00 0000 5a0a 6461 7461 3444  ...r<...Z.data4D
+000018f0: 5f52 4f49 723d 0000 005a 0271 715a 096e  _ROIr=...Z.qqZ.n
+00001900: 6f5f 706f 696e 7473 5a0a 6669 7474 6564  o_pointsZ.fitted
+00001910: 5f70 6f73 5a0a 6669 7474 6564 5f63 6f6d  _posZ.fitted_com
+00001920: 5a05 706f 735f 705a 0570 6f73 5f71 5a09  Z.pos_pZ.pos_qZ.
+00001930: 636f 7272 5f64 6973 6b5a 0f73 6f62 656c  corr_diskZ.sobel
+00001940: 5f63 6f72 725f 6469 736b 721f 0000 005a  _corr_diskr....Z
+00001950: 0570 5f63 656e 5a05 715f 6365 6e5a 0570  .p_cenZ.q_cenZ.p
+00001960: 5f63 6f6d 5a05 715f 636f 6d72 1c00 0000  _comZ.q_comr....
+00001970: 5a0a 6362 6564 5f69 6d61 6765 5a09 736c  Z.cbed_imageZ.sl
+00001980: 6d5f 696d 6167 6572 1900 0000 721b 0000  m_imager....r...
+00001990: 005a 0d66 6974 7465 645f 6365 6e74 6572  .Z.fitted_center
+000019a0: 5a0d 6669 7474 6564 5f63 6972 636c 655a  Z.fitted_circleZ
+000019b0: 0969 6d61 6765 5f73 756d 5a09 636f 6d5f  .image_sumZ.com_
+000019c0: 706f 735f 705a 0963 6f6d 5f70 6f73 5f71  pos_pZ.com_pos_q
+000019d0: 7220 0000 0072 2000 0000 7221 0000 00da  r ...r ...r!....
+000019e0: 1064 7063 5f63 656e 7472 616c 5f64 6973  .dpc_central_dis
+000019f0: 6b7a 0000 0073 6800 0000 0a33 0e02 1e01  kz...sh....3....
+00001a00: 2602 2001 2601 0a01 1401 1401 0802 0801  &. .&...........
+00001a10: 0601 1801 04ff 1003 2002 2001 2001 2001  ........ . . . .
+00001a20: 1002 1601 0601 1201 08ff 0603 0201 18ff  ................
+00001a30: 0c04 14ff 1203 0602 0801 04ff 0a03 0c01  ................
+00001a40: 1801 02ff 04ff 1004 0602 1801 04ff 0a03  ................
+00001a50: 0e01 1a01 1a01 1c02 2002 2001 2001 2001  ........ . . . .
+00001a60: 0c02 7244 0000 00e9 1e00 0000 7229 0000  ..rD........r)..
+00001a70: 0063 0300 0000 0000 0000 0000 0000 0500  .c..............
+00001a80: 0000 0700 0000 4300 0000 7374 0000 0064  ......C...st...d
+00001a90: 0174 006a 01a0 027c 00a1 0117 007d 0074  .t.j...|.....}.t
+00001aa0: 006a 01a0 0374 04a0 0574 006a 01a0 067c  .j...t...t.j...|
+00001ab0: 00a1 017c 02a1 02a1 015c 027d 037d 0474  ...|.....\.}.}.t
+00001ac0: 07a0 087c 03a1 017c 0114 007c 037c 037c  ...|...|...|.|.|
+00001ad0: 0174 07a0 087c 03a1 0114 006b 043c 0074  .t...|.....k.<.t
+00001ae0: 07a0 087c 03a1 017c 011b 007c 037c 0374  ...|...|...|.|.t
+00001af0: 07a0 087c 03a1 017c 011b 006b 003c 007c  ...|...|...k.<.|
+00001b00: 0353 0029 0261 3b04 0000 0a20 2020 2054  .S.).a;....    T
+00001b10: 616b 6520 7468 6520 4c6f 672d 536f 6265  ake the Log-Sobe
+00001b20: 6c20 6f66 2061 2070 6174 7465 726e 2e0a  l of a pattern..
+00001b30: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00001b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00001b50: 2020 2070 6174 7465 726e 3a20 2020 206e     pattern:    n
+00001b60: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00001b70: 2020 2020 2020 2049 6d61 6765 206f 6e20         Image on 
+00001b80: 7768 6963 6820 4c6f 672d 536f 6265 6c20  which Log-Sobel 
+00001b90: 6973 2074 6f20 6265 2070 6572 666f 726d  is to be perform
+00001ba0: 6564 0a20 2020 206d 6564 5f66 6163 746f  ed.    med_facto
+00001bb0: 723a 2066 6c6f 6174 0a20 2020 2020 2020  r: float.       
+00001bc0: 2020 2020 2020 2020 2044 7565 2074 6f20           Due to 
+00001bd0: 6465 7465 6374 6f72 206e 6f69 7365 2c20  detector noise, 
+00001be0: 736f 6d65 2073 7472 6179 2070 6978 656c  some stray pixel
+00001bf0: 7320 6d61 7920 6f66 7465 6e20 6265 2062  s may often be b
+00001c00: 7269 6768 7465 720a 2020 2020 2020 2020  righter.        
+00001c10: 2020 2020 2020 2020 7468 616e 2074 6865          than the
+00001c20: 2062 6163 6b67 726f 756e 642e 2054 6869   background. Thi
+00001c30: 7320 6973 2075 7365 6420 666f 7220 6461  s is used for da
+00001c40: 6d70 696e 6720 616e 7920 7375 6368 2070  mping any such p
+00001c50: 6978 656c 732e 0a20 2020 2020 2020 2020  ixels..         
+00001c60: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
+00001c70: 7320 3330 0a20 2020 2067 6175 7373 5f76  s 30.    gauss_v
+00001c80: 616c 3a20 2066 6c6f 6174 0a20 2020 2020  al:  float.     
+00001c90: 2020 2020 2020 2020 2020 2054 6865 2073             The s
+00001ca0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+00001cb0: 6e20 6f66 2074 6865 2047 6175 7373 6961  n of the Gaussia
+00001cc0: 6e20 6669 6c74 6572 2061 7070 6c69 6564  n filter applied
+00001cd0: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
+00001ce0: 2020 2020 2020 2020 6c6f 6761 7269 7468          logarith
+00001cf0: 6d20 6f66 2074 6865 2043 4245 4420 7061  m of the CBED pa
+00001d00: 7474 6572 6e2e 2044 6566 6175 6c74 2069  ttern. Default i
+00001d10: 7320 330a 0a20 2020 2052 6574 7572 6e73  s 3..    Returns
+00001d20: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00001d30: 206c 7362 5f70 6174 7465 726e 3a20 6e64   lsb_pattern: nd
+00001d40: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00001d50: 2020 2020 2020 204c 6f67 2d53 6f62 656c         Log-Sobel
+00001d60: 2046 696c 7465 7265 6420 7061 7474 6572   Filtered patter
+00001d70: 6e0a 0a20 2020 204e 6f74 6573 0a20 2020  n..    Notes.   
+00001d80: 202d 2d2d 2d2d 0a20 2020 2047 656e 6572   -----.    Gener
+00001d90: 6174 6520 7468 6520 536f 6265 6c20 6669  ate the Sobel fi
+00001da0: 6c74 6572 6564 2070 6174 7465 726e 206f  ltered pattern o
+00001db0: 6620 7468 6520 6c6f 6761 7269 7468 6d20  f the logarithm 
+00001dc0: 6f66 0a20 2020 2061 2064 6174 6173 6574  of.    a dataset
+00001dd0: 2e20 436f 6d70 6172 6564 2074 6f20 7275  . Compared to ru
+00001de0: 6e6e 696e 6720 7468 6520 536f 6265 6c20  nning the Sobel 
+00001df0: 6669 6c74 6572 2062 6163 6b20 6f6e 0a20  filter back on. 
+00001e00: 2020 2061 206c 6f67 2064 6174 6173 6574     a log dataset
+00001e10: 2c20 7468 6973 2074 616b 6573 2063 6172  , this takes car
+00001e20: 6520 6f66 2073 6f6d 6574 6869 6e67 7320  e of somethings 
+00001e30: 2d20 6e6f 7461 626c 790a 2020 2020 6120  - notably.    a 
+00001e40: 4761 7573 7369 616e 2062 6c75 7220 6973  Gaussian blur is
+00001e50: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
+00001e60: 696d 6167 652c 2061 6e64 2053 6f62 656c  image, and Sobel
+00001e70: 2073 7069 6b65 730a 2020 2020 6172 6520   spikes.    are 
+00001e80: 7265 6d6f 7665 6420 7768 656e 2061 6e79  removed when any
+00001e90: 2076 616c 7565 7320 6172 6520 746f 6f20   values are too 
+00001ea0: 6869 6768 6572 206f 7220 6c6f 7765 7220  higher or lower 
+00001eb0: 7468 616e 0a20 2020 2074 6865 206d 6564  than.    the med
+00001ec0: 6961 6e20 6f66 2074 6865 2069 6d61 6765  ian of the image
+00001ed0: 2e20 5468 6973 2069 7320 6265 6361 7573  . This is becaus
+00001ee0: 6520 7265 616c 2064 6574 6563 746f 720a  e real detector.
+00001ef0: 2020 2020 696d 6167 6573 206f 6674 656e      images often
+00001f00: 2061 7265 2076 6572 7920 6e6f 6973 792e   are very noisy.
+00001f10: 0a0a 2020 2020 5365 6520 416c 736f 0a20  ..    See Also. 
+00001f20: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00001f30: 6e62 6564 2e6c 6f67 5f73 6f62 656c 3444  nbed.log_sobel4D
+00001f40: 0a20 2020 2072 0700 0000 2909 7214 0000  .    r....).r...
+00001f50: 0072 1500 0000 5a10 696d 6167 655f 6e6f  .r....Z.image_no
+00001f60: 726d 616c 697a 6572 7224 0000 0072 4100  rmalizerr$...rA.
+00001f70: 0000 7242 0000 0072 2500 0000 720e 0000  ..rB...r%...r...
+00001f80: 0072 2600 0000 2905 723e 0000 0072 3a00  .r&...).r>...r:.
+00001f90: 0000 5a09 6761 7573 735f 7661 6c5a 0b6c  ..Z.gauss_valZ.l
+00001fa0: 7362 5f70 6174 7465 726e 721f 0000 0072  sb_patternr....r
+00001fb0: 2000 0000 7220 0000 0072 2100 0000 da09   ...r ...r!.....
+00001fc0: 6c6f 675f 736f 6265 6ced 0000 0073 1200  log_sobel....s..
+00001fd0: 0000 1023 0601 1201 08ff 0c04 14ff 0c04  ...#............
+00001fe0: 14ff 0403 7246 0000 0029 0172 2300 0000  ....rF...).r#...
+00001ff0: 2902 7207 0000 0072 2300 0000 2902 7207  ).r....r#...).r.
+00002000: 0000 0072 4000 0000 2902 7245 0000 0072  ...r@...).rE...r
+00002010: 2900 0000 2913 5a0d 7363 6970 792e 6e64  )...).Z.scipy.nd
+00002020: 696d 6167 655a 076e 6469 6d61 6765 7241  imageZ.ndimagerA
+00002030: 0000 005a 0e73 6369 7079 2e6f 7074 696d  ...Z.scipy.optim
+00002040: 697a 65da 086f 7074 696d 697a 65da 0373  ize..optimize..s
+00002050: 696f 5a05 6e75 6d70 7972 0e00 0000 720c  ioZ.numpyr....r.
+00002060: 0000 00da 0873 7465 6d74 6f6f 6c72 1400  .....stemtoolr..
+00002070: 0000 5a09 7471 646d 2e61 7574 6f72 0200  ..Z.tqdm.autor..
+00002080: 0000 7203 0000 0072 2200 0000 7228 0000  ..r....r"...r(..
+00002090: 0072 3f00 0000 7244 0000 0072 4600 0000  .r?...rD...rF...
+000020a0: 7220 0000 0072 2000 0000 7220 0000 0072  r ...r ...r ...r
+000020b0: 2100 0000 da08 3c6d 6f64 756c 653e 0100  !.....<module>..
+000020c0: 0000 7316 0000 000c 000c 0108 0108 0108  ..s.............
+000020d0: 0110 0108 030a 1b0a 0b0a 4b0e 73         ..........K.s
```

## Comparing `stemtool/eels/__pycache__/eels_tools.cpython-39.pyc` & `stemtool/eels/__pycache__/eels_tools.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:29:01 2023 UTC, .py size: 11485 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 6% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 dd38 e163 dd2c 0000  a........8.c.,..
+00000000: 6f0d 0d0a 0000 0000 8a74 6f64 dd2c 0000  o........tod.,..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0005 0000 0040 0000 0073 a200 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 6d04 5a05 0100 6400 6401 6c06  d.l.m.Z...d.d.l.
 00000050: 6d07 5a08 0100 6400 6401 6c09 6d0a 5a0b  m.Z...d.d.l.m.Z.
 00000060: 0100 6400 6401 6c0c 5a0d 6400 6402 6c0e  ..d.d.l.Z.d.d.l.
 00000070: 6d0f 5a0f 0100 6403 6404 8400 5a10 641a  m.Z...d.d...Z.d.
@@ -14,251 +14,251 @@
 000000d0: 291e e900 0000 004e 2901 da06 7472 616e  )......N)...tran
 000000e0: 6765 6302 0000 0000 0000 0000 0000 0008  gec.............
 000000f0: 0000 0009 0000 0043 0000 0073 7a00 0000  .......C...sz...
 00000100: 7400 a001 6401 a101 7d02 7400 a002 7403  t...d...}.t...t.
 00000110: 7c00 8301 7c02 6a04 a102 7d03 7400 6a05  |...|.j...}.t.j.
 00000120: 7c00 6401 7c03 6402 8d03 7d04 7c04 7d05  |.d.|.d...}.|.}.
 00000130: 6403 7d01 7406 6404 7403 7c04 8301 8302  d.}.t.d.t.|.....
-00000140: 4400 5d26 7d06 7400 a007 7c04 7c06 1900  D.]&}.t...|.|...
+00000140: 4400 5d13 7d06 7400 a007 7c04 7c06 1900  D.].}.t...|.|...
 00000150: 7c01 7408 a009 7c04 7c06 1900 a101 1400  |.t...|.|.......
-00000160: a102 7c05 7c06 3c00 7142 7400 a00a 7c05  ..|.|.<.qBt...|.
+00000160: a102 7c05 7c06 3c00 7121 7400 a00a 7c05  ..|.|.<.q!t...|.
 00000170: 6401 a102 7d07 7c07 5300 2905 4e5a 0473  d...}.|.S.).NZ.s
 00000180: 796d 3429 01da 056c 6576 656c 679a 9999  ym4)...levelg...
 00000190: 9999 99b9 3fe9 0100 0000 290b da04 7079  ....?.....)...py
 000001a0: 7774 5a07 5761 7665 6c65 745a 0d64 7774  wtZ.WaveletZ.dwt
 000001b0: 5f6d 6178 5f6c 6576 656c da03 6c65 6e5a  _max_level..lenZ
 000001c0: 0764 6563 5f6c 656e 5a07 7761 7665 6465  .dec_lenZ.wavede
 000001d0: 6372 0200 0000 da09 7468 7265 7368 6f6c  cr......threshol
 000001e0: 64da 026e 70da 0461 6d61 785a 0777 6176  d..np..amaxZ.wav
 000001f0: 6572 6563 2908 da04 6461 7461 7207 0000  erec)...datar...
 00000200: 005a 0477 6176 655a 096d 6178 5f6c 6576  .Z.waveZ.max_lev
 00000210: 656c 5a06 636f 6566 6673 5a07 636f 6566  elZ.coeffsZ.coef
 00000220: 6673 32da 0269 695a 0564 6174 6132 a900  fs2..iiZ.data2..
-00000230: 720c 0000 00fa 3e62 7569 6c64 2f62 6469  r.....>build/bdi
-00000240: 7374 2e6d 6163 6f73 782d 3130 2e39 2d78  st.macosx-10.9-x
-00000250: 3836 5f36 342f 6567 672f 7374 656d 746f  86_64/egg/stemto
-00000260: 6f6c 2f65 656c 732f 6565 6c73 5f74 6f6f  ol/eels/eels_too
-00000270: 6c73 2e70 79da 1163 6c65 616e 4545 4c53  ls.py..cleanEELS
-00000280: 5f77 6176 656c 6574 0a00 0000 7312 0000  _wavelet....s...
-00000290: 0000 010a 0112 0110 0104 0104 0112 0124  ...............$
-000002a0: 010c 0172 0e00 0000 6303 0000 0000 0000  ...r....c.......
-000002b0: 0000 0000 0007 0000 0008 0000 0043 0000  .............C..
-000002c0: 0073 e600 0000 7400 a001 7400 a002 7c00  .s....t...t...|.
-000002d0: a101 a101 a003 7404 a101 7d03 7400 a005  ......t...}.t...
-000002e0: 7c03 a101 7d04 7c01 6401 6b02 7280 7c02  |...}.|.d.k.r.|.
-000002f0: 6402 6b04 727c 7406 7c03 6403 1900 8301  d.k.r|t.|.d.....
-00000300: 4400 5d3c 7d05 7406 7c03 6404 1900 8301  D.]<}.t.|.d.....
-00000310: 4400 5d2a 7d06 7407 7c00 6400 6400 8502  D.]*}.t.|.d.d...
-00000320: 7c06 7c05 6603 1900 7c02 8302 7c04 6400  |.|.f...|...|.d.
-00000330: 6400 8502 7c06 7c05 6603 3c00 714c 713c  d...|.|.f.<.qLq<
-00000340: 6e04 7c00 7d04 7c01 6405 6b02 72e2 7c02  n.|.}.|.d.k.r.|.
-00000350: 6402 6b04 72de 7406 7c03 6403 1900 8301  d.k.r.t.|.d.....
-00000360: 4400 5d3e 7d05 7406 7c03 6404 1900 8301  D.]>}.t.|.d.....
-00000370: 4400 5d2c 7d06 7408 a009 7c00 6400 6400  D.],}.t...|.d.d.
-00000380: 8502 7c06 7c05 6603 1900 7c02 a102 7c04  ..|.|.f...|...|.
-00000390: 6400 6400 8502 7c06 7c05 6603 3c00 71ac  d.d...|.|.f.<.q.
-000003a0: 719c 6e04 7c00 7d04 7c04 5300 2906 4e5a  q.n.|.}.|.S.).NZ
-000003b0: 0777 6176 656c 6574 7201 0000 00e9 0200  .waveletr.......
-000003c0: 0000 7204 0000 00da 066d 6564 6961 6e29  ..r......median)
-000003d0: 0a72 0800 0000 da07 6173 6172 7261 79da  .r......asarray.
-000003e0: 0573 6861 7065 5a06 6173 7479 7065 da03  .shapeZ.astype..
-000003f0: 696e 74da 057a 6572 6f73 da05 7261 6e67  int..zeros..rang
-00000400: 6572 0e00 0000 da06 7363 6973 6967 5a07  er......scisigZ.
-00000410: 6d65 6466 696c 7429 075a 0664 6174 6133  medfilt).Z.data3
-00000420: 44da 066d 6574 686f 6472 0700 0000 5a0a  D..methodr....Z.
-00000430: 6461 7461 5f73 6861 7065 5a0a 636c 6561  data_shapeZ.clea
-00000440: 6e65 645f 3344 720b 0000 00da 026a 6a72  ned_3Dr......jjr
-00000450: 0c00 0000 720c 0000 0072 0d00 0000 da0c  ....r....r......
-00000460: 636c 6561 6e45 454c 535f 3344 1600 0000  cleanEELS_3D....
-00000470: 7322 0000 0000 0116 010a 0108 0108 0110  s"..............
-00000480: 0110 0102 0112 ff18 0404 0108 0108 0110  ................
-00000490: 0110 012e 0204 0172 1900 0000 6303 0000  .......r....c...
-000004a0: 0000 0000 0000 0000 000a 0000 0008 0000  ................
-000004b0: 0043 0000 0073 d200 0000 7400 a001 7c02  .C...s....t...|.
-000004c0: 6401 1900 7400 a002 7c00 a101 1800 7400  d...t...|.....t.
-000004d0: a003 7400 a004 7c00 a101 a101 1b00 a101  ..t...|.........
-000004e0: 7d03 7400 a001 7c02 6402 1900 7400 a002  }.t...|.d...t...
-000004f0: 7c00 a101 1800 7400 a003 7400 a004 7c00  |.....t...t...|.
-00000500: a101 a101 1b00 a101 7d04 7400 a005 7c00  ........}.t...|.
-00000510: 7c03 7c04 8502 1900 7400 a006 7c01 7c03  |.|.....t...|.|.
-00000520: 7c04 8502 1900 6401 6b04 a101 1900 a101  |.....d.k.......
-00000530: 7d05 7400 a005 7c01 7c03 7c04 8502 1900  }.t...|.|.|.....
-00000540: 7400 a006 7c01 7c03 7c04 8502 1900 6401  t...|.|.|.....d.
-00000550: 6b04 a101 1900 a101 7d06 7400 a007 7c05  k.......}.t...|.
-00000560: 7c06 6402 a103 5c02 7d07 7d08 7400 a008  |.d...\.}.}.t...
-00000570: 7c08 a101 7d08 7c08 7c00 7c07 1300 1400  |...}.|.|.|.....
-00000580: 7d09 7c09 7c07 7c08 6603 5300 2903 6185  }.|.|.|.f.S.).a.
-00000590: 0400 000a 2020 2020 506f 7765 7220 4c61  ....    Power La
-000005a0: 7720 4669 6974 696e 6720 6f66 2045 454c  w Fiiting of EEL
-000005b0: 5320 7370 6563 7472 616c 2064 6174 610a  S spectral data.
-000005c0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-000005d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000005e0: 2020 2078 6461 7461 3a20 206e 6461 7272     xdata:  ndarr
-000005f0: 6179 0a20 2020 2020 2020 2020 2020 2065  ay.            e
-00000600: 6e65 7267 7920 7661 6c75 6573 2069 6e20  nergy values in 
-00000610: 656c 6563 7472 6f6e 2d76 6f6c 7473 0a20  electron-volts. 
-00000620: 2020 2079 6461 7461 3a20 206e 6461 7272     ydata:  ndarr
-00000630: 6179 0a20 2020 2020 2020 2020 2020 2069  ay.            i
-00000640: 6e74 656e 7369 7479 2076 616c 7565 7320  ntensity values 
-00000650: 696e 2041 2e55 2e0a 2020 2020 7872 616e  in A.U..    xran
-00000660: 6765 3a20 6e64 6172 7261 790a 2020 2020  ge: ndarray.    
-00000670: 2020 2020 2020 2020 5374 6172 7469 6e67          Starting
-00000680: 2061 6e64 2073 746f 7070 696e 6720 656e   and stopping en
-00000690: 6572 6779 2076 616c 7565 730a 2020 2020  ergy values.    
-000006a0: 2020 2020 2020 2020 696e 2065 6c65 6374          in elect
-000006b0: 726f 6e20 766f 6c74 730a 0a20 2020 2052  ron volts..    R
-000006c0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-000006d0: 2d2d 0a20 2020 2066 6974 7465 643a 206e  --.    fitted: n
-000006e0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-000006f0: 2020 2042 6163 6b67 726f 756e 6420 6672     Background fr
-00000700: 6f6d 2074 6865 2072 6567 696f 6e20 6f66  om the region of
-00000710: 2078 6461 7461 0a20 2020 2070 6f77 6572   xdata.    power
-00000720: 3a20 2066 6c6f 6174 0a20 2020 2020 2020  :  float.       
-00000730: 2020 2020 2054 6865 2070 6f77 6572 2074       The power t
-00000740: 6572 6d0a 2020 2020 636f 6e73 743a 2020  erm.    const:  
-00000750: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-00000760: 2020 436f 6e73 7461 6e74 206f 6620 6d75    Constant of mu
-00000770: 6c74 6970 6c69 6361 7469 6f6e 0a0a 2020  ltiplication..  
-00000780: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00000790: 2d0a 2020 2020 5765 2066 6972 7374 2066  -.    We first f
-000007a0: 696e 6420 7468 6520 6172 7261 7920 7374  ind the array st
-000007b0: 6172 7420 616e 6420 7374 6f70 2070 6f69  art and stop poi
-000007c0: 6e74 730a 2020 2020 746f 2077 6869 6368  nts.    to which
-000007d0: 2074 6865 2070 6f77 6572 206c 6177 2077   the power law w
-000007e0: 696c 6c20 6265 2066 6974 7465 6420 746f  ill be fitted to
-000007f0: 2e20 4f6e 6365 0a20 2020 2064 6f6e 652c  . Once.    done,
-00000800: 2077 6520 7461 6b65 2074 6865 206c 6f67   we take the log
-00000810: 6172 6974 686d 206f 6620 626f 7468 2074  arithm of both t
-00000820: 6865 2069 6e74 656e 7369 7479 0a20 2020  he intensity.   
-00000830: 2076 616c 7565 7320 616e 6420 7468 6520   values and the 
-00000840: 656e 6572 6779 206c 6f73 7320 7661 6c75  energy loss valu
-00000850: 6573 2c20 7461 6b69 6e67 2063 6172 6520  es, taking care 
-00000860: 746f 0a20 2020 2074 6f20 6f6e 6c79 2074  to.    to only t
-00000870: 616b 6520 7468 6520 6c6f 6720 6f66 206e  ake the log of n
-00000880: 6f6e 2d6e 6567 6174 6976 6520 696e 7465  on-negative inte
-00000890: 6e73 6974 790a 2020 2020 7661 6c75 6573  nsity.    values
-000008a0: 2074 6f20 7072 6576 656e 7420 696d 6167   to prevent imag
-000008b0: 696e 6172 7920 6e75 6d62 6572 7320 6672  inary numbers fr
-000008c0: 6f6d 206f 6363 7572 696e 672e 0a20 2020  om occuring..   
-000008d0: 2057 6520 7468 656e 2064 6f20 6120 6c69   We then do a li
-000008e0: 6e65 6172 2070 6f6c 796e 6f6d 6961 6c20  near polynomial 
-000008f0: 6669 7420 696e 206e 756d 7079 2c20 616e  fit in numpy, an
-00000900: 640a 2020 2020 7265 7475 726e 2074 6865  d.    return the
-00000910: 2070 6f77 6572 206c 6177 2066 6974 7465   power law fitte
-00000920: 6420 6461 7461 2c20 706f 7765 7220 616e  d data, power an
-00000930: 6420 7468 650a 2020 2020 6d75 6c74 6970  d the.    multip
-00000940: 6c69 6361 7469 7665 2063 6f6e 7374 616e  licative constan
-00000950: 742e 2053 696e 6365 2074 6865 2066 6974  t. Since the fit
-00000960: 7469 6e67 2069 7320 646f 6e65 0a20 2020  ting is done.   
-00000970: 2069 6e20 6c6f 672d 6c6f 6720 7370 6163   in log-log spac
-00000980: 652c 2077 6520 6861 7665 2074 6f20 7461  e, we have to ta
-00000990: 6b65 2074 6865 2065 7870 6f6e 656e 7469  ke the exponenti
-000009a0: 616c 0a20 2020 206f 6620 7468 6520 696e  al.    of the in
-000009b0: 7465 7263 6570 7420 746f 2067 6574 2074  tercept to get t
-000009c0: 6865 206d 756c 7469 706c 6963 6174 6976  he multiplicativ
-000009d0: 6520 636f 6e73 7461 6e74 2e0a 0a20 2020  e constant...   
-000009e0: 203a 4175 7468 6f72 733a 0a20 2020 204a   :Authors:.    J
-000009f0: 6f72 6461 6e20 4861 6368 7465 6c20 3c68  ordan Hachtel <h
-00000a00: 6163 6874 656c 6a61 406f 726e 6c2e 676f  achtelja@ornl.go
-00000a10: 763e 0a0a 2020 2020 7201 0000 0072 0400  v>..    r....r..
-00000a20: 0000 2909 7208 0000 0072 1300 0000 da04  ..).r....r......
-00000a30: 616d 696e 7210 0000 00da 0464 6966 66da  aminr......diff.
-00000a40: 036c 6f67 da05 7768 6572 655a 0770 6f6c  .log..whereZ.pol
-00000a50: 7966 6974 da03 6578 7029 0ada 0578 6461  yfit..exp)...xda
-00000a60: 7461 da05 7964 6174 61da 0678 7261 6e67  ta..ydata..xrang
-00000a70: 65da 0973 7461 7274 5f76 616c da08 7374  e..start_val..st
-00000a80: 6f70 5f76 616c 5a04 786c 6f67 5a04 796c  op_valZ.xlogZ.yl
-00000a90: 6f67 da05 706f 7765 72da 0563 6f6e 7374  og..power..const
-00000aa0: 5a06 6669 7474 6564 720c 0000 0072 0c00  Z.fittedr....r..
-00000ab0: 0000 720d 0000 00da 0c70 6f77 6572 6c61  ..r......powerla
-00000ac0: 775f 6669 742c 0000 0073 1000 0000 0029  w_fit,...s.....)
-00000ad0: 2801 2801 2801 2801 1201 0a01 0c01 7226  (.(.(.(.......r&
-00000ae0: 0000 0054 7a0a 7361 6e73 2d73 6572 6966  ...Tz.sans-serif
-00000af0: 5a04 626f 6c64 e919 0000 0029 03da 0666  Z.bold.....)...f
-00000b00: 616d 696c 79da 0677 6569 6768 74da 0473  amily..weight..s
-00000b10: 697a 6563 0600 0000 0000 0000 0000 0000  izec............
-00000b20: 0c00 0000 0700 0000 4300 0000 7388 0100  ........C...s...
-00000b30: 0074 006a 0164 1e69 007c 05a4 018e 0101  .t.j.d.i.|......
-00000b40: 0064 0274 006a 0264 033c 0074 03a0 047c  .d.t.j.d.<.t...|
-00000b50: 02a1 017d 027c 0264 0419 0074 03a0 057c  ...}.|.d...t...|
-00000b60: 00a1 016b 0072 4474 03a0 057c 00a1 017c  ...k.rDt...|...|
-00000b70: 0264 043c 007c 0264 0519 0074 03a0 067c  .d.<.|.d...t...|
-00000b80: 00a1 016b 0472 6474 03a0 067c 00a1 017c  ...k.rdt...|...|
-00000b90: 0264 053c 0074 077c 007c 017c 0283 035c  .d.<.t.|.|.|...\
-00000ba0: 037d 067d 077d 087c 017c 0618 007d 097c  .}.}.}.|.|...}.|
-00000bb0: 087c 027c 0713 0014 007d 0a74 03a0 0874  .|.|.....}.t...t
-00000bc0: 03a0 097c 00a1 01a1 017d 0b7c 0490 0172  ...|.....}.|...r
-00000bd0: 8474 0a6a 0b64 0664 078d 0101 0074 0a6a  .t.j.d.d.....t.j
-00000be0: 0c7c 007c 0164 0864 0964 0a64 0b8d 0501  .|.|.d.d.d.d....
-00000bf0: 0074 0a6a 0c7c 007c 0664 0c64 0d64 0a64  .t.j.|.|.d.d.d.d
-00000c00: 0b8d 0501 0074 0a6a 0c7c 007c 0964 0e64  .....t.j.|.|.d.d
-00000c10: 0f64 0a64 0b8d 0501 0074 0a6a 0c7c 007c  .d.d.....t.j.|.|
-00000c20: 0b64 1064 1164 0a64 0b8d 0501 0074 0a6a  .d.d.d.d.....t.j
-00000c30: 0d7c 027c 0a64 1264 1364 1464 158d 0501  .|.|.d.d.d.d....
-00000c40: 0074 0a6a 0e64 1664 1764 188d 0201 0074  .t.j.d.d.d.....t
-00000c50: 0a6a 0f64 1f69 007c 05a4 018e 0101 0074  .j.d.i.|.......t
-00000c60: 0a6a 1064 2069 007c 05a4 018e 0101 0074  .j.d i.|.......t
-00000c70: 0aa0 1174 03a0 057c 00a1 0174 03a0 067c  ...t...|...t...|
-00000c80: 00a1 01a1 0201 0074 0aa0 1274 03a0 057c  .......t...t...|
-00000c90: 01a1 0164 1b18 0074 03a0 067c 01a1 0164  ...d...t...|...d
-00000ca0: 1b17 00a1 0201 0074 0a6a 137c 0364 1c64  .......t.j.|.d.d
-00000cb0: 1d8d 0201 007c 0653 0029 214e da04 666f  .....|.S.)!N..fo
-00000cc0: 6e74 e904 0000 007a 0e61 7865 732e 6c69  nt.....z.axes.li
-00000cd0: 6e65 7769 6474 6872 0100 0000 7204 0000  newidthr....r...
-00000ce0: 0029 02e9 2000 0000 e908 0000 00a9 015a  .).. ..........Z
-00000cf0: 0766 6967 7369 7a65 da01 63fa 0d4f 7269  .figsize..c..Ori
-00000d00: 6769 6e61 6c20 4461 7461 e903 0000 00a9  ginal Data......
-00000d10: 02da 056c 6162 656c 5a09 6c69 6e65 7769  ...labelZ.linewi
-00000d20: 6474 68da 016d 7a0d 506f 7765 7220 4c61  dth..mz.Power La
-00000d30: 7720 4669 74da 0167 5a07 5265 6d6e 616e  w Fit..gZ.Remnan
-00000d40: 74da 0172 fa09 5a65 726f 204c 696e 65da  t..r..Zero Line.
-00000d50: 0162 e9c8 0000 007a 0a46 6974 2052 6567  .b.....z.Fit Reg
-00000d60: 696f 6ea9 0372 3000 0000 da01 7372 3400  ion..r0.....sr4.
-00000d70: 0000 fa0b 7570 7065 7220 7269 6768 7446  ....upper rightF
-00000d80: 2902 da03 6c6f 635a 0766 7261 6d65 6f6e  )...locZ.frameon
-00000d90: fa10 456e 6572 6779 204c 6f73 7320 2865  ..Energy Loss (e
-00000da0: 5629 fa10 496e 7465 6e73 6974 7920 2841  V)..Intensity (A
-00000db0: 2e55 2e29 e9e8 0300 0069 9001 0000 2901  .U.).....i....).
-00000dc0: 5a03 6470 6929 0172 2b00 0000 2901 723f  Z.dpi).r+...).r?
-00000dd0: 0000 0029 0172 4000 0000 2914 da03 6d70  ...).r@...)...mp
-00000de0: 6cda 0272 635a 0872 6350 6172 616d 7372  l..rcZ.rcParamsr
-00000df0: 0800 0000 7211 0000 0072 1a00 0000 7209  ....r....r....r.
-00000e00: 0000 0072 2600 0000 7214 0000 0072 1200  ...r&...r....r..
-00000e10: 0000 da03 706c 74da 0666 6967 7572 65da  ....plt..figure.
-00000e20: 0470 6c6f 74da 0773 6361 7474 6572 da06  .plot..scatter..
-00000e30: 6c65 6765 6e64 da06 786c 6162 656c da06  legend..xlabel..
-00000e40: 796c 6162 656c da04 786c 696d da04 796c  ylabel..xlim..yl
-00000e50: 696d 5a07 7361 7665 6669 6729 0c72 1f00  imZ.savefig).r..
-00000e60: 0000 7220 0000 0072 2100 0000 5a08 6669  ..r ...r!...Z.fi
-00000e70: 6774 6974 6c65 da08 7368 6f77 6461 7461  gtitle..showdata
-00000e80: 722b 0000 00da 0b66 6974 7465 645f 6461  r+.....fitted_da
-00000e90: 7461 7224 0000 0072 2500 0000 da0f 7375  tar$...r%.....su
-00000ea0: 6274 7261 6374 6564 5f64 6174 61da 0679  btracted_data..y
-00000eb0: 7261 6e67 65da 097a 6572 6f5f 6c69 6e65  range..zero_line
-00000ec0: 720c 0000 0072 0c00 0000 720d 0000 00da  r....r....r.....
-00000ed0: 0d70 6f77 6572 6c61 775f 706c 6f74 5f00  .powerlaw_plot_.
-00000ee0: 0000 7332 0000 0000 0810 010a 010a 0112  ..s2............
-00000ef0: 010e 0112 010e 0112 0108 010c 0110 0106  ................
+00000230: 720c 0000 00fa 3862 7569 6c64 2f62 6469  r.....8build/bdi
+00000240: 7374 2e6c 696e 7578 2d78 3836 5f36 342f  st.linux-x86_64/
+00000250: 6567 672f 7374 656d 746f 6f6c 2f65 656c  egg/stemtool/eel
+00000260: 732f 6565 6c73 5f74 6f6f 6c73 2e70 79da  s/eels_tools.py.
+00000270: 1163 6c65 616e 4545 4c53 5f77 6176 656c  .cleanEELS_wavel
+00000280: 6574 0a00 0000 7312 0000 000a 0112 0110  et....s.........
+00000290: 0104 0104 0112 0124 010c 0104 0172 0e00  .......$.....r..
+000002a0: 0000 6303 0000 0000 0000 0000 0000 0007  ..c.............
+000002b0: 0000 0008 0000 0043 0000 0073 e800 0000  .......C...s....
+000002c0: 7400 a001 7400 a002 7c00 a101 a101 a003  t...t...|.......
+000002d0: 7404 a101 7d03 7400 a005 7c03 a101 7d04  t...}.t...|...}.
+000002e0: 7c01 6401 6b02 7240 7c02 6402 6b04 723e  |.d.k.r@|.d.k.r>
+000002f0: 7406 7c03 6403 1900 8301 4400 5d1e 7d05  t.|.d.....D.].}.
+00000300: 7406 7c03 6404 1900 8301 4400 5d15 7d06  t.|.d.....D.].}.
+00000310: 7407 7c00 6400 6400 8502 7c06 7c05 6603  t.|.d.d...|.|.f.
+00000320: 1900 7c02 8302 7c04 6400 6400 8502 7c06  ..|...|.d.d...|.
+00000330: 7c05 6603 3c00 7126 711e 6e02 7c00 7d04  |.f.<.q&q.n.|.}.
+00000340: 7c01 6405 6b02 7272 7c02 6402 6b04 7270  |.d.k.rr|.d.k.rp
+00000350: 7406 7c03 6403 1900 8301 4400 5d1f 7d05  t.|.d.....D.].}.
+00000360: 7406 7c03 6404 1900 8301 4400 5d16 7d06  t.|.d.....D.].}.
+00000370: 7408 a009 7c00 6400 6400 8502 7c06 7c05  t...|.d.d...|.|.
+00000380: 6603 1900 7c02 a102 7c04 6400 6400 8502  f...|...|.d.d...
+00000390: 7c06 7c05 6603 3c00 7156 714e 7c04 5300  |.|.f.<.qVqN|.S.
+000003a0: 7c00 7d04 7c04 5300 2906 4e5a 0777 6176  |.}.|.S.).NZ.wav
+000003b0: 656c 6574 7201 0000 00e9 0200 0000 7204  eletr.........r.
+000003c0: 0000 00da 066d 6564 6961 6e29 0a72 0800  .....median).r..
+000003d0: 0000 da07 6173 6172 7261 79da 0573 6861  ....asarray..sha
+000003e0: 7065 5a06 6173 7479 7065 da03 696e 74da  peZ.astype..int.
+000003f0: 057a 6572 6f73 da05 7261 6e67 6572 0e00  .zeros..ranger..
+00000400: 0000 da06 7363 6973 6967 5a07 6d65 6466  ....scisigZ.medf
+00000410: 696c 7429 075a 0664 6174 6133 44da 066d  ilt).Z.data3D..m
+00000420: 6574 686f 6472 0700 0000 5a0a 6461 7461  ethodr....Z.data
+00000430: 5f73 6861 7065 5a0a 636c 6561 6e65 645f  _shapeZ.cleaned_
+00000440: 3344 720b 0000 00da 026a 6a72 0c00 0000  3Dr......jjr....
+00000450: 720c 0000 0072 0d00 0000 da0c 636c 6561  r....r......clea
+00000460: 6e45 454c 535f 3344 1600 0000 732a 0000  nEELS_3D....s*..
+00000470: 0016 010a 0108 0108 0110 0110 0102 0112  ................
+00000480: 0114 ff02 ff02 ff04 0608 0108 0110 0110  ................
+00000490: 012a 0102 ff04 0404 ff04 0172 1900 0000  .*.........r....
+000004a0: 6303 0000 0000 0000 0000 0000 000a 0000  c...............
+000004b0: 0008 0000 0043 0000 0073 d200 0000 7400  .....C...s....t.
+000004c0: a001 7c02 6401 1900 7400 a002 7c00 a101  ..|.d...t...|...
+000004d0: 1800 7400 a003 7400 a004 7c00 a101 a101  ..t...t...|.....
+000004e0: 1b00 a101 7d03 7400 a001 7c02 6402 1900  ....}.t...|.d...
+000004f0: 7400 a002 7c00 a101 1800 7400 a003 7400  t...|.....t...t.
+00000500: a004 7c00 a101 a101 1b00 a101 7d04 7400  ..|.........}.t.
+00000510: a005 7c00 7c03 7c04 8502 1900 7400 a006  ..|.|.|.....t...
+00000520: 7c01 7c03 7c04 8502 1900 6401 6b04 a101  |.|.|.....d.k...
+00000530: 1900 a101 7d05 7400 a005 7c01 7c03 7c04  ....}.t...|.|.|.
+00000540: 8502 1900 7400 a006 7c01 7c03 7c04 8502  ....t...|.|.|...
+00000550: 1900 6401 6b04 a101 1900 a101 7d06 7400  ..d.k.......}.t.
+00000560: a007 7c05 7c06 6402 a103 5c02 7d07 7d08  ..|.|.d...\.}.}.
+00000570: 7400 a008 7c08 a101 7d08 7c08 7c00 7c07  t...|...}.|.|.|.
+00000580: 1300 1400 7d09 7c09 7c07 7c08 6603 5300  ....}.|.|.|.f.S.
+00000590: 2903 6185 0400 000a 2020 2020 506f 7765  ).a.....    Powe
+000005a0: 7220 4c61 7720 4669 6974 696e 6720 6f66  r Law Fiiting of
+000005b0: 2045 454c 5320 7370 6563 7472 616c 2064   EELS spectral d
+000005c0: 6174 610a 0a20 2020 2050 6172 616d 6574  ata..    Paramet
+000005d0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+000005e0: 2d2d 0a20 2020 2078 6461 7461 3a20 206e  --.    xdata:  n
+000005f0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00000600: 2020 2065 6e65 7267 7920 7661 6c75 6573     energy values
+00000610: 2069 6e20 656c 6563 7472 6f6e 2d76 6f6c   in electron-vol
+00000620: 7473 0a20 2020 2079 6461 7461 3a20 206e  ts.    ydata:  n
+00000630: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00000640: 2020 2069 6e74 656e 7369 7479 2076 616c     intensity val
+00000650: 7565 7320 696e 2041 2e55 2e0a 2020 2020  ues in A.U..    
+00000660: 7872 616e 6765 3a20 6e64 6172 7261 790a  xrange: ndarray.
+00000670: 2020 2020 2020 2020 2020 2020 5374 6172              Star
+00000680: 7469 6e67 2061 6e64 2073 746f 7070 696e  ting and stoppin
+00000690: 6720 656e 6572 6779 2076 616c 7565 730a  g energy values.
+000006a0: 2020 2020 2020 2020 2020 2020 696e 2065              in e
+000006b0: 6c65 6374 726f 6e20 766f 6c74 730a 0a20  lectron volts.. 
+000006c0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+000006d0: 2d2d 2d2d 2d2d 0a20 2020 2066 6974 7465  ------.    fitte
+000006e0: 643a 206e 6461 7272 6179 0a20 2020 2020  d: ndarray.     
+000006f0: 2020 2020 2020 2042 6163 6b67 726f 756e         Backgroun
+00000700: 6420 6672 6f6d 2074 6865 2072 6567 696f  d from the regio
+00000710: 6e20 6f66 2078 6461 7461 0a20 2020 2070  n of xdata.    p
+00000720: 6f77 6572 3a20 2066 6c6f 6174 0a20 2020  ower:  float.   
+00000730: 2020 2020 2020 2020 2054 6865 2070 6f77           The pow
+00000740: 6572 2074 6572 6d0a 2020 2020 636f 6e73  er term.    cons
+00000750: 743a 2020 666c 6f61 740a 2020 2020 2020  t:  float.      
+00000760: 2020 2020 2020 436f 6e73 7461 6e74 206f        Constant o
+00000770: 6620 6d75 6c74 6970 6c69 6361 7469 6f6e  f multiplication
+00000780: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
+00000790: 2d2d 2d2d 2d0a 2020 2020 5765 2066 6972  -----.    We fir
+000007a0: 7374 2066 696e 6420 7468 6520 6172 7261  st find the arra
+000007b0: 7920 7374 6172 7420 616e 6420 7374 6f70  y start and stop
+000007c0: 2070 6f69 6e74 730a 2020 2020 746f 2077   points.    to w
+000007d0: 6869 6368 2074 6865 2070 6f77 6572 206c  hich the power l
+000007e0: 6177 2077 696c 6c20 6265 2066 6974 7465  aw will be fitte
+000007f0: 6420 746f 2e20 4f6e 6365 0a20 2020 2064  d to. Once.    d
+00000800: 6f6e 652c 2077 6520 7461 6b65 2074 6865  one, we take the
+00000810: 206c 6f67 6172 6974 686d 206f 6620 626f   logarithm of bo
+00000820: 7468 2074 6865 2069 6e74 656e 7369 7479  th the intensity
+00000830: 0a20 2020 2076 616c 7565 7320 616e 6420  .    values and 
+00000840: 7468 6520 656e 6572 6779 206c 6f73 7320  the energy loss 
+00000850: 7661 6c75 6573 2c20 7461 6b69 6e67 2063  values, taking c
+00000860: 6172 6520 746f 0a20 2020 2074 6f20 6f6e  are to.    to on
+00000870: 6c79 2074 616b 6520 7468 6520 6c6f 6720  ly take the log 
+00000880: 6f66 206e 6f6e 2d6e 6567 6174 6976 6520  of non-negative 
+00000890: 696e 7465 6e73 6974 790a 2020 2020 7661  intensity.    va
+000008a0: 6c75 6573 2074 6f20 7072 6576 656e 7420  lues to prevent 
+000008b0: 696d 6167 696e 6172 7920 6e75 6d62 6572  imaginary number
+000008c0: 7320 6672 6f6d 206f 6363 7572 696e 672e  s from occuring.
+000008d0: 0a20 2020 2057 6520 7468 656e 2064 6f20  .    We then do 
+000008e0: 6120 6c69 6e65 6172 2070 6f6c 796e 6f6d  a linear polynom
+000008f0: 6961 6c20 6669 7420 696e 206e 756d 7079  ial fit in numpy
+00000900: 2c20 616e 640a 2020 2020 7265 7475 726e  , and.    return
+00000910: 2074 6865 2070 6f77 6572 206c 6177 2066   the power law f
+00000920: 6974 7465 6420 6461 7461 2c20 706f 7765  itted data, powe
+00000930: 7220 616e 6420 7468 650a 2020 2020 6d75  r and the.    mu
+00000940: 6c74 6970 6c69 6361 7469 7665 2063 6f6e  ltiplicative con
+00000950: 7374 616e 742e 2053 696e 6365 2074 6865  stant. Since the
+00000960: 2066 6974 7469 6e67 2069 7320 646f 6e65   fitting is done
+00000970: 0a20 2020 2069 6e20 6c6f 672d 6c6f 6720  .    in log-log 
+00000980: 7370 6163 652c 2077 6520 6861 7665 2074  space, we have t
+00000990: 6f20 7461 6b65 2074 6865 2065 7870 6f6e  o take the expon
+000009a0: 656e 7469 616c 0a20 2020 206f 6620 7468  ential.    of th
+000009b0: 6520 696e 7465 7263 6570 7420 746f 2067  e intercept to g
+000009c0: 6574 2074 6865 206d 756c 7469 706c 6963  et the multiplic
+000009d0: 6174 6976 6520 636f 6e73 7461 6e74 2e0a  ative constant..
+000009e0: 0a20 2020 203a 4175 7468 6f72 733a 0a20  .    :Authors:. 
+000009f0: 2020 204a 6f72 6461 6e20 4861 6368 7465     Jordan Hachte
+00000a00: 6c20 3c68 6163 6874 656c 6a61 406f 726e  l <hachtelja@orn
+00000a10: 6c2e 676f 763e 0a0a 2020 2020 7201 0000  l.gov>..    r...
+00000a20: 0072 0400 0000 2909 7208 0000 0072 1300  .r....).r....r..
+00000a30: 0000 da04 616d 696e 7210 0000 00da 0464  ....aminr......d
+00000a40: 6966 66da 036c 6f67 da05 7768 6572 655a  iff..log..whereZ
+00000a50: 0770 6f6c 7966 6974 da03 6578 7029 0ada  .polyfit..exp)..
+00000a60: 0578 6461 7461 da05 7964 6174 61da 0678  .xdata..ydata..x
+00000a70: 7261 6e67 65da 0973 7461 7274 5f76 616c  range..start_val
+00000a80: da08 7374 6f70 5f76 616c 5a04 786c 6f67  ..stop_valZ.xlog
+00000a90: 5a04 796c 6f67 da05 706f 7765 72da 0563  Z.ylog..power..c
+00000aa0: 6f6e 7374 5a06 6669 7474 6564 720c 0000  onstZ.fittedr...
+00000ab0: 0072 0c00 0000 720d 0000 00da 0c70 6f77  .r....r......pow
+00000ac0: 6572 6c61 775f 6669 742c 0000 0073 1000  erlaw_fit,...s..
+00000ad0: 0000 2829 2801 2801 2801 1201 0a01 0c01  ..()(.(.(.......
+00000ae0: 0a01 7226 0000 0054 7a0a 7361 6e73 2d73  ..r&...Tz.sans-s
+00000af0: 6572 6966 5a04 626f 6c64 e919 0000 0029  erifZ.bold.....)
+00000b00: 03da 0666 616d 696c 79da 0677 6569 6768  ...family..weigh
+00000b10: 74da 0473 697a 6563 0600 0000 0000 0000  t..sizec........
+00000b20: 0000 0000 0c00 0000 0700 0000 4300 0000  ............C...
+00000b30: 7386 0100 0074 006a 0164 1e69 007c 05a4  s....t.j.d.i.|..
+00000b40: 018e 0101 0064 0274 006a 0264 033c 0074  .....d.t.j.d.<.t
+00000b50: 03a0 047c 02a1 017d 027c 0264 0419 0074  ...|...}.|.d...t
+00000b60: 03a0 057c 00a1 016b 0072 2274 03a0 057c  ...|...k.r"t...|
+00000b70: 00a1 017c 0264 043c 007c 0264 0519 0074  ...|.d.<.|.d...t
+00000b80: 03a0 067c 00a1 016b 0472 3274 03a0 067c  ...|...k.r2t...|
+00000b90: 00a1 017c 0264 053c 0074 077c 007c 017c  ...|.d.<.t.|.|.|
+00000ba0: 0283 035c 037d 067d 077d 087c 017c 0618  ...\.}.}.}.|.|..
+00000bb0: 007d 097c 087c 027c 0713 0014 007d 0a74  .}.|.|.|.....}.t
+00000bc0: 03a0 0874 03a0 097c 00a1 01a1 017d 0b7c  ...t...|.....}.|
+00000bd0: 0472 c174 0a6a 0b64 0664 078d 0101 0074  .r.t.j.d.d.....t
+00000be0: 0a6a 0c7c 007c 0164 0864 0964 0a64 0b8d  .j.|.|.d.d.d.d..
+00000bf0: 0501 0074 0a6a 0c7c 007c 0664 0c64 0d64  ...t.j.|.|.d.d.d
+00000c00: 0a64 0b8d 0501 0074 0a6a 0c7c 007c 0964  .d.....t.j.|.|.d
+00000c10: 0e64 0f64 0a64 0b8d 0501 0074 0a6a 0c7c  .d.d.d.....t.j.|
+00000c20: 007c 0b64 1064 1164 0a64 0b8d 0501 0074  .|.d.d.d.d.....t
+00000c30: 0a6a 0d7c 027c 0a64 1264 1364 1464 158d  .j.|.|.d.d.d.d..
+00000c40: 0501 0074 0a6a 0e64 1664 1764 188d 0201  ...t.j.d.d.d....
+00000c50: 0074 0a6a 0f64 1f69 007c 05a4 018e 0101  .t.j.d.i.|......
+00000c60: 0074 0a6a 1064 2069 007c 05a4 018e 0101  .t.j.d i.|......
+00000c70: 0074 0aa0 1174 03a0 057c 00a1 0174 03a0  .t...t...|...t..
+00000c80: 067c 00a1 01a1 0201 0074 0aa0 1274 03a0  .|.......t...t..
+00000c90: 057c 01a1 0164 1b18 0074 03a0 067c 01a1  .|...d...t...|..
+00000ca0: 0164 1b17 00a1 0201 0074 0a6a 137c 0364  .d.......t.j.|.d
+00000cb0: 1c64 1d8d 0201 007c 0653 0029 214e da04  .d.....|.S.)!N..
+00000cc0: 666f 6e74 e904 0000 007a 0e61 7865 732e  font.....z.axes.
+00000cd0: 6c69 6e65 7769 6474 6872 0100 0000 7204  linewidthr....r.
+00000ce0: 0000 0029 02e9 2000 0000 e908 0000 00a9  ...).. .........
+00000cf0: 015a 0766 6967 7369 7a65 da01 63fa 0d4f  .Z.figsize..c..O
+00000d00: 7269 6769 6e61 6c20 4461 7461 e903 0000  riginal Data....
+00000d10: 00a9 02da 056c 6162 656c 5a09 6c69 6e65  .....labelZ.line
+00000d20: 7769 6474 68da 016d 7a0d 506f 7765 7220  width..mz.Power 
+00000d30: 4c61 7720 4669 74da 0167 5a07 5265 6d6e  Law Fit..gZ.Remn
+00000d40: 616e 74da 0172 fa09 5a65 726f 204c 696e  ant..r..Zero Lin
+00000d50: 65da 0162 e9c8 0000 007a 0a46 6974 2052  e..b.....z.Fit R
+00000d60: 6567 696f 6ea9 0372 3000 0000 da01 7372  egion..r0.....sr
+00000d70: 3400 0000 fa0b 7570 7065 7220 7269 6768  4.....upper righ
+00000d80: 7446 2902 da03 6c6f 635a 0766 7261 6d65  tF)...locZ.frame
+00000d90: 6f6e fa10 456e 6572 6779 204c 6f73 7320  on..Energy Loss 
+00000da0: 2865 5629 fa10 496e 7465 6e73 6974 7920  (eV)..Intensity 
+00000db0: 2841 2e55 2e29 e9e8 0300 0069 9001 0000  (A.U.).....i....
+00000dc0: 2901 5a03 6470 6929 0172 2b00 0000 2901  ).Z.dpi).r+...).
+00000dd0: 723f 0000 0029 0172 4000 0000 2914 da03  r?...).r@...)...
+00000de0: 6d70 6cda 0272 635a 0872 6350 6172 616d  mpl..rcZ.rcParam
+00000df0: 7372 0800 0000 7211 0000 0072 1a00 0000  sr....r....r....
+00000e00: 7209 0000 0072 2600 0000 7214 0000 0072  r....r&...r....r
+00000e10: 1200 0000 da03 706c 74da 0666 6967 7572  ......plt..figur
+00000e20: 65da 0470 6c6f 74da 0773 6361 7474 6572  e..plot..scatter
+00000e30: da06 6c65 6765 6e64 da06 786c 6162 656c  ..legend..xlabel
+00000e40: da06 796c 6162 656c da04 786c 696d da04  ..ylabel..xlim..
+00000e50: 796c 696d 5a07 7361 7665 6669 6729 0c72  ylimZ.savefig).r
+00000e60: 1f00 0000 7220 0000 0072 2100 0000 5a08  ....r ...r!...Z.
+00000e70: 6669 6774 6974 6c65 da08 7368 6f77 6461  figtitle..showda
+00000e80: 7461 722b 0000 00da 0b66 6974 7465 645f  tar+.....fitted_
+00000e90: 6461 7461 7224 0000 0072 2500 0000 da0f  datar$...r%.....
+00000ea0: 7375 6274 7261 6374 6564 5f64 6174 61da  subtracted_data.
+00000eb0: 0679 7261 6e67 65da 097a 6572 6f5f 6c69  .yrange..zero_li
+00000ec0: 6e65 720c 0000 0072 0c00 0000 720d 0000  ner....r....r...
+00000ed0: 00da 0d70 6f77 6572 6c61 775f 706c 6f74  ...powerlaw_plot
+00000ee0: 5f00 0000 7332 0000 0010 080a 010a 0112  _...s2..........
+00000ef0: 010e 0112 010e 0112 0108 010c 0110 0104  ................
 00000f00: 010c 0114 0114 0114 0114 0114 010e 0110  ................
-00000f10: 0110 0118 0120 010e 0172 5200 0000 6305  ..... ...rR...c.
-00000f20: 0000 0000 0000 0000 0000 000e 0000 0008  ................
-00000f30: 0000 0043 0000 0073 9201 0000 7400 7c00  ...C...s....t.|.
-00000f40: 7c01 7c02 8303 5c03 7d05 7d06 7d06 7c01  |.|...\.}.}.}.|.
-00000f50: 7c05 1800 7d07 7401 a002 7c03 6401 1900  |...}.t...|.d...
-00000f60: 7401 a003 7c00 a101 1800 7401 a004 7401  t...|.....t...t.
-00000f70: a005 7c00 a101 a101 1b00 a101 7d08 7401  ..|.........}.t.
-00000f80: a002 7c03 6402 1900 7401 a003 7c00 a101  ..|.d...t...|...
-00000f90: 1800 7401 a004 7401 a005 7c00 a101 a101  ..t...t...|.....
-00000fa0: 1b00 a101 7d09 7401 a003 7c07 7c08 7c09  ....}.t...|.|.|.
-00000fb0: 8502 1900 a101 7d0a 7401 a006 7c07 7c08  ......}.t...|.|.
-00000fc0: 7c09 8502 1900 7c0a 1800 a101 7d0b 7401  |.....|.....}.t.
-00000fd0: a007 7c03 a101 7d0c 7c07 7c08 1900 7c0c  ..|...}.|.|...|.
-00000fe0: 6401 3c00 7c07 7c09 1900 7c0c 6402 3c00  d.<.|.|...|.d.<.
-00000ff0: 7401 a008 7401 a009 7c00 a101 a101 7d0d  t...t...|.....}.
-00001000: 7c04 9001 728e 740a 6a0b 6403 6404 8d01  |...r.t.j.d.d...
+00000f10: 0110 0118 0120 010e 0104 0172 5200 0000  ..... .....rR...
+00000f20: 6305 0000 0000 0000 0000 0000 000e 0000  c...............
+00000f30: 0008 0000 0043 0000 0073 9001 0000 7400  .....C...s....t.
+00000f40: 7c00 7c01 7c02 8303 5c03 7d05 7d06 7d06  |.|.|...\.}.}.}.
+00000f50: 7c01 7c05 1800 7d07 7401 a002 7c03 6401  |.|...}.t...|.d.
+00000f60: 1900 7401 a003 7c00 a101 1800 7401 a004  ..t...|.....t...
+00000f70: 7401 a005 7c00 a101 a101 1b00 a101 7d08  t...|.........}.
+00000f80: 7401 a002 7c03 6402 1900 7401 a003 7c00  t...|.d...t...|.
+00000f90: a101 1800 7401 a004 7401 a005 7c00 a101  ....t...t...|...
+00000fa0: a101 1b00 a101 7d09 7401 a003 7c07 7c08  ......}.t...|.|.
+00000fb0: 7c09 8502 1900 a101 7d0a 7401 a006 7c07  |.......}.t...|.
+00000fc0: 7c08 7c09 8502 1900 7c0a 1800 a101 7d0b  |.|.....|.....}.
+00000fd0: 7401 a007 7c03 a101 7d0c 7c07 7c08 1900  t...|...}.|.|...
+00000fe0: 7c0c 6401 3c00 7c07 7c09 1900 7c0c 6402  |.d.<.|.|...|.d.
+00000ff0: 3c00 7401 a008 7401 a009 7c00 a101 a101  <.t...t...|.....
+00001000: 7d0d 7c04 72c6 740a 6a0b 6403 6404 8d01  }.|.r.t.j.d.d...
 00001010: 0100 740a 6a0c 7c00 7c01 6405 6406 6407  ..t.j.|.|.d.d.d.
 00001020: 6408 8d05 0100 740a 6a0c 7c00 7c07 6409  d.....t.j.|.|.d.
 00001030: 640a 6407 6408 8d05 0100 740a 6a0c 7c00  d.d.d.....t.j.|.
 00001040: 7c0d 640b 640c 640d 6408 8d05 0100 740a  |.d.d.d.d.....t.
 00001050: 6a0d 7c03 7c0c 640e 640f 6410 6411 8d05  j.|.|.d.d.d.d...
 00001060: 0100 740a 6a0e 6412 6413 8d01 0100 740a  ..t.j.d.d.....t.
 00001070: a00f 6414 a101 0100 740a a010 6415 a101  ..d.....t...d...
@@ -289,232 +289,231 @@
 00001200: 0072 2000 0000 7221 0000 00da 0a70 6561  .r ...r!.....pea
 00001210: 6b5f 7261 6e67 6572 4d00 0000 724e 0000  k_rangerM...rN..
 00001220: 00da 015f 724f 0000 0072 2200 0000 7223  ..._rO...r"...r#
 00001230: 0000 005a 0a64 6174 615f 666c 6f6f 72da  ...Z.data_floor.
 00001240: 0870 6561 6b5f 7375 6d72 5000 0000 7251  .peak_sumrP...rQ
 00001250: 0000 0072 0c00 0000 720c 0000 0072 0d00  ...r....r....r..
 00001260: 0000 da10 7265 6769 6f6e 5f69 6e74 656e  ....region_inten
-00001270: 7369 7479 8200 0000 733a 0000 0000 0112  sity....s:......
-00001280: 0108 0128 0128 0112 0116 010a 010c 010c  ...(.(..........
-00001290: 0110 0106 010c 0114 0104 0102 0102 0102  ................
-000012a0: 0102 0102 fb06 0714 0114 010c 010a 010a  ................
-000012b0: 0110 0118 0120 0172 5b00 0000 7232 0000  ..... .r[...r2..
+00001270: 7369 7479 8200 0000 733a 0000 0012 0108  sity....s:......
+00001280: 0128 0128 0112 0116 010a 010c 010c 0110  .(.(............
+00001290: 0104 010c 0114 0104 0102 0102 0102 0102  ................
+000012a0: 0102 0106 fb14 0714 010c 010a 010a 0110  ................
+000012b0: 0118 0120 0104 0172 5b00 0000 7232 0000  ... ...r[...r2..
 000012c0: 0063 0400 0000 0000 0000 0000 0000 1900  .c..............
-000012d0: 0000 0b00 0000 4300 0000 730c 0200 0074  ......C...s....t
+000012d0: 0000 0b00 0000 4300 0000 7306 0200 0074  ......C...s....t
 000012e0: 00a0 017c 01a1 017d 0174 00a0 017c 02a1  ...|...}.t...|..
 000012f0: 017d 0274 027c 0283 017d 047c 0064 0119  .}.t.|...}.|.d..
 00001300: 007d 0574 006a 037c 056a 0464 0219 007c  .}.t.j.|.j.d...|
 00001310: 056a 0464 0319 007c 056a 0464 0419 007c  .j.d...|.j.d...|
 00001320: 0466 0474 006a 0564 058d 027d 0674 006a  .f.t.j.d...}.t.j
 00001330: 0664 027c 056a 0464 0319 0085 0264 027c  .d.|.j.d.....d.|
 00001340: 056a 0464 0419 0085 0266 0219 005c 027d  .j.d.....f...\.}
 00001350: 077d 0874 00a0 077c 056a 0464 0219 00a1  .}.t...|.j.d....
 00001360: 017c 0064 0619 0064 0219 0018 007c 0064  .|.d...d.....|.d
 00001370: 0719 0064 0219 0014 007d 0974 006a 037c  ...d.....}.t.j.|
 00001380: 056a 0464 0819 007c 056a 0464 0919 007c  .j.d...|.j.d...|
 00001390: 0466 0374 006a 0564 058d 027d 0a74 087c  .f.t.j.d...}.t.|
-000013a0: 056a 0464 0819 0083 0144 0090 015d 347d  .j.d.....D...]4}
-000013b0: 0b74 087c 056a 0464 0919 0083 0144 0090  .t.|.j.d.....D..
-000013c0: 015d 1e7d 0c74 087c 0483 0144 0090 015d  .].}.t.|...D...]
-000013d0: 0e7d 0d7c 0564 0064 0085 027c 0b7c 0c66  .}.|.d.d...|.|.f
-000013e0: 0319 007d 0e7c 017c 0d64 0064 0085 0266  ...}.|.|.d.d...f
-000013f0: 0219 007d 0f7c 027c 0d64 0064 0085 0266  ...}.|.|.d.d...f
-00001400: 0219 007d 107c 077c 0b18 0064 0413 007c  ...}.|.|...d...|
-00001410: 087c 0c18 0064 0413 0017 007c 0364 0413  .|...d.....|.d..
-00001420: 006b 017d 1174 006a 097c 0564 0064 0085  .k.}.t.j.|.d.d..
-00001430: 027c 1166 0219 0064 0964 0a8d 027d 1274  .|.f...d.d...}.t
-00001440: 0a7c 097c 127c 0f83 035c 037d 137d 147d  .|.|.|...\.}.}.}
-00001450: 147c 0e7c 1318 007d 157c 157c 0664 0064  .|.|...}.|.|.d.d
-00001460: 0085 027c 0b7c 0c7c 0d66 043c 0074 00a0  ...|.|.|.f.<.t..
-00001470: 0b7c 1064 0219 0074 00a0 0c7c 09a1 0118  .|.d...t...|....
-00001480: 0074 00a0 0d74 00a0 0e7c 09a1 01a1 011b  .t...t...|......
-00001490: 00a1 017d 1674 00a0 0b7c 1064 0319 0074  ...}.t...|.d...t
-000014a0: 00a0 0c7c 09a1 0118 0074 00a0 0d74 00a0  ...|.....t...t..
-000014b0: 0e7c 09a1 01a1 011b 00a1 017d 1774 00a0  .|.........}.t..
-000014c0: 0f7c 157c 167c 1785 0219 00a1 017d 187c  .|.|.|.......}.|
-000014d0: 187c 0a7c 0b7c 0c7c 0d66 033c 0071 ee71  .|.|.|.|.f.<.q.q
-000014e0: e071 cc7c 0a7c 0666 0253 0029 0b4e 720a  .q.|.|.f.S.).Nr.
-000014f0: 0000 0072 0100 0000 7204 0000 0072 0f00  ...r....r....r..
-00001500: 0000 a901 5a05 6474 7970 65da 0b70 6978  ....Z.dtype..pix
-00001510: 656c 4f72 6967 696e da09 7069 7865 6c53  elOrigin..pixelS
-00001520: 697a 65e9 feff ffff e9ff ffff ffa9 015a  ize............Z
-00001530: 0461 7869 7329 1072 0800 0000 7211 0000  .axis).r....r...
-00001540: 0072 0600 0000 7214 0000 0072 1200 0000  .r....r....r....
-00001550: 5a07 666c 6f61 7436 34da 056d 6772 6964  Z.float64..mgrid
-00001560: da06 6172 616e 6765 7215 0000 00da 046d  ..aranger......m
-00001570: 6561 6e72 2600 0000 7213 0000 0072 1a00  eanr&...r....r..
-00001580: 0000 7210 0000 0072 1b00 0000 7255 0000  ..r....r....rU..
-00001590: 0029 19da 0965 656c 735f 6469 6374 da09  .)...eels_dict..
-000015a0: 6669 745f 7261 6e67 6572 5800 0000 da0a  fit_rangerX.....
-000015b0: 4c42 415f 7261 6469 7573 da0b 6e6f 5f65  LBA_radius..no_e
-000015c0: 6c65 6d65 6e74 73da 0a65 656c 735f 6172  lements..eels_ar
-000015d0: 7261 79da 1465 6c65 6d65 6e74 616c 5f73  ray..elemental_s
-000015e0: 7562 7472 6163 7465 64da 0279 79da 0278  ubtracted..yy..x
-000015f0: 7872 1f00 0000 da0b 7065 616b 5f76 616c  xr......peak_val
-00001600: 7565 7372 0b00 0000 7218 0000 00da 0271  uesr....r......q
-00001610: 71da 0965 656c 735f 6461 7461 da0a 6669  q..eels_data..fi
-00001620: 745f 706f 696e 7473 da0a 7065 616b 5f70  t_points..peak_p
-00001630: 6f69 6e74 da03 6c62 69da 0865 656c 735f  oint..lbi..eels_
-00001640: 6c62 69da 0262 6772 5900 0000 724f 0000  lbi..bgrY...rO..
-00001650: 0072 2200 0000 7223 0000 0072 5a00 0000  .r"...r#...rZ...
-00001660: 720c 0000 0072 0c00 0000 720d 0000 00da  r....r....r.....
-00001670: 0765 656c 735f 3344 a200 0000 734a 0000  .eels_3D....sJ..
-00001680: 0000 010a 010a 0108 0108 0104 011c 0104  ................
-00001690: fe06 0426 011c 0102 ff02 0202 fe06 0304  ...&............
-000016a0: 0118 ff06 0314 0114 010e 0112 0110 0110  ................
-000016b0: 0120 011a 0112 0108 0114 0104 0120 ff04  . ........... ..
-000016c0: 0304 0120 ff04 0312 0114 0172 7500 0000  ... .......ru...
-000016d0: 6305 0000 0000 0000 0000 0000 0006 0000  c...............
-000016e0: 0004 0000 0043 0000 0073 1c00 0000 7c01  .....C...s....|.
-000016f0: 7c00 7c02 1300 1400 7c03 7c00 7c04 1300  |.|.....|.|.|...
-00001700: 1400 1700 7d05 7c05 5300 2901 4e72 0c00  ....}.|.S.).Nr..
-00001710: 0000 2906 726c 0000 005a 0263 31da 0270  ..).rl...Z.c1..p
-00001720: 315a 0263 32da 0270 3272 6b00 0000 720c  1Z.c2..p2rk...r.
-00001730: 0000 0072 0c00 0000 720d 0000 00da 046c  ...r....r......l
-00001740: 6370 6cc8 0000 0073 0400 0000 0001 1801  cpl....s........
-00001750: 7278 0000 00e9 0500 0000 6305 0000 0000  rx........c.....
-00001760: 0000 0000 0000 0028 0000 000b 0000 0043  .......(.......C
-00001770: 0000 0073 0005 0000 7400 a001 7c01 a101  ...s....t...|...
-00001780: 7d01 7400 a001 7c02 a101 7d02 7402 7c02  }.t...|...}.t.|.
-00001790: 8301 7d05 7c00 6401 1900 7d06 7400 6a03  ..}.|.d...}.t.j.
-000017a0: 7c06 6a04 6402 1900 7c06 6a04 6403 1900  |.j.d...|.j.d...
-000017b0: 7c06 6a04 6404 1900 7c05 6604 7400 6a05  |.j.d...|.f.t.j.
-000017c0: 6405 8d02 7d07 7400 6a06 6402 7c06 6a04  d...}.t.j.d.|.j.
-000017d0: 6403 1900 8502 6402 7c06 6a04 6404 1900  d.....d.|.j.d...
-000017e0: 8502 6602 1900 5c02 7d08 7d09 7400 a007  ..f...\.}.}.t...
-000017f0: 7c06 6a04 6402 1900 a101 7c00 6406 1900  |.j.d.....|.d...
-00001800: 6402 1900 1800 7c00 6407 1900 6402 1900  d.....|.d...d...
-00001810: 1400 7d0a 7400 6a03 7c06 6a04 6408 1900  ..}.t.j.|.j.d...
-00001820: 7c06 6a04 6409 1900 7c05 6603 7400 6a05  |.j.d...|.f.t.j.
-00001830: 6405 8d02 7d0b 7400 6a03 7c06 6a04 6408  d...}.t.j.|.j.d.
-00001840: 1900 7c06 6a04 6409 1900 7c05 6603 7400  ..|.j.d...|.f.t.
-00001850: 6a05 6405 8d02 7d0c 7400 6a03 7c06 6a04  j.d...}.t.j.|.j.
-00001860: 6408 1900 7c06 6a04 6409 1900 7c05 6603  d...|.j.d...|.f.
-00001870: 7400 6a05 6405 8d02 7d0d 7408 7c06 6a04  t.j.d...}.t.|.j.
-00001880: 6408 1900 8301 4400 5d8c 7d0e 7408 7c06  d.....D.].}.t.|.
-00001890: 6a04 6409 1900 8301 4400 5d76 7d0f 7408  j.d.....D.]v}.t.
-000018a0: 7c05 8301 4400 5d66 7d10 7c06 6400 6400  |...D.]f}.|.d.d.
-000018b0: 8502 7c0e 7c0f 6603 1900 7d11 7c01 7c10  ..|.|.f...}.|.|.
-000018c0: 6400 6400 8502 6602 1900 7d12 7c02 7c10  d.d...f...}.|.|.
-000018d0: 6400 6400 8502 6602 1900 7d13 7409 7c0a  d.d...f...}.t.|.
-000018e0: 7c11 7c12 8303 5c03 7d14 7d15 7d16 7c15  |.|...\.}.}.}.|.
-000018f0: 7c0c 7c0e 7c0f 7c10 6603 3c00 7c16 7c0d  |.|.|.|.f.<.|.|.
-00001900: 7c0e 7c0f 7c10 6603 3c00 9001 712e 9001  |.|.|.f.<...q...
-00001910: 7122 9001 7110 7400 6a03 7c05 7400 6a05  q"..q.t.j.|.t.j.
-00001920: 6405 8d02 7d17 7400 6a03 7c05 7400 6a05  d...}.t.j.|.t.j.
-00001930: 6405 8d02 7d18 7400 6a03 640a 7c05 6602  d...}.t.j.d.|.f.
-00001940: 7400 6a05 6405 8d02 7d19 7400 6a03 640a  t.j.d...}.t.j.d.
-00001950: 7c05 6602 7400 6a05 6405 8d02 7d1a 7408  |.f.t.j.d...}.t.
-00001960: 7c05 8301 4400 9001 5d1a 7d1b 7400 a00a  |...D...].}.t...
-00001970: 7400 a00b 7c0c 6400 6400 8502 6400 6400  t...|.d.d...d.d.
-00001980: 8502 7c1b 6603 1900 a101 7c04 a102 7c17  ..|.f.....|...|.
-00001990: 7c1b 3c00 7400 a00a 7400 a00b 7c0c 6400  |.<.t...t...|.d.
-000019a0: 6400 8502 6400 6400 8502 7c1b 6603 1900  d...d.d...|.f...
-000019b0: a101 640b 7c04 1800 a102 7c18 7c1b 3c00  ..d.|.....|.|.<.
-000019c0: 640c 7400 a00c 7c0d 6400 6400 8502 6400  d.t...|.d.d...d.
-000019d0: 6400 8502 7c1b 6603 1900 a101 1400 640d  d...|.f.......d.
-000019e0: 7c17 7c1b 1900 1400 640c 7400 a00c 7c0d  |.|.....d.t...|.
-000019f0: 6400 6400 8502 6400 6400 8502 7c1b 6603  d.d...d.d...|.f.
-00001a00: 1900 a101 1400 640d 7c18 7c1b 1900 1400  ......d.|.|.....
-00001a10: 6604 7c19 6400 6400 8502 7c1b 6602 3c00  f.|.d.d...|.f.<.
-00001a20: 6404 7400 a00d 7c0d 6400 6400 8502 6400  d.t...|.d.d...d.
-00001a30: 6400 8502 7c1b 6603 1900 a101 1400 640e  d...|.f.......d.
-00001a40: 7c17 7c1b 1900 1400 6404 7400 a00d 7c0d  |.|.....d.t...|.
-00001a50: 6400 6400 8502 6400 6400 8502 7c1b 6603  d.d...d.d...|.f.
-00001a60: 1900 a101 1400 640e 7c18 7c1b 1900 1400  ......d.|.|.....
-00001a70: 6604 7c1a 6400 6400 8502 7c1b 6602 3c00  f.|.d.d...|.f.<.
-00001a80: 9001 71ee 7408 7c06 6a04 6408 1900 8301  ..q.t.|.j.d.....
-00001a90: 4400 9001 5dda 7d1c 7408 7c06 6a04 6409  D...].}.t.|.j.d.
-00001aa0: 1900 8301 4400 9001 5dc2 7d1d 7408 7c05  ....D...].}.t.|.
-00001ab0: 8301 4400 9001 5db0 7d1e 7c06 6400 6400  ..D...].}.|.d.d.
-00001ac0: 8502 7c1c 7c1d 6603 1900 7d11 7c01 7c1e  ..|.|.f...}.|.|.
-00001ad0: 6400 6400 8502 6602 1900 7d12 7c02 7c1e  d.d...f...}.|.|.
-00001ae0: 6400 6400 8502 6602 1900 7d13 7400 a00e  d.d...f...}.t...
-00001af0: 7c12 6402 1900 7400 a00c 7c0a a101 1800  |.d...t...|.....
-00001b00: 7400 a00f 7400 a010 7c0a a101 a101 1b00  t...t...|.......
-00001b10: a101 7d1f 7400 a00e 7c12 6403 1900 7400  ..}.t...|.d...t.
-00001b20: a00c 7c0a a101 1800 7400 a00f 7400 a010  ..|.....t...t...
-00001b30: 7c0a a101 a101 1b00 a101 7d20 7c08 7c0e  |.........} |.|.
-00001b40: 1800 6404 1300 7c09 7c0f 1800 6404 1300  ..d...|.|...d...
-00001b50: 1700 7c03 6404 1300 6b01 7d21 7400 6a11  ..|.d...k.}!t.j.
-00001b60: 7c06 6400 6400 8502 7c21 6602 1900 6409  |.d.d...|!f...d.
-00001b70: 640f 8d02 7d22 7412 6a13 7414 7c0a 7c1f  d...}"t.j.t.|.|.
-00001b80: 7c20 8502 1900 7c22 7c1f 7c20 8502 1900  | ....|"|.| ....
-00001b90: 7c19 6400 6400 8502 7c1e 6602 1900 7c1a  |.d.d...|.f...|.
-00001ba0: 6400 6400 8502 7c1e 6602 1900 6602 6410  d.d...|.f...f.d.
-00001bb0: 6410 6411 8d06 5c02 7d23 7d14 7414 7c0a  d.d...\.}#}.t.|.
-00001bc0: 7c23 6402 1900 7c23 6403 1900 7c23 6404  |#d...|#d...|#d.
-00001bd0: 1900 7c23 6412 1900 8305 7d24 7c11 7c24  ..|#d.....}$|.|$
-00001be0: 1800 7d25 7c25 7c07 6400 6400 8502 7c1c  ..}%|%|.d.d...|.
-00001bf0: 7c1d 7c1e 6604 3c00 7400 a00e 7c13 6402  |.|.f.<.t...|.d.
-00001c00: 1900 7400 a00c 7c0a a101 1800 7400 a00f  ..t...|.....t...
-00001c10: 7400 a010 7c0a a101 a101 1b00 a101 7d26  t...|.........}&
-00001c20: 7400 a00e 7c13 6403 1900 7400 a00c 7c0a  t...|.d...t...|.
-00001c30: a101 1800 7400 a00f 7400 a010 7c0a a101  ....t...t...|...
-00001c40: a101 1b00 a101 7d27 7400 a015 7c25 7c26  ......}'t...|%|&
-00001c50: 7c27 8502 1900 a101 7c0b 7c1c 7c1d 7c1e  |'......|.|.|.|.
-00001c60: 6603 3c00 9003 713c 9003 712e 9003 711a  f.<...q<..q...q.
-00001c70: 7c0b 7c07 6602 5300 2913 4e72 0a00 0000  |.|.f.S.).Nr....
-00001c80: 7201 0000 0072 0400 0000 720f 0000 0072  r....r....r....r
-00001c90: 5c00 0000 725d 0000 0072 5e00 0000 725f  \...r]...r^...r_
-00001ca0: 0000 0072 6000 0000 722c 0000 00e9 6400  ...r`...r,....d.
-00001cb0: 0000 6700 0000 0000 00e0 3f67 6abc 7493  ..g.......?gj.t.
-00001cc0: 1804 f03f 672b 8716 d9ce f7ef 3f72 6100  ...?g+......?ra.
-00001cd0: 0000 672d 431c ebe2 361a 3f29 03da 0662  ..g-C...6.?)...b
-00001ce0: 6f75 6e64 735a 0466 746f 6c5a 0478 746f  oundsZ.ftolZ.xto
-00001cf0: 6c72 3200 0000 2916 7208 0000 0072 1100  lr2...).r....r..
-00001d00: 0000 7206 0000 0072 1400 0000 7212 0000  ..r....r....r...
-00001d10: 005a 0766 6c6f 6174 3332 7262 0000 0072  .Z.float32rb...r
-00001d20: 6300 0000 7215 0000 0072 2600 0000 da0a  c...r....r&.....
-00001d30: 7065 7263 656e 7469 6c65 5a05 7261 7665  percentileZ.rave
-00001d40: 6c72 1a00 0000 7209 0000 0072 1300 0000  lr....r....r....
-00001d50: 7210 0000 0072 1b00 0000 7264 0000 00da  r....r....rd....
-00001d60: 0373 706f 5a09 6375 7276 655f 6669 7472  .spoZ.curve_fitr
-00001d70: 7800 0000 7255 0000 0029 2872 6500 0000  x...rU...)(re...
-00001d80: 7266 0000 0072 5800 0000 7267 0000 0072  rf...rX...rg...r
-00001d90: 7c00 0000 7268 0000 0072 6900 0000 726a  |...rh...ri...rj
-00001da0: 0000 0072 6b00 0000 726c 0000 0072 1f00  ...rk...rl...r..
-00001db0: 0000 726d 0000 005a 0c70 6f77 6572 5f76  ..rm...Z.power_v
-00001dc0: 616c 7565 735a 0c63 6f6e 7374 5f76 616c  aluesZ.const_val
-00001dd0: 7565 7372 0b00 0000 7218 0000 005a 026b  uesr....r....Z.k
-00001de0: 6b72 6f00 0000 7270 0000 0072 7100 0000  kro...rp...rq...
-00001df0: 7259 0000 0072 2400 0000 7225 0000 005a  rY...r$...r%...Z
-00001e00: 0b70 6572 6365 6e74 696c 6531 5a0b 7065  .percentile1Z.pe
-00001e10: 7263 656e 7469 6c65 325a 0b6c 6f77 6572  rcentile2Z.lower
-00001e20: 5f62 6f75 6e64 5a0b 7570 7065 725f 626f  _boundZ.upper_bo
-00001e30: 756e 645a 026c 6cda 0270 7072 6e00 0000  undZ.ll..pprn...
-00001e40: 5a02 7272 5a08 7374 6172 5f76 616c 7223  Z.rrZ.star_valr#
-00001e50: 0000 0072 7200 0000 7273 0000 005a 0470  ...rr...rs...Z.p
-00001e60: 6f70 745a 0a62 6163 6b67 726f 756e 6472  optZ.backgroundr
-00001e70: 4f00 0000 5a08 7374 6172 5f73 756d 5a08  O...Z.star_sumZ.
-00001e80: 7374 6f70 5f73 756d 720c 0000 0072 0c00  stop_sumr....r..
-00001e90: 0000 720d 0000 00da 0c65 656c 735f 3344  ..r......eels_3D
-00001ea0: 5f4c 4350 4ccd 0000 0073 a800 0000 0001  _LCPL....s......
-00001eb0: 0a01 0a01 0801 0801 0401 1c01 04fe 0604  ................
-00001ec0: 2601 1c01 02ff 0202 02fe 0603 0401 18ff  &...............
-00001ed0: 0603 0401 18ff 0603 0401 18ff 0604 1201  ................
-00001ee0: 1201 0c01 1201 1001 1001 1201 0e01 1a02  ................
-00001ef0: 1001 1001 1401 1402 0e01 2801 0401 20ff  ..........(... .
-00001f00: 0804 1e01 0a01 1e01 0afc 1007 1e01 0a01  ................
-00001f10: 1e01 0afc 1407 1401 1401 0e01 1201 1001  ................
-00001f20: 1001 0401 20ff 0403 0401 20ff 0404 2001  .... ..... ... .
-00001f30: 1a01 0401 0201 0a01 0a01 1e01 0201 02fa  ................
-00001f40: 0a08 2001 0801 1401 0401 20ff 0403 0401  .. ....... .....
-00001f50: 20ff 0403 2802 727f 0000 0029 0172 0100   ...(.r....).r..
-00001f60: 0000 2901 5429 0172 3200 0000 2902 7232  ..).T).r2...).r2
-00001f70: 0000 0072 7900 0000 2918 5a05 6e75 6d70  ...ry...).Z.nump
-00001f80: 7972 0800 0000 7205 0000 005a 0e73 6369  yr....r....Z.sci
-00001f90: 7079 2e6f 7074 696d 697a 65da 086f 7074  py.optimize..opt
-00001fa0: 696d 697a 6572 7d00 0000 5a0c 7363 6970  imizer}...Z.scip
-00001fb0: 792e 7369 676e 616c da06 7369 676e 616c  y.signal..signal
-00001fc0: 7216 0000 005a 116d 6174 706c 6f74 6c69  r....Z.matplotli
-00001fd0: 622e 7079 706c 6f74 5a06 7079 706c 6f74  b.pyplotZ.pyplot
-00001fe0: 7244 0000 005a 0a6d 6174 706c 6f74 6c69  rD...Z.matplotli
-00001ff0: 6272 4200 0000 5a09 7471 646d 2e61 7574  brB...Z.tqdm.aut
-00002000: 6f72 0200 0000 720e 0000 0072 1900 0000  or....r....r....
-00002010: 7226 0000 0072 5200 0000 725b 0000 0072  r&...rR...r[...r
-00002020: 7500 0000 7278 0000 0072 7f00 0000 720c  u...rx...r....r.
-00002030: 0000 0072 0c00 0000 720c 0000 0072 0d00  ...r....r....r..
-00002040: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
-00002050: 7320 0000 0008 0108 010c 010c 010c 0108  s ..............
-00002060: 010c 0308 0c0a 1608 3802 010a fa0a 230a  ........8.....#.
-00002070: 200a 2608 05                              .&..
+000013a0: 056a 0464 0819 0083 0144 005d 987d 0b74  .j.d.....D.].}.t
+000013b0: 087c 056a 0464 0919 0083 0144 005d 8e7d  .|.j.d.....D.].}
+000013c0: 0c74 087c 0483 0144 005d 877d 0d7c 0564  .t.|...D.].}.|.d
+000013d0: 0064 0085 027c 0b7c 0c66 0319 007d 0e7c  .d...|.|.f...}.|
+000013e0: 017c 0d64 0064 0085 0266 0219 007d 0f7c  .|.d.d...f...}.|
+000013f0: 027c 0d64 0064 0085 0266 0219 007d 107c  .|.d.d...f...}.|
+00001400: 077c 0b18 0064 0413 007c 087c 0c18 0064  .|...d...|.|...d
+00001410: 0413 0017 007c 0364 0413 006b 017d 1174  .....|.d...k.}.t
+00001420: 006a 097c 0564 0064 0085 027c 1166 0219  .j.|.d.d...|.f..
+00001430: 0064 0964 0a8d 027d 1274 0a7c 097c 127c  .d.d...}.t.|.|.|
+00001440: 0f83 035c 037d 137d 147d 147c 0e7c 1318  ...\.}.}.}.|.|..
+00001450: 007d 157c 157c 0664 0064 0085 027c 0b7c  .}.|.|.d.d...|.|
+00001460: 0c7c 0d66 043c 0074 00a0 0b7c 1064 0219  .|.f.<.t...|.d..
+00001470: 0074 00a0 0c7c 09a1 0118 0074 00a0 0d74  .t...|.....t...t
+00001480: 00a0 0e7c 09a1 01a1 011b 00a1 017d 1674  ...|.........}.t
+00001490: 00a0 0b7c 1064 0319 0074 00a0 0c7c 09a1  ...|.d...t...|..
+000014a0: 0118 0074 00a0 0d74 00a0 0e7c 09a1 01a1  ...t...t...|....
+000014b0: 011b 00a1 017d 1774 00a0 0f7c 157c 167c  .....}.t...|.|.|
+000014c0: 1785 0219 00a1 017d 187c 187c 0a7c 0b7c  .......}.|.|.|.|
+000014d0: 0c7c 0d66 033c 0071 7571 6f71 667c 0a7c  .|.f.<.quqoqf|.|
+000014e0: 0666 0253 0029 0b4e 720a 0000 0072 0100  .f.S.).Nr....r..
+000014f0: 0000 7204 0000 0072 0f00 0000 a901 5a05  ..r....r......Z.
+00001500: 6474 7970 65da 0b70 6978 656c 4f72 6967  dtype..pixelOrig
+00001510: 696e da09 7069 7865 6c53 697a 65e9 feff  in..pixelSize...
+00001520: ffff e9ff ffff ffa9 015a 0461 7869 7329  .........Z.axis)
+00001530: 1072 0800 0000 7211 0000 0072 0600 0000  .r....r....r....
+00001540: 7214 0000 0072 1200 0000 5a07 666c 6f61  r....r....Z.floa
+00001550: 7436 34da 056d 6772 6964 da06 6172 616e  t64..mgrid..aran
+00001560: 6765 7215 0000 00da 046d 6561 6e72 2600  ger......meanr&.
+00001570: 0000 7213 0000 0072 1a00 0000 7210 0000  ..r....r....r...
+00001580: 0072 1b00 0000 7255 0000 0029 19da 0965  .r....rU...)...e
+00001590: 656c 735f 6469 6374 da09 6669 745f 7261  els_dict..fit_ra
+000015a0: 6e67 6572 5800 0000 da0a 4c42 415f 7261  ngerX.....LBA_ra
+000015b0: 6469 7573 da0b 6e6f 5f65 6c65 6d65 6e74  dius..no_element
+000015c0: 73da 0a65 656c 735f 6172 7261 79da 1465  s..eels_array..e
+000015d0: 6c65 6d65 6e74 616c 5f73 7562 7472 6163  lemental_subtrac
+000015e0: 7465 64da 0279 79da 0278 7872 1f00 0000  ted..yy..xxr....
+000015f0: da0b 7065 616b 5f76 616c 7565 7372 0b00  ..peak_valuesr..
+00001600: 0000 7218 0000 00da 0271 71da 0965 656c  ..r......qq..eel
+00001610: 735f 6461 7461 da0a 6669 745f 706f 696e  s_data..fit_poin
+00001620: 7473 da0a 7065 616b 5f70 6f69 6e74 da03  ts..peak_point..
+00001630: 6c62 69da 0865 656c 735f 6c62 69da 0262  lbi..eels_lbi..b
+00001640: 6772 5900 0000 724f 0000 0072 2200 0000  grY...rO...r"...
+00001650: 7223 0000 0072 5a00 0000 720c 0000 0072  r#...rZ...r....r
+00001660: 0c00 0000 720d 0000 00da 0765 656c 735f  ....r......eels_
+00001670: 3344 a200 0000 734e 0000 000a 010a 0108  3D....sN........
+00001680: 0108 0104 011c 0104 0106 fe26 041c 0102  ...........&....
+00001690: 0102 ff02 0206 fe04 0318 0106 ff12 0312  ................
+000016a0: 010c 0112 0110 0110 0120 011a 0112 0108  ......... ......
+000016b0: 0114 0104 0120 0104 ff04 0320 0104 ff12  ..... ..... ....
+000016c0: 0310 0102 f002 ff08 1272 7500 0000 6305  .........ru...c.
+000016d0: 0000 0000 0000 0000 0000 0006 0000 0004  ................
+000016e0: 0000 0043 0000 0073 1c00 0000 7c01 7c00  ...C...s....|.|.
+000016f0: 7c02 1300 1400 7c03 7c00 7c04 1300 1400  |.....|.|.|.....
+00001700: 1700 7d05 7c05 5300 2901 4e72 0c00 0000  ..}.|.S.).Nr....
+00001710: 2906 726c 0000 005a 0263 31da 0270 315a  ).rl...Z.c1..p1Z
+00001720: 0263 32da 0270 3272 6b00 0000 720c 0000  .c2..p2rk...r...
+00001730: 0072 0c00 0000 720d 0000 00da 046c 6370  .r....r......lcp
+00001740: 6cc8 0000 0073 0400 0000 1801 0401 7278  l....s........rx
+00001750: 0000 00e9 0500 0000 6305 0000 0000 0000  ........c.......
+00001760: 0000 0000 0028 0000 000b 0000 0043 0000  .....(.......C..
+00001770: 0073 f004 0000 7400 a001 7c01 a101 7d01  .s....t...|...}.
+00001780: 7400 a001 7c02 a101 7d02 7402 7c02 8301  t...|...}.t.|...
+00001790: 7d05 7c00 6401 1900 7d06 7400 6a03 7c06  }.|.d...}.t.j.|.
+000017a0: 6a04 6402 1900 7c06 6a04 6403 1900 7c06  j.d...|.j.d...|.
+000017b0: 6a04 6404 1900 7c05 6604 7400 6a05 6405  j.d...|.f.t.j.d.
+000017c0: 8d02 7d07 7400 6a06 6402 7c06 6a04 6403  ..}.t.j.d.|.j.d.
+000017d0: 1900 8502 6402 7c06 6a04 6404 1900 8502  ....d.|.j.d.....
+000017e0: 6602 1900 5c02 7d08 7d09 7400 a007 7c06  f...\.}.}.t...|.
+000017f0: 6a04 6402 1900 a101 7c00 6406 1900 6402  j.d.....|.d...d.
+00001800: 1900 1800 7c00 6407 1900 6402 1900 1400  ....|.d...d.....
+00001810: 7d0a 7400 6a03 7c06 6a04 6408 1900 7c06  }.t.j.|.j.d...|.
+00001820: 6a04 6409 1900 7c05 6603 7400 6a05 6405  j.d...|.f.t.j.d.
+00001830: 8d02 7d0b 7400 6a03 7c06 6a04 6408 1900  ..}.t.j.|.j.d...
+00001840: 7c06 6a04 6409 1900 7c05 6603 7400 6a05  |.j.d...|.f.t.j.
+00001850: 6405 8d02 7d0c 7400 6a03 7c06 6a04 6408  d...}.t.j.|.j.d.
+00001860: 1900 7c06 6a04 6409 1900 7c05 6603 7400  ..|.j.d...|.f.t.
+00001870: 6a05 6405 8d02 7d0d 7408 7c06 6a04 6408  j.d...}.t.|.j.d.
+00001880: 1900 8301 4400 5d43 7d0e 7408 7c06 6a04  ....D.]C}.t.|.j.
+00001890: 6409 1900 8301 4400 5d39 7d0f 7408 7c05  d.....D.]9}.t.|.
+000018a0: 8301 4400 5d32 7d10 7c06 6400 6400 8502  ..D.]2}.|.d.d...
+000018b0: 7c0e 7c0f 6603 1900 7d11 7c01 7c10 6400  |.|.f...}.|.|.d.
+000018c0: 6400 8502 6602 1900 7d12 7c02 7c10 6400  d...f...}.|.|.d.
+000018d0: 6400 8502 6602 1900 7d13 7409 7c0a 7c11  d...f...}.t.|.|.
+000018e0: 7c12 8303 5c03 7d14 7d15 7d16 7c15 7c0c  |...\.}.}.}.|.|.
+000018f0: 7c0e 7c0f 7c10 6603 3c00 7c16 7c0d 7c0e  |.|.|.f.<.|.|.|.
+00001900: 7c0f 7c10 6603 3c00 7197 7191 7188 7400  |.|.f.<.q.q.q.t.
+00001910: 6a03 7c05 7400 6a05 6405 8d02 7d17 7400  j.|.t.j.d...}.t.
+00001920: 6a03 7c05 7400 6a05 6405 8d02 7d18 7400  j.|.t.j.d...}.t.
+00001930: 6a03 640a 7c05 6602 7400 6a05 6405 8d02  j.d.|.f.t.j.d...
+00001940: 7d19 7400 6a03 640a 7c05 6602 7400 6a05  }.t.j.d.|.f.t.j.
+00001950: 6405 8d02 7d1a 7408 7c05 8301 4400 5d8c  d...}.t.|...D.].
+00001960: 7d1b 7400 a00a 7400 a00b 7c0c 6400 6400  }.t...t...|.d.d.
+00001970: 8502 6400 6400 8502 7c1b 6603 1900 a101  ..d.d...|.f.....
+00001980: 7c04 a102 7c17 7c1b 3c00 7400 a00a 7400  |...|.|.<.t...t.
+00001990: a00b 7c0c 6400 6400 8502 6400 6400 8502  ..|.d.d...d.d...
+000019a0: 7c1b 6603 1900 a101 640b 7c04 1800 a102  |.f.....d.|.....
+000019b0: 7c18 7c1b 3c00 640c 7400 a00c 7c0d 6400  |.|.<.d.t...|.d.
+000019c0: 6400 8502 6400 6400 8502 7c1b 6603 1900  d...d.d...|.f...
+000019d0: a101 1400 640d 7c17 7c1b 1900 1400 640c  ....d.|.|.....d.
+000019e0: 7400 a00c 7c0d 6400 6400 8502 6400 6400  t...|.d.d...d.d.
+000019f0: 8502 7c1b 6603 1900 a101 1400 640d 7c18  ..|.f.......d.|.
+00001a00: 7c1b 1900 1400 6604 7c19 6400 6400 8502  |.....f.|.d.d...
+00001a10: 7c1b 6602 3c00 6404 7400 a00d 7c0d 6400  |.f.<.d.t...|.d.
+00001a20: 6400 8502 6400 6400 8502 7c1b 6603 1900  d...d.d...|.f...
+00001a30: a101 1400 640e 7c17 7c1b 1900 1400 6404  ....d.|.|.....d.
+00001a40: 7400 a00d 7c0d 6400 6400 8502 6400 6400  t...|.d.d...d.d.
+00001a50: 8502 7c1b 6603 1900 a101 1400 640e 7c18  ..|.f.......d.|.
+00001a60: 7c1b 1900 1400 6604 7c1a 6400 6400 8502  |.....f.|.d.d...
+00001a70: 7c1b 6602 3c00 71f4 7408 7c06 6a04 6408  |.f.<.q.t.|.j.d.
+00001a80: 1900 8301 4400 5deb 7d1c 7408 7c06 6a04  ....D.].}.t.|.j.
+00001a90: 6409 1900 8301 4400 5de0 7d1d 7408 7c05  d.....D.].}.t.|.
+00001aa0: 8301 4400 5dd8 7d1e 7c06 6400 6400 8502  ..D.].}.|.d.d...
+00001ab0: 7c1c 7c1d 6603 1900 7d11 7c01 7c1e 6400  |.|.f...}.|.|.d.
+00001ac0: 6400 8502 6602 1900 7d12 7c02 7c1e 6400  d...f...}.|.|.d.
+00001ad0: 6400 8502 6602 1900 7d13 7400 a00e 7c12  d...f...}.t...|.
+00001ae0: 6402 1900 7400 a00c 7c0a a101 1800 7400  d...t...|.....t.
+00001af0: a00f 7400 a010 7c0a a101 a101 1b00 a101  ..t...|.........
+00001b00: 7d1f 7400 a00e 7c12 6403 1900 7400 a00c  }.t...|.d...t...
+00001b10: 7c0a a101 1800 7400 a00f 7400 a010 7c0a  |.....t...t...|.
+00001b20: a101 a101 1b00 a101 7d20 7c08 7c0e 1800  ........} |.|...
+00001b30: 6404 1300 7c09 7c0f 1800 6404 1300 1700  d...|.|...d.....
+00001b40: 7c03 6404 1300 6b01 7d21 7400 6a11 7c06  |.d...k.}!t.j.|.
+00001b50: 6400 6400 8502 7c21 6602 1900 6409 640f  d.d...|!f...d.d.
+00001b60: 8d02 7d22 7412 6a13 7414 7c0a 7c1f 7c20  ..}"t.j.t.|.|.| 
+00001b70: 8502 1900 7c22 7c1f 7c20 8502 1900 7c19  ....|"|.| ....|.
+00001b80: 6400 6400 8502 7c1e 6602 1900 7c1a 6400  d.d...|.f...|.d.
+00001b90: 6400 8502 7c1e 6602 1900 6602 6410 6410  d...|.f...f.d.d.
+00001ba0: 6411 8d06 5c02 7d23 7d14 7414 7c0a 7c23  d...\.}#}.t.|.|#
+00001bb0: 6402 1900 7c23 6403 1900 7c23 6404 1900  d...|#d...|#d...
+00001bc0: 7c23 6412 1900 8305 7d24 7c11 7c24 1800  |#d.....}$|.|$..
+00001bd0: 7d25 7c25 7c07 6400 6400 8502 7c1c 7c1d  }%|%|.d.d...|.|.
+00001be0: 7c1e 6604 3c00 7400 a00e 7c13 6402 1900  |.f.<.t...|.d...
+00001bf0: 7400 a00c 7c0a a101 1800 7400 a00f 7400  t...|.....t...t.
+00001c00: a010 7c0a a101 a101 1b00 a101 7d26 7400  ..|.........}&t.
+00001c10: a00e 7c13 6403 1900 7400 a00c 7c0a a101  ..|.d...t...|...
+00001c20: 1800 7400 a00f 7400 a010 7c0a a101 a101  ..t...t...|.....
+00001c30: 1b00 a101 7d27 7400 a015 7c25 7c26 7c27  ....}'t...|%|&|'
+00001c40: 8502 1900 a101 7c0b 7c1c 7c1d 7c1e 6603  ......|.|.|.|.f.
+00001c50: 3c00 9001 7197 9001 7191 9001 7188 7c0b  <...q...q...q.|.
+00001c60: 7c07 6602 5300 2913 4e72 0a00 0000 7201  |.f.S.).Nr....r.
+00001c70: 0000 0072 0400 0000 720f 0000 0072 5c00  ...r....r....r\.
+00001c80: 0000 725d 0000 0072 5e00 0000 725f 0000  ..r]...r^...r_..
+00001c90: 0072 6000 0000 722c 0000 00e9 6400 0000  .r`...r,....d...
+00001ca0: 6700 0000 0000 00e0 3f67 6abc 7493 1804  g.......?gj.t...
+00001cb0: f03f 672b 8716 d9ce f7ef 3f72 6100 0000  .?g+......?ra...
+00001cc0: 672d 431c ebe2 361a 3f29 03da 0662 6f75  g-C...6.?)...bou
+00001cd0: 6e64 735a 0466 746f 6c5a 0478 746f 6c72  ndsZ.ftolZ.xtolr
+00001ce0: 3200 0000 2916 7208 0000 0072 1100 0000  2...).r....r....
+00001cf0: 7206 0000 0072 1400 0000 7212 0000 005a  r....r....r....Z
+00001d00: 0766 6c6f 6174 3332 7262 0000 0072 6300  .float32rb...rc.
+00001d10: 0000 7215 0000 0072 2600 0000 da0a 7065  ..r....r&.....pe
+00001d20: 7263 656e 7469 6c65 5a05 7261 7665 6c72  rcentileZ.ravelr
+00001d30: 1a00 0000 7209 0000 0072 1300 0000 7210  ....r....r....r.
+00001d40: 0000 0072 1b00 0000 7264 0000 00da 0373  ...r....rd.....s
+00001d50: 706f 5a09 6375 7276 655f 6669 7472 7800  poZ.curve_fitrx.
+00001d60: 0000 7255 0000 0029 2872 6500 0000 7266  ..rU...)(re...rf
+00001d70: 0000 0072 5800 0000 7267 0000 0072 7c00  ...rX...rg...r|.
+00001d80: 0000 7268 0000 0072 6900 0000 726a 0000  ..rh...ri...rj..
+00001d90: 0072 6b00 0000 726c 0000 0072 1f00 0000  .rk...rl...r....
+00001da0: 726d 0000 005a 0c70 6f77 6572 5f76 616c  rm...Z.power_val
+00001db0: 7565 735a 0c63 6f6e 7374 5f76 616c 7565  uesZ.const_value
+00001dc0: 7372 0b00 0000 7218 0000 005a 026b 6b72  sr....r....Z.kkr
+00001dd0: 6f00 0000 7270 0000 0072 7100 0000 7259  o...rp...rq...rY
+00001de0: 0000 0072 2400 0000 7225 0000 005a 0b70  ...r$...r%...Z.p
+00001df0: 6572 6365 6e74 696c 6531 5a0b 7065 7263  ercentile1Z.perc
+00001e00: 656e 7469 6c65 325a 0b6c 6f77 6572 5f62  entile2Z.lower_b
+00001e10: 6f75 6e64 5a0b 7570 7065 725f 626f 756e  oundZ.upper_boun
+00001e20: 645a 026c 6cda 0270 7072 6e00 0000 5a02  dZ.ll..pprn...Z.
+00001e30: 7272 5a08 7374 6172 5f76 616c 7223 0000  rrZ.star_valr#..
+00001e40: 0072 7200 0000 7273 0000 005a 0470 6f70  .rr...rs...Z.pop
+00001e50: 745a 0a62 6163 6b67 726f 756e 6472 4f00  tZ.backgroundrO.
+00001e60: 0000 5a08 7374 6172 5f73 756d 5a08 7374  ..Z.star_sumZ.st
+00001e70: 6f70 5f73 756d 720c 0000 0072 0c00 0000  op_sumr....r....
+00001e80: 720d 0000 00da 0c65 656c 735f 3344 5f4c  r......eels_3D_L
+00001e90: 4350 4ccd 0000 0073 b000 0000 0a01 0a01  CPL....s........
+00001ea0: 0801 0801 0401 1c01 0401 06fe 2604 1c01  ............&...
+00001eb0: 0201 02ff 0202 06fe 0403 1801 06ff 0403  ................
+00001ec0: 1801 06ff 0403 1801 06ff 1204 1201 0c01  ................
+00001ed0: 1201 1001 1001 1201 0e01 1001 02fa 02ff  ................
+00001ee0: 1009 1001 1401 1401 0c02 2801 0401 2001  ..........(... .
+00001ef0: 08ff 1e04 0a01 1e01 0a01 10fc 1e07 0a01  ................
+00001f00: 1e01 0a01 12fc 1207 1201 0c01 1201 1001  ................
+00001f10: 1001 0401 2001 04ff 0403 2001 04ff 2004  .... ..... ... .
+00001f20: 1a01 0401 0201 0a01 0a01 1e01 0201 0201  ................
+00001f30: 0afa 2008 0801 1401 0401 2001 04ff 0403  .. ....... .....
+00001f40: 2001 04ff 2003 04e2 04ff 0821 727f 0000   ... ......!r...
+00001f50: 0029 0172 0100 0000 2901 5429 0172 3200  .).r....).T).r2.
+00001f60: 0000 2902 7232 0000 0072 7900 0000 2918  ..).r2...ry...).
+00001f70: 5a05 6e75 6d70 7972 0800 0000 7205 0000  Z.numpyr....r...
+00001f80: 005a 0e73 6369 7079 2e6f 7074 696d 697a  .Z.scipy.optimiz
+00001f90: 65da 086f 7074 696d 697a 6572 7d00 0000  e..optimizer}...
+00001fa0: 5a0c 7363 6970 792e 7369 676e 616c da06  Z.scipy.signal..
+00001fb0: 7369 676e 616c 7216 0000 005a 116d 6174  signalr....Z.mat
+00001fc0: 706c 6f74 6c69 622e 7079 706c 6f74 5a06  plotlib.pyplotZ.
+00001fd0: 7079 706c 6f74 7244 0000 005a 0a6d 6174  pyplotrD...Z.mat
+00001fe0: 706c 6f74 6c69 6272 4200 0000 5a09 7471  plotlibrB...Z.tq
+00001ff0: 646d 2e61 7574 6f72 0200 0000 720e 0000  dm.autor....r...
+00002000: 0072 1900 0000 7226 0000 0072 5200 0000  .r....r&...rR...
+00002010: 725b 0000 0072 7500 0000 7278 0000 0072  r[...ru...rx...r
+00002020: 7f00 0000 720c 0000 0072 0c00 0000 720c  ....r....r....r.
+00002030: 0000 0072 0d00 0000 da08 3c6d 6f64 756c  ...r......<modul
+00002040: 653e 0100 0000 7322 0000 0008 0008 010c  e>....s"........
+00002050: 010c 010c 0108 010c 0108 030a 0c08 1602  ................
+00002060: 380a 010a fa0a 230a 2008 260e 05         8.....#. .&..
```

## Comparing `stemtool/gpa/__pycache__/gpa.cpython-39.pyc` & `stemtool/gpa/__pycache__/gpa.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:52:49 2023 UTC, .py size: 28390 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 3% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 610d 0d0a 0000 0000 713e e163 e66e 0000  a.......q>.c.n..
+00000000: 6f0d 0d0a 0000 0000 a974 6f64 e26e 0000  o........tod.n..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 ae00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 6d03 5a04  d.l.Z.d.d.l.m.Z.
 00000040: 0100 6400 6401 6c05 6d06 5a07 0100 6400  ..d.d.l.m.Z...d.
 00000050: 6401 6c08 5a09 6400 6401 6c0a 6d0b 5a0c  d.l.Z.d.d.l.m.Z.
 00000060: 0100 6400 6401 6c0d 5a0e 6400 6401 6c0f  ..d.d.l.Z.d.d.l.
 00000070: 6d10 5a11 0100 6400 6401 6c12 6d13 5a14  m.Z...d.d.l.m.Z.
@@ -90,1358 +90,1358 @@
 00000590: 1064 6966 665f 696d 6167 696e 6172 795f  .diff_imaginary_
 000005a0: 785a 1064 6966 665f 696d 6167 696e 6172  xZ.diff_imaginar
 000005b0: 795f 795a 1363 6f6e 6a75 6761 7465 5f69  y_yZ.conjugate_i
 000005c0: 6d61 6769 6e61 7279 5a0e 6469 6666 5f63  maginaryZ.diff_c
 000005d0: 6f6d 706c 6578 5f78 5a0e 6469 6666 5f63  omplex_xZ.diff_c
 000005e0: 6f6d 706c 6578 5f79 5a06 6469 6666 5f78  omplex_yZ.diff_x
 000005f0: 5a06 6469 6666 5f79 a900 720e 0000 00fa  Z.diff_y..r.....
-00000600: 3662 7569 6c64 2f62 6469 7374 2e6d 6163  6build/bdist.mac
-00000610: 6f73 782d 3130 2e39 2d78 3836 5f36 342f  osx-10.9-x86_64/
-00000620: 6567 672f 7374 656d 746f 6f6c 2f67 7061  egg/stemtool/gpa
-00000630: 2f67 7061 2e70 79da 0a70 6861 7365 5f64  /gpa.py..phase_d
-00000640: 6966 660c 0000 0073 1600 0000 001f 0e01  iff....s........
-00000650: 1001 1e01 1001 1e01 0a01 0c01 0c01 0a01  ................
-00000660: 0a01 7210 0000 0063 0200 0000 0000 0000  ..r....c........
-00000670: 0000 0000 0200 0000 0700 0000 4300 0000  ............C...
-00000680: 7318 0000 0074 00a0 0174 00a0 0264 017c  s....t...t...d.|
-00000690: 007c 0118 0014 00a1 01a1 0153 0029 0261  .|.........S.).a
-000006a0: 0c02 0000 0a20 2020 2053 7562 7472 6163  .....    Subtrac
-000006b0: 7420 6f6e 6520 636f 6d70 6c65 7820 7068  t one complex ph
-000006c0: 6173 6520 696d 6167 6520 6672 6f6d 0a20  ase image from. 
-000006d0: 2020 2061 6e6f 7468 6572 2077 6974 686f     another witho
-000006e0: 7574 2063 6175 7369 6e67 2070 6861 7365  ut causing phase
-000006f0: 2077 7261 7070 696e 672e 0a0a 2020 2020   wrapping...    
-00000700: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00000710: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61  ---------.    ma
-00000720: 7472 6978 5f31 3a20 206e 6461 7272 6179  trix_1:  ndarray
-00000730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000740: 4669 7273 7420 7068 6173 6520 696d 6167  First phase imag
-00000750: 650a 2020 2020 6d61 7472 6978 5f32 3a20  e.    matrix_2: 
-00000760: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000770: 2020 2020 2020 2020 5365 636f 6e64 2070          Second p
-00000780: 6861 7365 2069 6d61 6765 0a0a 2020 2020  hase image..    
-00000790: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-000007a0: 2d2d 2d0a 2020 2020 2020 2020 2020 2020  ---.            
-000007b0: 203a 206e 6461 7272 6179 0a20 2020 2020   : ndarray.     
-000007c0: 2020 2020 2020 2020 2020 4469 6666 6572            Differ
-000007d0: 656e 6365 206f 6620 7468 6520 7068 6173  ence of the phas
-000007e0: 6520 696d 6167 6573 0a0a 2020 2020 4e6f  e images..    No
-000007f0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
-00000800: 2020 5468 6520 6261 7369 6320 6964 6561    The basic idea
-00000810: 206f 6620 7468 6973 2069 7320 7468 6174   of this is that
-00000820: 2077 6520 7375 6274 7261 6374 2074 6865   we subtract the
-00000830: 0a20 2020 2070 6861 7365 2069 6d61 6765  .    phase image
-00000840: 7320 6672 6f6d 2065 6163 6820 6f74 6865  s from each othe
-00000850: 722c 2074 6865 6e20 7472 616e 7366 6f72  r, then transfor
-00000860: 6d0a 2020 2020 7468 6174 2074 6f20 6120  m.    that to a 
-00000870: 636f 6d70 6c65 7820 7068 6173 652c 2061  complex phase, a
-00000880: 6e64 2074 616b 6520 7468 6520 616e 676c  nd take the angl
-00000890: 6520 6f66 0a20 2020 2074 6865 2063 6f6d  e of.    the com
-000008a0: 706c 6578 2069 6d61 6765 2e0a 2020 2020  plex image..    
-000008b0: 7202 0000 0029 0372 0800 0000 da05 616e  r....).r......an
-000008c0: 676c 6572 0900 0000 2902 5a08 6d61 7472  gler....).Z.matr
-000008d0: 6978 5f31 5a08 6d61 7472 6978 5f32 720e  ix_1Z.matrix_2r.
-000008e0: 0000 0072 0e00 0000 720f 0000 00da 0e70  ...r....r......p
-000008f0: 6861 7365 5f73 7562 7472 6163 7438 0000  hase_subtract8..
-00000900: 0073 0200 0000 0018 7212 0000 0063 0200  .s......r....c..
-00000910: 0000 0000 0000 0000 0000 0300 0000 0700  ................
-00000920: 0000 4300 0000 733a 0000 0074 00a0 0164  ..C...s:...t...d
-00000930: 01a1 017d 0274 00a0 0274 00a0 0374 00a0  ...}.t...t...t..
-00000940: 047c 00a1 01a1 0174 00a0 047c 016a 05a1  .|.....t...|.j..
-00000950: 01a1 0264 0218 007c 0264 0364 0185 023c  ...d...|.d.d...<
-00000960: 007c 0253 0029 0461 8201 0000 0a20 2020  .|.S.).a.....   
-00000970: 2043 6f6e 7665 7274 2061 2070 6978 656c   Convert a pixel
-00000980: 2070 6f73 6974 696f 6e20 746f 2067 2076   position to g v
-00000990: 6563 746f 7273 2069 6e0a 2020 2020 466f  ectors in.    Fo
-000009a0: 7572 6965 7220 7370 6163 652e 0a0a 2020  urier space...  
-000009b0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000009c0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000009d0: 6369 7263 5f70 6f73 3a20 2074 7570 6c65  circ_pos:  tuple
-000009e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000009f0: 4669 7273 7420 7068 6173 6520 696d 6167  First phase imag
-00000a00: 650a 2020 2020 696d 6167 653a 2020 2020  e.    image:    
-00000a10: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000a20: 2020 2020 2020 2020 5468 6520 696d 6167          The imag
-00000a30: 6520 6d61 7472 6978 0a0a 2020 2020 5265  e matrix..    Re
-00000a40: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00000a50: 2d0a 2020 2020 675f 7665 633a 206e 6461  -.    g_vec: nda
-00000a60: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00000a70: 5368 6170 6520 6973 2028 322c 2031 2920  Shape is (2, 1) 
-00000a80: 7768 6963 6820 6973 2074 6865 0a20 2020  which is the.   
-00000a90: 2020 2020 2020 2020 636f 7272 6573 706f          correspo
-00000aa0: 6e64 696e 6720 672d 7665 6374 6f72 2069  nding g-vector i
-00000ab0: 6e20 696e 7665 7273 6520 7069 7865 6c73  n inverse pixels
-00000ac0: 0a0a 2020 2020 5365 6520 416c 736f 0a20  ..    See Also. 
-00000ad0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00000ae0: 475f 746f 5f63 6972 630a 2020 2020 e902  G_to_circ.    ..
-00000af0: 0000 00e7 0000 0000 0000 e03f 7201 0000  ...........?r...
-00000b00: 0029 0672 0800 0000 720a 0000 00da 0664  .).r....r......d
-00000b10: 6976 6964 65da 0466 6c69 70da 0761 7361  ivide..flip..asa
-00000b20: 7272 6179 720b 0000 0029 03da 0863 6972  rrayr....)...cir
-00000b30: 635f 706f 73da 0569 6d61 6765 da05 675f  c_pos..image..g_
-00000b40: 7665 6372 0e00 0000 720e 0000 0072 0f00  vecr....r....r..
-00000b50: 0000 da09 6369 7263 5f74 6f5f 4753 0000  ....circ_to_GS..
-00000b60: 0073 0600 0000 0016 0a01 2c01 721b 0000  .s........,.r...
-00000b70: 0063 0200 0000 0000 0000 0000 0000 0300  .c..............
-00000b80: 0000 0400 0000 4300 0000 7356 0000 0074  ......C...sV...t
-00000b90: 00a0 0164 01a1 017d 027c 0064 0219 007c  ...d...}.|.d...|
-00000ba0: 016a 0264 0219 0014 0064 037c 016a 0264  .j.d.....d.|.j.d
-00000bb0: 0219 0014 0017 007c 0264 043c 007c 0064  .......|.d.<.|.d
-00000bc0: 0419 007c 016a 0264 0419 0014 0064 037c  ...|.j.d.....d.|
-00000bd0: 016a 0264 0419 0014 0017 007c 0264 023c  .j.d.......|.d.<
-00000be0: 007c 0253 0029 0561 d401 0000 0a20 2020  .|.S.).a.....   
-00000bf0: 2043 6f6e 7665 7274 2067 2076 6563 746f   Convert g vecto
-00000c00: 7273 2069 6e20 466f 7572 6965 7220 7370  rs in Fourier sp
-00000c10: 6163 6520 746f 0a20 2020 2070 6978 656c  ace to.    pixel
-00000c20: 2070 6f73 6974 696f 6e73 2069 6e20 7265   positions in re
-00000c30: 616c 2073 7061 6365 2e0a 0a20 2020 2050  al space...    P
-00000c40: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000c50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2067 5f76  --------.    g_v
-00000c60: 6563 3a20 6e64 6172 7261 790a 2020 2020  ec: ndarray.    
-00000c70: 2020 2020 2020 2053 6861 7065 2069 7320         Shape is 
-00000c80: 2832 2c20 3129 2077 6869 6368 2069 7320  (2, 1) which is 
-00000c90: 7468 6520 470a 2020 2020 2020 2020 2020  the G.          
-00000ca0: 2076 6563 746f 7220 696e 2046 6f75 7269   vector in Fouri
-00000cb0: 6572 2073 7061 6365 2069 6e20 696e 7665  er space in inve
-00000cc0: 7273 6520 7069 7865 6c73 0a20 2020 2069  rse pixels.    i
-00000cd0: 6d61 6765 3a20 6e64 6172 7261 790a 2020  mage: ndarray.  
-00000ce0: 2020 2020 2020 2020 2054 6865 2069 6d61           The ima
-00000cf0: 6765 206d 6174 7269 780a 0a20 2020 2052  ge matrix..    R
-00000d00: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00000d10: 2d2d 0a20 2020 2063 6972 635f 706f 733a  --.    circ_pos:
-00000d20: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000d30: 2020 2020 5368 6170 6520 6973 2028 322c      Shape is (2,
-00000d40: 2031 2920 7768 6963 6820 6973 2074 6865   1) which is the
-00000d50: 0a20 2020 2020 2020 2020 2020 636f 7272  .           corr
-00000d60: 6573 706f 6e64 696e 6720 7069 7865 6c20  esponding pixel 
-00000d70: 706f 7369 7469 6f6e 2069 6e0a 2020 2020  position in.    
-00000d80: 2020 2020 2020 2072 6561 6c20 7370 6163         real spac
-00000d90: 652e 0a0a 2020 2020 5365 6520 416c 736f  e...    See Also
-00000da0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00000db0: 2020 6369 7263 5f74 6f5f 470a 2020 2020    circ_to_G.    
-00000dc0: 7213 0000 0072 0100 0000 7214 0000 0072  r....r....r....r
-00000dd0: 0400 0000 2903 7208 0000 0072 0a00 0000  ....).r....r....
-00000de0: 720b 0000 0029 0372 1a00 0000 7219 0000  r....).r....r...
-00000df0: 0072 1800 0000 720e 0000 0072 0e00 0000  .r....r....r....
-00000e00: 720f 0000 00da 0947 5f74 6f5f 6369 7263  r......G_to_circ
-00000e10: 6e00 0000 7308 0000 0000 180a 0124 0124  n...s........$.$
-00000e20: 0172 1c00 0000 6302 0000 0000 0000 0000  .r....c.........
-00000e30: 0000 0007 0000 0005 0000 0043 0000 0073  ...........C...s
-00000e40: 8200 0000 7400 6a01 7c01 6a02 6401 1900  ....t.j.|.j.d...
-00000e50: 0b00 6402 1b00 7c01 6a02 6401 1900 6402  ..d...|.j.d...d.
-00000e60: 1b00 6403 6404 8d03 7d02 7400 6a01 7c01  ..d.d...}.t.j.|.
-00000e70: 6a02 6403 1900 0b00 6402 1b00 7c01 6a02  j.d.....d...|.j.
-00000e80: 6403 1900 6402 1b00 6403 6404 8d03 7d03  d...d...d.d...}.
-00000e90: 7400 a003 7c03 7c02 a102 5c02 7d04 7d05  t...|.|...\.}.}.
-00000ea0: 6402 7400 6a04 1400 7c04 7c00 6403 1900  d.t.j...|.|.d...
-00000eb0: 1400 7c05 7c00 6401 1900 1400 1700 1400  ..|.|.d.........
-00000ec0: 7d06 7c06 5300 2905 61b5 0100 000a 2020  }.|.S.).a.....  
-00000ed0: 2020 4d75 6c74 6970 6c79 2067 2076 6563    Multiply g vec
-00000ee0: 746f 7220 7769 7468 2046 6f75 7269 6572  tor with Fourier
-00000ef0: 2063 6f6f 7264 696e 6174 6573 0a20 2020   coordinates.   
-00000f00: 2074 6f20 6765 6e65 7261 7465 2061 2063   to generate a c
-00000f10: 6f72 7265 7370 6f6e 6469 6e67 2070 6861  orresponding pha
-00000f20: 7365 206d 6174 7269 780a 0a20 2020 2050  se matrix..    P
-00000f30: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000f40: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2067 5f76  --------.    g_v
-00000f50: 6563 3a20 6e64 6172 7261 790a 2020 2020  ec: ndarray.    
-00000f60: 2020 2020 2020 2053 6861 7065 2069 7320         Shape is 
-00000f70: 2832 2c20 3129 2077 6869 6368 2069 7320  (2, 1) which is 
-00000f80: 7468 6520 470a 2020 2020 2020 2020 2020  the G.          
-00000f90: 2076 6563 746f 7220 696e 2046 6f75 7269   vector in Fouri
-00000fa0: 6572 2073 7061 6365 2069 6e20 696e 7665  er space in inve
-00000fb0: 7273 6520 7069 7865 6c73 0a20 2020 2069  rse pixels.    i
-00000fc0: 6d61 6765 3a20 6e64 6172 7261 790a 2020  mage: ndarray.  
-00000fd0: 2020 2020 2020 2020 2054 6865 2069 6d61           The ima
-00000fe0: 6765 206d 6174 7269 780a 0a20 2020 2052  ge matrix..    R
-00000ff0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00001000: 2d2d 0a20 2020 2047 5f72 3a20 6e64 6172  --.    G_r: ndar
-00001010: 7261 790a 2020 2020 2020 2020 2053 616d  ray.         Sam
-00001020: 6520 7369 7a65 2061 7320 7468 6520 696d  e size as the im
-00001030: 6167 6520 6f72 6967 696e 616c 6c79 0a20  age originally. 
-00001040: 2020 2020 2020 2020 616e 6420 6769 7665          and give
-00001050: 7320 7468 6520 7068 6173 6520 6d61 7020  s the phase map 
-00001060: 666f 7220 6120 6769 7665 6e0a 2020 2020  for a given.    
-00001070: 2020 2020 2067 2076 6563 746f 720a 2020       g vector.  
-00001080: 2020 7201 0000 0072 1300 0000 7204 0000    r....r....r...
-00001090: 00a9 03da 0573 7461 7274 da04 7374 6f70  .....start..stop
-000010a0: da04 7374 6570 2905 7208 0000 00da 0661  ..step).r......a
-000010b0: 7261 6e67 6572 0b00 0000 da08 6d65 7368  ranger......mesh
-000010c0: 6772 6964 da02 7069 2907 5a08 675f 7665  grid..pi).Z.g_ve
-000010d0: 6374 6f72 7219 0000 005a 0372 5f79 5a03  ctorr....Z.r_yZ.
-000010e0: 725f 78da 0352 5f78 da03 525f 795a 0347  r_x..R_x..R_yZ.G
-000010f0: 5f72 720e 0000 0072 0e00 0000 720f 0000  _rr....r....r...
-00001100: 00da 0867 5f6d 6174 7269 788c 0000 0073  ...g_matrix....s
-00001110: 0a00 0000 0014 2601 2601 1001 2201 7226  ......&.&...".r&
-00001120: 0000 0054 6304 0000 0000 0000 0000 0000  ...Tc...........
-00001130: 000f 0000 000b 0000 0043 0000 0073 7801  .........C...sx.
-00001140: 0000 7400 a001 7400 a002 7c01 a101 a101  ..t...t...|.....
-00001150: 7d04 7c02 6401 6b02 722e 7400 a003 6402  }.|.d.k.r.t...d.
-00001160: 7400 a001 7c04 a101 1400 a101 7d05 6e04  t...|.......}.n.
-00001170: 7c02 7d05 7400 6a04 6401 7c04 6401 1900  |.}.t.j.d.|.d...
-00001180: 8502 6401 7c04 6403 1900 8502 6602 1900  ..d.|.d.....f...
-00001190: 5c02 7d06 7d07 7400 a005 7400 a006 7c00  \.}.}.t...t...|.
-000011a0: a101 7c04 a102 6404 7c04 1400 1700 7d08  ..|...d.|.....}.
-000011b0: 7407 6a08 a009 7c04 7c08 6401 1900 7c08  t.j...|.|.d...|.
-000011c0: 6403 1900 7c05 a104 a00a 740b a101 7d09  d...|.....t...}.
-000011d0: 7400 a00c 7400 a00d 7400 a00e 7c04 6401  t...t...t...|.d.
-000011e0: 1900 a101 7400 a00e 7c04 6403 1900 a101  ....t...|.d.....
-000011f0: a102 a101 7d0a 7c03 9001 724a 7400 a00f  ....}.|...rJt...
-00001200: 6404 7c00 1400 7c04 1400 6405 1300 a101  d.|...|...d.....
-00001210: 7d0b 7c06 7c09 1900 7c08 6403 1900 1800  }.|.|...|.d.....
-00001220: 6405 1300 7c07 7c09 1900 7c08 6401 1900  d...|.|...|.d...
-00001230: 1800 6405 1300 1700 7c0b 1b00 7d0c 7400  ..d.....|...}.t.
-00001240: 6a10 7c06 7400 6a11 6406 8d02 7d0d 7400  j.|.t.j.d...}.t.
-00001250: a012 6407 7c0c 1400 a101 7c0d 7c09 3c00  ..d.|.....|.|.<.
-00001260: 7400 a013 7400 6a14 a015 7c0d 7400 6a14  t...t.j...|.t.j.
-00001270: a016 7400 6a14 a017 7c01 7c0a 1400 a101  ..t.j...|.|.....
-00001280: a101 1400 a101 a101 7d0e 6e2a 7400 a013  ........}.n*t...
-00001290: 7400 6a14 a015 7c09 7400 6a14 a016 7400  t.j...|.t.j...t.
-000012a0: 6a14 a017 7c01 7c0a 1400 a101 a101 1400  j...|.|.........
-000012b0: a101 a101 7d0e 7c0e 5300 2908 612b 0400  ....}.|.S.).a+..
-000012c0: 000a 2020 2020 5573 6520 7468 6520 6720  ..    Use the g 
-000012d0: 7665 6374 6f72 2069 6e20 466f 7572 6965  vector in Fourie
-000012e0: 7220 636f 6f72 6469 6e61 7465 730a 2020  r coordinates.  
-000012f0: 2020 746f 2073 656c 6563 7420 6f6e 6c79    to select only
-00001300: 2074 6865 2073 7562 7365 7420 6f66 2070   the subset of p
-00001310: 6861 7365 730a 2020 2020 6173 736f 6369  hases.    associ
-00001320: 6174 6564 2077 6974 6820 7468 6174 2064  ated with that d
-00001330: 6966 6672 6163 7469 6f6e 2073 706f 742c  iffraction spot,
-00001340: 0a20 2020 2061 2e6b 2e61 2e20 7468 6520  .    a.k.a. the 
-00001350: 6c61 7474 6963 6520 7061 7261 6d65 7465  lattice paramete
-00001360: 722e 0a0a 2020 2020 5061 7261 6d65 7465  r...    Paramete
-00001370: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00001380: 2d0a 2020 2020 675f 7665 633a 2020 2020  -.    g_vec:    
-00001390: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-000013a0: 2020 2020 2020 2020 5368 6170 6520 6973          Shape is
-000013b0: 2028 322c 2031 2920 7768 6963 6820 6973   (2, 1) which is
-000013c0: 2074 6865 2047 0a20 2020 2020 2020 2020   the G.         
-000013d0: 2020 2020 2020 7665 6374 6f72 2069 6e20        vector in 
-000013e0: 466f 7572 6965 7220 7370 6163 6520 696e  Fourier space in
-000013f0: 2069 6e76 6572 7365 2070 6978 656c 730a   inverse pixels.
-00001400: 2020 2020 696d 6167 653a 2020 2020 206e      image:     n
-00001410: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-00001420: 2020 2020 2020 5468 6520 696d 6167 6520        The image 
-00001430: 6d61 7472 6978 0a20 2020 2063 6972 635f  matrix.    circ_
-00001440: 7369 7a65 3a20 666c 6f61 742c 206f 7074  size: float, opt
-00001450: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00001460: 2020 2020 2053 697a 6520 6f66 2074 6865       Size of the
-00001470: 2063 6972 636c 6520 696e 2070 6978 656c   circle in pixel
-00001480: 730a 2020 2020 675f 626c 7572 3a20 2020  s.    g_blur:   
-00001490: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-000014a0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-000014b0: 202d 2d2d 2d2d 2d2d 0a20 2020 2050 5f6d   -------.    P_m
-000014c0: 6174 7269 783a 206e 6461 7272 6179 0a20  atrix: ndarray. 
-000014d0: 2020 2020 2020 2020 2020 2020 2053 616d               Sam
-000014e0: 6520 7369 7a65 2061 7320 7468 6520 696d  e size as the im
-000014f0: 6167 6520 6f72 6967 696e 616c 6c79 0a20  age originally. 
-00001500: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00001510: 2067 6976 6573 2061 2072 6561 6c20 7370   gives a real sp
-00001520: 6163 6520 7068 6173 6520 6d61 7472 6978  ace phase matrix
-00001530: 0a20 2020 2020 2020 2020 2020 2020 2066  .              f
-00001540: 6f72 2061 2067 6976 656e 2072 6561 6c20  or a given real 
-00001550: 696d 6167 6520 616e 6420 6120 6720 7665  image and a g ve
-00001560: 6374 6f72 0a0a 2020 2020 4e6f 7465 730a  ctor..    Notes.
-00001570: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5765      -----.    We
-00001580: 2070 7574 2061 6e20 6170 6572 7475 7265   put an aperture
-00001590: 2061 726f 756e 6420 6120 7369 6e67 6c65   around a single
-000015a0: 2064 6966 6672 6163 7469 6f6e 0a20 2020   diffraction.   
-000015b0: 2073 706f 742c 2067 6976 656e 2062 7920   spot, given by 
-000015c0: 7468 6520 6720 7665 6374 6f72 2074 6861  the g vector tha
-000015d0: 7420 6765 6e65 7261 7465 7320 7468 650a  t generates the.
-000015e0: 2020 2020 7068 6173 6520 6d61 7472 6978      phase matrix
-000015f0: 2061 7373 6f63 6961 7465 6420 7769 7468   associated with
-00001600: 2074 6861 7420 6469 6666 7261 6374 696f   that diffractio
-00001610: 6e0a 2020 2020 7370 6f74 2e20 4966 2074  n.    spot. If t
-00001620: 6865 2067 2076 6563 746f 7220 6973 2061  he g vector is a
-00001630: 6c72 6561 6479 2072 6566 696e 6564 2c20  lready refined, 
-00001640: 7468 656e 0a20 2020 2069 6e20 7468 6520  then.    in the 
-00001650: 7265 6665 7265 6e63 6520 7265 6769 6f6e  reference region
-00001660: 2c20 7468 6520 6469 6666 6572 656e 6365  , the difference
-00001670: 2062 6574 7765 656e 0a20 2020 2074 6869   between.    thi
-00001680: 7320 7068 6173 6520 6d61 7472 6978 2061  s phase matrix a
-00001690: 6e64 2074 6861 7420 6769 7665 6e20 6279  nd that given by
-000016a0: 2060 675f 6d61 7472 6978 600a 2020 2020   `g_matrix`.    
-000016b0: 7368 6f75 6c64 2062 6520 7a65 726f 2e0a  should be zero..
-000016c0: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-000016d0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2067    --------.    g
-000016e0: 5f6d 6174 7269 780a 2020 2020 7201 0000  _matrix.    r...
-000016f0: 0067 7b14 ae47 e17a 843f 7204 0000 0072  .g{..G.z.?r....r
-00001700: 1400 0000 7213 0000 0072 0300 0000 e700  ....r....r......
-00001710: 0000 0000 00e0 bf29 1872 0800 0000 7217  .......).r....r.
-00001720: 0000 0072 0b00 0000 5a04 616d 696e da05  ...r....Z.amin..
-00001730: 6d67 7269 6472 0c00 0000 7216 0000 00da  mgridr....r.....
-00001740: 0273 74da 0475 7469 6c5a 0b6d 616b 655f  .st..utilZ.make_
-00001750: 6369 7263 6c65 5a06 6173 7479 7065 da04  circleZ.astype..
-00001760: 626f 6f6c da04 7371 7274 da05 6f75 7465  bool..sqrt..oute
-00001770: 72da 0768 616d 6d69 6e67 da03 7375 6dda  r..hamming..sum.
-00001780: 0a7a 6572 6f73 5f6c 696b 65da 0566 6c6f  .zeros_like..flo
-00001790: 6174 7209 0000 0072 1100 0000 da03 6666  atr....r......ff
-000017a0: 745a 0569 6666 7432 da08 6666 7473 6869  tZ.ifft2..fftshi
-000017b0: 6674 da04 6666 7432 290f 5a04 6776 6563  ft..fft2).Z.gvec
-000017c0: 7219 0000 00da 0963 6972 635f 7369 7a65  r......circ_size
-000017d0: 5a06 675f 626c 7572 da07 696d 7368 6170  Z.g_blur..imshap
-000017e0: 655a 0863 6972 635f 7261 64da 0279 79da  eZ.circ_rad..yy.
-000017f0: 0278 7872 1800 0000 5a09 6369 7263 5f6d  .xxr....Z.circ_m
-00001800: 6173 6bda 0368 616d 5a06 7369 676d 6132  ask..hamZ.sigma2
-00001810: da02 7a7a 5a09 666f 7572 5f6d 6173 6b5a  ..zzZ.four_maskZ
-00001820: 0850 5f6d 6174 7269 7872 0e00 0000 720e  .P_matrixr....r.
-00001830: 0000 0072 0f00 0000 da0c 7068 6173 655f  ...r......phase_
-00001840: 6d61 7472 6978 a700 0000 7332 0000 0000  matrix....s2....
-00001850: 2710 0108 0116 0204 0122 011a 0218 ff02  '........"......
-00001860: 0202 fe04 0326 0206 0116 0226 0102 fe04  .....&.....&....
-00001870: 0310 0112 0104 0122 ff06 0404 0122 ff04  ......."....."..
-00001880: 0372 3b00 0000 6303 0000 0000 0000 0000  .r;...c.........
-00001890: 0000 0015 0000 0006 0000 0043 0000 0073  ...........C...s
-000018a0: 7201 0000 7400 7c00 8301 5c02 7d03 7d04  r...t.|...\.}.}.
-000018b0: 7400 7c01 8301 5c02 7d05 7d06 7401 a002  t.|...\.}.}.t...
-000018c0: 7c00 a101 7d07 7401 6a03 6401 7c07 6401  |...}.t.j.d.|.d.
-000018d0: 1900 8502 6401 7c07 6402 1900 8502 6602  ....d.|.d.....f.
-000018e0: 1900 5c02 7d08 7d09 7401 a004 7c08 a101  ..\.}.}.t...|...
-000018f0: 7d08 7401 a004 7c09 a101 7d09 7401 6a05  }.t...|...}.t.j.
-00001900: 6403 7401 6a06 6404 8d02 7d0a 7401 a007  d.t.j.d...}.t...
-00001910: 7c00 a101 7d0b 7401 a007 7c00 a101 7d0c  |...}.t...|...}.
-00001920: 7401 a007 7c00 a101 7d0d 7401 a007 7c00  t...|...}.t...|.
-00001930: a101 7d0e 7401 a008 7409 7c08 8301 a101  ..}.t...t.|.....
-00001940: 4400 5dae 7d0f 7c08 7c0f 1900 7d10 7c09  D.].}.|.|...}.|.
-00001950: 7c0f 1900 7d11 7c03 7c10 7c11 6602 1900  |...}.|.|.|.f...
-00001960: 7c0a 6405 3c00 7c04 7c10 7c11 6602 1900  |.d.<.|.|.|.f...
-00001970: 7c0a 6406 3c00 7c05 7c10 7c11 6602 1900  |.d.<.|.|.|.f...
-00001980: 7c0a 6407 3c00 7c06 7c10 7c11 6602 1900  |.d.<.|.|.|.f...
-00001990: 7c0a 6408 3c00 6402 6409 7401 6a0a 1400  |.d.<.d.d.t.j...
-000019a0: 1b00 7401 a00b 7c02 7c0a a102 1400 7d12  ..t...|.|.....}.
-000019b0: 7c12 6405 1900 7c0b 7c10 7c11 6602 3c00  |.d...|.|.|.f.<.
-000019c0: 7c12 6406 1900 7c0c 7c10 7c11 6602 3c00  |.d...|.|.|.f.<.
-000019d0: 7c12 6407 1900 7c0d 7c10 7c11 6602 3c00  |.d...|.|.|.f.<.
-000019e0: 7c12 6408 1900 7c0e 7c10 7c11 6602 3c00  |.d...|.|.|.f.<.
-000019f0: 719e 640a 7c0c 7c0d 1800 1400 7d13 640a  q.d.|.|.....}.d.
-00001a00: 7c0c 7c0d 1700 1400 7d14 7c0b 7c0e 7c13  |.|.....}.|.|.|.
-00001a10: 7c14 6604 5300 290b 61bd 0200 000a 2020  |.f.S.).a.....  
-00001a20: 2020 5573 6520 7468 6520 7265 6669 6e65    Use the refine
-00001a30: 6420 7068 6173 6520 6d61 7472 6963 6573  d phase matrices
-00001a40: 2061 6e64 206c 6174 7469 6365 206d 6174   and lattice mat
-00001a50: 7269 780a 2020 2020 746f 2063 616c 6375  rix.    to calcu
-00001a60: 6c61 7465 2074 6865 2073 7472 6169 6e20  late the strain 
-00001a70: 6d61 7472 6963 6573 2e0a 0a20 2020 2050  matrices...    P
-00001a80: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00001a90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2050 5f31  --------.    P_1
-00001aa0: 3a20 2020 2020 206e 6461 7272 6179 0a20  :      ndarray. 
-00001ab0: 2020 2020 2020 2020 2020 2020 2052 6566               Ref
-00001ac0: 696e 6564 2050 6861 7365 206d 6174 7269  ined Phase matri
-00001ad0: 7820 6672 6f6d 2066 6972 7374 206c 6174  x from first lat
-00001ae0: 7469 6365 2073 706f 740a 2020 2020 505f  tice spot.    P_
-00001af0: 323a 2020 2020 2020 6e64 6172 7261 790a  2:      ndarray.
-00001b00: 2020 2020 2020 2020 2020 2020 2020 5265                Re
-00001b10: 6669 6e65 6420 5068 6173 6520 6d61 7472  fined Phase matr
-00001b20: 6978 2066 726f 6d20 6669 7273 7420 6c61  ix from first la
-00001b30: 7474 6963 6520 7370 6f74 0a20 2020 2061  ttice spot.    a
-00001b40: 5f6d 6174 7269 783a 206e 6461 7272 6179  _matrix: ndarray
-00001b50: 0a20 2020 2020 2020 2020 2020 2020 206e  .              n
-00001b60: 6461 7272 6179 206f 6620 7368 6170 6520  darray of shape 
-00001b70: 2832 2c20 3229 2074 6861 7420 7265 7072  (2, 2) that repr
-00001b80: 6573 656e 7473 0a20 2020 2020 2020 2020  esents.         
-00001b90: 2020 2020 2074 6865 206c 6174 7469 6365       the lattice
-00001ba0: 2070 6172 616d 6574 6572 7320 696e 2072   parameters in r
-00001bb0: 6561 6c20 7370 6163 650a 0a20 2020 2052  eal space..    R
-00001bc0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00001bd0: 2d2d 0a20 2020 2065 5f78 783a 206e 6461  --.    e_xx: nda
-00001be0: 7272 6179 0a20 2020 2020 2020 2020 2053  rray.          S
-00001bf0: 7472 6169 6e20 616c 6f6e 6720 5820 6469  train along X di
-00001c00: 7265 6374 696f 6e0a 2020 2020 655f 7979  rection.    e_yy
-00001c10: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
-00001c20: 2020 2020 5374 7261 696e 2061 6c6f 6e67      Strain along
-00001c30: 2059 2064 6972 6563 7469 6f6e 0a20 2020   Y direction.   
-00001c40: 2065 5f74 683a 206e 6461 7272 6179 0a20   e_th: ndarray. 
-00001c50: 2020 2020 2020 2020 2052 6f74 6174 696f           Rotatio
-00001c60: 6e61 6c20 7374 7261 696e 0a20 2020 2065  nal strain.    e
-00001c70: 5f64 673a 206e 6461 7272 6179 0a20 2020  _dg: ndarray.   
-00001c80: 2020 2020 2020 2044 6961 676f 6e61 6c20         Diagonal 
-00001c90: 5374 7261 696e 0a0a 2020 2020 5365 6520  Strain..    See 
-00001ca0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
-00001cb0: 2d0a 2020 2020 7068 6173 655f 6469 6666  -.    phase_diff
-00001cc0: 0a20 2020 2047 5041 2e67 656e 5f73 7472  .    GPA.gen_str
-00001cd0: 6169 6e28 290a 2020 2020 7201 0000 0072  ain().    r....r
-00001ce0: 0400 0000 a902 7213 0000 0072 1300 0000  ......r....r....
-00001cf0: 7203 0000 0029 0272 0100 0000 7201 0000  r....).r....r...
-00001d00: 0029 0272 0100 0000 7204 0000 0029 0272  .).r....r....).r
-00001d10: 0400 0000 7201 0000 0029 0272 0400 0000  ....r....).r....
-00001d20: 7204 0000 0072 1300 0000 7214 0000 0029  r....r....r....)
-00001d30: 0c72 1000 0000 7208 0000 0072 0b00 0000  .r....r....r....
-00001d40: 7228 0000 00da 0572 6176 656c 720a 0000  r(.....ravelr...
-00001d50: 0072 3100 0000 7230 0000 0072 2100 0000  .r1...r0...r!...
-00001d60: da03 6c65 6e72 2300 0000 da06 6d61 746d  ..lenr#.....matm
-00001d70: 756c 2915 5a03 505f 315a 0350 5f32 da08  ul).Z.P_1Z.P_2..
-00001d80: 615f 6d61 7472 6978 5a04 5031 5f78 5a04  a_matrixZ.P1_xZ.
-00001d90: 5031 5f79 5a04 5032 5f78 5a04 5032 5f79  P1_yZ.P2_xZ.P2_y
-00001da0: 5a07 505f 7368 6170 6572 3700 0000 7238  Z.P_shaper7...r8
-00001db0: 0000 005a 0550 5f6d 6174 da04 655f 7878  ...Z.P_mat..e_xx
-00001dc0: da04 655f 7879 da04 655f 7978 da04 655f  ..e_xy..e_yx..e_
-00001dd0: 7979 da02 6969 5a04 7970 6f73 5a04 7870  yy..iiZ.yposZ.xp
-00001de0: 6f73 5a05 655f 6d61 74da 0465 5f74 68da  osZ.e_mat..e_th.
-00001df0: 0465 5f64 6772 0e00 0000 720e 0000 0072  .e_dgr....r....r
-00001e00: 0f00 0000 da08 7374 7261 696e 5f50 eb00  ......strain_P..
-00001e10: 0000 7334 0000 0000 1f0c 010c 010a 0122  ..s4..........."
-00001e20: 010a 010a 0110 010a 010a 010a 010a 0112  ................
-00001e30: 0108 0108 0110 0110 0110 0110 011a 0110  ................
-00001e40: 0110 0110 0112 010c 010c 0172 4800 0000  ...........rH...
-00001e50: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
-00001e60: 0003 0000 0040 0000 0073 5200 0000 6500  .....@...sR...e.
-00001e70: 5a01 6400 5a02 6401 5a03 641a 6405 6406  Z.d.Z.d.Z.d.d.d.
-00001e80: 8401 5a04 641b 6409 640a 8401 5a05 641c  ..Z.d.d.d...Z.d.
-00001e90: 640d 640e 8401 5a06 641d 6410 6411 8401  d.d...Z.d.d.d...
-00001ea0: 5a07 6412 6413 8400 5a08 6414 6415 8400  Z.d.d...Z.d.d...
-00001eb0: 5a09 641e 6417 6418 8401 5a0a 6419 5300  Z.d.d.d...Z.d.S.
-00001ec0: 291f da03 4750 4175 ed07 0000 0a20 2020  )...GPAu.....   
-00001ed0: 2055 7365 2047 656f 6d65 7472 6963 2050   Use Geometric P
-00001ee0: 6861 7365 2041 6e61 6c79 7369 7320 2847  hase Analysis (G
-00001ef0: 5041 2920 746f 206d 6561 7375 7265 2073  PA) to measure s
-00001f00: 7472 6169 6e20 696e 2061 6e0a 2020 2020  train in an.    
-00001f10: 656c 6563 7472 6f6e 206d 6963 726f 6772  electron microgr
-00001f20: 6170 6820 6279 206c 6f63 6174 696e 6720  aph by locating 
-00001f30: 7468 6520 6469 6666 7261 6374 696f 6e20  the diffraction 
-00001f40: 7370 6f74 7320 616e 640a 2020 2020 6964  spots and.    id
-00001f50: 656e 7469 6679 696e 6720 6120 7265 6665  entifying a refe
-00001f60: 7265 6e63 6520 7265 6769 6f6e 0a0a 2020  rence region..  
-00001f70: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00001f80: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00001f90: 696d 6167 653a 2020 2020 2020 206e 6461  image:       nda
-00001fa0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00001fb0: 2020 2020 2020 5468 6520 696d 6167 6520        The image 
-00001fc0: 6672 6f6d 2077 6869 6368 2074 6865 2073  from which the s
-00001fd0: 7472 6169 6e20 7769 6c6c 0a20 2020 2020  train will.     
-00001fe0: 2020 2020 2020 2020 2020 2020 6265 206d              be m
-00001ff0: 6561 7375 7265 6420 6672 6f6d 0a20 2020  easured from.   
-00002000: 2063 616c 6962 3a20 2020 2020 2020 666c   calib:       fl
-00002010: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-00002020: 2020 2020 2053 697a 6520 6f66 2061 6e20       Size of an 
-00002030: 696e 6469 7669 6475 616c 2070 6978 656c  individual pixel
-00002040: 0a20 2020 2063 616c 6962 5f75 6e69 7473  .    calib_units
-00002050: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-00002060: 2020 2020 2020 2055 6e69 7420 6f66 2063         Unit of c
-00002070: 616c 6962 7261 7469 6f6e 0a20 2020 2072  alibration.    r
-00002080: 6566 5f69 7465 723a 2020 2020 696e 742c  ef_iter:    int,
-00002090: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000020a0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-000020b0: 7220 6f66 2069 7465 7261 7469 6f6e 7320  r of iterations 
-000020c0: 746f 2072 756e 2066 6f72 2072 6566 696e  to run for refin
-000020d0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-000020e0: 2020 2020 2074 6865 2047 2076 6563 746f       the G vecto
-000020f0: 7273 2061 6e64 2074 6865 2070 6861 7365  rs and the phase
-00002100: 206d 6174 7269 7865 732e 0a20 2020 2020   matrixes..     
-00002110: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00002120: 756c 7420 6973 2032 302e 0a20 2020 2075  ult is 20..    u
-00002130: 7365 5f62 6c75 723a 2020 2020 626f 6f6c  se_blur:    bool
-00002140: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00002150: 2020 2020 2020 2020 2020 2020 5573 6520              Use 
-00002160: 6120 4761 7573 7369 616e 2062 6c75 7220  a Gaussian blur 
-00002170: 746f 2067 656e 6572 6174 6520 7468 650a  to generate the.
-00002180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002190: 2070 6861 7365 206d 6174 7269 7820 6672   phase matrix fr
-000021a0: 6f6d 2061 2067 2076 6563 746f 722e 2044  om a g vector. D
-000021b0: 6566 6175 6c74 2069 7320 5472 7565 0a0a  efault is True..
-000021c0: 2020 2020 5265 6665 7265 6e63 6573 0a20      References. 
-000021d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-000021e0: 2020 2e2e 205b 315d 2048 c3bf 7463 682c    .. [1] H..tch,
-000021f0: 204d 2e20 4a2e 2c20 452e 2053 6e6f 6563   M. J., E. Snoec
-00002200: 6b2c 2061 6e64 2052 2e20 4b69 6c61 6173  k, and R. Kilaas
-00002210: 2e20 2251 7561 6e74 6974 6174 6976 6520  . "Quantitative 
-00002220: 6d65 6173 7572 656d 656e 740a 2020 2020  measurement.    
-00002230: 2020 206f 6620 6469 7370 6c61 6365 6d65     of displaceme
-00002240: 6e74 2061 6e64 2073 7472 6169 6e20 6669  nt and strain fi
-00002250: 656c 6473 2066 726f 6d20 4852 454d 206d  elds from HREM m
-00002260: 6963 726f 6772 6170 6873 2e22 0a20 2020  icrographs.".   
-00002270: 2020 2020 556c 7472 616d 6963 726f 7363      Ultramicrosc
-00002280: 6f70 7920 3734 2e33 2028 3139 3938 293a  opy 74.3 (1998):
-00002290: 2031 3331 2d31 3436 2e0a 0a20 2020 2045   131-146...    E
-000022a0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-000022b0: 2d2d 2d2d 0a20 2020 2052 756e 2061 733a  ----.    Run as:
-000022c0: 0a0a 2020 2020 3e3e 3e20 696d 5f67 7061  ..    >>> im_gpa
-000022d0: 203d 2067 7061 2869 6d61 6765 3d69 6d61   = gpa(image=ima
-000022e0: 6765 4443 2c20 6361 6c69 623d 6361 6c69  geDC, calib=cali
-000022f0: 6231 2c20 6361 6c69 625f 756e 6974 733d  b1, calib_units=
-00002300: 2063 616c 6962 315f 756e 6974 7329 0a0a   calib1_units)..
-00002310: 2020 2020 5468 656e 2074 6f20 6368 6563      Then to chec
-00002320: 6b20 7468 6520 696d 6167 6520 796f 7520  k the image you 
-00002330: 6a75 7374 206c 6f61 6465 640a 0a20 2020  just loaded..   
-00002340: 203e 3e3e 2069 6d5f 6770 612e 7368 6f77   >>> im_gpa.show
-00002350: 5f69 6d61 6765 2829 0a0a 2020 2020 5468  _image()..    Th
-00002360: 656e 2c20 7365 6c65 6374 2074 6865 2064  en, select the d
-00002370: 6966 6672 6163 7469 6f6e 2073 706f 7473  iffraction spots
-00002380: 2069 6e20 696e 7665 7273 6520 756e 6974   in inverse unit
-00002390: 7320 7468 6174 2079 6f75 0a20 2020 2077  s that you.    w
-000023a0: 616e 7420 746f 2062 6520 7573 6564 2066  ant to be used f
-000023b0: 6f72 2047 5041 2e20 5468 6579 206d 7573  or GPA. They mus
-000023c0: 7420 6e6f 7420 6265 2063 6f6c 6c69 6e65  t not be colline
-000023d0: 6172 2e0a 0a20 2020 203e 3e3e 2069 6d5f  ar...    >>> im_
-000023e0: 6770 612e 6669 6e64 5f73 706f 7473 2828  gpa.find_spots((
-000023f0: 352c 2030 292c 2028 302c 202d 3529 290a  5, 0), (0, -5)).
-00002400: 0a20 2020 2077 6865 7265 2028 352c 2030  .    where (5, 0
-00002410: 2920 616e 6420 2830 2c20 2d35 2920 6172  ) and (0, -5) ar
-00002420: 6520 7477 6f20 6469 6666 7261 6374 696f  e two diffractio
-00002430: 6e20 7370 6f74 0a20 2020 206c 6f63 6174  n spot.    locat
-00002440: 696f 6e73 2e20 596f 7520 6361 6e20 7275  ions. You can ru
-00002450: 6e20 7468 6520 6066 696e 645f 7370 6f74  n the `find_spot
-00002460: 7360 206d 6574 686f 6420 6d61 6e75 616c  s` method manual
-00002470: 6c79 0a20 2020 206d 756c 7469 706c 6520  ly.    multiple 
-00002480: 7469 6d65 7320 7469 6c6c 2079 6f75 206c  times till you l
-00002490: 6f63 6174 6520 7468 6520 7370 6f74 7320  ocate the spots 
-000024a0: 636c 6f73 656c 792e 2041 6674 6572 0a20  closely. After. 
-000024b0: 2020 2079 6f75 2068 6176 6520 6c6f 6361     you have loca
-000024c0: 7465 6420 7468 6520 7370 6f74 732c 2079  ted the spots, y
-000024d0: 6f75 206e 6565 6420 746f 2064 6566 696e  ou need to defin
-000024e0: 6520 6120 7265 6665 7265 6e63 650a 2020  e a reference.  
-000024f0: 2020 7265 6769 6f6e 2066 6f72 2074 6865    region for the
-00002500: 2069 6d61 6765 202d 2077 6974 6820 7265   image - with re
-00002510: 7370 6563 7420 746f 2077 6869 6368 2074  spect to which t
-00002520: 6865 2073 7472 6169 6e0a 2020 2020 7769  he strain.    wi
-00002530: 6c6c 2062 6520 6361 6c63 756c 6174 6564  ll be calculated
-00002540: 2e0a 0a20 2020 203e 3e3e 2069 6d5f 6770  ...    >>> im_gp
-00002550: 612e 6465 6669 6e65 5f72 6566 6572 656e  a.define_referen
-00002560: 6365 2828 362e 382c 2036 2e39 292c 2028  ce((6.8, 6.9), (
-00002570: 3130 2e31 2c20 362e 3829 2c20 2831 302e  10.1, 6.8), (10.
-00002580: 322c 2039 2e35 292c 2028 372e 302c 2039  2, 9.5), (7.0, 9
-00002590: 2e36 2929 0a0a 2020 2020 7768 6572 6520  .6))..    where 
-000025a0: 2836 2e38 2c20 362e 3929 2c20 2831 302e  (6.8, 6.9), (10.
-000025b0: 312c 2036 2e38 292c 2028 3130 2e32 2c20  1, 6.8), (10.2, 
-000025c0: 392e 3529 2061 6e64 2028 372e 302c 2039  9.5) and (7.0, 9
-000025d0: 2e36 2920 6172 650a 2020 2020 7468 6520  .6) are.    the 
-000025e0: 636f 726e 6572 7320 6f66 2074 6865 2072  corners of the r
-000025f0: 6566 6572 656e 6365 2072 6567 696f 6e20  eference region 
-00002600: 796f 7520 6172 6520 6465 6669 6e69 6e67  you are defining
-00002610: 2e0a 0a20 2020 203e 3e3e 2069 6d5f 6770  ...    >>> im_gp
-00002620: 612e 7265 6669 6e65 5f70 6861 7365 2829  a.refine_phase()
-00002630: 0a20 2020 203e 3e3e 2065 5f78 782c 2065  .    >>> e_xx, e
-00002640: 5f79 792c 2065 5f74 6865 7461 2c20 655f  _yy, e_theta, e_
-00002650: 6469 6167 203d 2069 6d5f 6770 612e 6765  diag = im_gpa.ge
-00002660: 745f 7374 7261 696e 2829 0a0a 2020 2020  t_strain()..    
-00002670: 546f 2070 6c6f 7420 7468 6520 6f62 7461  To plot the obta
-00002680: 696e 6564 2073 7472 6169 6e20 6d61 7073  ined strain maps
-00002690: 3a0a 0a20 2020 203e 3e3e 2069 6d5f 6770  :..    >>> im_gp
-000026a0: 612e 706c 6f74 5f67 7061 5f73 7472 6169  a.plot_gpa_strai
-000026b0: 6e28 290a 0a20 2020 20e9 1400 0000 54e7  n()..    .....T.
-000026c0: 9a99 9999 9999 d93f 6307 0000 0000 0000  .......?c.......
-000026d0: 0000 0000 0008 0000 0003 0000 0043 0000  .............C..
-000026e0: 0073 9800 0000 7c01 7c00 5f00 7c02 7c00  .s....|.|._.|.|.
-000026f0: 5f01 7c03 7c00 5f02 7c05 7c00 5f03 7404  _.|.|._.|.|._.t.
-00002700: 7c04 8301 7c00 5f05 7406 a007 7c01 6a08  |...|._.t...|.j.
-00002710: a101 7c00 5f09 6401 7c00 6a01 7c00 6a09  ..|._.d.|.j.|.j.
-00002720: 1400 1b00 7d07 7c07 6402 1900 7c07 6401  ....}.|.d...|.d.
-00002730: 1900 6b02 725e 7406 a00a 7c07 a101 7c00  ..k.r^t...|...|.
-00002740: 5f0b 6e08 740c 6403 8301 8201 6404 7c00  _.n.t.d.....d.|.
-00002750: 6a09 1400 7c00 5f0d 6405 7c03 1700 7c00  j...|._.d.|...|.
-00002760: 5f0e 7c06 7c00 5f0f 6406 7c00 5f10 6406  _.|.|._.d.|._.d.
-00002770: 7c00 5f11 6406 7c00 5f12 6400 5300 2907  |._.d.|._.d.S.).
-00002780: 4e72 0400 0000 7201 0000 007a 2e50 6c65  Nr....r....z.Ple
-00002790: 6173 6520 656e 7375 7265 2074 6861 7420  ase ensure that 
-000027a0: 7468 6520 696d 6167 6520 6973 2061 2073  the image is a s
-000027b0: 7175 6172 6520 696d 6167 6572 1400 0000  quare imager....
-000027c0: 7a02 312f 4629 1372 1900 0000 da05 6361  z.1/F).r......ca
-000027d0: 6c69 62da 0b63 616c 6962 5f75 6e69 7473  lib..calib_units
-000027e0: da04 626c 7572 da03 696e 74da 0872 6566  ..blur..int..ref
-000027f0: 5f69 7465 7272 0800 0000 7217 0000 0072  _iterr....r....r
-00002800: 0b00 0000 7236 0000 00da 046d 6561 6eda  ....r6.....mean.
-00002810: 0969 6e76 5f63 616c 6962 da0c 5275 6e74  .inv_calib..Runt
-00002820: 696d 6545 7272 6f72 da06 6369 7263 5f30  imeError..circ_0
-00002830: da0d 696e 765f 6361 6c5f 756e 6974 73da  ..inv_cal_units.
-00002840: 0a6d 6178 5f73 7472 6169 6eda 0b73 706f  .max_strain..spo
-00002850: 7473 5f63 6865 636b da0f 7265 6665 7265  ts_check..refere
-00002860: 6e63 655f 6368 6563 6bda 0e72 6566 696e  nce_check..refin
-00002870: 696e 675f 6368 6563 6b29 08da 0473 656c  ing_check)...sel
-00002880: 6672 1900 0000 724c 0000 0072 4d00 0000  fr....rL...rM...
-00002890: 7250 0000 005a 0875 7365 5f62 6c75 7272  rP...Z.use_blurr
-000028a0: 5600 0000 5a07 696e 765f 6c65 6e72 0e00  V...Z.inv_lenr..
-000028b0: 0000 720e 0000 0072 0f00 0000 da08 5f5f  ..r....r......__
-000028c0: 696e 6974 5f5f 6701 0000 7320 0000 0000  init__g...s ....
-000028d0: 0306 0106 0106 0106 010a 010e 0110 0110  ................
-000028e0: 010e 0208 010c 010a 0106 0106 0106 017a  ...............z
-000028f0: 0c47 5041 2e5f 5f69 6e69 745f 5fa9 02e9  .GPA.__init__...
-00002900: 0f00 0000 725d 0000 00da 0769 6e66 6572  ....r].....infer
-00002910: 6e6f 6303 0000 0000 0000 0000 0000 0004  noc.............
-00002920: 0000 0004 0000 0043 0000 0073 5a00 0000  .......C...sZ...
-00002930: 7400 6a01 7c01 6401 8d01 0100 7400 6a02  t.j.|.d.....t.j.
-00002940: 7c00 6a03 7c02 6402 8d02 0100 7404 a005  |.j.|.d.....t...
-00002950: 7c00 6a06 7c00 6a07 a102 7d03 6403 7c03  |.j.|.j...}.d.|.
-00002960: 5f08 6404 7c03 5f09 6405 7c03 5f0a 7400  _.d.|._.d.|._.t.
-00002970: a00b a100 a00c 7c03 a101 0100 7400 a00d  ......|.....t...
-00002980: 6406 a101 0100 6407 5300 2908 6124 0100  d.....d.S.).a$..
-00002990: 000a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000029a0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-000029b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000029c0: 696d 7369 7a65 3a20 2020 7475 706c 652c  imsize:   tuple,
-000029d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000029e0: 2020 2020 2020 2020 2020 2020 5369 7a65              Size
-000029f0: 2069 6e20 696e 6368 6573 206f 6620 7468   in inches of th
-00002a00: 6520 696d 6167 6520 7769 7468 2074 6865  e image with the
-00002a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002a20: 2020 2064 6966 6672 6163 7469 6f6e 2073     diffraction s
-00002a30: 706f 7473 206d 6172 6b65 642e 2044 6566  pots marked. Def
-00002a40: 6175 6c74 2069 7320 2831 352c 2031 3529  ault is (15, 15)
-00002a50: 0a20 2020 2020 2020 2063 6f6c 6f72 6d61  .        colorma
-00002a60: 703a 2073 7472 2c20 6f70 7469 6f6e 616c  p: str, optional
-00002a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002a80: 2020 2043 6f6c 6f72 6d61 7020 6f66 2074     Colormap of t
-00002a90: 6865 2069 6d61 6765 2e20 4465 6661 756c  he image. Defaul
-00002aa0: 7420 6973 2069 6e66 6572 6e6f 0a20 2020  t is inferno.   
-00002ab0: 2020 2020 20a9 015a 0766 6967 7369 7a65       ..Z.figsize
-00002ac0: a901 da04 636d 6170 fa0b 6c6f 7765 7220  ....cmap..lower 
-00002ad0: 7269 6768 7472 0400 0000 da01 6bda 036f  rightr......k..o
-00002ae0: 6666 4e29 0eda 0370 6c74 da06 6669 6775  ffN)...plt..figu
-00002af0: 7265 da06 696d 7368 6f77 7219 0000 00da  re..imshowr.....
-00002b00: 046d 7073 73da 0853 6361 6c65 4261 7272  .mpss..ScaleBarr
-00002b10: 4c00 0000 724d 0000 00da 086c 6f63 6174  L...rM.....locat
-00002b20: 696f 6eda 0962 6f78 5f61 6c70 6861 da05  ion..box_alpha..
-00002b30: 636f 6c6f 725a 0367 6361 da0a 6164 645f  colorZ.gca..add_
-00002b40: 6172 7469 7374 7206 0000 0029 0472 5a00  artistr....).rZ.
-00002b50: 0000 da06 696d 7369 7a65 5a08 636f 6c6f  ....imsizeZ.colo
-00002b60: 726d 6170 da08 7363 616c 6562 6172 720e  rmap..scalebarr.
-00002b70: 0000 0072 0e00 0000 720f 0000 00da 0a73  ...r....r......s
-00002b80: 686f 775f 696d 6167 657c 0100 0073 1000  how_image|...s..
-00002b90: 0000 000a 0c01 1001 1001 0601 0601 0601  ................
-00002ba0: 0e01 7a0e 4750 412e 7368 6f77 5f69 6d61  ..z.GPA.show_ima
-00002bb0: 6765 725d 0000 00a9 02e9 0a00 0000 7272  ger]..........rr
-00002bc0: 0000 0063 0500 0000 0000 0000 0000 0000  ...c............
-00002bd0: 1000 0000 0900 0000 4300 0000 7340 0200  ........C...s@..
-00002be0: 007c 006a 0064 011b 0074 01a0 027c 01a1  .|.j.d...t...|..
-00002bf0: 017c 006a 031b 0017 007c 005f 047c 006a  .|.j.....|._.|.j
-00002c00: 0064 011b 0074 01a0 027c 02a1 017c 006a  .d...t...|...|.j
-00002c10: 031b 0017 007c 005f 057c 037c 005f 0674  .....|._.|.|._.t
-00002c20: 01a0 0774 01a0 0874 01a0 097c 006a 0064  ...t...t...|.j.d
-00002c30: 0219 00a1 0174 01a0 097c 006a 0064 0319  .....t...|.j.d..
-00002c40: 00a1 01a1 02a1 017c 005f 0a74 016a 0ba0  .......|._.t.j..
-00002c50: 0c74 016a 0ba0 0d7c 006a 0e7c 006a 0a14  .t.j...|.j.|.j..
-00002c60: 00a1 01a1 017c 005f 0f74 106a 11a0 1274  .....|._.t.j...t
-00002c70: 01a0 1374 01a0 147c 006a 0fa1 01a1 0164  ...t...|.j.....d
-00002c80: 04a1 027d 0574 01a0 1564 057c 006a 0314  ...}.t...d.|.j..
-00002c90: 007c 006a 0064 0219 0014 0064 067c 006a  .|.j.d.....d.|.j
-00002ca0: 0314 007c 006a 0064 0219 0014 007c 006a  ...|.j.d.....|.j
-00002cb0: 03a1 037d 0664 077d 0774 167c 006a 0064  ...}.d.}.t.|.j.d
-00002cc0: 0219 007c 0764 0318 001b 0083 017d 0874  ...|.d.......}.t
-00002cd0: 01a0 1564 027c 006a 0064 0219 007c 08a1  ...d.|.j.d...|..
-00002ce0: 037d 0974 01a0 177c 0664 0864 087c 0885  .}.t...|.d.d.|..
-00002cf0: 0319 0064 03a1 027d 0a74 186a 197c 0464  ...d...}.t.j.|.d
-00002d00: 098d 015c 027d 0b7d 0c74 186a 1a7c 006a  ...\.}.}.t.j.|.j
-00002d10: 1b7c 006a 0664 0a64 0b64 0c8d 047d 0d74  .|.j.d.d.d...}.t
-00002d20: 186a 1a7c 006a 047c 006a 0664 0d64 0b64  .j.|.j.|.j.d.d.d
-00002d30: 0c8d 047d 0e74 186a 1a7c 006a 057c 006a  ...}.t.j.|.j.|.j
-00002d40: 0664 0e64 0b64 0c8d 047d 0f7c 0c6a 1c7c  .d.d.d...}.|.j.|
-00002d50: 0564 0f64 108d 0201 007c 0ca0 1d7c 0da1  .d.d.....|...|..
-00002d60: 0101 007c 0ca0 1d7c 0ea1 0101 007c 0ca0  ...|...|.....|..
-00002d70: 1d7c 0fa1 0101 0074 18a0 1e7c 097c 0aa1  .|.....t...|.|..
-00002d80: 0201 0074 18a0 1f7c 097c 0aa1 0201 0074  ...t...|.|.....t
-00002d90: 18a0 2064 117c 006a 2117 0064 1217 00a1  .. d.|.j!..d....
-00002da0: 0101 0074 18a0 2264 137c 006a 2117 0064  ...t.."d.|.j!..d
-00002db0: 1217 00a1 0101 0074 236a 24a0 257c 006a  .......t#j$.%|.j
-00002dc0: 047c 006a 0ea1 027c 005f 2674 236a 24a0  .|.j...|._&t#j$.
-00002dd0: 257c 006a 057c 006a 0ea1 027c 005f 2774  %|.j.|.j...|._'t
-00002de0: 236a 24a0 287c 006a 267c 006a 0e7c 006a  #j$.(|.j&|.j.|.j
-00002df0: 067c 006a 29a1 047c 005f 2a74 236a 24a0  .|.j)..|._*t#j$.
-00002e00: 287c 006a 277c 006a 0e7c 006a 067c 006a  (|.j'|.j.|.j.|.j
-00002e10: 29a1 047c 005f 2b64 147c 005f 2c64 0853  )..|._+d.|._,d.S
-00002e20: 0029 1561 ee03 0000 0a20 2020 2020 2020  .).a.....       
-00002e30: 204c 6f63 6174 6520 7468 6520 6469 6666   Locate the diff
-00002e40: 7261 6374 696f 6e20 7370 6f74 7320 7669  raction spots vi
-00002e50: 7375 616c 6c79 2e0a 0a20 2020 2020 2020  sually...       
-00002e60: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00002e70: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00002e80: 2020 2020 2020 2063 6972 6331 3a20 2020         circ1:   
-00002e90: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-00002ea0: 2020 2020 2020 2020 2020 2020 2050 6f73               Pos
-00002eb0: 6974 696f 6e20 6f66 2074 6865 2066 6972  ition of the fir
-00002ec0: 7374 2062 6561 6d20 696e 0a20 2020 2020  st beam in.     
-00002ed0: 2020 2020 2020 2020 2020 2020 2020 7468                th
-00002ee0: 6520 466f 7572 6965 7220 7061 7474 6572  e Fourier patter
-00002ef0: 6e0a 2020 2020 2020 2020 6369 7263 323a  n.        circ2:
-00002f00: 2020 2020 206e 6461 7272 6179 0a20 2020       ndarray.   
-00002f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f20: 506f 7369 7469 6f6e 206f 6620 7468 6520  Position of the 
-00002f30: 7365 636f 6e64 2062 6561 6d20 696e 0a20  second beam in. 
-00002f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f50: 2020 7468 6520 466f 7572 6965 7220 7061    the Fourier pa
-00002f60: 7474 6572 6e0a 2020 2020 2020 2020 6369  ttern.        ci
-00002f70: 7263 5f73 697a 653a 2066 6c6f 6174 0a20  rc_size: float. 
-00002f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002f90: 2020 5369 7a65 206f 6620 7468 6520 6369    Size of the ci
-00002fa0: 7263 6c65 2069 6e20 7069 7865 6c73 0a20  rcle in pixels. 
-00002fb0: 2020 2020 2020 2069 6d73 697a 653a 2020         imsize:  
-00002fc0: 2020 7475 706c 652c 206f 7074 696f 6e61    tuple, optiona
-00002fd0: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
-00002fe0: 2020 2020 2053 697a 6520 696e 2069 6e63       Size in inc
-00002ff0: 6865 7320 6f66 2074 6865 2069 6d61 6765  hes of the image
-00003000: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
-00003010: 2020 2020 2020 2020 2020 2020 2064 6966               dif
-00003020: 6672 6163 7469 6f6e 2073 706f 7473 206d  fraction spots m
-00003030: 6172 6b65 642e 2044 6566 6175 6c74 2069  arked. Default i
-00003040: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00003050: 2020 2020 2028 3130 2c20 3130 290a 0a20       (10, 10).. 
-00003060: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-00003070: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
-00003080: 2020 2050 7574 2063 6972 636c 6573 2069     Put circles i
-00003090: 6e20 7265 6428 6365 6e74 7261 6c29 2c20  n red(central), 
-000030a0: 7928 626c 7565 2920 616e 6420 7828 6772  y(blue) and x(gr
-000030b0: 6565 6e29 0a20 2020 2020 2020 206f 6e20  een).        on 
-000030c0: 7468 6520 6469 6666 7261 6374 696f 6e20  the diffraction 
-000030d0: 7061 7474 6572 6e20 746f 2061 7070 726f  pattern to appro
-000030e0: 7869 6d61 7465 6c79 206b 6e6f 770a 2020  ximately know.  
-000030f0: 2020 2020 2020 7468 6520 706f 7369 7469        the positi
-00003100: 6f6e 732e 2057 6520 616c 736f 2063 6f6e  ons. We also con
-00003110: 7665 7274 2074 6865 2063 6972 636c 6520  vert the circle 
-00003120: 6c6f 6361 7469 6f6e 730a 2020 2020 2020  locations.      
-00003130: 2020 746f 2047 2076 6563 746f 7273 2062    to G vectors b
-00003140: 7920 6361 6c6c 696e 6720 7468 6520 7374  y calling the st
-00003150: 6174 6963 206d 6574 686f 6420 6063 6972  atic method `cir
-00003160: 635f 746f 5f47 602e 0a20 2020 2020 2020  c_to_G`..       
-00003170: 2057 6520 7573 6520 7468 6520 4720 7665   We use the G ve
-00003180: 6374 6f72 206c 6f63 6174 696f 6e73 2074  ctor locations t
-00003190: 6f20 616c 736f 2067 656e 6572 6174 6520  o also generate 
-000031a0: 7468 650a 2020 2020 2020 2020 696e 6974  the.        init
-000031b0: 6961 6c20 7068 6173 6520 6d61 7472 6963  ial phase matric
-000031c0: 6573 2e0a 0a20 2020 2020 2020 2053 6565  es...        See
-000031d0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-000031e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
-000031f0: 6972 635f 746f 5f47 0a20 2020 2020 2020  irc_to_G.       
-00003200: 2070 6861 7365 5f6d 6174 7269 780a 2020   phase_matrix.  
-00003210: 2020 2020 2020 7213 0000 0072 0100 0000        r....r....
-00003220: 7204 0000 00e9 0300 0000 7227 0000 0072  r.........r'...r
-00003230: 1400 0000 e909 0000 004e 725f 0000 005a  .........Nr_...Z
-00003240: 0372 6564 6700 0000 0000 00e8 3f29 0272  .redg.......?).r
-00003250: 6c00 0000 da05 616c 7068 615a 0462 6c75  l.....alphaZ.blu
-00003260: 655a 0567 7265 656e 5a04 6772 6179 7260  eZ.greenZ.grayr`
-00003270: 0000 00fa 1744 6973 7461 6e63 6520 616c  .....Distance al
-00003280: 6f6e 6720 582d 6178 6973 2028 fa01 29fa  ong X-axis (..).
-00003290: 1744 6973 7461 6e63 6520 616c 6f6e 6720  .Distance along 
-000032a0: 592d 6178 6973 2028 5429 2d72 3600 0000  Y-axis (T)-r6...
-000032b0: 7208 0000 0072 1700 0000 7252 0000 005a  r....r....rR...Z
-000032c0: 0663 6972 635f 315a 0663 6972 635f 3272  .circ_1Z.circ_2r
-000032d0: 3500 0000 722c 0000 0072 2d00 0000 722e  5...r,...r-...r.
-000032e0: 0000 0072 3900 0000 7232 0000 0072 3300  ...r9...r2...r3.
-000032f0: 0000 7234 0000 0072 1900 0000 5a08 696d  ..r4...r....Z.im
-00003300: 6167 655f 6674 da04 7363 6e64 da07 6669  age_ft..scnd..fi
-00003310: 6c74 6572 735a 0f67 6175 7373 6961 6e5f  ltersZ.gaussian_
-00003320: 6669 6c74 6572 da05 6c6f 6731 30da 0361  filter..log10..a
-00003330: 6273 7221 0000 0072 4f00 0000 da05 726f  bsr!...rO.....ro
-00003340: 756e 6472 6500 0000 5a08 7375 6270 6c6f  undre...Z.subplo
-00003350: 7473 5a06 4369 7263 6c65 7254 0000 0072  tsZ.CirclerT...r
-00003360: 6700 0000 726d 0000 00da 0678 7469 636b  g...rm.....xtick
-00003370: 73da 0679 7469 636b 73da 0678 6c61 6265  s..yticks..xlabe
-00003380: 6c72 5500 0000 da06 796c 6162 656c 7229  lrU.....ylabelr)
-00003390: 0000 00da 0367 7061 721b 0000 00da 0a67  .....gpar......g
-000033a0: 7665 635f 315f 696e 69da 0a67 7665 635f  vec_1_ini..gvec_
-000033b0: 325f 696e 6972 3b00 0000 724e 0000 00da  2_inir;...rN....
-000033c0: 0d50 5f6d 6174 7269 7831 5f69 6e69 da0d  .P_matrix1_ini..
-000033d0: 505f 6d61 7472 6978 325f 696e 6972 5700  P_matrix2_inirW.
-000033e0: 0000 2910 725a 0000 005a 0563 6972 6331  ..).rZ...Z.circ1
-000033f0: 5a05 6369 7263 3272 3500 0000 726e 0000  Z.circ2r5...rn..
-00003400: 005a 0a6c 6f67 5f61 6273 5f66 74da 0a70  .Z.log_abs_ft..p
-00003410: 6978 656c 5f6c 6973 74da 096e 6f5f 6c61  ixel_list..no_la
-00003420: 6265 6c73 da06 7374 6570 5f78 da0b 785f  bels..step_x..x_
-00003430: 706f 7369 7469 6f6e 73da 0878 5f6c 6162  positions..x_lab
-00003440: 656c 73da 015f 5a02 6178 5a09 6369 7263  els.._Z.axZ.circ
-00003450: 5f30 5f69 6d5a 0963 6972 635f 315f 696d  _0_imZ.circ_1_im
-00003460: 5a09 6369 7263 5f32 5f69 6d72 0e00 0000  Z.circ_2_imr....
-00003470: 720e 0000 0072 0f00 0000 da0a 6669 6e64  r....r......find
-00003480: 5f73 706f 7473 8f01 0000 734c 0000 0000  _spots....sL....
-00003490: 211c 011c 0106 0104 0122 ff06 031e 011c  !........"......
-000034a0: 0204 0112 0112 0104 fd04 0504 0116 0114  ................
-000034b0: 0116 0210 0116 0116 0116 010e 010a 010a  ................
-000034c0: 010a 010c 010c 0114 0114 0214 0114 0106  ................
-000034d0: 0110 ff06 0306 0110 ff06 037a 0e47 5041  ...........z.GPA
-000034e0: 2e66 696e 645f 7370 6f74 7372 6300 0000  .find_spotsrc...
-000034f0: 6307 0000 0000 0000 0000 0000 001c 0000  c...............
-00003500: 0008 0000 0043 0000 0073 2804 0000 7c00  .....C...s(...|.
-00003510: 6a00 730e 7401 6401 8301 8201 7402 a003  j.s.t.d.....t...
-00003520: 7c01 a101 7c00 6a04 1b00 7d07 7402 a003  |...|.j...}.t...
-00003530: 7c02 a101 7c00 6a04 1b00 7d08 7402 a003  |...|.j...}.t...
-00003540: 7c03 a101 7c00 6a04 1b00 7d09 7402 a003  |...|.j...}.t...
-00003550: 7c04 a101 7c00 6a04 1b00 7d0a 7402 6a05  |...|.j...}.t.j.
-00003560: 6402 7c00 6a06 6402 1900 8502 6402 7c00  d.|.j.d.....d.|.
-00003570: 6a06 6403 1900 8502 6602 1900 5c02 7d0b  j.d.....f...\.}.
-00003580: 7d0c 7402 a007 7c0b a101 7d0b 7402 a007  }.t...|...}.t...
-00003590: 7c0c a101 7d0c 7402 a003 7c0c 7c0b 6602  |...}.t...|.|.f.
-000035a0: a101 a008 a100 7c07 1800 7d0d 7402 a003  ......|...}.t...
-000035b0: 7c0c 7c0b 6602 a101 a008 a100 7c08 1800  |.|.f.......|...
-000035c0: 7d0e 7402 a003 7c0c 7c0b 6602 a101 a008  }.t...|.|.f.....
-000035d0: a100 7c09 1800 7d0f 7402 a003 7c0c 7c0b  ..|...}.t...|.|.
-000035e0: 6602 a101 a008 a100 7c0a 1800 7d10 7402  f.......|...}.t.
-000035f0: a009 7402 6a0a 7c0d 7c0e 1400 6403 6404  ..t.j.|.|...d.d.
-00003600: 8d02 7402 6a0a 7c0d 6405 1300 6403 6404  ..t.j.|.d...d.d.
-00003610: 8d02 6406 1300 7402 6a0a 7c0e 6405 1300  ..d...t.j.|.d...
-00003620: 6403 6404 8d02 6406 1300 1400 1b00 a101  d.d...d.........
-00003630: 7d11 7402 a009 7402 6a0a 7c0e 7c0f 1400  }.t...t.j.|.|...
-00003640: 6403 6404 8d02 7402 6a0a 7c0e 6405 1300  d.d...t.j.|.d...
-00003650: 6403 6404 8d02 6406 1300 7402 6a0a 7c0f  d.d...d...t.j.|.
-00003660: 6405 1300 6403 6404 8d02 6406 1300 1400  d...d.d...d.....
-00003670: 1b00 a101 7d12 7402 a009 7402 6a0a 7c0f  ....}.t...t.j.|.
-00003680: 7c10 1400 6403 6404 8d02 7402 6a0a 7c0f  |...d.d...t.j.|.
-00003690: 6405 1300 6403 6404 8d02 6406 1300 7402  d...d.d...d...t.
-000036a0: 6a0a 7c10 6405 1300 6403 6404 8d02 6406  j.|.d...d.d...d.
-000036b0: 1300 1400 1b00 a101 7d13 7402 a009 7402  ........}.t...t.
-000036c0: 6a0a 7c10 7c0d 1400 6403 6404 8d02 7402  j.|.|...d.d...t.
-000036d0: 6a0a 7c10 6405 1300 6403 6404 8d02 6406  j.|.d...d.d...d.
-000036e0: 1300 7402 6a0a 7c0d 6405 1300 6403 6404  ..t.j.|.d...d.d.
-000036f0: 8d02 6406 1300 1400 1b00 a101 7d14 7c11  ..d.........}.|.
-00003700: 7c12 1700 7c13 1700 7c14 1700 6405 7402  |...|...|...d.t.
-00003710: 6a0b 1400 1b00 a00c 7c00 6a0d 6a0e a101  j.......|.j.j...
-00003720: 7d15 7402 a00f 7c15 6403 a102 7c00 5f10  }.t...|.d...|._.
-00003730: 7402 a011 7c00 6a10 a101 7c00 5f10 7402  t...|.j...|._.t.
-00003740: a012 6402 7c00 6a04 7c00 6a06 6402 1900  ..d.|.j.|.j.d...
-00003750: 1400 7c00 6a04 a103 7d16 6407 7d17 7413  ..|.j...}.d.}.t.
-00003760: 7c00 6a06 6402 1900 7c17 6403 1800 1b00  |.j.d...|.d.....
-00003770: 8301 7d18 7402 a012 6402 7c00 6a06 6402  ..}.t...d.|.j.d.
-00003780: 1900 7c18 a103 7d19 7402 a014 7c16 6408  ..|...}.t...|.d.
-00003790: 6408 7c18 8503 1900 6403 a102 7d1a 7413  d.|.....d...}.t.
-000037a0: 6409 7402 a015 7402 a003 7c05 a101 a101  d.t...t...|.....
-000037b0: 1400 8301 7d1b 7416 640a 8301 0100 7417  ....}.t.d.....t.
-000037c0: 6a18 7c05 640b 8d01 0100 7417 6a19 7402  j.|.d.....t.j.t.
-000037d0: a011 741a 6a1b a01c 7c00 6a0d a101 640c  ..t.j...|.j...d.
-000037e0: 7c00 6a10 1400 1700 a101 640d 640e 640f  |.j.......d.d.d.
-000037f0: 8d03 0100 7417 6a1d 6410 741e 7c01 8301  ....t.j.d.t.|...
-00003800: 1700 7c07 7c00 6a06 1b00 6411 7c1b 7c06  ..|.|.j...d.|.|.
-00003810: 6412 8d05 0100 7417 6a1d 6413 741e 7c02  d.....t.j.d.t.|.
-00003820: 8301 1700 7c08 7c00 6a06 1b00 6411 7c1b  ....|.|.j...d.|.
-00003830: 7c06 6412 8d05 0100 7417 6a1d 6414 741e  |.d.....t.j.d.t.
-00003840: 7c03 8301 1700 7c09 7c00 6a06 1b00 6411  |.....|.|.j...d.
-00003850: 7c1b 7c06 6412 8d05 0100 7417 6a1d 6415  |.|.d.....t.j.d.
-00003860: 741e 7c04 8301 1700 7c0a 7c00 6a06 1b00  t.|.....|.|.j...
-00003870: 6411 7c1b 7c06 6412 8d05 0100 7417 6a1f  d.|.|.d.....t.j.
-00003880: 7c07 6402 1900 7c07 6403 1900 6416 6417  |.d...|.d...d.d.
-00003890: 8d03 0100 7417 6a1f 7c08 6402 1900 7c08  ....t.j.|.d...|.
-000038a0: 6403 1900 6416 6417 8d03 0100 7417 6a1f  d...d.d.....t.j.
-000038b0: 7c09 6402 1900 7c09 6403 1900 6416 6417  |.d...|.d...d.d.
-000038c0: 8d03 0100 7417 6a1f 7c0a 6402 1900 7c0a  ....t.j.|.d...|.
-000038d0: 6403 1900 6416 6417 8d03 0100 7417 6a20  d...d.d.....t.j 
-000038e0: 7c19 7c1a 7c1b 6418 8d03 0100 7417 6a21  |.|.|.d.....t.j!
-000038f0: 7c19 7c1a 7c1b 6418 8d03 0100 7417 6a22  |.|.|.d.....t.j"
-00003900: 6419 7c00 6a23 1700 641a 1700 7c1b 6418  d.|.j#..d...|.d.
-00003910: 8d02 0100 7417 6a24 641b 7c00 6a23 1700  ....t.j$d.|.j#..
-00003920: 641a 1700 7c1b 6418 8d02 0100 641c 7c00  d...|.d.....d.|.
-00003930: 5f25 6408 5300 291d 6148 0300 000a 2020  _%d.S.).aH....  
-00003940: 2020 2020 2020 4c6f 6361 7465 2074 6865        Locate the
-00003950: 2072 6566 6572 656e 6365 2069 6d61 6765   reference image
-00003960: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00003970: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00003980: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00003990: 2041 5f70 743a 2020 2074 7570 6c65 0a20   A_pt:   tuple. 
-000039a0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-000039b0: 6f70 206c 6566 7420 706f 7369 7469 6f6e  op left position
-000039c0: 206f 6620 7265 6665 7265 6e63 6520 7265   of reference re
-000039d0: 6769 6f6e 2069 6e20 2878 2c20 7929 0a20  gion in (x, y). 
-000039e0: 2020 2020 2020 2042 5f70 743a 2020 2074         B_pt:   t
-000039f0: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
-00003a00: 2020 2020 2054 6f70 2072 6967 6874 2070       Top right p
-00003a10: 6f73 6974 696f 6e20 6f66 2072 6566 6572  osition of refer
-00003a20: 656e 6365 2072 6567 696f 6e20 696e 2028  ence region in (
-00003a30: 782c 2079 290a 2020 2020 2020 2020 435f  x, y).        C_
-00003a40: 7074 3a20 2020 7475 706c 650a 2020 2020  pt:   tuple.    
-00003a50: 2020 2020 2020 2020 2020 2020 426f 7474              Bott
-00003a60: 6f6d 2072 6967 6874 2070 6f73 6974 696f  om right positio
-00003a70: 6e20 6f66 2072 6566 6572 656e 6365 2072  n of reference r
-00003a80: 6567 696f 6e20 696e 2028 782c 2079 290a  egion in (x, y).
-00003a90: 2020 2020 2020 2020 445f 7074 3a20 2020          D_pt:   
-00003aa0: 7475 706c 650a 2020 2020 2020 2020 2020  tuple.          
-00003ab0: 2020 2020 2020 426f 7474 6f6d 206c 6566        Bottom lef
-00003ac0: 7420 706f 7369 7469 6f6e 206f 6620 7265  t position of re
-00003ad0: 6665 7265 6e63 6520 7265 6769 6f6e 2069  ference region i
-00003ae0: 6e20 2878 2c20 7929 0a20 2020 2020 2020  n (x, y).       
-00003af0: 2069 6d73 697a 653a 2074 7570 6c65 2c20   imsize: tuple, 
-00003b00: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00003b10: 2020 2020 2020 2020 2053 697a 6520 696e           Size in
-00003b20: 2069 6e63 6865 7320 6f66 2074 6865 2069   inches of the i
-00003b30: 6d61 6765 2077 6974 6820 7468 650a 2020  mage with the.  
-00003b40: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00003b50: 6666 7261 6374 696f 6e20 7370 6f74 7320  ffraction spots 
-00003b60: 6d61 726b 6564 2e20 4465 6661 756c 7420  marked. Default 
-00003b70: 6973 0a20 2020 2020 2020 2020 2020 2020  is.             
-00003b80: 2020 2028 3130 2c20 3130 290a 2020 2020     (10, 10).    
-00003b90: 2020 2020 7443 6f6c 6f72 3a20 7374 722c      tColor: str,
-00003ba0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00003bb0: 2020 2020 2020 2020 2020 436f 6c6f 7220            Color 
-00003bc0: 6f66 2074 6865 2074 6578 7420 6f6e 2074  of the text on t
-00003bd0: 6865 2069 6d61 6765 0a0a 2020 2020 2020  he image..      
-00003be0: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
-00003bf0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4c6f  -----.        Lo
-00003c00: 6361 7465 7320 6120 7265 6665 7265 6e63  cates a referenc
-00003c10: 6520 7265 6769 6f6e 2062 6f75 6e64 6564  e region bounded
-00003c20: 2062 7920 7468 6520 666f 7572 2070 6f69   by the four poi
-00003c30: 6e74 7320 6769 7665 6e20 696e 0a20 2020  nts given in.   
-00003c40: 2020 2020 206c 656e 6774 6820 756e 6974       length unit
-00003c50: 732e 2043 686f 6f73 6520 7468 6520 706f  s. Choose the po
-00003c60: 696e 7473 2069 6e20 6120 636c 6f63 6b77  ints in a clockw
-00003c70: 6973 6520 6661 7368 696f 6e2e 0a20 2020  ise fashion..   
-00003c80: 2020 2020 207a 3950 6c65 6173 6520 6c6f       z9Please lo
-00003c90: 6361 7465 2074 6865 2064 6966 6672 6163  cate the diffrac
-00003ca0: 7469 6f6e 2073 706f 7473 2066 6972 7374  tion spots first
-00003cb0: 2061 7320 6669 6e64 5f73 706f 7473 2829   as find_spots()
-00003cc0: 7201 0000 0072 0400 0000 7205 0000 0072  r....r....r....r
-00003cd0: 1300 0000 7214 0000 0072 7200 0000 4e67  ....r....rr...Ng
-00003ce0: 0000 0000 0000 f83f 7a4e 4368 6f6f 7365  .......?zNChoose
-00003cf0: 2079 6f75 7220 706f 696e 7473 2069 6e20   your points in 
-00003d00: 6120 636c 6f63 6b77 6973 6520 6661 7368  a clockwise fash
-00003d10: 696f 6e2c 206f 7220 656c 7365 2079 6f75  ion, or else you
-00003d20: 2077 696c 6c20 6765 7420 6120 7772 6f6e   will get a wron
-00003d30: 6720 7265 7375 6c74 725f 0000 0067 1f85  g resultr_...g..
-00003d40: eb51 b81e d53f 5a05 6d61 676d 61da 056c  .Q...?Z.magma..l
-00003d50: 6f77 6572 2902 7261 0000 00da 066f 7269  ower).ra.....ori
-00003d60: 6769 6e7a 0241 3d7a 0d61 7865 7320 6672  ginz.A=z.axes fr
-00003d70: 6163 7469 6f6e 2903 5a0a 7465 7874 636f  action).Z.textco
-00003d80: 6f72 6473 da04 7369 7a65 726c 0000 007a  ords..sizerl...z
-00003d90: 0242 3d7a 0243 3d7a 0244 3dda 0172 2901  .B=z.C=z.D=..r).
-00003da0: da01 6329 01da 0866 6f6e 7473 697a 6572  ..c)...fontsizer
-00003db0: 7600 0000 7277 0000 0072 7800 0000 5429  v...rw...rx...T)
-00003dc0: 2672 5700 0000 7253 0000 0072 0800 0000  &rW...rS...r....
-00003dd0: 7217 0000 0072 4c00 0000 7228 0000 0072  r....rL...r(...r
-00003de0: 3600 0000 723d 0000 00da 0974 7261 6e73  6...r=.....trans
-00003df0: 706f 7365 5a06 6172 6363 6f73 722f 0000  poseZ.arccosr/..
-00003e00: 0072 2300 0000 da07 7265 7368 6170 6572  .r#.....reshaper
-00003e10: 1900 0000 720b 0000 00da 0769 7363 6c6f  ....r......isclo
-00003e20: 7365 da07 7265 665f 7265 675a 0666 6c69  se..ref_regZ.fli
-00003e30: 7075 6472 2100 0000 724f 0000 0072 7d00  pudr!...rO...r}.
-00003e40: 0000 7251 0000 00da 0570 7269 6e74 7265  ..rQ.....printre
-00003e50: 0000 0072 6600 0000 7267 0000 0072 2900  ...rf...rg...r).
-00003e60: 0000 722a 0000 005a 1069 6d61 6765 5f6e  ..r*...Z.image_n
-00003e70: 6f72 6d61 6c69 7a65 725a 0861 6e6e 6f74  ormalizerZ.annot
-00003e80: 6174 65da 0373 7472 5a07 7363 6174 7465  ate..strZ.scatte
-00003e90: 7272 7e00 0000 727f 0000 0072 8000 0000  rr~...r....r....
-00003ea0: 724d 0000 0072 8100 0000 7258 0000 0029  rM...r....rX...)
-00003eb0: 1c72 5a00 0000 5a04 415f 7074 5a04 425f  .rZ...Z.A_ptZ.B_
-00003ec0: 7074 5a04 435f 7074 5a04 445f 7074 726e  ptZ.C_ptZ.D_ptrn
-00003ed0: 0000 005a 0674 436f 6c6f 72da 0141 da01  ...Z.tColor..A..
-00003ee0: 42da 0143 da01 4472 3700 0000 7238 0000  B..C..Dr7...r8..
-00003ef0: 005a 0470 7441 415a 0470 7442 425a 0470  .Z.ptAAZ.ptBBZ.p
-00003f00: 7443 435a 0470 7444 445a 0761 6e67 4141  tCCZ.ptDDZ.angAA
-00003f10: 4242 5a07 616e 6742 4243 435a 0761 6e67  BBZ.angBBCCZ.ang
-00003f20: 4343 4444 5a07 616e 6744 4441 415a 0661  CCDDZ.angDDAAZ.a
-00003f30: 6e67 7375 6d72 8700 0000 7288 0000 0072  ngsumr....r....r
-00003f40: 8900 0000 728a 0000 0072 8b00 0000 da05  ....r....r......
-00003f50: 6673 697a 6572 0e00 0000 720e 0000 0072  fsizer....r....r
-00003f60: 0f00 0000 da10 6465 6669 6e65 5f72 6566  ......define_ref
-00003f70: 6572 656e 6365 da01 0000 73c8 0000 0000  erence....s.....
-00003f80: 1a06 0102 0102 ff04 0410 0110 0110 0110  ................
-00003f90: 0226 010a 010a 0116 0116 0116 0116 0104  .&..............
-00003fa0: 0110 0214 0114 ff02 fe02 ff04 0704 0110  ................
-00003fb0: 0214 0114 ff02 fe02 ff04 0704 0110 0214  ................
-00003fc0: 0114 ff02 fe02 ff04 0704 0110 0214 0114  ................
-00003fd0: ff02 fe02 ff04 071a 0106 ff04 030e 010e  ................
-00003fe0: 021c 0104 0116 0114 0116 0118 0202 0102  ................
-00003ff0: ff04 040c 0104 011c 0102 0102 fd06 0504  ................
-00004000: 010a 0108 0102 0102 0102 fb06 0704 010a  ................
-00004010: 0108 0102 0102 0102 fb06 0704 010a 0108  ................
-00004020: 0102 0102 0102 fb06 0704 010a 0108 0102  ................
-00004030: 0102 0102 fb06 0718 0118 0118 0118 0110  ................
-00004040: 0110 0118 0118 017a 1447 5041 2e64 6566  .......z.GPA.def
-00004050: 696e 655f 7265 6665 7265 6e63 6563 0100  ine_referencec..
-00004060: 0000 0000 0000 0000 0000 0e00 0000 0900  ................
-00004070: 0000 4300 0000 73ba 0100 007c 006a 0073  ..C...s....|.j.s
-00004080: 0e74 0164 0183 0182 0174 026a 037c 006a  .t.d.....t.j.|.j
-00004090: 0464 0219 000b 0064 031b 007c 006a 0464  .d.....d...|.j.d
-000040a0: 0219 0064 031b 0064 0464 058d 037d 0174  ...d...d.d...}.t
-000040b0: 026a 037c 006a 0464 0419 000b 0064 031b  .j.|.j.d.....d..
-000040c0: 007c 006a 0464 0419 0064 031b 0064 0464  .|.j.d...d...d.d
-000040d0: 058d 037d 0274 02a0 057c 027c 01a1 025c  ...}.t...|.|...\
-000040e0: 027d 037d 047c 006a 067c 005f 077c 006a  .}.}.|.j.|._.|.j
-000040f0: 087c 005f 097c 006a 0a7c 005f 0b7c 006a  .|._.|.j.|._.|.j
-00004100: 0c7c 005f 0d74 0e74 0f7c 006a 1083 0183  .|._.t.t.|.j....
-00004110: 0144 0090 015d 147d 0574 116a 12a0 137c  .D...].}.t.j...|
-00004120: 006a 0ba1 015c 027d 067d 0774 116a 12a0  .j...\.}.}.t.j..
-00004130: 137c 006a 0da1 015c 027d 087d 097c 067c  .|.j...\.}.}.|.|
-00004140: 0717 0064 0374 026a 1414 001b 007d 0a7c  ...d.t.j.....}.|
-00004150: 087c 0917 0064 0374 026a 1414 001b 007d  .|...d.t.j.....}
-00004160: 0b74 02a0 1574 02a0 167c 0a7c 006a 1719  .t...t...|.|.j..
-00004170: 007c 047c 006a 1719 001b 00a1 0174 02a0  .|.|.j.......t..
-00004180: 167c 0a7c 006a 1719 007c 037c 006a 1719  .|.|.j...|.|.j..
-00004190: 001b 00a1 0166 02a1 017d 0c74 02a0 1574  .....f...}.t...t
-000041a0: 02a0 167c 0b7c 006a 1719 007c 047c 006a  ...|.|.j...|.|.j
-000041b0: 1719 001b 00a1 0174 02a0 167c 0b7c 006a  .......t...|.|.j
-000041c0: 1719 007c 037c 006a 1719 001b 00a1 0166  ...|.|.j.......f
-000041d0: 02a1 017d 0d7c 0004 006a 077c 0c37 0002  ...}.|...j.|.7..
-000041e0: 005f 077c 0004 006a 097c 0d37 0002 005f  ._.|...j.|.7..._
-000041f0: 0974 116a 12a0 187c 006a 077c 006a 197c  .t.j...|.j.|.j.|
-00004200: 006a 1a7c 006a 1ba1 047c 005f 0b74 116a  .j.|.j...|._.t.j
-00004210: 12a0 187c 006a 097c 006a 197c 006a 1a7c  ...|.j.|.j.|.j.|
-00004220: 006a 1ba1 047c 005f 0d71 9864 067c 005f  .j...|._.q.d.|._
-00004230: 1c64 0753 0029 0861 8601 0000 0a20 2020  .d.S.).a.....   
-00004240: 2020 2020 2052 6566 696e 6520 7468 6520       Refine the 
-00004250: 7068 6173 6520 6d61 7472 6963 6573 2061  phase matrices a
-00004260: 6e64 2074 6865 2047 2076 6563 746f 7273  nd the G vectors
-00004270: 0a20 2020 2020 2020 2066 726f 6d20 7468  .        from th
-00004280: 6569 7220 696e 6974 6961 6c20 7661 6c75  eir initial valu
-00004290: 6573 2075 7369 6e67 2074 6865 2072 6566  es using the ref
-000042a0: 6572 656e 6365 0a20 2020 2020 2020 2072  erence.        r
-000042b0: 6567 696f 6e20 6c6f 6361 7469 6f6e 2e0a  egion location..
-000042c0: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-000042d0: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
-000042e0: 2020 2020 2049 7465 7261 7469 7665 6c79       Iteratively
-000042f0: 2072 6566 696e 6520 7468 6520 4720 7665   refine the G ve
-00004300: 6374 6f72 2061 6e64 2074 6865 2070 6861  ctor and the pha
-00004310: 7365 206d 6174 7269 6365 732c 0a20 2020  se matrices,.   
-00004320: 2020 2020 2073 6f20 7468 6174 2074 6865       so that the
-00004330: 2070 6861 7365 2076 6172 6961 7469 6f6e   phase variation
-00004340: 2069 6e20 7468 6520 7265 6665 7265 6e63   in the referenc
-00004350: 6520 7265 6769 6f6e 2069 730a 2020 2020  e region is.    
-00004360: 2020 2020 6d69 6e69 6d69 7a65 642e 0a0a      minimized...
-00004370: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00004380: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00004390: 2d0a 2020 2020 2020 2020 7068 6173 655f  -.        phase_
-000043a0: 6469 6666 0a20 2020 2020 2020 2070 6861  diff.        pha
-000043b0: 7365 5f6d 6174 7269 780a 2020 2020 2020  se_matrix.      
-000043c0: 2020 7a3e 506c 6561 7365 206c 6f63 6174    z>Please locat
-000043d0: 6520 7468 6520 7265 6665 7265 6e63 6520  e the reference 
-000043e0: 7265 6769 6f6e 2066 6972 7374 2061 7320  region first as 
-000043f0: 6465 6669 6e65 5f72 6566 6572 656e 6365  define_reference
-00004400: 2829 7201 0000 0072 1300 0000 7204 0000  ()r....r....r...
-00004410: 0072 1d00 0000 544e 291d 7258 0000 0072  .r....TN).rX...r
-00004420: 5300 0000 7208 0000 0072 2100 0000 7236  S...r....r!...r6
-00004430: 0000 0072 2200 0000 7283 0000 00da 0a67  ...r"...r......g
-00004440: 7665 635f 315f 6669 6e72 8400 0000 da0a  vec_1_finr......
-00004450: 6776 6563 5f32 5f66 696e 7285 0000 00da  gvec_2_finr.....
-00004460: 0d50 5f6d 6174 7269 7831 5f66 696e 7286  .P_matrix1_finr.
-00004470: 0000 005a 0d50 5f6d 6174 7269 7832 5f66  ...Z.P_matrix2_f
-00004480: 696e da05 7261 6e67 6572 4f00 0000 7250  in..rangerO...rP
-00004490: 0000 0072 2900 0000 7282 0000 0072 1000  ...r)...r....r..
-000044a0: 0000 7223 0000 0072 1700 0000 da06 6d65  ..r#...r......me
-000044b0: 6469 616e 7297 0000 0072 3b00 0000 7219  dianr....r;...r.
-000044c0: 0000 0072 3500 0000 724e 0000 0072 5900  ...r5...rN...rY.
-000044d0: 0000 290e 725a 0000 005a 0272 79da 0272  ..).rZ...Z.ry..r
-000044e0: 7872 2400 0000 7225 0000 0072 8c00 0000  xr$...r%...r....
-000044f0: 5a04 4731 5f78 5a04 4731 5f79 5a04 4732  Z.G1_xZ.G1_yZ.G2
-00004500: 5f78 5a04 4732 5f79 5a04 6731 5f72 5a04  _xZ.G2_yZ.g1_rZ.
-00004510: 6732 5f72 5a06 6465 6c5f 6731 5a06 6465  g2_rZ.del_g1Z.de
-00004520: 6c5f 6732 720e 0000 0072 0e00 0000 720f  l_g2r....r....r.
-00004530: 0000 00da 0c72 6566 696e 655f 7068 6173  .....refine_phas
-00004540: 655e 0200 0073 4600 0000 0011 0601 0201  e^...sF.........
-00004550: 02ff 0403 2601 2601 1001 0801 0801 0801  ....&.&.........
-00004560: 0801 1401 1201 1201 1201 1201 0402 1801  ................
-00004570: 18fe 02ff 0406 0402 1801 18fe 02ff 0406  ................
-00004580: 0e01 0e01 0601 10ff 0603 0601 10ff 0803  ................
-00004590: 7a10 4750 412e 7265 6669 6e65 5f70 6861  z.GPA.refine_pha
-000045a0: 7365 6301 0000 0000 0000 0000 0000 000a  sec.............
-000045b0: 0000 0007 0000 0043 0000 0073 6602 0000  .......C...sf...
-000045c0: 7c00 6a00 730e 7401 6401 8301 8201 7402  |.j.s.t.d.....t.
-000045d0: 6a03 6402 7402 6a04 6403 8d02 7d01 7402  j.d.t.j.d...}.t.
-000045e0: a005 7402 a006 7c00 6a07 a101 a101 7c01  ..t...|.j.....|.
-000045f0: 6404 6405 6405 8502 6602 3c00 7402 a005  d.d.d...f.<.t...
-00004600: 7402 a006 7c00 6a08 a101 a101 7c01 6406  t...|.j.....|.d.
-00004610: 6405 6405 8502 6602 3c00 7402 6a09 a00a  d.d...f.<.t.j...
-00004620: 7402 a00b 7c01 a101 a101 7c00 5f0c 740d  t...|.....|._.t.
-00004630: a00e 7c00 6a0f a101 7d02 740d a00e 7c00  ..|.j...}.t...|.
-00004640: 6a0f a101 7d03 7402 a006 7402 a010 7c02  j...}.t...t...|.
-00004650: 6407 a102 7402 a010 7c03 6407 a102 6602  d...t...|.d...f.
-00004660: a101 7d04 7402 a011 7c00 6a0c 7c04 a102  ..}.t...|.j.|...
-00004670: 7d05 7402 a010 7c05 6404 6405 6405 8502  }.t...|.d.d.d...
-00004680: 6602 1900 7c02 6a12 a102 7d06 7402 a010  f...|.j...}.t...
-00004690: 7c05 6406 6405 6405 8502 6602 1900 7c03  |.d.d.d...f...|.
-000046a0: 6a12 a102 7d07 7413 6a14 a015 7c06 a101  j...}.t.j...|...
-000046b0: 5c02 7c00 5f16 7d08 7413 6a14 a015 7c07  \.|._.}.t.j...|.
-000046c0: a101 5c02 7d09 7c00 5f17 6408 7c08 7c09  ..\.}.|._.d.|.|.
-000046d0: 1800 1400 7c00 5f18 6408 7c08 7c09 1700  ....|._.d.|.|...
-000046e0: 1400 7c00 5f19 7c00 0400 6a17 7402 a01a  ..|._.|...j.t...
-000046f0: 7c00 6a17 7c00 6a1b 1900 a101 3800 0200  |.j.|.j.....8...
-00004700: 5f17 7c00 0400 6a19 7402 a01a 7c00 6a19  _.|...j.t...|.j.
-00004710: 7c00 6a1b 1900 a101 3800 0200 5f19 7c00  |.j.....8..._.|.
-00004720: 0400 6a18 7402 a01a 7c00 6a18 7c00 6a1b  ..j.t...|.j.|.j.
-00004730: 1900 a101 3800 0200 5f18 7c00 0400 6a16  ....8..._.|...j.
-00004740: 7402 a01a 7c00 6a16 7c00 6a1b 1900 a101  t...|.j.|.j.....
-00004750: 3800 0200 5f16 7c00 6a1c 6404 6b04 9002  8..._.|.j.d.k...
-00004760: 7252 7c00 6a1c 7c00 6a17 7c00 6a17 7c00  rR|.j.|.j.|.j.|.
-00004770: 6a1c 6b04 3c00 7c00 6a1c 0b00 7c00 6a17  j.k.<.|.j...|.j.
-00004780: 7c00 6a17 7c00 6a1c 0b00 6b00 3c00 7c00  |.j.|.j...k.<.|.
-00004790: 6a1c 7c00 6a19 7c00 6a19 7c00 6a1c 6b04  j.|.j.|.j.|.j.k.
-000047a0: 3c00 7c00 6a1c 0b00 7c00 6a19 7c00 6a19  <.|.j...|.j.|.j.
-000047b0: 7c00 6a1c 0b00 6b00 3c00 7c00 6a1c 7c00  |.j...k.<.|.j.|.
-000047c0: 6a18 7c00 6a18 7c00 6a1c 6b04 3c00 7c00  j.|.j.|.j.k.<.|.
-000047d0: 6a1c 0b00 7c00 6a18 7c00 6a18 7c00 6a1c  j...|.j.|.j.|.j.
-000047e0: 0b00 6b00 3c00 7c00 6a1c 7c00 6a16 7c00  ..k.<.|.j.|.j.|.
-000047f0: 6a16 7c00 6a1c 6b04 3c00 7c00 6a1c 0b00  j.|.j.k.<.|.j...
-00004800: 7c00 6a16 7c00 6a16 7c00 6a1c 0b00 6b00  |.j.|.j.|.j...k.
-00004810: 3c00 7c00 6a16 7c00 6a17 7c00 6a18 7c00  <.|.j.|.j.|.j.|.
-00004820: 6a19 6604 5300 2909 61e5 0200 000a 2020  j.f.S.).a.....  
-00004830: 2020 2020 2020 5573 6520 7468 6520 7265        Use the re
-00004840: 6669 6e65 6420 7068 6173 6520 6d61 7472  fined phase matr
-00004850: 6978 2061 6e64 2067 2076 6563 746f 7273  ix and g vectors
-00004860: 2074 6f20 6361 6c63 756c 6174 650a 2020   to calculate.  
-00004870: 2020 2020 2020 7468 6520 7374 7261 696e        the strain
-00004880: 206d 6174 7269 6365 732e 0a0a 2020 2020   matrices...    
-00004890: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000048a0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000048b0: 2020 2020 655f 7878 3a20 6e64 6172 7261      e_xx: ndarra
-000048c0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-000048d0: 5374 7261 696e 2061 6c6f 6e67 2058 2064  Strain along X d
-000048e0: 6972 6563 7469 6f6e 0a20 2020 2020 2020  irection.       
-000048f0: 2065 5f79 793a 206e 6461 7272 6179 0a20   e_yy: ndarray. 
-00004900: 2020 2020 2020 2020 2020 2020 2053 7472               Str
-00004910: 6169 6e20 616c 6f6e 6720 5920 6469 7265  ain along Y dire
-00004920: 6374 696f 6e0a 2020 2020 2020 2020 655f  ction.        e_
-00004930: 7468 3a20 6e64 6172 7261 790a 2020 2020  th: ndarray.    
-00004940: 2020 2020 2020 2020 2020 526f 7461 7469            Rotati
-00004950: 6f6e 616c 2073 7472 6169 6e0a 2020 2020  onal strain.    
-00004960: 2020 2020 655f 6467 3a20 6e64 6172 7261      e_dg: ndarra
-00004970: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00004980: 4469 6167 6f6e 616c 2053 7472 6169 6e0a  Diagonal Strain.
-00004990: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-000049a0: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
-000049b0: 2020 2020 2055 7365 2074 6865 2072 6566       Use the ref
-000049c0: 696e 6564 2047 2076 6563 746f 7273 2074  ined G vectors t
-000049d0: 6f20 6765 6e65 7261 7465 2061 206d 6174  o generate a mat
-000049e0: 7269 780a 2020 2020 2020 2020 6f66 2074  rix.        of t
-000049f0: 6865 206c 6174 7469 6365 2070 6172 616d  he lattice param
-00004a00: 6574 6572 732c 2077 6869 6368 2069 7320  eters, which is 
-00004a10: 7374 6f72 6564 2061 7320 7468 650a 2020  stored as the.  
-00004a20: 2020 2020 2020 636c 6173 7320 6174 7472        class attr
-00004a30: 6962 7574 6520 6061 5f6d 6174 7269 7860  ibute `a_matrix`
-00004a40: 2e20 5468 6973 2069 7320 6d75 6c74 6970  . This is multip
-00004a50: 6c69 6564 2062 7920 7468 650a 2020 2020  lied by the.    
-00004a60: 2020 2020 7265 6669 6e65 6420 7068 6173      refined phas
-00004a70: 6520 6d61 7472 6978 2c20 616e 6420 7468  e matrix, and th
-00004a80: 6520 6d75 6c74 6970 6c69 6361 6e64 2069  e multiplicand i
-00004a90: 7320 7375 6273 6571 7565 6e74 6c79 0a20  s subsequently. 
-00004aa0: 2020 2020 2020 2064 6966 6665 7265 6e74         different
-00004ab0: 6961 7465 6420 746f 2067 6574 2074 6865  iated to get the
-00004ac0: 2073 7472 6169 6e20 7061 7261 6d65 7465   strain paramete
-00004ad0: 7273 2e0a 0a20 2020 2020 2020 2053 6565  rs...        See
-00004ae0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00004af0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-00004b00: 6861 7365 5f64 6966 660a 2020 2020 2020  hase_diff.      
-00004b10: 2020 7a3d 506c 6561 7365 2072 6566 696e    z=Please refin
-00004b20: 6520 7468 6520 7068 6173 6520 616e 6420  e the phase and 
-00004b30: 6720 7665 6374 6f72 7320 6669 7273 7420  g vectors first 
-00004b40: 6173 2072 6566 696e 655f 7068 6173 6528  as refine_phase(
-00004b50: 2972 3c00 0000 7203 0000 0072 0100 0000  )r<...r....r....
-00004b60: 4e72 0400 0000 7207 0000 0072 1400 0000  Nr....r....r....
-00004b70: 291d 7258 0000 0072 5300 0000 7208 0000  ).rX...rS...r...
-00004b80: 0072 0a00 0000 5a07 666c 6f61 7436 3472  .r....Z.float64r
-00004b90: 1600 0000 7217 0000 0072 a000 0000 72a1  ....r....r....r.
-00004ba0: 0000 005a 066c 696e 616c 67da 0369 6e76  ...Z.linalg..inv
-00004bb0: 7294 0000 0072 4000 0000 da03 736b 725a  r....r@.....skrZ
-00004bc0: 0c75 6e77 7261 705f 7068 6173 6572 a200  .unwrap_phaser..
-00004bd0: 0000 7295 0000 0072 3f00 0000 720b 0000  ..r....r?...r...
-00004be0: 0072 2900 0000 7282 0000 0072 1000 0000  .r)...r....r....
-00004bf0: 7241 0000 0072 4400 0000 7246 0000 0072  rA...rD...rF...r
-00004c00: 4700 0000 72a4 0000 0072 9700 0000 7256  G...r....r....rV
-00004c10: 0000 0029 0a72 5a00 0000 7226 0000 005a  ...).rZ...r&...Z
-00004c20: 0250 315a 0250 325a 0872 6f6c 6c65 645f  .P1Z.P2Z.rolled_
-00004c30: 705a 0875 5f6d 6174 7269 785a 0375 5f78  pZ.u_matrixZ.u_x
-00004c40: 5a03 755f 7972 4200 0000 7243 0000 0072  Z.u_yrB...rC...r
-00004c50: 0e00 0000 720e 0000 0072 0f00 0000 da0a  ....r....r......
-00004c60: 6765 745f 7374 7261 696e 9502 0000 7340  get_strain....s@
-00004c70: 0000 0000 1c06 0102 0102 ff04 0310 011e  ................
-00004c80: 011e 0114 010c 010c 011e 010e 011a 011a  ................
-00004c90: 0112 0112 010e 010e 011c 011c 011c 011c  ................
-00004ca0: 020c 0114 0118 0114 0118 0114 0118 0114  ................
-00004cb0: 0118 017a 0e47 5041 2e67 6574 5f73 7472  ...z.GPA.get_str
-00004cc0: 6169 6e72 0100 0000 6303 0000 0000 0000  ainr....c.......
-00004cd0: 0000 0000 0014 0000 000a 0000 0043 0000  .............C..
-00004ce0: 0073 f003 0000 7400 7c02 8301 7d03 7c01  .s....t.|...}.|.
-00004cf0: 6401 6b02 7240 6402 7401 a002 7401 a003  d.k.r@d.t...t...
-00004d00: 7401 6a04 7c00 6a05 7c00 6a06 7c00 6a07  t.j.|.j.|.j.|.j.
-00004d10: 7c00 6a08 6604 6403 6404 8d02 a101 a101  |.j.f.d.d.......
-00004d20: 1400 7d04 6e04 7c01 7d04 6405 7c03 6406  ..}.n.|.}.d.|.d.
-00004d30: 9c02 7d05 7409 6a0a 642b 6900 7c05 a401  ..}.t.j.d+i.|...
-00004d40: 8e01 0100 7400 7c02 8301 7400 7c02 6408  ....t.|...t.|.d.
-00004d50: 1400 8301 6602 7d06 740b 6a0c 7c06 6409  ....f.}.t.j.|.d.
-00004d60: 8d01 0100 740d a00e 640a 640b a102 7d07  ....t...d.d...}.
-00004d70: 740b a00f 7c07 6401 640c 8502 6401 640c  t...|.d.d...d.d.
-00004d80: 8502 6602 1900 a101 7d08 740b a00f 7c07  ..f.....}.t...|.
-00004d90: 6401 640c 8502 640c 640b 8502 6602 1900  d.d...d.d...f...
-00004da0: a101 7d09 740b a00f 7c07 640c 640b 8502  ..}.t...|.d.d...
-00004db0: 6401 640c 8502 6602 1900 a101 7d0a 740b  d.d...f.....}.t.
-00004dc0: a00f 7c07 640c 640b 8502 640c 640b 8502  ..|.d.d...d.d...
-00004dd0: 6602 1900 a101 7d0b 740b a00f 7c07 640b  f.....}.t...|.d.
-00004de0: 640a 8502 640d 640d 8502 6602 1900 a101  d...d.d...f.....
-00004df0: 7d0c 7c08 6a10 640e 7c00 6a06 1400 7c04  }.|.j.d.|.j...|.
-00004e00: 0b00 7c04 640f 6410 8d04 0100 7411 a012  ..|.d.d.....t...
-00004e10: 7c00 6a13 7c00 6a14 a102 7d0d 6411 7c0d  |.j.|.j...}.d.|.
-00004e20: 5f15 6403 7c0d 5f16 6412 7c0d 5f17 7c08  _.d.|._.d.|._.|.
-00004e30: a018 7c0d a101 0100 7419 6a1a 6413 741b  ..|.....t.j.d.t.
-00004e40: 7c03 6414 8d01 6415 6416 6417 8d04 7d0e  |.d...d.d.d...}.
-00004e50: 7c0e 6a1c a01d 6418 a101 0100 7c08 a018  |.j...d.....|...
-00004e60: 7c0e a101 0100 7c08 a01e 6419 a101 0100  |.....|...d.....
-00004e70: 7c09 6a10 640e 7c00 6a07 1400 7c04 0b00  |.j.d.|.j...|...
-00004e80: 7c04 640f 6410 8d04 0100 7411 a012 7c00  |.d.d.....t...|.
-00004e90: 6a13 7c00 6a14 a102 7d0d 6411 7c0d 5f15  j.|.j...}.d.|._.
-00004ea0: 6403 7c0d 5f16 6412 7c0d 5f17 7c09 a018  d.|._.d.|._.|...
-00004eb0: 7c0d a101 0100 7419 6a1a 641a 741b 7c03  |.....t.j.d.t.|.
-00004ec0: 6414 8d01 6415 6416 6417 8d04 7d0e 7c0e  d...d.d.d...}.|.
-00004ed0: 6a1c a01d 6418 a101 0100 7c09 a018 7c0e  j...d.....|...|.
-00004ee0: a101 0100 7c09 a01e 6419 a101 0100 7c0a  ....|...d.....|.
-00004ef0: 6a10 640e 7c00 6a08 1400 7c04 0b00 7c04  j.d.|.j...|...|.
-00004f00: 640f 6410 8d04 0100 7411 a012 7c00 6a13  d.d.....t...|.j.
-00004f10: 7c00 6a14 a102 7d0d 6411 7c0d 5f15 6403  |.j...}.d.|._.d.
-00004f20: 7c0d 5f16 6412 7c0d 5f17 7c0a a018 7c0d  |._.d.|._.|...|.
-00004f30: a101 0100 7419 6a1a 641b 741b 7c03 6414  ....t.j.d.t.|.d.
-00004f40: 8d01 6415 6416 6417 8d04 7d0e 7c0e 6a1c  ..d.d.d...}.|.j.
-00004f50: a01d 6418 a101 0100 7c0a a018 7c0e a101  ..d.....|...|...
-00004f60: 0100 7c0a a01e 6419 a101 0100 7c0b 6a10  ..|...d.....|.j.
-00004f70: 640e 7c00 6a05 1400 7c04 0b00 7c04 640f  d.|.j...|...|.d.
-00004f80: 6410 8d04 0100 7411 a012 7c00 6a13 7c00  d.....t...|.j.|.
-00004f90: 6a14 a102 7d0d 6411 7c0d 5f15 6403 7c0d  j...}.d.|._.d.|.
-00004fa0: 5f16 6412 7c0d 5f17 7c0b a018 7c0d a101  _.d.|._.|...|...
-00004fb0: 0100 7419 6a1a 641c 741b 7c03 6414 8d01  ..t.j.d.t.|.d...
-00004fc0: 6415 6416 6417 8d04 7d0e 7c0e 6a1c a01d  d.d.d...}.|.j...
-00004fd0: 6418 a101 0100 7c0b a018 7c0e a101 0100  d.....|...|.....
-00004fe0: 7c0b a01e 6419 a101 0100 7401 6a1f 641d  |...d.....t.j.d.
-00004ff0: 7401 6a20 641e 8d02 7d0f 7421 640b 8301  t.j d...}.t!d...
-00005000: 4400 5d22 7d10 7401 a022 7c04 0b00 7c04  D.]"}.t.."|...|.
-00005010: 641f a103 7c0f 7c10 640d 640d 8502 6602  d...|.|.d.d...f.
-00005020: 3c00 9003 711c 7c0c 6a10 7c0f 640f 6420  <...q.|.j.|.d.d 
-00005030: 8d02 0100 7c0c 6a23 a024 6421 a101 0100  ....|.j#.$d!....
-00005040: 6422 7d11 7401 a022 6401 641f 7c11 a103  d"}.t.."d.d.|...
-00005050: 7d12 7c0c a025 7c12 a101 0100 7c0c a026  }.|..%|.....|..&
-00005060: 7401 a027 7401 a022 7c04 0b00 7c04 7c11  t..'t.."|...|.|.
-00005070: a103 6423 a102 a101 0100 6424 4400 5d26  ..d#......d$D.]&
-00005080: 7d13 7c0c 6a28 7c13 1900 a029 6425 a101  }.|.j(|....)d%..
-00005090: 0100 7c0c 6a28 7c13 1900 a02a 6426 a101  ..|.j(|....*d&..
-000050a0: 0100 9003 7198 7c0c 6a2b 6a2c 6425 6427  ....q.|.j+j,d%d'
-000050b0: 6428 640b 6429 8d04 0100 7c0c 6a2d 642c  d(d.d)....|.j-d,
-000050c0: 6900 7c05 a401 8e01 0100 740b a02e a100  i.|.......t.....
-000050d0: 0100 640d 5300 292d 61b2 0200 000a 2020  ..d.S.)-a.....  
-000050e0: 2020 2020 2020 5573 6520 7468 6520 6361        Use the ca
-000050f0: 6c63 756c 6174 6564 2073 7472 6169 6e20  lculated strain 
-00005100: 6d61 7472 6963 6573 2074 6f20 706c 6f74  matrices to plot
-00005110: 2074 6865 2073 7472 6169 6e20 6d61 7073   the strain maps
-00005120: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00005130: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00005140: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005150: 6d76 616c 3a20 2020 2066 6c6f 6174 2c20  mval:    float, 
-00005160: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00005170: 2020 2020 2020 2020 2020 5468 6520 6d61            The ma
-00005180: 7869 6d75 6d20 7374 7261 696e 2076 616c  ximum strain val
-00005190: 7565 2074 6861 7420 7769 6c6c 2062 6520  ue that will be 
-000051a0: 706c 6f74 7465 642e 0a20 2020 2020 2020  plotted..       
-000051b0: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
-000051c0: 7420 6973 2030 2c20 7570 6f6e 2077 6869  t is 0, upon whi
-000051d0: 6368 2074 6865 206d 6178 696d 756d 2073  ch the maximum s
-000051e0: 7472 6169 6e0a 2020 2020 2020 2020 2020  train.          
-000051f0: 2020 2020 2020 2070 6572 6365 6e74 6167         percentag
-00005200: 6520 7769 6c6c 2062 6520 6361 6c63 756c  e will be calcul
-00005210: 6174 6564 2c20 7768 6963 6820 7769 6c6c  ated, which will
-00005220: 2062 6520 7573 6564 0a20 2020 2020 2020   be used.       
-00005230: 2020 2020 2020 2020 2020 666f 7220 706c            for pl
-00005240: 6f74 7469 6e67 2e0a 2020 2020 2020 2020  otting..        
-00005250: 696d 7769 6474 683a 2069 6e74 2c20 6f70  imwidth: int, op
-00005260: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00005270: 2020 2020 2020 2020 5369 7a65 2069 6e20          Size in 
-00005280: 696e 6368 6573 206f 6620 7468 6520 696d  inches of the im
-00005290: 6167 6520 7769 7468 2074 6865 0a20 2020  age with the.   
-000052a0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-000052b0: 6666 7261 6374 696f 6e20 7370 6f74 7320  ffraction spots 
-000052c0: 6d61 726b 6564 2e20 4465 6661 756c 7420  marked. Default 
-000052d0: 6973 2031 350a 0a20 2020 2020 2020 204e  is 15..        N
-000052e0: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-000052f0: 2d2d 0a20 2020 2020 2020 2055 7365 7320  --.        Uses 
-00005300: 606d 6174 706c 6f74 6c69 622e 6772 6964  `matplotlib.grid
-00005310: 7370 6563 6020 746f 2070 6c6f 7420 7468  spec` to plot th
-00005320: 6520 7374 7261 696e 206d 6170 7320 6f66  e strain maps of
-00005330: 2074 6865 0a20 2020 2020 2020 2066 6f75   the.        fou
-00005340: 7220 7479 7065 7320 6f66 2073 7472 6169  r types of strai
-00005350: 6e20 6361 6c63 756c 6174 6564 2074 6872  n calculated thr
-00005360: 6f75 6768 2067 656f 6d65 7472 6963 2070  ough geometric p
-00005370: 6861 7365 0a20 2020 2020 2020 2061 6e61  hase.        ana
-00005380: 6c79 7369 732e 0a20 2020 2020 2020 2072  lysis..        r
-00005390: 0100 0000 e964 0000 0072 0400 0000 7205  .....d...r....r.
-000053a0: 0000 005a 0462 6f6c 6429 02da 0677 6569  ...Z.bold)...wei
-000053b0: 6768 7472 9000 0000 da04 666f 6e74 679a  ghtr......fontg.
-000053c0: 9999 9999 99f1 3f72 5f00 0000 e90b 0000  ......?r_.......
-000053d0: 0072 7200 0000 e905 0000 004e 699c ffff  .rr........Ni...
-000053e0: ff5a 0652 6442 755f 7229 035a 0476 6d69  .Z.RdBu_r).Z.vmi
-000053f0: 6e5a 0476 6d61 7872 6100 0000 7262 0000  nZ.vmaxra...rb..
-00005400: 0072 6300 0000 7a18 245c 6d61 7468 726d  .rc...z.$\mathrm
-00005410: 7b5c 6570 7369 6c6f 6e5f 7b78 787d 7d24  {\epsilon_{xx}}$
-00005420: 2901 7290 0000 0054 7a0a 7570 7065 7220  ).r....Tz.upper 
-00005430: 6c65 6674 2903 da04 7072 6f70 5a07 6672  left)...propZ.fr
-00005440: 616d 656f 6eda 036c 6f63 7a22 726f 756e  ameon..locz"roun
-00005450: 642c 2070 6164 3d20 302e 2c20 726f 756e  d, pad= 0., roun
-00005460: 6469 6e67 5f73 697a 653d 2030 2e32 7264  ding_size= 0.2rd
-00005470: 0000 007a 1824 5c6d 6174 6872 6d7b 5c65  ...z.$\mathrm{\e
-00005480: 7073 696c 6f6e 5f7b 7879 7d7d 247a 1c24  psilon_{xy}}$z.$
-00005490: 5c6d 6174 6872 6d7b 5c65 7073 696c 6f6e  \mathrm{\epsilon
-000054a0: 5f7b 5c74 6865 7461 7d7d 247a 1824 5c6d  _{\theta}}$z.$\m
-000054b0: 6174 6872 6d7b 5c65 7073 696c 6f6e 5f7b  athrm{\epsilon_{
-000054c0: 7979 7d7d 2429 0272 7200 0000 e9e8 0300  yy}}$).rr.......
-000054d0: 0072 0300 0000 72b1 0000 0072 6000 0000  .r....r....r`...
-000054e0: 4672 7400 0000 e904 0000 0029 04da 0374  Frt........)...t
-000054f0: 6f70 5a06 626f 7474 6f6d da04 6c65 6674  opZ.bottom..left
-00005500: da05 7269 6768 7472 1300 0000 5a05 626c  ..rightr....Z.bl
-00005510: 6163 6be9 0600 0000 da03 6f75 7429 04da  ack.......out)..
-00005520: 0577 6964 7468 da06 6c65 6e67 7468 da09  .width..length..
-00005530: 6469 7265 6374 696f 6eda 0370 6164 fa0a  direction..pad..
-00005540: 5374 7261 696e 2028 2529 2901 72ac 0000  Strain (%)).r...
-00005550: 0029 0172 bc00 0000 292f 724f 0000 0072  .).r....)/rO...r
-00005560: 0800 0000 5a04 616d 6178 727c 0000 005a  ....Z.amaxr|...Z
-00005570: 0b63 6f6e 6361 7465 6e61 7465 7244 0000  .concatenaterD..
-00005580: 0072 4100 0000 7247 0000 0072 4600 0000  .rA...rG...rF...
-00005590: da03 6d70 6cda 0272 6372 6500 0000 7266  ..mpl..rcre...rf
-000055a0: 0000 00da 046d 7067 735a 0847 7269 6453  .....mpgsZ.GridS
-000055b0: 7065 635a 0773 7562 706c 6f74 7267 0000  pecZ.subplotrg..
-000055c0: 0072 6800 0000 7269 0000 0072 4c00 0000  .rh...ri...rL...
-000055d0: 724d 0000 0072 6a00 0000 726b 0000 0072  rM...rj...rk...r
-000055e0: 6c00 0000 726d 0000 00da 066d 706c 6f66  l...rm.....mplof
-000055f0: 665a 0c41 6e63 686f 7265 6454 6578 74da  fZ.AnchoredText.
-00005600: 0464 6963 745a 0570 6174 6368 5a0c 7365  .dictZ.patchZ.se
-00005610: 745f 626f 7873 7479 6c65 7206 0000 0072  t_boxstyler....r
-00005620: 0a00 0000 7231 0000 0072 a300 0000 5a08  ....r1...r....Z.
-00005630: 6c69 6e73 7061 6365 5a05 7961 7869 735a  linspaceZ.yaxisZ
-00005640: 0b73 6574 5f76 6973 6962 6c65 5a0a 7365  .set_visibleZ.se
-00005650: 745f 7874 6963 6b73 5a0f 7365 745f 7874  t_xticksZ.set_xt
-00005660: 6963 6b6c 6162 656c 7372 7d00 0000 5a06  icklabelsr}...Z.
-00005670: 7370 696e 6573 5a0d 7365 745f 6c69 6e65  spinesZ.set_line
-00005680: 7769 6474 685a 0973 6574 5f63 6f6c 6f72  widthZ.set_color
-00005690: 5a05 7861 7869 735a 0f73 6574 5f74 6963  Z.xaxisZ.set_tic
-000056a0: 6b5f 7061 7261 6d73 5a09 7365 745f 7469  k_paramsZ.set_ti
-000056b0: 746c 655a 0961 7574 6f73 6361 6c65 2914  tleZ.autoscale).
-000056c0: 725a 0000 005a 046d 7661 6c5a 0769 6d77  rZ...Z.mvalZ.imw
-000056d0: 6964 7468 7293 0000 005a 0276 6d5a 0773  idthr....Z.vmZ.s
-000056e0: 635f 666f 6e74 726e 0000 005a 0267 735a  c_fontrn...Z.gsZ
-000056f0: 0361 7831 5a03 6178 325a 0361 7833 5a03  .ax1Z.ax2Z.ax3Z.
-00005700: 6178 345a 0361 7835 726f 0000 00da 0261  ax4Z.ax5ro.....a
-00005710: 745a 0273 6272 4500 0000 7288 0000 00da  tZ.sbrE...r.....
-00005720: 0278 3172 0600 0000 720e 0000 0072 0e00  .x1r....r....r..
-00005730: 0000 720f 0000 00da 0f70 6c6f 745f 6770  ..r......plot_gp
-00005740: 615f 7374 7261 696e d302 0000 73ba 0000  a_strain....s...
-00005750: 0000 1508 0108 0106 0104 011c ff02 ff08  ................
-00005760: 0604 010a 0110 0114 020c 020c 011a 011a  ................
-00005770: 011a 011a 011a 021a 0110 0106 0106 0106  ................
-00005780: 010a 0104 0102 0108 0102 0102 fc06 060c  ................
-00005790: 010a 010a 021a 0110 0106 0106 0106 010a  ................
-000057a0: 0104 0102 0108 0102 0102 fc06 060c 010a  ................
-000057b0: 010a 021a 0110 0106 0106 0106 010a 0104  ................
-000057c0: 0102 0108 0102 0102 fc06 060c 010a 010a  ................
-000057d0: 021a 0110 0106 0106 0106 010a 0104 0102  ................
-000057e0: 0108 0102 0102 fc06 060c 010a 010a 0210  ................
-000057f0: 010c 0120 010e 010c 0104 010e 010a 011e  ... ............
-00005800: 0108 0110 0114 0114 0110 027a 1347 5041  ...........z.GPA
-00005810: 2e70 6c6f 745f 6770 615f 7374 7261 696e  .plot_gpa_strain
-00005820: 4e29 0372 4a00 0000 5472 4b00 0000 2902  N).rJ...TrK...).
-00005830: 725c 0000 0072 5e00 0000 2902 725d 0000  r\...r^...).r]..
-00005840: 0072 7100 0000 2902 7271 0000 0072 6300  .rq...).rq...rc.
-00005850: 0000 2902 7201 0000 0072 5d00 0000 290b  ..).r....r]...).
-00005860: da08 5f5f 6e61 6d65 5f5f da0a 5f5f 6d6f  ..__name__..__mo
-00005870: 6475 6c65 5f5f da0c 5f5f 7175 616c 6e61  dule__..__qualna
-00005880: 6d65 5f5f da07 5f5f 646f 635f 5f72 5b00  me__..__doc__r[.
-00005890: 0000 7270 0000 0072 8d00 0000 729f 0000  ..rp...r....r...
-000058a0: 0072 a600 0000 72a9 0000 0072 c400 0000  .r....r....r....
-000058b0: 720e 0000 0072 0e00 0000 720e 0000 0072  r....r....r....r
-000058c0: 0f00 0000 7249 0000 0026 0100 0073 1400  ....rI...&...s..
-000058d0: 0000 0801 0441 00ff 0a15 0a13 0a4b 0a7f  .....A.......K..
-000058e0: 0005 0837 083e 7249 0000 0029 0272 0100  ...7.>rI...).r..
-000058f0: 0000 5429 215a 056e 756d 7079 7208 0000  ..T)!Z.numpyr...
-00005900: 005a 1373 6b69 6d61 6765 2e72 6573 746f  .Z.skimage.resto
-00005910: 7261 7469 6f6e 5a0b 7265 7374 6f72 6174  rationZ.restorat
-00005920: 696f 6e72 a800 0000 5a0d 7363 6970 792e  ionr....Z.scipy.
-00005930: 6e64 696d 6167 655a 076e 6469 6d61 6765  ndimageZ.ndimage
-00005940: 7279 0000 005a 0a6d 6174 706c 6f74 6c69  ry...Z.matplotli
-00005950: 6272 bd00 0000 5a11 6d61 7470 6c6f 746c  br....Z.matplotl
-00005960: 6962 2e70 7970 6c6f 745a 0670 7970 6c6f  ib.pyplotZ.pyplo
-00005970: 7472 6500 0000 da08 7374 656d 746f 6f6c  tre.....stemtool
-00005980: 7229 0000 005a 146d 6174 706c 6f74 6c69  r)...Z.matplotli
-00005990: 622e 6f66 6673 6574 626f 785a 096f 6666  b.offsetboxZ.off
-000059a0: 7365 7462 6f78 72c0 0000 005a 136d 6174  setboxr....Z.mat
-000059b0: 706c 6f74 6c69 622e 6772 6964 7370 6563  plotlib.gridspec
-000059c0: 5a08 6772 6964 7370 6563 72bf 0000 005a  Z.gridspecr....Z
-000059d0: 1c6d 6174 706c 6f74 6c69 625f 7363 616c  .matplotlib_scal
-000059e0: 6562 6172 2e73 6361 6c65 6261 7272 6f00  ebar.scalebarro.
-000059f0: 0000 7268 0000 0072 1000 0000 7212 0000  ..rh...r....r...
-00005a00: 0072 1b00 0000 721c 0000 0072 2600 0000  .r....r....r&...
-00005a10: 723b 0000 0072 4800 0000 da06 6f62 6a65  r;...rH.....obje
-00005a20: 6374 7249 0000 0072 0e00 0000 720e 0000  ctrI...r....r...
-00005a30: 0072 0e00 0000 720f 0000 00da 083c 6d6f  .r....r......<mo
-00005a40: 6475 6c65 3e01 0000 0073 2000 0000 0801  dule>....s .....
-00005a50: 0c01 0c01 0801 0c01 0801 0c01 0c01 0c03  ................
-00005a60: 082c 081b 081b 081e 081b 0a44 083b       .,.........D.;
+00000600: 3062 7569 6c64 2f62 6469 7374 2e6c 696e  0build/bdist.lin
+00000610: 7578 2d78 3836 5f36 342f 6567 672f 7374  ux-x86_64/egg/st
+00000620: 656d 746f 6f6c 2f67 7061 2f67 7061 2e70  emtool/gpa/gpa.p
+00000630: 79da 0a70 6861 7365 5f64 6966 660c 0000  y..phase_diff...
+00000640: 0073 1600 0000 0e1f 1001 1e01 1001 1e01  .s..............
+00000650: 0a01 0c01 0c01 0a01 0a01 0801 7210 0000  ............r...
+00000660: 0063 0200 0000 0000 0000 0000 0000 0200  .c..............
+00000670: 0000 0700 0000 4300 0000 7318 0000 0074  ......C...s....t
+00000680: 00a0 0174 00a0 0264 017c 007c 0118 0014  ...t...d.|.|....
+00000690: 00a1 01a1 0153 0029 0261 0c02 0000 0a20  .....S.).a..... 
+000006a0: 2020 2053 7562 7472 6163 7420 6f6e 6520     Subtract one 
+000006b0: 636f 6d70 6c65 7820 7068 6173 6520 696d  complex phase im
+000006c0: 6167 6520 6672 6f6d 0a20 2020 2061 6e6f  age from.    ano
+000006d0: 7468 6572 2077 6974 686f 7574 2063 6175  ther without cau
+000006e0: 7369 6e67 2070 6861 7365 2077 7261 7070  sing phase wrapp
+000006f0: 696e 672e 0a0a 2020 2020 5061 7261 6d65  ing...    Parame
+00000700: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00000710: 2d2d 2d0a 2020 2020 6d61 7472 6978 5f31  ---.    matrix_1
+00000720: 3a20 206e 6461 7272 6179 0a20 2020 2020  :  ndarray.     
+00000730: 2020 2020 2020 2020 2020 4669 7273 7420            First 
+00000740: 7068 6173 6520 696d 6167 650a 2020 2020  phase image.    
+00000750: 6d61 7472 6978 5f32 3a20 206e 6461 7272  matrix_2:  ndarr
+00000760: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00000770: 2020 5365 636f 6e64 2070 6861 7365 2069    Second phase i
+00000780: 6d61 6765 0a0a 2020 2020 5265 7475 726e  mage..    Return
+00000790: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+000007a0: 2020 2020 2020 2020 2020 203a 206e 6461             : nda
+000007b0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+000007c0: 2020 2020 4469 6666 6572 656e 6365 206f      Difference o
+000007d0: 6620 7468 6520 7068 6173 6520 696d 6167  f the phase imag
+000007e0: 6573 0a0a 2020 2020 4e6f 7465 730a 2020  es..    Notes.  
+000007f0: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6520    -----.    The 
+00000800: 6261 7369 6320 6964 6561 206f 6620 7468  basic idea of th
+00000810: 6973 2069 7320 7468 6174 2077 6520 7375  is is that we su
+00000820: 6274 7261 6374 2074 6865 0a20 2020 2070  btract the.    p
+00000830: 6861 7365 2069 6d61 6765 7320 6672 6f6d  hase images from
+00000840: 2065 6163 6820 6f74 6865 722c 2074 6865   each other, the
+00000850: 6e20 7472 616e 7366 6f72 6d0a 2020 2020  n transform.    
+00000860: 7468 6174 2074 6f20 6120 636f 6d70 6c65  that to a comple
+00000870: 7820 7068 6173 652c 2061 6e64 2074 616b  x phase, and tak
+00000880: 6520 7468 6520 616e 676c 6520 6f66 0a20  e the angle of. 
+00000890: 2020 2074 6865 2063 6f6d 706c 6578 2069     the complex i
+000008a0: 6d61 6765 2e0a 2020 2020 7202 0000 0029  mage..    r....)
+000008b0: 0372 0800 0000 da05 616e 676c 6572 0900  .r......angler..
+000008c0: 0000 2902 5a08 6d61 7472 6978 5f31 5a08  ..).Z.matrix_1Z.
+000008d0: 6d61 7472 6978 5f32 720e 0000 0072 0e00  matrix_2r....r..
+000008e0: 0000 720f 0000 00da 0e70 6861 7365 5f73  ..r......phase_s
+000008f0: 7562 7472 6163 7438 0000 0073 0200 0000  ubtract8...s....
+00000900: 1818 7212 0000 0063 0200 0000 0000 0000  ..r....c........
+00000910: 0000 0000 0300 0000 0700 0000 4300 0000  ............C...
+00000920: 733a 0000 0074 00a0 0164 01a1 017d 0274  s:...t...d...}.t
+00000930: 00a0 0274 00a0 0374 00a0 047c 00a1 01a1  ...t...t...|....
+00000940: 0174 00a0 047c 016a 05a1 01a1 0264 0218  .t...|.j.....d..
+00000950: 007c 0264 0364 0185 023c 007c 0253 0029  .|.d.d...<.|.S.)
+00000960: 0461 8201 0000 0a20 2020 2043 6f6e 7665  .a.....    Conve
+00000970: 7274 2061 2070 6978 656c 2070 6f73 6974  rt a pixel posit
+00000980: 696f 6e20 746f 2067 2076 6563 746f 7273  ion to g vectors
+00000990: 2069 6e0a 2020 2020 466f 7572 6965 7220   in.    Fourier 
+000009a0: 7370 6163 652e 0a0a 2020 2020 5061 7261  space...    Para
+000009b0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+000009c0: 2d2d 2d2d 2d0a 2020 2020 6369 7263 5f70  -----.    circ_p
+000009d0: 6f73 3a20 2074 7570 6c65 0a20 2020 2020  os:  tuple.     
+000009e0: 2020 2020 2020 2020 2020 4669 7273 7420            First 
+000009f0: 7068 6173 6520 696d 6167 650a 2020 2020  phase image.    
+00000a00: 696d 6167 653a 2020 2020 206e 6461 7272  image:     ndarr
+00000a10: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00000a20: 2020 5468 6520 696d 6167 6520 6d61 7472    The image matr
+00000a30: 6978 0a0a 2020 2020 5265 7475 726e 730a  ix..    Returns.
+00000a40: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00000a50: 675f 7665 633a 206e 6461 7272 6179 0a20  g_vec: ndarray. 
+00000a60: 2020 2020 2020 2020 2020 5368 6170 6520            Shape 
+00000a70: 6973 2028 322c 2031 2920 7768 6963 6820  is (2, 1) which 
+00000a80: 6973 2074 6865 0a20 2020 2020 2020 2020  is the.         
+00000a90: 2020 636f 7272 6573 706f 6e64 696e 6720    corresponding 
+00000aa0: 672d 7665 6374 6f72 2069 6e20 696e 7665  g-vector in inve
+00000ab0: 7273 6520 7069 7865 6c73 0a0a 2020 2020  rse pixels..    
+00000ac0: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
+00000ad0: 2d2d 2d2d 2d0a 2020 2020 475f 746f 5f63  -----.    G_to_c
+00000ae0: 6972 630a 2020 2020 e902 0000 00e7 0000  irc.    ........
+00000af0: 0000 0000 e03f 7201 0000 0029 0672 0800  .....?r....).r..
+00000b00: 0000 720a 0000 00da 0664 6976 6964 65da  ..r......divide.
+00000b10: 0466 6c69 70da 0761 7361 7272 6179 720b  .flip..asarrayr.
+00000b20: 0000 0029 03da 0863 6972 635f 706f 73da  ...)...circ_pos.
+00000b30: 0569 6d61 6765 da05 675f 7665 6372 0e00  .image..g_vecr..
+00000b40: 0000 720e 0000 0072 0f00 0000 da09 6369  ..r....r......ci
+00000b50: 7263 5f74 6f5f 4753 0000 0073 0600 0000  rc_to_GS...s....
+00000b60: 0a16 2c01 0401 721b 0000 0063 0200 0000  ..,...r....c....
+00000b70: 0000 0000 0000 0000 0300 0000 0400 0000  ................
+00000b80: 4300 0000 7356 0000 0074 00a0 0164 01a1  C...sV...t...d..
+00000b90: 017d 027c 0064 0219 007c 016a 0264 0219  .}.|.d...|.j.d..
+00000ba0: 0014 0064 037c 016a 0264 0219 0014 0017  ...d.|.j.d......
+00000bb0: 007c 0264 043c 007c 0064 0419 007c 016a  .|.d.<.|.d...|.j
+00000bc0: 0264 0419 0014 0064 037c 016a 0264 0419  .d.....d.|.j.d..
+00000bd0: 0014 0017 007c 0264 023c 007c 0253 0029  .....|.d.<.|.S.)
+00000be0: 0561 d401 0000 0a20 2020 2043 6f6e 7665  .a.....    Conve
+00000bf0: 7274 2067 2076 6563 746f 7273 2069 6e20  rt g vectors in 
+00000c00: 466f 7572 6965 7220 7370 6163 6520 746f  Fourier space to
+00000c10: 0a20 2020 2070 6978 656c 2070 6f73 6974  .    pixel posit
+00000c20: 696f 6e73 2069 6e20 7265 616c 2073 7061  ions in real spa
+00000c30: 6365 2e0a 0a20 2020 2050 6172 616d 6574  ce...    Paramet
+00000c40: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00000c50: 2d2d 0a20 2020 2067 5f76 6563 3a20 6e64  --.    g_vec: nd
+00000c60: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00000c70: 2053 6861 7065 2069 7320 2832 2c20 3129   Shape is (2, 1)
+00000c80: 2077 6869 6368 2069 7320 7468 6520 470a   which is the G.
+00000c90: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+00000ca0: 7220 696e 2046 6f75 7269 6572 2073 7061  r in Fourier spa
+00000cb0: 6365 2069 6e20 696e 7665 7273 6520 7069  ce in inverse pi
+00000cc0: 7865 6c73 0a20 2020 2069 6d61 6765 3a20  xels.    image: 
+00000cd0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00000ce0: 2020 2054 6865 2069 6d61 6765 206d 6174     The image mat
+00000cf0: 7269 780a 0a20 2020 2052 6574 7572 6e73  rix..    Returns
+00000d00: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00000d10: 2063 6972 635f 706f 733a 206e 6461 7272   circ_pos: ndarr
+00000d20: 6179 0a20 2020 2020 2020 2020 2020 5368  ay.           Sh
+00000d30: 6170 6520 6973 2028 322c 2031 2920 7768  ape is (2, 1) wh
+00000d40: 6963 6820 6973 2074 6865 0a20 2020 2020  ich is the.     
+00000d50: 2020 2020 2020 636f 7272 6573 706f 6e64        correspond
+00000d60: 696e 6720 7069 7865 6c20 706f 7369 7469  ing pixel positi
+00000d70: 6f6e 2069 6e0a 2020 2020 2020 2020 2020  on in.          
+00000d80: 2072 6561 6c20 7370 6163 652e 0a0a 2020   real space...  
+00000d90: 2020 5365 6520 416c 736f 0a20 2020 202d    See Also.    -
+00000da0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6369 7263  -------.    circ
+00000db0: 5f74 6f5f 470a 2020 2020 7213 0000 0072  _to_G.    r....r
+00000dc0: 0100 0000 7214 0000 0072 0400 0000 2903  ....r....r....).
+00000dd0: 7208 0000 0072 0a00 0000 720b 0000 0029  r....r....r....)
+00000de0: 0372 1a00 0000 7219 0000 0072 1800 0000  .r....r....r....
+00000df0: 720e 0000 0072 0e00 0000 720f 0000 00da  r....r....r.....
+00000e00: 0947 5f74 6f5f 6369 7263 6e00 0000 7308  .G_to_circn...s.
+00000e10: 0000 000a 1824 0124 0104 0172 1c00 0000  .....$.$...r....
+00000e20: 6302 0000 0000 0000 0000 0000 0007 0000  c...............
+00000e30: 0005 0000 0043 0000 0073 8200 0000 7400  .....C...s....t.
+00000e40: 6a01 7c01 6a02 6401 1900 0b00 6402 1b00  j.|.j.d.....d...
+00000e50: 7c01 6a02 6401 1900 6402 1b00 6403 6404  |.j.d...d...d.d.
+00000e60: 8d03 7d02 7400 6a01 7c01 6a02 6403 1900  ..}.t.j.|.j.d...
+00000e70: 0b00 6402 1b00 7c01 6a02 6403 1900 6402  ..d...|.j.d...d.
+00000e80: 1b00 6403 6404 8d03 7d03 7400 a003 7c03  ..d.d...}.t...|.
+00000e90: 7c02 a102 5c02 7d04 7d05 6402 7400 6a04  |...\.}.}.d.t.j.
+00000ea0: 1400 7c04 7c00 6403 1900 1400 7c05 7c00  ..|.|.d.....|.|.
+00000eb0: 6401 1900 1400 1700 1400 7d06 7c06 5300  d.........}.|.S.
+00000ec0: 2905 61b5 0100 000a 2020 2020 4d75 6c74  ).a.....    Mult
+00000ed0: 6970 6c79 2067 2076 6563 746f 7220 7769  iply g vector wi
+00000ee0: 7468 2046 6f75 7269 6572 2063 6f6f 7264  th Fourier coord
+00000ef0: 696e 6174 6573 0a20 2020 2074 6f20 6765  inates.    to ge
+00000f00: 6e65 7261 7465 2061 2063 6f72 7265 7370  nerate a corresp
+00000f10: 6f6e 6469 6e67 2070 6861 7365 206d 6174  onding phase mat
+00000f20: 7269 780a 0a20 2020 2050 6172 616d 6574  rix..    Paramet
+00000f30: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00000f40: 2d2d 0a20 2020 2067 5f76 6563 3a20 6e64  --.    g_vec: nd
+00000f50: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00000f60: 2053 6861 7065 2069 7320 2832 2c20 3129   Shape is (2, 1)
+00000f70: 2077 6869 6368 2069 7320 7468 6520 470a   which is the G.
+00000f80: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+00000f90: 7220 696e 2046 6f75 7269 6572 2073 7061  r in Fourier spa
+00000fa0: 6365 2069 6e20 696e 7665 7273 6520 7069  ce in inverse pi
+00000fb0: 7865 6c73 0a20 2020 2069 6d61 6765 3a20  xels.    image: 
+00000fc0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00000fd0: 2020 2054 6865 2069 6d61 6765 206d 6174     The image mat
+00000fe0: 7269 780a 0a20 2020 2052 6574 7572 6e73  rix..    Returns
+00000ff0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00001000: 2047 5f72 3a20 6e64 6172 7261 790a 2020   G_r: ndarray.  
+00001010: 2020 2020 2020 2053 616d 6520 7369 7a65         Same size
+00001020: 2061 7320 7468 6520 696d 6167 6520 6f72   as the image or
+00001030: 6967 696e 616c 6c79 0a20 2020 2020 2020  iginally.       
+00001040: 2020 616e 6420 6769 7665 7320 7468 6520    and gives the 
+00001050: 7068 6173 6520 6d61 7020 666f 7220 6120  phase map for a 
+00001060: 6769 7665 6e0a 2020 2020 2020 2020 2067  given.         g
+00001070: 2076 6563 746f 720a 2020 2020 7201 0000   vector.    r...
+00001080: 0072 1300 0000 7204 0000 00a9 03da 0573  .r....r........s
+00001090: 7461 7274 da04 7374 6f70 da04 7374 6570  tart..stop..step
+000010a0: 2905 7208 0000 00da 0661 7261 6e67 6572  ).r......aranger
+000010b0: 0b00 0000 da08 6d65 7368 6772 6964 da02  ......meshgrid..
+000010c0: 7069 2907 5a08 675f 7665 6374 6f72 7219  pi).Z.g_vectorr.
+000010d0: 0000 005a 0372 5f79 5a03 725f 78da 0352  ...Z.r_yZ.r_x..R
+000010e0: 5f78 da03 525f 795a 0347 5f72 720e 0000  _x..R_yZ.G_rr...
+000010f0: 0072 0e00 0000 720f 0000 00da 0867 5f6d  .r....r......g_m
+00001100: 6174 7269 788c 0000 0073 0a00 0000 2614  atrix....s....&.
+00001110: 2601 1001 2201 0401 7226 0000 0054 6304  &..."...r&...Tc.
+00001120: 0000 0000 0000 0000 0000 000f 0000 000b  ................
+00001130: 0000 0043 0000 0073 7801 0000 7400 a001  ...C...sx...t...
+00001140: 7400 a002 7c01 a101 a101 7d04 7c02 6401  t...|.....}.|.d.
+00001150: 6b02 7217 7400 a003 6402 7400 a001 7c04  k.r.t...d.t...|.
+00001160: a101 1400 a101 7d05 6e02 7c02 7d05 7400  ......}.n.|.}.t.
+00001170: 6a04 6401 7c04 6401 1900 8502 6401 7c04  j.d.|.d.....d.|.
+00001180: 6403 1900 8502 6602 1900 5c02 7d06 7d07  d.....f...\.}.}.
+00001190: 7400 a005 7400 a006 7c00 a101 7c04 a102  t...t...|...|...
+000011a0: 6404 7c04 1400 1700 7d08 7407 6a08 a009  d.|.....}.t.j...
+000011b0: 7c04 7c08 6401 1900 7c08 6403 1900 7c05  |.|.d...|.d...|.
+000011c0: a104 a00a 740b a101 7d09 7400 a00c 7400  ....t...}.t...t.
+000011d0: a00d 7400 a00e 7c04 6401 1900 a101 7400  ..t...|.d.....t.
+000011e0: a00e 7c04 6403 1900 a101 a102 a101 7d0a  ..|.d.........}.
+000011f0: 7c03 72a5 7400 a00f 6404 7c00 1400 7c04  |.r.t...d.|...|.
+00001200: 1400 6405 1300 a101 7d0b 7c06 7c09 1900  ..d.....}.|.|...
+00001210: 7c08 6403 1900 1800 6405 1300 7c07 7c09  |.d.....d...|.|.
+00001220: 1900 7c08 6401 1900 1800 6405 1300 1700  ..|.d.....d.....
+00001230: 7c0b 1b00 7d0c 7400 6a10 7c06 7400 6a11  |...}.t.j.|.t.j.
+00001240: 6406 8d02 7d0d 7400 a012 6407 7c0c 1400  d...}.t...d.|...
+00001250: a101 7c0d 7c09 3c00 7400 a013 7400 6a14  ..|.|.<.t...t.j.
+00001260: a015 7c0d 7400 6a14 a016 7400 6a14 a017  ..|.t.j...t.j...
+00001270: 7c01 7c0a 1400 a101 a101 1400 a101 a101  |.|.............
+00001280: 7d0e 7c0e 5300 7400 a013 7400 6a14 a015  }.|.S.t...t.j...
+00001290: 7c09 7400 6a14 a016 7400 6a14 a017 7c01  |.t.j...t.j...|.
+000012a0: 7c0a 1400 a101 a101 1400 a101 a101 7d0e  |.............}.
+000012b0: 7c0e 5300 2908 612b 0400 000a 2020 2020  |.S.).a+....    
+000012c0: 5573 6520 7468 6520 6720 7665 6374 6f72  Use the g vector
+000012d0: 2069 6e20 466f 7572 6965 7220 636f 6f72   in Fourier coor
+000012e0: 6469 6e61 7465 730a 2020 2020 746f 2073  dinates.    to s
+000012f0: 656c 6563 7420 6f6e 6c79 2074 6865 2073  elect only the s
+00001300: 7562 7365 7420 6f66 2070 6861 7365 730a  ubset of phases.
+00001310: 2020 2020 6173 736f 6369 6174 6564 2077      associated w
+00001320: 6974 6820 7468 6174 2064 6966 6672 6163  ith that diffrac
+00001330: 7469 6f6e 2073 706f 742c 0a20 2020 2061  tion spot,.    a
+00001340: 2e6b 2e61 2e20 7468 6520 6c61 7474 6963  .k.a. the lattic
+00001350: 6520 7061 7261 6d65 7465 722e 0a0a 2020  e parameter...  
+00001360: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00001370: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00001380: 675f 7665 633a 2020 2020 206e 6461 7272  g_vec:     ndarr
+00001390: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+000013a0: 2020 5368 6170 6520 6973 2028 322c 2031    Shape is (2, 1
+000013b0: 2920 7768 6963 6820 6973 2074 6865 2047  ) which is the G
+000013c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000013d0: 7665 6374 6f72 2069 6e20 466f 7572 6965  vector in Fourie
+000013e0: 7220 7370 6163 6520 696e 2069 6e76 6572  r space in inver
+000013f0: 7365 2070 6978 656c 730a 2020 2020 696d  se pixels.    im
+00001400: 6167 653a 2020 2020 206e 6461 7272 6179  age:     ndarray
+00001410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001420: 5468 6520 696d 6167 6520 6d61 7472 6978  The image matrix
+00001430: 0a20 2020 2063 6972 635f 7369 7a65 3a20  .    circ_size: 
+00001440: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
+00001450: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+00001460: 697a 6520 6f66 2074 6865 2063 6972 636c  ize of the circl
+00001470: 6520 696e 2070 6978 656c 730a 2020 2020  e in pixels.    
+00001480: 675f 626c 7572 3a20 2020 2062 6f6f 6c2c  g_blur:    bool,
+00001490: 206f 7074 696f 6e61 6c0a 0a20 2020 2052   optional..    R
+000014a0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+000014b0: 2d2d 0a20 2020 2050 5f6d 6174 7269 783a  --.    P_matrix:
+000014c0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+000014d0: 2020 2020 2020 2053 616d 6520 7369 7a65         Same size
+000014e0: 2061 7320 7468 6520 696d 6167 6520 6f72   as the image or
+000014f0: 6967 696e 616c 6c79 0a20 2020 2020 2020  iginally.       
+00001500: 2020 2020 2020 2061 6e64 2067 6976 6573         and gives
+00001510: 2061 2072 6561 6c20 7370 6163 6520 7068   a real space ph
+00001520: 6173 6520 6d61 7472 6978 0a20 2020 2020  ase matrix.     
+00001530: 2020 2020 2020 2020 2066 6f72 2061 2067           for a g
+00001540: 6976 656e 2072 6561 6c20 696d 6167 6520  iven real image 
+00001550: 616e 6420 6120 6720 7665 6374 6f72 0a0a  and a g vector..
+00001560: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+00001570: 2d2d 2d0a 2020 2020 5765 2070 7574 2061  ---.    We put a
+00001580: 6e20 6170 6572 7475 7265 2061 726f 756e  n aperture aroun
+00001590: 6420 6120 7369 6e67 6c65 2064 6966 6672  d a single diffr
+000015a0: 6163 7469 6f6e 0a20 2020 2073 706f 742c  action.    spot,
+000015b0: 2067 6976 656e 2062 7920 7468 6520 6720   given by the g 
+000015c0: 7665 6374 6f72 2074 6861 7420 6765 6e65  vector that gene
+000015d0: 7261 7465 7320 7468 650a 2020 2020 7068  rates the.    ph
+000015e0: 6173 6520 6d61 7472 6978 2061 7373 6f63  ase matrix assoc
+000015f0: 6961 7465 6420 7769 7468 2074 6861 7420  iated with that 
+00001600: 6469 6666 7261 6374 696f 6e0a 2020 2020  diffraction.    
+00001610: 7370 6f74 2e20 4966 2074 6865 2067 2076  spot. If the g v
+00001620: 6563 746f 7220 6973 2061 6c72 6561 6479  ector is already
+00001630: 2072 6566 696e 6564 2c20 7468 656e 0a20   refined, then. 
+00001640: 2020 2069 6e20 7468 6520 7265 6665 7265     in the refere
+00001650: 6e63 6520 7265 6769 6f6e 2c20 7468 6520  nce region, the 
+00001660: 6469 6666 6572 656e 6365 2062 6574 7765  difference betwe
+00001670: 656e 0a20 2020 2074 6869 7320 7068 6173  en.    this phas
+00001680: 6520 6d61 7472 6978 2061 6e64 2074 6861  e matrix and tha
+00001690: 7420 6769 7665 6e20 6279 2060 675f 6d61  t given by `g_ma
+000016a0: 7472 6978 600a 2020 2020 7368 6f75 6c64  trix`.    should
+000016b0: 2062 6520 7a65 726f 2e0a 0a20 2020 2053   be zero...    S
+000016c0: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
+000016d0: 2d2d 2d2d 0a20 2020 2067 5f6d 6174 7269  ----.    g_matri
+000016e0: 780a 2020 2020 7201 0000 0067 7b14 ae47  x.    r....g{..G
+000016f0: e17a 843f 7204 0000 0072 1400 0000 7213  .z.?r....r....r.
+00001700: 0000 0072 0300 0000 e700 0000 0000 00e0  ...r............
+00001710: bf29 1872 0800 0000 7217 0000 0072 0b00  .).r....r....r..
+00001720: 0000 5a04 616d 696e da05 6d67 7269 6472  ..Z.amin..mgridr
+00001730: 0c00 0000 7216 0000 00da 0273 74da 0475  ....r......st..u
+00001740: 7469 6c5a 0b6d 616b 655f 6369 7263 6c65  tilZ.make_circle
+00001750: 5a06 6173 7479 7065 da04 626f 6f6c da04  Z.astype..bool..
+00001760: 7371 7274 da05 6f75 7465 72da 0768 616d  sqrt..outer..ham
+00001770: 6d69 6e67 da03 7375 6dda 0a7a 6572 6f73  ming..sum..zeros
+00001780: 5f6c 696b 65da 0566 6c6f 6174 7209 0000  _like..floatr...
+00001790: 0072 1100 0000 da03 6666 745a 0569 6666  .r......fftZ.iff
+000017a0: 7432 da08 6666 7473 6869 6674 da04 6666  t2..fftshift..ff
+000017b0: 7432 290f 5a04 6776 6563 7219 0000 00da  t2).Z.gvecr.....
+000017c0: 0963 6972 635f 7369 7a65 5a06 675f 626c  .circ_sizeZ.g_bl
+000017d0: 7572 da07 696d 7368 6170 655a 0863 6972  ur..imshapeZ.cir
+000017e0: 635f 7261 64da 0279 79da 0278 7872 1800  c_rad..yy..xxr..
+000017f0: 0000 5a09 6369 7263 5f6d 6173 6bda 0368  ..Z.circ_mask..h
+00001800: 616d 5a06 7369 676d 6132 da02 7a7a 5a09  amZ.sigma2..zzZ.
+00001810: 666f 7572 5f6d 6173 6b5a 0850 5f6d 6174  four_maskZ.P_mat
+00001820: 7269 7872 0e00 0000 720e 0000 0072 0f00  rixr....r....r..
+00001830: 0000 da0c 7068 6173 655f 6d61 7472 6978  ....phase_matrix
+00001840: a700 0000 7332 0000 0010 2708 0116 0104  ....s2....'.....
+00001850: 0222 011a 0118 0206 0102 fe26 0304 0216  .".........&....
+00001860: 0126 0202 0104 fe10 0312 0104 0122 0104  .&..........."..
+00001870: ff04 0704 fd22 0104 ff04 0372 3b00 0000  .....".....r;...
+00001880: 6303 0000 0000 0000 0000 0000 0015 0000  c...............
+00001890: 0006 0000 0043 0000 0073 7001 0000 7400  .....C...sp...t.
+000018a0: 7c00 8301 5c02 7d03 7d04 7400 7c01 8301  |...\.}.}.t.|...
+000018b0: 5c02 7d05 7d06 7401 a002 7c00 a101 7d07  \.}.}.t...|...}.
+000018c0: 7401 6a03 6401 7c07 6401 1900 8502 6401  t.j.d.|.d.....d.
+000018d0: 7c07 6402 1900 8502 6602 1900 5c02 7d08  |.d.....f...\.}.
+000018e0: 7d09 7401 a004 7c08 a101 7d08 7401 a004  }.t...|...}.t...
+000018f0: 7c09 a101 7d09 7401 6a05 6403 7401 6a06  |...}.t.j.d.t.j.
+00001900: 6404 8d02 7d0a 7401 a007 7c00 a101 7d0b  d...}.t...|...}.
+00001910: 7401 a007 7c00 a101 7d0c 7401 a007 7c00  t...|...}.t...|.
+00001920: a101 7d0d 7401 a007 7c00 a101 7d0e 7408  ..}.t...|...}.t.
+00001930: 7409 7c08 8301 8301 4400 5d57 7d0f 7c08  t.|.....D.]W}.|.
+00001940: 7c0f 1900 7d10 7c09 7c0f 1900 7d11 7c03  |...}.|.|...}.|.
+00001950: 7c10 7c11 6602 1900 7c0a 6405 3c00 7c04  |.|.f...|.d.<.|.
+00001960: 7c10 7c11 6602 1900 7c0a 6406 3c00 7c05  |.|.f...|.d.<.|.
+00001970: 7c10 7c11 6602 1900 7c0a 6407 3c00 7c06  |.|.f...|.d.<.|.
+00001980: 7c10 7c11 6602 1900 7c0a 6408 3c00 6402  |.|.f...|.d.<.d.
+00001990: 6409 7401 6a0a 1400 1b00 7401 a00b 7c02  d.t.j.....t...|.
+000019a0: 7c0a a102 1400 7d12 7c12 6405 1900 7c0b  |.....}.|.d...|.
+000019b0: 7c10 7c11 6602 3c00 7c12 6406 1900 7c0c  |.|.f.<.|.d...|.
+000019c0: 7c10 7c11 6602 3c00 7c12 6407 1900 7c0d  |.|.f.<.|.d...|.
+000019d0: 7c10 7c11 6602 3c00 7c12 6408 1900 7c0e  |.|.f.<.|.d...|.
+000019e0: 7c10 7c11 6602 3c00 714e 640a 7c0c 7c0d  |.|.f.<.qNd.|.|.
+000019f0: 1800 1400 7d13 640a 7c0c 7c0d 1700 1400  ....}.d.|.|.....
+00001a00: 7d14 7c0b 7c0e 7c13 7c14 6604 5300 290b  }.|.|.|.|.f.S.).
+00001a10: 61bd 0200 000a 2020 2020 5573 6520 7468  a.....    Use th
+00001a20: 6520 7265 6669 6e65 6420 7068 6173 6520  e refined phase 
+00001a30: 6d61 7472 6963 6573 2061 6e64 206c 6174  matrices and lat
+00001a40: 7469 6365 206d 6174 7269 780a 2020 2020  tice matrix.    
+00001a50: 746f 2063 616c 6375 6c61 7465 2074 6865  to calculate the
+00001a60: 2073 7472 6169 6e20 6d61 7472 6963 6573   strain matrices
+00001a70: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00001a80: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00001a90: 0a20 2020 2050 5f31 3a20 2020 2020 206e  .    P_1:      n
+00001aa0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00001ab0: 2020 2020 2052 6566 696e 6564 2050 6861       Refined Pha
+00001ac0: 7365 206d 6174 7269 7820 6672 6f6d 2066  se matrix from f
+00001ad0: 6972 7374 206c 6174 7469 6365 2073 706f  irst lattice spo
+00001ae0: 740a 2020 2020 505f 323a 2020 2020 2020  t.    P_2:      
+00001af0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00001b00: 2020 2020 2020 5265 6669 6e65 6420 5068        Refined Ph
+00001b10: 6173 6520 6d61 7472 6978 2066 726f 6d20  ase matrix from 
+00001b20: 6669 7273 7420 6c61 7474 6963 6520 7370  first lattice sp
+00001b30: 6f74 0a20 2020 2061 5f6d 6174 7269 783a  ot.    a_matrix:
+00001b40: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00001b50: 2020 2020 2020 206e 6461 7272 6179 206f         ndarray o
+00001b60: 6620 7368 6170 6520 2832 2c20 3229 2074  f shape (2, 2) t
+00001b70: 6861 7420 7265 7072 6573 656e 7473 0a20  hat represents. 
+00001b80: 2020 2020 2020 2020 2020 2020 2074 6865               the
+00001b90: 206c 6174 7469 6365 2070 6172 616d 6574   lattice paramet
+00001ba0: 6572 7320 696e 2072 6561 6c20 7370 6163  ers in real spac
+00001bb0: 650a 0a20 2020 2052 6574 7572 6e73 0a20  e..    Returns. 
+00001bc0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2065     -------.    e
+00001bd0: 5f78 783a 206e 6461 7272 6179 0a20 2020  _xx: ndarray.   
+00001be0: 2020 2020 2020 2053 7472 6169 6e20 616c         Strain al
+00001bf0: 6f6e 6720 5820 6469 7265 6374 696f 6e0a  ong X direction.
+00001c00: 2020 2020 655f 7979 3a20 6e64 6172 7261      e_yy: ndarra
+00001c10: 790a 2020 2020 2020 2020 2020 5374 7261  y.          Stra
+00001c20: 696e 2061 6c6f 6e67 2059 2064 6972 6563  in along Y direc
+00001c30: 7469 6f6e 0a20 2020 2065 5f74 683a 206e  tion.    e_th: n
+00001c40: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00001c50: 2052 6f74 6174 696f 6e61 6c20 7374 7261   Rotational stra
+00001c60: 696e 0a20 2020 2065 5f64 673a 206e 6461  in.    e_dg: nda
+00001c70: 7272 6179 0a20 2020 2020 2020 2020 2044  rray.          D
+00001c80: 6961 676f 6e61 6c20 5374 7261 696e 0a0a  iagonal Strain..
+00001c90: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00001ca0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 7068   --------.    ph
+00001cb0: 6173 655f 6469 6666 0a20 2020 2047 5041  ase_diff.    GPA
+00001cc0: 2e67 656e 5f73 7472 6169 6e28 290a 2020  .gen_strain().  
+00001cd0: 2020 7201 0000 0072 0400 0000 a902 7213    r....r......r.
+00001ce0: 0000 0072 1300 0000 7203 0000 0029 0272  ...r....r....).r
+00001cf0: 0100 0000 7201 0000 0029 0272 0100 0000  ....r....).r....
+00001d00: 7204 0000 0029 0272 0400 0000 7201 0000  r....).r....r...
+00001d10: 0029 0272 0400 0000 7204 0000 0072 1300  .).r....r....r..
+00001d20: 0000 7214 0000 0029 0c72 1000 0000 7208  ..r....).r....r.
+00001d30: 0000 0072 0b00 0000 7228 0000 00da 0572  ...r....r(.....r
+00001d40: 6176 656c 720a 0000 0072 3100 0000 7230  avelr....r1...r0
+00001d50: 0000 00da 0572 616e 6765 da03 6c65 6e72  .....range..lenr
+00001d60: 2300 0000 da06 6d61 746d 756c 2915 5a03  #.....matmul).Z.
+00001d70: 505f 315a 0350 5f32 da08 615f 6d61 7472  P_1Z.P_2..a_matr
+00001d80: 6978 5a04 5031 5f78 5a04 5031 5f79 5a04  ixZ.P1_xZ.P1_yZ.
+00001d90: 5032 5f78 5a04 5032 5f79 5a07 505f 7368  P2_xZ.P2_yZ.P_sh
+00001da0: 6170 6572 3700 0000 7238 0000 005a 0550  aper7...r8...Z.P
+00001db0: 5f6d 6174 da04 655f 7878 da04 655f 7879  _mat..e_xx..e_xy
+00001dc0: da04 655f 7978 da04 655f 7979 da02 6969  ..e_yx..e_yy..ii
+00001dd0: 5a04 7970 6f73 5a04 7870 6f73 5a05 655f  Z.yposZ.xposZ.e_
+00001de0: 6d61 74da 0465 5f74 68da 0465 5f64 6772  mat..e_th..e_dgr
+00001df0: 0e00 0000 720e 0000 0072 0f00 0000 da08  ....r....r......
+00001e00: 7374 7261 696e 5f50 eb00 0000 7334 0000  strain_P....s4..
+00001e10: 000c 1f0c 010a 0122 010a 010a 0110 010a  ......."........
+00001e20: 010a 010a 010a 0110 0108 0108 0110 0110  ................
+00001e30: 0110 0110 011a 0110 0110 0110 0112 010c  ................
+00001e40: 010c 010c 0172 4900 0000 6300 0000 0000  .....rI...c.....
+00001e50: 0000 0000 0000 0000 0000 0003 0000 0040  ...............@
+00001e60: 0000 0073 5400 0000 6500 5a01 6400 5a02  ...sT...e.Z.d.Z.
+00001e70: 6401 5a03 0904 641a 6405 6406 8401 5a04  d.Z...d.d.d...Z.
+00001e80: 641b 6409 640a 8401 5a05 641c 640d 640e  d.d.d...Z.d.d.d.
+00001e90: 8401 5a06 641d 6410 6411 8401 5a07 6412  ..Z.d.d.d...Z.d.
+00001ea0: 6413 8400 5a08 6414 6415 8400 5a09 641e  d...Z.d.d...Z.d.
+00001eb0: 6417 6418 8401 5a0a 6419 5300 291f da03  d.d...Z.d.S.)...
+00001ec0: 4750 4175 ed07 0000 0a20 2020 2055 7365  GPAu.....    Use
+00001ed0: 2047 656f 6d65 7472 6963 2050 6861 7365   Geometric Phase
+00001ee0: 2041 6e61 6c79 7369 7320 2847 5041 2920   Analysis (GPA) 
+00001ef0: 746f 206d 6561 7375 7265 2073 7472 6169  to measure strai
+00001f00: 6e20 696e 2061 6e0a 2020 2020 656c 6563  n in an.    elec
+00001f10: 7472 6f6e 206d 6963 726f 6772 6170 6820  tron micrograph 
+00001f20: 6279 206c 6f63 6174 696e 6720 7468 6520  by locating the 
+00001f30: 6469 6666 7261 6374 696f 6e20 7370 6f74  diffraction spot
+00001f40: 7320 616e 640a 2020 2020 6964 656e 7469  s and.    identi
+00001f50: 6679 696e 6720 6120 7265 6665 7265 6e63  fying a referenc
+00001f60: 6520 7265 6769 6f6e 0a0a 2020 2020 5061  e region..    Pa
+00001f70: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00001f80: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
+00001f90: 653a 2020 2020 2020 206e 6461 7272 6179  e:       ndarray
+00001fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001fb0: 2020 5468 6520 696d 6167 6520 6672 6f6d    The image from
+00001fc0: 2077 6869 6368 2074 6865 2073 7472 6169   which the strai
+00001fd0: 6e20 7769 6c6c 0a20 2020 2020 2020 2020  n will.         
+00001fe0: 2020 2020 2020 2020 6265 206d 6561 7375          be measu
+00001ff0: 7265 6420 6672 6f6d 0a20 2020 2063 616c  red from.    cal
+00002000: 6962 3a20 2020 2020 2020 666c 6f61 740a  ib:       float.
+00002010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002020: 2053 697a 6520 6f66 2061 6e20 696e 6469   Size of an indi
+00002030: 7669 6475 616c 2070 6978 656c 0a20 2020  vidual pixel.   
+00002040: 2063 616c 6962 5f75 6e69 7473 3a20 7374   calib_units: st
+00002050: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00002060: 2020 2055 6e69 7420 6f66 2063 616c 6962     Unit of calib
+00002070: 7261 7469 6f6e 0a20 2020 2072 6566 5f69  ration.    ref_i
+00002080: 7465 723a 2020 2020 696e 742c 206f 7074  ter:    int, opt
+00002090: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000020a0: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
+000020b0: 2069 7465 7261 7469 6f6e 7320 746f 2072   iterations to r
+000020c0: 756e 2066 6f72 2072 6566 696e 696e 670a  un for refining.
+000020d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000020e0: 2074 6865 2047 2076 6563 746f 7273 2061   the G vectors a
+000020f0: 6e64 2074 6865 2070 6861 7365 206d 6174  nd the phase mat
+00002100: 7269 7865 732e 0a20 2020 2020 2020 2020  rixes..         
+00002110: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
+00002120: 6973 2032 302e 0a20 2020 2075 7365 5f62  is 20..    use_b
+00002130: 6c75 723a 2020 2020 626f 6f6c 2c20 6f70  lur:    bool, op
+00002140: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00002150: 2020 2020 2020 2020 5573 6520 6120 4761          Use a Ga
+00002160: 7573 7369 616e 2062 6c75 7220 746f 2067  ussian blur to g
+00002170: 656e 6572 6174 6520 7468 650a 2020 2020  enerate the.    
+00002180: 2020 2020 2020 2020 2020 2020 2070 6861               pha
+00002190: 7365 206d 6174 7269 7820 6672 6f6d 2061  se matrix from a
+000021a0: 2067 2076 6563 746f 722e 2044 6566 6175   g vector. Defau
+000021b0: 6c74 2069 7320 5472 7565 0a0a 2020 2020  lt is True..    
+000021c0: 5265 6665 7265 6e63 6573 0a20 2020 202d  References.    -
+000021d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2e2e  ---------.    ..
+000021e0: 205b 315d 2048 c3bf 7463 682c 204d 2e20   [1] H..tch, M. 
+000021f0: 4a2e 2c20 452e 2053 6e6f 6563 6b2c 2061  J., E. Snoeck, a
+00002200: 6e64 2052 2e20 4b69 6c61 6173 2e20 2251  nd R. Kilaas. "Q
+00002210: 7561 6e74 6974 6174 6976 6520 6d65 6173  uantitative meas
+00002220: 7572 656d 656e 740a 2020 2020 2020 206f  urement.       o
+00002230: 6620 6469 7370 6c61 6365 6d65 6e74 2061  f displacement a
+00002240: 6e64 2073 7472 6169 6e20 6669 656c 6473  nd strain fields
+00002250: 2066 726f 6d20 4852 454d 206d 6963 726f   from HREM micro
+00002260: 6772 6170 6873 2e22 0a20 2020 2020 2020  graphs.".       
+00002270: 556c 7472 616d 6963 726f 7363 6f70 7920  Ultramicroscopy 
+00002280: 3734 2e33 2028 3139 3938 293a 2031 3331  74.3 (1998): 131
+00002290: 2d31 3436 2e0a 0a20 2020 2045 7861 6d70  -146...    Examp
+000022a0: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+000022b0: 0a20 2020 2052 756e 2061 733a 0a0a 2020  .    Run as:..  
+000022c0: 2020 3e3e 3e20 696d 5f67 7061 203d 2067    >>> im_gpa = g
+000022d0: 7061 2869 6d61 6765 3d69 6d61 6765 4443  pa(image=imageDC
+000022e0: 2c20 6361 6c69 623d 6361 6c69 6231 2c20  , calib=calib1, 
+000022f0: 6361 6c69 625f 756e 6974 733d 2063 616c  calib_units= cal
+00002300: 6962 315f 756e 6974 7329 0a0a 2020 2020  ib1_units)..    
+00002310: 5468 656e 2074 6f20 6368 6563 6b20 7468  Then to check th
+00002320: 6520 696d 6167 6520 796f 7520 6a75 7374  e image you just
+00002330: 206c 6f61 6465 640a 0a20 2020 203e 3e3e   loaded..    >>>
+00002340: 2069 6d5f 6770 612e 7368 6f77 5f69 6d61   im_gpa.show_ima
+00002350: 6765 2829 0a0a 2020 2020 5468 656e 2c20  ge()..    Then, 
+00002360: 7365 6c65 6374 2074 6865 2064 6966 6672  select the diffr
+00002370: 6163 7469 6f6e 2073 706f 7473 2069 6e20  action spots in 
+00002380: 696e 7665 7273 6520 756e 6974 7320 7468  inverse units th
+00002390: 6174 2079 6f75 0a20 2020 2077 616e 7420  at you.    want 
+000023a0: 746f 2062 6520 7573 6564 2066 6f72 2047  to be used for G
+000023b0: 5041 2e20 5468 6579 206d 7573 7420 6e6f  PA. They must no
+000023c0: 7420 6265 2063 6f6c 6c69 6e65 6172 2e0a  t be collinear..
+000023d0: 0a20 2020 203e 3e3e 2069 6d5f 6770 612e  .    >>> im_gpa.
+000023e0: 6669 6e64 5f73 706f 7473 2828 352c 2030  find_spots((5, 0
+000023f0: 292c 2028 302c 202d 3529 290a 0a20 2020  ), (0, -5))..   
+00002400: 2077 6865 7265 2028 352c 2030 2920 616e   where (5, 0) an
+00002410: 6420 2830 2c20 2d35 2920 6172 6520 7477  d (0, -5) are tw
+00002420: 6f20 6469 6666 7261 6374 696f 6e20 7370  o diffraction sp
+00002430: 6f74 0a20 2020 206c 6f63 6174 696f 6e73  ot.    locations
+00002440: 2e20 596f 7520 6361 6e20 7275 6e20 7468  . You can run th
+00002450: 6520 6066 696e 645f 7370 6f74 7360 206d  e `find_spots` m
+00002460: 6574 686f 6420 6d61 6e75 616c 6c79 0a20  ethod manually. 
+00002470: 2020 206d 756c 7469 706c 6520 7469 6d65     multiple time
+00002480: 7320 7469 6c6c 2079 6f75 206c 6f63 6174  s till you locat
+00002490: 6520 7468 6520 7370 6f74 7320 636c 6f73  e the spots clos
+000024a0: 656c 792e 2041 6674 6572 0a20 2020 2079  ely. After.    y
+000024b0: 6f75 2068 6176 6520 6c6f 6361 7465 6420  ou have located 
+000024c0: 7468 6520 7370 6f74 732c 2079 6f75 206e  the spots, you n
+000024d0: 6565 6420 746f 2064 6566 696e 6520 6120  eed to define a 
+000024e0: 7265 6665 7265 6e63 650a 2020 2020 7265  reference.    re
+000024f0: 6769 6f6e 2066 6f72 2074 6865 2069 6d61  gion for the ima
+00002500: 6765 202d 2077 6974 6820 7265 7370 6563  ge - with respec
+00002510: 7420 746f 2077 6869 6368 2074 6865 2073  t to which the s
+00002520: 7472 6169 6e0a 2020 2020 7769 6c6c 2062  train.    will b
+00002530: 6520 6361 6c63 756c 6174 6564 2e0a 0a20  e calculated... 
+00002540: 2020 203e 3e3e 2069 6d5f 6770 612e 6465     >>> im_gpa.de
+00002550: 6669 6e65 5f72 6566 6572 656e 6365 2828  fine_reference((
+00002560: 362e 382c 2036 2e39 292c 2028 3130 2e31  6.8, 6.9), (10.1
+00002570: 2c20 362e 3829 2c20 2831 302e 322c 2039  , 6.8), (10.2, 9
+00002580: 2e35 292c 2028 372e 302c 2039 2e36 2929  .5), (7.0, 9.6))
+00002590: 0a0a 2020 2020 7768 6572 6520 2836 2e38  ..    where (6.8
+000025a0: 2c20 362e 3929 2c20 2831 302e 312c 2036  , 6.9), (10.1, 6
+000025b0: 2e38 292c 2028 3130 2e32 2c20 392e 3529  .8), (10.2, 9.5)
+000025c0: 2061 6e64 2028 372e 302c 2039 2e36 2920   and (7.0, 9.6) 
+000025d0: 6172 650a 2020 2020 7468 6520 636f 726e  are.    the corn
+000025e0: 6572 7320 6f66 2074 6865 2072 6566 6572  ers of the refer
+000025f0: 656e 6365 2072 6567 696f 6e20 796f 7520  ence region you 
+00002600: 6172 6520 6465 6669 6e69 6e67 2e0a 0a20  are defining... 
+00002610: 2020 203e 3e3e 2069 6d5f 6770 612e 7265     >>> im_gpa.re
+00002620: 6669 6e65 5f70 6861 7365 2829 0a20 2020  fine_phase().   
+00002630: 203e 3e3e 2065 5f78 782c 2065 5f79 792c   >>> e_xx, e_yy,
+00002640: 2065 5f74 6865 7461 2c20 655f 6469 6167   e_theta, e_diag
+00002650: 203d 2069 6d5f 6770 612e 6765 745f 7374   = im_gpa.get_st
+00002660: 7261 696e 2829 0a0a 2020 2020 546f 2070  rain()..    To p
+00002670: 6c6f 7420 7468 6520 6f62 7461 696e 6564  lot the obtained
+00002680: 2073 7472 6169 6e20 6d61 7073 3a0a 0a20   strain maps:.. 
+00002690: 2020 203e 3e3e 2069 6d5f 6770 612e 706c     >>> im_gpa.pl
+000026a0: 6f74 5f67 7061 5f73 7472 6169 6e28 290a  ot_gpa_strain().
+000026b0: 0a20 2020 20e9 1400 0000 54e7 9a99 9999  .    .....T.....
+000026c0: 9999 d93f 6307 0000 0000 0000 0000 0000  ...?c...........
+000026d0: 0008 0000 0003 0000 0043 0000 0073 9800  .........C...s..
+000026e0: 0000 7c01 7c00 5f00 7c02 7c00 5f01 7c03  ..|.|._.|.|._.|.
+000026f0: 7c00 5f02 7c05 7c00 5f03 7404 7c04 8301  |._.|.|._.t.|...
+00002700: 7c00 5f05 7406 a007 7c01 6a08 a101 7c00  |._.t...|.j...|.
+00002710: 5f09 6401 7c00 6a01 7c00 6a09 1400 1b00  _.d.|.j.|.j.....
+00002720: 7d07 7c07 6402 1900 7c07 6401 1900 6b02  }.|.d...|.d...k.
+00002730: 722f 7406 a00a 7c07 a101 7c00 5f0b 6e04  r/t...|...|._.n.
+00002740: 740c 6403 8301 8201 6404 7c00 6a09 1400  t.d.....d.|.j...
+00002750: 7c00 5f0d 6405 7c03 1700 7c00 5f0e 7c06  |._.d.|...|._.|.
+00002760: 7c00 5f0f 6406 7c00 5f10 6406 7c00 5f11  |._.d.|._.d.|._.
+00002770: 6406 7c00 5f12 6400 5300 2907 4e72 0400  d.|._.d.S.).Nr..
+00002780: 0000 7201 0000 007a 2e50 6c65 6173 6520  ..r....z.Please 
+00002790: 656e 7375 7265 2074 6861 7420 7468 6520  ensure that the 
+000027a0: 696d 6167 6520 6973 2061 2073 7175 6172  image is a squar
+000027b0: 6520 696d 6167 6572 1400 0000 7a02 312f  e imager....z.1/
+000027c0: 4629 1372 1900 0000 da05 6361 6c69 62da  F).r......calib.
+000027d0: 0b63 616c 6962 5f75 6e69 7473 da04 626c  .calib_units..bl
+000027e0: 7572 da03 696e 74da 0872 6566 5f69 7465  ur..int..ref_ite
+000027f0: 7272 0800 0000 7217 0000 0072 0b00 0000  rr....r....r....
+00002800: 7236 0000 00da 046d 6561 6eda 0969 6e76  r6.....mean..inv
+00002810: 5f63 616c 6962 da0c 5275 6e74 696d 6545  _calib..RuntimeE
+00002820: 7272 6f72 da06 6369 7263 5f30 da0d 696e  rror..circ_0..in
+00002830: 765f 6361 6c5f 756e 6974 73da 0a6d 6178  v_cal_units..max
+00002840: 5f73 7472 6169 6eda 0b73 706f 7473 5f63  _strain..spots_c
+00002850: 6865 636b da0f 7265 6665 7265 6e63 655f  heck..reference_
+00002860: 6368 6563 6bda 0e72 6566 696e 696e 675f  check..refining_
+00002870: 6368 6563 6b29 08da 0473 656c 6672 1900  check)...selfr..
+00002880: 0000 724d 0000 0072 4e00 0000 7251 0000  ..rM...rN...rQ..
+00002890: 005a 0875 7365 5f62 6c75 7272 5700 0000  .Z.use_blurrW...
+000028a0: 5a07 696e 765f 6c65 6e72 0e00 0000 720e  Z.inv_lenr....r.
+000028b0: 0000 0072 0f00 0000 da08 5f5f 696e 6974  ...r......__init
+000028c0: 5f5f 6701 0000 7320 0000 0006 0306 0106  __g...s ........
+000028d0: 0106 010a 010e 0110 0110 010e 0108 020c  ................
+000028e0: 010a 0106 0106 0106 010a 017a 0c47 5041  ...........z.GPA
+000028f0: 2e5f 5f69 6e69 745f 5fa9 02e9 0f00 0000  .__init__.......
+00002900: 725e 0000 00da 0769 6e66 6572 6e6f 6303  r^.....infernoc.
+00002910: 0000 0000 0000 0000 0000 0004 0000 0004  ................
+00002920: 0000 0043 0000 0073 5a00 0000 7400 6a01  ...C...sZ...t.j.
+00002930: 7c01 6401 8d01 0100 7400 6a02 7c00 6a03  |.d.....t.j.|.j.
+00002940: 7c02 6402 8d02 0100 7404 a005 7c00 6a06  |.d.....t...|.j.
+00002950: 7c00 6a07 a102 7d03 6403 7c03 5f08 6404  |.j...}.d.|._.d.
+00002960: 7c03 5f09 6405 7c03 5f0a 7400 a00b a100  |._.d.|._.t.....
+00002970: a00c 7c03 a101 0100 7400 a00d 6406 a101  ..|.....t...d...
+00002980: 0100 6407 5300 2908 6124 0100 000a 2020  ..d.S.).a$....  
+00002990: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000029a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000029b0: 2d2d 2d0a 2020 2020 2020 2020 696d 7369  ---.        imsi
+000029c0: 7a65 3a20 2020 7475 706c 652c 206f 7074  ze:   tuple, opt
+000029d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000029e0: 2020 2020 2020 2020 5369 7a65 2069 6e20          Size in 
+000029f0: 696e 6368 6573 206f 6620 7468 6520 696d  inches of the im
+00002a00: 6167 6520 7769 7468 2074 6865 0a20 2020  age with the.   
+00002a10: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00002a20: 6966 6672 6163 7469 6f6e 2073 706f 7473  iffraction spots
+00002a30: 206d 6172 6b65 642e 2044 6566 6175 6c74   marked. Default
+00002a40: 2069 7320 2831 352c 2031 3529 0a20 2020   is (15, 15).   
+00002a50: 2020 2020 2063 6f6c 6f72 6d61 703a 2073       colormap: s
+00002a60: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00002a70: 2020 2020 2020 2020 2020 2020 2020 2043                 C
+00002a80: 6f6c 6f72 6d61 7020 6f66 2074 6865 2069  olormap of the i
+00002a90: 6d61 6765 2e20 4465 6661 756c 7420 6973  mage. Default is
+00002aa0: 2069 6e66 6572 6e6f 0a20 2020 2020 2020   inferno.       
+00002ab0: 20a9 015a 0766 6967 7369 7a65 a901 da04   ..Z.figsize....
+00002ac0: 636d 6170 fa0b 6c6f 7765 7220 7269 6768  cmap..lower righ
+00002ad0: 7472 0400 0000 da01 6bda 036f 6666 4e29  tr......k..offN)
+00002ae0: 0eda 0370 6c74 da06 6669 6775 7265 da06  ...plt..figure..
+00002af0: 696d 7368 6f77 7219 0000 00da 046d 7073  imshowr......mps
+00002b00: 73da 0853 6361 6c65 4261 7272 4d00 0000  s..ScaleBarrM...
+00002b10: 724e 0000 00da 086c 6f63 6174 696f 6eda  rN.....location.
+00002b20: 0962 6f78 5f61 6c70 6861 da05 636f 6c6f  .box_alpha..colo
+00002b30: 725a 0367 6361 da0a 6164 645f 6172 7469  rZ.gca..add_arti
+00002b40: 7374 7206 0000 0029 0472 5b00 0000 da06  str....).r[.....
+00002b50: 696d 7369 7a65 5a08 636f 6c6f 726d 6170  imsizeZ.colormap
+00002b60: da08 7363 616c 6562 6172 720e 0000 0072  ..scalebarr....r
+00002b70: 0e00 0000 720f 0000 00da 0a73 686f 775f  ....r......show_
+00002b80: 696d 6167 657c 0100 0073 1000 0000 0c0a  image|...s......
+00002b90: 1001 1001 0601 0601 0601 0e01 0e01 7a0e  ..............z.
+00002ba0: 4750 412e 7368 6f77 5f69 6d61 6765 725e  GPA.show_imager^
+00002bb0: 0000 00a9 02e9 0a00 0000 7273 0000 0063  ..........rs...c
+00002bc0: 0500 0000 0000 0000 0000 0000 1000 0000  ................
+00002bd0: 0900 0000 4300 0000 7340 0200 007c 006a  ....C...s@...|.j
+00002be0: 0064 011b 0074 01a0 027c 01a1 017c 006a  .d...t...|...|.j
+00002bf0: 031b 0017 007c 005f 047c 006a 0064 011b  .....|._.|.j.d..
+00002c00: 0074 01a0 027c 02a1 017c 006a 031b 0017  .t...|...|.j....
+00002c10: 007c 005f 057c 037c 005f 0674 01a0 0774  .|._.|.|._.t...t
+00002c20: 01a0 0874 01a0 097c 006a 0064 0219 00a1  ...t...|.j.d....
+00002c30: 0174 01a0 097c 006a 0064 0319 00a1 01a1  .t...|.j.d......
+00002c40: 02a1 017c 005f 0a74 016a 0ba0 0c74 016a  ...|._.t.j...t.j
+00002c50: 0ba0 0d7c 006a 0e7c 006a 0a14 00a1 01a1  ...|.j.|.j......
+00002c60: 017c 005f 0f74 106a 11a0 1274 01a0 1374  .|._.t.j...t...t
+00002c70: 01a0 147c 006a 0fa1 01a1 0164 04a1 027d  ...|.j.....d...}
+00002c80: 0574 01a0 1564 057c 006a 0314 007c 006a  .t...d.|.j...|.j
+00002c90: 0064 0219 0014 0064 067c 006a 0314 007c  .d.....d.|.j...|
+00002ca0: 006a 0064 0219 0014 007c 006a 03a1 037d  .j.d.....|.j...}
+00002cb0: 0664 077d 0774 167c 006a 0064 0219 007c  .d.}.t.|.j.d...|
+00002cc0: 0764 0318 001b 0083 017d 0874 01a0 1564  .d.......}.t...d
+00002cd0: 027c 006a 0064 0219 007c 08a1 037d 0974  .|.j.d...|...}.t
+00002ce0: 01a0 177c 0664 0864 087c 0885 0319 0064  ...|.d.d.|.....d
+00002cf0: 03a1 027d 0a74 186a 197c 0464 098d 015c  ...}.t.j.|.d...\
+00002d00: 027d 0b7d 0c74 186a 1a7c 006a 1b7c 006a  .}.}.t.j.|.j.|.j
+00002d10: 0664 0a64 0b64 0c8d 047d 0d74 186a 1a7c  .d.d.d...}.t.j.|
+00002d20: 006a 047c 006a 0664 0d64 0b64 0c8d 047d  .j.|.j.d.d.d...}
+00002d30: 0e74 186a 1a7c 006a 057c 006a 0664 0e64  .t.j.|.j.|.j.d.d
+00002d40: 0b64 0c8d 047d 0f7c 0c6a 1c7c 0564 0f64  .d...}.|.j.|.d.d
+00002d50: 108d 0201 007c 0ca0 1d7c 0da1 0101 007c  .....|...|.....|
+00002d60: 0ca0 1d7c 0ea1 0101 007c 0ca0 1d7c 0fa1  ...|.....|...|..
+00002d70: 0101 0074 18a0 1e7c 097c 0aa1 0201 0074  ...t...|.|.....t
+00002d80: 18a0 1f7c 097c 0aa1 0201 0074 18a0 2064  ...|.|.....t.. d
+00002d90: 117c 006a 2117 0064 1217 00a1 0101 0074  .|.j!..d.......t
+00002da0: 18a0 2264 137c 006a 2117 0064 1217 00a1  .."d.|.j!..d....
+00002db0: 0101 0074 236a 24a0 257c 006a 047c 006a  ...t#j$.%|.j.|.j
+00002dc0: 0ea1 027c 005f 2674 236a 24a0 257c 006a  ...|._&t#j$.%|.j
+00002dd0: 057c 006a 0ea1 027c 005f 2774 236a 24a0  .|.j...|._'t#j$.
+00002de0: 287c 006a 267c 006a 0e7c 006a 067c 006a  (|.j&|.j.|.j.|.j
+00002df0: 29a1 047c 005f 2a74 236a 24a0 287c 006a  )..|._*t#j$.(|.j
+00002e00: 277c 006a 0e7c 006a 067c 006a 29a1 047c  '|.j.|.j.|.j)..|
+00002e10: 005f 2b64 147c 005f 2c64 0853 0029 1561  ._+d.|._,d.S.).a
+00002e20: ee03 0000 0a20 2020 2020 2020 204c 6f63  .....        Loc
+00002e30: 6174 6520 7468 6520 6469 6666 7261 6374  ate the diffract
+00002e40: 696f 6e20 7370 6f74 7320 7669 7375 616c  ion spots visual
+00002e50: 6c79 2e0a 0a20 2020 2020 2020 2050 6172  ly...        Par
+00002e60: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00002e70: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00002e80: 2020 2063 6972 6331 3a20 2020 2020 6e64     circ1:     nd
+00002e90: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00002ea0: 2020 2020 2020 2020 2050 6f73 6974 696f           Positio
+00002eb0: 6e20 6f66 2074 6865 2066 6972 7374 2062  n of the first b
+00002ec0: 6561 6d20 696e 0a20 2020 2020 2020 2020  eam in.         
+00002ed0: 2020 2020 2020 2020 2020 7468 6520 466f            the Fo
+00002ee0: 7572 6965 7220 7061 7474 6572 6e0a 2020  urier pattern.  
+00002ef0: 2020 2020 2020 6369 7263 323a 2020 2020        circ2:    
+00002f00: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00002f10: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+00002f20: 7469 6f6e 206f 6620 7468 6520 7365 636f  tion of the seco
+00002f30: 6e64 2062 6561 6d20 696e 0a20 2020 2020  nd beam in.     
+00002f40: 2020 2020 2020 2020 2020 2020 2020 7468                th
+00002f50: 6520 466f 7572 6965 7220 7061 7474 6572  e Fourier patter
+00002f60: 6e0a 2020 2020 2020 2020 6369 7263 5f73  n.        circ_s
+00002f70: 697a 653a 2066 6c6f 6174 0a20 2020 2020  ize: float.     
+00002f80: 2020 2020 2020 2020 2020 2020 2020 5369                Si
+00002f90: 7a65 206f 6620 7468 6520 6369 7263 6c65  ze of the circle
+00002fa0: 2069 6e20 7069 7865 6c73 0a20 2020 2020   in pixels.     
+00002fb0: 2020 2069 6d73 697a 653a 2020 2020 7475     imsize:    tu
+00002fc0: 706c 652c 206f 7074 696f 6e61 6c0a 2020  ple, optional.  
+00002fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002fe0: 2053 697a 6520 696e 2069 6e63 6865 7320   Size in inches 
+00002ff0: 6f66 2074 6865 2069 6d61 6765 2077 6974  of the image wit
+00003000: 6820 7468 650a 2020 2020 2020 2020 2020  h the.          
+00003010: 2020 2020 2020 2020 2064 6966 6672 6163           diffrac
+00003020: 7469 6f6e 2073 706f 7473 206d 6172 6b65  tion spots marke
+00003030: 642e 2044 6566 6175 6c74 2069 730a 2020  d. Default is.  
+00003040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003050: 2028 3130 2c20 3130 290a 0a20 2020 2020   (10, 10)..     
+00003060: 2020 204e 6f74 6573 0a20 2020 2020 2020     Notes.       
+00003070: 202d 2d2d 2d2d 0a20 2020 2020 2020 2050   -----.        P
+00003080: 7574 2063 6972 636c 6573 2069 6e20 7265  ut circles in re
+00003090: 6428 6365 6e74 7261 6c29 2c20 7928 626c  d(central), y(bl
+000030a0: 7565 2920 616e 6420 7828 6772 6565 6e29  ue) and x(green)
+000030b0: 0a20 2020 2020 2020 206f 6e20 7468 6520  .        on the 
+000030c0: 6469 6666 7261 6374 696f 6e20 7061 7474  diffraction patt
+000030d0: 6572 6e20 746f 2061 7070 726f 7869 6d61  ern to approxima
+000030e0: 7465 6c79 206b 6e6f 770a 2020 2020 2020  tely know.      
+000030f0: 2020 7468 6520 706f 7369 7469 6f6e 732e    the positions.
+00003100: 2057 6520 616c 736f 2063 6f6e 7665 7274   We also convert
+00003110: 2074 6865 2063 6972 636c 6520 6c6f 6361   the circle loca
+00003120: 7469 6f6e 730a 2020 2020 2020 2020 746f  tions.        to
+00003130: 2047 2076 6563 746f 7273 2062 7920 6361   G vectors by ca
+00003140: 6c6c 696e 6720 7468 6520 7374 6174 6963  lling the static
+00003150: 206d 6574 686f 6420 6063 6972 635f 746f   method `circ_to
+00003160: 5f47 602e 0a20 2020 2020 2020 2057 6520  _G`..        We 
+00003170: 7573 6520 7468 6520 4720 7665 6374 6f72  use the G vector
+00003180: 206c 6f63 6174 696f 6e73 2074 6f20 616c   locations to al
+00003190: 736f 2067 656e 6572 6174 6520 7468 650a  so generate the.
+000031a0: 2020 2020 2020 2020 696e 6974 6961 6c20          initial 
+000031b0: 7068 6173 6520 6d61 7472 6963 6573 2e0a  phase matrices..
+000031c0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+000031d0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+000031e0: 2d2d 0a20 2020 2020 2020 2063 6972 635f  --.        circ_
+000031f0: 746f 5f47 0a20 2020 2020 2020 2070 6861  to_G.        pha
+00003200: 7365 5f6d 6174 7269 780a 2020 2020 2020  se_matrix.      
+00003210: 2020 7213 0000 0072 0100 0000 7204 0000    r....r....r...
+00003220: 00e9 0300 0000 7227 0000 0072 1400 0000  ......r'...r....
+00003230: e909 0000 004e 7260 0000 005a 0372 6564  .....Nr`...Z.red
+00003240: 6700 0000 0000 00e8 3f29 0272 6d00 0000  g.......?).rm...
+00003250: da05 616c 7068 615a 0462 6c75 655a 0567  ..alphaZ.blueZ.g
+00003260: 7265 656e 5a04 6772 6179 7261 0000 00fa  reenZ.grayra....
+00003270: 1744 6973 7461 6e63 6520 616c 6f6e 6720  .Distance along 
+00003280: 582d 6178 6973 2028 fa01 29fa 1744 6973  X-axis (..)..Dis
+00003290: 7461 6e63 6520 616c 6f6e 6720 592d 6178  tance along Y-ax
+000032a0: 6973 2028 5429 2d72 3600 0000 7208 0000  is (T)-r6...r...
+000032b0: 0072 1700 0000 7253 0000 005a 0663 6972  .r....rS...Z.cir
+000032c0: 635f 315a 0663 6972 635f 3272 3500 0000  c_1Z.circ_2r5...
+000032d0: 722c 0000 0072 2d00 0000 722e 0000 0072  r,...r-...r....r
+000032e0: 3900 0000 7232 0000 0072 3300 0000 7234  9...r2...r3...r4
+000032f0: 0000 0072 1900 0000 5a08 696d 6167 655f  ...r....Z.image_
+00003300: 6674 da04 7363 6e64 da07 6669 6c74 6572  ft..scnd..filter
+00003310: 735a 0f67 6175 7373 6961 6e5f 6669 6c74  sZ.gaussian_filt
+00003320: 6572 da05 6c6f 6731 30da 0361 6273 7221  er..log10..absr!
+00003330: 0000 0072 5000 0000 da05 726f 756e 6472  ...rP.....roundr
+00003340: 6600 0000 5a08 7375 6270 6c6f 7473 5a06  f...Z.subplotsZ.
+00003350: 4369 7263 6c65 7255 0000 0072 6800 0000  CirclerU...rh...
+00003360: 726e 0000 00da 0678 7469 636b 73da 0679  rn.....xticks..y
+00003370: 7469 636b 73da 0678 6c61 6265 6c72 5600  ticks..xlabelrV.
+00003380: 0000 da06 796c 6162 656c 7229 0000 00da  ....ylabelr)....
+00003390: 0367 7061 721b 0000 00da 0a67 7665 635f  .gpar......gvec_
+000033a0: 315f 696e 69da 0a67 7665 635f 325f 696e  1_ini..gvec_2_in
+000033b0: 6972 3b00 0000 724f 0000 00da 0d50 5f6d  ir;...rO.....P_m
+000033c0: 6174 7269 7831 5f69 6e69 da0d 505f 6d61  atrix1_ini..P_ma
+000033d0: 7472 6978 325f 696e 6972 5800 0000 2910  trix2_inirX...).
+000033e0: 725b 0000 005a 0563 6972 6331 5a05 6369  r[...Z.circ1Z.ci
+000033f0: 7263 3272 3500 0000 726f 0000 005a 0a6c  rc2r5...ro...Z.l
+00003400: 6f67 5f61 6273 5f66 74da 0a70 6978 656c  og_abs_ft..pixel
+00003410: 5f6c 6973 74da 096e 6f5f 6c61 6265 6c73  _list..no_labels
+00003420: da06 7374 6570 5f78 da0b 785f 706f 7369  ..step_x..x_posi
+00003430: 7469 6f6e 73da 0878 5f6c 6162 656c 73da  tions..x_labels.
+00003440: 015f 5a02 6178 5a09 6369 7263 5f30 5f69  ._Z.axZ.circ_0_i
+00003450: 6d5a 0963 6972 635f 315f 696d 5a09 6369  mZ.circ_1_imZ.ci
+00003460: 7263 5f32 5f69 6d72 0e00 0000 720e 0000  rc_2_imr....r...
+00003470: 0072 0f00 0000 da0a 6669 6e64 5f73 706f  .r......find_spo
+00003480: 7473 8f01 0000 734c 0000 001c 211c 0106  ts....sL....!...
+00003490: 0104 0122 0106 ff1e 031c 0104 0212 0112  ..."............
+000034a0: 0104 0104 fd04 0516 0114 0116 0110 0216  ................
+000034b0: 0116 0116 010e 010a 010a 010a 010c 010c  ................
+000034c0: 0114 0114 0114 0214 0106 0110 0106 ff06  ................
+000034d0: 0310 0106 ff0a 037a 0e47 5041 2e66 696e  .......z.GPA.fin
+000034e0: 645f 7370 6f74 7372 6400 0000 6307 0000  d_spotsrd...c...
+000034f0: 0000 0000 0000 0000 001c 0000 0008 0000  ................
+00003500: 0043 0000 0073 2804 0000 7c00 6a00 7307  .C...s(...|.j.s.
+00003510: 7401 6401 8301 8201 7402 a003 7c01 a101  t.d.....t...|...
+00003520: 7c00 6a04 1b00 7d07 7402 a003 7c02 a101  |.j...}.t...|...
+00003530: 7c00 6a04 1b00 7d08 7402 a003 7c03 a101  |.j...}.t...|...
+00003540: 7c00 6a04 1b00 7d09 7402 a003 7c04 a101  |.j...}.t...|...
+00003550: 7c00 6a04 1b00 7d0a 7402 6a05 6402 7c00  |.j...}.t.j.d.|.
+00003560: 6a06 6402 1900 8502 6402 7c00 6a06 6403  j.d.....d.|.j.d.
+00003570: 1900 8502 6602 1900 5c02 7d0b 7d0c 7402  ....f...\.}.}.t.
+00003580: a007 7c0b a101 7d0b 7402 a007 7c0c a101  ..|...}.t...|...
+00003590: 7d0c 7402 a003 7c0c 7c0b 6602 a101 a008  }.t...|.|.f.....
+000035a0: a100 7c07 1800 7d0d 7402 a003 7c0c 7c0b  ..|...}.t...|.|.
+000035b0: 6602 a101 a008 a100 7c08 1800 7d0e 7402  f.......|...}.t.
+000035c0: a003 7c0c 7c0b 6602 a101 a008 a100 7c09  ..|.|.f.......|.
+000035d0: 1800 7d0f 7402 a003 7c0c 7c0b 6602 a101  ..}.t...|.|.f...
+000035e0: a008 a100 7c0a 1800 7d10 7402 a009 7402  ....|...}.t...t.
+000035f0: 6a0a 7c0d 7c0e 1400 6403 6404 8d02 7402  j.|.|...d.d...t.
+00003600: 6a0a 7c0d 6405 1300 6403 6404 8d02 6406  j.|.d...d.d...d.
+00003610: 1300 7402 6a0a 7c0e 6405 1300 6403 6404  ..t.j.|.d...d.d.
+00003620: 8d02 6406 1300 1400 1b00 a101 7d11 7402  ..d.........}.t.
+00003630: a009 7402 6a0a 7c0e 7c0f 1400 6403 6404  ..t.j.|.|...d.d.
+00003640: 8d02 7402 6a0a 7c0e 6405 1300 6403 6404  ..t.j.|.d...d.d.
+00003650: 8d02 6406 1300 7402 6a0a 7c0f 6405 1300  ..d...t.j.|.d...
+00003660: 6403 6404 8d02 6406 1300 1400 1b00 a101  d.d...d.........
+00003670: 7d12 7402 a009 7402 6a0a 7c0f 7c10 1400  }.t...t.j.|.|...
+00003680: 6403 6404 8d02 7402 6a0a 7c0f 6405 1300  d.d...t.j.|.d...
+00003690: 6403 6404 8d02 6406 1300 7402 6a0a 7c10  d.d...d...t.j.|.
+000036a0: 6405 1300 6403 6404 8d02 6406 1300 1400  d...d.d...d.....
+000036b0: 1b00 a101 7d13 7402 a009 7402 6a0a 7c10  ....}.t...t.j.|.
+000036c0: 7c0d 1400 6403 6404 8d02 7402 6a0a 7c10  |...d.d...t.j.|.
+000036d0: 6405 1300 6403 6404 8d02 6406 1300 7402  d...d.d...d...t.
+000036e0: 6a0a 7c0d 6405 1300 6403 6404 8d02 6406  j.|.d...d.d...d.
+000036f0: 1300 1400 1b00 a101 7d14 7c11 7c12 1700  ........}.|.|...
+00003700: 7c13 1700 7c14 1700 6405 7402 6a0b 1400  |...|...d.t.j...
+00003710: 1b00 a00c 7c00 6a0d 6a0e a101 7d15 7402  ....|.j.j...}.t.
+00003720: a00f 7c15 6403 a102 7c00 5f10 7402 a011  ..|.d...|._.t...
+00003730: 7c00 6a10 a101 7c00 5f10 7402 a012 6402  |.j...|._.t...d.
+00003740: 7c00 6a04 7c00 6a06 6402 1900 1400 7c00  |.j.|.j.d.....|.
+00003750: 6a04 a103 7d16 6407 7d17 7413 7c00 6a06  j...}.d.}.t.|.j.
+00003760: 6402 1900 7c17 6403 1800 1b00 8301 7d18  d...|.d.......}.
+00003770: 7402 a012 6402 7c00 6a06 6402 1900 7c18  t...d.|.j.d...|.
+00003780: a103 7d19 7402 a014 7c16 6408 6408 7c18  ..}.t...|.d.d.|.
+00003790: 8503 1900 6403 a102 7d1a 7413 6409 7402  ....d...}.t.d.t.
+000037a0: a015 7402 a003 7c05 a101 a101 1400 8301  ..t...|.........
+000037b0: 7d1b 7416 640a 8301 0100 7417 6a18 7c05  }.t.d.....t.j.|.
+000037c0: 640b 8d01 0100 7417 6a19 7402 a011 741a  d.....t.j.t...t.
+000037d0: 6a1b a01c 7c00 6a0d a101 640c 7c00 6a10  j...|.j...d.|.j.
+000037e0: 1400 1700 a101 640d 640e 640f 8d03 0100  ......d.d.d.....
+000037f0: 7417 6a1d 6410 741e 7c01 8301 1700 7c07  t.j.d.t.|.....|.
+00003800: 7c00 6a06 1b00 6411 7c1b 7c06 6412 8d05  |.j...d.|.|.d...
+00003810: 0100 7417 6a1d 6413 741e 7c02 8301 1700  ..t.j.d.t.|.....
+00003820: 7c08 7c00 6a06 1b00 6411 7c1b 7c06 6412  |.|.j...d.|.|.d.
+00003830: 8d05 0100 7417 6a1d 6414 741e 7c03 8301  ....t.j.d.t.|...
+00003840: 1700 7c09 7c00 6a06 1b00 6411 7c1b 7c06  ..|.|.j...d.|.|.
+00003850: 6412 8d05 0100 7417 6a1d 6415 741e 7c04  d.....t.j.d.t.|.
+00003860: 8301 1700 7c0a 7c00 6a06 1b00 6411 7c1b  ....|.|.j...d.|.
+00003870: 7c06 6412 8d05 0100 7417 6a1f 7c07 6402  |.d.....t.j.|.d.
+00003880: 1900 7c07 6403 1900 6416 6417 8d03 0100  ..|.d...d.d.....
+00003890: 7417 6a1f 7c08 6402 1900 7c08 6403 1900  t.j.|.d...|.d...
+000038a0: 6416 6417 8d03 0100 7417 6a1f 7c09 6402  d.d.....t.j.|.d.
+000038b0: 1900 7c09 6403 1900 6416 6417 8d03 0100  ..|.d...d.d.....
+000038c0: 7417 6a1f 7c0a 6402 1900 7c0a 6403 1900  t.j.|.d...|.d...
+000038d0: 6416 6417 8d03 0100 7417 6a20 7c19 7c1a  d.d.....t.j |.|.
+000038e0: 7c1b 6418 8d03 0100 7417 6a21 7c19 7c1a  |.d.....t.j!|.|.
+000038f0: 7c1b 6418 8d03 0100 7417 6a22 6419 7c00  |.d.....t.j"d.|.
+00003900: 6a23 1700 641a 1700 7c1b 6418 8d02 0100  j#..d...|.d.....
+00003910: 7417 6a24 641b 7c00 6a23 1700 641a 1700  t.j$d.|.j#..d...
+00003920: 7c1b 6418 8d02 0100 641c 7c00 5f25 6408  |.d.....d.|._%d.
+00003930: 5300 291d 6148 0300 000a 2020 2020 2020  S.).aH....      
+00003940: 2020 4c6f 6361 7465 2074 6865 2072 6566    Locate the ref
+00003950: 6572 656e 6365 2069 6d61 6765 2e0a 0a20  erence image... 
+00003960: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00003970: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00003980: 2d2d 2d2d 0a20 2020 2020 2020 2041 5f70  ----.        A_p
+00003990: 743a 2020 2074 7570 6c65 0a20 2020 2020  t:   tuple.     
+000039a0: 2020 2020 2020 2020 2020 2054 6f70 206c             Top l
+000039b0: 6566 7420 706f 7369 7469 6f6e 206f 6620  eft position of 
+000039c0: 7265 6665 7265 6e63 6520 7265 6769 6f6e  reference region
+000039d0: 2069 6e20 2878 2c20 7929 0a20 2020 2020   in (x, y).     
+000039e0: 2020 2042 5f70 743a 2020 2074 7570 6c65     B_pt:   tuple
+000039f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003a00: 2054 6f70 2072 6967 6874 2070 6f73 6974   Top right posit
+00003a10: 696f 6e20 6f66 2072 6566 6572 656e 6365  ion of reference
+00003a20: 2072 6567 696f 6e20 696e 2028 782c 2079   region in (x, y
+00003a30: 290a 2020 2020 2020 2020 435f 7074 3a20  ).        C_pt: 
+00003a40: 2020 7475 706c 650a 2020 2020 2020 2020    tuple.        
+00003a50: 2020 2020 2020 2020 426f 7474 6f6d 2072          Bottom r
+00003a60: 6967 6874 2070 6f73 6974 696f 6e20 6f66  ight position of
+00003a70: 2072 6566 6572 656e 6365 2072 6567 696f   reference regio
+00003a80: 6e20 696e 2028 782c 2079 290a 2020 2020  n in (x, y).    
+00003a90: 2020 2020 445f 7074 3a20 2020 7475 706c      D_pt:   tupl
+00003aa0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00003ab0: 2020 426f 7474 6f6d 206c 6566 7420 706f    Bottom left po
+00003ac0: 7369 7469 6f6e 206f 6620 7265 6665 7265  sition of refere
+00003ad0: 6e63 6520 7265 6769 6f6e 2069 6e20 2878  nce region in (x
+00003ae0: 2c20 7929 0a20 2020 2020 2020 2069 6d73  , y).        ims
+00003af0: 697a 653a 2074 7570 6c65 2c20 6f70 7469  ize: tuple, opti
+00003b00: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00003b10: 2020 2020 2053 697a 6520 696e 2069 6e63       Size in inc
+00003b20: 6865 7320 6f66 2074 6865 2069 6d61 6765  hes of the image
+00003b30: 2077 6974 6820 7468 650a 2020 2020 2020   with the.      
+00003b40: 2020 2020 2020 2020 2020 6469 6666 7261            diffra
+00003b50: 6374 696f 6e20 7370 6f74 7320 6d61 726b  ction spots mark
+00003b60: 6564 2e20 4465 6661 756c 7420 6973 0a20  ed. Default is. 
+00003b70: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+00003b80: 3130 2c20 3130 290a 2020 2020 2020 2020  10, 10).        
+00003b90: 7443 6f6c 6f72 3a20 7374 722c 206f 7074  tColor: str, opt
+00003ba0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00003bb0: 2020 2020 2020 436f 6c6f 7220 6f66 2074        Color of t
+00003bc0: 6865 2074 6578 7420 6f6e 2074 6865 2069  he text on the i
+00003bd0: 6d61 6765 0a0a 2020 2020 2020 2020 4e6f  mage..        No
+00003be0: 7465 730a 2020 2020 2020 2020 2d2d 2d2d  tes.        ----
+00003bf0: 2d0a 2020 2020 2020 2020 4c6f 6361 7465  -.        Locate
+00003c00: 7320 6120 7265 6665 7265 6e63 6520 7265  s a reference re
+00003c10: 6769 6f6e 2062 6f75 6e64 6564 2062 7920  gion bounded by 
+00003c20: 7468 6520 666f 7572 2070 6f69 6e74 7320  the four points 
+00003c30: 6769 7665 6e20 696e 0a20 2020 2020 2020  given in.       
+00003c40: 206c 656e 6774 6820 756e 6974 732e 2043   length units. C
+00003c50: 686f 6f73 6520 7468 6520 706f 696e 7473  hoose the points
+00003c60: 2069 6e20 6120 636c 6f63 6b77 6973 6520   in a clockwise 
+00003c70: 6661 7368 696f 6e2e 0a20 2020 2020 2020  fashion..       
+00003c80: 207a 3950 6c65 6173 6520 6c6f 6361 7465   z9Please locate
+00003c90: 2074 6865 2064 6966 6672 6163 7469 6f6e   the diffraction
+00003ca0: 2073 706f 7473 2066 6972 7374 2061 7320   spots first as 
+00003cb0: 6669 6e64 5f73 706f 7473 2829 7201 0000  find_spots()r...
+00003cc0: 0072 0400 0000 7205 0000 0072 1300 0000  .r....r....r....
+00003cd0: 7214 0000 0072 7300 0000 4e67 0000 0000  r....rs...Ng....
+00003ce0: 0000 f83f 7a4e 4368 6f6f 7365 2079 6f75  ...?zNChoose you
+00003cf0: 7220 706f 696e 7473 2069 6e20 6120 636c  r points in a cl
+00003d00: 6f63 6b77 6973 6520 6661 7368 696f 6e2c  ockwise fashion,
+00003d10: 206f 7220 656c 7365 2079 6f75 2077 696c   or else you wil
+00003d20: 6c20 6765 7420 6120 7772 6f6e 6720 7265  l get a wrong re
+00003d30: 7375 6c74 7260 0000 0067 1f85 eb51 b81e  sultr`...g...Q..
+00003d40: d53f 5a05 6d61 676d 61da 056c 6f77 6572  .?Z.magma..lower
+00003d50: 2902 7262 0000 00da 066f 7269 6769 6e7a  ).rb.....originz
+00003d60: 0241 3d7a 0d61 7865 7320 6672 6163 7469  .A=z.axes fracti
+00003d70: 6f6e 2903 5a0a 7465 7874 636f 6f72 6473  on).Z.textcoords
+00003d80: da04 7369 7a65 726d 0000 007a 0242 3d7a  ..sizerm...z.B=z
+00003d90: 0243 3d7a 0244 3dda 0172 2901 da01 6329  .C=z.D=..r)...c)
+00003da0: 01da 0866 6f6e 7473 697a 6572 7700 0000  ...fontsizerw...
+00003db0: 7278 0000 0072 7900 0000 5429 2672 5800  rx...ry...T)&rX.
+00003dc0: 0000 7254 0000 0072 0800 0000 7217 0000  ..rT...r....r...
+00003dd0: 0072 4d00 0000 7228 0000 0072 3600 0000  .rM...r(...r6...
+00003de0: 723d 0000 00da 0974 7261 6e73 706f 7365  r=.....transpose
+00003df0: 5a06 6172 6363 6f73 722f 0000 0072 2300  Z.arccosr/...r#.
+00003e00: 0000 da07 7265 7368 6170 6572 1900 0000  ....reshaper....
+00003e10: 720b 0000 00da 0769 7363 6c6f 7365 da07  r......isclose..
+00003e20: 7265 665f 7265 675a 0666 6c69 7075 6472  ref_regZ.flipudr
+00003e30: 2100 0000 7250 0000 0072 7e00 0000 7252  !...rP...r~...rR
+00003e40: 0000 00da 0570 7269 6e74 7266 0000 0072  .....printrf...r
+00003e50: 6700 0000 7268 0000 0072 2900 0000 722a  g...rh...r)...r*
+00003e60: 0000 005a 1069 6d61 6765 5f6e 6f72 6d61  ...Z.image_norma
+00003e70: 6c69 7a65 725a 0861 6e6e 6f74 6174 65da  lizerZ.annotate.
+00003e80: 0373 7472 5a07 7363 6174 7465 7272 7f00  .strZ.scatterr..
+00003e90: 0000 7280 0000 0072 8100 0000 724e 0000  ..r....r....rN..
+00003ea0: 0072 8200 0000 7259 0000 0029 1c72 5b00  .r....rY...).r[.
+00003eb0: 0000 5a04 415f 7074 5a04 425f 7074 5a04  ..Z.A_ptZ.B_ptZ.
+00003ec0: 435f 7074 5a04 445f 7074 726f 0000 005a  C_ptZ.D_ptro...Z
+00003ed0: 0674 436f 6c6f 72da 0141 da01 42da 0143  .tColor..A..B..C
+00003ee0: da01 4472 3700 0000 7238 0000 005a 0470  ..Dr7...r8...Z.p
+00003ef0: 7441 415a 0470 7442 425a 0470 7443 435a  tAAZ.ptBBZ.ptCCZ
+00003f00: 0470 7444 445a 0761 6e67 4141 4242 5a07  .ptDDZ.angAABBZ.
+00003f10: 616e 6742 4243 435a 0761 6e67 4343 4444  angBBCCZ.angCCDD
+00003f20: 5a07 616e 6744 4441 415a 0661 6e67 7375  Z.angDDAAZ.angsu
+00003f30: 6d72 8800 0000 7289 0000 0072 8a00 0000  mr....r....r....
+00003f40: 728b 0000 0072 8c00 0000 da05 6673 697a  r....r......fsiz
+00003f50: 6572 0e00 0000 720e 0000 0072 0f00 0000  er....r....r....
+00003f60: da10 6465 6669 6e65 5f72 6566 6572 656e  ..define_referen
+00003f70: 6365 da01 0000 73c8 0000 0006 1a02 0102  ce....s.........
+00003f80: 0104 ff10 0410 0110 0110 0126 020a 010a  ...........&....
+00003f90: 0116 0116 0116 0116 0104 0110 0114 0214  ................
+00003fa0: 0102 ff02 fe04 ff04 0710 0114 0214 0102  ................
+00003fb0: ff02 fe04 ff04 0710 0114 0214 0102 ff02  ................
+00003fc0: fe04 ff04 0710 0114 0214 0102 ff02 fe04  ................
+00003fd0: ff1a 0706 0104 ff0e 030e 011c 0204 0116  ................
+00003fe0: 0114 0116 0118 0102 0202 0104 ff0c 0404  ................
+00003ff0: 011c 0102 0102 0106 fd04 050a 0108 0102  ................
+00004000: 0102 0102 0106 fb04 070a 0108 0102 0102  ................
+00004010: 0102 0106 fb04 070a 0108 0102 0102 0102  ................
+00004020: 0106 fb04 070a 0108 0102 0102 0102 0106  ................
+00004030: fb18 0718 0118 0118 0110 0110 0118 0118  ................
+00004040: 010a 017a 1447 5041 2e64 6566 696e 655f  ...z.GPA.define_
+00004050: 7265 6665 7265 6e63 6563 0100 0000 0000  referencec......
+00004060: 0000 0000 0000 0e00 0000 0900 0000 4300  ..............C.
+00004070: 0000 73b8 0100 007c 006a 0073 0774 0164  ..s....|.j.s.t.d
+00004080: 0183 0182 0174 026a 037c 006a 0464 0219  .....t.j.|.j.d..
+00004090: 000b 0064 031b 007c 006a 0464 0219 0064  ...d...|.j.d...d
+000040a0: 031b 0064 0464 058d 037d 0174 026a 037c  ...d.d...}.t.j.|
+000040b0: 006a 0464 0419 000b 0064 031b 007c 006a  .j.d.....d...|.j
+000040c0: 0464 0419 0064 031b 0064 0464 058d 037d  .d...d...d.d...}
+000040d0: 0274 02a0 057c 027c 01a1 025c 027d 037d  .t...|.|...\.}.}
+000040e0: 047c 006a 067c 005f 077c 006a 087c 005f  .|.j.|._.|.j.|._
+000040f0: 097c 006a 0a7c 005f 0b7c 006a 0c7c 005f  .|.j.|._.|.j.|._
+00004100: 0d74 0e74 0f7c 006a 1083 0183 0144 005d  .t.t.|.j.....D.]
+00004110: 8a7d 0574 116a 12a0 137c 006a 0ba1 015c  .}.t.j...|.j...\
+00004120: 027d 067d 0774 116a 12a0 137c 006a 0da1  .}.}.t.j...|.j..
+00004130: 015c 027d 087d 097c 067c 0717 0064 0374  .\.}.}.|.|...d.t
+00004140: 026a 1414 001b 007d 0a7c 087c 0917 0064  .j.....}.|.|...d
+00004150: 0374 026a 1414 001b 007d 0b74 02a0 1574  .t.j.....}.t...t
+00004160: 02a0 167c 0a7c 006a 1719 007c 047c 006a  ...|.|.j...|.|.j
+00004170: 1719 001b 00a1 0174 02a0 167c 0a7c 006a  .......t...|.|.j
+00004180: 1719 007c 037c 006a 1719 001b 00a1 0166  ...|.|.j.......f
+00004190: 02a1 017d 0c74 02a0 1574 02a0 167c 0b7c  ...}.t...t...|.|
+000041a0: 006a 1719 007c 047c 006a 1719 001b 00a1  .j...|.|.j......
+000041b0: 0174 02a0 167c 0b7c 006a 1719 007c 037c  .t...|.|.j...|.|
+000041c0: 006a 1719 001b 00a1 0166 02a1 017d 0d7c  .j.......f...}.|
+000041d0: 0004 006a 077c 0c37 0002 005f 077c 0004  ...j.|.7..._.|..
+000041e0: 006a 097c 0d37 0002 005f 0974 116a 12a0  .j.|.7..._.t.j..
+000041f0: 187c 006a 077c 006a 197c 006a 1a7c 006a  .|.j.|.j.|.j.|.j
+00004200: 1ba1 047c 005f 0b74 116a 12a0 187c 006a  ...|._.t.j...|.j
+00004210: 097c 006a 197c 006a 1a7c 006a 1ba1 047c  .|.j.|.j.|.j...|
+00004220: 005f 0d71 4c64 067c 005f 1c64 0753 0029  ._.qLd.|._.d.S.)
+00004230: 0861 8601 0000 0a20 2020 2020 2020 2052  .a.....        R
+00004240: 6566 696e 6520 7468 6520 7068 6173 6520  efine the phase 
+00004250: 6d61 7472 6963 6573 2061 6e64 2074 6865  matrices and the
+00004260: 2047 2076 6563 746f 7273 0a20 2020 2020   G vectors.     
+00004270: 2020 2066 726f 6d20 7468 6569 7220 696e     from their in
+00004280: 6974 6961 6c20 7661 6c75 6573 2075 7369  itial values usi
+00004290: 6e67 2074 6865 2072 6566 6572 656e 6365  ng the reference
+000042a0: 0a20 2020 2020 2020 2072 6567 696f 6e20  .        region 
+000042b0: 6c6f 6361 7469 6f6e 2e0a 0a20 2020 2020  location...     
+000042c0: 2020 204e 6f74 6573 0a20 2020 2020 2020     Notes.       
+000042d0: 202d 2d2d 2d2d 0a20 2020 2020 2020 2049   -----.        I
+000042e0: 7465 7261 7469 7665 6c79 2072 6566 696e  teratively refin
+000042f0: 6520 7468 6520 4720 7665 6374 6f72 2061  e the G vector a
+00004300: 6e64 2074 6865 2070 6861 7365 206d 6174  nd the phase mat
+00004310: 7269 6365 732c 0a20 2020 2020 2020 2073  rices,.        s
+00004320: 6f20 7468 6174 2074 6865 2070 6861 7365  o that the phase
+00004330: 2076 6172 6961 7469 6f6e 2069 6e20 7468   variation in th
+00004340: 6520 7265 6665 7265 6e63 6520 7265 6769  e reference regi
+00004350: 6f6e 2069 730a 2020 2020 2020 2020 6d69  on is.        mi
+00004360: 6e69 6d69 7a65 642e 0a0a 2020 2020 2020  nimized...      
+00004370: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00004380: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00004390: 2020 2020 7068 6173 655f 6469 6666 0a20      phase_diff. 
+000043a0: 2020 2020 2020 2070 6861 7365 5f6d 6174         phase_mat
+000043b0: 7269 780a 2020 2020 2020 2020 7a3e 506c  rix.        z>Pl
+000043c0: 6561 7365 206c 6f63 6174 6520 7468 6520  ease locate the 
+000043d0: 7265 6665 7265 6e63 6520 7265 6769 6f6e  reference region
+000043e0: 2066 6972 7374 2061 7320 6465 6669 6e65   first as define
+000043f0: 5f72 6566 6572 656e 6365 2829 7201 0000  _reference()r...
+00004400: 0072 1300 0000 7204 0000 0072 1d00 0000  .r....r....r....
+00004410: 544e 291d 7259 0000 0072 5400 0000 7208  TN).rY...rT...r.
+00004420: 0000 0072 2100 0000 7236 0000 0072 2200  ...r!...r6...r".
+00004430: 0000 7284 0000 00da 0a67 7665 635f 315f  ..r......gvec_1_
+00004440: 6669 6e72 8500 0000 da0a 6776 6563 5f32  finr......gvec_2
+00004450: 5f66 696e 7286 0000 00da 0d50 5f6d 6174  _finr......P_mat
+00004460: 7269 7831 5f66 696e 7287 0000 005a 0d50  rix1_finr....Z.P
+00004470: 5f6d 6174 7269 7832 5f66 696e 723e 0000  _matrix2_finr>..
+00004480: 0072 5000 0000 7251 0000 0072 2900 0000  .rP...rQ...r)...
+00004490: 7283 0000 0072 1000 0000 7223 0000 0072  r....r....r#...r
+000044a0: 1700 0000 da06 6d65 6469 616e 7298 0000  ......medianr...
+000044b0: 0072 3b00 0000 7219 0000 0072 3500 0000  .r;...r....r5...
+000044c0: 724f 0000 0072 5a00 0000 290e 725b 0000  rO...rZ...).r[..
+000044d0: 005a 0272 79da 0272 7872 2400 0000 7225  .Z.ry..rxr$...r%
+000044e0: 0000 0072 8d00 0000 5a04 4731 5f78 5a04  ...r....Z.G1_xZ.
+000044f0: 4731 5f79 5a04 4732 5f78 5a04 4732 5f79  G1_yZ.G2_xZ.G2_y
+00004500: 5a04 6731 5f72 5a04 6732 5f72 5a06 6465  Z.g1_rZ.g2_rZ.de
+00004510: 6c5f 6731 5a06 6465 6c5f 6732 720e 0000  l_g1Z.del_g2r...
+00004520: 0072 0e00 0000 720f 0000 00da 0c72 6566  .r....r......ref
+00004530: 696e 655f 7068 6173 655e 0200 0073 4600  ine_phase^...sF.
+00004540: 0000 0611 0201 0201 04ff 2603 2601 1001  ..........&.&...
+00004550: 0801 0801 0801 0801 1201 1201 1201 1201  ................
+00004560: 1201 0401 1802 1801 02fe 04ff 0406 1802  ................
+00004570: 1801 02fe 04ff 0e06 0e01 0601 1001 06ff  ................
+00004580: 0603 1001 08ff 0a03 7a10 4750 412e 7265  ........z.GPA.re
+00004590: 6669 6e65 5f70 6861 7365 6301 0000 0000  fine_phasec.....
+000045a0: 0000 0000 0000 000a 0000 0007 0000 0043  ...............C
+000045b0: 0000 0073 6602 0000 7c00 6a00 7307 7401  ...sf...|.j.s.t.
+000045c0: 6401 8301 8201 7402 6a03 6402 7402 6a04  d.....t.j.d.t.j.
+000045d0: 6403 8d02 7d01 7402 a005 7402 a006 7c00  d...}.t...t...|.
+000045e0: 6a07 a101 a101 7c01 6404 6405 6405 8502  j.....|.d.d.d...
+000045f0: 6602 3c00 7402 a005 7402 a006 7c00 6a08  f.<.t...t...|.j.
+00004600: a101 a101 7c01 6406 6405 6405 8502 6602  ....|.d.d.d...f.
+00004610: 3c00 7402 6a09 a00a 7402 a00b 7c01 a101  <.t.j...t...|...
+00004620: a101 7c00 5f0c 740d a00e 7c00 6a0f a101  ..|._.t...|.j...
+00004630: 7d02 740d a00e 7c00 6a0f a101 7d03 7402  }.t...|.j...}.t.
+00004640: a006 7402 a010 7c02 6407 a102 7402 a010  ..t...|.d...t...
+00004650: 7c03 6407 a102 6602 a101 7d04 7402 a011  |.d...f...}.t...
+00004660: 7c00 6a0c 7c04 a102 7d05 7402 a010 7c05  |.j.|...}.t...|.
+00004670: 6404 6405 6405 8502 6602 1900 7c02 6a12  d.d.d...f...|.j.
+00004680: a102 7d06 7402 a010 7c05 6406 6405 6405  ..}.t...|.d.d.d.
+00004690: 8502 6602 1900 7c03 6a12 a102 7d07 7413  ..f...|.j...}.t.
+000046a0: 6a14 a015 7c06 a101 5c02 7c00 5f16 7d08  j...|...\.|._.}.
+000046b0: 7413 6a14 a015 7c07 a101 5c02 7d09 7c00  t.j...|...\.}.|.
+000046c0: 5f17 6408 7c08 7c09 1800 1400 7c00 5f18  _.d.|.|.....|._.
+000046d0: 6408 7c08 7c09 1700 1400 7c00 5f19 7c00  d.|.|.....|._.|.
+000046e0: 0400 6a17 7402 a01a 7c00 6a17 7c00 6a1b  ..j.t...|.j.|.j.
+000046f0: 1900 a101 3800 0200 5f17 7c00 0400 6a19  ....8..._.|...j.
+00004700: 7402 a01a 7c00 6a19 7c00 6a1b 1900 a101  t...|.j.|.j.....
+00004710: 3800 0200 5f19 7c00 0400 6a18 7402 a01a  8..._.|...j.t...
+00004720: 7c00 6a18 7c00 6a1b 1900 a101 3800 0200  |.j.|.j.....8...
+00004730: 5f18 7c00 0400 6a16 7402 a01a 7c00 6a16  _.|...j.t...|.j.
+00004740: 7c00 6a1b 1900 a101 3800 0200 5f16 7c00  |.j.....8..._.|.
+00004750: 6a1c 6404 6b04 9001 7229 7c00 6a1c 7c00  j.d.k...r)|.j.|.
+00004760: 6a17 7c00 6a17 7c00 6a1c 6b04 3c00 7c00  j.|.j.|.j.k.<.|.
+00004770: 6a1c 0b00 7c00 6a17 7c00 6a17 7c00 6a1c  j...|.j.|.j.|.j.
+00004780: 0b00 6b00 3c00 7c00 6a1c 7c00 6a19 7c00  ..k.<.|.j.|.j.|.
+00004790: 6a19 7c00 6a1c 6b04 3c00 7c00 6a1c 0b00  j.|.j.k.<.|.j...
+000047a0: 7c00 6a19 7c00 6a19 7c00 6a1c 0b00 6b00  |.j.|.j.|.j...k.
+000047b0: 3c00 7c00 6a1c 7c00 6a18 7c00 6a18 7c00  <.|.j.|.j.|.j.|.
+000047c0: 6a1c 6b04 3c00 7c00 6a1c 0b00 7c00 6a18  j.k.<.|.j...|.j.
+000047d0: 7c00 6a18 7c00 6a1c 0b00 6b00 3c00 7c00  |.j.|.j...k.<.|.
+000047e0: 6a1c 7c00 6a16 7c00 6a16 7c00 6a1c 6b04  j.|.j.|.j.|.j.k.
+000047f0: 3c00 7c00 6a1c 0b00 7c00 6a16 7c00 6a16  <.|.j...|.j.|.j.
+00004800: 7c00 6a1c 0b00 6b00 3c00 7c00 6a16 7c00  |.j...k.<.|.j.|.
+00004810: 6a17 7c00 6a18 7c00 6a19 6604 5300 2909  j.|.j.|.j.f.S.).
+00004820: 61e5 0200 000a 2020 2020 2020 2020 5573  a.....        Us
+00004830: 6520 7468 6520 7265 6669 6e65 6420 7068  e the refined ph
+00004840: 6173 6520 6d61 7472 6978 2061 6e64 2067  ase matrix and g
+00004850: 2076 6563 746f 7273 2074 6f20 6361 6c63   vectors to calc
+00004860: 756c 6174 650a 2020 2020 2020 2020 7468  ulate.        th
+00004870: 6520 7374 7261 696e 206d 6174 7269 6365  e strain matrice
+00004880: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
+00004890: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+000048a0: 2d2d 2d0a 2020 2020 2020 2020 655f 7878  ---.        e_xx
+000048b0: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
+000048c0: 2020 2020 2020 2020 5374 7261 696e 2061          Strain a
+000048d0: 6c6f 6e67 2058 2064 6972 6563 7469 6f6e  long X direction
+000048e0: 0a20 2020 2020 2020 2065 5f79 793a 206e  .        e_yy: n
+000048f0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00004900: 2020 2020 2053 7472 6169 6e20 616c 6f6e       Strain alon
+00004910: 6720 5920 6469 7265 6374 696f 6e0a 2020  g Y direction.  
+00004920: 2020 2020 2020 655f 7468 3a20 6e64 6172        e_th: ndar
+00004930: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00004940: 2020 526f 7461 7469 6f6e 616c 2073 7472    Rotational str
+00004950: 6169 6e0a 2020 2020 2020 2020 655f 6467  ain.        e_dg
+00004960: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
+00004970: 2020 2020 2020 2020 4469 6167 6f6e 616c          Diagonal
+00004980: 2053 7472 6169 6e0a 0a20 2020 2020 2020   Strain..       
+00004990: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
+000049a0: 2d2d 2d2d 0a20 2020 2020 2020 2055 7365  ----.        Use
+000049b0: 2074 6865 2072 6566 696e 6564 2047 2076   the refined G v
+000049c0: 6563 746f 7273 2074 6f20 6765 6e65 7261  ectors to genera
+000049d0: 7465 2061 206d 6174 7269 780a 2020 2020  te a matrix.    
+000049e0: 2020 2020 6f66 2074 6865 206c 6174 7469      of the latti
+000049f0: 6365 2070 6172 616d 6574 6572 732c 2077  ce parameters, w
+00004a00: 6869 6368 2069 7320 7374 6f72 6564 2061  hich is stored a
+00004a10: 7320 7468 650a 2020 2020 2020 2020 636c  s the.        cl
+00004a20: 6173 7320 6174 7472 6962 7574 6520 6061  ass attribute `a
+00004a30: 5f6d 6174 7269 7860 2e20 5468 6973 2069  _matrix`. This i
+00004a40: 7320 6d75 6c74 6970 6c69 6564 2062 7920  s multiplied by 
+00004a50: 7468 650a 2020 2020 2020 2020 7265 6669  the.        refi
+00004a60: 6e65 6420 7068 6173 6520 6d61 7472 6978  ned phase matrix
+00004a70: 2c20 616e 6420 7468 6520 6d75 6c74 6970  , and the multip
+00004a80: 6c69 6361 6e64 2069 7320 7375 6273 6571  licand is subseq
+00004a90: 7565 6e74 6c79 0a20 2020 2020 2020 2064  uently.        d
+00004aa0: 6966 6665 7265 6e74 6961 7465 6420 746f  ifferentiated to
+00004ab0: 2067 6574 2074 6865 2073 7472 6169 6e20   get the strain 
+00004ac0: 7061 7261 6d65 7465 7273 2e0a 0a20 2020  parameters...   
+00004ad0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00004ae0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00004af0: 2020 2020 2020 2070 6861 7365 5f64 6966         phase_dif
+00004b00: 660a 2020 2020 2020 2020 7a3d 506c 6561  f.        z=Plea
+00004b10: 7365 2072 6566 696e 6520 7468 6520 7068  se refine the ph
+00004b20: 6173 6520 616e 6420 6720 7665 6374 6f72  ase and g vector
+00004b30: 7320 6669 7273 7420 6173 2072 6566 696e  s first as refin
+00004b40: 655f 7068 6173 6528 2972 3c00 0000 7203  e_phase()r<...r.
+00004b50: 0000 0072 0100 0000 4e72 0400 0000 7207  ...r....Nr....r.
+00004b60: 0000 0072 1400 0000 291d 7259 0000 0072  ...r....).rY...r
+00004b70: 5400 0000 7208 0000 0072 0a00 0000 5a07  T...r....r....Z.
+00004b80: 666c 6f61 7436 3472 1600 0000 7217 0000  float64r....r...
+00004b90: 0072 a100 0000 72a2 0000 005a 066c 696e  .r....r....Z.lin
+00004ba0: 616c 67da 0369 6e76 7295 0000 0072 4100  alg..invr....rA.
+00004bb0: 0000 da03 736b 725a 0c75 6e77 7261 705f  ....skrZ.unwrap_
+00004bc0: 7068 6173 6572 a300 0000 7296 0000 0072  phaser....r....r
+00004bd0: 4000 0000 720b 0000 0072 2900 0000 7283  @...r....r)...r.
+00004be0: 0000 0072 1000 0000 7242 0000 0072 4500  ...r....rB...rE.
+00004bf0: 0000 7247 0000 0072 4800 0000 72a4 0000  ..rG...rH...r...
+00004c00: 0072 9800 0000 7257 0000 0029 0a72 5b00  .r....rW...).r[.
+00004c10: 0000 7226 0000 005a 0250 315a 0250 325a  ..r&...Z.P1Z.P2Z
+00004c20: 0872 6f6c 6c65 645f 705a 0875 5f6d 6174  .rolled_pZ.u_mat
+00004c30: 7269 785a 0375 5f78 5a03 755f 7972 4300  rixZ.u_xZ.u_yrC.
+00004c40: 0000 7244 0000 0072 0e00 0000 720e 0000  ..rD...r....r...
+00004c50: 0072 0f00 0000 da0a 6765 745f 7374 7261  .r......get_stra
+00004c60: 696e 9502 0000 7340 0000 0006 1c02 0102  in....s@........
+00004c70: 0104 ff10 031e 011e 0114 010c 010c 011e  ................
+00004c80: 010e 011a 011a 0112 0112 010e 010e 011c  ................
+00004c90: 011c 011c 011c 010c 0214 0118 0114 0118  ................
+00004ca0: 0114 0118 0114 0118 0114 017a 0e47 5041  ...........z.GPA
+00004cb0: 2e67 6574 5f73 7472 6169 6e72 0100 0000  .get_strainr....
+00004cc0: 6303 0000 0000 0000 0000 0000 0014 0000  c...............
+00004cd0: 000a 0000 0043 0000 0073 f003 0000 7400  .....C...s....t.
+00004ce0: 7c02 8301 7d03 7c01 6401 6b02 7220 6402  |...}.|.d.k.r d.
+00004cf0: 7401 a002 7401 a003 7401 6a04 7c00 6a05  t...t...t.j.|.j.
+00004d00: 7c00 6a06 7c00 6a07 7c00 6a08 6604 6403  |.j.|.j.|.j.f.d.
+00004d10: 6404 8d02 a101 a101 1400 7d04 6e02 7c01  d.........}.n.|.
+00004d20: 7d04 6405 7c03 6406 9c02 7d05 7409 6a0a  }.d.|.d...}.t.j.
+00004d30: 642b 6900 7c05 a401 8e01 0100 7400 7c02  d+i.|.......t.|.
+00004d40: 8301 7400 7c02 6408 1400 8301 6602 7d06  ..t.|.d.....f.}.
+00004d50: 740b 6a0c 7c06 6409 8d01 0100 740d a00e  t.j.|.d.....t...
+00004d60: 640a 640b a102 7d07 740b a00f 7c07 6401  d.d...}.t...|.d.
+00004d70: 640c 8502 6401 640c 8502 6602 1900 a101  d...d.d...f.....
+00004d80: 7d08 740b a00f 7c07 6401 640c 8502 640c  }.t...|.d.d...d.
+00004d90: 640b 8502 6602 1900 a101 7d09 740b a00f  d...f.....}.t...
+00004da0: 7c07 640c 640b 8502 6401 640c 8502 6602  |.d.d...d.d...f.
+00004db0: 1900 a101 7d0a 740b a00f 7c07 640c 640b  ....}.t...|.d.d.
+00004dc0: 8502 640c 640b 8502 6602 1900 a101 7d0b  ..d.d...f.....}.
+00004dd0: 740b a00f 7c07 640b 640a 8502 640d 640d  t...|.d.d...d.d.
+00004de0: 8502 6602 1900 a101 7d0c 7c08 6a10 640e  ..f.....}.|.j.d.
+00004df0: 7c00 6a06 1400 7c04 0b00 7c04 640f 6410  |.j...|...|.d.d.
+00004e00: 8d04 0100 7411 a012 7c00 6a13 7c00 6a14  ....t...|.j.|.j.
+00004e10: a102 7d0d 6411 7c0d 5f15 6403 7c0d 5f16  ..}.d.|._.d.|._.
+00004e20: 6412 7c0d 5f17 7c08 a018 7c0d a101 0100  d.|._.|...|.....
+00004e30: 7419 6a1a 6413 741b 7c03 6414 8d01 6415  t.j.d.t.|.d...d.
+00004e40: 6416 6417 8d04 7d0e 7c0e 6a1c a01d 6418  d.d...}.|.j...d.
+00004e50: a101 0100 7c08 a018 7c0e a101 0100 7c08  ....|...|.....|.
+00004e60: a01e 6419 a101 0100 7c09 6a10 640e 7c00  ..d.....|.j.d.|.
+00004e70: 6a07 1400 7c04 0b00 7c04 640f 6410 8d04  j...|...|.d.d...
+00004e80: 0100 7411 a012 7c00 6a13 7c00 6a14 a102  ..t...|.j.|.j...
+00004e90: 7d0d 6411 7c0d 5f15 6403 7c0d 5f16 6412  }.d.|._.d.|._.d.
+00004ea0: 7c0d 5f17 7c09 a018 7c0d a101 0100 7419  |._.|...|.....t.
+00004eb0: 6a1a 641a 741b 7c03 6414 8d01 6415 6416  j.d.t.|.d...d.d.
+00004ec0: 6417 8d04 7d0e 7c0e 6a1c a01d 6418 a101  d...}.|.j...d...
+00004ed0: 0100 7c09 a018 7c0e a101 0100 7c09 a01e  ..|...|.....|...
+00004ee0: 6419 a101 0100 7c0a 6a10 640e 7c00 6a08  d.....|.j.d.|.j.
+00004ef0: 1400 7c04 0b00 7c04 640f 6410 8d04 0100  ..|...|.d.d.....
+00004f00: 7411 a012 7c00 6a13 7c00 6a14 a102 7d0d  t...|.j.|.j...}.
+00004f10: 6411 7c0d 5f15 6403 7c0d 5f16 6412 7c0d  d.|._.d.|._.d.|.
+00004f20: 5f17 7c0a a018 7c0d a101 0100 7419 6a1a  _.|...|.....t.j.
+00004f30: 641b 741b 7c03 6414 8d01 6415 6416 6417  d.t.|.d...d.d.d.
+00004f40: 8d04 7d0e 7c0e 6a1c a01d 6418 a101 0100  ..}.|.j...d.....
+00004f50: 7c0a a018 7c0e a101 0100 7c0a a01e 6419  |...|.....|...d.
+00004f60: a101 0100 7c0b 6a10 640e 7c00 6a05 1400  ....|.j.d.|.j...
+00004f70: 7c04 0b00 7c04 640f 6410 8d04 0100 7411  |...|.d.d.....t.
+00004f80: a012 7c00 6a13 7c00 6a14 a102 7d0d 6411  ..|.j.|.j...}.d.
+00004f90: 7c0d 5f15 6403 7c0d 5f16 6412 7c0d 5f17  |._.d.|._.d.|._.
+00004fa0: 7c0b a018 7c0d a101 0100 7419 6a1a 641c  |...|.....t.j.d.
+00004fb0: 741b 7c03 6414 8d01 6415 6416 6417 8d04  t.|.d...d.d.d...
+00004fc0: 7d0e 7c0e 6a1c a01d 6418 a101 0100 7c0b  }.|.j...d.....|.
+00004fd0: a018 7c0e a101 0100 7c0b a01e 6419 a101  ..|.....|...d...
+00004fe0: 0100 7401 6a1f 641d 7401 6a20 641e 8d02  ..t.j.d.t.j d...
+00004ff0: 7d0f 7421 640b 8301 4400 5d11 7d10 7401  }.t!d...D.].}.t.
+00005000: a022 7c04 0b00 7c04 641f a103 7c0f 7c10  ."|...|.d...|.|.
+00005010: 640d 640d 8502 6602 3c00 9001 718e 7c0c  d.d...f.<...q.|.
+00005020: 6a10 7c0f 640f 6420 8d02 0100 7c0c 6a23  j.|.d.d ....|.j#
+00005030: a024 6421 a101 0100 6422 7d11 7401 a022  .$d!....d"}.t.."
+00005040: 6401 641f 7c11 a103 7d12 7c0c a025 7c12  d.d.|...}.|..%|.
+00005050: a101 0100 7c0c a026 7401 a027 7401 a022  ....|..&t..'t.."
+00005060: 7c04 0b00 7c04 7c11 a103 6423 a102 a101  |...|.|...d#....
+00005070: 0100 6424 4400 5d13 7d13 7c0c 6a28 7c13  ..d$D.].}.|.j(|.
+00005080: 1900 a029 6425 a101 0100 7c0c 6a28 7c13  ...)d%....|.j(|.
+00005090: 1900 a02a 6426 a101 0100 9001 71cc 7c0c  ...*d&......q.|.
+000050a0: 6a2b 6a2c 6425 6427 6428 640b 6429 8d04  j+j,d%d'd(d.d)..
+000050b0: 0100 7c0c 6a2d 642c 6900 7c05 a401 8e01  ..|.j-d,i.|.....
+000050c0: 0100 740b a02e a100 0100 640d 5300 292d  ..t.......d.S.)-
+000050d0: 61b2 0200 000a 2020 2020 2020 2020 5573  a.....        Us
+000050e0: 6520 7468 6520 6361 6c63 756c 6174 6564  e the calculated
+000050f0: 2073 7472 6169 6e20 6d61 7472 6963 6573   strain matrices
+00005100: 2074 6f20 706c 6f74 2074 6865 2073 7472   to plot the str
+00005110: 6169 6e20 6d61 7073 0a0a 2020 2020 2020  ain maps..      
+00005120: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00005130: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00005140: 2020 2020 2020 2020 6d76 616c 3a20 2020          mval:   
+00005150: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00005160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005170: 2020 5468 6520 6d61 7869 6d75 6d20 7374    The maximum st
+00005180: 7261 696e 2076 616c 7565 2074 6861 7420  rain value that 
+00005190: 7769 6c6c 2062 6520 706c 6f74 7465 642e  will be plotted.
+000051a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000051b0: 2020 4465 6661 756c 7420 6973 2030 2c20    Default is 0, 
+000051c0: 7570 6f6e 2077 6869 6368 2074 6865 206d  upon which the m
+000051d0: 6178 696d 756d 2073 7472 6169 6e0a 2020  aximum strain.  
+000051e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000051f0: 6572 6365 6e74 6167 6520 7769 6c6c 2062  ercentage will b
+00005200: 6520 6361 6c63 756c 6174 6564 2c20 7768  e calculated, wh
+00005210: 6963 6820 7769 6c6c 2062 6520 7573 6564  ich will be used
+00005220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005230: 2020 666f 7220 706c 6f74 7469 6e67 2e0a    for plotting..
+00005240: 2020 2020 2020 2020 696d 7769 6474 683a          imwidth:
+00005250: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+00005260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005270: 5369 7a65 2069 6e20 696e 6368 6573 206f  Size in inches o
+00005280: 6620 7468 6520 696d 6167 6520 7769 7468  f the image with
+00005290: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+000052a0: 2020 2020 2020 6469 6666 7261 6374 696f        diffractio
+000052b0: 6e20 7370 6f74 7320 6d61 726b 6564 2e20  n spots marked. 
+000052c0: 4465 6661 756c 7420 6973 2031 350a 0a20  Default is 15.. 
+000052d0: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
+000052e0: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
+000052f0: 2020 2055 7365 7320 606d 6174 706c 6f74     Uses `matplot
+00005300: 6c69 622e 6772 6964 7370 6563 6020 746f  lib.gridspec` to
+00005310: 2070 6c6f 7420 7468 6520 7374 7261 696e   plot the strain
+00005320: 206d 6170 7320 6f66 2074 6865 0a20 2020   maps of the.   
+00005330: 2020 2020 2066 6f75 7220 7479 7065 7320       four types 
+00005340: 6f66 2073 7472 6169 6e20 6361 6c63 756c  of strain calcul
+00005350: 6174 6564 2074 6872 6f75 6768 2067 656f  ated through geo
+00005360: 6d65 7472 6963 2070 6861 7365 0a20 2020  metric phase.   
+00005370: 2020 2020 2061 6e61 6c79 7369 732e 0a20       analysis.. 
+00005380: 2020 2020 2020 2072 0100 0000 e964 0000         r.....d..
+00005390: 0072 0400 0000 7205 0000 005a 0462 6f6c  .r....r....Z.bol
+000053a0: 6429 02da 0677 6569 6768 7472 9100 0000  d)...weightr....
+000053b0: da04 666f 6e74 679a 9999 9999 99f1 3f72  ..fontg.......?r
+000053c0: 6000 0000 e90b 0000 0072 7300 0000 e905  `........rs.....
+000053d0: 0000 004e 699c ffff ff5a 0652 6442 755f  ...Ni....Z.RdBu_
+000053e0: 7229 035a 0476 6d69 6e5a 0476 6d61 7872  r).Z.vminZ.vmaxr
+000053f0: 6200 0000 7263 0000 0072 6400 0000 7a18  b...rc...rd...z.
+00005400: 245c 6d61 7468 726d 7b5c 6570 7369 6c6f  $\mathrm{\epsilo
+00005410: 6e5f 7b78 787d 7d24 2901 7291 0000 0054  n_{xx}}$).r....T
+00005420: 7a0a 7570 7065 7220 6c65 6674 2903 da04  z.upper left)...
+00005430: 7072 6f70 5a07 6672 616d 656f 6eda 036c  propZ.frameon..l
+00005440: 6f63 7a22 726f 756e 642c 2070 6164 3d20  ocz"round, pad= 
+00005450: 302e 2c20 726f 756e 6469 6e67 5f73 697a  0., rounding_siz
+00005460: 653d 2030 2e32 7265 0000 007a 1824 5c6d  e= 0.2re...z.$\m
+00005470: 6174 6872 6d7b 5c65 7073 696c 6f6e 5f7b  athrm{\epsilon_{
+00005480: 7879 7d7d 247a 1c24 5c6d 6174 6872 6d7b  xy}}$z.$\mathrm{
+00005490: 5c65 7073 696c 6f6e 5f7b 5c74 6865 7461  \epsilon_{\theta
+000054a0: 7d7d 247a 1824 5c6d 6174 6872 6d7b 5c65  }}$z.$\mathrm{\e
+000054b0: 7073 696c 6f6e 5f7b 7979 7d7d 2429 0272  psilon_{yy}}$).r
+000054c0: 7300 0000 e9e8 0300 0072 0300 0000 72b1  s........r....r.
+000054d0: 0000 0072 6100 0000 4672 7500 0000 e904  ...ra...Fru.....
+000054e0: 0000 0029 04da 0374 6f70 5a06 626f 7474  ...)...topZ.bott
+000054f0: 6f6d da04 6c65 6674 da05 7269 6768 7472  om..left..rightr
+00005500: 1300 0000 5a05 626c 6163 6be9 0600 0000  ....Z.black.....
+00005510: da03 6f75 7429 04da 0577 6964 7468 da06  ..out)...width..
+00005520: 6c65 6e67 7468 da09 6469 7265 6374 696f  length..directio
+00005530: 6eda 0370 6164 fa0a 5374 7261 696e 2028  n..pad..Strain (
+00005540: 2529 2901 72ac 0000 0029 0172 bc00 0000  %)).r....).r....
+00005550: 292f 7250 0000 0072 0800 0000 5a04 616d  )/rP...r....Z.am
+00005560: 6178 727d 0000 005a 0b63 6f6e 6361 7465  axr}...Z.concate
+00005570: 6e61 7465 7245 0000 0072 4200 0000 7248  naterE...rB...rH
+00005580: 0000 0072 4700 0000 da03 6d70 6cda 0272  ...rG.....mpl..r
+00005590: 6372 6600 0000 7267 0000 00da 046d 7067  crf...rg.....mpg
+000055a0: 735a 0847 7269 6453 7065 635a 0773 7562  sZ.GridSpecZ.sub
+000055b0: 706c 6f74 7268 0000 0072 6900 0000 726a  plotrh...ri...rj
+000055c0: 0000 0072 4d00 0000 724e 0000 0072 6b00  ...rM...rN...rk.
+000055d0: 0000 726c 0000 0072 6d00 0000 726e 0000  ..rl...rm...rn..
+000055e0: 00da 066d 706c 6f66 665a 0c41 6e63 686f  ...mploffZ.Ancho
+000055f0: 7265 6454 6578 74da 0464 6963 745a 0570  redText..dictZ.p
+00005600: 6174 6368 5a0c 7365 745f 626f 7873 7479  atchZ.set_boxsty
+00005610: 6c65 7206 0000 0072 0a00 0000 7231 0000  ler....r....r1..
+00005620: 0072 3e00 0000 5a08 6c69 6e73 7061 6365  .r>...Z.linspace
+00005630: 5a05 7961 7869 735a 0b73 6574 5f76 6973  Z.yaxisZ.set_vis
+00005640: 6962 6c65 5a0a 7365 745f 7874 6963 6b73  ibleZ.set_xticks
+00005650: 5a0f 7365 745f 7874 6963 6b6c 6162 656c  Z.set_xticklabel
+00005660: 7372 7e00 0000 5a06 7370 696e 6573 5a0d  sr~...Z.spinesZ.
+00005670: 7365 745f 6c69 6e65 7769 6474 685a 0973  set_linewidthZ.s
+00005680: 6574 5f63 6f6c 6f72 5a05 7861 7869 735a  et_colorZ.xaxisZ
+00005690: 0f73 6574 5f74 6963 6b5f 7061 7261 6d73  .set_tick_params
+000056a0: 5a09 7365 745f 7469 746c 655a 0961 7574  Z.set_titleZ.aut
+000056b0: 6f73 6361 6c65 2914 725b 0000 005a 046d  oscale).r[...Z.m
+000056c0: 7661 6c5a 0769 6d77 6964 7468 7294 0000  valZ.imwidthr...
+000056d0: 005a 0276 6d5a 0773 635f 666f 6e74 726f  .Z.vmZ.sc_fontro
+000056e0: 0000 005a 0267 735a 0361 7831 5a03 6178  ...Z.gsZ.ax1Z.ax
+000056f0: 325a 0361 7833 5a03 6178 345a 0361 7835  2Z.ax3Z.ax4Z.ax5
+00005700: 7270 0000 00da 0261 745a 0273 6272 4600  rp.....atZ.sbrF.
+00005710: 0000 7289 0000 00da 0278 3172 0600 0000  ..r......x1r....
+00005720: 720e 0000 0072 0e00 0000 720f 0000 00da  r....r....r.....
+00005730: 0f70 6c6f 745f 6770 615f 7374 7261 696e  .plot_gpa_strain
+00005740: d302 0000 73ba 0000 0008 1508 0106 0104  ....s...........
+00005750: 011c 0102 ff08 ff04 060a 0110 0114 010c  ................
+00005760: 020c 021a 011a 011a 011a 011a 011a 0210  ................
+00005770: 0106 0106 0106 010a 0104 0102 0108 0102  ................
+00005780: 0102 0106 fc0c 060a 010a 011a 0210 0106  ................
+00005790: 0106 0106 010a 0104 0102 0108 0102 0102  ................
+000057a0: 0106 fc0c 060a 010a 011a 0210 0106 0106  ................
+000057b0: 0106 010a 0104 0102 0108 0102 0102 0106  ................
+000057c0: fc0c 060a 010a 011a 0210 0106 0106 0106  ................
+000057d0: 010a 0104 0102 0108 0102 0102 0106 fc0c  ................
+000057e0: 060a 010a 0110 020c 0120 010e 010c 0104  ......... ......
+000057f0: 010e 010a 011e 0108 0110 0114 0114 0110  ................
+00005800: 010c 027a 1347 5041 2e70 6c6f 745f 6770  ...z.GPA.plot_gp
+00005810: 615f 7374 7261 696e 4e29 0372 4b00 0000  a_strainN).rK...
+00005820: 5472 4c00 0000 2902 725d 0000 0072 5f00  TrL...).r]...r_.
+00005830: 0000 2902 725e 0000 0072 7200 0000 2902  ..).r^...rr...).
+00005840: 7272 0000 0072 6400 0000 2902 7201 0000  rr...rd...).r...
+00005850: 0072 5e00 0000 290b da08 5f5f 6e61 6d65  .r^...)...__name
+00005860: 5f5f da0a 5f5f 6d6f 6475 6c65 5f5f da0c  __..__module__..
+00005870: 5f5f 7175 616c 6e61 6d65 5f5f da07 5f5f  __qualname__..__
+00005880: 646f 635f 5f72 5c00 0000 7271 0000 0072  doc__r\...rq...r
+00005890: 8e00 0000 72a0 0000 0072 a600 0000 72a9  ....r....r....r.
+000058a0: 0000 0072 c400 0000 720e 0000 0072 0e00  ...r....r....r..
+000058b0: 0000 720e 0000 0072 0f00 0000 724a 0000  ..r....r....rJ..
+000058c0: 0026 0100 0073 1600 0000 0800 0401 0241  .&...s.........A
+000058d0: 0aff 0a15 0a13 0a4b 007f 0805 0837 0e3e  .......K.....7.>
+000058e0: 724a 0000 0029 0272 0100 0000 5429 215a  rJ...).r....T)!Z
+000058f0: 056e 756d 7079 7208 0000 005a 1373 6b69  .numpyr....Z.ski
+00005900: 6d61 6765 2e72 6573 746f 7261 7469 6f6e  mage.restoration
+00005910: 5a0b 7265 7374 6f72 6174 696f 6e72 a800  Z.restorationr..
+00005920: 0000 5a0d 7363 6970 792e 6e64 696d 6167  ..Z.scipy.ndimag
+00005930: 655a 076e 6469 6d61 6765 727a 0000 005a  eZ.ndimagerz...Z
+00005940: 0a6d 6174 706c 6f74 6c69 6272 bd00 0000  .matplotlibr....
+00005950: 5a11 6d61 7470 6c6f 746c 6962 2e70 7970  Z.matplotlib.pyp
+00005960: 6c6f 745a 0670 7970 6c6f 7472 6600 0000  lotZ.pyplotrf...
+00005970: da08 7374 656d 746f 6f6c 7229 0000 005a  ..stemtoolr)...Z
+00005980: 146d 6174 706c 6f74 6c69 622e 6f66 6673  .matplotlib.offs
+00005990: 6574 626f 785a 096f 6666 7365 7462 6f78  etboxZ.offsetbox
+000059a0: 72c0 0000 005a 136d 6174 706c 6f74 6c69  r....Z.matplotli
+000059b0: 622e 6772 6964 7370 6563 5a08 6772 6964  b.gridspecZ.grid
+000059c0: 7370 6563 72bf 0000 005a 1c6d 6174 706c  specr....Z.matpl
+000059d0: 6f74 6c69 625f 7363 616c 6562 6172 2e73  otlib_scalebar.s
+000059e0: 6361 6c65 6261 7272 7000 0000 7269 0000  calebarrp...ri..
+000059f0: 0072 1000 0000 7212 0000 0072 1b00 0000  .r....r....r....
+00005a00: 721c 0000 0072 2600 0000 723b 0000 0072  r....r&...r;...r
+00005a10: 4900 0000 da06 6f62 6a65 6374 724a 0000  I.....objectrJ..
+00005a20: 0072 0e00 0000 720e 0000 0072 0e00 0000  .r....r....r....
+00005a30: 720f 0000 00da 083c 6d6f 6475 6c65 3e01  r......<module>.
+00005a40: 0000 0073 2200 0000 0800 0c01 0c01 0801  ...s"...........
+00005a50: 0c01 0801 0c01 0c01 0c01 0803 082c 081b  .............,..
+00005a60: 081b 081e 0a1b 0844 143b                 .......D.;
```

## Comparing `stemtool/nbed/__pycache__/nbed_strain.cpython-39.pyc` & `stemtool/nbed/__pycache__/nbed_strain.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 18:00:14 2023 UTC, .py size: 71865 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 3% similar despite different names*

```diff
@@ -1,3505 +1,3551 @@
-00000000: 610d 0d0a 0000 0000 2e40 e163 b918 0100  a........@.c....
+00000000: 6f0d 0d0a 0000 0000 e175 6f64 321c 0100  o........uod2...
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 000b 0000 0040 0000 0073 e601 0000 6400  .....@...s....d.
+00000020: 000b 0000 0040 0000 0073 0802 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 6d03 5a04  d.l.Z.d.d.l.m.Z.
 00000040: 0100 6400 6401 6c05 6d06 5a07 0100 6400  ..d.d.l.m.Z...d.
 00000050: 6401 6c08 6d09 5a0a 0100 6400 6401 6c0b  d.l.m.Z...d.d.l.
 00000060: 6d0c 5a0d 0100 6400 6401 6c0e 6d0f 5a10  m.Z...d.d.l.m.Z.
 00000070: 0100 6400 6401 6c11 6d12 5a13 0100 6400  ..d.d.l.m.Z...d.
 00000080: 6401 6c14 5a15 6400 6401 6c16 5a17 6400  d.l.Z.d.d.l.Z.d.
 00000090: 6401 6c18 6d19 5a1a 0100 6400 6401 6c1b  d.l.m.Z...d.d.l.
 000000a0: 6d1c 5a1d 0100 6400 6401 6c1e 6d1f 5a20  m.Z...d.d.l.m.Z 
 000000b0: 0100 6400 6401 6c21 5a21 6400 6401 6c22  ..d.d.l!Z!d.d.l"
 000000c0: 6d23 5a24 0100 6400 6401 6c25 6d26 5a27  m#Z$..d.d.l%m&Z'
-000000d0: 0100 6400 6401 6c28 5a28 6455 6402 6403  ..d.d.l(Z(dUd.d.
+000000d0: 0100 6400 6401 6c28 5a28 6459 6402 6403  ..d.d.l(Z(dYd.d.
 000000e0: 8401 5a29 6404 6405 8400 5a2a 6406 6407  ..Z)d.d...Z*d.d.
 000000f0: 8400 5a2b 6408 6409 8400 5a2c 640a 640b  ..Z+d.d...Z,d.d.
-00000100: 8400 5a2d 640c 640d 8400 5a2e 6456 640f  ..Z-d.d...Z.dVd.
-00000110: 6410 8401 5a2f 6457 6412 6413 8401 5a30  d...Z/dWd.d...Z0
-00000120: 6414 6415 8400 5a31 6458 6417 6418 8401  d.d...Z1dXd.d...
-00000130: 5a32 6459 641b 641c 8401 5a33 641d 641e  Z2dYd.d...Z3d.d.
-00000140: 8400 5a34 645a 641f 6420 8401 5a35 645b  ..Z4dZd.d ..Z5d[
-00000150: 6425 6426 8401 5a36 645c 6427 6428 8401  d%d&..Z6d\d'd(..
-00000160: 5a37 645d 6429 642a 8401 5a38 642b 642c  Z7d]d)d*..Z8d+d,
-00000170: 8400 5a39 645e 642e 642f 8401 5a3a 645f  ..Z9d^d.d/..Z:d_
-00000180: 6431 6432 8401 5a3b 6433 6434 8400 5a3c  d1d2..Z;d3d4..Z<
-00000190: 6460 6436 6437 8401 5a3d 6461 6439 643a  d`d6d7..Z=dad9d:
-000001a0: 8401 5a3e 6462 643c 643d 8401 5a3f 643e  ..Z>dbd<d=..Z?d>
-000001b0: 643f 8400 5a40 6400 6400 6501 6a41 6400  d?..Z@d.d.e.jAd.
-000001c0: 6400 6430 6422 6440 6411 6423 6411 660b  d.d0d"d@d.d#d.f.
-000001d0: 6441 6442 8401 5a42 6443 6444 8400 5a43  dAdB..ZBdCdD..ZC
-000001e0: 6463 6446 6447 8401 5a44 6464 6449 644a  dcdFdG..ZDdddIdJ
-000001f0: 8401 5a45 644b 644c 8400 5a46 6465 644f  ..ZEdKdL..ZFdedO
-00000200: 6450 8401 5a47 6466 6453 6454 8401 5a48  dP..ZGdfdSdT..ZH
-00000210: 6401 5300 2967 e900 0000 004e 6302 0000  d.S.)g.....Nc...
-00000220: 0000 0000 0000 0000 0006 0000 0004 0000  ................
-00000230: 0003 0000 0073 2a00 0000 7c01 6601 8700  .....s*...|.f...
-00000240: 6601 6401 6402 8409 7d02 6403 7d03 7400  f.d.d...}.d.}.t.
-00000250: a001 7c02 7c03 a102 7d04 7c04 6a02 7d05  ..|.|...}.|.j.}.
-00000260: 7c05 5300 2904 612e 0200 000a 2020 2020  |.S.).a.....    
-00000270: 416e 676c 6520 4669 6e64 6572 0a0a 2020  Angle Finder..  
-00000280: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00000290: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000002a0: 696d 6167 655f 6f72 6967 3a20 2832 2c32  image_orig: (2,2
-000002b0: 2920 7368 6170 6520 6e64 6172 7261 790a  ) shape ndarray.
-000002c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000002d0: 496e 7075 7420 496d 6167 650a 2020 2020  Input Image.    
-000002e0: 6178 6973 3a20 2020 2020 2020 696e 742c  axis:       int,
-000002f0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00000300: 2020 2020 2020 2020 2020 4178 6973 2061            Axis a
-00000310: 6c6f 6e67 2077 6869 6368 2074 6f20 7065  long which to pe
-00000320: 7266 6f72 6d20 7375 6d0a 0a20 2020 2052  rform sum..    R
-00000330: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00000340: 2d2d 0a20 2020 206d 696e 5f78 3a20 666c  --.    min_x: fl
-00000350: 6f61 740a 2020 2020 2020 2020 2020 2041  oat.           A
-00000360: 6e67 6c65 2062 7920 7768 6963 6820 6966  ngle by which if
-00000370: 2074 6865 2069 6d61 6765 2069 7320 726f   the image is ro
-00000380: 7461 7465 640a 2020 2020 2020 2020 2020  tated.          
-00000390: 2062 792c 2074 6865 2073 756d 206f 6620   by, the sum of 
-000003a0: 7468 6520 696d 6167 6520 616c 6f6e 6720  the image along 
-000003b0: 7468 6520 6178 6973 0a20 2020 2020 2020  the axis.       
-000003c0: 2020 2020 7370 6563 6966 6965 6420 6973      specified is
-000003d0: 206d 6178 696d 756d 0a0a 2020 2020 4e6f   maximum..    No
-000003e0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
-000003f0: 2020 5573 6573 2061 6e20 696e 7465 726e    Uses an intern
-00000400: 616c 2060 616e 676c 655f 6675 6e60 2074  al `angle_fun` t
-00000410: 6f20 7375 6d20 7468 6520 696e 7465 6e73  o sum the intens
-00000420: 6974 7920 616c 6f6e 670a 2020 2020 6120  ity along.    a 
-00000430: 7061 7274 6963 756c 6172 2061 7869 732e  particular axis.
-00000440: 2054 6869 7320 7769 6c6c 2067 6976 6520   This will give 
-00000450: 7468 6520 616e 676c 6520 6174 2077 6869  the angle at whi
-00000460: 6368 2074 6861 740a 2020 2020 7375 6d20  ch that.    sum 
-00000470: 6973 2068 6967 6865 7374 2061 6c6f 6e67  is highest along
-00000480: 2074 6865 2061 7869 7320 7370 6563 6966   the axis specif
-00000490: 6965 642e 0a20 2020 2063 0200 0000 0000  ied..    c......
-000004a0: 0000 0000 0000 0500 0000 0600 0000 1300  ................
-000004b0: 0000 7330 0000 0074 006a 0188 007c 0064  ..s0...t.j...|.d
-000004c0: 0164 0264 038d 047d 0264 0474 02a0 037c  .d.d...}.d.t...|
-000004d0: 027c 01a1 0214 007d 0374 02a0 047c 03a1  .|.....}.t...|..
-000004e0: 017d 047c 0453 0029 054e e905 0000 0046  .}.|.S.).N.....F
-000004f0: a902 da05 6f72 6465 72da 0772 6573 6861  ....order..resha
-00000500: 7065 e9ff ffff ff29 05da 0473 636e 64da  pe.....)...scnd.
-00000510: 0672 6f74 6174 65da 026e 70da 0373 756d  .rotate..np..sum
-00000520: da04 616d 696e 2905 5a05 616e 676c 65da  ..amin).Z.angle.
-00000530: 0461 7869 735a 0d72 6f74 6174 6564 5f69  .axisZ.rotated_i
-00000540: 6d61 6765 5a06 726f 7473 756d 5a06 726f  mageZ.rotsumZ.ro
-00000550: 746d 696e a901 da0a 696d 6167 655f 6f72  tmin....image_or
-00000560: 6967 a900 fa3f 6275 696c 642f 6264 6973  ig...?build/bdis
-00000570: 742e 6d61 636f 7378 2d31 302e 392d 7838  t.macosx-10.9-x8
-00000580: 365f 3634 2f65 6767 2f73 7465 6d74 6f6f  6_64/egg/stemtoo
-00000590: 6c2f 6e62 6564 2f6e 6265 645f 7374 7261  l/nbed/nbed_stra
-000005a0: 696e 2e70 79da 0961 6e67 6c65 5f66 756e  in.py..angle_fun
-000005b0: 2c00 0000 7308 0000 0000 0112 0110 010a  ,...s...........
-000005c0: 017a 2272 6f74 6174 696f 6e5f 6669 6e64  .z"rotation_find
-000005d0: 6572 2e3c 6c6f 6361 6c73 3e2e 616e 676c  er.<locals>.angl
-000005e0: 655f 6675 6ee9 5a00 0000 2903 da03 7369  e_fun.Z...)...si
-000005f0: 6f5a 086d 696e 696d 697a 65da 0178 2906  oZ.minimize..x).
-00000600: 720e 0000 0072 0c00 0000 7211 0000 005a  r....r....r....Z
-00000610: 0278 3072 1400 0000 5a05 6d69 6e5f 7872  .x0r....Z.min_xr
-00000620: 0f00 0000 720d 0000 0072 1000 0000 da0f  ....r....r......
-00000630: 726f 7461 7469 6f6e 5f66 696e 6465 7213  rotation_finder.
-00000640: 0000 0073 0a00 0000 0019 1006 0401 0c01  ...s............
-00000650: 0601 7215 0000 0063 0400 0000 0000 0000  ..r....c........
-00000660: 0000 0000 0a00 0000 0b00 0000 4300 0000  ............C...
-00000670: 73a2 0000 0074 00a0 0174 00a0 027c 00a1  s....t...t...|..
-00000680: 01a1 017d 0474 00a0 037c 00a1 017d 0574  ...}.t...|...}.t
-00000690: 047c 006a 0264 0119 0083 0144 005d 747d  .|.j.d.....D.]t}
-000006a0: 067c 007c 0664 0264 0285 0264 0264 0285  .|.|.d.d...d.d..
-000006b0: 0266 0319 007d 0774 00a0 0574 066a 07a0  .f...}.t...t.j..
-000006c0: 087c 077c 020b 0064 037c 0464 0419 0014  .|.|...d.|.d....
-000006d0: 0017 007c 030b 0064 037c 0464 0519 0014  ...|...d.|.d....
-000006e0: 0017 00a1 03a1 017d 0874 096a 0a7c 087c  .......}.t.j.|.|
-000006f0: 0164 0664 0764 088d 047d 097c 097c 057c  .d.d.d...}.|.|.|
-00000700: 0664 0264 0285 0264 0264 0285 0266 033c  .d.d...d.d...f.<
-00000710: 0071 287c 0553 0029 0961 4403 0000 0a20  .q(|.S.).aD.... 
-00000720: 2020 2052 6f74 6174 696f 6e20 436f 7272     Rotation Corr
-00000730: 6563 746f 720a 0a20 2020 2050 6172 616d  ector..    Param
-00000740: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00000750: 2d2d 2d2d 0a20 2020 2064 6174 6134 445f  ----.    data4D_
-00000760: 524f 493a 206e 6461 7272 6179 0a20 2020  ROI: ndarray.   
-00000770: 2020 2020 2020 2020 2020 2020 2052 6567               Reg
-00000780: 696f 6e20 6f66 2069 6e74 6572 6573 7420  ion of interest 
-00000790: 6f66 2074 6865 2034 442d 5354 454d 2064  of the 4D-STEM d
-000007a0: 6174 6173 6574 2069 6e0a 2020 2020 2020  ataset in.      
-000007b0: 2020 2020 2020 2020 2020 7468 6520 666f            the fo
-000007c0: 726d 206f 6620 524f 4920 7069 7865 6c73  rm of ROI pixels
-000007d0: 2028 7363 616e 6e69 6e67 292c 2043 4245   (scanning), CBE
-000007e0: 445f 592c 2043 4245 445f 780a 2020 2020  D_Y, CBED_x.    
-000007f0: 726f 7461 6e67 6c65 3a20 2020 666c 6f61  rotangle:   floa
-00000800: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00000810: 2020 616e 676c 6520 696e 2063 6f75 6e74    angle in count
-00000820: 6572 2d63 6c6f 636b 7769 7365 2064 6972  er-clockwise dir
-00000830: 6563 7469 6f6e 2074 6f0a 2020 2020 2020  ection to.      
-00000840: 2020 2020 2020 2020 2020 726f 7461 7465            rotate
-00000850: 2069 6e64 6976 6964 7561 6c20 4342 4544   individual CBED
-00000860: 2070 6174 7465 726e 730a 2020 2020 7863   patterns.    xc
-00000870: 656e 7465 723a 2020 2020 666c 6f61 740a  enter:    float.
-00000880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000890: 5820 7069 7865 6c20 636f 2d6f 7264 696e  X pixel co-ordin
-000008a0: 6174 6520 6f66 2063 656e 7465 7220 6f66  ate of center of
-000008b0: 206d 6561 6e20 7061 7474 6572 6e0a 2020   mean pattern.  
-000008c0: 2020 7963 656e 7465 723a 2020 2020 666c    ycenter:    fl
-000008d0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-000008e0: 2020 2020 5920 7069 7865 6c20 636f 2d6f      Y pixel co-o
-000008f0: 7264 696e 6174 6520 6f66 2063 656e 7465  rdinate of cente
-00000900: 7220 6f66 206d 6561 6e20 7061 7474 6572  r of mean patter
-00000910: 6e0a 0a20 2020 2052 6574 7572 6e73 0a20  n..    Returns. 
-00000920: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2063     -------.    c
-00000930: 6f72 7265 6374 6564 5f52 4f49 3a20 6e64  orrected_ROI: nd
-00000940: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00000950: 2020 2020 2020 2020 2045 6163 6820 4342           Each CB
-00000960: 4544 2070 6174 7465 726e 2066 726f 6d20  ED pattern from 
-00000970: 7468 6520 7265 6769 6f6e 206f 6620 696e  the region of in
-00000980: 7465 7265 7374 0a20 2020 2020 2020 2020  terest.         
-00000990: 2020 2020 2020 2020 2020 6669 7273 7420            first 
-000009a0: 6365 6e74 6572 6564 2061 6e64 2074 6865  centered and the
-000009b0: 6e20 726f 7461 7465 6420 616c 6f6e 6720  n rotated along 
-000009c0: 7468 6520 6365 6e74 6572 0a0a 2020 2020  the center..    
-000009d0: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-000009e0: 2020 2020 5765 2073 7461 7274 2062 7920      We start by 
-000009f0: 6365 6e74 6572 696e 6720 6561 6368 2034  centering each 4
-00000a00: 442d 5354 454d 2043 4245 4420 7061 7474  D-STEM CBED patt
-00000a10: 6572 6e0a 2020 2020 616e 6420 7468 656e  ern.    and then
-00000a20: 2072 6f74 6174 696e 6720 7468 6520 7061   rotating the pa
-00000a30: 7474 6572 6e73 2077 6974 6820 7265 7370  tterns with resp
-00000a40: 6563 7420 746f 2074 6865 0a20 2020 2070  ect to the.    p
-00000a50: 6174 7465 726e 2063 656e 7465 720a 2020  attern center.  
-00000a60: 2020 7201 0000 004e e700 0000 0000 00e0    r....N........
-00000a70: 3f72 0600 0000 e9fe ffff ff72 0200 0000  ?r.........r....
-00000a80: 4672 0300 0000 290b 7209 0000 00da 0761  Fr....).r......a
-00000a90: 7361 7272 6179 da05 7368 6170 65da 0a7a  sarray..shape..z
-00000aa0: 6572 6f73 5f6c 696b 65da 0572 616e 6765  eros_like..range
-00000ab0: da03 6162 73da 0273 74da 0475 7469 6c5a  ..abs..st..utilZ
-00000ac0: 0d6d 6f76 655f 6279 5f70 6861 7365 7207  .move_by_phaser.
-00000ad0: 0000 0072 0800 0000 290a da0a 6461 7461  ...r....)...data
-00000ae0: 3444 5f52 4f49 da08 726f 7461 6e67 6c65  4D_ROI..rotangle
-00000af0: 5a07 7863 656e 7465 725a 0779 6365 6e74  Z.xcenterZ.ycent
-00000b00: 6572 da09 6461 7461 5f73 697a 655a 0d63  er..data_sizeZ.c
-00000b10: 6f72 7265 6374 6564 5f52 4f49 da02 6969  orrected_ROI..ii
-00000b20: 5a0c 6362 6564 5f70 6174 7465 726e 5a0a  Z.cbed_patternZ.
-00000b30: 6d6f 7665 645f 6362 6564 5a0c 726f 7461  moved_cbedZ.rota
-00000b40: 7465 645f 6362 6564 720f 0000 0072 0f00  ted_cbedr....r..
-00000b50: 0000 7210 0000 00da 1572 6f74 6174 655f  ..r......rotate_
-00000b60: 616e 645f 6365 6e74 6572 5f52 4f49 3800  and_center_ROI8.
-00000b70: 0000 731c 0000 0000 1d10 010a 0112 0116  ..s.............
-00000b80: 0104 0106 0102 0110 0110 fd02 ff04 0712  ................
-00000b90: 0118 0172 2300 0000 6301 0000 0000 0000  ...r#...c.......
-00000ba0: 0000 0000 0003 0000 0004 0000 0043 0000  .............C..
-00000bb0: 0073 3800 0000 7400 a001 7c00 6401 a102  .s8...t...|.d...
-00000bc0: 7d01 7c01 6a02 7d02 7c02 6402 1900 7c02  }.|.j.}.|.d...|.
-00000bd0: 6403 1900 1400 7c02 6404 1900 7c02 6405  d.....|.d...|.d.
-00000be0: 1900 1400 6602 7c01 5f02 7c01 5300 2906  ....f.|._.|.S.).
-00000bf0: 61aa 0100 000a 2020 2020 436f 6e76 6572  a.....    Conver
-00000c00: 7420 3444 2064 6174 6120 746f 2032 4420  t 4D data to 2D 
-00000c10: 6461 7461 0a0a 2020 2020 5061 7261 6d65  data..    Parame
-00000c20: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-00000c30: 2d2d 2d0a 2020 2020 6461 7461 3444 3a20  ---.    data4D: 
-00000c40: 6e64 6172 7261 7920 6f66 2073 6861 7065  ndarray of shape
-00000c50: 2028 342c 3429 0a20 2020 2020 2020 2020   (4,4).         
-00000c60: 2020 2074 6865 2066 6972 7374 2074 776f     the first two
-00000c70: 2064 696d 656e 7369 6f6e 7320 6172 6520   dimensions are 
-00000c80: 466f 7572 6965 720a 2020 2020 2020 2020  Fourier.        
-00000c90: 2020 2020 7370 6163 652c 2077 6869 6c65      space, while
-00000ca0: 2074 6865 206e 6578 7420 7477 6f20 6469   the next two di
-00000cb0: 6d65 6e73 696f 6e73 0a20 2020 2020 2020  mensions.       
-00000cc0: 2020 2020 2061 7265 2072 6561 6c20 7370       are real sp
-00000cd0: 6163 650a 0a20 2020 2052 6574 7572 6e73  ace..    Returns
-00000ce0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00000cf0: 2064 6174 6132 443a 206e 6461 7272 6179   data2D: ndarray
-00000d00: 206f 6620 7368 6170 6520 2832 2c32 290a   of shape (2,2).
-00000d10: 2020 2020 2020 2020 2020 2020 5261 7665              Rave
-00000d20: 6c65 6420 3244 2064 6174 6120 7768 6572  led 2D data wher
-00000d30: 6520 7468 650a 2020 2020 2020 2020 2020  e the.          
-00000d40: 2020 6669 7273 7420 7477 6f20 6469 6d65    first two dime
-00000d50: 6e73 696f 6e73 2061 7265 2070 6f73 6974  nsions are posit
-00000d60: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00000d70: 2077 6869 6c65 2074 6865 206e 6578 7420   while the next 
-00000d80: 7477 6f20 6469 6d65 6e73 696f 6e73 2061  two dimensions a
-00000d90: 7265 2073 7065 6374 7261 0a20 2020 20a9  re spectra.    .
-00000da0: 04e9 0200 0000 e903 0000 0072 0100 0000  ...........r....
-00000db0: e901 0000 0072 0100 0000 7227 0000 0072  .....r....r'...r
-00000dc0: 2500 0000 7226 0000 0029 0372 0900 0000  %...r&...).r....
-00000dd0: da09 7472 616e 7370 6f73 6572 1900 0000  ..transposer....
-00000de0: 2903 da06 6461 7461 3444 da06 6461 7461  )...data4D..data
-00000df0: 3244 da0a 6461 7461 5f73 6861 7065 720f  2D..data_shaper.
-00000e00: 0000 0072 0f00 0000 7210 0000 00da 0a64  ...r....r......d
-00000e10: 6174 6134 4474 6f32 4465 0000 0073 0800  ata4Dto2De...s..
-00000e20: 0000 0012 0c01 0601 2201 722c 0000 0063  ........".r,...c
-00000e30: 0200 0000 0000 0000 0000 0000 0800 0000  ................
-00000e40: 0500 0000 4300 0000 7398 0000 007c 006a  ....C...s....|.j
-00000e50: 007d 0264 017d 0364 017d 0474 01a0 0274  .}.d.}.d.}.t...t
-00000e60: 037c 0183 01a1 017d 0574 0474 037c 0183  .|.....}.t.t.|..
-00000e70: 0183 0144 005d 6a7d 067c 037d 077c 047c  ...D.]j}.|.}.|.|
-00000e80: 0114 007c 067c 0214 0018 007c 026b 0072  ...|.|.....|.k.r
-00000e90: 5a7c 077c 007c 0419 0037 007d 077c 0464  Z|.|.|...7.}.|.d
-00000ea0: 0237 007d 0471 307c 047c 0664 0217 007c  .7.}.q0|.|.d...|
-00000eb0: 027c 011b 0014 0018 007c 007c 0464 0218  .|.......|.|.d..
-00000ec0: 0019 0014 007d 037c 077c 0338 007d 077c  .....}.|.|.8.}.|
-00000ed0: 077c 017c 021b 0014 007c 057c 063c 0071  .|.|.....|.|.<.q
-00000ee0: 287c 0553 0029 034e 7201 0000 0072 2700  (|.S.).Nr....r'.
-00000ef0: 0000 2905 da04 7369 7a65 7209 0000 00da  ..)...sizer.....
-00000f00: 057a 6572 6f73 da03 696e 7472 1b00 0000  .zeros..intr....
-00000f10: 2908 da04 6461 7461 da01 4eda 014d 5a05  )...data..N..MZ.
-00000f20: 6361 7272 79da 016d da03 7265 73da 016e  carry..m..res..n
-00000f30: 5a08 6461 7461 5f73 756d 720f 0000 0072  Z.data_sumr....r
-00000f40: 0f00 0000 7210 0000 00da 0972 6573 697a  ....r......resiz
-00000f50: 6572 3144 7d00 0000 731a 0000 0000 0106  er1D}...s.......
-00000f60: 0104 0104 010e 0110 0104 0114 010c 010a  ................
-00000f70: 0120 0108 0112 0172 3600 0000 6302 0000  . .....r6...c...
-00000f80: 0000 0000 0000 0000 0011 0000 0007 0000  ................
-00000f90: 0043 0000 0073 6c01 0000 7400 a001 7c01  .C...sl...t...|.
-00000fa0: a101 7d01 7402 7c01 8301 6401 6b00 722c  ..}.t.|...d.k.r,
-00000fb0: 7400 a001 7c01 6402 1900 7c01 6402 1900  t...|.d...|.d...
-00000fc0: 6602 a101 7d01 7403 a004 a100 7d02 7403  f...}.t.....}.t.
-00000fd0: a005 7c02 a101 7d03 7c03 6a06 7c00 6403  ..|...}.|.j.|.d.
-00000fe0: 6404 8d02 7d04 7407 a008 7c04 7c00 6a09  d...}.t...|.|.j.
-00000ff0: 7c00 6a0a a103 7d05 7400 a001 7c00 6a09  |.j...}.t...|.j.
-00001000: a101 7d06 7c06 7c01 1b00 a00b 740c a101  ..}.|.|.....t...
-00001010: 7d07 6700 7d08 6700 7d09 740d 7c06 6405  }.g.}.g.}.t.|.d.
-00001020: 1900 8301 4400 5d4a 7d0a 740e a00f 7410  ....D.]J}.t...t.
-00001030: 6a11 6a12 a101 7c05 6400 6400 8502 7c0a  j.j...|.d.d...|.
-00001040: 6602 1900 7c07 6402 1900 8302 7d0b 7407  f...|.d.....}.t.
-00001050: a008 7c0b 6405 7c07 6402 1900 6602 7c00  ..|.d.|.d...f.|.
-00001060: 6a0a a103 7d0c 7c08 a013 7c0c a101 0100  j...}.|...|.....
-00001070: 718c 7407 6a14 7c08 6402 6406 8d02 7d08  q.t.j.|.d.d...}.
-00001080: 7407 a015 7c08 6407 a102 7d08 740d 7c07  t...|.d...}.t.|.
-00001090: 6402 1900 8301 4400 5d4a 7d0d 740e a00f  d.....D.]J}.t...
-000010a0: 7410 6a11 6a12 a101 7c08 7c0d 6400 6400  t.j.j...|.|.d.d.
-000010b0: 8502 6602 1900 7c07 6405 1900 8302 7d0e  ..f...|.d.....}.
-000010c0: 7407 a008 7c0e 6405 7c07 6405 1900 6602  t...|.d.|.d...f.
-000010d0: 7c00 6a0a a103 7d0f 7c09 a013 7c0f a101  |.j...}.|...|...
-000010e0: 0100 71fe 7407 6a14 7c09 6402 6406 8d02  ..q.t.j.|.d.d...
-000010f0: 7d09 7c09 a016 a100 7d10 7c02 a017 a100  }.|.....}.|.....
-00001100: 0100 7c10 5300 2908 4e72 2500 0000 7201  ..|.S.).Nr%...r.
-00001110: 0000 0054 a901 5a09 6272 6f61 6463 6173  ...T..Z.broadcas
-00001120: 7472 2700 0000 a901 720c 0000 00a9 0272  tr'.....r......r
-00001130: 2700 0000 7201 0000 0029 1872 0900 0000  '...r....).r....
-00001140: 7218 0000 00da 036c 656e da02 6464 da0c  r......len..dd..
-00001150: 4c6f 6361 6c43 6c75 7374 6572 da06 436c  LocalCluster..Cl
-00001160: 6965 6e74 da07 7363 6174 7465 72da 0264  ient..scatter..d
-00001170: 61da 0c66 726f 6d5f 6465 6c61 7965 6472  a..from_delayedr
-00001180: 1900 0000 da05 6474 7970 65da 0661 7374  ......dtype..ast
-00001190: 7970 6572 2f00 0000 721b 0000 00da 0464  yper/...r......d
-000011a0: 6173 6bda 0764 656c 6179 6564 721d 0000  ask..delayedr...
-000011b0: 00da 046e 6265 6472 3600 0000 da06 6170  ...nbedr6.....ap
-000011c0: 7065 6e64 da0b 636f 6e63 6174 656e 6174  pend..concatenat
-000011d0: 6572 2800 0000 da07 636f 6d70 7574 65da  er(.....compute.
-000011e0: 0563 6c6f 7365 2911 722a 0000 005a 0873  .close).r*...Z.s
-000011f0: 616d 706c 696e 67da 0763 6c75 7374 6572  ampling..cluster
-00001200: da06 636c 6965 6e74 5a0b 6461 7461 3244  ..clientZ.data2D
-00001210: 5f73 6361 745a 0b64 6174 6132 445f 6461  _scatZ.data2D_da
-00001220: 736b 722b 0000 00da 0972 6573 5f73 6861  skr+.....res_sha
-00001230: 7065 da0b 7265 7361 6d70 6c65 645f 59da  pe..resampled_Y.
-00001240: 0b72 6573 616d 706c 6564 5859 da02 7878  .resampledXY..xx
-00001250: da06 696e 7465 7259 da09 696e 7465 7259  ..interY..interY
-00001260: 6172 72da 0279 79da 0669 6e74 6572 58da  arr..yy..interX.
-00001270: 0969 6e74 6572 5861 7272 da0b 7265 7361  .interXarr..resa
-00001280: 6d70 6c65 645f 6672 0f00 0000 720f 0000  mpled_fr....r...
-00001290: 0072 1000 0000 da09 7265 7369 7a65 7232  .r......resizer2
-000012a0: 448d 0000 0073 3200 0000 0001 0a01 0c01  D....s2.........
-000012b0: 1601 0801 0a01 0e01 1201 0c01 0e01 0401  ................
-000012c0: 0401 1001 2401 1801 0c01 0e02 0c01 1001  ....$...........
-000012d0: 2401 1801 0c01 0e01 0801 0801 7256 0000  $...........rV..
-000012e0: 0063 0200 0000 0000 0000 0000 0000 0a00  .c..............
-000012f0: 0000 0800 0000 4300 0000 7320 0100 0074  ......C...s ...t
-00001300: 00a0 017c 007c 006a 0264 0119 007c 006a  ...|.|.j.d...|.j
-00001310: 0264 0219 007c 006a 0264 0319 007c 006a  .d...|.j.d...|.j
-00001320: 0264 0419 0014 0066 03a1 027d 0274 00a0  .d.....f...}.t..
-00001330: 037c 026a 02a1 017d 0374 00a0 047c 03a1  .|.j...}.t...|..
-00001340: 017d 0474 00a0 057c 0364 0164 0385 0219  .}.t...|.d.d....
-00001350: 007c 011b 00a1 017c 0464 0164 0385 023c  .|.....|.d.d...<
-00001360: 0074 006a 067c 04a0 0774 08a1 017c 026a  .t.j.|...t...|.j
-00001370: 0964 058d 027d 0574 00a0 067c 0364 0119  .d...}.t...|.d..
-00001380: 007c 0464 0219 0066 027c 026a 09a1 027d  .|.d...f.|.j...}
-00001390: 0674 006a 067c 0464 0164 0385 0219 007c  .t.j.|.d.d.....|
-000013a0: 026a 0964 058d 027d 0774 0a7c 026a 0264  .j.d...}.t.|.j.d
-000013b0: 0619 0083 0144 005d 367d 0874 0b7c 0264  .....D.]6}.t.|.d
-000013c0: 0764 0785 0264 0764 0785 027c 0866 0319  .d...d.d...|.f..
-000013d0: 007c 067c 077c 0183 047c 0564 0764 0785  .|.|.|...|.d.d..
-000013e0: 0264 0764 0785 027c 0866 033c 0071 b874  .d.d...|.f.<.q.t
-000013f0: 00a0 017c 057c 076a 0264 0119 007c 076a  ...|.|.j.d...|.j
-00001400: 0264 0219 007c 006a 0264 0319 007c 006a  .d...|.j.d...|.j
-00001410: 0264 0419 0066 04a1 027d 097c 0953 0029  .d...f...}.|.S.)
-00001420: 0861 b401 0000 0a20 2020 2042 696e 2034  .a.....    Bin 4
-00001430: 4420 6461 7461 2069 6e20 7370 6563 7472  D data in spectr
-00001440: 616c 2064 696d 656e 7369 6f6e 730a 0a20  al dimensions.. 
-00001450: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00001460: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00001470: 2064 6174 6134 443a 2020 2020 206e 6461   data4D:     nda
-00001480: 7272 6179 206f 6620 7368 6170 6520 2834  rray of shape (4
-00001490: 2c34 290a 2020 2020 2020 2020 2020 2020  ,4).            
-000014a0: 2020 2020 7468 6520 6669 7273 7420 7477      the first tw
-000014b0: 6f20 6469 6d65 6e73 696f 6e73 2061 7265  o dimensions are
-000014c0: 2046 6f75 7269 6572 0a20 2020 2020 2020   Fourier.       
-000014d0: 2020 2020 2020 2020 2073 7061 6365 2c20           space, 
-000014e0: 7768 696c 6520 7468 6520 6e65 7874 2074  while the next t
-000014f0: 776f 2064 696d 656e 7369 6f6e 730a 2020  wo dimensions.  
-00001500: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00001510: 6520 7265 616c 2073 7061 6365 0a20 2020  e real space.   
-00001520: 2062 696e 5f66 6163 746f 723a 2069 6e74   bin_factor: int
-00001530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001540: 2056 616c 7565 2062 7920 7768 6963 6820   Value by which 
-00001550: 746f 2062 696e 2064 6174 610a 0a20 2020  to bin data..   
-00001560: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00001570: 2d2d 2d2d 0a20 2020 2062 696e 6e65 645f  ----.    binned_
-00001580: 6461 7461 3a20 6e64 6172 7261 7920 6f66  data: ndarray of
-00001590: 2073 6861 7065 2028 342c 3429 0a20 2020   shape (4,4).   
-000015a0: 2020 2020 2020 2020 2020 2020 2020 4461                Da
-000015b0: 7461 2062 696e 6e65 6420 696e 2074 6865  ta binned in the
-000015c0: 2073 7065 6374 7261 6c20 6469 6d65 6e73   spectral dimens
-000015d0: 696f 6e73 0a0a 2020 2020 7201 0000 0072  ions..    r....r
-000015e0: 2700 0000 7225 0000 0072 2600 0000 a901  '...r%...r&.....
-000015f0: 7241 0000 0072 0600 0000 4e29 0c72 0900  rA...r....N).r..
-00001600: 0000 7205 0000 0072 1900 0000 7218 0000  ..r....r....r...
-00001610: 00da 0463 6f70 79da 0572 6f75 6e64 722e  ...copy..roundr.
-00001620: 0000 0072 4200 0000 722f 0000 0072 4100  ...rB...r/...rA.
-00001630: 0000 721b 0000 0072 5600 0000 290a 7229  ..r....rV...).r)
-00001640: 0000 00da 0a62 696e 5f66 6163 746f 72da  .....bin_factor.
-00001650: 0b64 6174 6134 445f 666c 6174 da09 6461  .data4D_flat..da
-00001660: 7461 7368 6170 6572 4c00 0000 da0a 6461  tashaperL.....da
-00001670: 7461 3444 5f72 6573 5a0b 7265 7361 6d70  ta4D_resZ.resamp
-00001680: 6c65 645f 7872 5500 0000 da02 7a7a da0b  led_xrU.....zz..
-00001690: 6269 6e6e 6564 5f64 6174 6172 0f00 0000  binned_datar....
-000016a0: 720f 0000 0072 1000 0000 da05 6269 6e34  r....r......bin4
-000016b0: 44aa 0000 0073 2000 0000 0013 0401 26ff  D....s .......&.
-000016c0: 0403 0c01 0a01 1e01 1601 1a01 1801 1201  ................
-000016d0: 3401 0401 0201 22fe 0404 7260 0000 00e9  4....."...r`....
-000016e0: 0400 0000 6303 0000 0000 0000 0000 0000  ....c...........
-000016f0: 0016 0000 0008 0000 0043 0000 0073 f201  .........C...s..
-00001700: 0000 7400 6a01 7c02 6401 8d01 7d03 7400  ..t.j.|.d...}.t.
-00001710: a002 7c03 a101 7d04 7c04 6a03 7c00 6402  ..|...}.|.j.|.d.
-00001720: 6403 8d02 7d05 7404 a005 7c05 7c00 6a06  d...}.t...|.|.j.
-00001730: 7c00 6a07 a103 7d06 7404 a008 7c06 7c00  |.j...}.t...|.|.
-00001740: 6a06 6404 1900 7c00 6a06 6405 1900 7c00  j.d...|.j.d...|.
-00001750: 6a06 6406 1900 7c00 6a06 6407 1900 1400  j.d...|.j.d.....
-00001760: 6603 a102 7d07 7409 a00a 7c07 6a06 a101  f...}.t...|.j...
-00001770: 7d08 7409 a00b 7c08 a101 7d09 7c08 6404  }.t...|...}.|.d.
-00001780: 6406 8502 1900 7c01 1b00 a00c 740d a101  d.....|.....t...
-00001790: 7c09 6404 6406 8502 3c00 6700 7d0a 740e  |.d.d...<.g.}.t.
-000017a0: 7c08 6408 1900 8301 4400 5df2 7d0b 6700  |.d.....D.].}.g.
-000017b0: 7d0c 6700 7d0d 740e 7c08 6405 1900 8301  }.g.}.t.|.d.....
-000017c0: 4400 5d4c 7d0e 740f a010 7411 6a12 6a13  D.]L}.t...t.j.j.
-000017d0: a101 7c07 6409 6409 8502 7c0e 7c0b 6603  ..|.d.d...|.|.f.
-000017e0: 1900 7c09 6404 1900 8302 7d0f 7404 a005  ..|.d.....}.t...
-000017f0: 7c0f 6405 7c09 6404 1900 6602 7c00 6a07  |.d.|.d...f.|.j.
-00001800: a103 7d10 7c0c a014 7c10 a101 0100 71c0  ..}.|...|.....q.
-00001810: 7404 6a15 7c0c 6404 640a 8d02 7d0c 7404  t.j.|.d.d...}.t.
-00001820: a016 7c0c 640b a102 7d0c 740e 7c09 6404  ..|.d...}.t.|.d.
-00001830: 1900 8301 4400 5d4c 7d11 740f a010 7411  ....D.]L}.t...t.
-00001840: 6a12 6a13 a101 7c0c 7c11 6409 6409 8502  j.j...|.|.d.d...
-00001850: 6602 1900 7c09 6405 1900 8302 7d12 7404  f...|.d.....}.t.
-00001860: a005 7c12 6405 7c09 6405 1900 6602 7c00  ..|.d.|.d...f.|.
-00001870: 6a07 a103 7d13 7c0d a014 7c13 a101 0100  j...}.|...|.....
-00001880: 9001 7134 7404 6a15 7c0d 6404 640a 8d02  ..q4t.j.|.d.d...
-00001890: 7d0d 7c0a a014 7c0d a101 0100 71a8 7404  }.|...|.....q.t.
-000018a0: 6a17 7c0a 6404 640a 8d02 7d0a 7404 a016  j.|.d.d...}.t...
-000018b0: 7c0a 640c a102 7d0a 7404 a008 7c0a 7c09  |.d...}.t...|.|.
-000018c0: 6404 1900 7c09 6405 1900 7c00 6a06 6406  d...|.d...|.j.d.
-000018d0: 1900 7c00 6a06 6407 1900 6604 a102 7d14  ..|.j.d...f...}.
-000018e0: 7c14 a018 a100 7d15 7c03 a019 a100 0100  |.....}.|.......
-000018f0: 7c15 5300 290d 6159 0200 000a 2020 2020  |.S.).aY....    
-00001900: 4269 6e20 3444 2064 6174 6120 696e 2073  Bin 4D data in s
-00001910: 7065 6374 7261 6c20 6469 6d65 6e73 696f  pectral dimensio
-00001920: 6e73 2c0a 2020 2020 696d 706c 656d 656e  ns,.    implemen
-00001930: 7465 6420 696e 2064 6173 6b0a 0a20 2020  ted in dask..   
-00001940: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00001950: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-00001960: 6174 6134 443a 2020 2020 206e 6461 7272  ata4D:     ndarr
-00001970: 6179 206f 6620 7368 6170 6520 2834 2c34  ay of shape (4,4
-00001980: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00001990: 2020 7468 6520 6669 7273 7420 7477 6f20    the first two 
-000019a0: 6469 6d65 6e73 696f 6e73 2061 7265 2046  dimensions are F
-000019b0: 6f75 7269 6572 0a20 2020 2020 2020 2020  ourier.         
-000019c0: 2020 2020 2020 2073 7061 6365 2c20 7768         space, wh
-000019d0: 696c 6520 7468 6520 6e65 7874 2074 776f  ile the next two
-000019e0: 2064 696d 656e 7369 6f6e 730a 2020 2020   dimensions.    
-000019f0: 2020 2020 2020 2020 2020 2020 6172 6520              are 
-00001a00: 7265 616c 2073 7061 6365 0a20 2020 2062  real space.    b
-00001a10: 696e 5f66 6163 746f 723a 2069 6e74 0a20  in_factor: int. 
-00001a20: 2020 2020 2020 2020 2020 2020 2020 2056                 V
-00001a30: 616c 7565 2062 7920 7768 6963 6820 746f  alue by which to
-00001a40: 2062 696e 2064 6174 610a 2020 2020 776f   bin data.    wo
-00001a50: 726b 6572 733a 2020 2020 696e 742c 206f  rkers:    int, o
-00001a60: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00001a70: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-00001a80: 6620 6461 736b 2077 6f72 6b65 7273 2e20  f dask workers. 
-00001a90: 4465 6661 756c 7420 6973 0a20 2020 2020  Default is.     
-00001aa0: 2020 2020 2020 2020 2020 2034 2e0a 0a20             4... 
-00001ab0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00001ac0: 2d2d 2d2d 2d2d 0a20 2020 2062 696e 6e65  ------.    binne
-00001ad0: 645f 6461 7461 3a20 6e64 6172 7261 7920  d_data: ndarray 
-00001ae0: 6f66 2073 6861 7065 2028 342c 3429 0a20  of shape (4,4). 
-00001af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001b00: 4461 7461 2062 696e 6e65 6420 696e 2074  Data binned in t
-00001b10: 6865 2073 7065 6374 7261 6c20 6469 6d65  he spectral dime
-00001b20: 6e73 696f 6e73 0a0a 2020 2020 5365 6520  nsions..    See 
-00001b30: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
-00001b40: 2d0a 2020 2020 7265 7369 7a65 7231 440a  -.    resizer1D.
-00001b50: 2020 2020 2901 5a09 6e5f 776f 726b 6572      ).Z.n_worker
-00001b60: 7354 7237 0000 0072 0100 0000 7227 0000  sTr7...r....r'..
-00001b70: 0072 2500 0000 7226 0000 0072 0600 0000  .r%...r&...r....
-00001b80: 4e72 3800 0000 7239 0000 0029 0372 2700  Nr8...r9...).r'.
-00001b90: 0000 7225 0000 0072 0100 0000 291a 723b  ..r%...r....).r;
-00001ba0: 0000 0072 3c00 0000 723d 0000 0072 3e00  ...r<...r=...r>.
-00001bb0: 0000 723f 0000 0072 4000 0000 7219 0000  ..r?...r@...r...
-00001bc0: 0072 4100 0000 7205 0000 0072 0900 0000  .rA...r....r....
-00001bd0: 7218 0000 0072 5800 0000 7242 0000 0072  r....rX...rB...r
-00001be0: 2f00 0000 721b 0000 0072 4300 0000 7244  /...r....rC...rD
-00001bf0: 0000 0072 1d00 0000 7245 0000 0072 3600  ...r....rE...r6.
-00001c00: 0000 7246 0000 0072 4700 0000 7228 0000  ..rF...rG...r(..
-00001c10: 00da 0573 7461 636b 7248 0000 0072 4900  ...stackrH...rI.
-00001c20: 0000 2916 7229 0000 0072 5a00 0000 5a07  ..).r)...rZ...Z.
-00001c30: 776f 726b 6572 7372 4a00 0000 724b 0000  workersrJ...rK..
-00001c40: 005a 0b64 6174 6134 445f 7363 6174 5a0b  .Z.data4D_scatZ.
-00001c50: 6461 7461 3444 5f64 6173 6b72 5b00 0000  data4D_daskr[...
-00001c60: 725c 0000 0072 4c00 0000 5a05 7265 7334  r\...rL...Z.res4
-00001c70: 4472 5e00 0000 724d 0000 0072 4e00 0000  Dr^...rM...rN...
-00001c80: 724f 0000 0072 5000 0000 7251 0000 0072  rO...rP...rQ...r
-00001c90: 5200 0000 7253 0000 0072 5400 0000 725d  R...rS...rT...r]
-00001ca0: 0000 0072 5f00 0000 720f 0000 0072 0f00  ...r_...r....r..
-00001cb0: 0000 7210 0000 00da 0a62 696e 3444 5f64  ..r......bin4D_d
-00001cc0: 6173 6bcf 0000 0073 4a00 0000 001a 0c01  ask....sJ.......
-00001cd0: 0a01 0e01 1201 0401 0201 24fe 0404 0c01  ..........$.....
-00001ce0: 0a01 1e01 0401 1001 0401 0401 1001 0c01  ................
-00001cf0: 16ff 0403 1801 0c01 0e02 0c01 1001 2401  ..............$.
-00001d00: 1801 0e01 0e01 0c01 0e01 0c01 0401 20ff  .............. .
-00001d10: 0403 0801 0801 7263 0000 0054 6304 0000  ......rc...Tc...
-00001d20: 0000 0000 0000 0000 0008 0000 0006 0000  ................
-00001d30: 0043 0000 0073 b800 0000 7400 a001 7c01  .C...s....t...|.
-00001d40: a101 7d01 7400 6a02 6401 7c00 6a03 6401  ..}.t.j.d.|.j.d.
-00001d50: 1900 8502 6401 7c00 6a03 6402 1900 8502  ....d.|.j.d.....
-00001d60: 6602 1900 5c02 7d04 7d05 7c04 7c01 6402  f...\.}.}.|.|.d.
-00001d70: 1900 1800 7d04 7c05 7c01 6401 1900 1800  ....}.|.|.d.....
-00001d80: 7d05 7c04 6403 1300 7c05 6403 1300 1700  }.|.d...|.d.....
-00001d90: 6404 1300 7d06 7400 6a01 7c06 7c02 6b01  d...}.t.j.|.|.k.
-00001da0: 7400 6a04 6405 8d02 7d07 7c03 72b4 7405  t.j.d...}.|.r.t.
-00001db0: 6a06 6406 6407 8d01 0100 7405 6a07 7408  j.d.d.....t.j.t.
-00001dc0: 6a09 a00a 7c00 a101 7c07 1700 6408 6409  j...|...|...d.d.
-00001dd0: 8d02 0100 7405 6a0b 7c01 6401 1900 7c01  ....t.j.|.d...|.
-00001de0: 6402 1900 640a 640b 640c 8d04 0100 7c07  d...d.d.d.....|.
-00001df0: 5300 290d 6167 0300 000a 2020 2020 5465  S.).ag....    Te
-00001e00: 7374 2061 6e20 6170 6572 7475 7265 2070  st an aperture p
-00001e10: 6f73 6974 696f 6e20 666f 7220 5669 7274  osition for Virt
-00001e20: 7561 6c20 4446 2069 6d61 6765 0a0a 2020  ual DF image..  
-00001e30: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00001e40: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00001e50: 7061 7474 6572 6e3a 206e 6461 7272 6179  pattern: ndarray
-00001e60: 206f 6620 7368 6170 6520 2832 2c32 290a   of shape (2,2).
-00001e70: 2020 2020 2020 2020 2020 2020 2044 6966               Dif
-00001e80: 6672 6163 7469 6f6e 2070 6174 7465 726e  fraction pattern
-00001e90: 2c20 7072 6566 6572 6162 6c79 2074 6865  , preferably the
-00001ea0: 0a20 2020 2020 2020 2020 2020 2020 6d65  .             me
-00001eb0: 616e 2064 6966 6672 6163 7469 6f6e 2070  an diffraction p
-00001ec0: 6174 7465 726e 2066 6f72 2074 6573 7469  attern for testi
-00001ed0: 6e67 206f 7574 0a20 2020 2020 2020 2020  ng out.         
-00001ee0: 2020 2020 7468 6520 6170 6572 7475 7265      the aperture
-00001ef0: 206c 6f63 6174 696f 6e0a 2020 2020 6365   location.    ce
-00001f00: 6e74 6572 3a20 206e 6461 7272 6179 206f  nter:  ndarray o
-00001f10: 6620 7368 6170 6520 2831 2c32 290a 2020  f shape (1,2).  
-00001f20: 2020 2020 2020 2020 2020 2043 656e 7465             Cente
-00001f30: 7220 6f66 2074 6865 2063 6972 6375 6c61  r of the circula
-00001f40: 7220 6170 6572 7475 7265 0a20 2020 2072  r aperture.    r
-00001f50: 6164 6975 733a 2020 666c 6f61 740a 2020  adius:  float.  
-00001f60: 2020 2020 2020 2020 2020 2052 6164 6975             Radiu
-00001f70: 7320 6f66 2074 6865 2063 6972 6375 6c61  s of the circula
-00001f80: 7220 6170 6572 7475 7265 0a20 2020 2073  r aperture.    s
-00001f90: 686f 7766 6967 3a20 626f 6f6c 2c20 6f70  howfig: bool, op
-00001fa0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00001fb0: 2020 2020 4966 2073 686f 7766 6967 2069      If showfig i
-00001fc0: 7320 5472 7565 2c20 7468 656e 2074 6865  s True, then the
-00001fd0: 2069 6d61 6765 2069 730a 2020 2020 2020   image is.      
-00001fe0: 2020 2020 2020 2064 6973 706c 6179 6564         displayed
-00001ff0: 2077 6974 6820 7468 6520 6170 6572 7475   with the apertu
-00002000: 7265 206f 7665 726c 6169 640a 0a20 2020  re overlaid..   
-00002010: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00002020: 2d2d 2d2d 0a20 2020 2061 7065 7274 7572  ----.    apertur
-00002030: 653a 206e 6461 7272 6179 206f 6620 7368  e: ndarray of sh
-00002040: 6170 6520 2832 2c32 290a 2020 2020 2020  ape (2,2).      
-00002050: 2020 2020 2020 2020 4120 6d61 7472 6978          A matrix
-00002060: 206f 6620 7468 6520 7361 6d65 2073 697a   of the same siz
-00002070: 6520 6f66 2074 6865 2069 6e70 7574 2069  e of the input i
-00002080: 6d61 6765 0a20 2020 2020 2020 2020 2020  mage.           
-00002090: 2020 2077 6974 6820 7a65 726f 7320 6576     with zeros ev
-000020a0: 6572 7977 6865 7265 2061 6e64 206f 6e65  erywhere and one
-000020b0: 7320 7768 6572 6520 7468 6520 6170 6572  s where the aper
-000020c0: 7475 7265 0a20 2020 2020 2020 2020 2020  ture.           
-000020d0: 2020 2069 7320 7375 7070 6f73 6564 2074     is supposed t
-000020e0: 6f20 6265 0a0a 2020 2020 4e6f 7465 730a  o be..    Notes.
-000020f0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5573      -----.    Us
-00002100: 6520 7468 6520 7368 6f77 6669 6720 6f70  e the showfig op
-00002110: 7469 6f6e 2074 6f20 7669 7375 616c 6c79  tion to visually
-00002120: 2074 6573 7420 6f75 7420 7468 6520 6170   test out the ap
-00002130: 6572 7475 7265 0a20 2020 206c 6f63 6174  erture.    locat
-00002140: 696f 6e20 7769 7468 2076 6172 7969 6e67  ion with varying
-00002150: 2070 6172 616d 6574 6572 730a 2020 2020   parameters.    
-00002160: 7201 0000 0072 2700 0000 7225 0000 0072  r....r'...r%...r
-00002170: 1600 0000 7257 0000 00a9 02e9 0f00 0000  ....rW..........
-00002180: 7265 0000 00a9 01da 0766 6967 7369 7a65  re.......figsize
-00002190: 5a08 5370 6563 7472 616c a901 5a04 636d  Z.Spectral..Z.cm
-000021a0: 6170 da01 77e9 1900 0000 2902 da01 63da  ap..w.....)...c.
-000021b0: 0173 290c 7209 0000 0072 1800 0000 da05  .s).r....r......
-000021c0: 6d67 7269 6472 1900 0000 da06 646f 7562  mgridr......doub
-000021d0: 6c65 da03 706c 74da 0666 6967 7572 65da  le..plt..figure.
-000021e0: 0669 6d73 686f 7772 1d00 0000 721e 0000  .imshowr....r...
-000021f0: 00da 1069 6d61 6765 5f6e 6f72 6d61 6c69  ...image_normali
-00002200: 7a65 7272 3e00 0000 2908 da07 7061 7474  zerr>...)...patt
-00002210: 6572 6eda 0663 656e 7465 72da 0672 6164  ern..center..rad
-00002220: 6975 73da 0773 686f 7766 6967 7252 0000  ius..showfigrR..
-00002230: 0072 4f00 0000 da02 7272 da08 6170 6572  .rO.....rr..aper
-00002240: 7475 7265 720f 0000 0072 0f00 0000 7210  turer....r....r.
-00002250: 0000 00da 0d74 6573 745f 6170 6572 7475  .....test_apertu
-00002260: 7265 1101 0000 7316 0000 0000 1e0a 0126  re....s........&
-00002270: 010c 010c 0114 0114 0104 010c 011a 011a  ................
-00002280: 0172 7900 0000 6303 0000 0000 0000 0000  .ry...c.........
-00002290: 0000 000a 0000 0005 0000 0043 0000 0073  ...........C...s
-000022a0: d200 0000 7400 a001 7c01 a101 7d01 7400  ....t...|...}.t.
-000022b0: 6a02 6401 7c00 6a03 6401 1900 8502 6401  j.d.|.j.d.....d.
-000022c0: 7c00 6a03 6402 1900 8502 6602 1900 5c02  |.j.d.....f...\.
-000022d0: 7d03 7d04 7c03 7c01 6402 1900 1800 7d03  }.}.|.|.d.....}.
-000022e0: 7c04 7c01 6401 1900 1800 7d04 7c03 6403  |.|.d.....}.|.d.
-000022f0: 1300 7c04 6403 1300 1700 6404 1300 7d05  ..|.d.....d...}.
-00002300: 7400 6a04 7c05 7c02 6b01 7c00 6a05 6405  t.j.|.|.k.|.j.d.
-00002310: 8d02 7d06 7400 6a06 7c00 6a03 6403 1900  ..}.t.j.|.j.d...
-00002320: 7c00 6a03 6406 1900 6602 7c06 6a03 1700  |.j.d...f.|.j...
-00002330: 7c00 6a05 6405 8d02 7d07 7c06 7c07 6407  |.j.d...}.|.|.d.
-00002340: 6407 8502 3c00 7400 a007 7c07 6408 a102  d...<.t...|.d...
-00002350: 7d07 7c07 7c00 1400 7d08 7400 6a08 7400  }.|.|...}.t.j.t.
-00002360: 6a08 7c08 6401 6409 8d02 6401 6409 8d02  j.|.d.d...d.d...
-00002370: 7d09 7c09 5300 290a 614d 0300 000a 2020  }.|.S.).aM....  
-00002380: 2020 4765 6e65 7261 7465 2056 6972 7475    Generate Virtu
-00002390: 616c 2044 4620 696d 6167 6520 666f 7220  al DF image for 
-000023a0: 6120 6769 7665 6e20 6170 6572 7475 7265  a given aperture
-000023b0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-000023c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-000023d0: 2020 2020 6461 7461 3444 3a20 6e64 6172      data4D: ndar
-000023e0: 7261 7920 6f66 2073 6861 7065 2028 342c  ray of shape (4,
-000023f0: 3429 0a20 2020 2020 2020 2020 2020 2074  4).            t
-00002400: 6865 2066 6972 7374 2074 776f 2064 696d  he first two dim
-00002410: 656e 7369 6f6e 7320 6172 6520 466f 7572  ensions are Four
-00002420: 6965 720a 2020 2020 2020 2020 2020 2020  ier.            
-00002430: 7370 6163 652c 2077 6869 6c65 2074 6865  space, while the
-00002440: 206e 6578 7420 7477 6f20 6469 6d65 6e73   next two dimens
-00002450: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00002460: 2061 7265 2072 6561 6c20 7370 6163 650a   are real space.
-00002470: 2020 2020 6365 6e74 6572 3a20 6e64 6172      center: ndar
-00002480: 7261 7920 6f66 2073 6861 7065 2028 312c  ray of shape (1,
-00002490: 3229 0a20 2020 2020 2020 2020 2020 2043  2).            C
-000024a0: 656e 7465 7220 6f66 2074 6865 2063 6972  enter of the cir
-000024b0: 6375 6c61 7220 6170 6572 7475 7265 0a20  cular aperture. 
-000024c0: 2020 2072 6164 6975 733a 2066 6c6f 6174     radius: float
-000024d0: 0a20 2020 2020 2020 2020 2020 2052 6164  .            Rad
-000024e0: 6975 7320 6f66 2074 6865 2063 6972 6375  ius of the circu
-000024f0: 6c61 7220 6170 6572 7475 7265 0a0a 2020  lar aperture..  
-00002500: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
-00002510: 2d2d 2d2d 2d0a 2020 2020 6466 5f69 6d61  -----.    df_ima
-00002520: 6765 3a20 6e64 6172 7261 7920 6f66 2073  ge: ndarray of s
-00002530: 6861 7065 2028 322c 3229 0a20 2020 2020  hape (2,2).     
-00002540: 2020 2020 2020 2020 2047 656e 6572 6174           Generat
-00002550: 6564 2076 6972 7475 616c 2064 6172 6b20  ed virtual dark 
-00002560: 6669 656c 6420 696d 6167 650a 2020 2020  field image.    
-00002570: 2020 2020 2020 2020 2020 6672 6f6d 2074            from t
-00002580: 6865 2061 7065 7274 7572 6520 616e 6420  he aperture and 
-00002590: 3444 2064 6174 610a 0a20 2020 204e 6f74  4D data..    Not
-000025a0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-000025b0: 2057 6520 6765 6e65 7261 7465 2074 6865   We generate the
-000025c0: 2061 7065 7274 7572 6520 6669 7273 742c   aperture first,
-000025d0: 2061 6e64 2074 6865 6e20 6d61 6b65 2063   and then make c
-000025e0: 6f70 6965 730a 2020 2020 6f66 2074 6865  opies.    of the
-000025f0: 2061 7065 7274 7572 6520 746f 2067 656e   aperture to gen
-00002600: 6572 6174 6520 6120 3444 2064 6174 6173  erate a 4D datas
-00002610: 6574 206f 6620 7468 6520 7361 6d65 0a20  et of the same. 
-00002620: 2020 2073 697a 6520 6173 2074 6865 2034     size as the 4
-00002630: 4420 6461 7461 2e20 5468 656e 2077 6520  D data. Then we 
-00002640: 646f 2061 6e20 656c 656d 656e 7420 7769  do an element wi
-00002650: 7365 0a20 2020 206d 756c 7469 706c 6963  se.    multiplic
-00002660: 6174 696f 6e20 6f66 2074 6869 7320 6170  ation of this ap
-00002670: 6572 7475 7265 2034 4420 6461 7461 2077  erture 4D data w
-00002680: 6974 6820 7468 6520 3444 2064 6174 610a  ith the 4D data.
-00002690: 2020 2020 616e 6420 7468 656e 2073 756d      and then sum
-000026a0: 2069 7420 616c 6f6e 6720 7468 6520 7477   it along the tw
-000026b0: 6f20 466f 7572 6965 7220 6469 7265 6374  o Fourier direct
-000026c0: 696f 6e73 2e0a 2020 2020 7201 0000 0072  ions..    r....r
-000026d0: 2700 0000 7225 0000 0072 1600 0000 7257  '...r%...r....rW
-000026e0: 0000 0072 2600 0000 4e72 2400 0000 7238  ...r&...Nr$...r8
-000026f0: 0000 0029 0972 0900 0000 da05 6172 7261  ...).r......arra
-00002700: 7972 6d00 0000 7219 0000 0072 1800 0000  yrm...r....r....
-00002710: 7241 0000 00da 0565 6d70 7479 7228 0000  rA.....emptyr(..
-00002720: 0072 0a00 0000 290a 7229 0000 0072 7400  .r....).r)...rt.
-00002730: 0000 7275 0000 0072 5200 0000 724f 0000  ..ru...rR...rO..
-00002740: 0072 7700 0000 7278 0000 005a 0861 7074  .rw...rx...Z.apt
-00002750: 5f63 6f70 795a 0861 7074 5f6d 756c 745a  _copyZ.apt_multZ
-00002760: 0864 665f 696d 6167 6572 0f00 0000 720f  .df_imager....r.
-00002770: 0000 0072 1000 0000 da0e 6170 6572 7475  ...r......apertu
-00002780: 7265 5f69 6d61 6765 3c01 0000 731c 0000  re_image<...s...
-00002790: 0000 1d0a 0126 010c 010c 0114 0114 0104  .....&..........
-000027a0: 011c ff06 030c 010c 0108 0118 0172 7c00  .............r|.
-000027b0: 0000 da04 6f76 6572 6304 0000 0000 0000  ....overc.......
-000027c0: 0000 0000 0005 0000 0006 0000 0043 0000  .............C..
-000027d0: 0073 8800 0000 7c02 6401 6b02 7228 7400  .s....|.d.k.r(t.
-000027e0: 6a01 7c00 7c01 7400 a002 7c00 a101 1400  j.|.|.t...|.....
-000027f0: 6b04 7400 6a03 6402 8d02 7d04 6e1e 7400  k.t.j.d...}.n.t.
-00002800: 6a01 7c00 7c01 7400 a002 7c00 a101 1400  j.|.|.t...|.....
-00002810: 6b00 7400 6a03 6402 8d02 7d04 7c03 727a  k.t.j.d...}.|.rz
-00002820: 7404 6a05 6403 6404 8d01 0100 7404 6a06  t.j.d.d.....t.j.
-00002830: 7c04 7407 6a08 a009 7c00 a101 1700 6405  |.t.j...|.....d.
-00002840: 6406 8d02 0100 7404 a00a 6407 a101 0100  d.....t...d.....
-00002850: 7c04 a00b 740c a101 7d04 7c04 5300 2908  |...t...}.|.S.).
-00002860: 4e72 7d00 0000 7257 0000 0072 6400 0000  Nr}...rW...rd...
-00002870: 7266 0000 005a 0776 6972 6964 6973 7268  rf...Z.viridisrh
-00002880: 0000 007a 0c52 4f49 206f 7665 726c 6169  ...z.ROI overlai
-00002890: 6429 0d72 0900 0000 7218 0000 00da 066d  d).r....r......m
-000028a0: 6564 6961 6e72 6e00 0000 726f 0000 0072  edianrn...ro...r
-000028b0: 7000 0000 7271 0000 0072 1d00 0000 721e  p...rq...r....r.
-000028c0: 0000 0072 7200 0000 da05 7469 746c 6572  ...rr.....titler
-000028d0: 4200 0000 da04 626f 6f6c 2905 da05 696d  B.....bool)...im
-000028e0: 6167 65da 076d 6564 5f76 616c da05 7374  age..med_val..st
-000028f0: 796c 6572 7600 0000 da03 524f 4972 0f00  ylerv.....ROIr..
-00002900: 0000 720f 0000 0072 1000 0000 da0e 524f  ..r....r......RO
-00002910: 495f 6672 6f6d 5f69 6d61 6765 6901 0000  I_from_imagei...
-00002920: 7312 0000 0000 0108 0120 021e 0104 010c  s........ ......
-00002930: 011a 010a 010a 0172 8500 0000 a902 7201  .......r......r.
-00002940: 0000 0072 0100 0000 4663 0600 0000 0000  ...r....Fc......
-00002950: 0000 0000 0000 0b00 0000 0600 0000 4300  ..............C.
-00002960: 0000 7324 0100 0074 00a0 017c 03a1 017d  ..s$...t...|...}
-00002970: 037c 0364 0119 0064 016b 0272 2864 027c  .|.d...d.k.r(d.|
-00002980: 006a 0264 0119 0014 007c 0364 013c 007c  .j.d.....|.d.<.|
-00002990: 0364 0319 0064 016b 0272 4664 027c 006a  .d...d.k.rFd.|.j
-000029a0: 0264 0319 0014 007c 0364 033c 0074 006a  .d.....|.d.<.t.j
-000029b0: 0364 017c 006a 0264 0119 0085 0264 017c  .d.|.j.d.....d.|
-000029c0: 006a 0264 0319 0085 0266 0219 005c 027d  .j.d.....f...\.}
-000029d0: 067d 077c 0464 016b 0472 9c7c 017c 0414  .}.|.d.k.r.|.|..
-000029e0: 007d 017c 027c 0414 007d 027c 037c 0414  .}.|.|...}.|.|..
-000029f0: 007d 037c 067c 0414 007d 067c 077c 0414  .}.|.|...}.|.|..
-00002a00: 007d 077c 067c 0364 0119 0018 007d 067c  .}.|.|.d.....}.|
-00002a10: 077c 0364 0319 0018 007d 077c 0664 0413  .|.d.....}.|.d..
-00002a20: 007c 0764 0413 0017 0064 0213 007d 087c  .|.d.....d...}.|
-00002a30: 0264 016b 0272 da74 00a0 047c 08a1 017d  .d.k.r.t...|...}
-00002a40: 0274 00a0 057c 087c 016b 047c 087c 026b  .t...|.|.k.|.|.k
-00002a50: 00a1 027d 0974 006a 067c 007c 0964 0564  ...}.t.j.|.|.d.d
-00002a60: 0585 0264 0564 0585 0266 0319 0064 0164  ...d.d...f...d.d
-00002a70: 068d 027d 0a7c 0590 0172 1c7c 0a7c 0966  ...}.|...r.|.|.f
-00002a80: 0253 007c 0a53 0064 0553 0029 0761 4505  .S.|.S.d.S.).aE.
-00002a90: 0000 0a20 2020 2052 6574 7572 6e20 5354  ...    Return ST
-00002aa0: 454d 2069 6d61 6765 2066 726f 6d20 6465  EM image from de
-00002ab0: 7465 6374 6f72 2076 616c 7565 730a 0a20  tector values.. 
-00002ac0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00002ad0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00002ae0: 2064 6174 6134 443a 2020 2020 2020 206e   data4D:       n
-00002af0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-00002b00: 2020 2020 2020 2020 2074 6865 2066 6972           the fir
-00002b10: 7374 2074 776f 2064 696d 656e 7369 6f6e  st two dimension
-00002b20: 7320 6172 6520 466f 7572 6965 720a 2020  s are Fourier.  
-00002b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b40: 7370 6163 652c 2077 6869 6c65 2074 6865  space, while the
-00002b50: 206e 6578 7420 7477 6f20 6469 6d65 6e73   next two dimens
-00002b60: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00002b70: 2020 2020 2020 2061 7265 2072 6561 6c20         are real 
-00002b80: 7370 6163 650a 2020 2020 696e 6e65 723a  space.    inner:
-00002b90: 2020 2020 2020 2020 666c 6f61 740a 2020          float.  
-00002ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bb0: 5468 6520 696e 6e65 7220 636f 6c6c 6563  The inner collec
-00002bc0: 7469 6f6e 2061 6e67 6c65 2069 6e20 466f  tion angle in Fo
-00002bd0: 7572 6965 7220 7370 6163 650a 2020 2020  urier space.    
-00002be0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00002bf0: 2070 6978 656c 730a 2020 2020 6f75 7465   pixels.    oute
-00002c00: 723a 2020 2020 2020 2020 666c 6f61 742c  r:        float,
-00002c10: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00002c20: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00002c30: 696e 6e65 7220 636f 6c6c 6563 7469 6f6e  inner collection
-00002c40: 2061 6e67 6c65 2069 6e20 466f 7572 6965   angle in Fourie
-00002c50: 7220 7370 6163 650a 2020 2020 2020 2020  r space.        
-00002c60: 2020 2020 2020 2020 2020 696e 2070 6978            in pix
-00002c70: 656c 732e 2044 6566 6175 6c74 2069 7320  els. Default is 
-00002c80: 300a 2020 2020 6365 6e74 6572 3a20 2020  0.    center:   
-00002c90: 2020 2020 7475 706c 652c 206f 7074 696f      tuple, optio
-00002ca0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00002cb0: 2020 2020 2020 5468 6520 6365 6e74 6572        The center
-00002cc0: 206f 6620 7468 6520 3444 2d53 5445 4d20   of the 4D-STEM 
-00002cd0: 7061 7474 6572 6e20 696e 2046 6f75 7269  pattern in Fouri
-00002ce0: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-00002cf0: 2020 2020 2073 7061 6365 2e20 4465 6661       space. Defa
-00002d00: 756c 7420 6973 2028 302c 2030 290a 2020  ult is (0, 0).  
-00002d10: 2020 6d72 6164 5f63 616c 6962 3a20 2020    mrad_calib:   
-00002d20: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
-00002d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002d40: 2020 4361 6c69 6272 6174 696f 6e20 6f66    Calibration of
-00002d50: 2074 6865 2046 6f75 7269 6572 2073 7061   the Fourier spa
-00002d60: 6365 2e20 4465 6661 756c 740a 2020 2020  ce. Default.    
-00002d70: 2020 2020 2020 2020 2020 2020 2020 6973                is
-00002d80: 2030 2e0a 2020 2020 6765 745f 6465 7465   0..    get_dete
-00002d90: 6374 6f72 3a20 626f 6f6c 2c20 6f70 7469  ctor: bool, opti
-00002da0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00002db0: 2020 2020 2020 2047 6574 2074 6865 2064         Get the d
-00002dc0: 6574 6563 746f 7220 6172 7261 7920 6966  etector array if
-00002dd0: 2073 6574 2074 6f20 5472 7565 2e20 4465   set to True. De
-00002de0: 6661 756c 7420 6973 0a20 2020 2020 2020  fault is.       
-00002df0: 2020 2020 2020 2020 2020 2046 616c 7365             False
-00002e00: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00002e10: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6461    -------.    da
-00002e20: 7461 5f64 6574 3a20 6e64 6172 7261 790a  ta_det: ndarray.
-00002e30: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00002e40: 6520 5354 454d 2069 6d61 6765 2066 726f  e STEM image fro
-00002e50: 6d20 7468 6520 6465 7465 6374 6f72 2072  m the detector r
-00002e60: 6567 696f 6e20 6368 6f73 656e 0a20 2020  egion chosen.   
-00002e70: 2064 6574 6563 746f 723a 206e 6461 7272   detector: ndarr
-00002e80: 6179 2c20 6f70 7469 6f6e 616c 0a20 2020  ay, optional.   
-00002e90: 2020 2020 2020 2020 2020 2054 6865 2062             The b
-00002ea0: 6f6f 6c65 616e 206e 6461 7272 6179 2069  oolean ndarray i
-00002eb0: 6620 6765 745f 6465 7465 6374 6f72 2069  f get_detector i
-00002ec0: 7320 5472 7565 0a0a 2020 2020 4e6f 7465  s True..    Note
-00002ed0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
-00002ee0: 4261 7365 6420 6f6e 2074 6865 2069 6e6e  Based on the inn
-00002ef0: 6572 2061 6e64 206f 7574 6572 2063 6f6c  er and outer col
-00002f00: 6c65 6374 696f 6e20 616e 676c 6520 7468  lection angle th
-00002f10: 6520 6120 5354 454d 0a20 2020 2069 6d61  e a STEM.    ima
-00002f20: 6765 2069 7320 6765 6e65 7261 7465 6420  ge is generated 
-00002f30: 6672 6f6d 2074 6865 2034 442d 5354 454d  from the 4D-STEM
-00002f40: 2064 6174 6173 6574 2e20 5765 2061 7373   dataset. We ass
-00002f50: 756d 6520 7468 6174 0a20 2020 2074 6865  ume that.    the
-00002f60: 2066 6972 7374 2074 776f 2064 696d 656e   first two dimen
-00002f70: 7369 6f6e 7320 6172 6520 7468 6520 466f  sions are the Fo
-00002f80: 7572 6965 7220 7370 6163 652c 2077 6869  urier space, whi
-00002f90: 6c65 2074 6865 0a20 2020 206e 6578 7420  le the.    next 
-00002fa0: 7477 6f20 6469 6d65 6e73 696f 6e73 2061  two dimensions a
-00002fb0: 7265 2072 6561 6c20 7370 6163 6520 7363  re real space sc
-00002fc0: 616e 6e69 6e67 2064 696d 656e 7369 6f6e  anning dimension
-00002fd0: 732e 0a20 2020 2072 0100 0000 7216 0000  s..    r....r...
-00002fe0: 0072 2700 0000 7225 0000 004e 7238 0000  .r'...r%...Nr8..
-00002ff0: 0029 0772 0900 0000 7218 0000 0072 1900  .).r....r....r..
-00003000: 0000 726d 0000 00da 0461 6d61 78da 0b6c  ..rm.....amax..l
-00003010: 6f67 6963 616c 5f61 6e64 720a 0000 0029  ogical_andr....)
-00003020: 0b72 2900 0000 da05 696e 6e65 725a 056f  .r).....innerZ.o
-00003030: 7574 6572 7274 0000 005a 0a6d 7261 645f  uterrt...Z.mrad_
-00003040: 6361 6c69 625a 0c67 6574 5f64 6574 6563  calibZ.get_detec
-00003050: 746f 7272 5200 0000 724f 0000 0072 7700  torrR...rO...rw.
-00003060: 0000 5a08 6465 7465 6374 6f72 5a08 6461  ..Z.detectorZ.da
-00003070: 7461 5f64 6574 720f 0000 0072 0f00 0000  ta_detr....r....
-00003080: 7210 0000 00da 0f63 7573 746f 6d5f 6465  r......custom_de
-00003090: 7465 6374 6f72 7601 0000 732c 0000 0000  tectorv...s,....
-000030a0: 2a0a 010c 0112 010c 0112 0126 0108 0108  *..........&....
-000030b0: 0108 0108 0108 0108 010c 010c 0114 0108  ................
-000030c0: 010a 0114 0120 0106 0108 0272 8a00 0000  ..... .....r....
-000030d0: 6302 0000 0000 0000 0000 0000 000b 0000  c...............
-000030e0: 0006 0000 0043 0000 0073 2801 0000 7400  .....C...s(...t.
-000030f0: a001 7c00 a101 6401 1900 7d02 7400 6a02  ..|...d...}.t.j.
-00003100: 7c02 7400 6a03 6402 8d02 7c02 1b00 7d03  |.t.j.d...|...}.
-00003110: 7c00 7400 a004 7c00 a101 1800 7400 a005  |.t...|.....t...
-00003120: 7c00 a101 7400 a004 7c00 a101 1800 1b00  |...t...|.......
-00003130: 7d04 7400 6a06 7c01 7400 6a03 6402 8d02  }.t.j.|.t.j.d...
-00003140: 7d05 7400 6a07 7c01 6403 1900 7c01 6401  }.t.j.|.d...|.d.
-00003150: 1900 6404 6603 7400 6a03 6402 8d02 7d06  ..d.f.t.j.d...}.
-00003160: 7400 6a07 7c01 6403 1900 7c01 6401 1900  t.j.|.d...|.d...
-00003170: 6404 6603 7400 6a03 6402 8d02 7d07 7c05  d.f.t.j.d...}.|.
-00003180: 7c06 6400 6400 8502 6400 6400 8502 6401  |.d.d...d.d...d.
-00003190: 6603 3c00 7408 7c02 8301 4400 5d66 7d08  f.<.t.|...D.]f}.
-000031a0: 7400 a009 7c04 6400 6400 8502 7c08 6602  t...|.d.d...|.f.
-000031b0: 1900 7c01 a102 a00a 7400 6a03 a101 7d09  ..|.....t.j...}.
-000031c0: 7c05 7c03 7c08 1900 1400 7c06 6400 6400  |.|.|.....|.d.d.
-000031d0: 8502 6400 6400 8502 6403 6603 3c00 7c09  ..d.d...d.f.<.|.
-000031e0: 7c06 6400 6400 8502 6400 6400 8502 6405  |.d.d...d.d...d.
-000031f0: 6603 3c00 7c07 740b a00c 7c06 a101 1700  f.<.|.t...|.....
-00003200: 7d07 71ae 7c07 7400 a005 7c07 a101 1b00  }.q.|.t...|.....
-00003210: 7d0a 7c0a 5300 2906 4e72 2700 0000 7257  }.|.S.).Nr'...rW
-00003220: 0000 0072 0100 0000 7226 0000 0072 2500  ...r....r&...r%.
-00003230: 0000 290d 7209 0000 0072 1900 0000 da06  ..).r....r......
-00003240: 6172 616e 6765 da07 666c 6f61 7436 3472  arange..float64r
-00003250: 0b00 0000 7287 0000 00da 046f 6e65 7372  ....r......onesr
-00003260: 2e00 0000 721b 0000 0072 0500 0000 7242  ....r....r....rB
-00003270: 0000 00da 046d 706c 635a 0a68 7376 5f74  .....mplcZ.hsv_t
-00003280: 6f5f 7267 6229 0b5a 0963 6f6e 635f 6461  o_rgb).Z.conc_da
-00003290: 7461 722b 0000 005a 0a6e 6f5f 7370 6563  tar+...Z.no_spec
-000032a0: 7472 615a 0a63 6f6c 6f72 5f68 7565 735a  traZ.color_huesZ
-000032b0: 096e 6f72 6d5f 636f 6e63 5a11 7361 7475  .norm_concZ.satu
-000032c0: 7261 7469 6f6e 5f6d 6174 7269 785a 0868  ration_matrixZ.h
-000032d0: 7376 5f63 616c 635a 0872 6762 5f63 616c  sv_calcZ.rgb_cal
-000032e0: 6372 2200 0000 5a0a 636f 6e63 5f69 6d61  cr"...Z.conc_ima
-000032f0: 6765 5a09 7267 625f 696d 6167 6572 0f00  geZ.rgb_imager..
-00003300: 0000 720f 0000 0072 1000 0000 da0b 636f  ..r....r......co
-00003310: 6c6f 7265 645f 6d63 72b9 0100 0073 2000  lored_mcr....s .
-00003320: 0000 0001 0e01 1401 0c01 12ff 0403 1001  ................
-00003330: 1e01 1e01 1601 0c01 2001 1e01 1601 1001  ........ .......
-00003340: 0e01 728f 0000 0063 0500 0000 0000 0000  ..r....c........
-00003350: 0000 0000 1b00 0000 0b00 0000 4300 0000  ............C...
-00003360: 7366 0300 0074 00a0 0164 01a1 0101 0074  sf...t...d.....t
-00003370: 0274 03a0 047c 02a1 0164 0219 0083 017d  .t...|...d.....}
-00003380: 0574 036a 057c 0374 036a 0664 038d 027d  .t.j.|.t.j.d...}
-00003390: 0374 03a0 077c 02a1 017d 0674 036a 0864  .t...|...}.t.j.d
-000033a0: 027c 006a 0464 0219 0085 0264 027c 006a  .|.j.d.....d.|.j
-000033b0: 0464 0419 0085 0266 0219 005c 027d 077d  .d.....f...\.}.}
-000033c0: 0874 097c 0583 0144 005d a27d 097c 027c  .t.|...D.].}.|.|
-000033d0: 0964 0266 0219 007d 0a7c 027c 0964 0466  .d.f...}.|.|.d.f
-000033e0: 0219 007d 0b7c 077c 0b18 0064 0513 007c  ...}.|.|...d...|
-000033f0: 087c 0a18 0064 0513 0017 007c 0164 0513  .|...d.....|.d..
-00003400: 006b 017d 0c74 03a0 0a7c 007c 0c19 00a1  .k.}.t...|.|....
-00003410: 0174 03a0 0b7c 007c 0c19 00a1 011b 007d  .t...|.|.......}
-00003420: 0d7c 0d64 047c 0417 006b 0072 dc74 036a  .|.d.|...k.r.t.j
-00003430: 0c7c 067c 0964 0264 0585 0266 023c 0071  .|.|.d.d...f.<.q
-00003440: 6474 0d6a 0ea0 0f7c 007c 0a7c 0b7c 01a1  dt.j...|.|.|.|..
-00003450: 047d 0e7c 0e64 0264 0585 0219 007c 067c  .}.|.d.d.....|.|
-00003460: 0964 0264 0585 0266 023c 0071 6474 03a0  .d.d...f.<.qdt..
-00003470: 0274 03a0 1074 03a0 117c 06a1 01a1 0164  .t...t...|.....d
-00003480: 051b 00a1 017d 0f7c 0f7c 056b 0290 0172  .....}.|.|.k...r
-00003490: 4c74 036a 0c74 03a0 1264 06a1 0114 007d  Lt.j.t...d.....}
-000034a0: 1074 036a 0c7d 1174 036a 0c7d 1290 026e  .t.j.}.t.j.}...n
-000034b0: 0e7c 0374 03a0 117c 06a1 010f 0019 00a0  .|.t...|........
-000034c0: 137c 057c 0f18 0064 05a1 027d 037c 0674  .|.|...d...}.|.t
-000034d0: 03a0 117c 06a1 010f 0019 00a0 137c 057c  ...|.........|.|
-000034e0: 0f18 0064 05a1 027d 0674 03a0 147c 06a1  ...d...}.t...|..
-000034f0: 017d 1364 077c 1364 0864 0885 0264 0466  .}.d.|.d.d...d.f
-00003500: 0219 0014 007c 1364 0864 0885 0264 0466  .....|.d.d...d.f
-00003510: 023c 007c 1374 03a0 157c 0364 0864 0885  .<.|.t...|.d.d..
-00003520: 0264 0266 0219 0064 026b 027c 0364 0864  .d.f...d.k.|.d.d
-00003530: 0885 0264 0466 0219 0064 026b 02a1 0264  ...d.f...d.k...d
-00003540: 0864 0885 0266 0219 007d 147c 146a 0464  .d...f...}.|.j.d
-00003550: 0219 0064 026b 0490 0372 487c 1464 0919  ...d.k...rH|.d..
-00003560: 007d 157c 1464 0a19 007d 1674 036a 057c  .}.|.d...}.t.j.|
-00003570: 157c 160b 0066 0274 036a 0664 038d 027d  .|...f.t.j.d...}
-00003580: 107c 0f7c 051b 0064 0b6b 0090 0372 3a7c  .|.|...d.k...r:|
-00003590: 1364 0864 0885 0264 0264 0585 0266 0219  .d.d...d.d...f..
-000035a0: 0074 036a 057c 157c 1666 0274 036a 0664  .t.j.|.|.f.t.j.d
-000035b0: 038d 0218 007c 1364 0864 0885 0264 0264  .....|.d.d...d.d
-000035c0: 0585 0266 023c 0074 036a 166a 177c 037c  ...f.<.t.j.j.|.|
-000035d0: 1364 0864 0c8d 035c 047d 127d 177d 177d  .d.d...\.}.}.}.}
-000035e0: 1774 03a0 187c 037c 12a1 027d 1874 03a0  .t...|.|...}.t..
-000035f0: 1974 03a0 1a7c 1374 03a0 1b7c 1864 0864  .t...|.t...|.d.d
-00003600: 0885 0264 0266 0219 0064 026b 03a1 0164  ...d.f...d.k...d
-00003610: 0266 0219 007c 1874 03a0 1b7c 1864 0864  .f...|.t...|.d.d
-00003620: 0885 0264 0266 0219 0064 026b 03a1 0164  ...d.f...d.k...d
-00003630: 0266 0219 00a1 02a1 017d 1974 03a0 1974  .f.......}.t...t
-00003640: 03a0 1a7c 1374 03a0 1b7c 1864 0864 0885  ...|.t...|.d.d..
-00003650: 0264 0466 0219 0064 026b 03a1 0164 0466  .d.f...d.k...d.f
-00003660: 0219 007c 1874 03a0 1b7c 1864 0864 0885  ...|.t...|.d.d..
-00003670: 0264 0466 0219 0064 026b 03a1 0164 0466  .d.f...d.k...d.f
-00003680: 0219 00a1 02a1 017d 1a74 036a 057c 197c  .......}.t.j.|.|
-00003690: 1a66 0274 036a 0664 038d 027d 116e 0c74  .f.t.j.d...}.n.t
-000036a0: 036a 0c7d 1174 036a 0c7d 126e 1274 036a  .j.}.t.j.}.n.t.j
-000036b0: 0c7d 1074 036a 0c7d 1174 036a 0c7d 127c  .}.t.j.}.t.j.}.|
-000036c0: 067c 107c 117c 1266 0453 0029 0d61 d007  .|.|.|.f.S.).a..
-000036d0: 0000 0a20 2020 2044 6973 6b20 4669 7474  ...    Disk Fitt
-000036e0: 696e 6720 616c 676f 7269 7468 6d20 666f  ing algorithm fo
-000036f0: 7220 6120 7369 6e67 6c65 204e 4245 4420  r a single NBED 
-00003700: 7061 7474 6572 6e0a 0a20 2020 2050 6172  pattern..    Par
-00003710: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00003720: 2d2d 2d2d 2d2d 0a20 2020 2063 6f72 725f  ------.    corr_
-00003730: 696d 6167 653a 206e 6461 7272 6179 206f  image: ndarray o
-00003740: 6620 7368 6170 6520 2832 2c32 290a 2020  f shape (2,2).  
-00003750: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00003760: 6520 6372 6f73 732d 636f 7272 656c 6174  e cross-correlat
-00003770: 6564 2069 6d61 6765 206f 6620 7468 6520  ed image of the 
-00003780: 4e42 4544 2074 6861 740a 2020 2020 2020  NBED that.      
-00003790: 2020 2020 2020 2020 2020 7769 6c6c 2062            will b
-000037a0: 6520 6669 7474 6564 0a20 2020 2064 6973  e fitted.    dis
-000037b0: 6b5f 7369 7a65 3a20 2066 6c6f 6174 0a20  k_size:  float. 
-000037c0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-000037d0: 697a 6520 6f66 2065 6163 6820 4e42 4544  ize of each NBED
-000037e0: 2064 6973 6b73 2069 6e20 7069 7865 6c73   disks in pixels
-000037f0: 0a20 2020 2070 6f73 6974 696f 6e73 3a20  .    positions: 
-00003800: 206e 6461 7272 6179 206f 6620 7368 6170   ndarray of shap
-00003810: 6520 286e 2c32 290a 2020 2020 2020 2020  e (n,2).        
-00003820: 2020 2020 2020 2020 5820 616e 6420 5920          X and Y 
-00003830: 706f 7369 7469 6f6e 7320 7768 6572 6520  positions where 
-00003840: 6e20 6973 2074 6865 206e 756d 6265 7220  n is the number 
-00003850: 6f66 2070 6f73 6974 696f 6e73 2e0a 2020  of positions..  
-00003860: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00003870: 6573 6520 6172 6520 7468 6520 696e 6974  ese are the init
-00003880: 6961 6c20 6775 6573 7365 7320 7468 6174  ial guesses that
-00003890: 2077 696c 6c20 6265 2072 6566 696e 6564   will be refined
-000038a0: 0a20 2020 2064 6966 665f 7370 6f74 733a  .    diff_spots:
-000038b0: 206e 6461 7272 6179 206f 6620 7368 6170   ndarray of shap
-000038c0: 6520 286e 2c32 290a 2020 2020 2020 2020  e (n,2).        
-000038d0: 2020 2020 2020 2020 6120 616e 6420 6220          a and b 
-000038e0: 4d69 6c6c 6572 2069 6e64 6963 6573 2063  Miller indices c
-000038f0: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
-00003900: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00003910: 2020 2020 6469 736b 2070 6f73 6974 696f      disk positio
-00003920: 6e73 0a20 2020 206e 616e 5f63 7574 6f66  ns.    nan_cutof
-00003930: 663a 2066 6c6f 6174 2c20 6f70 7469 6f6e  f: float, option
-00003940: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00003950: 2020 204f 7074 696f 6e61 6c20 7061 7261     Optional para
-00003960: 6d65 7465 7220 7468 6174 2069 7320 7573  meter that is us
-00003970: 6564 2066 6f72 2074 6872 6573 686f 6c64  ed for threshold
-00003980: 696e 6720 6469 736b 0a20 2020 2020 2020  ing disk.       
-00003990: 2020 2020 2020 2020 2066 6974 732e 2049           fits. I
-000039a0: 6620 7468 6520 696e 7465 6e73 6974 7920  f the intensity 
-000039b0: 7261 7469 6f20 6973 2062 656c 6f77 2074  ratio is below t
-000039c0: 6865 2074 6872 6573 686f 6c64 0a20 2020  he threshold.   
-000039d0: 2020 2020 2020 2020 2020 2020 2074 6865               the
-000039e0: 2070 6f73 6974 696f 6e20 7769 6c6c 206e   position will n
-000039f0: 6f74 2062 6520 6669 742e 2044 6566 6175  ot be fit. Defau
-00003a00: 6c74 2076 616c 7565 2069 7320 300a 0a20  lt value is 0.. 
-00003a10: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00003a20: 2d2d 2d2d 2d2d 0a20 2020 2066 6974 7465  ------.    fitte
-00003a30: 645f 6469 736b 5f6c 6973 743a 206e 6461  d_disk_list: nda
-00003a40: 7272 6179 206f 6620 7368 6170 6520 286e  rray of shape (n
-00003a50: 2c32 290a 2020 2020 2020 2020 2020 2020  ,2).            
-00003a60: 2020 2020 2020 2020 2020 5375 622d 7069            Sub-pi
-00003a70: 7865 6c20 7072 6563 6973 696f 6e20 4761  xel precision Ga
-00003a80: 7573 7369 616e 2066 6974 7465 6420 6469  ussian fitted di
-00003a90: 736b 0a20 2020 2020 2020 2020 2020 2020  sk.             
-00003aa0: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
-00003ab0: 6e73 2e20 4966 206e 616e 5f63 7574 6f66  ns. If nan_cutof
-00003ac0: 6620 6973 2067 7265 6174 6572 2074 6861  f is greater tha
-00003ad0: 6e20 7a65 726f 2c20 7468 656e 0a20 2020  n zero, then.   
-00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003af0: 2020 206f 6e6c 7920 7468 6520 706f 7369     only the posi
-00003b00: 7469 6f6e 7320 7468 6174 2061 7265 2067  tions that are g
-00003b10: 7265 6174 6572 2074 6861 6e20 7468 6520  reater than the 
-00003b20: 7468 7265 7368 6f6c 640a 2020 2020 2020  threshold.      
-00003b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b40: 6172 6520 7265 7475 726e 6564 2e0a 2020  are returned..  
-00003b50: 2020 6365 6e74 6572 5f70 6f73 6974 696f    center_positio
-00003b60: 6e3a 2020 6e64 6172 7261 7920 6f66 2073  n:  ndarray of s
-00003b70: 6861 7065 2028 312c 3229 0a20 2020 2020  hape (1,2).     
-00003b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b90: 204c 6f63 6174 696f 6e20 6f66 2074 6865   Location of the
-00003ba0: 2063 656e 7472 616c 2028 302c 3029 2064   central (0,0) d
-00003bb0: 6973 6b0a 2020 2020 6669 745f 6465 7669  isk.    fit_devi
-00003bc0: 6174 696f 6e3a 2020 2020 6e64 6172 7261  ation:    ndarra
-00003bd0: 7920 6f66 2073 6861 7065 2028 312c 3229  y of shape (1,2)
+00000100: 8400 5a2d 640c 640d 8400 5a2e 640e 640f  ..Z-d.d...Z.d.d.
+00000110: 8400 5a2f 6410 6411 8400 5a30 645a 6413  ..Z/d.d...Z0dZd.
+00000120: 6414 8401 5a31 645b 6416 6417 8401 5a32  d...Z1d[d.d...Z2
+00000130: 6418 6419 8400 5a33 645c 641b 641c 8401  d.d...Z3d\d.d...
+00000140: 5a34 091e 645d 641f 6420 8401 5a35 6421  Z4..d]d.d ..Z5d!
+00000150: 6422 8400 5a36 6459 6423 6424 8401 5a37  d"..Z6dYd#d$..Z7
+00000160: 0900 0925 0926 0927 0928 645e 6429 642a  ...%.&.'.(d^d)d*
+00000170: 8401 5a38 0925 645f 642b 642c 8401 5a39  ..Z8.%d_d+d,..Z9
+00000180: 6459 642d 642e 8401 5a3a 642f 6430 8400  dYd-d...Z:d/d0..
+00000190: 5a3b 6460 6432 6433 8401 5a3c 6461 6435  Z;d`d2d3..Z<dad5
+000001a0: 6436 8401 5a3d 6437 6438 8400 5a3e 6462  d6..Z=d7d8..Z>db
+000001b0: 643a 643b 8401 5a3f 6463 643d 643e 8401  d:d;..Z?dcd=d>..
+000001c0: 5a40 6464 6440 6441 8401 5a41 6442 6443  Z@ddd@dA..ZAdBdC
+000001d0: 8400 5a42 6400 6400 6501 6a43 6400 6400  ..ZBd.d.e.jCd.d.
+000001e0: 6434 6426 6444 6415 6427 6415 660b 6445  d4d&dDd.d'd.f.dE
+000001f0: 6446 8401 5a44 6447 6448 8400 5a45 0931  dF..ZDdGdH..ZE.1
+00000200: 6465 644a 644b 8401 5a46 6466 644d 644e  dedJdK..ZFdfdMdN
+00000210: 8401 5a47 644f 6450 8400 5a48 0952 6467  ..ZGdOdP..ZH.Rdg
+00000220: 6453 6454 8401 5a49 6468 6457 6458 8401  dSdT..ZIdhdWdX..
+00000230: 5a4a 6401 5300 2969 e900 0000 004e 6302  ZJd.S.)i.....Nc.
+00000240: 0000 0000 0000 0000 0000 0006 0000 0004  ................
+00000250: 0000 0003 0000 0073 2a00 0000 7c01 6601  .......s*...|.f.
+00000260: 8700 6601 6401 6402 8409 7d02 6403 7d03  ..f.d.d...}.d.}.
+00000270: 7400 a001 7c02 7c03 a102 7d04 7c04 6a02  t...|.|...}.|.j.
+00000280: 7d05 7c05 5300 2904 612e 0200 000a 2020  }.|.S.).a.....  
+00000290: 2020 416e 676c 6520 4669 6e64 6572 0a0a    Angle Finder..
+000002a0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000002b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000002c0: 2020 696d 6167 655f 6f72 6967 3a20 2832    image_orig: (2
+000002d0: 2c32 2920 7368 6170 6520 6e64 6172 7261  ,2) shape ndarra
+000002e0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+000002f0: 2020 496e 7075 7420 496d 6167 650a 2020    Input Image.  
+00000300: 2020 6178 6973 3a20 2020 2020 2020 696e    axis:       in
+00000310: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00000320: 2020 2020 2020 2020 2020 2020 4178 6973              Axis
+00000330: 2061 6c6f 6e67 2077 6869 6368 2074 6f20   along which to 
+00000340: 7065 7266 6f72 6d20 7375 6d0a 0a20 2020  perform sum..   
+00000350: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00000360: 2d2d 2d2d 0a20 2020 206d 696e 5f78 3a20  ----.    min_x: 
+00000370: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+00000380: 2041 6e67 6c65 2062 7920 7768 6963 6820   Angle by which 
+00000390: 6966 2074 6865 2069 6d61 6765 2069 7320  if the image is 
+000003a0: 726f 7461 7465 640a 2020 2020 2020 2020  rotated.        
+000003b0: 2020 2062 792c 2074 6865 2073 756d 206f     by, the sum o
+000003c0: 6620 7468 6520 696d 6167 6520 616c 6f6e  f the image alon
+000003d0: 6720 7468 6520 6178 6973 0a20 2020 2020  g the axis.     
+000003e0: 2020 2020 2020 7370 6563 6966 6965 6420        specified 
+000003f0: 6973 206d 6178 696d 756d 0a0a 2020 2020  is maximum..    
+00000400: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+00000410: 2020 2020 5573 6573 2061 6e20 696e 7465      Uses an inte
+00000420: 726e 616c 2060 616e 676c 655f 6675 6e60  rnal `angle_fun`
+00000430: 2074 6f20 7375 6d20 7468 6520 696e 7465   to sum the inte
+00000440: 6e73 6974 7920 616c 6f6e 670a 2020 2020  nsity along.    
+00000450: 6120 7061 7274 6963 756c 6172 2061 7869  a particular axi
+00000460: 732e 2054 6869 7320 7769 6c6c 2067 6976  s. This will giv
+00000470: 6520 7468 6520 616e 676c 6520 6174 2077  e the angle at w
+00000480: 6869 6368 2074 6861 740a 2020 2020 7375  hich that.    su
+00000490: 6d20 6973 2068 6967 6865 7374 2061 6c6f  m is highest alo
+000004a0: 6e67 2074 6865 2061 7869 7320 7370 6563  ng the axis spec
+000004b0: 6966 6965 642e 0a20 2020 2063 0200 0000  ified..    c....
+000004c0: 0000 0000 0000 0000 0500 0000 0600 0000  ................
+000004d0: 1300 0000 7330 0000 0074 006a 0188 007c  ....s0...t.j...|
+000004e0: 0064 0164 0264 038d 047d 0264 0474 02a0  .d.d.d...}.d.t..
+000004f0: 037c 027c 01a1 0214 007d 0374 02a0 047c  .|.|.....}.t...|
+00000500: 03a1 017d 047c 0453 0029 054e e905 0000  ...}.|.S.).N....
+00000510: 0046 a902 da05 6f72 6465 72da 0772 6573  .F....order..res
+00000520: 6861 7065 e9ff ffff ff29 05da 0473 636e  hape.....)...scn
+00000530: 64da 0672 6f74 6174 65da 026e 70da 0373  d..rotate..np..s
+00000540: 756d da04 616d 696e 2905 5a05 616e 676c  um..amin).Z.angl
+00000550: 65da 0461 7869 735a 0d72 6f74 6174 6564  e..axisZ.rotated
+00000560: 5f69 6d61 6765 5a06 726f 7473 756d 5a06  _imageZ.rotsumZ.
+00000570: 726f 746d 696e a901 da0a 696d 6167 655f  rotmin....image_
+00000580: 6f72 6967 a900 fa39 6275 696c 642f 6264  orig...9build/bd
+00000590: 6973 742e 6c69 6e75 782d 7838 365f 3634  ist.linux-x86_64
+000005a0: 2f65 6767 2f73 7465 6d74 6f6f 6c2f 6e62  /egg/stemtool/nb
+000005b0: 6564 2f6e 6265 645f 7374 7261 696e 2e70  ed/nbed_strain.p
+000005c0: 79da 0961 6e67 6c65 5f66 756e 2c00 0000  y..angle_fun,...
+000005d0: 7308 0000 0012 0110 010a 0104 017a 2272  s............z"r
+000005e0: 6f74 6174 696f 6e5f 6669 6e64 6572 2e3c  otation_finder.<
+000005f0: 6c6f 6361 6c73 3e2e 616e 676c 655f 6675  locals>.angle_fu
+00000600: 6ee9 5a00 0000 2903 da03 7369 6f5a 086d  n.Z...)...sioZ.m
+00000610: 696e 696d 697a 65da 0178 2906 720e 0000  inimize..x).r...
+00000620: 0072 0c00 0000 7211 0000 005a 0278 3072  .r....r....Z.x0r
+00000630: 1400 0000 5a05 6d69 6e5f 7872 0f00 0000  ....Z.min_xr....
+00000640: 720d 0000 0072 1000 0000 da0f 726f 7461  r....r......rota
+00000650: 7469 6f6e 5f66 696e 6465 7213 0000 0073  tion_finder....s
+00000660: 0a00 0000 1019 0406 0c01 0601 0401 7215  ..............r.
+00000670: 0000 0063 0400 0000 0000 0000 0000 0000  ...c............
+00000680: 0a00 0000 0b00 0000 4300 0000 73a2 0000  ........C...s...
+00000690: 0074 00a0 0174 00a0 027c 00a1 01a1 017d  .t...t...|.....}
+000006a0: 0474 00a0 037c 00a1 017d 0574 047c 006a  .t...|...}.t.|.j
+000006b0: 0264 0119 0083 0144 005d 3a7d 067c 007c  .d.....D.]:}.|.|
+000006c0: 0664 0264 0285 0264 0264 0285 0266 0319  .d.d...d.d...f..
+000006d0: 007d 0774 00a0 0574 066a 07a0 087c 077c  .}.t...t.j...|.|
+000006e0: 020b 0064 037c 0464 0419 0014 0017 007c  ...d.|.d.......|
+000006f0: 030b 0064 037c 0464 0519 0014 0017 00a1  ...d.|.d........
+00000700: 03a1 017d 0874 096a 0a7c 087c 0164 0664  ...}.t.j.|.|.d.d
+00000710: 0764 088d 047d 097c 097c 057c 0664 0264  .d...}.|.|.|.d.d
+00000720: 0285 0264 0264 0285 0266 033c 0071 147c  ...d.d...f.<.q.|
+00000730: 0553 0029 0961 4403 0000 0a20 2020 2052  .S.).aD....    R
+00000740: 6f74 6174 696f 6e20 436f 7272 6563 746f  otation Correcto
+00000750: 720a 0a20 2020 2050 6172 616d 6574 6572  r..    Parameter
+00000760: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00000770: 0a20 2020 2064 6174 6134 445f 524f 493a  .    data4D_ROI:
+00000780: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00000790: 2020 2020 2020 2020 2052 6567 696f 6e20           Region 
+000007a0: 6f66 2069 6e74 6572 6573 7420 6f66 2074  of interest of t
+000007b0: 6865 2034 442d 5354 454d 2064 6174 6173  he 4D-STEM datas
+000007c0: 6574 2069 6e0a 2020 2020 2020 2020 2020  et in.          
+000007d0: 2020 2020 2020 7468 6520 666f 726d 206f        the form o
+000007e0: 6620 524f 4920 7069 7865 6c73 2028 7363  f ROI pixels (sc
+000007f0: 616e 6e69 6e67 292c 2043 4245 445f 592c  anning), CBED_Y,
+00000800: 2043 4245 445f 780a 2020 2020 726f 7461   CBED_x.    rota
+00000810: 6e67 6c65 3a20 2020 666c 6f61 740a 2020  ngle:   float.  
+00000820: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00000830: 676c 6520 696e 2063 6f75 6e74 6572 2d63  gle in counter-c
+00000840: 6c6f 636b 7769 7365 2064 6972 6563 7469  lockwise directi
+00000850: 6f6e 2074 6f0a 2020 2020 2020 2020 2020  on to.          
+00000860: 2020 2020 2020 726f 7461 7465 2069 6e64        rotate ind
+00000870: 6976 6964 7561 6c20 4342 4544 2070 6174  ividual CBED pat
+00000880: 7465 726e 730a 2020 2020 7863 656e 7465  terns.    xcente
+00000890: 723a 2020 2020 666c 6f61 740a 2020 2020  r:    float.    
+000008a0: 2020 2020 2020 2020 2020 2020 5820 7069              X pi
+000008b0: 7865 6c20 636f 2d6f 7264 696e 6174 6520  xel co-ordinate 
+000008c0: 6f66 2063 656e 7465 7220 6f66 206d 6561  of center of mea
+000008d0: 6e20 7061 7474 6572 6e0a 2020 2020 7963  n pattern.    yc
+000008e0: 656e 7465 723a 2020 2020 666c 6f61 740a  enter:    float.
+000008f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000900: 5920 7069 7865 6c20 636f 2d6f 7264 696e  Y pixel co-ordin
+00000910: 6174 6520 6f66 2063 656e 7465 7220 6f66  ate of center of
+00000920: 206d 6561 6e20 7061 7474 6572 6e0a 0a20   mean pattern.. 
+00000930: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00000940: 2d2d 2d2d 2d2d 0a20 2020 2063 6f72 7265  ------.    corre
+00000950: 6374 6564 5f52 4f49 3a20 6e64 6172 7261  cted_ROI: ndarra
+00000960: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00000970: 2020 2020 2045 6163 6820 4342 4544 2070       Each CBED p
+00000980: 6174 7465 726e 2066 726f 6d20 7468 6520  attern from the 
+00000990: 7265 6769 6f6e 206f 6620 696e 7465 7265  region of intere
+000009a0: 7374 0a20 2020 2020 2020 2020 2020 2020  st.             
+000009b0: 2020 2020 2020 6669 7273 7420 6365 6e74        first cent
+000009c0: 6572 6564 2061 6e64 2074 6865 6e20 726f  ered and then ro
+000009d0: 7461 7465 6420 616c 6f6e 6720 7468 6520  tated along the 
+000009e0: 6365 6e74 6572 0a0a 2020 2020 4e6f 7465  center..    Note
+000009f0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+00000a00: 5765 2073 7461 7274 2062 7920 6365 6e74  We start by cent
+00000a10: 6572 696e 6720 6561 6368 2034 442d 5354  ering each 4D-ST
+00000a20: 454d 2043 4245 4420 7061 7474 6572 6e0a  EM CBED pattern.
+00000a30: 2020 2020 616e 6420 7468 656e 2072 6f74      and then rot
+00000a40: 6174 696e 6720 7468 6520 7061 7474 6572  ating the patter
+00000a50: 6e73 2077 6974 6820 7265 7370 6563 7420  ns with respect 
+00000a60: 746f 2074 6865 0a20 2020 2070 6174 7465  to the.    patte
+00000a70: 726e 2063 656e 7465 720a 2020 2020 7201  rn center.    r.
+00000a80: 0000 004e e700 0000 0000 00e0 3f72 0600  ...N........?r..
+00000a90: 0000 e9fe ffff ff72 0200 0000 4672 0300  .......r....Fr..
+00000aa0: 0000 290b 7209 0000 00da 0761 7361 7272  ..).r......asarr
+00000ab0: 6179 da05 7368 6170 65da 0a7a 6572 6f73  ay..shape..zeros
+00000ac0: 5f6c 696b 65da 0572 616e 6765 da03 6162  _like..range..ab
+00000ad0: 73da 0273 74da 0475 7469 6c5a 0d6d 6f76  s..st..utilZ.mov
+00000ae0: 655f 6279 5f70 6861 7365 7207 0000 0072  e_by_phaser....r
+00000af0: 0800 0000 290a da0a 6461 7461 3444 5f52  ....)...data4D_R
+00000b00: 4f49 da08 726f 7461 6e67 6c65 5a07 7863  OI..rotangleZ.xc
+00000b10: 656e 7465 725a 0779 6365 6e74 6572 da09  enterZ.ycenter..
+00000b20: 6461 7461 5f73 697a 655a 0d63 6f72 7265  data_sizeZ.corre
+00000b30: 6374 6564 5f52 4f49 da02 6969 5a0c 6362  cted_ROI..iiZ.cb
+00000b40: 6564 5f70 6174 7465 726e 5a0a 6d6f 7665  ed_patternZ.move
+00000b50: 645f 6362 6564 5a0c 726f 7461 7465 645f  d_cbedZ.rotated_
+00000b60: 6362 6564 720f 0000 0072 0f00 0000 7210  cbedr....r....r.
+00000b70: 0000 00da 1572 6f74 6174 655f 616e 645f  .....rotate_and_
+00000b80: 6365 6e74 6572 5f52 4f49 3800 0000 731c  center_ROI8...s.
+00000b90: 0000 0010 1d0a 0112 0116 0104 0106 0102  ................
+00000ba0: 0110 0110 0102 fd04 ff12 0718 0104 0172  ...............r
+00000bb0: 2300 0000 6301 0000 0000 0000 0000 0000  #...c...........
+00000bc0: 0003 0000 0004 0000 0043 0000 0073 3800  .........C...s8.
+00000bd0: 0000 7400 a001 7c00 6401 a102 7d01 7c01  ..t...|.d...}.|.
+00000be0: 6a02 7d02 7c02 6402 1900 7c02 6403 1900  j.}.|.d...|.d...
+00000bf0: 1400 7c02 6404 1900 7c02 6405 1900 1400  ..|.d...|.d.....
+00000c00: 6602 7c01 5f02 7c01 5300 2906 61aa 0100  f.|._.|.S.).a...
+00000c10: 000a 2020 2020 436f 6e76 6572 7420 3444  ..    Convert 4D
+00000c20: 2064 6174 6120 746f 2032 4420 6461 7461   data to 2D data
+00000c30: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00000c40: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00000c50: 2020 2020 6461 7461 3444 3a20 6e64 6172      data4D: ndar
+00000c60: 7261 7920 6f66 2073 6861 7065 2028 342c  ray of shape (4,
+00000c70: 3429 0a20 2020 2020 2020 2020 2020 2074  4).            t
+00000c80: 6865 2066 6972 7374 2074 776f 2064 696d  he first two dim
+00000c90: 656e 7369 6f6e 7320 6172 6520 466f 7572  ensions are Four
+00000ca0: 6965 720a 2020 2020 2020 2020 2020 2020  ier.            
+00000cb0: 7370 6163 652c 2077 6869 6c65 2074 6865  space, while the
+00000cc0: 206e 6578 7420 7477 6f20 6469 6d65 6e73   next two dimens
+00000cd0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+00000ce0: 2061 7265 2072 6561 6c20 7370 6163 650a   are real space.
+00000cf0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+00000d00: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6174   -------.    dat
+00000d10: 6132 443a 206e 6461 7272 6179 206f 6620  a2D: ndarray of 
+00000d20: 7368 6170 6520 2832 2c32 290a 2020 2020  shape (2,2).    
+00000d30: 2020 2020 2020 2020 5261 7665 6c65 6420          Raveled 
+00000d40: 3244 2064 6174 6120 7768 6572 6520 7468  2D data where th
+00000d50: 650a 2020 2020 2020 2020 2020 2020 6669  e.            fi
+00000d60: 7273 7420 7477 6f20 6469 6d65 6e73 696f  rst two dimensio
+00000d70: 6e73 2061 7265 2070 6f73 6974 696f 6e73  ns are positions
+00000d80: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
+00000d90: 6c65 2074 6865 206e 6578 7420 7477 6f20  le the next two 
+00000da0: 6469 6d65 6e73 696f 6e73 2061 7265 2073  dimensions are s
+00000db0: 7065 6374 7261 0a20 2020 20a9 04e9 0200  pectra.    .....
+00000dc0: 0000 e903 0000 0072 0100 0000 e901 0000  .......r........
+00000dd0: 0072 0100 0000 7227 0000 0072 2500 0000  .r....r'...r%...
+00000de0: 7226 0000 0029 0372 0900 0000 da09 7472  r&...).r......tr
+00000df0: 616e 7370 6f73 6572 1900 0000 2903 da06  ansposer....)...
+00000e00: 6461 7461 3444 da06 6461 7461 3244 da0a  data4D..data2D..
+00000e10: 6461 7461 5f73 6861 7065 720f 0000 0072  data_shaper....r
+00000e20: 0f00 0000 7210 0000 00da 0a64 6174 6134  ....r......data4
+00000e30: 4474 6f32 4465 0000 0073 0800 0000 0c12  Dto2De...s......
+00000e40: 0601 2201 0401 722c 0000 0063 0300 0000  .."...r,...c....
+00000e50: 0000 0000 0000 0000 0800 0000 0500 0000  ................
+00000e60: 4300 0000 739c 0000 007c 006a 007d 0364  C...s....|.j.}.d
+00000e70: 017d 0464 017d 0574 0174 027c 0283 0183  .}.d.}.t.t.|....
+00000e80: 0144 005d 3e7d 067c 047d 077c 057c 0214  .D.]>}.|.}.|.|..
+00000e90: 007c 067c 0314 0018 007c 036b 0072 2f7c  .|.|.....|.k.r/|
+00000ea0: 077c 007c 0519 0037 007d 077c 0564 0237  .|.|...7.}.|.d.7
+00000eb0: 007d 057c 057c 0214 007c 067c 0314 0018  .}.|.|...|.|....
+00000ec0: 007c 036b 0073 1b7c 057c 0664 0217 007c  .|.k.s.|.|.d...|
+00000ed0: 037c 021b 0014 0018 007c 007c 0564 0218  .|.......|.|.d..
+00000ee0: 0019 0014 007d 047c 077c 0438 007d 077c  .....}.|.|.8.}.|
+00000ef0: 077c 027c 031b 0014 007c 017c 063c 0071  .|.|.....|.|.<.q
+00000f00: 0d7c 0153 00a9 034e 7201 0000 0072 2700  .|.S...Nr....r'.
+00000f10: 0000 2903 da04 7369 7a65 721b 0000 00da  ..)...sizer.....
+00000f20: 0369 6e74 2908 da04 6461 7461 da03 7265  .int)...data..re
+00000f30: 73da 014e da01 4dda 0563 6172 7279 da01  s..N..M..carry..
+00000f40: 6dda 016e da08 6461 7461 5f73 756d 720f  m..n..data_sumr.
+00000f50: 0000 0072 0f00 0000 7210 0000 00da 0d72  ...r....r......r
+00000f60: 6573 697a 6572 3144 5f6f 7074 7d00 0000  esizer1D_opt}...
+00000f70: 731a 0000 0006 0104 0104 0110 0104 0114  s...............
+00000f80: 010c 0108 0114 fe20 0308 0112 0104 0172  ....... .......r
+00000f90: 3800 0000 6304 0000 0000 0000 0000 0000  8...c...........
+00000fa0: 0008 0000 0007 0000 0043 0000 0073 b000  .........C...s..
+00000fb0: 0000 7400 a001 7c00 6a02 a101 7d04 7400  ..t...|.j...}.t.
+00000fc0: a003 7c04 7c03 1b00 a101 a004 7405 a101  ..|.|.......t...
+00000fd0: 7d05 7406 7c04 6401 1900 8301 4400 5d1c  }.t.|.d.....D.].
+00000fe0: 7d06 7407 7c00 7c06 6400 6400 8502 6602  }.t.|.|.d.d...f.
+00000ff0: 1900 7c01 7c06 6400 6400 8502 6602 1900  ..|.|.d.d...f...
+00001000: 7c05 6402 1900 8303 7c01 7c06 6400 6400  |.d.....|.|.d.d.
+00001010: 8502 6602 3c00 7116 7406 7c05 6402 1900  ..f.<.q.t.|.d...
+00001020: 8301 4400 5d1c 7d07 7407 7c01 6400 6400  ..D.].}.t.|.d.d.
+00001030: 8502 7c07 6602 1900 7c02 6400 6400 8502  ..|.f...|.d.d...
+00001040: 7c07 6602 1900 7c05 6401 1900 8303 7c02  |.f...|.d.....|.
+00001050: 6400 6400 8502 7c07 6602 3c00 7139 7c02  d.d...|.f.<.q9|.
+00001060: 5300 722d 0000 0029 0872 0900 0000 7218  S.r-...).r....r.
+00001070: 0000 0072 1900 0000 da05 726f 756e 64da  ...r......round.
+00001080: 0661 7374 7970 6572 2f00 0000 721b 0000  .astyper/...r...
+00001090: 0072 3800 0000 2908 722a 0000 00da 0b72  .r8...).r*.....r
+000010a0: 6573 616d 706c 6564 5f78 da0b 7265 7361  esampled_x..resa
+000010b0: 6d70 6c65 645f 66da 0873 616d 706c 696e  mpled_f..samplin
+000010c0: 6772 2b00 0000 5a0d 7361 6d70 6c65 645f  gr+...Z.sampled_
+000010d0: 7368 6170 65da 0279 79da 0278 7872 0f00  shape..yy..xxr..
+000010e0: 0000 720f 0000 0072 1000 0000 da0d 7265  ..r....r......re
+000010f0: 7369 7a65 7232 445f 6f70 748c 0000 0073  sizer2D_opt....s
+00001100: 1600 0000 0c01 1401 1001 0201 2201 12ff  ............"...
+00001110: 1003 0201 2201 12ff 0403 7240 0000 0063  ....".....r@...c
+00001120: 0200 0000 0000 0000 0000 0000 0800 0000  ................
+00001130: 0500 0000 4300 0000 73aa 0000 007c 006a  ....C...s....|.j
+00001140: 007d 0264 017d 0364 017d 0474 01a0 0274  .}.d.}.d.}.t...t
+00001150: 037c 0183 01a1 017d 0574 0474 037c 0183  .|.....}.t.t.|..
+00001160: 0183 0144 005d 3e7d 067c 037d 077c 047c  ...D.]>}.|.}.|.|
+00001170: 0114 007c 067c 0214 0018 007c 026b 0072  ...|.|.....|.k.r
+00001180: 367c 077c 007c 0419 0037 007d 077c 0464  6|.|.|...7.}.|.d
+00001190: 0237 007d 047c 047c 0114 007c 067c 0214  .7.}.|.|...|.|..
+000011a0: 0018 007c 026b 0073 227c 047c 0664 0217  ...|.k.s"|.|.d..
+000011b0: 007c 027c 011b 0014 0018 007c 007c 0464  .|.|.......|.|.d
+000011c0: 0218 0019 0014 007d 037c 077c 0338 007d  .......}.|.|.8.}
+000011d0: 077c 077c 017c 021b 0014 007c 057c 063c  .|.|.|.....|.|.<
+000011e0: 0071 147c 0553 0072 2d00 0000 2905 722e  .q.|.S.r-...).r.
+000011f0: 0000 0072 0900 0000 da05 7a65 726f 7372  ...r......zerosr
+00001200: 2f00 0000 721b 0000 0029 0872 3000 0000  /...r....).r0...
+00001210: 7232 0000 0072 3300 0000 7234 0000 0072  r2...r3...r4...r
+00001220: 3500 0000 7231 0000 0072 3600 0000 7237  5...r1...r6...r7
+00001230: 0000 0072 0f00 0000 720f 0000 0072 1000  ...r....r....r..
+00001240: 0000 da09 7265 7369 7a65 7231 449a 0000  ....resizer1D...
+00001250: 0073 1c00 0000 0601 0401 0401 0e01 1001  .s..............
+00001260: 0401 1401 0c01 0801 14fe 2003 0801 1201  .......... .....
+00001270: 0401 7242 0000 0063 0200 0000 0000 0000  ..rB...c........
+00001280: 0000 0000 1100 0000 0700 0000 4300 0000  ............C...
+00001290: 736c 0100 0074 00a0 017c 01a1 017d 0174  sl...t...|...}.t
+000012a0: 027c 0183 0164 016b 0072 1674 00a0 017c  .|...d.k.r.t...|
+000012b0: 0164 0219 007c 0164 0219 0066 02a1 017d  .d...|.d...f...}
+000012c0: 0174 03a0 04a1 007d 0274 03a0 057c 02a1  .t.....}.t...|..
+000012d0: 017d 037c 036a 067c 0064 0364 048d 027d  .}.|.j.|.d.d...}
+000012e0: 0474 07a0 087c 047c 006a 097c 006a 0aa1  .t...|.|.j.|.j..
+000012f0: 037d 0574 00a0 017c 006a 09a1 017d 067c  .}.t...|.j...}.|
+00001300: 067c 011b 00a0 0b74 0ca1 017d 0767 007d  .|.....t...}.g.}
+00001310: 0867 007d 0974 0d7c 0664 0519 0083 0144  .g.}.t.|.d.....D
+00001320: 005d 257d 0a74 0ea0 0f74 106a 116a 12a1  .]%}.t...t.j.j..
+00001330: 017c 0564 0064 0085 027c 0a66 0219 007c  .|.d.d...|.f...|
+00001340: 0764 0219 0083 027d 0b74 07a0 087c 0b64  .d.....}.t...|.d
+00001350: 057c 0764 0219 0066 027c 006a 0aa1 037d  .|.d...f.|.j...}
+00001360: 0c7c 08a0 137c 0ca1 0101 0071 4674 076a  .|...|.....qFt.j
+00001370: 147c 0864 0264 068d 027d 0874 07a0 157c  .|.d.d...}.t...|
+00001380: 0864 07a1 027d 0874 0d7c 0764 0219 0083  .d...}.t.|.d....
+00001390: 0144 005d 257d 0d74 0ea0 0f74 106a 116a  .D.]%}.t...t.j.j
+000013a0: 12a1 017c 087c 0d64 0064 0085 0266 0219  ...|.|.d.d...f..
+000013b0: 007c 0764 0519 0083 027d 0e74 07a0 087c  .|.d.....}.t...|
+000013c0: 0e64 057c 0764 0519 0066 027c 006a 0aa1  .d.|.d...f.|.j..
+000013d0: 037d 0f7c 09a0 137c 0fa1 0101 0071 7f74  .}.|...|.....q.t
+000013e0: 076a 147c 0964 0264 068d 027d 097c 09a0  .j.|.d.d...}.|..
+000013f0: 16a1 007d 107c 02a0 17a1 0001 007c 1053  ...}.|.......|.S
+00001400: 0029 084e 7225 0000 0072 0100 0000 54a9  .).Nr%...r....T.
+00001410: 015a 0962 726f 6164 6361 7374 7227 0000  .Z.broadcastr'..
+00001420: 00a9 0172 0c00 0000 a902 7227 0000 0072  ...r......r'...r
+00001430: 0100 0000 2918 7209 0000 0072 1800 0000  ....).r....r....
+00001440: da03 6c65 6eda 0264 64da 0c4c 6f63 616c  ..len..dd..Local
+00001450: 436c 7573 7465 72da 0643 6c69 656e 74da  Cluster..Client.
+00001460: 0773 6361 7474 6572 da02 6461 da0c 6672  .scatter..da..fr
+00001470: 6f6d 5f64 656c 6179 6564 7219 0000 00da  om_delayedr.....
+00001480: 0564 7479 7065 723a 0000 0072 2f00 0000  .dtyper:...r/...
+00001490: 721b 0000 00da 0464 6173 6bda 0764 656c  r......dask..del
+000014a0: 6179 6564 721d 0000 00da 046e 6265 6472  ayedr......nbedr
+000014b0: 4200 0000 da06 6170 7065 6e64 da0b 636f  B.....append..co
+000014c0: 6e63 6174 656e 6174 6572 2800 0000 da07  ncatenater(.....
+000014d0: 636f 6d70 7574 65da 0563 6c6f 7365 2911  compute..close).
+000014e0: 722a 0000 0072 3d00 0000 da07 636c 7573  r*...r=.....clus
+000014f0: 7465 72da 0663 6c69 656e 745a 0b64 6174  ter..clientZ.dat
+00001500: 6132 445f 7363 6174 5a0b 6461 7461 3244  a2D_scatZ.data2D
+00001510: 5f64 6173 6b72 2b00 0000 da09 7265 735f  _daskr+.....res_
+00001520: 7368 6170 65da 0b72 6573 616d 706c 6564  shape..resampled
+00001530: 5f59 da0b 7265 7361 6d70 6c65 6458 5972  _Y..resampledXYr
+00001540: 3f00 0000 da06 696e 7465 7259 da09 696e  ?.....interY..in
+00001550: 7465 7259 6172 7272 3e00 0000 da06 696e  terYarrr>.....in
+00001560: 7465 7258 da09 696e 7465 7258 6172 7272  terX..interXarrr
+00001570: 3c00 0000 720f 0000 0072 0f00 0000 7210  <...r....r....r.
+00001580: 0000 00da 0972 6573 697a 6572 3244 aa00  .....resizer2D..
+00001590: 0000 7332 0000 000a 010c 0116 0108 010a  ..s2............
+000015a0: 010e 0112 010c 010e 0104 0104 0110 0124  ...............$
+000015b0: 0118 010c 010e 010c 0210 0124 0118 010c  ...........$....
+000015c0: 010e 0108 0108 0104 0172 5e00 0000 6302  .........r^...c.
+000015d0: 0000 0000 0000 0000 0000 000a 0000 0008  ................
+000015e0: 0000 0043 0000 0073 2001 0000 7400 a001  ...C...s ...t...
+000015f0: 7c00 7c00 6a02 6401 1900 7c00 6a02 6402  |.|.j.d...|.j.d.
+00001600: 1900 7c00 6a02 6403 1900 7c00 6a02 6404  ..|.j.d...|.j.d.
+00001610: 1900 1400 6603 a102 7d02 7400 a003 7c02  ....f...}.t...|.
+00001620: 6a02 a101 7d03 7400 a004 7c03 a101 7d04  j...}.t...|...}.
+00001630: 7400 a005 7c03 6401 6403 8502 1900 7c01  t...|.d.d.....|.
+00001640: 1b00 a101 7c04 6401 6403 8502 3c00 7400  ....|.d.d...<.t.
+00001650: 6a06 7c04 a007 7408 a101 7c02 6a09 6405  j.|...t...|.j.d.
+00001660: 8d02 7d05 7400 a006 7c03 6401 1900 7c04  ..}.t...|.d...|.
+00001670: 6402 1900 6602 7c02 6a09 a102 7d06 7400  d...f.|.j...}.t.
+00001680: 6a06 7c04 6401 6403 8502 1900 7c02 6a09  j.|.d.d.....|.j.
+00001690: 6405 8d02 7d07 740a 7c02 6a02 6406 1900  d...}.t.|.j.d...
+000016a0: 8301 4400 5d1b 7d08 740b 7c02 6407 6407  ..D.].}.t.|.d.d.
+000016b0: 8502 6407 6407 8502 7c08 6603 1900 7c06  ..d.d...|.f...|.
+000016c0: 7c07 7c01 8304 7c05 6407 6407 8502 6407  |.|...|.d.d...d.
+000016d0: 6407 8502 7c08 6603 3c00 715c 7400 a001  d...|.f.<.q\t...
+000016e0: 7c05 7c07 6a02 6401 1900 7c07 6a02 6402  |.|.j.d...|.j.d.
+000016f0: 1900 7c00 6a02 6403 1900 7c00 6a02 6404  ..|.j.d...|.j.d.
+00001700: 1900 6604 a102 7d09 7c09 5300 2908 61b4  ..f...}.|.S.).a.
+00001710: 0100 000a 2020 2020 4269 6e20 3444 2064  ....    Bin 4D d
+00001720: 6174 6120 696e 2073 7065 6374 7261 6c20  ata in spectral 
+00001730: 6469 6d65 6e73 696f 6e73 0a0a 2020 2020  dimensions..    
+00001740: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+00001750: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6461  ---------.    da
+00001760: 7461 3444 3a20 2020 2020 6e64 6172 7261  ta4D:     ndarra
+00001770: 7920 6f66 2073 6861 7065 2028 342c 3429  y of shape (4,4)
+00001780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001790: 2074 6865 2066 6972 7374 2074 776f 2064   the first two d
+000017a0: 696d 656e 7369 6f6e 7320 6172 6520 466f  imensions are Fo
+000017b0: 7572 6965 720a 2020 2020 2020 2020 2020  urier.          
+000017c0: 2020 2020 2020 7370 6163 652c 2077 6869        space, whi
+000017d0: 6c65 2074 6865 206e 6578 7420 7477 6f20  le the next two 
+000017e0: 6469 6d65 6e73 696f 6e73 0a20 2020 2020  dimensions.     
+000017f0: 2020 2020 2020 2020 2020 2061 7265 2072             are r
+00001800: 6561 6c20 7370 6163 650a 2020 2020 6269  eal space.    bi
+00001810: 6e5f 6661 6374 6f72 3a20 696e 740a 2020  n_factor: int.  
+00001820: 2020 2020 2020 2020 2020 2020 2020 5661                Va
+00001830: 6c75 6520 6279 2077 6869 6368 2074 6f20  lue by which to 
+00001840: 6269 6e20 6461 7461 0a0a 2020 2020 5265  bin data..    Re
+00001850: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00001860: 2d0a 2020 2020 6269 6e6e 6564 5f64 6174  -.    binned_dat
+00001870: 613a 206e 6461 7272 6179 206f 6620 7368  a: ndarray of sh
+00001880: 6170 6520 2834 2c34 290a 2020 2020 2020  ape (4,4).      
+00001890: 2020 2020 2020 2020 2020 2044 6174 6120             Data 
+000018a0: 6269 6e6e 6564 2069 6e20 7468 6520 7370  binned in the sp
+000018b0: 6563 7472 616c 2064 696d 656e 7369 6f6e  ectral dimension
+000018c0: 730a 0a20 2020 2072 0100 0000 7227 0000  s..    r....r'..
+000018d0: 0072 2500 0000 7226 0000 00a9 0172 4d00  .r%...r&.....rM.
+000018e0: 0000 7206 0000 004e 290c 7209 0000 0072  ..r....N).r....r
+000018f0: 0500 0000 7219 0000 0072 1800 0000 da04  ....r....r......
+00001900: 636f 7079 7239 0000 0072 4100 0000 723a  copyr9...rA...r:
+00001910: 0000 0072 2f00 0000 724d 0000 0072 1b00  ...r/...rM...r..
+00001920: 0000 7240 0000 0029 0a72 2900 0000 da0a  ..r@...).r).....
+00001930: 6269 6e5f 6661 6374 6f72 da0b 6461 7461  bin_factor..data
+00001940: 3444 5f66 6c61 74da 0964 6174 6173 6861  4D_flat..datasha
+00001950: 7065 7257 0000 00da 0a64 6174 6134 445f  perW.....data4D_
+00001960: 7265 7372 3b00 0000 723c 0000 00da 027a  resr;...r<.....z
+00001970: 7ada 0b62 696e 6e65 645f 6461 7461 720f  z..binned_datar.
+00001980: 0000 0072 0f00 0000 7210 0000 00da 0562  ...r....r......b
+00001990: 696e 3444 c700 0000 7324 0000 0004 1326  in4D....s$.....&
+000019a0: 0104 ff0c 030a 011e 0116 011a 0118 0112  ................
+000019b0: 0102 011a 0118 ff04 0302 0122 0104 fe04  ..........."....
+000019c0: 0472 6700 0000 e904 0000 0063 0300 0000  .rg........c....
+000019d0: 0000 0000 0000 0000 1600 0000 0800 0000  ................
+000019e0: 4300 0000 73f0 0100 0074 006a 017c 0264  C...s....t.j.|.d
+000019f0: 018d 017d 0374 00a0 027c 03a1 017d 047c  ...}.t...|...}.|
+00001a00: 046a 037c 0064 0264 038d 027d 0574 04a0  .j.|.d.d...}.t..
+00001a10: 057c 057c 006a 067c 006a 07a1 037d 0674  .|.|.j.|.j...}.t
+00001a20: 04a0 087c 067c 006a 0664 0419 007c 006a  ...|.|.j.d...|.j
+00001a30: 0664 0519 007c 006a 0664 0619 007c 006a  .d...|.j.d...|.j
+00001a40: 0664 0719 0014 0066 03a1 027d 0774 09a0  .d.....f...}.t..
+00001a50: 0a7c 076a 06a1 017d 0874 09a0 0b7c 08a1  .|.j...}.t...|..
+00001a60: 017d 097c 0864 0464 0685 0219 007c 011b  .}.|.d.d.....|..
+00001a70: 00a0 0c74 0da1 017c 0964 0464 0685 023c  ...t...|.d.d...<
+00001a80: 0067 007d 0a74 0e7c 0864 0819 0083 0144  .g.}.t.|.d.....D
+00001a90: 005d 787d 0b67 007d 0c67 007d 0d74 0e7c  .]x}.g.}.g.}.t.|
+00001aa0: 0864 0519 0083 0144 005d 267d 0e74 0fa0  .d.....D.]&}.t..
+00001ab0: 1074 116a 126a 13a1 017c 0764 0964 0985  .t.j.j...|.d.d..
+00001ac0: 027c 0e7c 0b66 0319 007c 0964 0419 0083  .|.|.f...|.d....
+00001ad0: 027d 0f74 04a0 057c 0f64 057c 0964 0419  .}.t...|.d.|.d..
+00001ae0: 0066 027c 006a 07a1 037d 107c 0ca0 147c  .f.|.j...}.|...|
+00001af0: 10a1 0101 0071 6074 046a 157c 0c64 0464  .....q`t.j.|.d.d
+00001b00: 0a8d 027d 0c74 04a0 167c 0c64 0ba1 027d  ...}.t...|.d...}
+00001b10: 0c74 0e7c 0964 0419 0083 0144 005d 257d  .t.|.d.....D.]%}
+00001b20: 1174 0fa0 1074 116a 126a 13a1 017c 0c7c  .t...t.j.j...|.|
+00001b30: 1164 0964 0985 0266 0219 007c 0964 0519  .d.d...f...|.d..
+00001b40: 0083 027d 1274 04a0 057c 1264 057c 0964  ...}.t...|.d.|.d
+00001b50: 0519 0066 027c 006a 07a1 037d 137c 0da0  ...f.|.j...}.|..
+00001b60: 147c 13a1 0101 0071 9a74 046a 157c 0d64  .|.....q.t.j.|.d
+00001b70: 0464 0a8d 027d 0d7c 0aa0 147c 0da1 0101  .d...}.|...|....
+00001b80: 0071 5474 046a 177c 0a64 0464 0a8d 027d  .qTt.j.|.d.d...}
+00001b90: 0a74 04a0 167c 0a64 0ca1 027d 0a74 04a0  .t...|.d...}.t..
+00001ba0: 087c 0a7c 0964 0419 007c 0964 0519 007c  .|.|.d...|.d...|
+00001bb0: 006a 0664 0619 007c 006a 0664 0719 0066  .j.d...|.j.d...f
+00001bc0: 04a1 027d 147c 14a0 18a1 007d 157c 03a0  ...}.|.....}.|..
+00001bd0: 19a1 0001 007c 1553 0029 0d61 5902 0000  .....|.S.).aY...
+00001be0: 0a20 2020 2042 696e 2034 4420 6461 7461  .    Bin 4D data
+00001bf0: 2069 6e20 7370 6563 7472 616c 2064 696d   in spectral dim
+00001c00: 656e 7369 6f6e 732c 0a20 2020 2069 6d70  ensions,.    imp
+00001c10: 6c65 6d65 6e74 6564 2069 6e20 6461 736b  lemented in dask
+00001c20: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00001c30: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00001c40: 2020 2020 6461 7461 3444 3a20 2020 2020      data4D:     
+00001c50: 6e64 6172 7261 7920 6f66 2073 6861 7065  ndarray of shape
+00001c60: 2028 342c 3429 0a20 2020 2020 2020 2020   (4,4).         
+00001c70: 2020 2020 2020 2074 6865 2066 6972 7374         the first
+00001c80: 2074 776f 2064 696d 656e 7369 6f6e 7320   two dimensions 
+00001c90: 6172 6520 466f 7572 6965 720a 2020 2020  are Fourier.    
+00001ca0: 2020 2020 2020 2020 2020 2020 7370 6163              spac
+00001cb0: 652c 2077 6869 6c65 2074 6865 206e 6578  e, while the nex
+00001cc0: 7420 7477 6f20 6469 6d65 6e73 696f 6e73  t two dimensions
+00001cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001ce0: 2061 7265 2072 6561 6c20 7370 6163 650a   are real space.
+00001cf0: 2020 2020 6269 6e5f 6661 6374 6f72 3a20      bin_factor: 
+00001d00: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
+00001d10: 2020 2020 5661 6c75 6520 6279 2077 6869      Value by whi
+00001d20: 6368 2074 6f20 6269 6e20 6461 7461 0a20  ch to bin data. 
+00001d30: 2020 2077 6f72 6b65 7273 3a20 2020 2069     workers:    i
+00001d40: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+00001d50: 2020 2020 2020 2020 2020 2020 204e 756d               Num
+00001d60: 6265 7220 6f66 2064 6173 6b20 776f 726b  ber of dask work
+00001d70: 6572 732e 2044 6566 6175 6c74 2069 730a  ers. Default is.
+00001d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d90: 342e 0a0a 2020 2020 5265 7475 726e 730a  4...    Returns.
+00001da0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00001db0: 6269 6e6e 6564 5f64 6174 613a 206e 6461  binned_data: nda
+00001dc0: 7272 6179 206f 6620 7368 6170 6520 2834  rray of shape (4
+00001dd0: 2c34 290a 2020 2020 2020 2020 2020 2020  ,4).            
+00001de0: 2020 2020 2044 6174 6120 6269 6e6e 6564       Data binned
+00001df0: 2069 6e20 7468 6520 7370 6563 7472 616c   in the spectral
+00001e00: 2064 696d 656e 7369 6f6e 730a 0a20 2020   dimensions..   
+00001e10: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
+00001e20: 2d2d 2d2d 2d2d 0a20 2020 2072 6573 697a  ------.    resiz
+00001e30: 6572 3144 0a20 2020 2029 015a 096e 5f77  er1D.    ).Z.n_w
+00001e40: 6f72 6b65 7273 5472 4300 0000 7201 0000  orkersTrC...r...
+00001e50: 0072 2700 0000 7225 0000 0072 2600 0000  .r'...r%...r&...
+00001e60: 7206 0000 004e 7244 0000 0072 4500 0000  r....NrD...rE...
+00001e70: 2903 7227 0000 0072 2500 0000 7201 0000  ).r'...r%...r...
+00001e80: 0029 1a72 4700 0000 7248 0000 0072 4900  .).rG...rH...rI.
+00001e90: 0000 724a 0000 0072 4b00 0000 724c 0000  ..rJ...rK...rL..
+00001ea0: 0072 1900 0000 724d 0000 0072 0500 0000  .r....rM...r....
+00001eb0: 7209 0000 0072 1800 0000 7260 0000 0072  r....r....r`...r
+00001ec0: 3a00 0000 722f 0000 0072 1b00 0000 724e  :...r/...r....rN
+00001ed0: 0000 0072 4f00 0000 721d 0000 0072 5000  ...rO...r....rP.
+00001ee0: 0000 7242 0000 0072 5100 0000 7252 0000  ..rB...rQ...rR..
+00001ef0: 0072 2800 0000 da05 7374 6163 6b72 5300  .r(.....stackrS.
+00001f00: 0000 7254 0000 0029 1672 2900 0000 7261  ..rT...).r)...ra
+00001f10: 0000 005a 0777 6f72 6b65 7273 7255 0000  ...Z.workersrU..
+00001f20: 0072 5600 0000 5a0b 6461 7461 3444 5f73  .rV...Z.data4D_s
+00001f30: 6361 745a 0b64 6174 6134 445f 6461 736b  catZ.data4D_dask
+00001f40: 7262 0000 0072 6300 0000 7257 0000 005a  rb...rc...rW...Z
+00001f50: 0572 6573 3444 7265 0000 0072 5800 0000  .res4Dre...rX...
+00001f60: 7259 0000 0072 3f00 0000 725a 0000 0072  rY...r?...rZ...r
+00001f70: 5b00 0000 723e 0000 0072 5c00 0000 725d  [...r>...r\...r]
+00001f80: 0000 0072 6400 0000 7266 0000 0072 0f00  ...rd...rf...r..
+00001f90: 0000 720f 0000 0072 1000 0000 da0a 6269  ..r....r......bi
+00001fa0: 6e34 445f 6461 736b ee00 0000 734a 0000  n4D_dask....sJ..
+00001fb0: 000c 1a0a 010e 0112 0104 0102 0124 0104  .............$..
+00001fc0: fe0c 040a 011e 0104 0110 0104 0104 0110  ................
+00001fd0: 010c 0116 0104 ff18 030c 010e 010c 0210  ................
+00001fe0: 0124 0118 010c 010e 010c 010e 010c 0104  .$..............
+00001ff0: 0120 0104 ff08 0308 0104 0172 6a00 0000  . .........rj...
+00002000: 5463 0400 0000 0000 0000 0000 0000 0800  Tc..............
+00002010: 0000 0600 0000 4300 0000 73b8 0000 0074  ......C...s....t
+00002020: 00a0 017c 01a1 017d 0174 006a 0264 017c  ...|...}.t.j.d.|
+00002030: 006a 0364 0119 0085 0264 017c 006a 0364  .j.d.....d.|.j.d
+00002040: 0219 0085 0266 0219 005c 027d 047d 057c  .....f...\.}.}.|
+00002050: 047c 0164 0219 0018 007d 047c 057c 0164  .|.d.....}.|.|.d
+00002060: 0119 0018 007d 057c 0464 0313 007c 0564  .....}.|.d...|.d
+00002070: 0313 0017 0064 0413 007d 0674 006a 017c  .....d...}.t.j.|
+00002080: 067c 026b 0174 006a 0464 058d 027d 077c  .|.k.t.j.d...}.|
+00002090: 0372 5a74 056a 0664 0664 078d 0101 0074  .rZt.j.d.d.....t
+000020a0: 056a 0774 086a 09a0 0a7c 00a1 017c 0717  .j.t.j...|...|..
+000020b0: 0064 0864 098d 0201 0074 056a 0b7c 0164  .d.d.....t.j.|.d
+000020c0: 0119 007c 0164 0219 0064 0a64 0b64 0c8d  ...|.d...d.d.d..
+000020d0: 0401 007c 0753 0029 0d61 6703 0000 0a20  ...|.S.).ag.... 
+000020e0: 2020 2054 6573 7420 616e 2061 7065 7274     Test an apert
+000020f0: 7572 6520 706f 7369 7469 6f6e 2066 6f72  ure position for
+00002100: 2056 6972 7475 616c 2044 4620 696d 6167   Virtual DF imag
+00002110: 650a 0a20 2020 2050 6172 616d 6574 6572  e..    Parameter
+00002120: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00002130: 0a20 2020 2070 6174 7465 726e 3a20 6e64  .    pattern: nd
+00002140: 6172 7261 7920 6f66 2073 6861 7065 2028  array of shape (
+00002150: 322c 3229 0a20 2020 2020 2020 2020 2020  2,2).           
+00002160: 2020 4469 6666 7261 6374 696f 6e20 7061    Diffraction pa
+00002170: 7474 6572 6e2c 2070 7265 6665 7261 626c  ttern, preferabl
+00002180: 7920 7468 650a 2020 2020 2020 2020 2020  y the.          
+00002190: 2020 206d 6561 6e20 6469 6666 7261 6374     mean diffract
+000021a0: 696f 6e20 7061 7474 6572 6e20 666f 7220  ion pattern for 
+000021b0: 7465 7374 696e 6720 6f75 740a 2020 2020  testing out.    
+000021c0: 2020 2020 2020 2020 2074 6865 2061 7065           the ape
+000021d0: 7274 7572 6520 6c6f 6361 7469 6f6e 0a20  rture location. 
+000021e0: 2020 2063 656e 7465 723a 2020 6e64 6172     center:  ndar
+000021f0: 7261 7920 6f66 2073 6861 7065 2028 312c  ray of shape (1,
+00002200: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+00002210: 4365 6e74 6572 206f 6620 7468 6520 6369  Center of the ci
+00002220: 7263 756c 6172 2061 7065 7274 7572 650a  rcular aperture.
+00002230: 2020 2020 7261 6469 7573 3a20 2066 6c6f      radius:  flo
+00002240: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+00002250: 5261 6469 7573 206f 6620 7468 6520 6369  Radius of the ci
+00002260: 7263 756c 6172 2061 7065 7274 7572 650a  rcular aperture.
+00002270: 2020 2020 7368 6f77 6669 673a 2062 6f6f      showfig: boo
+00002280: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+00002290: 2020 2020 2020 2020 2049 6620 7368 6f77           If show
+000022a0: 6669 6720 6973 2054 7275 652c 2074 6865  fig is True, the
+000022b0: 6e20 7468 6520 696d 6167 6520 6973 0a20  n the image is. 
+000022c0: 2020 2020 2020 2020 2020 2020 6469 7370              disp
+000022d0: 6c61 7965 6420 7769 7468 2074 6865 2061  layed with the a
+000022e0: 7065 7274 7572 6520 6f76 6572 6c61 6964  perture overlaid
+000022f0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00002300: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6170    -------.    ap
+00002310: 6572 7475 7265 3a20 6e64 6172 7261 7920  erture: ndarray 
+00002320: 6f66 2073 6861 7065 2028 322c 3229 0a20  of shape (2,2). 
+00002330: 2020 2020 2020 2020 2020 2020 2041 206d               A m
+00002340: 6174 7269 7820 6f66 2074 6865 2073 616d  atrix of the sam
+00002350: 6520 7369 7a65 206f 6620 7468 6520 696e  e size of the in
+00002360: 7075 7420 696d 6167 650a 2020 2020 2020  put image.      
+00002370: 2020 2020 2020 2020 7769 7468 207a 6572          with zer
+00002380: 6f73 2065 7665 7279 7768 6572 6520 616e  os everywhere an
+00002390: 6420 6f6e 6573 2077 6865 7265 2074 6865  d ones where the
+000023a0: 2061 7065 7274 7572 650a 2020 2020 2020   aperture.      
+000023b0: 2020 2020 2020 2020 6973 2073 7570 706f          is suppo
+000023c0: 7365 6420 746f 2062 650a 0a20 2020 204e  sed to be..    N
+000023d0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+000023e0: 2020 2055 7365 2074 6865 2073 686f 7766     Use the showf
+000023f0: 6967 206f 7074 696f 6e20 746f 2076 6973  ig option to vis
+00002400: 7561 6c6c 7920 7465 7374 206f 7574 2074  ually test out t
+00002410: 6865 2061 7065 7274 7572 650a 2020 2020  he aperture.    
+00002420: 6c6f 6361 7469 6f6e 2077 6974 6820 7661  location with va
+00002430: 7279 696e 6720 7061 7261 6d65 7465 7273  rying parameters
+00002440: 0a20 2020 2072 0100 0000 7227 0000 0072  .    r....r'...r
+00002450: 2500 0000 7216 0000 0072 5f00 0000 a902  %...r....r_.....
+00002460: e90f 0000 0072 6c00 0000 a901 da07 6669  .....rl.......fi
+00002470: 6773 697a 655a 0853 7065 6374 7261 6ca9  gsizeZ.Spectral.
+00002480: 015a 0463 6d61 70da 0177 e919 0000 0029  .Z.cmap..w.....)
+00002490: 02da 0163 da01 7329 0c72 0900 0000 7218  ...c..s).r....r.
+000024a0: 0000 00da 056d 6772 6964 7219 0000 00da  .....mgridr.....
+000024b0: 0664 6f75 626c 65da 0370 6c74 da06 6669  .double..plt..fi
+000024c0: 6775 7265 da06 696d 7368 6f77 721d 0000  gure..imshowr...
+000024d0: 0072 1e00 0000 da10 696d 6167 655f 6e6f  .r......image_no
+000024e0: 726d 616c 697a 6572 724a 0000 0029 08da  rmalizerrJ...)..
+000024f0: 0770 6174 7465 726e da06 6365 6e74 6572  .pattern..center
+00002500: da06 7261 6469 7573 da07 7368 6f77 6669  ..radius..showfi
+00002510: 6772 3e00 0000 723f 0000 00da 0272 72da  gr>...r?.....rr.
+00002520: 0861 7065 7274 7572 6572 0f00 0000 720f  .aperturer....r.
+00002530: 0000 0072 1000 0000 da0d 7465 7374 5f61  ...r......test_a
+00002540: 7065 7274 7572 6530 0100 0073 1600 0000  perture0...s....
+00002550: 0a1e 2601 0c01 0c01 1401 1401 0401 0c01  ..&.............
+00002560: 1a01 1a01 0401 7280 0000 0063 0300 0000  ......r....c....
+00002570: 0000 0000 0000 0000 0a00 0000 0500 0000  ................
+00002580: 4300 0000 73d2 0000 0074 00a0 017c 01a1  C...s....t...|..
+00002590: 017d 0174 006a 0264 017c 006a 0364 0119  .}.t.j.d.|.j.d..
+000025a0: 0085 0264 017c 006a 0364 0219 0085 0266  ...d.|.j.d.....f
+000025b0: 0219 005c 027d 037d 047c 037c 0164 0219  ...\.}.}.|.|.d..
+000025c0: 0018 007d 037c 047c 0164 0119 0018 007d  ...}.|.|.d.....}
+000025d0: 047c 0364 0313 007c 0464 0313 0017 0064  .|.d...|.d.....d
+000025e0: 0413 007d 0574 006a 047c 057c 026b 017c  ...}.t.j.|.|.k.|
+000025f0: 006a 0564 058d 027d 0674 006a 067c 006a  .j.d...}.t.j.|.j
+00002600: 0364 0319 007c 006a 0364 0619 0066 027c  .d...|.j.d...f.|
+00002610: 066a 0317 007c 006a 0564 058d 027d 077c  .j...|.j.d...}.|
+00002620: 067c 0764 0764 0785 023c 0074 00a0 077c  .|.d.d...<.t...|
+00002630: 0764 08a1 027d 077c 077c 0014 007d 0874  .d...}.|.|...}.t
+00002640: 006a 0874 006a 087c 0864 0164 098d 0264  .j.t.j.|.d.d...d
+00002650: 0164 098d 027d 097c 0953 0029 0a61 4d03  .d...}.|.S.).aM.
+00002660: 0000 0a20 2020 2047 656e 6572 6174 6520  ...    Generate 
+00002670: 5669 7274 7561 6c20 4446 2069 6d61 6765  Virtual DF image
+00002680: 2066 6f72 2061 2067 6976 656e 2061 7065   for a given ape
+00002690: 7274 7572 650a 0a20 2020 2050 6172 616d  rture..    Param
+000026a0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+000026b0: 2d2d 2d2d 0a20 2020 2064 6174 6134 443a  ----.    data4D:
+000026c0: 206e 6461 7272 6179 206f 6620 7368 6170   ndarray of shap
+000026d0: 6520 2834 2c34 290a 2020 2020 2020 2020  e (4,4).        
+000026e0: 2020 2020 7468 6520 6669 7273 7420 7477      the first tw
+000026f0: 6f20 6469 6d65 6e73 696f 6e73 2061 7265  o dimensions are
+00002700: 2046 6f75 7269 6572 0a20 2020 2020 2020   Fourier.       
+00002710: 2020 2020 2073 7061 6365 2c20 7768 696c       space, whil
+00002720: 6520 7468 6520 6e65 7874 2074 776f 2064  e the next two d
+00002730: 696d 656e 7369 6f6e 730a 2020 2020 2020  imensions.      
+00002740: 2020 2020 2020 6172 6520 7265 616c 2073        are real s
+00002750: 7061 6365 0a20 2020 2063 656e 7465 723a  pace.    center:
+00002760: 206e 6461 7272 6179 206f 6620 7368 6170   ndarray of shap
+00002770: 6520 2831 2c32 290a 2020 2020 2020 2020  e (1,2).        
+00002780: 2020 2020 4365 6e74 6572 206f 6620 7468      Center of th
+00002790: 6520 6369 7263 756c 6172 2061 7065 7274  e circular apert
+000027a0: 7572 650a 2020 2020 7261 6469 7573 3a20  ure.    radius: 
+000027b0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+000027c0: 2020 5261 6469 7573 206f 6620 7468 6520    Radius of the 
+000027d0: 6369 7263 756c 6172 2061 7065 7274 7572  circular apertur
+000027e0: 650a 0a20 2020 2052 6574 7572 6e73 0a20  e..    Returns. 
+000027f0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00002800: 665f 696d 6167 653a 206e 6461 7272 6179  f_image: ndarray
+00002810: 206f 6620 7368 6170 6520 2832 2c32 290a   of shape (2,2).
+00002820: 2020 2020 2020 2020 2020 2020 2020 4765                Ge
+00002830: 6e65 7261 7465 6420 7669 7274 7561 6c20  nerated virtual 
+00002840: 6461 726b 2066 6965 6c64 2069 6d61 6765  dark field image
+00002850: 0a20 2020 2020 2020 2020 2020 2020 2066  .              f
+00002860: 726f 6d20 7468 6520 6170 6572 7475 7265  rom the aperture
+00002870: 2061 6e64 2034 4420 6461 7461 0a0a 2020   and 4D data..  
+00002880: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
+00002890: 2d0a 2020 2020 5765 2067 656e 6572 6174  -.    We generat
+000028a0: 6520 7468 6520 6170 6572 7475 7265 2066  e the aperture f
+000028b0: 6972 7374 2c20 616e 6420 7468 656e 206d  irst, and then m
+000028c0: 616b 6520 636f 7069 6573 0a20 2020 206f  ake copies.    o
+000028d0: 6620 7468 6520 6170 6572 7475 7265 2074  f the aperture t
+000028e0: 6f20 6765 6e65 7261 7465 2061 2034 4420  o generate a 4D 
+000028f0: 6461 7461 7365 7420 6f66 2074 6865 2073  dataset of the s
+00002900: 616d 650a 2020 2020 7369 7a65 2061 7320  ame.    size as 
+00002910: 7468 6520 3444 2064 6174 612e 2054 6865  the 4D data. The
+00002920: 6e20 7765 2064 6f20 616e 2065 6c65 6d65  n we do an eleme
+00002930: 6e74 2077 6973 650a 2020 2020 6d75 6c74  nt wise.    mult
+00002940: 6970 6c69 6361 7469 6f6e 206f 6620 7468  iplication of th
+00002950: 6973 2061 7065 7274 7572 6520 3444 2064  is aperture 4D d
+00002960: 6174 6120 7769 7468 2074 6865 2034 4420  ata with the 4D 
+00002970: 6461 7461 0a20 2020 2061 6e64 2074 6865  data.    and the
+00002980: 6e20 7375 6d20 6974 2061 6c6f 6e67 2074  n sum it along t
+00002990: 6865 2074 776f 2046 6f75 7269 6572 2064  he two Fourier d
+000029a0: 6972 6563 7469 6f6e 732e 0a20 2020 2072  irections..    r
+000029b0: 0100 0000 7227 0000 0072 2500 0000 7216  ....r'...r%...r.
+000029c0: 0000 0072 5f00 0000 7226 0000 004e 7224  ...r_...r&...Nr$
+000029d0: 0000 0072 4400 0000 2909 7209 0000 00da  ...rD...).r.....
+000029e0: 0561 7272 6179 7274 0000 0072 1900 0000  .arrayrt...r....
+000029f0: 7218 0000 0072 4d00 0000 da05 656d 7074  r....rM.....empt
+00002a00: 7972 2800 0000 720a 0000 0029 0a72 2900  yr(...r....).r).
+00002a10: 0000 727b 0000 0072 7c00 0000 723e 0000  ..r{...r|...r>..
+00002a20: 0072 3f00 0000 727e 0000 0072 7f00 0000  .r?...r~...r....
+00002a30: 5a08 6170 745f 636f 7079 5a08 6170 745f  Z.apt_copyZ.apt_
+00002a40: 6d75 6c74 5a08 6466 5f69 6d61 6765 720f  multZ.df_imager.
+00002a50: 0000 0072 0f00 0000 7210 0000 00da 0e61  ...r....r......a
+00002a60: 7065 7274 7572 655f 696d 6167 655b 0100  perture_image[..
+00002a70: 0073 1c00 0000 0a1d 2601 0c01 0c01 1401  .s......&.......
+00002a80: 1401 0401 1c01 06ff 0c03 0c01 0801 1801  ................
+00002a90: 0401 7283 0000 00da 046f 7665 7263 0400  ..r......overc..
+00002aa0: 0000 0000 0000 0000 0000 0500 0000 0600  ................
+00002ab0: 0000 4300 0000 7388 0000 007c 0264 016b  ..C...s....|.d.k
+00002ac0: 0272 1474 006a 017c 007c 0174 00a0 027c  .r.t.j.|.|.t...|
+00002ad0: 00a1 0114 006b 0474 006a 0364 028d 027d  .....k.t.j.d...}
+00002ae0: 046e 0f74 006a 017c 007c 0174 00a0 027c  .n.t.j.|.|.t...|
+00002af0: 00a1 0114 006b 0074 006a 0364 028d 027d  .....k.t.j.d...}
+00002b00: 047c 0372 3d74 046a 0564 0364 048d 0101  .|.r=t.j.d.d....
+00002b10: 0074 046a 067c 0474 076a 08a0 097c 00a1  .t.j.|.t.j...|..
+00002b20: 0117 0064 0564 068d 0201 0074 04a0 0a64  ...d.d.....t...d
+00002b30: 07a1 0101 007c 04a0 0b74 0ca1 017d 047c  .....|...t...}.|
+00002b40: 0453 0029 084e 7284 0000 0072 5f00 0000  .S.).Nr....r_...
+00002b50: 726b 0000 0072 6d00 0000 5a07 7669 7269  rk...rm...Z.viri
+00002b60: 6469 7372 6f00 0000 7a0c 524f 4920 6f76  disro...z.ROI ov
+00002b70: 6572 6c61 6964 290d 7209 0000 0072 1800  erlaid).r....r..
+00002b80: 0000 da06 6d65 6469 616e 7275 0000 0072  ....medianru...r
+00002b90: 7600 0000 7277 0000 0072 7800 0000 721d  v...rw...rx...r.
+00002ba0: 0000 0072 1e00 0000 7279 0000 00da 0574  ...r....ry.....t
+00002bb0: 6974 6c65 723a 0000 00da 0462 6f6f 6c29  itler:.....bool)
+00002bc0: 05da 0569 6d61 6765 da07 6d65 645f 7661  ...image..med_va
+00002bd0: 6cda 0573 7479 6c65 727d 0000 00da 0352  l..styler}.....R
+00002be0: 4f49 720f 0000 0072 0f00 0000 7210 0000  OIr....r....r...
+00002bf0: 00da 0e52 4f49 5f66 726f 6d5f 696d 6167  ...ROI_from_imag
+00002c00: 6588 0100 0073 1200 0000 0801 2001 1e02  e....s...... ...
+00002c10: 0401 0c01 1a01 0a01 0a01 0401 728c 0000  ............r...
+00002c20: 00a9 0272 0100 0000 7201 0000 0046 6306  ...r....r....Fc.
+00002c30: 0000 0000 0000 0000 0000 000b 0000 0006  ................
+00002c40: 0000 0043 0000 0073 1e01 0000 7400 a001  ...C...s....t...
+00002c50: 7c03 a101 7d03 7c03 6401 1900 6401 6b02  |...}.|.d...d.k.
+00002c60: 7214 6402 7c00 6a02 6401 1900 1400 7c03  r.d.|.j.d.....|.
+00002c70: 6401 3c00 7c03 6403 1900 6401 6b02 7223  d.<.|.d...d.k.r#
+00002c80: 6402 7c00 6a02 6403 1900 1400 7c03 6403  d.|.j.d.....|.d.
+00002c90: 3c00 7400 6a03 6401 7c00 6a02 6401 1900  <.t.j.d.|.j.d...
+00002ca0: 8502 6401 7c00 6a02 6403 1900 8502 6602  ..d.|.j.d.....f.
+00002cb0: 1900 5c02 7d06 7d07 7c04 6401 6b04 724e  ..\.}.}.|.d.k.rN
+00002cc0: 7c01 7c04 1400 7d01 7c02 7c04 1400 7d02  |.|...}.|.|...}.
+00002cd0: 7c03 7c04 1400 7d03 7c06 7c04 1400 7d06  |.|...}.|.|...}.
+00002ce0: 7c07 7c04 1400 7d07 7c06 7c03 6401 1900  |.|...}.|.|.d...
+00002cf0: 1800 7d06 7c07 7c03 6403 1900 1800 7d07  ..}.|.|.d.....}.
+00002d00: 7c06 6404 1300 7c07 6404 1300 1700 6402  |.d...|.d.....d.
+00002d10: 1300 7d08 7c02 6401 6b02 726d 7400 a004  ..}.|.d.k.rmt...
+00002d20: 7c08 a101 7d02 7400 a005 7c08 7c01 6b04  |...}.t...|.|.k.
+00002d30: 7c08 7c02 6b00 a102 7d09 7400 6a06 7c00  |.|.k...}.t.j.|.
+00002d40: 7c09 6405 6405 8502 6405 6405 8502 6603  |.d.d...d.d...f.
+00002d50: 1900 6401 6406 8d02 7d0a 7c05 728d 7c0a  ..d.d...}.|.r.|.
+00002d60: 7c09 6602 5300 7c0a 5300 2907 6145 0500  |.f.S.|.S.).aE..
+00002d70: 000a 2020 2020 5265 7475 726e 2053 5445  ..    Return STE
+00002d80: 4d20 696d 6167 6520 6672 6f6d 2064 6574  M image from det
+00002d90: 6563 746f 7220 7661 6c75 6573 0a0a 2020  ector values..  
+00002da0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00002db0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00002dc0: 6461 7461 3444 3a20 2020 2020 2020 6e64  data4D:       nd
+00002dd0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00002de0: 2020 2020 2020 2020 7468 6520 6669 7273          the firs
+00002df0: 7420 7477 6f20 6469 6d65 6e73 696f 6e73  t two dimensions
+00002e00: 2061 7265 2046 6f75 7269 6572 0a20 2020   are Fourier.   
+00002e10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00002e20: 7061 6365 2c20 7768 696c 6520 7468 6520  pace, while the 
+00002e30: 6e65 7874 2074 776f 2064 696d 656e 7369  next two dimensi
+00002e40: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00002e50: 2020 2020 2020 6172 6520 7265 616c 2073        are real s
+00002e60: 7061 6365 0a20 2020 2069 6e6e 6572 3a20  pace.    inner: 
+00002e70: 2020 2020 2020 2066 6c6f 6174 0a20 2020         float.   
+00002e80: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00002e90: 6865 2069 6e6e 6572 2063 6f6c 6c65 6374  he inner collect
+00002ea0: 696f 6e20 616e 676c 6520 696e 2046 6f75  ion angle in Fou
+00002eb0: 7269 6572 2073 7061 6365 0a20 2020 2020  rier space.     
+00002ec0: 2020 2020 2020 2020 2020 2020 2069 6e20               in 
+00002ed0: 7069 7865 6c73 0a20 2020 206f 7574 6572  pixels.    outer
+00002ee0: 3a20 2020 2020 2020 2066 6c6f 6174 2c20  :        float, 
+00002ef0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00002f00: 2020 2020 2020 2020 2020 2054 6865 2069             The i
+00002f10: 6e6e 6572 2063 6f6c 6c65 6374 696f 6e20  nner collection 
+00002f20: 616e 676c 6520 696e 2046 6f75 7269 6572  angle in Fourier
+00002f30: 2073 7061 6365 0a20 2020 2020 2020 2020   space.         
+00002f40: 2020 2020 2020 2020 2069 6e20 7069 7865           in pixe
+00002f50: 6c73 2e20 4465 6661 756c 7420 6973 2030  ls. Default is 0
+00002f60: 0a20 2020 2063 656e 7465 723a 2020 2020  .    center:    
+00002f70: 2020 2074 7570 6c65 2c20 6f70 7469 6f6e     tuple, option
+00002f80: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+00002f90: 2020 2020 2054 6865 2063 656e 7465 7220       The center 
+00002fa0: 6f66 2074 6865 2034 442d 5354 454d 2070  of the 4D-STEM p
+00002fb0: 6174 7465 726e 2069 6e20 466f 7572 6965  attern in Fourie
+00002fc0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00002fd0: 2020 2020 7370 6163 652e 2044 6566 6175      space. Defau
+00002fe0: 6c74 2069 7320 2830 2c20 3029 0a20 2020  lt is (0, 0).   
+00002ff0: 206d 7261 645f 6361 6c69 623a 2020 2066   mrad_calib:   f
+00003000: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+00003010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003020: 2043 616c 6962 7261 7469 6f6e 206f 6620   Calibration of 
+00003030: 7468 6520 466f 7572 6965 7220 7370 6163  the Fourier spac
+00003040: 652e 2044 6566 6175 6c74 0a20 2020 2020  e. Default.     
+00003050: 2020 2020 2020 2020 2020 2020 2069 7320               is 
+00003060: 302e 0a20 2020 2067 6574 5f64 6574 6563  0..    get_detec
+00003070: 746f 723a 2062 6f6f 6c2c 206f 7074 696f  tor: bool, optio
+00003080: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00003090: 2020 2020 2020 4765 7420 7468 6520 6465        Get the de
+000030a0: 7465 6374 6f72 2061 7272 6179 2069 6620  tector array if 
+000030b0: 7365 7420 746f 2054 7275 652e 2044 6566  set to True. Def
+000030c0: 6175 6c74 2069 730a 2020 2020 2020 2020  ault is.        
+000030d0: 2020 2020 2020 2020 2020 4661 6c73 650a            False.
+000030e0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+000030f0: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6174   -------.    dat
+00003100: 615f 6465 743a 206e 6461 7272 6179 0a20  a_det: ndarray. 
+00003110: 2020 2020 2020 2020 2020 2020 2054 6865               The
+00003120: 2053 5445 4d20 696d 6167 6520 6672 6f6d   STEM image from
+00003130: 2074 6865 2064 6574 6563 746f 7220 7265   the detector re
+00003140: 6769 6f6e 2063 686f 7365 6e0a 2020 2020  gion chosen.    
+00003150: 6465 7465 6374 6f72 3a20 6e64 6172 7261  detector: ndarra
+00003160: 792c 206f 7074 696f 6e61 6c0a 2020 2020  y, optional.    
+00003170: 2020 2020 2020 2020 2020 5468 6520 626f            The bo
+00003180: 6f6c 6561 6e20 6e64 6172 7261 7920 6966  olean ndarray if
+00003190: 2067 6574 5f64 6574 6563 746f 7220 6973   get_detector is
+000031a0: 2054 7275 650a 0a20 2020 204e 6f74 6573   True..    Notes
+000031b0: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2042  .    -----.    B
+000031c0: 6173 6564 206f 6e20 7468 6520 696e 6e65  ased on the inne
+000031d0: 7220 616e 6420 6f75 7465 7220 636f 6c6c  r and outer coll
+000031e0: 6563 7469 6f6e 2061 6e67 6c65 2074 6865  ection angle the
+000031f0: 2061 2053 5445 4d0a 2020 2020 696d 6167   a STEM.    imag
+00003200: 6520 6973 2067 656e 6572 6174 6564 2066  e is generated f
+00003210: 726f 6d20 7468 6520 3444 2d53 5445 4d20  rom the 4D-STEM 
+00003220: 6461 7461 7365 742e 2057 6520 6173 7375  dataset. We assu
+00003230: 6d65 2074 6861 740a 2020 2020 7468 6520  me that.    the 
+00003240: 6669 7273 7420 7477 6f20 6469 6d65 6e73  first two dimens
+00003250: 696f 6e73 2061 7265 2074 6865 2046 6f75  ions are the Fou
+00003260: 7269 6572 2073 7061 6365 2c20 7768 696c  rier space, whil
+00003270: 6520 7468 650a 2020 2020 6e65 7874 2074  e the.    next t
+00003280: 776f 2064 696d 656e 7369 6f6e 7320 6172  wo dimensions ar
+00003290: 6520 7265 616c 2073 7061 6365 2073 6361  e real space sca
+000032a0: 6e6e 696e 6720 6469 6d65 6e73 696f 6e73  nning dimensions
+000032b0: 2e0a 2020 2020 7201 0000 0072 1600 0000  ..    r....r....
+000032c0: 7227 0000 0072 2500 0000 4e72 4400 0000  r'...r%...NrD...
+000032d0: 2907 7209 0000 0072 1800 0000 7219 0000  ).r....r....r...
+000032e0: 0072 7400 0000 da04 616d 6178 da0b 6c6f  .rt.....amax..lo
+000032f0: 6769 6361 6c5f 616e 6472 0a00 0000 290b  gical_andr....).
+00003300: 7229 0000 00da 0569 6e6e 6572 5a05 6f75  r).....innerZ.ou
+00003310: 7465 7272 7b00 0000 5a0a 6d72 6164 5f63  terr{...Z.mrad_c
+00003320: 616c 6962 5a0c 6765 745f 6465 7465 6374  alibZ.get_detect
+00003330: 6f72 723e 0000 0072 3f00 0000 727e 0000  orr>...r?...r~..
+00003340: 005a 0864 6574 6563 746f 725a 0864 6174  .Z.detectorZ.dat
+00003350: 615f 6465 7472 0f00 0000 720f 0000 0072  a_detr....r....r
+00003360: 1000 0000 da0f 6375 7374 6f6d 5f64 6574  ......custom_det
+00003370: 6563 746f 7295 0100 0073 2c00 0000 0a2a  ector....s,....*
+00003380: 0c01 1201 0c01 1201 2601 0801 0801 0801  ........&.......
+00003390: 0801 0801 0801 0c01 0c01 1401 0801 0a01  ................
+000033a0: 1401 2001 0401 0801 0402 7291 0000 0063  .. .......r....c
+000033b0: 0200 0000 0000 0000 0000 0000 0b00 0000  ................
+000033c0: 0600 0000 4300 0000 7328 0100 0074 00a0  ....C...s(...t..
+000033d0: 017c 00a1 0164 0119 007d 0274 006a 027c  .|...d...}.t.j.|
+000033e0: 0274 006a 0364 028d 027c 021b 007d 037c  .t.j.d...|...}.|
+000033f0: 0074 00a0 047c 00a1 0118 0074 00a0 057c  .t...|.....t...|
+00003400: 00a1 0174 00a0 047c 00a1 0118 001b 007d  ...t...|.......}
+00003410: 0474 006a 067c 0174 006a 0364 028d 027d  .t.j.|.t.j.d...}
+00003420: 0574 006a 077c 0164 0319 007c 0164 0119  .t.j.|.d...|.d..
+00003430: 0064 0466 0374 006a 0364 028d 027d 0674  .d.f.t.j.d...}.t
+00003440: 006a 077c 0164 0319 007c 0164 0119 0064  .j.|.d...|.d...d
+00003450: 0466 0374 006a 0364 028d 027d 077c 057c  .f.t.j.d...}.|.|
+00003460: 0664 0064 0085 0264 0064 0085 0264 0166  .d.d...d.d...d.f
+00003470: 033c 0074 087c 0283 0144 005d 337d 0874  .<.t.|...D.]3}.t
+00003480: 00a0 097c 0464 0064 0085 027c 0866 0219  ...|.d.d...|.f..
+00003490: 007c 01a1 02a0 0a74 006a 03a1 017d 097c  .|.....t.j...}.|
+000034a0: 057c 037c 0819 0014 007c 0664 0064 0085  .|.|.....|.d.d..
+000034b0: 0264 0064 0085 0264 0366 033c 007c 097c  .d.d...d.f.<.|.|
+000034c0: 0664 0064 0085 0264 0064 0085 0264 0566  .d.d...d.d...d.f
+000034d0: 033c 007c 0774 0ba0 0c7c 06a1 0117 007d  .<.|.t...|.....}
+000034e0: 0771 577c 0774 00a0 057c 07a1 011b 007d  .qW|.t...|.....}
+000034f0: 0a7c 0a53 0029 064e 7227 0000 0072 5f00  .|.S.).Nr'...r_.
+00003500: 0000 7201 0000 0072 2600 0000 7225 0000  ..r....r&...r%..
+00003510: 0029 0d72 0900 0000 7219 0000 00da 0661  .).r....r......a
+00003520: 7261 6e67 65da 0766 6c6f 6174 3634 720b  range..float64r.
+00003530: 0000 0072 8e00 0000 da04 6f6e 6573 7241  ...r......onesrA
+00003540: 0000 0072 1b00 0000 7205 0000 0072 3a00  ...r....r....r:.
+00003550: 0000 da04 6d70 6c63 5a0a 6873 765f 746f  ....mplcZ.hsv_to
+00003560: 5f72 6762 290b 5a09 636f 6e63 5f64 6174  _rgb).Z.conc_dat
+00003570: 6172 2b00 0000 5a0a 6e6f 5f73 7065 6374  ar+...Z.no_spect
+00003580: 7261 5a0a 636f 6c6f 725f 6875 6573 5a09  raZ.color_huesZ.
+00003590: 6e6f 726d 5f63 6f6e 635a 1173 6174 7572  norm_concZ.satur
+000035a0: 6174 696f 6e5f 6d61 7472 6978 5a08 6873  ation_matrixZ.hs
+000035b0: 765f 6361 6c63 5a08 7267 625f 6361 6c63  v_calcZ.rgb_calc
+000035c0: 7222 0000 005a 0a63 6f6e 635f 696d 6167  r"...Z.conc_imag
+000035d0: 655a 0972 6762 5f69 6d61 6765 720f 0000  eZ.rgb_imager...
+000035e0: 0072 0f00 0000 7210 0000 00da 0b63 6f6c  .r....r......col
+000035f0: 6f72 6564 5f6d 6372 d801 0000 7320 0000  ored_mcr....s ..
+00003600: 000e 0114 010c 0112 0104 ff10 031e 011e  ................
+00003610: 0116 010c 0120 011e 0116 0110 010e 0104  ..... ..........
+00003620: 0172 9600 0000 6305 0000 0000 0000 0000  .r....c.........
+00003630: 0000 001b 0000 000b 0000 0043 0000 0073  ...........C...s
+00003640: 6403 0000 7400 a001 6401 a101 0100 7402  d...t...d.....t.
+00003650: 7403 a004 7c02 a101 6402 1900 8301 7d05  t...|...d.....}.
+00003660: 7403 6a05 7c03 7403 6a06 6403 8d02 7d03  t.j.|.t.j.d...}.
+00003670: 7403 a007 7c02 a101 7d06 7403 6a08 6402  t...|...}.t.j.d.
+00003680: 7c00 6a04 6402 1900 8502 6402 7c00 6a04  |.j.d.....d.|.j.
+00003690: 6404 1900 8502 6602 1900 5c02 7d07 7d08  d.....f...\.}.}.
+000036a0: 7409 7c05 8301 4400 5d51 7d09 7c02 7c09  t.|...D.]Q}.|.|.
+000036b0: 6402 6602 1900 7d0a 7c02 7c09 6404 6602  d.f...}.|.|.d.f.
+000036c0: 1900 7d0b 7c07 7c0b 1800 6405 1300 7c08  ..}.|.|...d...|.
+000036d0: 7c0a 1800 6405 1300 1700 7c01 6405 1300  |...d.....|.d...
+000036e0: 6b01 7d0c 7403 a00a 7c00 7c0c 1900 a101  k.}.t...|.|.....
+000036f0: 7403 a00b 7c00 7c0c 1900 a101 1b00 7d0d  t...|.|.......}.
+00003700: 7c0d 6404 7c04 1700 6b00 726e 7403 6a0c  |.d.|...k.rnt.j.
+00003710: 7c06 7c09 6402 6405 8502 6602 3c00 7132  |.|.d.d...f.<.q2
+00003720: 740d 6a0e a00f 7c00 7c0a 7c0b 7c01 a104  t.j...|.|.|.|...
+00003730: 7d0e 7c0e 6402 6405 8502 1900 7c06 7c09  }.|.d.d.....|.|.
+00003740: 6402 6405 8502 6602 3c00 7132 7403 a002  d.d...f.<.q2t...
+00003750: 7403 a010 7403 a011 7c06 a101 a101 6405  t...t...|.....d.
+00003760: 1b00 a101 7d0f 7c0f 7c05 6b02 72a5 7403  ....}.|.|.k.r.t.
+00003770: 6a0c 7403 a012 6406 a101 1400 7d10 7403  j.t...d.....}.t.
+00003780: 6a0c 7d11 7403 6a0c 7d12 9001 6e07 7c03  j.}.t.j.}...n.|.
+00003790: 7403 a011 7c06 a101 0f00 1900 a013 7c05  t...|.........|.
+000037a0: 7c0f 1800 6405 a102 7d03 7c06 7403 a011  |...d...}.|.t...
+000037b0: 7c06 a101 0f00 1900 a013 7c05 7c0f 1800  |.........|.|...
+000037c0: 6405 a102 7d06 7403 a014 7c06 a101 7d13  d...}.t...|...}.
+000037d0: 6407 7c13 6408 6408 8502 6404 6602 1900  d.|.d.d...d.f...
+000037e0: 1400 7c13 6408 6408 8502 6404 6602 3c00  ..|.d.d...d.f.<.
+000037f0: 7c13 7403 a015 7c03 6408 6408 8502 6402  |.t...|.d.d...d.
+00003800: 6602 1900 6402 6b02 7c03 6408 6408 8502  f...d.k.|.d.d...
+00003810: 6404 6602 1900 6402 6b02 a102 6408 6408  d.f...d.k...d.d.
+00003820: 8502 6602 1900 7d14 7c14 6a04 6402 1900  ..f...}.|.j.d...
+00003830: 6402 6b04 9001 72a3 7c14 6409 1900 7d15  d.k...r.|.d...}.
+00003840: 7c14 640a 1900 7d16 7403 6a05 7c15 7c16  |.d...}.t.j.|.|.
+00003850: 0b00 6602 7403 6a06 6403 8d02 7d10 7c0f  ..f.t.j.d...}.|.
+00003860: 7c05 1b00 640b 6b00 9001 729c 7c13 6408  |...d.k...r.|.d.
+00003870: 6408 8502 6402 6405 8502 6602 1900 7403  d...d.d...f...t.
+00003880: 6a05 7c15 7c16 6602 7403 6a06 6403 8d02  j.|.|.f.t.j.d...
+00003890: 1800 7c13 6408 6408 8502 6402 6405 8502  ..|.d.d...d.d...
+000038a0: 6602 3c00 7403 6a16 6a17 7c03 7c13 6408  f.<.t.j.j.|.|.d.
+000038b0: 640c 8d03 5c04 7d12 7d17 7d17 7d17 7403  d...\.}.}.}.}.t.
+000038c0: a018 7c03 7c12 a102 7d18 7403 a019 7403  ..|.|...}.t...t.
+000038d0: a01a 7c13 7403 a01b 7c18 6408 6408 8502  ..|.t...|.d.d...
+000038e0: 6402 6602 1900 6402 6b03 a101 6402 6602  d.f...d.k...d.f.
+000038f0: 1900 7c18 7403 a01b 7c18 6408 6408 8502  ..|.t...|.d.d...
+00003900: 6402 6602 1900 6402 6b03 a101 6402 6602  d.f...d.k...d.f.
+00003910: 1900 a102 a101 7d19 7403 a019 7403 a01a  ......}.t...t...
+00003920: 7c13 7403 a01b 7c18 6408 6408 8502 6404  |.t...|.d.d...d.
+00003930: 6602 1900 6402 6b03 a101 6404 6602 1900  f...d.k...d.f...
+00003940: 7c18 7403 a01b 7c18 6408 6408 8502 6404  |.t...|.d.d...d.
+00003950: 6602 1900 6402 6b03 a101 6404 6602 1900  f...d.k...d.f...
+00003960: a102 a101 7d1a 7403 6a05 7c19 7c1a 6602  ....}.t.j.|.|.f.
+00003970: 7403 6a06 6403 8d02 7d11 6e10 7403 6a0c  t.j.d...}.n.t.j.
+00003980: 7d11 7403 6a0c 7d12 6e09 7403 6a0c 7d10  }.t.j.}.n.t.j.}.
+00003990: 7403 6a0c 7d11 7403 6a0c 7d12 7c06 7c10  t.j.}.t.j.}.|.|.
+000039a0: 7c11 7c12 6604 5300 290d 61d0 0700 000a  |.|.f.S.).a.....
+000039b0: 2020 2020 4469 736b 2046 6974 7469 6e67      Disk Fitting
+000039c0: 2061 6c67 6f72 6974 686d 2066 6f72 2061   algorithm for a
+000039d0: 2073 696e 676c 6520 4e42 4544 2070 6174   single NBED pat
+000039e0: 7465 726e 0a0a 2020 2020 5061 7261 6d65  tern..    Parame
+000039f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00003a00: 2d2d 2d0a 2020 2020 636f 7272 5f69 6d61  ---.    corr_ima
+00003a10: 6765 3a20 6e64 6172 7261 7920 6f66 2073  ge: ndarray of s
+00003a20: 6861 7065 2028 322c 3229 0a20 2020 2020  hape (2,2).     
+00003a30: 2020 2020 2020 2020 2020 2054 6865 2063             The c
+00003a40: 726f 7373 2d63 6f72 7265 6c61 7465 6420  ross-correlated 
+00003a50: 696d 6167 6520 6f66 2074 6865 204e 4245  image of the NBE
+00003a60: 4420 7468 6174 0a20 2020 2020 2020 2020  D that.         
+00003a70: 2020 2020 2020 2077 696c 6c20 6265 2066         will be f
+00003a80: 6974 7465 640a 2020 2020 6469 736b 5f73  itted.    disk_s
+00003a90: 697a 653a 2020 666c 6f61 740a 2020 2020  ize:  float.    
+00003aa0: 2020 2020 2020 2020 2020 2020 5369 7a65              Size
+00003ab0: 206f 6620 6561 6368 204e 4245 4420 6469   of each NBED di
+00003ac0: 736b 7320 696e 2070 6978 656c 730a 2020  sks in pixels.  
+00003ad0: 2020 706f 7369 7469 6f6e 733a 2020 6e64    positions:  nd
+00003ae0: 6172 7261 7920 6f66 2073 6861 7065 2028  array of shape (
+00003af0: 6e2c 3229 0a20 2020 2020 2020 2020 2020  n,2).           
+00003b00: 2020 2020 2058 2061 6e64 2059 2070 6f73       X and Y pos
+00003b10: 6974 696f 6e73 2077 6865 7265 206e 2069  itions where n i
+00003b20: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+00003b30: 706f 7369 7469 6f6e 732e 0a20 2020 2020  positions..     
+00003b40: 2020 2020 2020 2020 2020 2054 6865 7365             These
+00003b50: 2061 7265 2074 6865 2069 6e69 7469 616c   are the initial
+00003b60: 2067 7565 7373 6573 2074 6861 7420 7769   guesses that wi
+00003b70: 6c6c 2062 6520 7265 6669 6e65 640a 2020  ll be refined.  
+00003b80: 2020 6469 6666 5f73 706f 7473 3a20 6e64    diff_spots: nd
+00003b90: 6172 7261 7920 6f66 2073 6861 7065 2028  array of shape (
+00003ba0: 6e2c 3229 0a20 2020 2020 2020 2020 2020  n,2).           
+00003bb0: 2020 2020 2061 2061 6e64 2062 204d 696c       a and b Mil
+00003bc0: 6c65 7220 696e 6469 6365 7320 636f 7272  ler indices corr
+00003bd0: 6573 706f 6e64 696e 6720 746f 2074 6865  esponding to the
 00003be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003bf0: 2020 2020 2020 2053 7461 6e64 6172 6420         Standard 
-00003c00: 6465 7669 6174 696f 6e20 6f66 2074 6865  deviation of the
-00003c10: 2058 2061 6e64 2059 2064 6973 6b20 6669   X and Y disk fi
-00003c20: 7473 2067 6976 656e 2061 7320 7069 7865  ts given as pixe
-00003c30: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
-00003c40: 2020 2020 2020 2020 7261 7469 6f73 0a20          ratios. 
-00003c50: 2020 206c 6362 6564 3a20 2020 2020 2020     lcbed:       
-00003c60: 2020 2020 206e 6461 7272 6179 206f 6620       ndarray of 
-00003c70: 7368 6170 6520 2832 2c32 290a 2020 2020  shape (2,2).    
-00003c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c90: 2020 4d61 7472 6978 2064 6566 696e 696e    Matrix definin
-00003ca0: 6720 7468 6520 4d69 6c6c 6572 2069 6e64  g the Miller ind
-00003cb0: 6963 6573 2061 7865 730a 0a20 2020 204e  ices axes..    N
-00003cc0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-00003cd0: 2020 2045 7665 7279 2064 6973 6b20 706f     Every disk po
-00003ce0: 7369 7469 6f6e 2069 7320 6669 7474 6564  sition is fitted
-00003cf0: 2077 6974 6820 6120 3244 2047 6175 7373   with a 2D Gauss
-00003d00: 6961 6e20 6279 2063 7574 7469 6e67 206f  ian by cutting o
-00003d10: 6666 2061 2063 6972 636c 650a 2020 2020  ff a circle.    
-00003d20: 6f66 2074 6865 2073 697a 6520 6f66 2064  of the size of d
-00003d30: 6973 6b5f 7369 7a65 2061 726f 756e 6420  isk_size around 
-00003d40: 7468 6520 696e 6974 6961 6c20 706f 6973  the initial pois
-00003d50: 7469 6f6e 732e 2049 6620 6e61 6e2d 6375  tions. If nan-cu
-00003d60: 746f 6666 2069 7320 6162 6f76 650a 2020  toff is above.  
-00003d70: 2020 7a65 726f 2074 6865 6e20 6f6e 6c79    zero then only
-00003d80: 2074 6865 206c 6f63 6174 696f 6e73 2069   the locations i
-00003d90: 6e73 6964 6520 7468 6973 2063 7574 6f66  nside this cutof
-00003da0: 6620 7768 6572 6520 7468 6520 6d61 7869  f where the maxi
-00003db0: 6d75 6d20 7069 7865 6c20 696e 7465 6e73  mum pixel intens
-00003dc0: 6974 790a 2020 2020 6973 2028 312b 6e61  ity.    is (1+na
-00003dd0: 6e5f 6375 746f 6666 2920 7469 6d65 7320  n_cutoff) times 
-00003de0: 7468 6520 6d65 6469 616e 2070 6978 656c  the median pixel
-00003df0: 2069 6e74 656e 7369 7479 2077 696c 6c20   intensity will 
-00003e00: 6265 2066 6974 7465 642e 2055 7365 2074  be fitted. Use t
-00003e10: 6869 730a 2020 2020 7061 7261 6d65 7465  his.    paramete
-00003e20: 7220 6361 7265 6675 6c6c 792c 2062 6563  r carefully, bec
-00003e30: 6175 7365 2069 6e20 736f 6d65 2063 6173  ause in some cas
-00003e40: 6573 2074 6869 7320 6d61 7920 7265 7375  es this may resu
-00003e50: 6c74 2069 6e20 6e6f 2064 6973 6b73 2062  lt in no disks b
-00003e60: 6569 6e67 2066 6974 7465 640a 2020 2020  eing fitted.    
-00003e70: 616e 6420 7468 6520 7072 6f67 7261 6d20  and the program 
-00003e80: 7468 726f 7769 6e67 2077 6569 7264 2065  throwing weird e
-00003e90: 7272 6f72 7320 6174 2079 6f75 2e0a 2020  rrors at you..  
-00003ea0: 2020 da06 6967 6e6f 7265 7201 0000 0072    ..ignorer....r
-00003eb0: 5700 0000 7227 0000 0072 2500 0000 2902  W...r'...r%...).
-00003ec0: 7227 0000 0072 2500 0000 7206 0000 004e  r'...r%...r....N
-00003ed0: 7286 0000 00a9 0272 0100 0000 7227 0000  r......r....r'..
-00003ee0: 0072 1600 0000 a901 5a05 7263 6f6e 6429  .r......Z.rcond)
-00003ef0: 1cda 0877 6172 6e69 6e67 73da 0e66 696c  ...warnings..fil
-00003f00: 7465 7277 6172 6e69 6e67 7372 2f00 0000  terwarningsr/...
-00003f10: 7209 0000 0072 1900 0000 7218 0000 0072  r....r....r....r
-00003f20: 8c00 0000 721a 0000 0072 6d00 0000 721b  ....r....rm...r.
-00003f30: 0000 0072 8700 0000 727e 0000 00da 036e  ...r....r~.....n
-00003f40: 616e 721d 0000 0072 1e00 0000 da13 6669  anr....r......fi
-00003f50: 745f 6761 7573 7369 616e 3244 5f6d 6173  t_gaussian2D_mas
-00003f60: 6b72 0a00 0000 da05 6973 6e61 6e72 8d00  kr......isnanr..
-00003f70: 0000 7205 0000 0072 5800 0000 7288 0000  ..r....rX...r...
-00003f80: 00da 066c 696e 616c 67da 056c 7374 7371  ...linalg..lstsq
-00003f90: da06 6d61 746d 756c da03 7374 64da 0664  ..matmul..std..d
-00003fa0: 6976 6964 65da 0577 6865 7265 291b 5a0a  ivide..where).Z.
-00003fb0: 636f 7272 5f69 6d61 6765 da09 6469 736b  corr_image..disk
-00003fc0: 5f73 697a 65da 0970 6f73 6974 696f 6e73  _size..positions
-00003fd0: 5a0a 6469 6666 5f73 706f 7473 da0a 6e61  Z.diff_spots..na
-00003fe0: 6e5f 6375 746f 6666 5a06 6e6f 5f70 6f73  n_cutoffZ.no_pos
-00003ff0: 5a10 6669 7474 6564 5f64 6973 6b5f 6c69  Z.fitted_disk_li
-00004000: 7374 7252 0000 0072 4f00 0000 7222 0000  strR...rO...r"..
-00004010: 005a 0470 6f73 785a 0470 6f73 79da 0372  .Z.posxZ.posy..r
-00004020: 6567 5a0a 7065 616b 5f72 6174 696f da03  egZ.peak_ratio..
-00004030: 7061 725a 086e 616e 636f 756e 745a 0f63  parZ.nancountZ.c
-00004040: 656e 7465 725f 706f 7369 7469 6f6e 5a0d  enter_positionZ.
-00004050: 6669 745f 6465 7669 6174 696f 6e5a 056c  fit_deviationZ.l
-00004060: 6362 6564 5a0e 6469 736b 5f6c 6f63 6174  cbedZ.disk_locat
-00004070: 696f 6e73 7274 0000 005a 0263 78da 0263  ionsrt...Z.cx..c
-00004080: 79da 015f 5a0b 6361 6c63 5f70 6f69 6e74  y.._Z.calc_point
-00004090: 735a 0473 7464 785a 0473 7464 7972 0f00  sZ.stdxZ.stdyr..
-000040a0: 0000 720f 0000 0072 1000 0000 da0e 6669  ..r....r......fi
-000040b0: 745f 6e62 6564 5f64 6973 6b73 cc01 0000  t_nbed_disks....
-000040c0: 7376 0000 0000 2e0a 0112 0110 010a 0126  sv.............&
-000040d0: 010c 010c 010c 0120 011c 010c 0114 0212  ....... ........
-000040e0: 011a 011a 010a 0110 0106 010a 0210 0108  ................
-000040f0: ff04 0310 0108 ff04 030a 0120 0102 0132  ........... ...2
-00004100: ff04 0310 0108 0108 0116 010e 0116 010a  ................
-00004110: ff18 031a 010c 0104 0104 0120 0120 fe02  ........... . ..
-00004120: ff04 0604 0104 0120 0120 fe02 ff04 0616  ....... . ......
-00004130: 0206 0108 0206 0106 0106 0172 a500 0000  ...........r....
-00004140: e90a 0000 0072 2600 0000 e79a 9999 9999  .....r&.........
-00004150: 99b9 3f72 1600 0000 630a 0000 0000 0000  ..?r....c.......
-00004160: 0000 0000 0028 0000 0008 0000 0043 0000  .....(.......C..
-00004170: 0073 ac03 0000 7400 a001 6401 a101 0100  .s....t...d.....
-00004180: 7402 6a03 6402 7c00 6a04 6403 1900 8502  t.j.d.|.j.d.....
-00004190: 6402 7c00 6a04 6404 1900 8502 6602 1900  d.|.j.d.....f...
-000041a0: 5c02 7d0a 7d0b 7c00 6405 6405 8502 6405  \.}.}.|.d.d...d.
-000041b0: 6405 8502 7c0a 7c01 1900 7c0b 7c01 1900  d...|.|...|.|...
-000041c0: 6604 1900 7d0c 7c0c 6a04 6406 1900 7d0d  f...}.|.j.d...}.
-000041d0: 7402 a005 7406 6a07 a008 7c02 a101 a101  t...t.j...|.....
-000041e0: 7402 6a09 1b00 6407 1300 7d0e 7402 a00a  t.j...d...}.t...
-000041f0: 6403 a101 a00b 7402 6a0c a101 7d0f 7406  d.....t.j...}.t.
-00004200: 6a07 a00d 7c02 a101 5c02 7d10 7d11 7402  j...|...\.}.}.t.
-00004210: 6a0e 7402 6a0f 7c0d 7402 6a0c 6408 8d02  j.t.j.|.t.j.d...
-00004220: 1400 7d12 7402 6a0e 7402 6a0f 7c0d 7402  ..}.t.j.t.j.|.t.
-00004230: 6a0c 6408 8d02 1400 7d13 7402 6a0e 7402  j.d.....}.t.j.t.
-00004240: 6a0f 7c0d 7402 6a0c 6408 8d02 1400 7d14  j.|.t.j.d.....}.
-00004250: 7402 6a0e 7402 6a0f 7c0d 7402 6a0c 6408  t.j.t.j.|.t.j.d.
-00004260: 8d02 1400 7d15 7402 6a0e 7402 6a0f 7c0d  ....}.t.j.t.j.|.
-00004270: 6403 6602 7402 6a0c 6408 8d02 1400 7d16  d.f.t.j.d.....}.
-00004280: 7402 6a0e 7402 a010 7c0a a101 1400 7d17  t.j.t...|.....}.
-00004290: 7402 6a0e 7402 a010 7c0a a101 1400 7d18  t.j.t...|.....}.
-000042a0: 7402 6a0e 7402 a010 7c0a a101 1400 7d19  t.j.t...|.....}.
-000042b0: 7402 6a0e 7402 a010 7c0a a101 1400 7d1a  t.j.t...|.....}.
-000042c0: 7402 a011 7c05 a101 6403 6b00 9001 72d2  t...|...d.k...r.
-000042d0: 7402 6a12 7c0c 6406 6409 8d02 7d1b 7406  t.j.|.d.d...}.t.
-000042e0: 6a07 a00d 7406 6a07 a013 7c1b a101 a101  j...t.j...|.....
-000042f0: 5c02 7d1c 7d11 7402 a014 7c1c a101 7c1c  \.}.}.t...|...|.
-00004300: 7c1c 7c06 7402 a014 7c1c a101 1400 6b04  |.|.t...|.....k.
-00004310: 3c00 7406 6a07 6a15 7c1c 7c10 7c08 640a  <.t.j.j.|.|.|.d.
-00004320: 8d03 7d1d 7416 7c1d 7c0e 7c03 7c04 8304  ..}.t.|.|.|.|...
-00004330: 5c04 7d11 7d11 7d11 7d1e 7402 6a17 a018  \.}.}.}.}.t.j...
-00004340: 7c1e a101 7d1f 6e0c 7402 6a17 a018 7c05  |...}.n.t.j...|.
-00004350: a101 7d1f 7419 741a 7c0d 8301 8301 4400  ..}.t.t.|.....D.
-00004360: 9001 5d28 7d20 7c0c 6405 6405 8502 6405  ..](} |.d.d...d.
-00004370: 6405 8502 7c20 6603 1900 7d21 7406 6a07  d...| f...}!t.j.
-00004380: a00d 741b a01c 7406 6a07 a013 7c21 a101  ..t...t.j...|!..
-00004390: 7c07 a102 a101 5c02 7d22 7d11 7402 a014  |.....\.}"}.t...
-000043a0: 7c22 a101 7c06 1400 7c22 7c22 7c06 7402  |"..|...|"|"|.t.
-000043b0: a014 7c22 a101 1400 6b04 3c00 7402 a014  ..|"....k.<.t...
-000043c0: 7c22 a101 7c06 1b00 7c22 7c22 7402 a014  |"..|...|"|"t...
-000043d0: 7c22 a101 7c06 1b00 6b00 3c00 7406 6a07  |"..|...k.<.t.j.
-000043e0: 6a15 7c22 7c10 7c08 640a 8d03 7d23 7416  j.|"|.|.d...}#t.
-000043f0: 7c23 7c0e 7c03 7c04 7c09 8305 5c04 7d11  |#|.|.|.|...\.}.
-00004400: 7d11 7d24 7d25 7402 a01d 7402 a01e 7c25  }.}$}%t...t...|%
-00004410: a101 a101 6402 1900 0f00 9001 72ea 7c24  ....d.......r.|$
-00004420: 7c16 7c20 6405 6405 8502 6602 3c00 7402  |.| d.d...f.<.t.
-00004430: a01f 7c25 7c1f a102 7d26 7c26 7c0f 1800  ..|%|...}&|&|...
-00004440: 7d27 7c27 640b 1900 0b00 7c12 7c20 3c00  }'|'d.....|.| <.
-00004450: 7c27 640c 1900 7c27 640d 1900 1700 0b00  |'d...|'d.......
-00004460: 7c13 7c20 3c00 7c27 640c 1900 7c27 640d  |.| <.|'d...|'d.
-00004470: 1900 1800 7c14 7c20 3c00 7c27 640e 1900  ....|.| <.|'d...
-00004480: 0b00 7c15 7c20 3c00 9001 71ea 7c12 7c17  ..|.| <...q.|.|.
-00004490: 7c01 3c00 6402 7c17 7402 a01d 7c17 a101  |.<.d.|.t...|...
-000044a0: 3c00 741b a01c 7c17 640f a102 7d17 7c13  <.t...|.d...}.|.
-000044b0: 7c18 7c01 3c00 6402 7c18 7402 a01d 7c18  |.|.<.d.|.t...|.
-000044c0: a101 3c00 741b a01c 7c18 640f a102 7d18  ..<.t...|.d...}.
-000044d0: 7c14 7c19 7c01 3c00 6402 7c19 7402 a01d  |.|.|.<.d.|.t...
-000044e0: 7c19 a101 3c00 741b a01c 7c19 640f a102  |...<.t...|.d...
-000044f0: 7d19 7c15 7c1a 7c01 3c00 6402 7c1a 7402  }.|.|.|.<.d.|.t.
-00004500: a01d 7c1a a101 3c00 741b a01c 7c1a 640f  ..|...<.t...|.d.
-00004510: a102 7d1a 7c17 7c18 7c19 7c1a 7c16 6605  ..}.|.|.|.|.|.f.
-00004520: 5300 2910 6182 0c00 000a 2020 2020 4765  S.).a.....    Ge
-00004530: 7420 7374 7261 696e 2066 726f 6d20 6120  t strain from a 
-00004540: 7265 6769 6f6e 206f 6620 696e 7465 7265  region of intere
-00004550: 7374 0a0a 2020 2020 5061 7261 6d65 7465  st..    Paramete
-00004560: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00004570: 2d0a 2020 2020 6461 7461 3444 3a20 2020  -.    data4D:   
-00004580: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-00004590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000045a0: 2020 5468 6973 2069 7320 6120 3444 2064    This is a 4D d
-000045b0: 6174 6173 6574 2077 6865 7265 2074 6865  ataset where the
-000045c0: 2066 6972 7374 2074 776f 2064 696d 656e   first two dimen
-000045d0: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
-000045e0: 2020 2020 2020 2020 2020 6172 6520 7468            are th
-000045f0: 6520 6469 6666 7261 6374 696f 6e20 6469  e diffraction di
-00004600: 6d65 6e73 696f 6e73 2061 6e64 2074 6865  mensions and the
-00004610: 206e 6578 7420 7477 6f0a 2020 2020 2020   next two.      
-00004620: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00004630: 6d65 6e73 696f 6e73 2061 7265 2074 6865  mensions are the
-00004640: 2073 6361 6e20 6469 6d65 6e73 696f 6e73   scan dimensions
-00004650: 0a20 2020 2052 4f49 3a20 2020 2020 2020  .    ROI:       
-00004660: 2020 2020 206e 6461 7272 6179 206f 6620       ndarray of 
-00004670: 6474 7970 6520 626f 6f6c 0a20 2020 2020  dtype bool.     
-00004680: 2020 2020 2020 2020 2020 2020 2020 2052                 R
-00004690: 6567 696f 6e20 6f66 2069 6e74 6572 6573  egion of interes
-000046a0: 740a 2020 2020 6365 6e74 6572 5f64 6973  t.    center_dis
-000046b0: 6b3a 2020 2020 6e64 6172 7261 790a 2020  k:    ndarray.  
-000046c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000046d0: 2020 5468 6520 626c 616e 6b20 6469 6666    The blank diff
-000046e0: 7261 6374 696f 6e20 6469 736b 2074 656d  raction disk tem
-000046f0: 706c 6174 6520 7768 6572 650a 2020 2020  plate where.    
-00004700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004710: 6974 2069 7320 3120 696e 7369 6465 2074  it is 1 inside t
-00004720: 6865 2063 6972 636c 6520 616e 6420 3020  he circle and 0 
-00004730: 6f75 7473 6964 650a 2020 2020 6469 736b  outside.    disk
-00004740: 5f6c 6973 743a 2020 2020 2020 6e64 6172  _list:      ndar
-00004750: 7261 7920 6f66 2073 6861 7065 2028 6e2c  ray of shape (n,
-00004760: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-00004770: 2020 2020 2020 2058 2061 6e64 2059 2070         X and Y p
-00004780: 6f73 6974 696f 6e73 2077 6865 7265 206e  ositions where n
-00004790: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
-000047a0: 6620 706f 7369 7469 6f6e 732e 0a20 2020  f positions..   
-000047b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047c0: 2054 6865 7365 2061 7265 2074 6865 2069   These are the i
-000047d0: 6e69 7469 616c 2067 7565 7373 6573 2074  nitial guesses t
-000047e0: 6861 7420 7769 6c6c 2062 6520 7265 6669  hat will be refi
-000047f0: 6e65 640a 2020 2020 706f 735f 6c69 7374  ned.    pos_list
-00004800: 3a20 2020 2020 2020 6e64 6172 7261 7920  :       ndarray 
-00004810: 6f66 2073 6861 7065 2028 6e2c 3229 0a20  of shape (n,2). 
-00004820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004830: 2020 2061 2061 6e64 2062 204d 696c 6c65     a and b Mille
-00004840: 7220 696e 6469 6365 7320 636f 7272 6573  r indices corres
-00004850: 706f 6e64 696e 6720 746f 2074 6865 0a20  ponding to the. 
-00004860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004870: 2020 2064 6973 6b20 706f 7369 7469 6f6e     disk position
-00004880: 730a 2020 2020 7265 6665 7265 6e63 655f  s.    reference_
-00004890: 6178 6573 3a20 6e64 6172 7261 792c 206f  axes: ndarray, o
-000048a0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000048b0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-000048c0: 756e 6974 2063 656c 6c20 6178 6573 2066  unit cell axes f
-000048d0: 726f 6d20 7468 6520 7265 6665 7265 6e63  rom the referenc
-000048e0: 6520 7265 6769 6f6e 2e20 5374 7261 696e  e region. Strain
-000048f0: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
-00004900: 2020 2020 2020 2020 6361 6c63 756c 6174          calculat
-00004910: 6564 2062 7920 636f 6d61 7072 696e 6720  ed by comapring 
-00004920: 7468 6520 6178 6573 2061 7420 6120 7363  the axes at a sc
-00004930: 616e 2070 6f73 6974 696f 6e20 7769 7468  an position with
-00004940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004950: 2020 2020 2074 6865 2072 6566 6572 656e       the referen
-00004960: 6365 2061 7865 7320 7661 6c75 6573 2e20  ce axes values. 
-00004970: 4966 2069 7420 6973 2030 2c20 7468 656e  If it is 0, then
-00004980: 2074 6865 2061 7665 7261 6765 0a20 2020   the average.   
-00004990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049a0: 204e 4245 4420 6178 6573 2077 696c 6c20   NBED axes will 
-000049b0: 6265 2063 616c 6375 6c61 7465 6420 616e  be calculated an
-000049c0: 6420 7769 6c6c 2062 6520 7573 6564 2061  d will be used a
-000049d0: 7320 7468 650a 2020 2020 2020 2020 2020  s the.          
-000049e0: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-000049f0: 6e63 6520 6178 6573 2e0a 2020 2020 6d65  nce axes..    me
-00004a00: 645f 6661 6374 6f72 3a20 2020 2020 666c  d_factor:     fl
-00004a10: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00004a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a30: 2020 4475 6520 746f 2064 6574 6563 746f    Due to detecto
-00004a40: 7220 6e6f 6973 652c 2073 6f6d 6520 7374  r noise, some st
-00004a50: 7261 7920 7069 7865 6c73 206d 6179 206f  ray pixels may o
-00004a60: 6674 656e 2062 6520 6272 6967 6874 6572  ften be brighter
-00004a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004a80: 2020 2020 2074 6861 6e20 7468 6520 6261       than the ba
-00004a90: 636b 6772 6f75 6e64 2e20 5468 6973 2069  ckground. This i
-00004aa0: 7320 7573 6564 2066 6f72 2064 616d 7069  s used for dampi
-00004ab0: 6e67 2061 6e79 2073 7563 6820 7069 7865  ng any such pixe
-00004ac0: 6c73 2e0a 2020 2020 2020 2020 2020 2020  ls..            
-00004ad0: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-00004ae0: 6973 2033 300a 2020 2020 6761 7573 735f  is 30.    gauss_
-00004af0: 7661 6c3a 2020 2020 2020 666c 6f61 742c  val:      float,
-00004b00: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00004b10: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-00004b20: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
-00004b30: 7469 6f6e 206f 6620 7468 6520 4761 7573  tion of the Gaus
-00004b40: 7369 616e 2066 696c 7465 7220 6170 706c  sian filter appl
-00004b50: 6965 6420 746f 2074 6865 0a20 2020 2020  ied to the.     
-00004b60: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00004b70: 6f67 6172 6974 686d 206f 6620 7468 6520  ogarithm of the 
-00004b80: 4342 4544 2070 6174 7465 726e 2e20 4465  CBED pattern. De
-00004b90: 6661 756c 7420 6973 2033 0a20 2020 2068  fault is 3.    h
-00004ba0: 7962 7269 645f 6363 3a20 2020 2020 2066  ybrid_cc:      f
-00004bb0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-00004bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004bd0: 2020 2048 7962 7269 6469 7a61 7469 6f6e     Hybridization
-00004be0: 2070 6172 616d 6574 6572 2074 6f20 6265   parameter to be
-00004bf0: 2075 7365 6420 666f 7220 6372 6f73 732d   used for cross-
-00004c00: 636f 7272 656c 6174 696f 6e2e 0a20 2020  correlation..   
-00004c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004c20: 2044 6566 6175 6c74 2069 7320 302e 310a   Default is 0.1.
-00004c30: 2020 2020 6e61 6e5f 6375 746f 6666 3a20      nan_cutoff: 
-00004c40: 2020 2020 666c 6f61 742c 206f 7074 696f      float, optio
-00004c50: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00004c60: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00004c70: 7220 7468 6174 2069 7320 7573 6564 2066  r that is used f
-00004c80: 6f72 2074 6872 6573 686f 6c64 696e 6720  or thresholding 
-00004c90: 6469 736b 0a20 2020 2020 2020 2020 2020  disk.           
-00004ca0: 2020 2020 2020 2020 2066 6974 732e 2049           fits. I
-00004cb0: 6620 7468 6520 696e 7465 6e73 6974 7920  f the intensity 
-00004cc0: 7261 7469 6f20 6973 2062 656c 6f77 2074  ratio is below t
-00004cd0: 6865 2074 6872 6573 686f 6c64 0a20 2020  he threshold.   
-00004ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004cf0: 2074 6865 2070 6f73 6974 696f 6e20 7769   the position wi
-00004d00: 6c6c 206e 6f74 2062 6520 6669 742e 2044  ll not be fit. D
-00004d10: 6566 6175 6c74 2076 616c 7565 2069 7320  efault value is 
-00004d20: 302e 350a 0a20 2020 2052 6574 7572 6e73  0.5..    Returns
-00004d30: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00004d40: 2065 5f78 785f 6d61 703a 206e 6461 7272   e_xx_map: ndarr
-00004d50: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-00004d60: 2053 7472 6169 6e20 696e 2074 6865 2078   Strain in the x
-00004d70: 7820 6469 7265 6374 696f 6e20 696e 2074  x direction in t
-00004d80: 6865 2072 6567 696f 6e20 6f66 2069 6e74  he region of int
-00004d90: 6572 6573 740a 2020 2020 655f 7879 5f6d  erest.    e_xy_m
-00004da0: 6170 3a20 6e64 6172 7261 790a 2020 2020  ap: ndarray.    
-00004db0: 2020 2020 2020 2020 2020 5374 7261 696e            Strain
-00004dc0: 2069 6e20 7468 6520 7879 2064 6972 6563   in the xy direc
-00004dd0: 7469 6f6e 2069 6e20 7468 6520 7265 6769  tion in the regi
-00004de0: 6f6e 206f 6620 696e 7465 7265 7374 0a20  on of interest. 
-00004df0: 2020 2065 5f74 685f 6d61 703a 206e 6461     e_th_map: nda
-00004e00: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00004e10: 2020 2041 6e67 756c 6172 2073 7472 6169     Angular strai
-00004e20: 6e20 696e 2074 6865 2072 6567 696f 6e20  n in the region 
-00004e30: 6f66 2069 6e74 6572 6573 740a 2020 2020  of interest.    
-00004e40: 655f 7979 5f6d 6170 3a20 6e64 6172 7261  e_yy_map: ndarra
-00004e50: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00004e60: 5374 7261 696e 2069 6e20 7468 6520 7979  Strain in the yy
-00004e70: 2064 6972 6563 7469 6f6e 2069 6e20 7468   direction in th
-00004e80: 6520 7265 6769 6f6e 206f 6620 696e 7465  e region of inte
-00004e90: 7265 7374 0a20 2020 2066 6974 5f73 7464  rest.    fit_std
-00004ea0: 3a20 206e 6461 7272 6179 0a20 2020 2020  :  ndarray.     
-00004eb0: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
-00004ec0: 2064 6576 6961 7469 6f6e 7320 696e 2061   deviations in a
-00004ed0: 7865 7320 6669 7474 696e 6720 666f 7220  xes fitting for 
-00004ee0: 7468 6520 7363 616e 2070 6f69 6e74 730a  the scan points.
-00004ef0: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-00004f00: 2d2d 2d2d 0a20 2020 2041 7420 6576 6572  ----.    At ever
-00004f10: 7920 7363 616e 2070 6f73 6974 696f 6e2c  y scan position,
-00004f20: 2074 6865 2064 6966 6672 6163 7469 6f6e   the diffraction
-00004f30: 2064 6973 6b20 6973 2066 696c 7465 7265   disk is filtere
-00004f40: 6420 6279 2066 6972 7374 2074 616b 696e  d by first takin
-00004f50: 670a 2020 2020 7468 6520 6c6f 6720 6f66  g.    the log of
-00004f60: 2074 6865 2043 4245 4420 7061 7474 6572   the CBED patter
-00004f70: 6e2c 2061 6e64 2074 6865 6e20 6279 2061  n, and then by a
-00004f80: 7070 6c79 696e 6720 6120 4761 7573 7369  pplying a Gaussi
-00004f90: 616e 2066 696c 7465 722e 0a20 2020 2046  an filter..    F
-00004fa0: 6f6c 6c6f 7769 6e67 2074 6869 7320 7468  ollowing this th
-00004fb0: 6520 536f 6265 6c20 6f66 2074 6865 2066  e Sobel of the f
-00004fc0: 696c 7465 7265 6420 6461 7461 7365 7420  iltered dataset 
-00004fd0: 6973 2063 616c 6375 6c61 7465 642e 0a20  is calculated.. 
-00004fe0: 2020 2054 6865 2069 6e74 656e 7369 7479     The intensity
-00004ff0: 206f 6620 7468 6520 536f 6265 6c2c 2047   of the Sobel, G
-00005000: 6175 7373 6961 6e20 616e 6420 4c6f 6720  aussian and Log 
-00005010: 6669 6c74 6572 6564 2043 4245 4420 6461  filtered CBED da
-00005020: 7461 2069 7320 7468 656e 0a20 2020 2069  ta is then.    i
-00005030: 6e73 7065 6374 6564 2066 6f72 206f 7574  nspected for out
-00005040: 6c69 6572 2070 6978 656c 732e 2049 6620  lier pixels. If 
-00005050: 7069 7865 6c20 696e 7465 6e73 6974 6965  pixel intensitie
-00005060: 7320 6172 6520 6869 6768 6572 206f 7220  s are higher or 
-00005070: 6c6f 7765 7220 7468 616e 0a20 2020 2061  lower than.    a
-00005080: 2074 6872 6573 686f 6c64 206f 6620 7468   threshold of th
-00005090: 6520 6d65 6469 616e 2070 6978 656c 2069  e median pixel i
-000050a0: 6e74 656e 7369 7479 2c20 7468 6579 2061  ntensity, they a
-000050b0: 7265 2072 6570 6c61 6365 6420 6279 2074  re replaced by t
-000050c0: 6865 2074 6872 6573 686f 6c64 0a20 2020  he threshold.   
-000050d0: 2076 616c 7565 2e20 5468 6973 2069 7320   value. This is 
-000050e0: 7468 656e 2068 7962 7269 6420 6372 6f73  then hybrid cros
-000050f0: 732d 636f 7272 656c 6174 6564 2077 6974  s-correlated wit
-00005100: 6820 7468 6520 536f 6265 6c20 6d61 676e  h the Sobel magn
-00005110: 6974 7564 6520 6f66 2074 6865 0a20 2020  itude of the.   
-00005120: 2074 656d 706c 6174 6520 6469 736b 2e20   template disk. 
-00005130: 4966 2074 6865 2070 6174 7465 726e 2061  If the pattern a
-00005140: 7865 7320 7265 7475 726e 2061 206e 756d  xes return a num
-00005150: 6572 6963 616c 2076 616c 7565 2c20 7468  erical value, th
-00005160: 656e 2074 6865 2073 7472 6169 6e0a 2020  en the strain.  
-00005170: 2020 6973 2063 616c 6375 6c61 7465 6420    is calculated 
-00005180: 666f 7220 7468 6174 2073 6361 6e20 706f  for that scan po
-00005190: 7369 7469 6f6e 2c20 656c 7365 2069 7420  sition, else it 
-000051a0: 6973 204e 614e 0a20 2020 2072 9000 0000  is NaN.    r....
-000051b0: 7201 0000 0072 2500 0000 7226 0000 004e  r....r%...r&...N
-000051c0: 7206 0000 0072 1600 0000 7257 0000 0072  r....r....rW...r
-000051d0: 3800 0000 a901 da0a 6879 6272 6964 697a  8.......hybridiz
-000051e0: 6572 7286 0000 0072 9100 0000 7239 0000  err....r....r9..
-000051f0: 00a9 0272 2700 0000 7227 0000 0072 2700  ...r'...r'...r'.
-00005200: 0000 2920 7293 0000 0072 9400 0000 7209  ..) r....r....r.
-00005210: 0000 0072 6d00 0000 7219 0000 0072 0a00  ...rm...r....r..
-00005220: 0000 721d 0000 0072 1e00 0000 7272 0000  ..r....r....rr..
-00005230: 00da 0270 69da 0365 7965 7242 0000 0072  ...pi..eyerB...r
-00005240: 8c00 0000 da05 736f 6265 6c72 9500 0000  ......sobelr....
-00005250: 728d 0000 005a 096f 6e65 735f 6c69 6b65  r....Z.ones_like
-00005260: 722d 0000 00da 046d 6561 6eda 0f69 6d61  r-.....mean..ima
-00005270: 6765 5f6c 6f67 6172 697a 6572 727e 0000  ge_logarizerr~..
-00005280: 00da 0a63 726f 7373 5f63 6f72 7272 a500  ...cross_corrr..
-00005290: 0000 7298 0000 00da 0369 6e76 721b 0000  ..r......invr...
-000052a0: 0072 2f00 0000 7207 0000 00da 0f67 6175  .r/...r......gau
-000052b0: 7373 6961 6e5f 6669 6c74 6572 7297 0000  ssian_filterr...
-000052c0: 00da 0572 6176 656c 729a 0000 0029 2872  ...ravelr....)(r
-000052d0: 2900 0000 7284 0000 00da 0b63 656e 7465  )...r......cente
-000052e0: 725f 6469 736b da09 6469 736b 5f6c 6973  r_disk..disk_lis
-000052f0: 74da 0870 6f73 5f6c 6973 74da 0e72 6566  t..pos_list..ref
-00005300: 6572 656e 6365 5f61 7865 73da 0a6d 6564  erence_axes..med
-00005310: 5f66 6163 746f 72da 0967 6175 7373 5f76  _factor..gauss_v
-00005320: 616c da09 6879 6272 6964 5f63 6372 a000  al..hybrid_ccr..
-00005330: 0000 5a06 7363 616e 5f79 5a06 7363 616e  ..Z.scan_yZ.scan
-00005340: 5f78 721f 0000 00da 0b6e 6f5f 6f66 5f64  _xr......no_of_d
-00005350: 6973 6b73 729e 0000 00da 0869 5f6d 6174  isksr......i_mat
-00005360: 7269 78da 1173 6f62 656c 5f63 656e 7465  rix..sobel_cente
-00005370: 725f 6469 736b 72a4 0000 00da 0865 5f78  r_diskr......e_x
-00005380: 785f 524f 49da 0865 5f78 795f 524f 49da  x_ROI..e_xy_ROI.
-00005390: 0865 5f74 685f 524f 49da 0865 5f79 795f  .e_th_ROI..e_yy_
-000053a0: 524f 495a 0766 6974 5f73 7464 da08 655f  ROIZ.fit_std..e_
-000053b0: 7878 5f6d 6170 da08 655f 7879 5f6d 6170  xx_map..e_xy_map
-000053c0: da08 655f 7468 5f6d 6170 da08 655f 7979  ..e_th_map..e_yy
-000053d0: 5f6d 6170 da09 6d65 616e 5f63 6265 645a  _map..mean_cbedZ
-000053e0: 0d73 6f62 656c 5f6c 6d5f 6362 6564 5a08  .sobel_lm_cbedZ.
-000053f0: 6c73 635f 6d65 616e da09 6d65 616e 5f61  lsc_mean..mean_a
-00005400: 7865 73da 0c69 6e76 6572 7365 5f61 7865  xes..inverse_axe
-00005410: 7372 2200 0000 7273 0000 005a 1173 6f62  sr"...rs...Z.sob
-00005420: 656c 5f6c 6f67 5f70 6174 7465 726e 5a0b  el_log_patternZ.
-00005430: 6c73 635f 7061 7474 6572 6e72 9b00 0000  lsc_patternr....
-00005440: da0c 7061 7474 6572 6e5f 6178 6573 da09  ..pattern_axes..
-00005450: 745f 7061 7474 6572 6eda 0973 5f70 6174  t_pattern..s_pat
-00005460: 7465 726e 720f 0000 0072 0f00 0000 7210  ternr....r....r.
-00005470: 0000 00da 0d73 7472 6169 6e5f 696e 5f52  .....strain_in_R
-00005480: 4f49 3b02 0000 738a 0000 0000 4e0a 0226  OI;...s.....N..&
-00005490: 0120 010a 011c 0112 0110 0216 0116 0116  . ..............
-000054a0: 0116 011a 0110 0110 0110 0110 0310 010e  ................
-000054b0: 0118 0308 fe02 0110 ff02 0306 0106 ff06  ................
-000054c0: 0316 010e 020c 0112 0116 0106 0112 ff08  ................
-000054d0: 050c fe02 0110 ff02 050c fe02 0110 ff02  ................
-000054e0: 0306 0106 ff06 0302 010a ff0c 0318 0110  ................
-000054f0: 010c 0108 010e 0116 0114 0112 0108 010e  ................
-00005500: 010c 0108 010e 010c 0108 010e 010c 0108  ................
-00005510: 010e 010c 0172 cc00 0000 6306 0000 0000  .....r....c.....
-00005520: 0000 0000 0000 001a 0000 0006 0000 0043  ...............C
-00005530: 0000 0073 aa01 0000 7400 a001 6401 a101  ...s....t...d...
-00005540: 0100 7c00 6a02 6402 1900 7d06 7403 a004  ..|.j.d...}.t...
-00005550: 7c01 a101 7403 6a05 1b00 6403 1300 7d07  |...t.j...d...}.
-00005560: 7403 a006 6404 a101 a007 7403 6a08 a101  t...d.....t.j...
-00005570: 7d08 7403 6a09 7c06 7403 6a08 6405 8d02  }.t.j.|.t.j.d...
-00005580: 7d09 7403 6a09 7c06 7403 6a08 6405 8d02  }.t.j.|.t.j.d...
-00005590: 7d0a 7403 6a09 7c06 7403 6a08 6405 8d02  }.t.j.|.t.j.d...
-000055a0: 7d0b 7403 6a09 7c06 7403 6a08 6405 8d02  }.t.j.|.t.j.d...
-000055b0: 7d0c 7403 a00a 7c04 a101 6404 6b00 72da  }.t...|...d.k.r.
-000055c0: 7403 6a0b 7c00 6402 6406 8d02 7d0d 740c  t.j.|.d.d...}.t.
-000055d0: 6a0d a00e 7c0d a101 5c02 7d0e 7d0f 740c  j...|...\.}.}.t.
-000055e0: 6a0d 6a0f 7c0e 7c01 6407 6408 8d03 7d10  j.j.|.|.d.d...}.
-000055f0: 7410 7c10 7c07 7c02 7c03 8304 5c03 7d0f  t.|.|.|.|...\.}.
-00005600: 7d0f 7d11 7403 6a11 a012 7c11 a101 7d12  }.}.t.j...|...}.
-00005610: 6e0c 7403 6a11 a012 7c04 a101 7d12 7413  n.t.j...|...}.t.
-00005620: 7414 7c06 8301 8301 4400 5daa 7d13 7c00  t.|.....D.].}.|.
-00005630: 6400 6400 8502 6400 6400 8502 7c13 6603  d.d...d.d...|.f.
-00005640: 1900 7d14 740c 6a0d a00e 7c14 a101 5c02  ..}.t.j...|...\.
-00005650: 7d15 7d0f 740c 6a0d 6a0f 7c15 7c01 6407  }.}.t.j.j.|.|.d.
-00005660: 6408 8d03 7d16 7410 7c16 7c07 7c02 7c03  d...}.t.|.|.|.|.
-00005670: 8304 5c03 7d0f 7d0f 7d17 7403 a015 7c17  ..\.}.}.}.t...|.
-00005680: 7c12 a102 7d18 7c18 7c08 1800 7d19 7c19  |...}.|.|...}.|.
-00005690: 6409 1900 0b00 7c09 7c13 3c00 7c19 640a  d.....|.|.<.|.d.
-000056a0: 1900 7c19 640b 1900 1700 0b00 7c0a 7c13  ..|.d.......|.|.
-000056b0: 3c00 7c19 640a 1900 7c19 640b 1900 1800  <.|.d...|.d.....
-000056c0: 7c0b 7c13 3c00 7c19 640c 1900 0b00 7c0c  |.|.<.|.d.....|.
-000056d0: 7c13 3c00 71f2 7c09 7c0a 7c0b 7c0c 6604  |.<.q.|.|.|.|.f.
-000056e0: 5300 a90d 4e72 9000 0000 7206 0000 0072  S...Nr....r....r
-000056f0: 1600 0000 7225 0000 0072 5700 0000 7238  ....r%...rW...r8
-00005700: 0000 0072 a700 0000 72a8 0000 0072 8600  ...r....r....r..
-00005710: 0000 7291 0000 0072 3900 0000 72aa 0000  ..r....r9...r...
-00005720: 0029 1672 9300 0000 7294 0000 0072 1900  .).r....r....r..
-00005730: 0000 7209 0000 0072 0a00 0000 72ab 0000  ..r....r....r...
-00005740: 0072 ac00 0000 7242 0000 0072 8c00 0000  .r....rB...r....
-00005750: 722e 0000 0072 2d00 0000 72ae 0000 0072  r....r-...r....r
-00005760: 1d00 0000 721e 0000 0072 af00 0000 72b0  ....r....r....r.
-00005770: 0000 0072 a500 0000 7298 0000 0072 b100  ...r....r....r..
-00005780: 0000 721b 0000 0072 2f00 0000 729a 0000  ..r....r/...r...
-00005790: 0029 1a72 1f00 0000 72b4 0000 0072 b500  .).r....r....r..
-000057a0: 0000 72b6 0000 0072 b700 0000 72b8 0000  ..r....r....r...
-000057b0: 0072 bb00 0000 729e 0000 0072 bc00 0000  .r....r....r....
-000057c0: 5a08 655f 7878 5f6c 6f67 5a08 655f 7879  Z.e_xx_logZ.e_xy
-000057d0: 5f6c 6f67 5a08 655f 7468 5f6c 6f67 5a08  _logZ.e_th_logZ.
-000057e0: 655f 7979 5f6c 6f67 72c6 0000 00da 086c  e_yy_logr......l
-000057f0: 6f67 5f63 6265 6472 a400 0000 5a0b 6c6f  og_cbedr....Z.lo
-00005800: 675f 6363 5f6d 6561 6e72 c700 0000 72c8  g_cc_meanr....r.
-00005810: 0000 0072 2200 0000 7273 0000 005a 0b6c  ...r"...rs...Z.l
-00005820: 6f67 5f70 6174 7465 726e 5a0e 6c6f 675f  og_patternZ.log_
-00005830: 6363 5f70 6174 7465 726e 72c9 0000 0072  cc_patternr....r
-00005840: ca00 0000 72cb 0000 0072 0f00 0000 720f  ....r....r....r.
-00005850: 0000 0072 1000 0000 da0a 7374 7261 696e  ...r......strain
-00005860: 5f6c 6f67 d202 0000 733a 0000 0000 030a  _log....s:......
-00005870: 020a 0114 0112 0210 0110 0110 0110 030e  ................
-00005880: 010e 0110 0112 0114 010e 020c 0110 0116  ................
-00005890: 0110 0112 0102 0108 ff0a 030c 0108 010e  ................
-000058a0: 0116 0114 0110 0172 cf00 0000 6305 0000  .......r....c...
-000058b0: 0000 0000 0000 0000 0017 0000 0006 0000  ................
-000058c0: 0043 0000 0073 8a01 0000 7400 a001 6401  .C...s....t...d.
-000058d0: a101 0100 7c00 6a02 6402 1900 7d05 7403  ....|.j.d...}.t.
-000058e0: a004 7c01 a101 7403 6a05 1b00 6403 1300  ..|...t.j...d...
-000058f0: 7d06 7403 a006 6404 a101 a007 7403 6a08  }.t...d.....t.j.
-00005900: a101 7d07 7403 6a09 7c05 7403 6a08 6405  ..}.t.j.|.t.j.d.
-00005910: 8d02 7d08 7403 6a09 7c05 7403 6a08 6405  ..}.t.j.|.t.j.d.
-00005920: 8d02 7d09 7403 6a09 7c05 7403 6a08 6405  ..}.t.j.|.t.j.d.
-00005930: 8d02 7d0a 7403 6a09 7c05 7403 6a08 6405  ..}.t.j.|.t.j.d.
-00005940: 8d02 7d0b 7403 a00a 7c04 a101 6404 6b00  ..}.t...|...d.k.
-00005950: 72ca 7403 6a0b 7c00 6402 6406 8d02 7d0c  r.t.j.|.d.d...}.
-00005960: 740c 6a0d 6a0e 7c0c 7c01 6407 6408 8d03  t.j.j.|.|.d.d...
-00005970: 7d0d 740f 7c0d 7c06 7c02 7c03 8304 5c03  }.t.|.|.|.|...\.
-00005980: 7d0e 7d0e 7d0f 7403 6a10 a011 7c0f a101  }.}.}.t.j...|...
-00005990: 7d10 6e0c 7403 6a10 a011 7c04 a101 7d10  }.n.t.j...|...}.
-000059a0: 7412 7413 7c05 8301 8301 4400 5d9a 7d11  t.t.|.....D.].}.
-000059b0: 7c00 6400 6400 8502 6400 6400 8502 7c11  |.d.d...d.d...|.
-000059c0: 6603 1900 7d12 740c 6a0d 6a0e 7c12 7c01  f...}.t.j.j.|.|.
-000059d0: 6407 6408 8d03 7d13 740f 7c13 7c06 7c02  d.d...}.t.|.|.|.
-000059e0: 7c03 8304 5c03 7d0e 7d0e 7d14 7403 a014  |...\.}.}.}.t...
-000059f0: 7c14 7c10 a102 7d15 7c15 7c07 1800 7d16  |.|...}.|.|...}.
-00005a00: 7c16 6409 1900 0b00 7c08 7c11 3c00 7c16  |.d.....|.|.<.|.
-00005a10: 640a 1900 7c16 640b 1900 1700 0b00 7c09  d...|.d.......|.
-00005a20: 7c11 3c00 7c16 640a 1900 7c16 640b 1900  |.<.|.d...|.d...
-00005a30: 1800 7c0a 7c11 3c00 7c16 640c 1900 0b00  ..|.|.<.|.d.....
-00005a40: 7c0b 7c11 3c00 71e2 7c08 7c09 7c0a 7c0b  |.|.<.q.|.|.|.|.
-00005a50: 6604 5300 72cd 0000 0029 1572 9300 0000  f.S.r....).r....
-00005a60: 7294 0000 0072 1900 0000 7209 0000 0072  r....r....r....r
-00005a70: 0a00 0000 72ab 0000 0072 ac00 0000 7242  ....r....r....rB
-00005a80: 0000 0072 8c00 0000 722e 0000 0072 2d00  ...r....r....r-.
-00005a90: 0000 72ae 0000 0072 1d00 0000 721e 0000  ..r....r....r...
-00005aa0: 0072 b000 0000 72a5 0000 0072 9800 0000  .r....r....r....
-00005ab0: 72b1 0000 0072 1b00 0000 722f 0000 0072  r....r....r/...r
-00005ac0: 9a00 0000 2917 721f 0000 0072 b400 0000  ....).r....r....
-00005ad0: 72b5 0000 0072 b600 0000 72b7 0000 0072  r....r....r....r
-00005ae0: bb00 0000 729e 0000 0072 bc00 0000 72be  ....r....r....r.
-00005af0: 0000 0072 bf00 0000 72c0 0000 0072 c100  ...r....r....r..
-00005b00: 0000 72c6 0000 005a 0763 635f 6d65 616e  ..r....Z.cc_mean
-00005b10: 72a4 0000 0072 c700 0000 72c8 0000 0072  r....r....r....r
-00005b20: 2200 0000 7273 0000 005a 0a63 635f 7061  "...rs...Z.cc_pa
-00005b30: 7474 6572 6e72 c900 0000 72ca 0000 0072  tternr....r....r
-00005b40: cb00 0000 720f 0000 0072 0f00 0000 7210  ....r....r....r.
-00005b50: 0000 00da 0f73 7472 6169 6e5f 6f6c 6473  .....strain_olds
-00005b60: 7479 6c65 f902 0000 7332 0000 0000 010a  tyle....s2......
-00005b70: 020a 0114 0112 0210 0110 0110 0110 030e  ................
-00005b80: 010e 0112 0114 010e 020c 0110 0116 0112  ................
-00005b90: 0114 010c 0108 010e 0116 0114 0110 0172  ...............r
-00005ba0: d000 0000 6302 0000 0000 0000 0000 0000  ....c...........
-00005bb0: 0003 0000 0004 0000 0043 0000 0073 2400  .........C...s$.
-00005bc0: 0000 7400 6a01 7c01 7400 6a02 6401 8d02  ..t.j.|.t.j.d...
-00005bd0: 7d02 7c00 a003 7400 6a02 a101 7c02 7c01  }.|...t.j...|.|.
-00005be0: 3c00 7c02 5300 2902 7a3d 0a20 2020 2043  <.|.S.).z=.    C
-00005bf0: 6f6e 7665 7274 2074 6865 2073 7472 6169  onvert the strai
-00005c00: 6e20 696e 2074 6865 2052 4f49 2061 7272  n in the ROI arr
-00005c10: 6179 2074 6f20 6120 7374 7261 696e 206d  ay to a strain m
-00005c20: 6170 0a20 2020 2072 5700 0000 2904 7209  ap.    rW...).r.
-00005c30: 0000 0072 1a00 0000 728c 0000 0072 4200  ...r....r....rB.
-00005c40: 0000 2903 5a0a 7374 7261 696e 5f52 4f49  ..).Z.strain_ROI
-00005c50: 7284 0000 005a 0a73 7472 6169 6e5f 6d61  r....Z.strain_ma
-00005c60: 7072 0f00 0000 720f 0000 0072 1000 0000  pr....r....r....
-00005c70: da0e 524f 495f 7374 7261 696e 5f6d 6170  ..ROI_strain_map
-00005c80: 1a03 0000 7306 0000 0000 0410 0110 0172  ....s..........r
-00005c90: d100 0000 e920 0000 0063 0300 0000 0000  ..... ...c......
-00005ca0: 0000 0000 0000 0900 0000 0900 0000 4300  ..............C.
-00005cb0: 0000 73f6 0000 0064 017c 0213 007d 0374  ..s....d.|...}.t
-00005cc0: 00a0 017c 01a1 017d 0164 027c 017c 0164  ...|...}.d.|.|.d
-00005cd0: 036b 0019 0017 007c 017c 0164 036b 003c  .k.....|.|.d.k.<
-00005ce0: 0074 00a0 027c 01a1 017d 047c 0464 016b  .t...|...}.|.d.k
-00005cf0: 0072 4874 00a0 037c 0064 04a1 027d 0074  .rHt...|.d...}.t
-00005d00: 006a 047c 0074 006a 0564 058d 027d 0574  .j.|.t.j.d...}.t
-00005d10: 067c 006a 0774 087c 0164 0619 0083 0119  .|.j.t.|.d......
-00005d20: 0083 0144 005d 6e7d 0674 067c 006a 0774  ...D.]n}.t.|.j.t
-00005d30: 087c 0164 0319 0083 0119 0083 0144 005d  .|.d.........D.]
-00005d40: 527d 0774 096a 0aa0 0b7c 0064 0764 0785  R}.t.j...|.d.d..
-00005d50: 0264 0764 0785 027c 077c 0666 0419 00a1  .d.d...|.|.f....
-00005d60: 017d 0864 067c 0364 0618 007c 0814 0017  .}.d.|.d...|....
-00005d70: 007d 0874 00a0 0c7c 08a1 017c 0564 0764  .}.t...|...|.d.d
-00005d80: 0785 0264 0764 0785 027c 077c 0666 043c  ...d.d...|.|.f.<
-00005d90: 0071 8871 6e7c 0464 016b 0072 f274 00a0  .q.qn|.d.k.r.t..
-00005da0: 037c 0564 04a1 027d 057c 0553 0029 0861  .|.d...}.|.S.).a
-00005db0: 5403 0000 0a20 2020 2054 616b 6520 7468  T....    Take th
-00005dc0: 6520 4c6f 6761 7269 7468 6d20 6f66 2061  e Logarithm of a
-00005dd0: 2034 4420 6461 7461 7365 742e 0a0a 2020   4D dataset...  
-00005de0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00005df0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00005e00: 6461 7461 3444 3a20 2020 2020 6e64 6172  data4D:     ndar
-00005e10: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00005e20: 2020 2020 3444 2064 6174 6173 6574 2077      4D dataset w
-00005e30: 686f 7365 2043 4245 4420 7061 7474 6572  hose CBED patter
-00005e40: 6e73 2077 696c 6c20 6265 2066 696c 7465  ns will be filte
-00005e50: 7265 640a 2020 2020 7363 616e 5f64 696d  red.    scan_dim
-00005e60: 733a 2020 7475 706c 650a 2020 2020 2020  s:  tuple.      
-00005e70: 2020 2020 2020 2020 2020 5363 616e 2064            Scan d
-00005e80: 696d 656e 7369 6f6e 732e 2049 6620 796f  imensions. If yo
-00005e90: 7572 2073 6361 6e6e 696e 6720 7069 7865  ur scanning pixe
-00005ea0: 6c73 2061 7265 2066 6f72 0a20 2020 2020  ls are for.     
-00005eb0: 2020 2020 2020 2020 2020 2065 7861 6d70             examp
-00005ec0: 6c65 2074 6865 2066 6972 7374 2074 776f  le the first two
-00005ed0: 2064 696d 656e 7369 6f6e 7320 7370 6563   dimensions spec
-00005ee0: 6966 7920 6974 2061 7320 2830 2c31 290a  ify it as (0,1).
-00005ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f00: 5769 6c6c 2062 6520 636f 6e76 6572 7465  Will be converte
-00005f10: 6420 746f 206e 756d 7079 2061 7272 6179  d to numpy array
-00005f20: 2073 6f20 7061 7373 2074 7570 6c65 206f   so pass tuple o
-00005f30: 6e6c 790a 2020 2020 6d65 645f 6661 6374  nly.    med_fact
-00005f40: 6f72 3a20 666c 6f61 742c 206f 7074 696f  or: float, optio
-00005f50: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00005f60: 2020 2020 4475 6520 746f 2064 6574 6563      Due to detec
-00005f70: 746f 7220 6e6f 6973 652c 2073 6f6d 6520  tor noise, some 
-00005f80: 7374 7261 7920 7069 7865 6c73 206d 6179  stray pixels may
-00005f90: 206f 6674 656e 0a20 2020 2020 2020 2020   often.         
-00005fa0: 2020 2020 2020 2062 6520 6272 6967 6874         be bright
-00005fb0: 6572 2074 6861 6e20 7468 6520 6261 636b  er than the back
-00005fc0: 6772 6f75 6e64 2e20 5468 6973 2069 7320  ground. This is 
-00005fd0: 7573 6564 2066 6f72 0a20 2020 2020 2020  used for.       
-00005fe0: 2020 2020 2020 2020 2064 616d 7069 6e67           damping
-00005ff0: 2061 6e79 2073 7563 6820 7069 7865 6c73   any such pixels
-00006000: 2e20 4465 6661 756c 7420 6973 2033 300a  . Default is 30.
-00006010: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00006020: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6174   -------.    dat
-00006030: 615f 6c6f 673a 206e 6461 7272 6179 0a20  a_log: ndarray. 
-00006040: 2020 2020 2020 2020 2020 2020 2034 4420               4D 
-00006050: 6461 7461 7365 7420 7768 6572 6520 6561  dataset where ea
-00006060: 6368 2043 4245 4420 7061 7474 6572 6e20  ch CBED pattern 
-00006070: 6861 7320 6265 656e 206c 6f67 0a0a 2020  has been log..  
-00006080: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00006090: 2d0a 2020 2020 4765 6e65 7261 7465 2074  -.    Generate t
-000060a0: 6865 206c 6f67 6172 6974 686d 206f 6620  he logarithm of 
-000060b0: 7468 6520 3444 2064 6174 6173 6574 2e0a  the 4D dataset..
-000060c0: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-000060d0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 206c    --------.    l
-000060e0: 6f67 5f73 6f62 656c 3444 0a20 2020 2075  og_sobel4D.    u
-000060f0: 7469 6c2e 696d 6167 655f 6c6f 6761 7269  til.image_logari
-00006100: 7a65 720a 2020 2020 7225 0000 0072 6100  zer.    r%...ra.
-00006110: 0000 7201 0000 0072 2400 0000 7257 0000  ..r....r$...rW..
-00006120: 0072 2700 0000 4e29 0d72 0900 0000 7218  .r'...N).r....r.
-00006130: 0000 0072 0a00 0000 7228 0000 0072 1a00  ...r....r(...r..
-00006140: 0000 5a07 666c 6f61 7433 3272 1b00 0000  ..Z.float32r....
-00006150: 7219 0000 0072 2f00 0000 721d 0000 0072  r....r/...r....r
-00006160: 1e00 0000 7272 0000 00da 046c 6f67 3229  ....rr.....log2)
-00006170: 0972 2900 0000 da09 7363 616e 5f64 696d  .r).....scan_dim
-00006180: 73da 0962 6974 5f64 6570 7468 5a07 6269  s..bit_depthZ.bi
-00006190: 745f 6d61 78da 0873 756d 5f64 696d 735a  t_max..sum_dimsZ
-000061a0: 0864 6174 615f 6c6f 67da 026a 6a72 2200  .data_log..jjr".
-000061b0: 0000 7273 0000 0072 0f00 0000 720f 0000  ..rs...r....r...
-000061c0: 0072 1000 0000 da0b 6c6f 6761 7269 7a65  .r......logarize
-000061d0: 7234 4423 0300 0073 1e00 0000 001f 0801  r4D#...s........
-000061e0: 0a01 1801 0a01 0801 0c01 1001 1a01 1a01  ................
-000061f0: 2001 1001 2201 0801 0c01 72d8 0000 00e9   ...".....r.....
-00006200: 1e00 0000 6304 0000 0000 0000 0000 0000  ....c...........
-00006210: 000b 0000 0009 0000 0043 0000 0073 4801  .........C...sH.
-00006220: 0000 7400 a001 7c01 a101 7d01 6401 7c01  ..t...|...}.d.|.
-00006230: 7c01 6402 6b00 1900 1700 7c01 7c01 6402  |.d.k.....|.|.d.
-00006240: 6b00 3c00 7400 a002 7c01 a101 7d04 7c04  k.<.t...|...}.|.
-00006250: 6403 6b00 7240 7400 a003 7c00 6404 a102  d.k.r@t...|.d...
-00006260: 7d00 7400 6a04 7c00 7400 6a05 6405 8d02  }.t.j.|.t.j.d...
-00006270: 7d05 7406 7c00 6a07 7408 7c01 6406 1900  }.t.|.j.t.|.d...
-00006280: 8301 1900 8301 4400 5dc6 7d06 7406 7c00  ......D.].}.t.|.
-00006290: 6a07 7408 7c01 6402 1900 8301 1900 8301  j.t.|.d.........
-000062a0: 4400 5daa 7d07 7c00 6407 6407 8502 6407  D.].}.|.d.d...d.
-000062b0: 6407 8502 7c07 7c06 6604 1900 7d08 6408  d...|.|.f...}.d.
-000062c0: 6406 7409 6a0a a00b 7c08 a101 1700 1400  d.t.j...|.......
-000062d0: 7d08 7409 6a0a a00c 740d a00e 7409 6a0a  }.t.j...t...t.j.
-000062e0: a00f 7c08 a101 7c03 a102 6409 a102 5c02  ..|...|...d...\.
-000062f0: 7d09 7d0a 7400 a010 7c09 a101 7c02 1400  }.}.t...|...|...
-00006300: 7c09 7c09 7c02 7400 a010 7c09 a101 1400  |.|.|.t...|.....
-00006310: 6b04 3c00 7400 a010 7c09 a101 7c02 1b00  k.<.t...|...|...
-00006320: 7c09 7c09 7400 a010 7c09 a101 7c02 1b00  |.|.t...|...|...
-00006330: 6b00 3c00 7c09 7c05 6407 6407 8502 6407  k.<.|.|.d.d...d.
-00006340: 6407 8502 7c07 7c06 6604 3c00 7180 7166  d...|.|.f.<.q.qf
-00006350: 7c04 6403 6b00 9001 7244 7400 a003 7c05  |.d.k...rDt...|.
-00006360: 6404 a102 7d05 7c05 5300 290a 6136 0600  d...}.|.S.).a6..
-00006370: 000a 2020 2020 5461 6b65 2074 6865 204c  ..    Take the L
-00006380: 6f67 2d53 6f62 656c 206f 6620 6120 7061  og-Sobel of a pa
-00006390: 7474 6572 6e2e 0a0a 2020 2020 5061 7261  ttern...    Para
-000063a0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-000063b0: 2d2d 2d2d 2d0a 2020 2020 6461 7461 3444  -----.    data4D
-000063c0: 3a20 2020 2020 6e64 6172 7261 790a 2020  :     ndarray.  
-000063d0: 2020 2020 2020 2020 2020 2020 2020 3444                4D
-000063e0: 2064 6174 6173 6574 2077 686f 7365 2043   dataset whose C
-000063f0: 4245 4420 7061 7474 6572 6e73 2077 696c  BED patterns wil
-00006400: 6c20 6265 2066 696c 7465 7265 640a 2020  l be filtered.  
-00006410: 2020 7363 616e 5f64 696d 733a 2020 7475    scan_dims:  tu
-00006420: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
-00006430: 2020 2020 5363 616e 2064 696d 656e 7369      Scan dimensi
-00006440: 6f6e 732e 2049 6620 796f 7572 2073 6361  ons. If your sca
-00006450: 6e6e 696e 6720 7069 7865 6c73 2061 7265  nning pixels are
-00006460: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-00006470: 2020 2020 2065 7861 6d70 6c65 2074 6865       example the
-00006480: 2066 6972 7374 2074 776f 2064 696d 656e   first two dimen
-00006490: 7369 6f6e 7320 7370 6563 6966 7920 6974  sions specify it
-000064a0: 2061 7320 2830 2c31 290a 2020 2020 2020   as (0,1).      
-000064b0: 2020 2020 2020 2020 2020 5769 6c6c 2062            Will b
-000064c0: 6520 636f 6e76 6572 7465 6420 746f 206e  e converted to n
-000064d0: 756d 7079 2061 7272 6179 2073 6f20 7061  umpy array so pa
-000064e0: 7373 2074 7570 6c65 206f 6e6c 790a 2020  ss tuple only.  
-000064f0: 2020 6d65 645f 6661 6374 6f72 3a20 666c    med_factor: fl
-00006500: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00006510: 2020 2020 2020 2020 2020 2020 2020 4475                Du
-00006520: 6520 746f 2064 6574 6563 746f 7220 6e6f  e to detector no
-00006530: 6973 652c 2073 6f6d 6520 7374 7261 7920  ise, some stray 
-00006540: 7069 7865 6c73 206d 6179 206f 6674 656e  pixels may often
-00006550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006560: 2062 6520 6272 6967 6874 6572 2074 6861   be brighter tha
-00006570: 6e20 7468 6520 6261 636b 6772 6f75 6e64  n the background
-00006580: 2e20 5468 6973 2069 7320 7573 6564 2066  . This is used f
-00006590: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-000065a0: 2020 2064 616d 7069 6e67 2061 6e79 2073     damping any s
-000065b0: 7563 6820 7069 7865 6c73 2e20 4465 6661  uch pixels. Defa
-000065c0: 756c 7420 6973 2033 300a 2020 2020 6761  ult is 30.    ga
-000065d0: 7573 735f 7661 6c3a 2020 666c 6f61 742c  uss_val:  float,
-000065e0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000065f0: 2020 2020 2020 2020 2020 5468 6520 7374            The st
-00006600: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00006610: 206f 6620 7468 6520 4761 7573 7369 616e   of the Gaussian
-00006620: 2066 696c 7465 7220 6170 706c 6965 640a   filter applied.
-00006630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006640: 746f 2074 6865 206c 6f67 6172 6974 686d  to the logarithm
-00006650: 206f 6620 7468 6520 4342 4544 2070 6174   of the CBED pat
-00006660: 7465 726e 2e20 4465 6661 756c 7420 6973  tern. Default is
-00006670: 2033 0a0a 2020 2020 5265 7475 726e 730a   3..    Returns.
-00006680: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00006690: 6461 7461 5f6c 7362 3a20 6e64 6172 7261  data_lsb: ndarra
-000066a0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-000066b0: 3444 2064 6174 6173 6574 2077 6865 7265  4D dataset where
-000066c0: 2065 6163 6820 4342 4544 2070 6174 7465   each CBED patte
-000066d0: 726e 2068 6173 2062 6565 6e20 6c6f 670a  rn has been log.
-000066e0: 2020 2020 2020 2020 2020 2020 2020 536f                So
-000066f0: 6265 6c20 6669 6c74 6572 6564 0a0a 2020  bel filtered..  
-00006700: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00006710: 2d0a 2020 2020 4765 6e65 7261 7465 2074  -.    Generate t
-00006720: 6865 2053 6f62 656c 2066 696c 7465 7265  he Sobel filtere
-00006730: 6420 7061 7474 6572 6e20 6f66 2074 6865  d pattern of the
-00006740: 206c 6f67 6172 6974 686d 206f 660a 2020   logarithm of.  
-00006750: 2020 6120 6461 7461 7365 742e 2043 6f6d    a dataset. Com
-00006760: 7061 7265 6420 746f 2072 756e 6e69 6e67  pared to running
-00006770: 2074 6865 2053 6f62 656c 2066 696c 7465   the Sobel filte
-00006780: 7220 6261 636b 206f 6e0a 2020 2020 6120  r back on.    a 
-00006790: 6c6f 6720 6461 7461 7365 742c 2074 6869  log dataset, thi
-000067a0: 7320 7461 6b65 7320 6361 7265 206f 6620  s takes care of 
-000067b0: 736f 6d65 7468 696e 6773 202d 206e 6f74  somethings - not
-000067c0: 6162 6c79 0a20 2020 2061 2047 6175 7373  ably.    a Gauss
-000067d0: 6961 6e20 626c 7572 2069 7320 6170 706c  ian blur is appl
-000067e0: 6965 6420 746f 2074 6865 2069 6d61 6765  ied to the image
-000067f0: 2c20 616e 6420 536f 6265 6c20 7370 696b  , and Sobel spik
-00006800: 6573 0a20 2020 2061 7265 2072 656d 6f76  es.    are remov
-00006810: 6564 2077 6865 6e20 616e 7920 7661 6c75  ed when any valu
-00006820: 6573 2061 7265 2074 6f6f 2068 6967 6865  es are too highe
-00006830: 7220 6f72 206c 6f77 6572 2074 6861 6e0a  r or lower than.
-00006840: 2020 2020 7468 6520 6d65 6469 616e 206f      the median o
-00006850: 6620 7468 6520 696d 6167 652e 2054 6869  f the image. Thi
-00006860: 7320 6973 2062 6563 6175 7365 2072 6561  s is because rea
-00006870: 6c20 6465 7465 6374 6f72 0a20 2020 2069  l detector.    i
-00006880: 6d61 6765 7320 6f66 7465 6e20 6172 6520  mages often are 
-00006890: 7665 7279 206e 6f69 7379 2e20 5468 6973  very noisy. This
-000068a0: 2063 6f64 6520 6765 6e65 7261 7465 7320   code generates 
-000068b0: 7468 6520 6669 6c74 6572 6564 0a20 2020  the filtered.   
-000068c0: 2043 4245 4420 6174 2065 7665 7279 2073   CBED at every s
-000068d0: 6361 6e20 706f 7369 7469 6f6e 2c20 616e  can position, an
-000068e0: 6420 6973 2064 696d 656e 7369 6f6e 2061  d is dimension a
-000068f0: 676e 6f73 7469 632c 2069 6e0a 2020 2020  gnostic, in.    
-00006900: 7468 6174 2079 6f75 7220 4342 4544 2064  that your CBED d
-00006910: 696d 656e 7369 6f6e 7320 6361 6e20 6569  imensions can ei
-00006920: 7468 6572 2062 6520 7468 6520 6669 7273  ther be the firs
-00006930: 7420 7477 6f20 6f72 206c 6173 740a 2020  t two or last.  
-00006940: 2020 7477 6f20 2d20 6a75 7374 2073 7065    two - just spe
-00006950: 6369 6679 2074 6865 2064 696d 656e 7369  cify the dimensi
-00006960: 6f6e 732e 200a 0a20 2020 2053 6565 2041  ons. ..    See A
-00006970: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
-00006980: 0a20 2020 206c 6f67 6172 697a 6572 3444  .    logarizer4D
-00006990: 0a20 2020 2064 7063 2e6c 6f67 5f73 6f62  .    dpc.log_sob
-000069a0: 656c 0a20 2020 2072 6100 0000 7201 0000  el.    ra...r...
-000069b0: 0072 2500 0000 7224 0000 0072 5700 0000  .r%...r$...rW...
-000069c0: 7227 0000 004e e9e8 0300 0072 0200 0000  r'...N.....r....
-000069d0: 2911 7209 0000 0072 1800 0000 720a 0000  ).r....r....r...
-000069e0: 0072 2800 0000 721a 0000 00da 0566 6c6f  .r(...r......flo
-000069f0: 6174 721b 0000 0072 1900 0000 722f 0000  atr....r....r/..
-00006a00: 0072 1d00 0000 721e 0000 0072 7200 0000  .r....r....rr...
-00006a10: 72ad 0000 0072 0700 0000 72b2 0000 0072  r....r....r....r
-00006a20: af00 0000 727e 0000 0029 0b72 2900 0000  ....r~...).r)...
-00006a30: 72d4 0000 0072 b800 0000 72b9 0000 0072  r....r....r....r
-00006a40: d600 0000 5a08 6461 7461 5f6c 7362 72d7  ....Z.data_lsbr.
-00006a50: 0000 0072 2200 0000 7273 0000 005a 0b6c  ...r"...rs...Z.l
-00006a60: 7362 5f70 6174 7465 726e 72a4 0000 0072  sb_patternr....r
-00006a70: 0f00 0000 720f 0000 0072 1000 0000 da0b  ....r....r......
-00006a80: 6c6f 675f 736f 6265 6c34 4453 0300 0073  log_sobel4DS...s
-00006a90: 2a00 0000 002c 0a01 1801 0a01 0801 0c01  *....,..........
-00006aa0: 1001 1a01 1a01 1801 1401 0601 14ff 0804  ................
-00006ab0: 0cff 1404 0cff 1403 1c01 0a01 0c01 72dc  ..............r.
-00006ac0: 0000 0063 0300 0000 0000 0000 0000 0000  ...c............
-00006ad0: 0600 0000 0a00 0000 4300 0000 73b2 0000  ........C...s...
-00006ae0: 0074 00a0 0174 006a 027c 0064 0064 0085  .t...t.j.|.d.d..
-00006af0: 0264 0064 0085 027c 0164 0119 007c 0164  .d.d...|.d...|.d
-00006b00: 0219 0085 027c 0264 0119 007c 0264 0219  .....|.d...|.d..
-00006b10: 0085 0266 0419 0064 0374 006a 0364 048d  ...f...d.t.j.d..
-00006b20: 03a1 017d 0374 006a 047c 0064 0564 068d  ...}.t.j.|.d.d..
-00006b30: 027d 047c 0474 00a0 057c 04a1 0118 0074  .}.|.t...|.....t
-00006b40: 00a0 067c 04a1 0174 00a0 057c 04a1 0118  ...|...t...|....
-00006b50: 001b 007d 0474 00a0 077c 04a1 017d 0564  ...}.t...|...}.d
-00006b60: 027c 057c 0164 0119 007c 0164 0219 0085  .|.|.d...|.d....
-00006b70: 027c 0264 0119 007c 0264 0219 0085 0266  .|.d...|.d.....f
-00006b80: 023c 007c 0364 077c 047c 0517 0014 0066  .<.|.d.|.|.....f
-00006b90: 0253 0029 084e 7201 0000 0072 2700 0000  .S.).Nr....r'...
-00006ba0: a902 7206 0000 0072 1700 0000 2902 720c  ..r....r....).r.
-00006bb0: 0000 0072 4100 0000 7291 0000 0072 3800  ...rA...r....r8.
-00006bc0: 0000 7216 0000 0029 0872 0900 0000 72b3  ..r....).r....r.
-00006bd0: 0000 0072 ae00 0000 728c 0000 0072 0a00  ...r....r....r..
-00006be0: 0000 720b 0000 0072 8700 0000 721a 0000  ..r....r....r...
-00006bf0: 0029 0672 2900 0000 da05 7976 616c 73da  .).r).....yvals.
-00006c00: 0578 7661 6c73 5a0c 7370 6563 7472 615f  .xvalsZ.spectra_
-00006c10: 6461 7461 5a07 6461 7461 5f69 6d5a 076f  dataZ.data_imZ.o
-00006c20: 7665 726c 6179 720f 0000 0072 0f00 0000  verlayr....r....
-00006c30: 7210 0000 00da 0e73 7065 6374 7261 5f66  r......spectra_f
-00006c40: 696e 6465 7298 0300 0073 1800 0000 0001  inder....s......
-00006c50: 0401 0401 2e01 0201 04fd 04ff 0407 0e01  ................
-00006c60: 2201 0a01 2401 72e0 0000 0072 0200 0000  "...$.r....r....
-00006c70: 6302 0000 0000 0000 0000 0000 001d 0000  c...............
-00006c80: 0007 0000 0043 0000 0073 e202 0000 7400  .....C...s....t.
-00006c90: 6a01 6401 7400 a002 7c00 a101 6401 1900  j.d.t...|...d...
-00006ca0: 8502 6401 7400 a002 7c00 a101 6402 1900  ..d.t...|...d...
-00006cb0: 8502 6602 1900 5c02 7d02 7d03 7c02 7c00  ..f...\.}.}.|.|.
-00006cc0: 1900 7d04 7c03 7c00 1900 7d05 7400 a003  ..}.|.|...}.t...
-00006cd0: 7c04 a101 7d06 7400 a004 7c06 a101 7d07  |...}.t...|...}.
-00006ce0: 7400 a005 7400 a006 7c02 7c00 1900 7c03  t...t...|.|...|.
-00006cf0: 7c00 1900 6602 a101 a101 7d08 7400 6a07  |...f.....}.t.j.
-00006d00: 7c06 6403 6602 7408 6404 8d02 7d09 7400  |.d.f.t.d...}.t.
-00006d10: a007 7c06 6403 6602 a101 7d0a 6401 7d0b  ..|.d.f...}.d.}.
-00006d20: 7400 a006 7c04 6401 1900 7c05 6401 1900  t...|.d...|.d...
-00006d30: 6602 a101 7c0a 7409 7c0b 8301 6401 6403  f...|.t.|...d.d.
-00006d40: 8502 6602 3c00 6405 7c09 7409 7c0b 8301  ..f.<.d.|.t.|...
-00006d50: 6401 6403 8502 6602 3c00 6402 7d0c 7400  d.d...f.<.d.}.t.
-00006d60: a004 7c06 a101 4400 9001 5d22 7d0d 7c0a  ..|...D...]"}.|.
-00006d70: 7409 7c0c 6402 1800 8301 6401 6602 1900  t.|.d.....d.f...
-00006d80: 7d0e 7c0a 7409 7c0c 6402 1800 8301 6402  }.|.t.|.d.....d.
-00006d90: 6602 1900 7d0f 7400 a00a 7c08 7c09 0f00  f...}.t...|.|...
-00006da0: 1900 7409 7c06 7c0c 1800 8301 6403 6602  ..t.|.|.....d.f.
-00006db0: a102 7d10 7c10 6400 6400 8502 6401 6602  ..}.|.d.d...d.f.
-00006dc0: 1900 7c0e 1800 6403 1300 7c10 6400 6400  ..|...d...|.d.d.
-00006dd0: 8502 6402 6602 1900 7c0f 1800 6403 1300  ..d.f...|...d...
-00006de0: 1700 6406 1300 7d11 7400 a00b 7c11 a101  ..d...}.t...|...
-00006df0: 7d12 7c12 7c01 6b00 72da 7c10 7c11 7c12  }.|.|.k.r.|.|.|.
-00006e00: 6b02 6401 6602 1900 6401 1900 7d13 7c10  k.d.f...d...}.|.
-00006e10: 7c11 7c12 6b02 6402 6602 1900 6401 1900  |.|.k.d.f...d...
-00006e20: 7d14 7c07 7c08 6400 6400 8502 6401 6602  }.|.|.d.d...d.f.
-00006e30: 1900 7c13 6b02 7c08 6400 6400 8502 6402  ..|.k.|.d.d...d.
-00006e40: 6602 1900 7c14 6b02 4000 1900 6401 1900  f...|.k.@...d...
-00006e50: 7d0b 7400 a006 7c13 7c14 6602 a101 7c0a  }.t...|.|.f...|.
-00006e60: 7409 7c0c 8301 6401 6403 8502 6602 3c00  t.|...d.d...f.<.
-00006e70: 6405 7c09 7409 7c0b 8301 6401 6403 8502  d.|.t.|...d.d...
-00006e80: 6602 3c00 7c0c 6407 1700 7d0c 71da 7400  f.<.|.d...}.q.t.
-00006e90: a00a 7c08 7c09 1900 7409 7c0c 8301 6403  ..|.|...t.|...d.
-00006ea0: 6602 a102 7d15 7400 a00a 7c08 7c09 0f00  f...}.t...|.|...
-00006eb0: 1900 7409 7c06 7c0c 1800 8301 6403 6602  ..t.|.|.....d.f.
-00006ec0: a102 7d16 7400 a00c 7c00 a101 7d17 6402  ..}.t...|...}.d.
-00006ed0: 7c17 7c15 6400 6400 8502 6401 6602 1900  |.|.d.d...d.f...
-00006ee0: 7c15 6400 6400 8502 6402 6602 1900 6602  |.d.d...d.f...f.
-00006ef0: 3c00 7400 a00c 7c00 a101 7d18 6402 7c18  <.t...|...}.d.|.
-00006f00: 7c16 6400 6400 8502 6401 6602 1900 7c16  |.d.d...d.f...|.
-00006f10: 6400 6400 8502 6402 6602 1900 6602 3c00  d.d...d.f...f.<.
-00006f20: 7400 a00d 7c17 a101 7d19 7400 a00d 7c18  t...|...}.t...|.
-00006f30: a101 7d1a 7c19 7c1a 6b04 9002 72c6 7400  ..}.|.|.k...r.t.
-00006f40: a00e 7c17 a101 7d1b 7400 a00e 7c18 a101  ..|...}.t...|...
-00006f50: 7d1c 6e14 7400 a00e 7c18 a101 7d1b 7400  }.n.t...|...}.t.
-00006f60: a00e 7c17 a101 7d1c 7c1b 7c1c 6602 5300  ..|...}.|.|.f.S.
-00006f70: 2908 4e72 0100 0000 7227 0000 0072 2500  ).Nr....r'...r%.
-00006f80: 0000 7257 0000 0054 7216 0000 0067 0000  ..rW...Tr....g..
-00006f90: 0000 0000 f03f 290f 7209 0000 0072 6d00  .....?).r....rm.
-00006fa0: 0000 7219 0000 0072 2d00 0000 728b 0000  ..r....r-...r...
-00006fb0: 0072 2800 0000 7218 0000 0072 2e00 0000  .r(...r....r....
-00006fc0: 7280 0000 0072 2f00 0000 7205 0000 0072  r....r/...r....r
-00006fd0: 0b00 0000 721a 0000 0072 0a00 0000 7258  ....r....r....rX
-00006fe0: 0000 0029 1d5a 0865 6467 655f 6d61 705a  ...).Z.edge_mapZ
-00006ff0: 0d65 6467 655f 6469 7374 616e 6365 5a02  .edge_distanceZ.
-00007000: 7956 5a02 7856 7252 0000 0072 4f00 0000  yVZ.xVrR...rO...
-00007010: 5a09 6e6f 5f70 6f69 6e74 735a 0670 6f69  Z.no_pointsZ.poi
-00007020: 6e74 735a 0a70 6f69 6e74 5f6c 6973 745a  ntsZ.point_listZ
-00007030: 0a74 7275 7468 5f6c 6973 745a 0b65 6467  .truth_listZ.edg
-00007040: 655f 6c69 7374 5f31 5a0c 706f 696e 745f  e_list_1Z.point_
-00007050: 6e75 6d62 6572 5a0b 6564 6765 5f70 6f69  numberZ.edge_poi
-00007060: 6e74 7372 a400 0000 5a07 6c61 7374 5f79  ntsr....Z.last_y
-00007070: 795a 076c 6173 745f 7878 5a0c 6f74 6865  yZ.last_xxZ.othe
-00007080: 725f 706f 696e 7473 5a09 6469 7374 5f76  r_pointsZ.dist_v
-00007090: 616c 735a 086d 696e 5f64 6973 745a 046e  alsZ.min_distZ.n
-000070a0: 5f79 795a 046e 5f78 785a 066c 6973 745f  _yyZ.n_xxZ.list_
-000070b0: 315a 066c 6973 745f 325a 0565 6467 6531  1Z.list_2Z.edge1
-000070c0: 5a05 6564 6765 325a 0965 6467 6531 5f73  Z.edge2Z.edge1_s
-000070d0: 756d 5a09 6564 6765 325f 7375 6d5a 0a6f  umZ.edge2_sumZ.o
-000070e0: 7574 6572 5f65 6467 655a 0a69 6e6e 6572  uter_edgeZ.inner
-000070f0: 5f65 6467 6572 0f00 0000 720f 0000 0072  _edger....r....r
-00007100: 1000 0000 da0a 736f 7274 5f65 6467 6573  ......sort_edges
-00007110: a703 0000 7362 0000 0000 012e 0108 0108  ....sb..........
-00007120: 010a 010a 011c 0112 010e 0104 0126 0114  .............&..
-00007130: 0104 0110 0114 0114 0104 0116 ff04 0416  ................
-00007140: 0116 ff02 0202 fd04 040a 0108 0114 0114  ................
-00007150: 0102 0126 ff02 0202 fe04 031e 0114 010a  ...&............
-00007160: 0118 011e 010a 0124 010a 0124 010a 010a  .......$...$....
-00007170: 010a 010a 010c 020a 010a 0172 e100 0000  ...........r....
-00007180: e766 6666 6666 66ee 3f63 0200 0000 0000  .ffffff.?c......
-00007190: 0000 0000 0000 1600 0000 0900 0000 4300  ..............C.
-000071a0: 0000 7386 0200 0064 0174 00a0 017c 006a  ..s....d.t...|.j
-000071b0: 02a1 0114 00a0 0374 04a1 017d 0264 027c  .......t...}.d.|
-000071c0: 0274 00a0 017c 006a 02a1 0118 0014 00a0  .t...|.j........
-000071d0: 0374 04a1 017d 0374 00a0 057c 02a1 017d  .t...}.t...|...}
-000071e0: 047c 007c 047c 0364 0319 007c 0364 0319  .|.|.|.d...|.d..
-000071f0: 007c 006a 0264 0319 0017 0085 027c 0364  .|.j.d.......|.d
-00007200: 0419 007c 0364 0419 007c 006a 0264 0419  ...|.d...|.j.d..
-00007210: 0017 0085 0266 023c 007c 04a0 0374 06a1  .....f.<.|...t..
-00007220: 017d 0574 00a0 077c 04a1 01a0 0374 06a1  .}.t...|.....t..
-00007230: 017d 0674 006a 0864 037c 0264 0319 0085  .}.t.j.d.|.d....
-00007240: 0264 037c 0264 0419 0085 0266 0219 005c  .d.|.d.....f...\
-00007250: 027d 077d 0874 006a 057c 046a 0964 0566  .}.}.t.j.|.j.d.f
-00007260: 0274 0464 068d 027d 0974 00a0 0a7c 07a1  .t.d...}.t...|..
-00007270: 017c 0964 0064 0085 0264 0366 023c 0074  .|.d.d...d.f.<.t
-00007280: 00a0 0a7c 08a1 017c 0964 0064 0085 0264  ...|...|.d.d...d
-00007290: 0466 023c 007c 077c 0519 007d 0a7c 087c  .f.<.|.|...}.|.|
-000072a0: 0519 007d 0b7c 077c 0619 007d 0c7c 087c  ...}.|.|...}.|.|
-000072b0: 0619 007d 0d74 006a 0b7c 0774 006a 0c64  ...}.t.j.|.t.j.d
-000072c0: 068d 027d 0e74 006a 0b7c 0774 006a 0c64  ...}.t.j.|.t.j.d
-000072d0: 068d 027d 0f74 0d74 0e7c 0983 0183 0144  ...}.t.t.|.....D
-000072e0: 005d 607d 1064 0774 006a 0f1b 0074 00a0  .]`}.d.t.j...t..
-000072f0: 107c 0a7c 097c 1064 0366 0219 0018 007c  .|.|.|.d.f.....|
-00007300: 0b7c 097c 1064 0466 0219 0018 00a1 0214  .|.|.d.f........
-00007310: 007d 1174 00a0 117c 11a1 0174 00a0 127c  .}.t...|...t...|
-00007320: 11a1 0118 007c 0e7c 097c 1064 0366 0219  .....|.|.|.d.f..
-00007330: 007c 097c 1064 0466 0219 0066 023c 0090  .|.|.d.f...f.<..
-00007340: 0171 3a74 0d74 0e7c 0983 0183 0144 005d  .q:t.t.|.....D.]
-00007350: 607d 1264 0774 006a 0f1b 0074 00a0 107c  `}.d.t.j...t...|
-00007360: 0c7c 097c 1264 0366 0219 0018 007c 0d7c  .|.|.d.f.....|.|
-00007370: 097c 1264 0466 0219 0018 00a1 0214 007d  .|.d.f.........}
-00007380: 1374 00a0 117c 13a1 0174 00a0 127c 13a1  .t...|...t...|..
-00007390: 0118 007c 0f7c 097c 1264 0366 0219 007c  ...|.|.|.d.f...|
-000073a0: 097c 1264 0466 0219 0066 023c 0090 0171  .|.d.f...f.<...q
-000073b0: a874 00a0 077c 0fa1 017d 0f74 00a0 137c  .t...|...}.t...|
-000073c0: 0e7c 0174 00a0 117c 0ea1 0114 006b 047c  .|.t...|.....k.|
-000073d0: 0f7c 0174 00a0 117c 0fa1 0114 006b 04a1  .|.t...|.....k..
-000073e0: 027d 1474 006a 0b7c 0074 0664 068d 027d  .}.t.j.|.t.d...}
-000073f0: 157c 147c 0364 0319 007c 0364 0319 007c  .|.|.d...|.d...|
-00007400: 006a 0264 0319 0017 0085 027c 0364 0419  .j.d.......|.d..
-00007410: 007c 0364 0419 007c 006a 0264 0419 0017  .|.d...|.j.d....
-00007420: 0085 0266 0219 007d 157c 1553 0029 084e  ...f...}.|.S.).N
-00007430: 6700 0000 0000 0004 4072 1600 0000 7201  g.......@r....r.
-00007440: 0000 0072 2700 0000 7225 0000 0072 5700  ...r'...r%...rW.
-00007450: 0000 e9b4 0000 0029 1472 0900 0000 7218  .......).r....r.
-00007460: 0000 0072 1900 0000 7242 0000 0072 2f00  ...r....rB...r/.
-00007470: 0000 722e 0000 0072 8000 0000 5a06 666c  ..r....r....Z.fl
-00007480: 6970 6c72 726d 0000 0072 2d00 0000 72b3  iplrrm...r-...r.
-00007490: 0000 0072 1a00 0000 72db 0000 0072 1b00  ...r....r....r..
-000074a0: 0000 723a 0000 0072 ab00 0000 5a07 6172  ..r:...r....Z.ar
-000074b0: 6374 616e 3272 8700 0000 720b 0000 0072  ctan2r....r....r
-000074c0: 8800 0000 2916 5a05 6564 6765 73da 0663  ....).Z.edges..c
-000074d0: 7574 6f66 665a 0862 6967 5f73 697a 655a  utoffZ.big_sizeZ
-000074e0: 0773 7461 7274 6572 5a09 6269 6767 6572  .starterZ.bigger
-000074f0: 5f61 615a 0361 6131 5a03 6161 3272 5200  _aaZ.aa1Z.aa2rR.
-00007500: 0000 724f 0000 0072 9f00 0000 5a06 7979  ..rO...r....Z.yy
-00007510: 5f61 6131 5a06 7878 5f61 6131 5a06 7979  _aa1Z.xx_aa1Z.yy
-00007520: 5f61 6132 5a06 7878 5f61 6132 5a0a 616e  _aa2Z.xx_aa2Z.an
-00007530: 675f 7261 6e67 6531 5a0a 616e 675f 7261  g_range1Z.ang_ra
-00007540: 6e67 6532 7222 0000 005a 0761 6e67 6c65  nge2r"...Z.angle
-00007550: 7331 72d7 0000 005a 0761 6e67 6c65 7332  s1r....Z.angles2
-00007560: 5a09 616e 675f 7261 6e67 655a 0e72 6561  Z.ang_rangeZ.rea
-00007570: 6c5f 616e 675f 7261 6e67 6572 0f00 0000  l_ang_ranger....
-00007580: 720f 0000 0072 1000 0000 da0a 6765 745f  r....r......get_
-00007590: 696e 7369 6465 d903 0000 735e 0000 0000  inside....s^....
-000075a0: 0116 011a 010a 0402 fd02 0118 0118 ff02  ................
-000075b0: ff02 040a 0110 0122 0114 0116 0116 0108  ......."........
-000075c0: 0108 0108 0108 0110 0110 0110 010c 011c  ................
-000075d0: ff06 030c 0102 ff22 0310 010c 011c ff06  ......."........
-000075e0: 030c 0102 ff22 030a 0104 0110 0110 fe04  ....."..........
-000075f0: 040e 0102 0118 0118 ff02 ff04 0472 e500  .............r..
-00007600: 0000 e932 0000 0063 0200 0000 0000 0000  ...2...c........
-00007610: 0000 0000 0400 0000 0700 0000 4300 0000  ............C...
-00007620: 735c 0000 0074 006a 01a0 0274 006a 01a0  s\...t.j...t.j..
-00007630: 037c 00a1 01a1 015c 027d 027d 037c 0174  .|.....\.}.}.|.t
-00007640: 04a0 057c 02a1 0114 007c 027c 027c 0174  ...|.....|.|.|.t
-00007650: 04a0 057c 02a1 0114 006b 043c 0074 04a0  ...|.....k.<.t..
-00007660: 057c 02a1 017c 011b 007c 027c 0274 04a0  .|...|...|.|.t..
-00007670: 057c 02a1 017c 011b 006b 003c 007c 0253  .|...|...k.<.|.S
-00007680: 0029 014e 2906 721d 0000 0072 1e00 0000  .).N).r....r....
-00007690: 72ad 0000 0072 af00 0000 7209 0000 0072  r....r....r....r
-000076a0: 7e00 0000 2904 7281 0000 005a 0a6d 6564  ~...).r....Z.med
-000076b0: 5f66 696c 7465 725a 086c 735f 696d 6167  _filterZ.ls_imag
-000076c0: 6572 a400 0000 720f 0000 0072 0f00 0000  er....r....r....
-000076d0: 7210 0000 00da 0c73 6f62 656c 5f66 696c  r......sobel_fil
-000076e0: 7465 7208 0400 0073 0e00 0000 0001 1801  ter....s........
-000076f0: 0601 02ff 1804 0cff 1403 72e7 0000 0063  ..........r....c
-00007700: 0300 0000 0000 0000 0000 0000 0900 0000  ................
-00007710: 0600 0000 4300 0000 73b2 0000 0074 006a  ....C...s....t.j
-00007720: 0164 017c 016a 0264 0119 0085 0264 017c  .d.|.j.d.....d.|
-00007730: 016a 0264 0219 0085 0266 0219 005c 027d  .j.d.....f...\.}
-00007740: 037d 047c 037c 0064 0119 0018 0064 0313  .}.|.|.d.....d..
-00007750: 007c 047c 0064 0219 0018 0064 0313 0017  .|.|.d.....d....
-00007760: 007d 057c 017c 057c 0264 0313 006b 0019  .}.|.|.|.d...k..
-00007770: 007d 067c 0174 037c 0064 0119 0064 0218  .}.|.t.|.d...d..
-00007780: 0083 0174 037c 0064 0119 0064 0217 0083  ...t.|.d...d....
-00007790: 0185 0274 037c 0064 0219 0064 0218 0083  ...t.|.d...d....
-000077a0: 0174 037c 0064 0219 0064 0217 0083 0185  .t.|.d...d......
-000077b0: 0266 0219 007d 0774 00a0 047c 07a1 0174  .f...}.t...|...t
-000077c0: 00a0 047c 06a1 0118 007d 087c 0853 0029  ...|.....}.|.S.)
-000077d0: 044e 7201 0000 0072 2700 0000 7225 0000  .Nr....r'...r%..
-000077e0: 0029 0572 0900 0000 726d 0000 0072 1900  .).r....rm...r..
-000077f0: 0000 722f 0000 0072 ae00 0000 2909 5a08  ..r/...r....).Z.
-00007800: 7065 616b 5f70 6f73 5a07 7065 616b 5f69  peak_posZ.peak_i
-00007810: 6d5a 0a66 6974 5f72 6164 6975 735a 0670  mZ.fit_radiusZ.p
-00007820: 726f 6d5f 795a 0670 726f 6d5f 785a 0670  rom_yZ.prom_xZ.p
-00007830: 726f 6d5f 725a 0970 726f 6d5f 7661 6c73  rom_rZ.prom_vals
-00007840: 5a09 7072 6f6d 5f70 6561 6b5a 0a70 726f  Z.prom_peakZ.pro
-00007850: 6d69 6e65 6e63 6572 0f00 0000 720f 0000  minencer....r...
-00007860: 0072 1000 0000 da0f 7065 616b 5f70 726f  .r......peak_pro
-00007870: 6d69 6e65 6e63 6513 0400 0073 1400 0000  minence....s....
-00007880: 0001 2601 2001 1001 0201 1e01 1eff 02ff  ..&. ...........
-00007890: 0404 1401 72e8 0000 00e7 9a99 9999 9999  ....r...........
-000078a0: c93f 630d 0000 0000 0000 0000 0000 004a  .?c............J
-000078b0: 0000 000b 0000 0043 0000 0073 ec09 0000  .......C...s....
-000078c0: 7400 a001 7c06 a101 7d06 7400 a002 7400  t...|...}.t...t.
-000078d0: a003 7c06 a101 7400 a004 7c06 a101 0b00  ..|...t...|.....
-000078e0: 6602 7400 a004 7c06 a101 7400 a003 7c06  f.t...|...t...|.
-000078f0: a101 6602 6602 a101 7d0d 7400 6a05 6401  ..f.f...}.t.j.d.
-00007900: 7c00 6a06 6401 1900 8502 6401 7c00 6a06  |.j.d.....d.|.j.
-00007910: 6402 1900 8502 6602 1900 5c02 7d0e 7d0f  d.....f...\.}.}.
-00007920: 7400 a007 7400 a008 7c04 a101 a101 7286  t...t...|.....r.
-00007930: 7400 a002 7400 a006 7c0e a101 a101 6403  t...t...|.....d.
-00007940: 1b00 7d04 6e0a 7400 a002 7c04 a101 7d04  ..}.n.t...|...}.
-00007950: 7c0e 7c04 6401 1900 1800 6403 1300 7c0f  |.|.d.....d...|.
-00007960: 7c04 6402 1900 1800 6403 1300 1700 7d10  |.d.....d.....}.
-00007970: 7400 a009 7c10 a101 7d11 6402 7c11 7c10  t...|...}.d.|.|.
-00007980: 7c01 6403 1300 6b00 3c00 740a 6a0b a00c  |.d...k.<.t.j...
-00007990: 7c11 a101 5c02 7d12 7d13 7400 a00d 7c02  |...\.}.}.t...|.
-000079a0: a101 6401 6b02 9001 7204 7400 6a0e 7c00  ..d.k...r.t.j.|.
-000079b0: 6a06 6401 6403 8502 1900 740f 6404 8d02  j.d.d.....t.d...
-000079c0: 7d14 6e04 7c02 7d14 7c00 6405 6405 8502  }.n.|.}.|.d.d...
-000079d0: 6405 6405 8502 7c14 6603 1900 7d15 7c15  d.d...|.f...}.|.
-000079e0: 6a06 6406 1900 7d16 7400 6a09 7c15 7400  j.d...}.t.j.|.t.
-000079f0: 6a10 6404 8d02 7d17 7411 7c16 8301 4400  j.d...}.t.|...D.
-00007a00: 5dbc 7d18 7c15 6405 6405 8502 6405 6405  ].}.|.d.d...d.d.
-00007a10: 8502 7c18 6603 1900 7d19 6402 740a 6a0b  ..|.f...}.d.t.j.
-00007a20: a012 7c19 a101 1700 7d19 7413 a014 7400  ..|.....}.t...t.
-00007a30: a015 7c19 a101 6402 a102 7d1a 740a 6a0b  ..|...d...}.t.j.
-00007a40: a00c 7c1a a101 5c02 7d1b 7d13 7400 a016  ..|...\.}.}.t...
-00007a50: 7c1b a101 7c07 1400 7c1b 7c1b 7c07 7400  |...|...|.|.|.t.
-00007a60: a016 7c1b a101 1400 6b04 3c00 7400 a016  ..|.....k.<.t...
-00007a70: 7c1b a101 7c07 1b00 7c1b 7c1b 7400 a016  |...|...|.|.t...
-00007a80: 7c1b a101 7c07 1b00 6b00 3c00 740a 6a0b  |...|...k.<.t.j.
-00007a90: a012 7c1b a101 740a 6a0b a012 7c12 a101  ..|...t.j...|...
-00007aa0: 1700 7d1b 7c1b 7c17 6405 6405 8502 6405  ..}.|.|.d.d...d.
-00007ab0: 6405 8502 7c18 6603 3c00 9001 7140 7c0c  d...|.f.<...q@|.
-00007ac0: 9002 7214 7400 6a16 7c17 6406 6407 8d02  ..r.t.j.|.d.d...
-00007ad0: 7d1c 6e0e 7400 6a08 7c17 6406 6407 8d02  }.n.t.j.|.d.d...
-00007ae0: 7d1c 740a 6a0b a017 7c1c 7c12 7c09 a103  }.t.j...|.|.|...
-00007af0: 7d1d 7418 6a19 7c1d 741a 6403 7c01 1400  }.t.j.|.t.d.|...
-00007b00: 8301 6408 6409 8d03 7d1e 7413 6a1b a01c  ..d.d...}.t.j...
-00007b10: 7c1e a101 6401 1900 7d1f 7400 a002 7413  |...d...}.t...t.
-00007b20: 6a1b a01d 7c1e 7c1f 7411 6402 7400 a01e  j...|.|.t.d.t...
-00007b30: 7c1f a101 6402 1700 8302 a103 a101 7d20  |...d.........} 
-00007b40: 7c05 6401 6b04 9002 72da 7c20 6405 6405  |.d.k...r.| d.d.
-00007b50: 8502 6401 6602 1900 7c04 6401 1900 1800  ..d.f...|.d.....
-00007b60: 6403 1300 7c20 6405 6405 8502 6402 6602  d...| d.d...d.f.
-00007b70: 1900 7c04 6402 1900 1800 6403 1300 1700  ..|.d.....d.....
-00007b80: 640a 1300 7d21 7c20 7c21 7c05 6b00 6405  d...}!| |!|.k.d.
-00007b90: 6405 8502 6602 1900 7d20 7c20 6a06 6401  d...f...} | j.d.
-00007ba0: 1900 6402 6b02 9003 7252 7400 6a09 7c14  ..d.k...rRt.j.|.
-00007bb0: 7410 6404 8d02 7d22 7400 6a09 7c14 7410  t.d...}"t.j.|.t.
-00007bc0: 6404 8d02 7d23 7400 6a09 7c14 7410 6404  d...}#t.j.|.t.d.
-00007bd0: 8d02 7d24 7400 6a09 7c14 7410 6404 8d02  ..}$t.j.|.t.d...
-00007be0: 7d25 7c14 7d26 7400 a01f 7c16 7c20 6a06  }%|.}&t...|.| j.
-00007bf0: 6401 1900 7c20 6a06 6402 1900 6603 a101  d...| j.d...f...
-00007c00: 7d27 7c22 7c23 7c24 7c25 7c26 7c27 6606  }'|"|#|$|%|&|'f.
-00007c10: 5300 7400 6a09 7c20 7400 6a20 6404 8d02  S.t.j.| t.j d...
-00007c20: 7d28 7400 6a09 7c20 7400 6a20 6404 8d02  }(t.j.| t.j d...
-00007c30: 7d29 7411 7c20 6a06 6401 1900 8301 4400  })t.| j.d.....D.
-00007c40: 5d46 7d2a 740a 6a0b a021 7c1d 7c20 7c2a  ]F}*t.j..!|.| |*
-00007c50: 6402 6602 1900 7c20 7c2a 6401 6602 1900  d.f...| |*d.f...
-00007c60: 7c01 a104 7d2b 7400 a022 7c2b 6401 6403  |...}+t.."|+d.d.
-00007c70: 8502 1900 a101 7c28 7c2a 6401 6403 8502  ......|(|*d.d...
-00007c80: 6602 3c00 9003 7180 7400 6a0d 7c28 7c04  f.<...q.t.j.|(|.
-00007c90: 1800 6403 1300 6402 6407 8d02 640a 1300  ..d...d.d...d...
-00007ca0: 7d2c 7c28 7c2c 7400 a023 7c2c a101 6b03  },|(|,t..#|,..k.
-00007cb0: 6405 6405 8502 6602 1900 7c28 7c2c 7400  d.d...f...|(|,t.
-00007cc0: a023 7c2c a101 6b02 6405 6405 8502 6602  .#|,..k.d.d...f.
-00007cd0: 1900 1800 7d2d 7400 a024 7c20 6a06 6401  ....}-t..$| j.d.
-00007ce0: 1900 a101 7c2c 7400 a023 7c2c a101 6b02  ....|,t..#|,..k.
-00007cf0: 1900 6401 1900 7d2e 7400 a01f 741a 7400  ..d...}.t...t.t.
-00007d00: a00d 7c14 a101 8301 7c2d 6a06 6401 1900  ..|.....|-j.d...
-00007d10: 7c2d 6a06 6402 1900 6603 a101 7d2f 7400  |-j.d...f...}/t.
-00007d20: 6a1f 7c16 7c20 6a06 6401 1900 6602 7400  j.|.| j.d...f.t.
-00007d30: 6a10 6404 8d02 7d30 7411 7c16 8301 4400  j.d...}0t.|...D.
-00007d40: 5df2 7d31 7c17 6405 6405 8502 6405 6405  ].}1|.d.d...d.d.
-00007d50: 8502 7c31 6603 1900 7d32 740a 6a0b a017  ..|1f...}2t.j...
-00007d60: 7c32 7c12 7c09 a103 7d33 7411 7c20 6a06  |2|.|...}3t.| j.
-00007d70: 6401 1900 8301 4400 5d6c 7d34 740a 6a0b  d.....D.]l}4t.j.
-00007d80: a021 7c33 7c28 7c34 6402 6602 1900 7c28  .!|3|(|4d.f...|(
-00007d90: 7c34 6401 6602 1900 7c01 a104 7d35 7400  |4d.f...|...}5t.
-00007da0: a022 7c35 6401 6403 8502 1900 a101 7c29  ."|5d.d.......|)
-00007db0: 7c34 6401 6403 8502 6602 3c00 740a 6a25  |4d.d...f.<.t.j%
-00007dc0: a026 7400 a022 7c35 6401 6403 8502 1900  .&t.."|5d.d.....
-00007dd0: a101 7c33 7c01 a103 7c30 7c31 7c34 6602  ..|3|...|0|1|4f.
-00007de0: 3c00 9004 71b8 7c29 7c2c 7400 a023 7c2c  <...q.|)|,t..#|,
-00007df0: a101 6b03 6405 6405 8502 6602 1900 7c29  ..k.d.d...f...|)
-00007e00: 7c2c 7400 a023 7c2c a101 6b02 6405 6405  |,t..#|,..k.d.d.
-00007e10: 8502 6602 1900 1800 7d36 7c36 7c2f 7c31  ..f.....}6|6|/|1
-00007e20: 6405 6405 8502 6405 6405 8502 6603 3c00  d.d...d.d...f.<.
-00007e30: 9004 7180 7400 a01f 7c14 6a06 6401 1900  ..q.t...|.j.d...
-00007e40: 7c14 6a06 6402 1900 7c30 6a06 6406 1900  |.j.d...|0j.d...
-00007e50: 6603 a101 7d37 7400 a024 7c30 6a06 6406  f...}7t..$|0j.d.
-00007e60: 1900 a101 4400 5d1e 7d18 7c30 6405 6405  ....D.].}.|0d.d.
-00007e70: 8502 7c18 6602 1900 7c37 7c14 7c18 6602  ..|.f...|7|.|.f.
-00007e80: 3c00 9005 71a6 7400 6a0e 7c37 6a06 6401  <...q.t.j.|7j.d.
-00007e90: 6403 8502 1900 7c37 6a27 6404 8d02 7d38  d.....|7j'd...}8
-00007ea0: 7411 7c30 6a06 6406 1900 8301 4400 5d2a  t.|0j.d.....D.]*
-00007eb0: 7d18 7c18 7c2e 6b03 9005 72ee 7c38 7c37  }.|.|.k...r.|8|7
-00007ec0: 6405 6405 8502 6405 6405 8502 7c18 6603  d.d...d.d...|.f.
-00007ed0: 1900 1400 7d38 9005 71ee 6401 7c38 7c38  ....}8..q.d.|8|8
-00007ee0: 6401 6b00 3c00 7c38 6402 7c30 6a06 6406  d.k.<.|8d.|0j.d.
-00007ef0: 1900 6402 1800 1b00 1300 7d38 7413 a014  ..d.......}8t...
-00007f00: 7c38 6402 a102 7d39 7c39 7c14 1900 7d3a  |8d...}9|9|...}:
-00007f10: 7c3a 7400 a028 7c3a a101 1b00 7d3b 6401  |:t..(|:....};d.
-00007f20: 7c3b 7c3b 7c03 6b00 3c00 7400 6a09 7c14  |;|;|.k.<.t.j.|.
-00007f30: 7c3b 6a27 6404 8d02 7d3c 7c3b 7c3c 7c14  |;j'd...}<|;|<|.
-00007f40: 3c00 7c3c 6401 6b04 7d26 7400 6a29 7400  <.|<d.k.}&t.j)t.
-00007f50: 6a0e 7c16 7400 6a20 6404 8d02 1400 7d3d  j.|.t.j d.....}=
-00007f60: 7400 6a29 7400 6a0e 7c16 7400 6a20 6404  t.j)t.j.|.t.j d.
-00007f70: 8d02 1400 7d3e 7400 6a29 7400 6a0e 7c16  ....}>t.j)t.j.|.
-00007f80: 7400 6a20 6404 8d02 1400 7d3f 7400 6a29  t.j d.....}?t.j)
-00007f90: 7400 6a0e 7c16 7400 6a20 6404 8d02 1400  t.j.|.t.j d.....
-00007fa0: 7d40 7411 7c16 8301 4400 5d98 7d31 7c2f  }@t.|...D.].}1|/
-00007fb0: 7c31 6405 6405 8502 6405 6405 8502 6603  |1d.d...d.d...f.
-00007fc0: 1900 7d36 7400 6a2a 6a2b 7c36 7c2d 6405  ..}6t.j*j+|6|-d.
-00007fd0: 640b 8d03 5c04 7d41 7d13 7d13 7d13 7400  d...\.}A}.}.}.t.
-00007fe0: a02c 7c41 7c0d a102 7d41 7c41 7400 a02d  .,|A|...}A|At..-
-00007ff0: 6403 a101 1800 7d41 7c41 640c 1900 7c3d  d.....}A|Ad...|=
-00008000: 7c31 3c00 7c41 640d 1900 7c41 640e 1900  |1<.|Ad...|Ad...
-00008010: 1700 6403 1b00 7c3e 7c31 3c00 7c41 640d  ..d...|>|1<.|Ad.
-00008020: 1900 7c41 640e 1900 1800 6403 1b00 7c3f  ..|Ad.....d...|?
-00008030: 7c31 3c00 7c41 640f 1900 7c40 7c31 3c00  |1<.|Ad...|@|1<.
-00008040: 9006 71ea 6401 7c3d 7400 a007 7c3d a101  ..q.d.|=t...|=..
-00008050: 3c00 6401 7c3e 7400 a007 7c3e a101 3c00  <.d.|>t...|>..<.
-00008060: 6401 7c3f 7400 a007 7c3f a101 3c00 6401  d.|?t...|?..<.d.
-00008070: 7c40 7400 a007 7c40 a101 3c00 7400 6a09  |@t...|@..<.t.j.
-00008080: 7c14 7c3d 6a27 6404 8d02 7d22 7400 6a09  |.|=j'd...}"t.j.
-00008090: 7c14 7c3d 6a27 6404 8d02 7d23 7400 6a09  |.|=j'd...}#t.j.
-000080a0: 7c14 7c3d 6a27 6404 8d02 7d24 7400 6a09  |.|=j'd...}$t.j.
-000080b0: 7c14 7c3d 6a27 6404 8d02 7d25 6406 7c0b  |.|=j'd...}%d.|.
-000080c0: 1400 7d42 7c3d 7c22 7c14 3c00 7c22 7400  ..}B|=|"|.<.|"t.
-000080d0: a016 7c22 7c26 1900 a101 3800 7d22 7c0b  ..|"|&....8.}"|.
-000080e0: 7c22 7c22 7c0b 6b04 3c00 7c42 7c22 7c22  |"|"|.k.<.|B|"|"
-000080f0: 7c42 6b00 3c00 7c22 7c26 a02e 7410 a101  |Bk.<.|"|&..t...
-00008100: 3900 7d22 7c3e 7c23 7c14 3c00 7c23 7400  9.}"|>|#|.<.|#t.
-00008110: a016 7c23 7c26 1900 a101 3800 7d23 7c0b  ..|#|&....8.}#|.
-00008120: 7c23 7c23 7c0b 6b04 3c00 7c42 7c23 7c23  |#|#|.k.<.|B|#|#
-00008130: 7c42 6b00 3c00 7c23 7c26 a02e 7410 a101  |Bk.<.|#|&..t...
-00008140: 3900 7d23 7c3f 7c24 7c14 3c00 7c24 7400  9.}#|?|$|.<.|$t.
-00008150: a016 7c24 7c26 1900 a101 3800 7d24 7c0b  ..|$|&....8.}$|.
-00008160: 7c24 7c24 7c0b 6b04 3c00 7c42 7c24 7c24  |$|$|.k.<.|B|$|$
-00008170: 7c42 6b00 3c00 7c24 7c26 a02e 7410 a101  |Bk.<.|$|&..t...
-00008180: 3900 7d24 7c40 7c25 7c14 3c00 7c25 7400  9.}$|@|%|.<.|%t.
-00008190: a016 7c25 7c26 1900 a101 3800 7d25 7c0b  ..|%|&....8.}%|.
-000081a0: 7c25 7c25 7c0b 6b04 3c00 7c42 7c25 7c25  |%|%|.k.<.|B|%|%
-000081b0: 7c42 6b00 3c00 7c25 7c26 a02e 7410 a101  |Bk.<.|%|&..t...
-000081c0: 3900 7d25 7400 a01f 7c14 6a06 6401 1900  9.}%t...|.j.d...
-000081d0: 7c14 6a06 6402 1900 7c2f 6a06 6402 1900  |.j.d...|/j.d...
-000081e0: 7c2f 6a06 6403 1900 6604 a101 7d43 7c2f  |/j.d...f...}C|/
-000081f0: 7c43 7c14 6405 6405 8502 6405 6405 8502  |C|.d.d...d.d...
-00008200: 6603 3c00 7c43 7c26 6405 6405 8502 6405  f.<.|C|&d.d...d.
-00008210: 6405 8502 6603 1900 7d44 6410 7d45 740a  d...f...}Dd.}Et.
-00008220: 6a0b a02f 7c26 6402 7c45 1b00 a102 7d46  j../|&d.|E....}F
-00008230: 740a 6a0b a00c 7c46 6411 a102 5c02 7d47  t.j...|Fd...\.}G
-00008240: 7d13 740a 6a0b a030 7c47 a101 7d48 740a  }.t.j..0|G..}Ht.
-00008250: 6a0b a02f 7c48 7c45 a102 7d49 7c49 7c26  j../|H|E..}I|I|&
-00008260: 1900 7d49 7c0a 9009 72da 7413 a014 7c22  ..}I|...r.t...|"
-00008270: 6402 a102 7d22 7413 a014 7c23 6402 a102  d...}"t...|#d...
-00008280: 7d23 7413 a014 7c24 6402 a102 7d24 7413  }#t...|$d...}$t.
-00008290: a014 7c25 6402 a102 7d25 7c22 7c23 7c24  ..|%d...}%|"|#|$
-000082a0: 7c25 7c26 7c44 7c49 6607 5300 2912 612e  |%|&|D|If.S.).a.
-000082b0: 1000 000a 2020 2020 4765 7420 7374 7261  ....    Get stra
-000082c0: 696e 2066 726f 6d20 6120 524f 4920 7769  in from a ROI wi
-000082d0: 7468 6f75 7420 7468 6520 6e65 6564 2066  thout the need f
-000082e0: 6f72 0a20 2020 2073 7065 6369 6679 696e  or.    specifyin
-000082f0: 6720 4d69 6c6c 6572 2069 6e64 6963 6573  g Miller indices
-00008300: 206f 6620 6469 6666 7261 6374 696f 6e20   of diffraction 
-00008310: 7370 6f74 730a 0a20 2020 2050 6172 616d  spots..    Param
-00008320: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00008330: 2d2d 2d2d 0a20 2020 2064 6174 6134 443a  ----.    data4D:
-00008340: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-00008350: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00008360: 6869 7320 6973 2061 2034 4420 6461 7461  his is a 4D data
-00008370: 7365 7420 7768 6572 6520 7468 6520 6669  set where the fi
-00008380: 7273 7420 7477 6f20 6469 6d65 6e73 696f  rst two dimensio
-00008390: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
-000083a0: 2020 2020 6172 6520 7468 6520 6469 6666      are the diff
-000083b0: 7261 6374 696f 6e20 6469 6d65 6e73 696f  raction dimensio
-000083c0: 6e73 2061 6e64 2074 6865 206e 6578 7420  ns and the next 
-000083d0: 7477 6f0a 2020 2020 2020 2020 2020 2020  two.            
-000083e0: 2020 2020 2064 696d 656e 7369 6f6e 7320       dimensions 
-000083f0: 6172 6520 7468 6520 7363 616e 2064 696d  are the scan dim
-00008400: 656e 7369 6f6e 730a 2020 2020 6469 736b  ensions.    disk
-00008410: 5f72 6164 6975 733a 2066 6c6f 6174 0a20  _radius: float. 
-00008420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008430: 5261 6469 7573 2069 6e20 7069 7865 6c73  Radius in pixels
-00008440: 206f 6620 7468 6520 6469 6666 7261 6374   of the diffract
-00008450: 696f 6e20 6469 736b 730a 2020 2020 524f  ion disks.    RO
-00008460: 493a 2020 2020 2020 2020 206e 6461 7272  I:         ndarr
-00008470: 6179 2c20 6f70 7469 6f6e 616c 0a20 2020  ay, optional.   
-00008480: 2020 2020 2020 2020 2020 2020 2020 5265                Re
-00008490: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
-000084a0: 2e20 4966 206e 6f20 524f 4920 6973 2070  . If no ROI is p
-000084b0: 6173 7365 6420 7468 656e 2074 6865 2065  assed then the e
-000084c0: 6e74 6972 650a 2020 2020 2020 2020 2020  ntire.          
-000084d0: 2020 2020 2020 2073 6361 6e20 7265 6769         scan regi
-000084e0: 6f6e 2069 7320 7468 6520 524f 490a 2020  on is the ROI.  
-000084f0: 2020 7072 6f6d 5f76 616c 3a20 2020 2066    prom_val:    f
-00008500: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-00008510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008520: 4d69 6e69 6d75 6d20 7072 6f6d 696e 656e  Minimum prominen
-00008530: 6365 2076 616c 7565 2074 6f20 7573 6520  ce value to use 
-00008540: 746f 2075 7365 2074 6865 2070 6561 6b20  to use the peak 
-00008550: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-00008560: 2020 2020 2073 7472 6169 6e20 6d61 7070       strain mapp
-00008570: 696e 672e 2044 6566 6175 6c74 2069 7320  ing. Default is 
-00008580: 300a 2020 2020 6469 736b 5f63 656e 7465  0.    disk_cente
-00008590: 723a 2074 7570 6c65 2c20 6f70 7469 6f6e  r: tuple, option
-000085a0: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-000085b0: 2020 2020 4c6f 6361 7469 6f6e 206f 6620      Location of 
-000085c0: 7468 6520 6365 6e74 6572 206f 6620 7468  the center of th
-000085d0: 6520 6469 6666 7261 6374 696f 6e20 6469  e diffraction di
-000085e0: 736b 202d 2063 6c6f 7365 7374 2074 6f0a  sk - closest to.
-000085f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008600: 2074 6865 203c 3030 303e 2075 6e64 6966   the <000> undif
-00008610: 6672 6163 7465 6420 6265 616d 0a20 2020  fracted beam.   
-00008620: 206d 6178 5f72 6164 6975 733a 2020 666c   max_radius:  fl
-00008630: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00008640: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-00008650: 6178 696d 756d 2064 6973 7461 6e63 6520  aximum distance 
-00008660: 6672 6f6d 2074 6865 2063 656e 7465 7220  from the center 
-00008670: 746f 2075 7365 2066 6f72 2063 616c 6375  to use for calcu
-00008680: 6c61 7469 6f6e 2e20 4465 6661 756c 740a  lation. Default.
-00008690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000086a0: 2069 7320 302c 2077 6865 6e20 616c 6c20   is 0, when all 
-000086b0: 6469 7374 616e 6365 7320 6172 6520 636f  distances are co
-000086c0: 6e73 6964 6572 6564 2e0a 2020 2020 726f  nsidered..    ro
-000086d0: 7461 6e67 6c65 3a20 2020 2066 6c6f 6174  tangle:    float
-000086e0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-000086f0: 2020 2020 2020 2020 2020 2020 416e 676c              Angl
-00008700: 6520 6f66 2072 6f74 6174 696f 6e20 6f66  e of rotation of
-00008710: 2074 6865 2043 4245 4420 7769 7468 2072   the CBED with r
-00008720: 6573 7065 6374 2074 6f20 7468 6520 6f70  espect to the op
-00008730: 7469 6320 6178 6973 0a20 2020 2020 2020  tic axis.       
-00008740: 2020 2020 2020 2020 2020 5468 6973 206d            This m
-00008750: 7573 7420 6265 2069 6e20 6465 6772 6565  ust be in degree
-00008760: 730a 2020 2020 6d65 645f 6661 6374 6f72  s.    med_factor
-00008770: 3a20 2066 6c6f 6174 2c20 6f70 7469 6f6e  :  float, option
-00008780: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00008790: 2020 2020 4475 6520 746f 2064 6574 6563      Due to detec
-000087a0: 746f 7220 6e6f 6973 652c 2073 6f6d 6520  tor noise, some 
-000087b0: 7374 7261 7920 7069 7865 6c73 206d 6179  stray pixels may
-000087c0: 206f 6674 656e 2062 6520 6272 6967 6874   often be bright
-000087d0: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-000087e0: 2020 2020 7468 616e 2074 6865 2062 6163      than the bac
-000087f0: 6b67 726f 756e 642e 2054 6869 7320 6973  kground. This is
-00008800: 2075 7365 6420 666f 7220 6461 6d70 696e   used for dampin
-00008810: 6720 616e 7920 7375 6368 2070 6978 656c  g any such pixel
-00008820: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-00008830: 2020 2020 4465 6661 756c 7420 6973 2033      Default is 3
-00008840: 300a 2020 2020 6761 7573 735f 7661 6c3a  0.    gauss_val:
-00008850: 2020 2066 6c6f 6174 2c20 6f70 7469 6f6e     float, option
-00008860: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00008870: 2020 2020 5468 6520 7374 616e 6461 7264      The standard
-00008880: 2064 6576 6961 7469 6f6e 206f 6620 7468   deviation of th
-00008890: 6520 4761 7573 7369 616e 2066 696c 7465  e Gaussian filte
-000088a0: 7220 6170 706c 6965 6420 746f 2074 6865  r applied to the
-000088b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000088c0: 2020 6c6f 6761 7269 7468 6d20 6f66 2074    logarithm of t
-000088d0: 6865 2043 4245 4420 7061 7474 6572 6e2e  he CBED pattern.
-000088e0: 2044 6566 6175 6c74 2069 7320 330a 2020   Default is 3.  
-000088f0: 2020 6879 6272 6964 5f63 633a 2020 2066    hybrid_cc:   f
-00008900: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-00008910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008920: 4879 6272 6964 697a 6174 696f 6e20 7061  Hybridization pa
-00008930: 7261 6d65 7465 7220 746f 2062 6520 7573  rameter to be us
-00008940: 6564 2066 6f72 2063 726f 7373 2d63 6f72  ed for cross-cor
-00008950: 7265 6c61 7469 6f6e 2e0a 2020 2020 2020  relation..      
-00008960: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00008970: 6c74 2069 7320 302e 310a 2020 2020 6762  lt is 0.1.    gb
-00008980: 6c75 723a 2020 2020 2020 2062 6f6f 6c2c  lur:       bool,
-00008990: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000089a0: 2020 2020 2020 2020 2020 2049 6620 6762             If gb
-000089b0: 6c75 7220 6973 206f 6e2c 2074 6865 2073  lur is on, the s
-000089c0: 7472 6169 6e20 6d61 7073 2061 7265 2062  train maps are b
-000089d0: 6c75 7272 6564 2062 7920 6120 7369 6e67  lurred by a sing
-000089e0: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
-000089f0: 2020 2020 7069 7865 6c2e 0a20 2020 2020      pixel..     
-00008a00: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00008a10: 756c 7420 6973 2054 7275 652e 0a20 2020  ult is True..   
-00008a20: 206d 6178 5f73 7472 6169 6e3a 2020 666c   max_strain:  fl
-00008a30: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00008a40: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00008a50: 616d 7020 7374 7261 696e 2076 616c 7565  amp strain value
-00008a60: 2061 626f 7665 2074 6869 7320 7661 6c75   above this valu
-00008a70: 652e 0a20 2020 2020 2020 2020 2020 2020  e..             
-00008a80: 2020 2020 4465 6661 756c 7420 6973 2030      Default is 0
-00008a90: 2e31 0a20 2020 2074 616b 655f 6d65 6469  .1.    take_medi
-00008aa0: 616e 3a20 626f 6f6c 2c20 6f70 7469 6f6e  an: bool, option
-00008ab0: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-00008ac0: 2020 2020 4966 2054 7275 652c 2074 6865      If True, the
-00008ad0: 204d 6561 6e5f 4342 4544 2069 7320 7468   Mean_CBED is th
-00008ae0: 6520 6d65 6469 616e 2064 6966 6672 6163  e median diffrac
-00008af0: 7469 6f6e 2070 6174 7465 726e 2069 6e20  tion pattern in 
-00008b00: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00008b10: 2020 2020 2052 4f49 2e20 4966 2046 616c       ROI. If Fal
-00008b20: 7365 2c20 6974 2069 7320 7468 6520 6d65  se, it is the me
-00008b30: 616e 2064 6966 6672 6163 7469 6f6e 2070  an diffraction p
-00008b40: 6174 7465 722e 0a20 2020 2020 2020 2020  atter..         
-00008b50: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-00008b60: 6973 2054 7275 650a 0a20 2020 2052 6574  is True..    Ret
-00008b70: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00008b80: 0a20 2020 2065 5f78 785f 6d61 703a 2020  .    e_xx_map:  
-00008b90: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00008ba0: 2020 2020 2020 2053 7472 6169 6e20 696e         Strain in
-00008bb0: 2074 6865 2078 7820 6469 7265 6374 696f   the xx directio
-00008bc0: 6e20 696e 2074 6865 2072 6567 696f 6e20  n in the region 
-00008bd0: 6f66 2069 6e74 6572 6573 740a 2020 2020  of interest.    
-00008be0: 655f 7879 5f6d 6170 3a20 206e 6461 7272  e_xy_map:  ndarr
-00008bf0: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-00008c00: 2020 5374 7261 696e 2069 6e20 7468 6520    Strain in the 
-00008c10: 7879 2064 6972 6563 7469 6f6e 2069 6e20  xy direction in 
-00008c20: 7468 6520 7265 6769 6f6e 206f 6620 696e  the region of in
-00008c30: 7465 7265 7374 0a20 2020 2065 5f74 685f  terest.    e_th_
-00008c40: 6d61 703a 2020 6e64 6172 7261 790a 2020  map:  ndarray.  
-00008c50: 2020 2020 2020 2020 2020 2020 2041 6e67               Ang
-00008c60: 756c 6172 2073 7472 6169 6e20 696e 2074  ular strain in t
-00008c70: 6865 2072 6567 696f 6e20 6f66 2069 6e74  he region of int
-00008c80: 6572 6573 740a 2020 2020 655f 7979 5f6d  erest.    e_yy_m
-00008c90: 6170 3a20 206e 6461 7272 6179 0a20 2020  ap:  ndarray.   
-00008ca0: 2020 2020 2020 2020 2020 2020 5374 7261              Stra
-00008cb0: 696e 2069 6e20 7468 6520 7979 2064 6972  in in the yy dir
-00008cc0: 6563 7469 6f6e 2069 6e20 7468 6520 7265  ection in the re
-00008cd0: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
-00008ce0: 0a20 2020 206e 6577 524f 493a 2020 2020  .    newROI:    
-00008cf0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00008d00: 2020 2020 2020 204e 6577 2072 6564 7563         New reduc
-00008d10: 6564 2052 4f49 2077 6865 7265 2074 6865  ed ROI where the
-00008d20: 2070 726f 6d69 6e65 6e63 6520 6f66 2074   prominence of t
-00008d30: 6865 2068 6967 6865 720a 2020 2020 2020  he higher.      
-00008d40: 2020 2020 2020 2020 206f 7264 6572 2064           order d
-00008d50: 6966 6672 6163 7469 6f6e 2064 6973 6b73  iffraction disks
-00008d60: 2069 7320 6162 6f76 6520 7072 6f6d 5f76   is above prom_v
-00008d70: 616c 0a20 2020 206e 6577 5f70 6f73 3a20  al.    new_pos: 
-00008d80: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-00008d90: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
-00008da0: 2061 6c6c 2074 6865 2068 6967 6865 7220   all the higher 
-00008db0: 6f72 6465 7220 7065 616b 2070 6f73 6974  order peak posit
-00008dc0: 696f 6e73 2077 6974 680a 2020 2020 2020  ions with.      
-00008dd0: 2020 2020 2020 2020 2072 6573 7065 6374           respect
-00008de0: 2074 6f20 7468 6520 6365 6e74 7261 6c20   to the central 
-00008df0: 6469 736b 2066 6f72 2061 6c6c 2070 6f73  disk for all pos
-00008e00: 6974 696f 6e73 2069 6e20 7468 6520 524f  itions in the RO
-00008e10: 490a 2020 2020 6469 7374 616e 6365 733a  I.    distances:
-00008e20: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00008e30: 2020 2020 2020 2020 4c69 7374 206f 6620          List of 
-00008e40: 6469 7374 616e 6365 7320 696e 2074 6865  distances in the
-00008e50: 206e 6577 6c79 2063 616c 6375 6c61 7465   newly calculate
-00008e60: 6420 524f 4920 6672 6f6d 2074 6865 0a20  d ROI from the. 
-00008e70: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00008e80: 7274 6963 6c65 2065 6467 652e 0a0a 2020  rticle edge...  
-00008e90: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00008ea0: 2d0a 2020 2020 5765 2066 6972 7374 206f  -.    We first o
-00008eb0: 6620 616c 6c20 6361 6c63 756c 6174 6520  f all calculate 
-00008ec0: 7468 6520 7072 6563 6f6e 6469 7469 6f6e  the precondition
-00008ed0: 6564 2064 6174 6120 286c 6f67 202b 2053  ed data (log + S
-00008ee0: 6f62 656c 2066 696c 7465 7265 6429 0a20  obel filtered). 
-00008ef0: 2020 2066 6f72 2065 7665 7279 2043 4245     for every CBE
-00008f00: 4420 7061 7474 6572 6e20 696e 2074 6865  D pattern in the
-00008f10: 2052 4f49 2e20 5468 656e 2074 6865 206d   ROI. Then the m
-00008f20: 6561 6e20 7072 6563 6f6e 6469 7469 6f6e  ean precondition
-00008f30: 6564 0a20 2020 2070 6174 7465 726e 2069  ed.    pattern i
-00008f40: 7320 6361 6c63 756c 6174 6564 2061 6e64  s calculated and
-00008f50: 2063 726f 7373 2d63 6f72 7265 6c61 7465   cross-correlate
-00008f60: 6420 7769 7468 2074 6865 2053 6f62 656c  d with the Sobel
-00008f70: 2074 656d 706c 6174 652e 2054 6865 2064   template. The d
-00008f80: 6973 6b0a 2020 2020 706f 7369 7469 6f6e  isk.    position
-00008f90: 7320 6172 6520 6173 2070 6561 6b73 2069  s are as peaks i
-00008fa0: 6e20 7468 6973 2063 726f 7373 2d63 6f72  n this cross-cor
-00008fb0: 7265 6c61 7465 6420 7061 7474 6572 6e2c  related pattern,
-00008fc0: 2077 6974 6820 7468 6520 6365 6e74 7261   with the centra
-00008fd0: 6c0a 2020 2020 6469 736b 2074 6865 206f  l.    disk the o
-00008fe0: 6e65 2063 6c6f 7365 7374 2074 6f20 7468  ne closest to th
-00008ff0: 6520 6365 6e74 6572 206f 6620 7468 6520  e center of the 
-00009000: 4342 4544 2070 6174 7465 726e 2e20 5573  CBED pattern. Us
-00009010: 696e 6720 7468 6174 2069 6e73 6967 6874  ing that insight
-00009020: 0a20 2020 2074 6865 2064 6973 7461 6e63  .    the distanc
-00009030: 6573 206f 6620 7468 6520 6869 6768 6572  es of the higher
-00009040: 206f 7264 6572 2064 6966 6672 6163 7469   order diffracti
-00009050: 6f6e 2064 6973 6b73 2061 7265 2063 616c  on disks are cal
-00009060: 6375 6c61 7465 6420 7769 7468 2072 6573  culated with res
-00009070: 7065 6374 0a20 2020 2074 6f20 7468 6520  pect.    to the 
-00009080: 6365 6e74 7261 6c20 7472 616e 736d 6974  central transmit
-00009090: 7465 6420 6265 616d 2e20 5468 6973 2069  ted beam. This i
-000090a0: 7320 7468 656e 2070 6572 666f 726d 6564  s then performed
-000090b0: 2066 6f72 2061 6c6c 206f 7468 6572 2043   for all other C
-000090c0: 4245 440a 2020 2020 7061 7474 6572 6e73  BED.    patterns
-000090d0: 2e20 5468 6520 6361 6c63 756c 6174 6564  . The calculated
-000090e0: 2068 6967 6865 7220 6f72 6465 7220 6469   higher order di
-000090f0: 736b 206c 6f63 6174 696f 6e73 2061 7265  sk locations are
-00009100: 2074 6865 6e20 636f 6d70 6172 6564 2074   then compared t
-00009110: 6f20 7468 650a 2020 2020 6869 6768 6572  o the.    higher
-00009120: 206f 7264 6572 2064 6973 6b20 6c6f 6361   order disk loca
-00009130: 7469 6f6e 7320 666f 7220 7468 6520 6d65  tions for the me
-00009140: 6469 616e 2070 6174 7465 726e 2074 6f20  dian pattern to 
-00009150: 6765 6e65 7261 7465 2073 7472 6169 6e20  generate strain 
-00009160: 6d61 7073 2e0a 2020 2020 486f 7765 7665  maps..    Howeve
-00009170: 722c 2073 6f6d 6574 696d 6573 2074 6865  r, sometimes the
-00009180: 2052 4f49 206d 6179 2063 6f6e 7461 696e   ROI may contain
-00009190: 2070 6f69 6e74 7320 7768 6572 6520 7468   points where th
-000091a0: 6572 6520 6973 206e 6f20 6469 6666 7261  ere is no diffra
-000091b0: 6374 696f 6e0a 2020 2020 7061 7474 6572  ction.    patter
-000091c0: 6e20 6163 7475 616c 6c79 2e20 546f 2070  n actually. To p
-000091d0: 7265 7665 6e74 2070 6963 6b69 6e67 2073  revent picking s
-000091e0: 7563 6820 706f 696e 7473 2061 6e64 2067  uch points and g
-000091f0: 656e 6572 6174 696e 6720 6572 726f 6e65  enerating errone
-00009200: 6f75 7320 7265 7375 6c74 732c 0a20 2020  ous results,.   
-00009210: 2077 6520 6361 6c63 756c 6174 6520 7468   we calculate th
-00009220: 6520 7065 616b 2070 726f 6d69 6e65 6e63  e peak prominenc
-00009230: 6520 6f66 2065 7665 7279 2068 6967 6865  e of every highe
-00009240: 7220 6f72 6465 7220 6469 6666 7261 6374  r order diffract
-00009250: 696f 6e20 7370 6f74 2c20 616e 6420 6f6e  ion spot, and on
-00009260: 6c79 0a20 2020 2069 6620 7468 6579 2061  ly.    if they a
-00009270: 7265 206d 6f72 6520 7072 6f6d 696e 656e  re more prominen
-00009280: 7420 7468 616e 2060 7072 6f6d 5f76 616c  t than `prom_val
-00009290: 6020 7468 6579 2077 696c 6c20 6265 2063  ` they will be c
-000092a0: 686f 7365 6e2e 2049 6620 6070 726f 6d5f  hosen. If `prom_
-000092b0: 7661 6c60 2069 730a 2020 2020 7a65 726f  val` is.    zero
-000092c0: 2c20 7468 656e 2061 6c6c 2070 6561 6b73  , then all peaks
-000092d0: 2061 7265 2063 686f 7365 6e2e 0a20 2020   are chosen..   
-000092e0: 2072 0100 0000 7227 0000 0072 2500 0000   r....r'...r%...
-000092f0: 7257 0000 004e 7206 0000 0072 3800 0000  rW...Nr....r8...
-00009300: 4629 025a 0c6d 696e 5f64 6973 7461 6e63  F).Z.min_distanc
-00009310: 65da 0769 6e64 6963 6573 7216 0000 0072  e..indicesr....r
-00009320: 9200 0000 7286 0000 0072 9100 0000 7239  ....r....r....r9
-00009330: 0000 0072 aa00 0000 e906 0000 0072 0200  ...r.........r..
-00009340: 0000 2931 7209 0000 005a 0764 6567 3272  ..)1r....Z.deg2r
-00009350: 6164 7218 0000 00da 0363 6f73 da03 7369  adr......cos..si
-00009360: 6e72 6d00 0000 7219 0000 0072 9700 0000  nrm...r....r....
-00009370: 72ae 0000 0072 1a00 0000 721d 0000 0072  r....r....r....r
-00009380: 1e00 0000 72ad 0000 0072 0a00 0000 728d  ....r....r....r.
-00009390: 0000 0072 8000 0000 72db 0000 0072 1b00  ...r....r....r..
-000093a0: 0000 7272 0000 0072 0700 0000 72b2 0000  ..rr...r....r...
-000093b0: 00da 056c 6f67 3130 727e 0000 0072 b000  ...log10r~...r..
-000093c0: 0000 da06 736b 6665 6174 5a0e 7065 616b  ....skfeatZ.peak
-000093d0: 5f6c 6f63 616c 5f6d 6178 722f 0000 005a  _local_maxr/...Z
-000093e0: 0c6d 6561 7375 7265 6d65 6e74 73da 056c  .measurements..l
-000093f0: 6162 656c 5a0e 6365 6e74 6572 5f6f 665f  abelZ.center_of_
-00009400: 6d61 7373 da03 6d61 7872 2e00 0000 728c  mass..maxr....r.
-00009410: 0000 0072 9600 0000 5a04 666c 6970 720b  ...r....Z.flipr.
-00009420: 0000 0072 8b00 0000 7245 0000 0072 e800  ...r....rE...r..
-00009430: 0000 7241 0000 0072 8700 0000 7295 0000  ..rA...r....r...
-00009440: 0072 9800 0000 7299 0000 0072 9a00 0000  .r....r....r....
-00009450: 72ac 0000 0072 4200 0000 7256 0000 00da  r....rB...rV....
-00009460: 0e65 7563 6c69 6465 616e 5f64 6973 7429  .euclidean_dist)
-00009470: 4a72 2900 0000 5a0b 6469 736b 5f72 6164  Jr)...Z.disk_rad
-00009480: 6975 7372 8400 0000 5a08 7072 6f6d 5f76  iusr....Z.prom_v
-00009490: 616c 5a0b 6469 736b 5f63 656e 7465 725a  alZ.disk_centerZ
-000094a0: 0a6d 6178 5f72 6164 6975 7372 2000 0000  .max_radiusr ...
-000094b0: 72b8 0000 0072 b900 0000 72ba 0000 005a  r....r....r....Z
-000094c0: 0567 626c 7572 5a0a 6d61 785f 7374 7261  .gblurZ.max_stra
-000094d0: 696e 5a0b 7461 6b65 5f6d 6564 6961 6e5a  inZ.take_medianZ
-000094e0: 0972 6f74 6d61 7472 6978 5a06 6469 6666  .rotmatrixZ.diff
-000094f0: 5f79 5a06 6469 6666 5f78 5a09 7261 6469  _yZ.diff_xZ.radi
-00009500: 6174 696e 675a 0464 6973 6b5a 0a73 6f62  atingZ.diskZ.sob
-00009510: 656c 5f64 6973 6b72 a400 0000 5a05 696d  el_diskr....Z.im
-00009520: 524f 495a 0652 4f49 5f34 4472 bb00 0000  ROIZ.ROI_4Dr....
-00009530: 5a07 4c53 425f 524f 4972 2200 0000 5a04  Z.LSB_ROIr"...Z.
-00009540: 6362 6564 72ce 0000 005a 086c 7362 5f63  cbedr....Z.lsb_c
-00009550: 6265 645a 084d 6561 6e5f 4c53 425a 064c  bedZ.Mean_LSBZ.L
-00009560: 5342 5f43 435a 0a64 6174 615f 7065 616b  SB_CCZ.data_peak
-00009570: 735a 0b70 6561 6b5f 6c61 6265 6c73 5a0c  sZ.peak_labelsZ.
-00009580: 6d65 7267 6564 5f70 6561 6b73 5a0a 6469  merged_peaksZ.di
-00009590: 7374 5f70 6561 6b73 72c2 0000 0072 c300  st_peaksr....r..
-000095a0: 0000 72c4 0000 0072 c500 0000 5a06 6e65  ..r....r....Z.ne
-000095b0: 7752 4f49 5a0c 6e65 775f 6c69 7374 5f70  wROIZ.new_list_p
-000095c0: 6f73 5a0b 6669 7474 6564 5f6d 6561 6e5a  osZ.fitted_meanZ
-000095d0: 0b66 6974 7465 645f 7363 616e 72d7 0000  .fitted_scanr...
-000095e0: 0072 a200 0000 5a07 6469 7374 6172 725a  .r....Z.distarrZ
-000095f0: 0a70 6561 6b73 5f6d 6561 6e5a 0f63 656e  .peaks_meanZ.cen
-00009600: 7472 616c 5f64 6973 6b5f 6e6f 5a08 6c69  tral_disk_noZ.li
-00009610: 7374 5f70 6f73 5a0b 7072 6f6d 696e 656e  st_posZ.prominen
-00009620: 6365 735a 026b 6b5a 0873 6361 6e5f 4c53  cesZ.kkZ.scan_LS
-00009630: 425a 0773 6361 6e5f 4343 5a02 7171 5a08  BZ.scan_CCZ.qqZ.
-00009640: 7363 616e 5f70 6172 5a0a 7065 616b 735f  scan_parZ.peaks_
-00009650: 7363 616e 5a0e 7072 6f6d 696e 656e 6365  scanZ.prominence
-00009660: 5f6d 6170 5a0a 7072 6f6d 5f64 6973 6b73  _mapZ.prom_disks
-00009670: 5a0b 7072 6f6d 5f64 6973 6b73 475a 0670  Z.prom_disksGZ.p
-00009680: 726f 6d73 735a 0770 726f 6d73 7332 5a0b  romssZ.promss2Z.
-00009690: 7072 6f6d 5f64 6973 6b73 325a 0765 7878  prom_disks2Z.exx
-000096a0: 5f52 4f49 5a07 6578 795f 524f 495a 0765  _ROIZ.exy_ROIZ.e
-000096b0: 7468 5f52 4f49 5a07 6579 795f 524f 495a  th_ROIZ.eyy_ROIZ
-000096c0: 0b73 6361 6e5f 7374 7261 696e 5a0a 6d69  .scan_strainZ.mi
-000096d0: 6e5f 7374 7261 696e 5a08 6c69 7374 5f6d  n_strainZ.list_m
-000096e0: 6170 da07 6e65 775f 706f 73da 0a75 7073  ap..new_pos..ups
-000096f0: 616d 706c 696e 67da 0772 6f69 5f75 7073  ampling..roi_ups
-00009700: da08 726f 695f 6564 6765 da09 726f 695f  ..roi_edge..roi_
-00009710: 6469 7374 735a 0964 6973 7461 6e63 6573  distsZ.distances
-00009720: 720f 0000 0072 0f00 0000 7210 0000 00da  r....r....r.....
-00009730: 1073 7472 6169 6e34 445f 6765 6e65 7261  .strain4D_genera
-00009740: 6c1f 0400 0073 5c01 0000 0066 0a01 0401  l....s\....f....
-00009750: 28ff 0403 2601 1001 1602 0a02 2001 0a01  (...&....... ...
-00009760: 1001 1001 1001 1a02 0401 1601 0a01 1001  ................
-00009770: 0c01 1601 1001 1201 1002 0cff 1404 0cff  ................
-00009780: 1403 1001 02ff 0603 1a01 0601 1002 0e01  ................
-00009790: 1001 0401 0eff 0603 1001 0401 0601 16ff  ................
-000097a0: 02ff 0405 0a02 1a01 1aff 0202 02fd 0404  ................
-000097b0: 1402 1001 0e01 0e01 0e01 0e01 0401 0401  ................
-000097c0: 14ff 0403 1002 1001 1002 1201 0601 18ff  ................
-000097d0: 0403 2201 1a02 1801 18ff 02ff 0204 2202  .."...........".
-000097e0: 2601 1a02 0c01 1601 1001 1201 0601 18ff  &...............
-000097f0: 0403 1e01 0601 14ff 1004 1801 18ff 02ff  ................
-00009800: 0204 1a02 2201 1401 1c02 1a01 1201 0a01  ...."...........
-00009810: 1e01 0c01 1601 0c02 0801 0e01 0c01 1001  ................
-00009820: 0802 0802 1601 1601 1601 1602 0c01 1601  ................
-00009830: 1a02 0c01 0e01 0c01 1801 1801 1003 0e01  ................
-00009840: 0e01 0e01 0e02 1001 1001 1001 1002 0802  ................
-00009850: 0801 1201 0c01 0c01 0e02 0801 1201 0c01  ................
-00009860: 0c01 0e02 0801 1201 0c01 0c01 0e02 0801  ................
-00009870: 1201 0c01 0c01 0e02 0401 22ff 0403 1601  ..........".....
-00009880: 1602 0401 1201 1201 0c01 0e01 0802 0601  ................
-00009890: 0c01 0c01 0c01 0c03 0201 0201 0201 0201  ................
-000098a0: 0201 0201 02f9 72f8 0000 0063 0200 0000  ......r....c....
-000098b0: 0000 0000 0000 0000 0f00 0000 0900 0000  ................
-000098c0: 4300 0000 7382 0100 0074 006a 017c 0164  C...s....t.j.|.d
-000098d0: 0164 028d 027d 0174 00a0 027c 01a1 017d  .d...}.t...|...}
-000098e0: 0274 00a0 0364 03a1 017d 017c 027c 0164  .t...d...}.|.|.d
-000098f0: 0464 0385 023c 0074 00a0 047c 006a 05a1  .d...<.t...|.j..
-00009900: 017d 0374 00a0 067c 037c 011b 00a1 01a0  .}.t...|.|......
-00009910: 0774 08a1 017d 047c 047c 0114 00a0 0774  .t...}.|.|.....t
-00009920: 08a1 017d 0574 006a 097c 0464 0564 0385  ...}.t.j.|.d.d..
-00009930: 0219 007c 006a 0a64 068d 027d 0674 006a  ...|.j.d...}.t.j
-00009940: 097c 0564 0564 0385 0219 007c 006a 0a64  .|.d.d.....|.j.d
-00009950: 068d 027d 077c 007c 0764 0764 0785 0264  ...}.|.|.d.d...d
-00009960: 0764 0785 0264 057c 0364 0419 0085 0264  .d...d.|.d.....d
-00009970: 057c 0364 0819 0085 0266 043c 0074 0b7c  .|.d.....f.<.t.|
-00009980: 0464 0419 0083 0144 005d a07d 0874 0b7c  .d.....D.].}.t.|
-00009990: 0464 0819 0083 0144 005d 8e7d 0974 087c  .d.....D.].}.t.|
-000099a0: 0164 0419 007c 0814 0083 017d 0a74 087c  .d...|.....}.t.|
-000099b0: 0164 0419 007c 0864 0117 0014 0083 017d  .d...|.d.......}
-000099c0: 0b74 087c 0164 0819 007c 0914 0083 017d  .t.|.d...|.....}
-000099d0: 0c74 087c 0164 0819 007c 0964 0117 0014  .t.|.d...|.d....
-000099e0: 0083 017d 0d74 006a 0c7c 0764 0764 0785  ...}.t.j.|.d.d..
-000099f0: 0264 0764 0785 027c 0a7c 0b85 027c 0c7c  .d.d...|.|...|.|
-00009a00: 0d85 0266 0419 0064 0964 0a8d 027d 0e7c  ...f...d.d...}.|
-00009a10: 0e7c 0664 0764 0785 0264 0764 0785 027c  .|.d.d...d.d...|
-00009a20: 087c 0966 043c 0071 d071 c07c 067c 0164  .|.f.<.q.q.|.|.d
-00009a30: 0419 007c 0164 0819 0014 001b 007d 067c  ...|.d.......}.|
-00009a40: 06a0 077c 006a 0aa1 0153 0029 0b61 c503  ...|.j...S.).a..
-00009a50: 0000 0a20 2020 2042 696e 2074 6865 2064  ...    Bin the d
-00009a60: 6174 6120 696e 2074 6865 2073 6361 6e20  ata in the scan 
-00009a70: 6469 6d65 6e73 696f 6e73 0a0a 2020 2020  dimensions..    
-00009a80: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00009a90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6461  ---------.    da
-00009aa0: 7461 3444 3a20 2020 2020 6e64 6172 7261  ta4D:     ndarra
-00009ab0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00009ac0: 2020 5468 6973 2069 7320 6120 3444 2064    This is a 4D d
-00009ad0: 6174 6173 6574 2077 6865 7265 2074 6865  ataset where the
-00009ae0: 2066 6972 7374 2074 776f 2064 696d 656e   first two dimen
-00009af0: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
-00009b00: 2020 2020 2020 6172 6520 7468 6520 6466        are the df
-00009b10: 6672 6163 7469 6f6e 2064 696d 656e 7369  fraction dimensi
-00009b20: 6f6e 7320 616e 6420 7468 6520 6e65 7874  ons and the next
-00009b30: 2074 776f 0a20 2020 2020 2020 2020 2020   two.           
-00009b40: 2020 2020 2064 696d 656e 7369 6f6e 7320       dimensions 
-00009b50: 6172 6520 7468 6520 7363 616e 2064 696d  are the scan dim
-00009b60: 656e 7369 6f6e 730a 2020 2020 6269 6e5f  ensions.    bin_
-00009b70: 6661 6374 6f72 3a20 696e 7420 6f72 2074  factor: int or t
-00009b80: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
-00009b90: 2020 2020 2042 696e 6e69 6e67 2066 6163       Binning fac
-00009ba0: 746f 7220 666f 7220 7363 616e 2064 696d  tor for scan dim
-00009bb0: 656e 7369 6f6e 730a 0a20 2020 2052 6574  ensions..    Ret
-00009bc0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00009bd0: 0a20 2020 2062 696e 6e65 645f 3444 3a20  .    binned_4D: 
-00009be0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00009bf0: 2020 2020 2020 2054 6865 2064 6174 6120         The data 
-00009c00: 6269 6e6e 6564 2069 6e20 7468 6520 7363  binned in the sc
-00009c10: 616e 6e65 6420 6469 6d65 6e73 696f 6e73  anned dimensions
-00009c20: 2e0a 0a20 2020 204e 6f74 6573 0a20 2020  ...    Notes.   
-00009c30: 202d 2d2d 2d2d 0a20 2020 2059 6f75 2063   -----.    You c
-00009c40: 616e 2073 7065 6369 6679 2074 6865 2062  an specify the b
-00009c50: 696e 2066 6163 746f 7220 746f 2062 6520  in factor to be 
-00009c60: 6569 7468 6572 2061 6e20 696e 7465 6765  either an intege
-00009c70: 7220 6f72 0a20 2020 2061 2074 7570 6c65  r or.    a tuple
-00009c80: 2e20 4966 2079 6f75 2073 7065 6369 6679  . If you specify
-00009c90: 2061 6e20 696e 7465 6765 7220 7468 6520   an integer the 
-00009ca0: 7361 6d65 2062 696e 6e69 6e67 2077 696c  same binning wil
-00009cb0: 6c0a 2020 2020 6265 2075 7365 6420 696e  l.    be used in
-00009cc0: 2062 6f74 6820 7468 6520 7363 616e 2058   both the scan X
-00009cd0: 2061 6e64 2073 6361 6e20 5920 6469 6d65   and scan Y dime
-00009ce0: 6e73 696f 6e73 2c20 7768 696c 6520 6966  nsions, while if
-00009cf0: 0a20 2020 2079 6f75 2073 7065 6369 6679  .    you specify
-00009d00: 2061 2074 7570 6c65 2074 6865 6e20 6469   a tuple then di
-00009d10: 6666 6572 656e 7420 6269 6e6e 696e 6720  fferent binning 
-00009d20: 6661 6374 6f72 7320 666f 7220 6561 6368  factors for each
-00009d30: 0a20 2020 2064 696d 656e 7369 6f6e 732e  .    dimensions.
-00009d40: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00009d50: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00009d60: 5275 6e20 6173 3a0a 0a20 2020 203e 3e3e  Run as:..    >>>
-00009d70: 2062 696e 6e65 645f 3444 203d 2062 696e   binned_4D = bin
-00009d80: 5f73 6361 6e28 6461 7461 3444 2c20 3429  _scan(data4D, 4)
-00009d90: 0a0a 2020 2020 5468 6973 2077 696c 6c20  ..    This will 
-00009da0: 6269 6e20 7468 6520 7363 616e 2064 696d  bin the scan dim
-00009db0: 656e 7369 6f6e 7320 6279 2034 2e20 5468  ensions by 4. Th
-00009dc0: 6973 2069 7320 6675 6e63 7469 6f6e 616c  is is functional
-00009dd0: 6c79 0a20 2020 2069 6465 6e74 6963 616c  ly.    identical
-00009de0: 2074 6f3a 0a0a 2020 2020 3e3e 3e20 6269   to:..    >>> bi
-00009df0: 6e6e 6564 5f34 4420 3d20 6269 6e5f 7363  nned_4D = bin_sc
-00009e00: 616e 2864 6174 6134 442c 2028 342c 2034  an(data4D, (4, 4
-00009e10: 2929 0a20 2020 2072 2700 0000 a901 5a05  )).    r'.....Z.
-00009e20: 6e64 6d69 6e72 6100 0000 7225 0000 0072  ndminra...r%...r
-00009e30: 0100 0000 7257 0000 004e 7226 0000 0072  ....rW...Nr&...r
-00009e40: dd00 0000 7238 0000 0029 0d72 0900 0000  ....r8...).r....
-00009e50: 727a 0000 0072 5800 0000 728d 0000 0072  rz...rX...r....r
-00009e60: 1800 0000 7219 0000 00da 0463 6569 6c72  ....r......ceilr
-00009e70: 4200 0000 722f 0000 0072 2e00 0000 7241  B...r/...r....rA
-00009e80: 0000 0072 1b00 0000 720a 0000 0029 0f72  ...r....r....).r
-00009e90: 2900 0000 725a 0000 00da 0262 66da 0969  )...rZ.....bf..i
-00009ea0: 6e69 5f73 6861 7065 da09 6669 6e5f 7368  ni_shape..fin_sh
-00009eb0: 6170 655a 0962 6967 5f73 6861 7065 da09  apeZ.big_shape..
-00009ec0: 6269 6e6e 6564 5f34 44da 0562 6967 3444  binned_4D..big4D
-00009ed0: 7222 0000 0072 d700 0000 da0a 7374 6172  r"...r......star
-00009ee0: 7465 725f 6969 da0a 7374 6f70 7065 725f  ter_ii..stopper_
-00009ef0: 6969 da0a 7374 6172 7465 725f 6a6a da0a  ii..starter_jj..
-00009f00: 7374 6f70 7065 725f 6a6a da0b 7375 6d6d  stopper_jj..summ
-00009f10: 6564 5f63 6265 6472 0f00 0000 720f 0000  ed_cbedr....r...
-00009f20: 0072 1000 0000 da08 6269 6e5f 7363 616e  .r......bin_scan
-00009f30: 5305 0000 732c 0000 0000 250e 010a 010a  S...s,....%.....
-00009f40: 010c 010c 0114 010e 0118 0118 0128 0110  .............(..
-00009f50: 0110 0110 0114 0110 0114 0104 0120 ff06  ............. ..
-00009f60: 031c 0114 0172 0501 0000 e700 0000 0000  .....r..........
-00009f70: 00d0 3f63 0600 0000 0000 0000 0000 0000  ..?c............
-00009f80: 0c00 0000 0800 0000 4300 0000 7306 0100  ........C...s...
-00009f90: 0074 006a 01a0 0274 03a0 047c 006a 05a1  .t.j...t...|.j..
-00009fa0: 017c 006a 0564 0119 0064 021b 007c 006a  .|.j.d...d...|.j
-00009fb0: 0564 0319 0064 021b 007c 01a1 047d 0674  .d...d...|...}.t
-00009fc0: 006a 01a0 067c 06a1 015c 027d 077d 0874  .j...|...\.}.}.t
-00009fd0: 03a0 077c 00a1 017d 097c 0274 03a0 087c  ...|...}.|.t...|
-00009fe0: 09a1 0114 007c 097c 097c 0274 03a0 087c  .....|.|.|.t...|
-00009ff0: 09a1 0114 006b 043c 0074 03a0 087c 09a1  .....k.<.t...|..
-0000a000: 017c 021b 007c 097c 0974 03a0 087c 09a1  .|...|.|.t...|..
-0000a010: 017c 021b 006b 003c 0074 006a 01a0 0674  .|...k.<.t.j...t
-0000a020: 09a0 0a74 006a 01a0 0b7c 097c 05a1 0264  ...t.j...|.|...d
-0000a030: 01a1 02a1 015c 027d 0a7d 087c 0372 ee7c  .....\.}.}.|.r.|
-0000a040: 0274 03a0 087c 0aa1 0114 007c 0a7c 0a7c  .t...|.....|.|.|
-0000a050: 0274 03a0 087c 0aa1 0114 006b 043c 0074  .t...|.....k.<.t
-0000a060: 03a0 087c 0aa1 017c 021b 007c 0a7c 0a74  ...|...|...|.|.t
-0000a070: 03a0 087c 0aa1 017c 021b 006b 003c 0074  ...|...|...k.<.t
-0000a080: 006a 01a0 0c7c 0a7c 077c 04a1 037d 0b7c  .j...|.|.|...}.|
-0000a090: 0a7c 0b66 0253 0029 0461 a10a 0000 0a20  .|.f.S.).a..... 
-0000a0a0: 2020 2047 656e 6572 6174 6520 7468 6520     Generate the 
-0000a0b0: 6669 6c74 6572 6564 2063 726f 7373 2d63  filtered cross-c
-0000a0c0: 6f72 7265 6c61 7465 6420 696d 6167 6520  orrelated image 
-0000a0d0: 666f 7220 6c6f 6361 7469 6e67 2064 6973  for locating dis
-0000a0e0: 6b0a 2020 2020 706f 7369 7469 6f6e 730a  k.    positions.
-0000a0f0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-0000a100: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-0000a110: 2020 2069 6d61 6765 3a20 2020 2020 206e     image:      n
-0000a120: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-0000a130: 2020 2020 2020 2054 6865 2069 6d61 6765         The image
-0000a140: 2074 6f20 6265 2066 696c 7465 7265 640a   to be filtered.
-0000a150: 2020 2020 6265 616d 5f72 6164 3a20 2020      beam_rad:   
-0000a160: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-0000a170: 2020 2020 2020 5261 6469 7573 206f 6620        Radius of 
-0000a180: 7468 6520 6369 7263 6c65 2e20 5468 6520  the circle. The 
-0000a190: 6369 7263 6c65 2075 7365 6420 666f 720a  circle used for.
-0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1b0: 6372 6f73 732d 636f 7272 656c 6174 696e  cross-correlatin
-0000a1c0: 6720 6973 2061 6c77 6179 7320 6365 6e74  g is always cent
-0000a1d0: 6572 6564 2061 7420 7468 6520 696d 6167  ered at the imag
-0000a1e0: 6520 6365 6e74 6572 2e0a 2020 2020 6d65  e center..    me
-0000a1f0: 645f 7661 6c3a 2020 2020 666c 6f61 742c  d_val:    float,
-0000a200: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0000a210: 2020 2020 2020 2020 2020 4465 7669 6174            Deviat
-0000a220: 696f 6e20 6672 6f6d 206d 6564 6961 6e20  ion from median 
-0000a230: 7661 6c75 6520 746f 2061 6363 6570 7420  value to accept 
-0000a240: 696e 2074 6865 0a20 2020 2020 2020 2020  in the.         
-0000a250: 2020 2020 2020 2053 6f62 656c 2066 696c         Sobel fil
-0000a260: 7465 7265 6420 696d 6167 652e 2044 6566  tered image. Def
-0000a270: 6175 6c74 2069 7320 3530 0a20 2020 2073  ault is 50.    s
-0000a280: 6563 5f6d 6564 3a20 2020 2062 6f6f 6c2c  ec_med:    bool,
-0000a290: 204f 7074 696f 6e61 6c0a 2020 2020 2020   Optional.      
-0000a2a0: 2020 2020 2020 2020 2020 5461 6d70 7320            Tamps 
-0000a2b0: 6f75 7420 6465 7669 6174 696f 6e20 6672  out deviation fr
-0000a2c0: 6f6d 206d 6564 6961 6e20 7661 6c75 6573  om median values
-0000a2d0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
-0000a2e0: 2020 2020 2020 2020 536f 6265 6c20 6669          Sobel fi
-0000a2f0: 6c74 6572 6564 2069 6d61 6765 2074 6f6f  ltered image too
-0000a300: 2069 6620 5472 7565 0a20 2020 2068 7962   if True.    hyb
-0000a310: 7269 6469 7a65 723a 2066 6c6f 6174 2c20  ridizer: float, 
-0000a320: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0000a330: 2020 2020 2020 2020 2054 6865 2076 616c           The val
-0000a340: 7565 2074 6f20 7573 6520 666f 7220 6879  ue to use for hy
-0000a350: 6272 6964 2063 726f 7373 2d63 6f72 7265  brid cross-corre
-0000a360: 6c61 7469 6f6e 2e0a 2020 2020 2020 2020  lation..        
-0000a370: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-0000a380: 6973 2030 2e32 352e 2030 2067 6976 6573  is 0.25. 0 gives
-0000a390: 2070 7572 6520 6372 6f73 7320 636f 7272   pure cross corr
-0000a3a0: 656c 6174 696f 6e2c 0a20 2020 2020 2020  elation,.       
-0000a3b0: 2020 2020 2020 2020 2077 6869 6c65 2031           while 1
-0000a3c0: 2067 6976 6573 2070 7572 6520 7068 6173   gives pure phas
-0000a3d0: 6520 636f 7272 656c 6174 696f 6e0a 2020  e correlation.  
-0000a3e0: 2020 6269 745f 6465 7074 683a 2020 696e    bit_depth:  in
-0000a3f0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000a400: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
-0000a410: 6d75 6d20 706f 7765 7220 6f66 2032 2074  mum power of 2 t
-0000a420: 6f20 6265 2075 7365 6420 666f 7220 7363  o be used for sc
-0000a430: 616c 696e 6720 7468 6520 696d 6167 650a  aling the image.
-0000a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a450: 7768 656e 2074 616b 696e 6720 6c6f 6761  when taking loga
-0000a460: 7269 7468 6d73 2e20 4465 6661 756c 7420  rithms. Default 
-0000a470: 6973 2033 320a 0a20 2020 2052 6574 7572  is 32..    Retur
-0000a480: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-0000a490: 2020 2073 6c6d 5f69 6d61 6765 3a20 6e64     slm_image: nd
-0000a4a0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-0000a4b0: 2020 2020 2054 6865 2066 696c 7465 7265       The filtere
-0000a4c0: 6420 696d 6167 652e 0a0a 2020 2020 6c73  d image...    ls
-0000a4d0: 635f 696d 6167 653a 206e 6461 7272 6179  c_image: ndarray
-0000a4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a4f0: 5468 6520 6669 6c74 6572 6564 2069 6d61  The filtered ima
-0000a500: 6765 2063 726f 7373 2d63 6f72 7265 6c61  ge cross-correla
-0000a510: 7465 6420 7769 7468 2074 6865 2063 6972  ted with the cir
-0000a520: 636c 6520 6564 6765 0a0a 2020 2020 4e6f  cle edge..    No
-0000a530: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
-0000a540: 2020 5765 2066 6972 7374 2067 656e 6572    We first gener
-0000a550: 6174 6520 7468 6520 6369 7263 6c65 2063  ate the circle c
-0000a560: 656e 7465 7265 6420 6174 2074 6865 2058  entered at the X
-0000a570: 2061 6e64 2059 2063 6f2d 6f72 6469 6e61   and Y co-ordina
-0000a580: 7465 732c 2077 6974 680a 2020 2020 7468  tes, with.    th
-0000a590: 6520 7261 6469 7573 2067 6976 656e 2069  e radius given i
-0000a5a0: 6e73 6964 6520 7468 6520 6369 7263 5f76  nside the circ_v
-0000a5b0: 616c 7320 7475 706c 652e 2054 6869 7320  als tuple. This 
-0000a5c0: 6765 6e65 7261 7465 6420 6369 7263 6c65  generated circle
-0000a5d0: 2069 730a 2020 2020 7468 6520 536f 6265   is.    the Sobe
-0000a5e0: 6c20 6669 6c74 6572 6564 2074 6f20 6765  l filtered to ge
-0000a5f0: 6e65 7261 7465 2061 6e20 6564 6765 206f  nerate an edge o
-0000a600: 6620 7468 6520 6369 7263 6c65 2e0a 0a20  f the circle... 
-0000a610: 2020 204f 6674 656e 2064 7565 2074 6f20     Often due to 
-0000a620: 6465 7465 6374 6f72 2069 7373 7565 732c  detector issues,
-0000a630: 206f 7220 7374 7261 7920 6d75 6f6e 7320   or stray muons 
-0000a640: 6120 7369 6e67 6c65 2070 6978 656c 206d  a single pixel m
-0000a650: 6179 2062 650a 2020 2020 6d75 6368 2062  ay be.    much b
-0000a660: 7269 6768 7465 722e 2041 6c73 6f20 6465  righter. Also de
-0000a670: 6164 2070 6978 656c 7320 6361 6e20 6361  ad pixels can ca
-0000a680: 7573 6520 696e 6469 7669 6475 616c 2070  use individual p
-0000a690: 6978 656c 7320 746f 2062 650a 2020 2020  ixels to be.    
-0000a6a0: 6d75 6368 2064 6172 6b65 722e 2054 6f20  much darker. To 
-0000a6b0: 7265 6d6f 7665 2073 7563 6820 6572 726f  remove such erro
-0000a6c0: 7273 2c20 616e 6420 7661 6c75 6573 2069  rs, and values i
-0000a6d0: 6e20 7468 6520 696d 6167 652c 2077 6520  n the image, we 
-0000a6e0: 7461 6b65 0a20 2020 2074 6865 206d 6564  take.    the med
-0000a6f0: 6961 6e20 7661 6c75 6520 6f66 2074 6865  ian value of the
-0000a700: 2069 6d61 6765 2061 6e64 2074 6865 6e20   image and then 
-0000a710: 7468 726f 7720 616e 7920 7661 6c75 6573  throw any values
-0000a720: 2074 6861 7420 6172 6520 6d65 645f 7661   that are med_va
-0000a730: 6c0a 2020 2020 7469 6d65 7320 6c61 7267  l.    times larg
-0000a740: 6572 206f 7220 6d65 645f 7661 6c20 7469  er or med_val ti
-0000a750: 6d65 7320 736d 616c 6c65 7220 7468 616e  mes smaller than
-0000a760: 2074 6865 206d 6564 6961 6e2e 2054 6865   the median. The
-0000a770: 6e20 7765 206e 6f72 6d61 6c69 7a65 0a20  n we normalize. 
-0000a780: 2020 2074 6865 2069 6d61 6765 2066 726f     the image fro
-0000a790: 6d20 3120 746f 2074 6865 2032 5e62 6974  m 1 to the 2^bit
-0000a7a0: 5f64 6570 7468 2061 6e64 2074 6865 6e20  _depth and then 
-0000a7b0: 7461 6b65 2074 6865 206c 6f67 206f 6620  take the log of 
-0000a7c0: 7468 6174 2069 6d61 6765 2e0a 2020 2020  that image..    
-0000a7d0: 5468 6973 2067 656e 6572 6174 6573 2061  This generates a
-0000a7e0: 6e20 696d 6167 6520 7768 6f73 6520 7363  n image whose sc
-0000a7f0: 616c 6520 6973 2062 6574 7765 656e 2030  ale is between 0
-0000a800: 2061 6e64 2074 6865 2062 6974 5f64 6570   and the bit_dep
-0000a810: 7468 2e20 546f 0a20 2020 2066 7572 7468  th. To.    furth
-0000a820: 6572 2064 6563 7265 6173 6520 6465 7465  er decrease dete
-0000a830: 6374 6f72 206e 6f69 7365 2c20 7468 6973  ctor noise, this
-0000a840: 2073 6361 6c65 6420 696d 6167 6520 6973   scaled image is
-0000a850: 2074 6865 6e20 4761 7573 7369 616e 2066   then Gaussian f
-0000a860: 696c 7465 7265 640a 2020 2020 7769 7468  iltered.    with
-0000a870: 2061 2073 696e 676c 6520 7069 7865 6c20   a single pixel 
-0000a880: 626c 7572 2c20 616e 6420 7468 656e 2066  blur, and then f
-0000a890: 696e 616c 6c79 2053 6f62 656c 2066 696c  inally Sobel fil
-0000a8a0: 7465 7265 642e 2054 6869 7320 536f 6265  tered. This Sobe
-0000a8b0: 6c0a 2020 2020 6669 6c74 6572 6564 2069  l.    filtered i
-0000a8c0: 6d61 6765 2069 7320 7468 656e 2063 726f  mage is then cro
-0000a8d0: 7373 2d63 6f72 7265 6c61 7465 6420 7769  ss-correlated wi
-0000a8e0: 7468 2074 6865 2053 6f62 656c 2066 696c  th the Sobel fil
-0000a8f0: 7465 7265 6420 6369 7263 6c65 2065 6467  tered circle edg
-0000a900: 652e 0a0a 2020 2020 4966 2074 6865 7265  e...    If there
-0000a910: 2061 7265 2064 6973 6b73 2069 6e20 7468   are disks in th
-0000a920: 6520 696d 6167 6520 7768 6f73 6520 7369  e image whose si
-0000a930: 7a65 2069 7320 636c 6f73 6520 746f 2074  ze is close to t
-0000a940: 6865 2072 6164 6975 7320 6f66 2074 6865  he radius of the
-0000a950: 0a20 2020 2063 6972 636c 652c 2074 6865  .    circle, the
-0000a960: 6e20 7468 6520 6c6f 6361 7469 6f6e 7320  n the locations 
-0000a970: 6f66 2074 6865 6d20 6e6f 7720 6265 636f  of them now beco
-0000a980: 6d65 2032 4420 7065 616b 732e 2049 6620  me 2D peaks. If 
-0000a990: 7468 650a 2020 2020 6369 7263 6c65 2072  the.    circle r
-0000a9a0: 6164 6975 7320 6973 2068 6f77 6576 6572  adius is however
-0000a9b0: 2074 6f6f 2073 6d61 6c6c 2f6c 6172 6765   too small/large
-0000a9c0: 2072 6174 6865 7220 7468 616e 2032 4420   rather than 2D 
-0000a9d0: 7065 616b 7320 6174 0a20 2020 2064 6966  peaks at.    dif
-0000a9e0: 6672 6163 7469 6f6e 2064 6973 6b20 6c6f  fraction disk lo
-0000a9f0: 6361 7469 6f6e 732c 2077 6520 7769 6c6c  cations, we will
-0000aa00: 206f 6273 6572 7665 2063 6972 636c 6573   observe circles
-0000aa10: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
-0000aa20: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000aa30: 2054 6869 7320 6973 2065 7874 7265 6d65   This is extreme
-0000aa40: 6c79 2075 7365 6675 6c20 666f 7220 6c6f  ly useful for lo
-0000aa50: 6361 7469 6e67 204e 4245 4420 6469 6666  cating NBED diff
-0000aa60: 7261 6374 696f 6e20 706f 7369 7469 6f6e  raction position
-0000aa70: 732e 2049 6620 796f 7520 6b6e 6f77 0a20  s. If you know. 
-0000aa80: 2020 2074 6865 2073 697a 6520 616e 6420     the size and 
-0000aa90: 6f66 2074 6865 2063 656e 7472 616c 2064  of the central d
-0000aaa0: 6973 6b20 796f 7520 7573 6520 7468 6520  isk you use the 
-0000aab0: 6f6e 2074 6865 204d 6561 6e5f 4342 4544  on the Mean_CBED
-0000aac0: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
-0000aad0: 650a 2020 2020 6469 736b 2070 6f73 6974  e.    disk posit
-0000aae0: 696f 6e73 2066 726f 6d3a 0a0a 2020 2020  ions from:..    
-0000aaf0: 3e3e 3e20 736c 6d5f 7265 6665 7265 6e63  >>> slm_referenc
-0000ab00: 652c 206c 7363 5f72 6566 6572 656e 6365  e, lsc_reference
-0000ab10: 203d 2073 742e 6e62 6564 2e63 6265 645f   = st.nbed.cbed_
-0000ab20: 6669 6c74 6572 284d 6561 6e5f 4342 4544  filter(Mean_CBED
-0000ab30: 2c20 6265 616d 5f72 290a 0a20 2020 2072  , beam_r)..    r
-0000ab40: 2700 0000 7225 0000 0072 0100 0000 290d  '...r%...r....).
-0000ab50: 721d 0000 0072 1e00 0000 da0b 6d61 6b65  r....r......make
-0000ab60: 5f63 6972 636c 6572 0900 0000 7218 0000  _circler....r...
-0000ab70: 0072 1900 0000 72ad 0000 0072 5800 0000  .r....r....rX...
-0000ab80: 727e 0000 0072 0700 0000 72b2 0000 0072  r~...r....r....r
-0000ab90: af00 0000 72b0 0000 0029 0c72 8100 0000  ....r....).r....
-0000aba0: 5a08 6265 616d 5f72 6164 7282 0000 005a  Z.beam_radr....Z
-0000abb0: 0773 6563 5f6d 6564 72a9 0000 0072 d500  .sec_medr....r..
-0000abc0: 0000 72b4 0000 0072 bd00 0000 72a4 0000  ..r....r....r...
-0000abd0: 005a 096d 6564 5f69 6d61 6765 5a09 736c  .Z.med_imageZ.sl
-0000abe0: 6d5f 696d 6167 655a 096c 7363 5f69 6d61  m_imageZ.lsc_ima
-0000abf0: 6765 720f 0000 0072 0f00 0000 7210 0000  ger....r....r...
-0000ac00: 00da 0b63 6265 645f 6669 6c74 6572 9005  ...cbed_filter..
-0000ac10: 0000 732a 0000 0000 4406 0124 ff04 0310  ..s*....D..$....
-0000ac20: 030a 0106 0102 ff18 040c ff14 0506 0114  ................
-0000ac30: ff08 0304 0106 0102 ff18 040c ff14 0510  ................
-0000ac40: 0172 0801 0000 e72d 431c ebe2 361a 3f63  .r.....-C...6.?c
-0000ac50: 0300 0000 0000 0000 0000 0000 1100 0000  ................
-0000ac60: 0900 0000 0300 0000 7374 0100 0074 00a0  ........st...t..
-0000ac70: 017c 006a 02a1 0189 0074 036a 04a0 057c  .|.j.....t.j...|
-0000ac80: 00a1 015c 0289 017d 0374 0664 017c 021b  ...\...}.t.d.|..
-0000ac90: 0064 021b 0083 017d 0474 00a0 077c 0464  .d.....}.t...|.d
-0000aca0: 0366 02a1 017d 0564 0174 00a0 087c 04a1  .f...}.d.t...|..
-0000acb0: 0117 007c 0174 00a0 0988 00a1 0114 007c  ...|.t.........|
-0000acc0: 041b 0014 007c 0564 0464 0485 0264 0566  .....|.d.d...d.f
-0000acd0: 023c 0074 0a7c 0483 0144 005d 827d 0674  .<.t.|...D.].}.t
-0000ace0: 036a 04a0 0b74 00a0 0188 00a1 0188 0064  .j...t.........d
-0000acf0: 0119 0064 031b 0088 0064 0519 0064 031b  ...d.....d...d..
-0000ad00: 007c 057c 0664 0566 0219 00a1 047d 0774  .|.|.d.f.....}.t
-0000ad10: 036a 04a0 057c 07a1 015c 027d 087d 0374  .j...|...\.}.}.t
-0000ad20: 036a 04a0 0c88 017c 08a1 027d 097c 0974  .j.....|...}.|.t
-0000ad30: 067c 096a 0264 0519 0064 031b 0083 0174  .|.j.d...d.....t
-0000ad40: 067c 096a 0264 0119 0064 031b 0083 0166  .|.j.d...d.....f
-0000ad50: 0219 007c 057c 0664 0166 023c 0071 6e7c  ...|.|.d.f.<.qn|
-0000ad60: 057c 0564 0464 0485 0264 0166 0219 0074  .|.d.d...d.f...t
-0000ad70: 00a0 0d7c 0564 0464 0485 0264 0166 0219  ...|.d.d...d.f..
-0000ad80: 00a1 016b 0264 0566 0219 0064 0519 007d  ...k.d.f...d...}
-0000ad90: 0a7c 0174 00a0 0988 00a1 0114 0064 061b  .|.t.........d..
-0000ada0: 007d 0b7c 0a7c 0b18 007d 0c7c 0a7c 0b17  .}.|.|...}.|.|..
-0000adb0: 007d 0d87 0087 0166 0264 0764 0884 087d  .}.....f.d.d...}
-0000adc0: 0e74 0e6a 0f7c 0e7c 0c7c 0d66 027c 0264  .t.j.|.|.|.f.|.d
-0000add0: 0964 0a8d 047d 0f7c 0f6a 107d 107c 1053  .d...}.|.j.}.|.S
-0000ade0: 0029 0b61 2f05 0000 0a20 2020 2046 696e  .).a/....    Fin
-0000adf0: 6420 7468 6520 7369 7a65 206f 6620 7468  d the size of th
-0000ae00: 6520 6365 6e74 7261 6c20 6469 736b 2066  e central disk f
-0000ae10: 726f 6d20 6469 6666 7261 6374 696f 6e0a  rom diffraction.
-0000ae20: 2020 2020 7061 7474 6572 6e73 2e0a 0a20      patterns... 
-0000ae30: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000ae40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000ae50: 2063 6265 645f 696d 6167 653a 206e 6461   cbed_image: nda
-0000ae60: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-0000ae70: 2020 2020 2054 6865 2043 4245 4420 696d       The CBED im
-0000ae80: 6167 6520 746f 2062 6520 7573 6564 2066  age to be used f
-0000ae90: 6f72 2063 616c 6375 6c61 7469 6e67 0a20  or calculating. 
-0000aea0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0000aeb0: 6865 2063 656e 7472 616c 2063 6f6e 7665  he central conve
-0000aec0: 7267 656e 6365 2061 6e67 6c65 2073 697a  rgence angle siz
-0000aed0: 6520 6672 6f6d 0a20 2020 2075 626f 756e  e from.    uboun
-0000aee0: 643a 2020 2020 2066 6c6f 6174 2c20 6f70  d:     float, op
-0000aef0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000af00: 2020 2020 2020 2054 6865 2072 6174 696f         The ratio
-0000af10: 206f 6620 7468 6520 7369 7a65 206f 6620   of the size of 
-0000af20: 7468 6520 696d 6167 6520 746f 2062 6520  the image to be 
-0000af30: 7573 6564 0a20 2020 2020 2020 2020 2020  used.           
-0000af40: 2020 2020 2061 7320 7468 6520 7570 7065       as the uppe
-0000af50: 7220 626f 756e 6420 666f 7220 7468 6520  r bound for the 
-0000af60: 7261 6469 7573 2073 697a 652e 2044 6566  radius size. Def
-0000af70: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
-0000af80: 2020 2020 2069 7320 302e 322e 2054 6865       is 0.2. The
-0000af90: 206c 6f77 6572 2062 6f75 6e64 2069 7320   lower bound is 
-0000afa0: 616c 7761 7973 2031 2070 6978 656c 730a  always 1 pixels.
-0000afb0: 2020 2020 746f 6c3a 2020 2020 2020 2020      tol:        
-0000afc0: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
-0000afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000afe0: 5468 6520 746f 6c65 7261 6e63 6520 6f66  The tolerance of
-0000aff0: 2074 6865 2073 6369 7079 2e6f 7074 696d   the scipy.optim
-0000b000: 697a 6520 6669 7474 696e 6720 6675 6e63  ize fitting func
-0000b010: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-0000b020: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0000b030: 302e 3031 0a0a 2020 2020 5265 7475 726e  0.01..    Return
-0000b040: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-0000b050: 2020 7261 643a 2066 6c6f 6174 0a20 2020    rad: float.   
-0000b060: 2020 2020 2020 5468 6520 7261 6469 7573        The radius
-0000b070: 2069 6e20 7069 7865 6c73 206f 6620 7468   in pixels of th
-0000b080: 6520 636f 6e76 6572 6765 6e63 6520 6170  e convergence ap
-0000b090: 6572 7475 7265 0a0a 2020 2020 4e6f 7465  erture..    Note
-0000b0a0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
-0000b0b0: 5468 6973 2069 7320 6261 7365 6420 6f6e  This is based on
-0000b0c0: 2074 6865 2069 6465 6120 7468 6174 2069   the idea that i
-0000b0d0: 6620 6120 536f 6265 6c20 6669 6c74 6572  f a Sobel filter
-0000b0e0: 6564 2043 4245 4420 7061 7474 6572 6e0a  ed CBED pattern.
-0000b0f0: 2020 2020 6973 2063 726f 7373 2d63 6f72      is cross-cor
-0000b100: 7265 6c61 7465 6420 7769 7468 2061 2063  related with a c
-0000b110: 6972 636c 6520 6564 6765 2c20 6120 7368  ircle edge, a sh
-0000b120: 6172 7020 7065 616b 2069 7320 6f62 7461  arp peak is obta
-0000b130: 696e 6564 0a20 2020 206f 6e6c 7920 6966  ined.    only if
-0000b140: 2074 6865 2072 6164 6975 7320 6f66 2074   the radius of t
-0000b150: 6861 7420 6369 7263 6c65 2069 7320 7468  hat circle is th
-0000b160: 6520 7361 6d65 2061 7320 7468 6520 7261  e same as the ra
-0000b170: 6469 7573 2069 6e0a 2020 2020 7069 7865  dius in.    pixe
-0000b180: 6c73 206f 6620 7468 6520 4342 4544 2070  ls of the CBED p
-0000b190: 6174 7465 726e 2e20 4966 2074 6865 2063  attern. If the c
-0000b1a0: 6972 636c 6520 6973 2061 206c 6f74 2073  ircle is a lot s
-0000b1b0: 6d61 6c6c 6572 206f 7220 6c61 7267 6572  maller or larger
-0000b1c0: 2c0a 2020 2020 7468 656e 2061 2064 6f6e  ,.    then a don
-0000b1d0: 7574 206c 696b 6520 7269 6e67 2069 7320  ut like ring is 
-0000b1e0: 666f 726d 6564 2061 7420 7468 6520 6365  formed at the ce
-0000b1f0: 6e74 6572 206f 6620 7468 6520 6372 6f73  nter of the cros
-0000b200: 732d 636f 7272 656c 6174 6564 0a20 2020  s-correlated.   
-0000b210: 2070 6174 7465 726e 2e20 4966 2074 6865   pattern. If the
-0000b220: 2072 6164 6975 7320 6973 2061 2062 6974   radius is a bit
-0000b230: 206f 6666 202d 2074 6865 6e20 7468 6520   off - then the 
-0000b240: 7065 616b 2069 7320 6120 6269 7420 6469  peak is a bit di
-0000b250: 6666 7573 652e 0a20 2020 2054 6875 7320  ffuse..    Thus 
-0000b260: 7468 6520 636f 7272 6563 7420 7261 6469  the correct radi
-0000b270: 7573 2069 6e20 7069 7865 6c73 2077 696c  us in pixels wil
-0000b280: 6c20 6769 7665 2074 6865 2073 6861 7270  l give the sharp
-0000b290: 6573 7420 7065 616b 2c20 7768 6963 680a  est peak, which.
-0000b2a0: 2020 2020 6973 2068 6f77 2077 6520 6669      is how we fi
-0000b2b0: 6e64 2074 6865 2072 6164 6975 7320 6279  nd the radius by
-0000b2c0: 2075 7369 6e67 2060 7363 6970 792e 6f70   using `scipy.op
-0000b2d0: 7469 6d69 7a65 2e6d 696e 696d 697a 655f  timize.minimize_
-0000b2e0: 7363 616c 6172 600a 0a20 2020 2053 6565  scalar`..    See
-0000b2f0: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
-0000b300: 2d2d 0a20 2020 2063 6265 645f 6669 6c74  --.    cbed_filt
-0000b310: 6572 0a20 2020 2072 2700 0000 e914 0000  er.    r'.......
-0000b320: 0072 2500 0000 4e72 0100 0000 72a6 0000  .r%...Nr....r...
-0000b330: 0063 0100 0000 0000 0000 0000 0000 0600  .c..............
-0000b340: 0000 0600 0000 1300 0000 7374 0000 0074  ..........st...t
-0000b350: 006a 01a0 0274 03a0 0488 00a1 0188 0064  .j...t.........d
-0000b360: 0119 0064 021b 0088 0064 0319 0064 021b  ...d.....d...d..
-0000b370: 007c 00a1 047d 0174 006a 01a0 057c 01a1  .|...}.t.j...|..
-0000b380: 015c 027d 027d 0374 006a 01a0 0688 017c  .\.}.}.t.j.....|
-0000b390: 02a1 027d 047c 0474 077c 046a 0864 0319  ...}.|.t.|.j.d..
-0000b3a0: 0064 021b 0083 0174 077c 046a 0864 0119  .d.....t.|.j.d..
-0000b3b0: 0064 021b 0083 0166 0219 007d 057c 050b  .d.....f...}.|..
-0000b3c0: 0053 0029 044e 7227 0000 0072 2500 0000  .S.).Nr'...r%...
-0000b3d0: 7201 0000 0029 0972 1d00 0000 721e 0000  r....).r....r...
-0000b3e0: 0072 0701 0000 7209 0000 0072 1800 0000  .r....r....r....
-0000b3f0: 72ad 0000 0072 b000 0000 722f 0000 0072  r....r....r/...r
-0000b400: 1900 0000 2906 7275 0000 00da 0263 645a  ....).ru.....cdZ
-0000b410: 0873 6f62 656c 5f63 6472 a400 0000 5a09  .sobel_cdr....Z.
-0000b420: 7465 7374 5f63 6f72 725a 0772 6164 5f76  test_corrZ.rad_v
-0000b430: 616c a902 5a07 696d 7368 6170 655a 0a73  al..Z.imshapeZ.s
-0000b440: 6f62 656c 5f63 6265 6472 0f00 0000 7210  obel_cbedr....r.
-0000b450: 0000 00da 0872 6164 5f66 756e 632d 0600  .....rad_func-..
-0000b460: 0073 0e00 0000 0001 0601 1eff 0403 1001  .s..............
-0000b470: 0e01 2801 7a1c 6765 745f 7261 6469 7573  ..(.z.get_radius
-0000b480: 2e3c 6c6f 6361 6c73 3e2e 7261 645f 6675  .<locals>.rad_fu
-0000b490: 6e63 5a07 626f 756e 6465 6429 03da 0662  ncZ.bounded)...b
-0000b4a0: 6f75 6e64 73da 0374 6f6c da06 6d65 7468  ounds..tol..meth
-0000b4b0: 6f64 2911 7209 0000 0072 1800 0000 7219  od).r....r....r.
-0000b4c0: 0000 0072 1d00 0000 721e 0000 0072 ad00  ...r....r....r..
-0000b4d0: 0000 722f 0000 0072 2e00 0000 728b 0000  ..r/...r....r...
-0000b4e0: 0072 8700 0000 721b 0000 0072 0701 0000  .r....r....r....
-0000b4f0: 72b0 0000 0072 f100 0000 7213 0000 005a  r....r....r....Z
-0000b500: 0f6d 696e 696d 697a 655f 7363 616c 6172  .minimize_scalar
-0000b510: 7214 0000 0029 115a 0a63 6265 645f 696d  r....).Z.cbed_im
-0000b520: 6167 655a 0675 626f 756e 6472 0f01 0000  ageZ.uboundr....
-0000b530: 72a4 0000 005a 0d74 6573 745f 7072 6563  r....Z.test_prec
-0000b540: 6973 6f6e 5a09 7465 7374 5f76 616c 7372  isonZ.test_valsr
-0000b550: 2200 0000 72b4 0000 0072 bd00 0000 5a02  "...r....r....Z.
-0000b560: 7463 5a09 6669 7273 745f 6d61 785a 0976  tcZ.first_maxZ.v
-0000b570: 6172 6961 7469 6f6e 5a02 6c62 5a02 7562  ariationZ.lbZ.ub
-0000b580: 720d 0100 0072 3400 0000 5a03 7261 6472  r....r4...Z.radr
-0000b590: 0f00 0000 720c 0100 0072 1000 0000 da0a  ....r....r......
-0000b5a0: 6765 745f 7261 6469 7573 f305 0000 732c  get_radius....s,
-0000b5b0: 0000 0000 260c 0110 0110 010e 010c 0110  ....&...........
-0000b5c0: ff10 030c 0106 0126 ff04 0310 010e 0132  .......&.......2
-0000b5d0: 0232 0112 0108 0108 020e 0916 0106 0172  .2.............r
-0000b5e0: 1101 0000 6302 0000 0000 0000 0000 0000  ....c...........
-0000b5f0: 001d 0000 000b 0000 0043 0000 0073 1c06  .........C...s..
-0000b600: 0000 7400 6a01 7c01 6401 6402 8d02 7d01  ..t.j.|.d.d...}.
-0000b610: 7400 a002 7c01 a101 7d02 7400 a003 6403  t...|...}.t...d.
-0000b620: a101 7d01 7c02 7c01 6404 6403 8502 3c00  ..}.|.|.d.d...<.
-0000b630: 7400 a004 7c00 6a05 a101 7d03 7400 a006  t...|.j...}.t...
-0000b640: 7c03 7c01 1b00 a101 a007 7408 a101 7d04  |.|.......t...}.
-0000b650: 7c03 6404 1900 7c04 6404 1900 1b00 7d05  |.d...|.d.....}.
-0000b660: 7c03 6405 1900 7c04 6405 1900 1b00 7d06  |.d...|.d.....}.
-0000b670: 7400 a009 7c04 6404 1900 6404 6602 a101  t...|.d...d.f...
-0000b680: 7d07 7400 a009 7c04 6405 1900 6404 6602  }.t...|.d...d.f.
-0000b690: a101 7d08 7400 6a0a 6406 7c03 6404 1900  ..}.t.j.d.|.d...
-0000b6a0: 7c04 6404 1900 6401 1700 6407 8d03 6406  |.d...d...d...d.
-0000b6b0: 7c04 6404 1900 8502 1900 7c07 6400 6400  |.d.......|.d.d.
-0000b6c0: 8502 6406 6602 3c00 7400 6a0a 6406 7c03  ..d.f.<.t.j.d.|.
-0000b6d0: 6404 1900 7c04 6404 1900 6401 1700 6407  d...|.d...d...d.
-0000b6e0: 8d03 6401 7c04 6404 1900 6401 1700 8502  ..d.|.d...d.....
-0000b6f0: 1900 7c07 6400 6400 8502 6401 6602 3c00  ..|.d.d...d.f.<.
-0000b700: 7400 6a0a 6406 7c03 6405 1900 7c04 6405  t.j.d.|.d...|.d.
-0000b710: 1900 6401 1700 6407 8d03 6406 7c04 6405  ..d...d...d.|.d.
-0000b720: 1900 8502 1900 7c08 6400 6400 8502 6406  ......|.d.d...d.
-0000b730: 6602 3c00 7400 6a0a 6406 7c03 6405 1900  f.<.t.j.d.|.d...
-0000b740: 7c04 6405 1900 6401 1700 6407 8d03 6401  |.d...d...d...d.
-0000b750: 7c04 6405 1900 6401 1700 8502 1900 7c08  |.d...d.......|.
-0000b760: 6400 6400 8502 6401 6602 3c00 7400 6a09  d.d...d.f.<.t.j.
-0000b770: 7c04 6406 6403 8502 1900 7c00 6a0b 6408  |.d.d.....|.j.d.
-0000b780: 8d02 7d09 7408 7400 a00c 7c07 6409 1900  ..}.t.t...|.d...
-0000b790: a101 8301 7d0a 7400 a00d 7c07 6409 1900  ....}.t...|.d...
-0000b7a0: 6401 a102 7d0b 7408 7400 a00c 7c08 6409  d...}.t.t...|.d.
-0000b7b0: 1900 a101 8301 7d0c 7400 a00d 7c08 6409  ......}.t...|.d.
-0000b7c0: 1900 6401 a102 7d0d 7400 6a0e 7c00 6400  ..d...}.t.j.|.d.
-0000b7d0: 6400 8502 6400 6400 8502 6406 7c0a 8502  d...d.d...d.|...
-0000b7e0: 6406 7c0c 8502 6604 1900 640a 640b 8d02  d.|...f...d.d...
-0000b7f0: 7c09 6400 6400 8502 6400 6400 8502 6406  |.d.d...d.d...d.
-0000b800: 6406 6604 3c00 7c09 6400 6400 8502 6400  d.f.<.|.d.d...d.
-0000b810: 6400 8502 6406 6406 6604 1900 7c0b 7c00  d...d.d.f...|.|.
-0000b820: 6400 6400 8502 6400 6400 8502 7408 7c0a  d.d...d.d...t.|.
-0000b830: 6401 1700 8301 7c0c 6604 1900 1400 1700  d.....|.f.......
-0000b840: 7c0d 7c00 6400 6400 8502 6400 6400 8502  |.|.d.d...d.d...
-0000b850: 7c0a 7408 7c0c 6401 1700 8301 6604 1900  |.t.|.d.....f...
-0000b860: 1400 1700 7c0b 7c0d 1400 7c00 6400 6400  ....|.|...|.d.d.
-0000b870: 8502 6400 6400 8502 7408 7c0a 6401 1700  ..d.d...t.|.d...
-0000b880: 8301 7408 7c0c 6401 1700 8301 6604 1900  ..t.|.d.....f...
-0000b890: 1400 1700 7c09 6400 6400 8502 6400 6400  ....|.d.d...d.d.
-0000b8a0: 8502 6406 6406 6604 3c00 7408 7400 a006  ..d.d.f.<.t.t...
-0000b8b0: 7c07 640c 1900 a101 8301 7d0e 6401 7400  |.d.......}.d.t.
-0000b8c0: a00d 7c07 640c 1900 6401 a102 1800 7d0f  ..|.d...d.....}.
-0000b8d0: 7408 7400 a006 7c07 640c 1900 a101 8301  t.t...|.d.......
-0000b8e0: 7d10 6401 7400 a00d 7c08 640c 1900 6401  }.d.t...|.d...d.
-0000b8f0: a102 1800 7d11 7400 6a0e 7c00 6400 6400  ....}.t.j.|.d.d.
-0000b900: 8502 6400 6400 8502 7c0e 7408 7c07 640d  ..d.d...|.t.|.d.
-0000b910: 1900 8301 8502 7c10 7408 7c08 640d 1900  ......|.t.|.d...
-0000b920: 8301 8502 6604 1900 640a 640b 8d02 7c09  ....f...d.d...|.
-0000b930: 6400 6400 8502 6400 6400 8502 640e 640e  d.d...d.d...d.d.
-0000b940: 6604 3c00 7c09 6400 6400 8502 6400 6400  f.<.|.d.d...d.d.
-0000b950: 8502 640e 640e 6604 1900 7c0f 7c00 6400  ..d.d.f...|.|.d.
-0000b960: 6400 8502 6400 6400 8502 7408 7c0e 6401  d...d.d...t.|.d.
-0000b970: 1800 8301 7c10 6604 1900 1400 1700 7c11  ....|.f.......|.
-0000b980: 7c00 6400 6400 8502 6400 6400 8502 7c0e  |.d.d...d.d...|.
-0000b990: 7408 7c10 6401 1800 8301 6604 1900 1400  t.|.d.....f.....
-0000b9a0: 1700 7c0f 7c11 1400 7c00 6400 6400 8502  ..|.|...|.d.d...
-0000b9b0: 6400 6400 8502 7408 7c0e 6401 1800 8301  d.d...t.|.d.....
-0000b9c0: 7408 7c10 6401 1800 8301 6604 1900 1400  t.|.d.....f.....
-0000b9d0: 1700 7c09 6400 6400 8502 6400 6400 8502  ..|.d.d...d.d...
-0000b9e0: 640e 640e 6604 3c00 7400 a00f 6401 7c04  d.d.f.<.t...d.|.
-0000b9f0: 6404 1900 6401 1800 a102 4400 9002 5d0e  d...d.....D...].
-0000ba00: 7d12 7400 a00f 6401 7c04 6405 1900 6401  }.t...d.|.d...d.
-0000ba10: 1800 a102 4400 9001 5df0 7d13 7408 7400  ....D...].}.t.t.
-0000ba20: a006 7c07 7c12 6406 6602 1900 a101 8301  ..|.|.d.f.......
-0000ba30: 7d14 7408 7400 a00c 7c07 7c12 6401 6602  }.t.t...|.|.d.f.
-0000ba40: 1900 a101 8301 7d15 6401 7400 a00d 7c07  ......}.d.t...|.
-0000ba50: 7c12 6406 6602 1900 6401 a102 1800 7d16  |.d.f...d.....}.
-0000ba60: 7400 a00d 7c07 7c12 6401 6602 1900 6401  t...|.|.d.f...d.
-0000ba70: a102 7d17 7408 7400 a006 7c08 7c13 6406  ..}.t.t...|.|.d.
-0000ba80: 6602 1900 a101 8301 7d18 7408 7400 a00c  f.......}.t.t...
-0000ba90: 7c08 7c13 6401 6602 1900 a101 8301 7d19  |.|.d.f.......}.
-0000baa0: 6401 7400 a00d 7c08 7c13 6406 6602 1900  d.t...|.|.d.f...
-0000bab0: 6401 a102 1800 7d1a 7400 a00d 7c08 7c13  d.....}.t...|.|.
-0000bac0: 6401 6602 1900 6401 a102 7d1b 7400 6a0e  d.f...d...}.t.j.
-0000bad0: 7c00 6400 6400 8502 6400 6400 8502 7c14  |.d.d...d.d...|.
-0000bae0: 7c15 8502 7c18 7c19 8502 6604 1900 640a  |...|.|...f...d.
-0000baf0: 640b 8d02 7d1c 7c1c 7c16 7c00 6400 6400  d...}.|.|.|.d.d.
-0000bb00: 8502 6400 6400 8502 7408 7c14 6401 1800  ..d.d...t.|.d...
-0000bb10: 8301 7c18 6604 1900 1400 1700 7c1a 7c00  ..|.f.......|.|.
-0000bb20: 6400 6400 8502 6400 6400 8502 7c14 7408  d.d...d.d...|.t.
-0000bb30: 7c18 6401 1800 8301 6604 1900 1400 1700  |.d.....f.......
-0000bb40: 7c16 7c1a 1400 7c00 6400 6400 8502 6400  |.|...|.d.d...d.
-0000bb50: 6400 8502 7408 7c14 6401 1800 8301 7408  d...t.|.d.....t.
-0000bb60: 7c18 6401 1800 8301 6604 1900 1400 1700  |.d.....f.......
-0000bb70: 7d1c 7c1c 7c17 7c00 6400 6400 8502 6400  }.|.|.|.d.d...d.
-0000bb80: 6400 8502 7408 7c15 6401 1700 8301 7c19  d...t.|.d.....|.
-0000bb90: 6604 1900 1400 1700 7c1b 7c00 6400 6400  f.......|.|.d.d.
-0000bba0: 8502 6400 6400 8502 7c15 7408 7c19 6401  ..d.d...|.t.|.d.
-0000bbb0: 1700 8301 6604 1900 1400 1700 7c17 7c1b  ....f.......|.|.
-0000bbc0: 1400 7c00 6400 6400 8502 6400 6400 8502  ..|.d.d...d.d...
-0000bbd0: 7408 7c15 6401 1700 8301 7408 7c19 6401  t.|.d.....t.|.d.
-0000bbe0: 1700 8301 6604 1900 1400 1700 7d1c 7c1c  ....f.......}.|.
-0000bbf0: 7c09 6400 6400 8502 6400 6400 8502 7c12  |.d.d...d.d...|.
-0000bc00: 7c13 6604 3c00 9004 7114 9003 71fa 7c09  |.f.<...q...q.|.
-0000bc10: 7c06 7c05 1400 1b00 7d09 7c09 5300 290f  |.|.....}.|.S.).
-0000bc20: 4e72 2700 0000 72f9 0000 0072 6100 0000  Nr'...r....ra...
-0000bc30: 7225 0000 0072 2600 0000 7201 0000 0029  r%...r&...r....)
-0000bc40: 03da 0573 7461 7274 da04 7374 6f70 da03  ...start..stop..
-0000bc50: 6e75 6d72 5700 0000 7291 0000 0072 dd00  numrW...r....r..
-0000bc60: 0000 7238 0000 0029 0272 0600 0000 7201  ..r8...).r....r.
-0000bc70: 0000 0029 0272 0600 0000 7227 0000 0072  ...).r....r'...r
-0000bc80: 0600 0000 2910 7209 0000 0072 7a00 0000  ....).r....rz...
-0000bc90: 7258 0000 0072 8d00 0000 7218 0000 0072  rX...r....r....r
-0000bca0: 1900 0000 72fa 0000 0072 4200 0000 722f  ....r....rB...r/
-0000bcb0: 0000 0072 2e00 0000 da08 6c69 6e73 7061  ...r......linspa
-0000bcc0: 6365 7241 0000 00da 0566 6c6f 6f72 da03  cerA.....floor..
-0000bcd0: 6d6f 6472 0a00 0000 728b 0000 0029 1d72  modr....r....).r
-0000bce0: ff00 0000 725a 0000 0072 fb00 0000 72fc  ....rZ...r....r.
-0000bcf0: 0000 0072 fd00 0000 5a05 6462 696e 795a  ...r....Z.dbinyZ
-0000bd00: 0564 6269 6e78 5a05 6269 6e5f 795a 0562  .dbinxZ.bin_yZ.b
-0000bd10: 696e 5f78 72fe 0000 005a 0a73 746f 7070  in_xr....Z.stopp
-0000bd20: 6572 5f30 695a 0974 6f70 7065 725f 3069  er_0iZ.topper_0i
-0000bd30: 5a0a 7374 6f70 7065 725f 306a 5a09 746f  Z.stopper_0jZ.to
-0000bd40: 7070 6572 5f30 6a5a 0a73 7461 7274 6572  pper_0jZ.starter
-0000bd50: 5f31 695a 086c 6f77 6572 5f31 695a 0a73  _1iZ.lower_1iZ.s
-0000bd60: 7461 7274 6572 5f31 6a5a 086c 6f77 6572  tarter_1jZ.lower
-0000bd70: 5f31 6a72 2200 0000 72d7 0000 0072 0001  _1jr"...r....r..
-0000bd80: 0000 7201 0100 005a 086c 6f77 6572 5f69  ..r....Z.lower_i
-0000bd90: 695a 0974 6f70 7065 725f 6969 7202 0100  iZ.topper_iir...
-0000bda0: 0072 0301 0000 5a08 6c6f 7765 725f 6a6a  .r....Z.lower_jj
-0000bdb0: 5a09 746f 7070 6572 5f6a 6a72 0401 0000  Z.topper_jjr....
-0000bdc0: 720f 0000 0072 0f00 0000 7210 0000 00da  r....r....r.....
-0000bdd0: 0d62 696e 5f73 6361 6e5f 7465 7374 3b06  .bin_scan_test;.
-0000bde0: 0000 73c4 0000 0000 010e 010a 010a 010c  ..s.............
-0000bdf0: 010c 0114 0210 0110 0212 0112 021a 010a  ................
-0000be00: ff10 031a 010e ff10 031a 010a ff10 031a  ................
-0000be10: 010e ff10 0418 0212 0110 0112 0110 0104  ................
-0000be20: 0120 ff1a 0416 0122 ff02 0222 fe02 0402  . ....."..."....
-0000be30: 0102 ff02 0226 fe02 fc02 ff16 0b12 0114  .....&..........
-0000be40: 0112 0114 0104 012e 0102 fe1a 0516 0122  ..............."
-0000be50: ff02 0222 fe02 032e fd02 ff16 071a 011a  ..."............
-0000be60: 0116 0116 0118 0114 0216 0116 0118 0114  ................
-0000be70: 0204 0120 ff06 0602 0122 ff02 0222 fe02  ... ....."..."..
-0000be80: 0402 0102 ff02 0226 fe02 fc02 ff02 0d02  .......&........
-0000be90: 0122 ff02 0222 fe02 0402 0102 ff02 0226  ."...".........&
-0000bea0: fe02 fc02 ff02 0b20 020c 0172 1801 0000  ....... ...r....
-0000beb0: da02 6e6d a902 e916 0000 00e9 1500 0000  ..nm............
-0000bec0: 6309 0000 0000 0000 0000 0000 0018 0000  c...............
-0000bed0: 000d 0000 0043 0000 0073 0a04 0000 6401  .....C...s....d.
-0000bee0: 6402 8400 7d09 7c05 6403 6b02 725c 6404  d...}.|.d.k.r\d.
-0000bef0: 7400 a001 7400 a002 7400 a001 7400 a003  t...t...t...t...
-0000bf00: 7c00 a101 a101 7400 a001 7400 a003 7c01  |.....t...t...|.
-0000bf10: a101 a101 7400 a001 7400 a003 7c02 a101  ....t...t...|...
-0000bf20: a101 7400 a001 7400 a003 7c03 a101 a101  ..t...t...|.....
-0000bf30: 6604 a101 a101 1400 7d05 7404 6405 7400  f.......}.t.d.t.
-0000bf40: a005 7c08 a101 1400 8301 7d0a 6406 7c0a  ..|.......}.d.|.
-0000bf50: 6407 9c02 7d0b 7406 6a07 642d 6900 7c0b  d...}.t.j.d-i.|.
-0000bf60: a401 8e01 0100 7408 6a09 7c08 6409 8d01  ......t.j.|.d...
-0000bf70: 0100 740a a00b 640a 640b a102 7d0c 7408  ..t...d.d...}.t.
-0000bf80: a00c 7c0c 6403 640c 8502 6403 640c 8502  ..|.d.d...d.d...
-0000bf90: 6602 1900 a101 7d0d 7408 a00c 7c0c 6403  f.....}.t...|.d.
-0000bfa0: 640c 8502 640d 640b 8502 6602 1900 a101  d...d.d...f.....
-0000bfb0: 7d0e 7408 a00c 7c0c 640c 640e 8502 6403  }.t...|.d.d...d.
-0000bfc0: 640c 8502 6602 1900 a101 7d0f 7408 a00c  d...f.....}.t...
-0000bfd0: 7c0c 640c 640e 8502 640d 640b 8502 6602  |.d.d...d.d...f.
-0000bfe0: 1900 a101 7d10 7408 a00c 7c0c 640e 640a  ....}.t...|.d.d.
-0000bff0: 8502 640f 640f 8502 6602 1900 a101 7d11  ..d.d...f.....}.
-0000c000: 7c0d a00d 7c09 6404 7c00 1400 7c04 7c05  |...|.d.|...|.|.
-0000c010: 8303 a101 0100 740e 6a0f 6410 7410 7c0a  ......t.j.d.t.|.
-0000c020: 6411 8d01 6412 6413 6414 8d04 7d12 7c12  d...d.d.d...}.|.
-0000c030: 6a11 a012 6415 a101 0100 7c0d a013 7c12  j...d.....|...|.
-0000c040: a101 0100 7c06 6403 6b04 9001 7298 7414  ....|.d.k...r.t.
-0000c050: a015 7c06 7c07 a102 7d13 6416 7c13 5f16  ..|.|...}.d.|._.
-0000c060: 6417 7c13 5f17 6418 7c13 5f18 7c0d a013  d.|._.d.|._.|...
-0000c070: 7c13 a101 0100 7c0d a019 6419 a101 0100  |.....|...d.....
-0000c080: 7c0e a00d 7c09 6404 7c01 1400 7c04 7c05  |...|.d.|...|.|.
-0000c090: 8303 a101 0100 740e 6a0f 641a 7410 7c0a  ......t.j.d.t.|.
-0000c0a0: 6411 8d01 6412 6413 6414 8d04 7d12 7c12  d...d.d.d...}.|.
-0000c0b0: 6a11 a012 6415 a101 0100 7c0e a013 7c12  j...d.....|...|.
-0000c0c0: a101 0100 7c06 6403 6b04 9002 7218 7414  ....|.d.k...r.t.
-0000c0d0: a015 7c06 7c07 a102 7d13 6416 7c13 5f16  ..|.|...}.d.|._.
-0000c0e0: 6417 7c13 5f17 6418 7c13 5f18 7c0e a013  d.|._.d.|._.|...
-0000c0f0: 7c13 a101 0100 7c0e a019 6419 a101 0100  |.....|...d.....
-0000c100: 7c0f a00d 7c09 6404 7c02 1400 7c04 7c05  |...|.d.|...|.|.
-0000c110: 8303 a101 0100 740e 6a0f 641b 7410 7c0a  ......t.j.d.t.|.
-0000c120: 6411 8d01 6412 6413 6414 8d04 7d12 7c12  d...d.d.d...}.|.
-0000c130: 6a11 a012 6415 a101 0100 7c0f a013 7c12  j...d.....|...|.
-0000c140: a101 0100 7c06 6403 6b04 9002 7298 7414  ....|.d.k...r.t.
-0000c150: a015 7c06 7c07 a102 7d13 6416 7c13 5f16  ..|.|...}.d.|._.
-0000c160: 6417 7c13 5f17 6418 7c13 5f18 7c0f a013  d.|._.d.|._.|...
-0000c170: 7c13 a101 0100 7c0f a019 6419 a101 0100  |.....|...d.....
-0000c180: 7c10 a00d 7c09 6404 7c03 1400 7c04 7c05  |...|.d.|...|.|.
-0000c190: 8303 a101 0100 740e 6a0f 641c 7410 7c0a  ......t.j.d.t.|.
-0000c1a0: 6411 8d01 6412 6413 6414 8d04 7d12 7c12  d...d.d.d...}.|.
-0000c1b0: 6a11 a012 6415 a101 0100 7c10 a013 7c12  j...d.....|...|.
-0000c1c0: a101 0100 7c06 6403 6b04 9003 7218 7414  ....|.d.k...r.t.
-0000c1d0: a015 7c06 7c07 a102 7d13 6416 7c13 5f16  ..|.|...}.d.|._.
-0000c1e0: 6417 7c13 5f17 6418 7c13 5f18 7c10 a013  d.|._.d.|._.|...
-0000c1f0: 7c13 a101 0100 7c10 a019 6419 a101 0100  |.....|...d.....
-0000c200: 7400 6a1a 641d 7400 6a1b 641e 8d02 7d14  t.j.d.t.j.d...}.
-0000c210: 741c 640c 8301 4400 5d22 7d15 7400 a01d  t.d...D.]"}.t...
-0000c220: 7c05 0b00 7c05 641f a103 7c14 7c15 640f  |...|.d...|.|.d.
-0000c230: 640f 8502 6602 3c00 9003 713a 7c11 6a0d  d...f.<...q:|.j.
-0000c240: 7c14 6420 6421 8d02 0100 7c11 6a1e a01f  |.d d!....|.j...
-0000c250: 6422 a101 0100 7400 a01d 6403 641f 6423  d"....t...d.d.d#
-0000c260: a103 7d16 7c11 a020 7c16 a101 0100 7c11  ..}.|.. |.....|.
-0000c270: a021 7400 a022 7400 a01d 7c05 0b00 7c05  .!t.."t...|...|.
-0000c280: 6423 a103 6424 a102 a101 0100 6425 4400  d#..d$......d%D.
-0000c290: 5d26 7d17 7c11 6a23 7c17 1900 a024 6424  ]&}.|.j#|....$d$
-0000c2a0: a101 0100 7c11 6a23 7c17 1900 a025 6426  ....|.j#|....%d&
-0000c2b0: a101 0100 9003 71b2 7c11 6a26 6a27 6424  ......q.|.j&j'd$
-0000c2c0: 6427 6428 640c 6429 8d04 0100 7c11 6a28  d'd(d.d)....|.j(
-0000c2d0: 642a 642b 6406 642c 8d03 0100 7408 a029  d*d+d.d,....t..)
-0000c2e0: a100 0100 640f 5300 292e 61f1 0500 000a  ....d.S.).a.....
-0000c2f0: 2020 2020 506c 6f74 2074 6865 2073 7472      Plot the str
-0000c300: 6169 6e20 6d61 7073 2066 726f 6d20 6120  ain maps from a 
-0000c310: 6769 7665 6e20 7365 7420 6f66 2073 7472  given set of str
-0000c320: 6169 6e73 2c20 7768 6572 6520 7468 6520  ains, where the 
-0000c330: 7374 7261 696e 2069 730a 2020 2020 6d61  strain is.    ma
-0000c340: 7070 6564 206f 6e6c 7920 696e 2074 6865  pped only in the
-0000c350: 2072 6567 696f 6e20 6f66 2069 6e74 6572   region of inter
-0000c360: 6573 742c 2077 6869 6c65 2061 6e79 7468  est, while anyth
-0000c370: 696e 6720 6f75 7473 6964 6520 7468 6520  ing outside the 
-0000c380: 7265 6769 6f6e 0a20 2020 206f 6620 696e  region.    of in
-0000c390: 7465 7265 7374 2069 7320 626c 6163 6b2e  terest is black.
-0000c3a0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0000c3b0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-0000c3c0: 2020 2020 6578 783a 2020 2020 2020 2020      exx:        
-0000c3d0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-0000c3e0: 2020 2020 2020 2020 3244 2061 7272 6179          2D array
-0000c3f0: 206f 6620 655f 7878 2073 7472 6169 6e73   of e_xx strains
-0000c400: 0a20 2020 2065 7979 3a20 2020 2020 2020  .    eyy:       
-0000c410: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-0000c420: 2020 2020 2020 2020 2032 4420 6172 7261           2D arra
-0000c430: 7920 6f66 2065 5f79 7920 7374 7261 696e  y of e_yy strain
-0000c440: 730a 2020 2020 6574 683a 2020 2020 2020  s.    eth:      
-0000c450: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-0000c460: 2020 2020 2020 2020 2020 3244 2061 7272            2D arr
-0000c470: 6179 206f 6620 655f 7468 6574 6120 7374  ay of e_theta st
-0000c480: 7261 696e 730a 2020 2020 6579 793a 2020  rains.    eyy:  
-0000c490: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-0000c4a0: 2020 2020 2020 2020 2020 2020 2020 3244                2D
-0000c4b0: 2061 7272 6179 206f 6620 655f 7979 2073   array of e_yy s
-0000c4c0: 7472 6169 6e73 0a20 2020 2052 4f49 3a20  trains.    ROI: 
-0000c4d0: 2020 2020 2020 206e 6461 7272 6179 206f         ndarray o
-0000c4e0: 6620 7479 7065 2062 6f6f 6c0a 2020 2020  f type bool.    
-0000c4f0: 2020 2020 2020 2020 2020 2020 5265 6769              Regi
-0000c500: 6f6e 206f 6620 696e 7465 7265 7374 0a20  on of interest. 
-0000c510: 2020 2076 6d3a 2020 2020 2020 2020 2066     vm:         f
-0000c520: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-0000c530: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-0000c540: 6178 696d 756d 2076 616c 7565 206f 6620  aximum value of 
-0000c550: 7374 7261 696e 206d 6170 0a20 2020 2020  strain map.     
-0000c560: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0000c570: 6c74 2069 7320 302c 2061 6e64 2077 6865  lt is 0, and whe
-0000c580: 6e20 6974 2773 207a 6572 6f2c 0a20 2020  n it's zero,.   
-0000c590: 2020 2020 2020 2020 2020 2020 2069 7420               it 
-0000c5a0: 7769 6c6c 2063 616c 6375 6c61 7465 2074  will calculate t
-0000c5b0: 6865 206d 6178 696d 756d 2061 6273 6f6c  he maximum absol
-0000c5c0: 7574 650a 2020 2020 2020 2020 2020 2020  ute.            
-0000c5d0: 2020 2020 7374 7261 696e 2076 616c 7565      strain value
-0000c5e0: 2061 6e64 2075 7365 2074 6861 742e 0a20   and use that.. 
-0000c5f0: 2020 2073 6361 6c65 3a20 2020 2020 2066     scale:      f
-0000c600: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
-0000c610: 2020 2020 2020 2020 2020 2020 2020 2050                 P
-0000c620: 6978 656c 2073 697a 652e 2044 6566 6175  ixel size. Defau
-0000c630: 6c74 2069 7320 300a 2020 2020 7363 616c  lt is 0.    scal
-0000c640: 655f 756e 6974 3a20 6368 6172 2c20 6f70  e_unit: char, op
-0000c650: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000c660: 2020 2020 2020 2055 6e69 7473 206f 6620         Units of 
-0000c670: 7468 6520 6361 6c69 6272 6174 696f 6e2e  the calibration.
-0000c680: 2044 6566 6175 6c74 2069 7320 276e 6d27   Default is 'nm'
-0000c690: 0a20 2020 2066 6967 7369 7a65 3a20 2020  .    figsize:   
-0000c6a0: 2074 7570 6c65 2c20 6f70 7469 6f6e 616c   tuple, optional
-0000c6b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c6c0: 2053 697a 6520 6f66 2074 6865 2066 696e   Size of the fin
-0000c6d0: 616c 2066 6967 7572 650a 0a20 2020 204e  al figure..    N
-0000c6e0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-0000c6f0: 2020 2054 6869 7320 6973 2062 6173 6963     This is basic
-0000c700: 616c 6c79 2061 206e 6963 6520 6675 6e63  ally a nice func
-0000c710: 7469 6f6e 2066 6f72 2070 6c6f 7474 696e  tion for plottin
-0000c720: 6720 6361 6c63 756c 6174 6564 2073 7472  g calculated str
-0000c730: 6169 6e20 6d61 7073 0a20 2020 2066 726f  ain maps.    fro
-0000c740: 6d20 6120 7265 6769 6f6e 206f 6620 696e  m a region of in
-0000c750: 7465 7265 7374 2e20 5765 2075 7365 2074  terest. We use t
-0000c760: 6865 2052 6442 755f 722c 2077 6869 6368  he RdBu_r, which
-0000c770: 2069 7320 7468 6520 5264 4275 2072 6576   is the RdBu rev
-0000c780: 6572 7365 640a 2020 2020 636f 6c6f 7220  ersed.    color 
-0000c790: 7363 6865 6d65 2c20 7768 6572 6520 3020  scheme, where 0 
-0000c7a0: 6973 2077 6869 7465 2c20 6e65 6761 7469  is white, negati
-0000c7b0: 7665 2076 616c 7565 7320 6172 6520 696e  ve values are in
-0000c7c0: 6372 6561 7369 6e67 6c79 2062 6c75 6520  creasingly blue 
-0000c7d0: 7468 650a 2020 2020 6d6f 7265 206e 6567  the.    more neg
-0000c7e0: 6174 6976 6520 7468 6579 2061 7265 2c20  ative they are, 
-0000c7f0: 7768 696c 6520 706f 7369 7469 7665 2076  while positive v
-0000c800: 616c 7565 7320 6172 6520 696e 6372 6561  alues are increa
-0000c810: 7369 6e67 6c79 2072 6564 2074 6865 206d  singly red the m
-0000c820: 6f72 650a 2020 2020 706f 7369 7469 7665  ore.    positive
-0000c830: 2074 6865 7920 6172 652e 2041 6e79 7468   they are. Anyth
-0000c840: 696e 6720 6f75 7473 6964 6520 7468 6520  ing outside the 
-0000c850: 7265 6769 6f6e 206f 6620 696e 7465 7265  region of intere
-0000c860: 7374 2069 7320 626c 6163 6b2c 2061 6e64  st is black, and
-0000c870: 2074 6875 730a 2020 2020 746f 2061 6e20   thus.    to an 
-0000c880: 6f62 7365 7276 6572 2074 6865 2052 4f49  observer the ROI
-0000c890: 2063 616e 2062 6520 7669 7375 616c 697a   can be visualiz
-0000c8a0: 6564 2063 6c65 6172 6c79 2e20 4f70 7469  ed clearly. Opti
-0000c8b0: 6f6e 616c 6c79 2c20 6120 7363 616c 6562  onally, a scaleb
-0000c8c0: 6172 2063 616e 0a20 2020 2062 6520 6173  ar can.    be as
-0000c8d0: 7369 676e 6564 2074 6f6f 2e0a 2020 2020  signed too..    
-0000c8e0: 6303 0000 0000 0000 0000 0000 0007 0000  c...............
-0000c8f0: 0006 0000 0053 0000 0073 b600 0000 7400  .....S...s....t.
-0000c900: 6a01 6401 7400 6a02 6402 8d02 7d03 7403  j.d.t.j.d...}.t.
-0000c910: 6403 8301 4400 5d2a 7d04 7400 a004 7405  d...D.]*}.t...t.
-0000c920: 6a06 a007 7c04 a101 6404 6405 8502 1900  j...|...d.d.....
-0000c930: a101 7c03 7c04 6404 6405 8502 6602 3c00  ..|.|.d.d...f.<.
-0000c940: 7118 7400 a001 7c00 6a08 6404 1900 7c00  q.t...|.j.d...|.
-0000c950: 6a08 6406 1900 6405 6603 a101 7d05 6403  j.d...d.f...}.d.
-0000c960: 7c00 7c01 1900 7c02 1700 6407 7c02 1400  |.|...|...d.|...
-0000c970: 1b00 1400 a009 740a a101 7d06 6403 7c06  ......t...}.d.|.
-0000c980: 7c06 6403 6b04 3c00 6404 7c06 7c06 6404  |.d.k.<.d.|.|.d.
-0000c990: 6b00 3c00 7c03 7c06 6400 6400 8502 6602  k.<.|.|.d.d...f.
-0000c9a0: 1900 7c05 7c01 6404 6405 8502 6602 3c00  ..|.|.d.d...f.<.
-0000c9b0: 7c05 5300 2908 4e29 02e9 0001 0000 7226  |.S.).N)......r&
-0000c9c0: 0000 0072 5700 0000 e9ff 0000 0072 0100  ...rW........r..
-0000c9d0: 0000 7226 0000 0072 2700 0000 7225 0000  ..r&...r'...r%..
-0000c9e0: 0029 0b72 0900 0000 722e 0000 0072 db00  .).r....r....r..
-0000c9f0: 0000 721b 0000 0072 1800 0000 da03 6d70  ..r....r......mp
-0000ca00: 6cda 0263 6dda 0652 6442 755f 7272 1900  l..cm..RdBu_rr..
-0000ca10: 0000 7242 0000 0072 2f00 0000 2907 5a06  ..rB...r/...).Z.
-0000ca20: 7661 6c6d 6170 da03 726f 695a 0876 616c  valmap..roiZ.val
-0000ca30: 7261 6e67 655a 0870 6c6f 745f 636f 6c72  rangeZ.plot_colr
-0000ca40: 2200 0000 5a07 6d61 705f 636f 6c5a 0963  "...Z.map_colZ.c
-0000ca50: 6f6c 6f72 7661 6c73 720f 0000 0072 0f00  olorvalsr....r..
-0000ca60: 0000 7210 0000 00da 0c52 4f49 5f52 6442  ..r......ROI_RdB
-0000ca70: 755f 6d61 70d2 0600 0073 1200 0000 0001  u_map....s......
-0000ca80: 1001 0c01 2801 1c01 1e01 0c01 0c01 1c01  ....(...........
-0000ca90: 7a23 7374 7261 696e 5f66 6967 7572 652e  z#strain_figure.
-0000caa0: 3c6c 6f63 616c 733e 2e52 4f49 5f52 6442  <locals>.ROI_RdB
-0000cab0: 755f 6d61 7072 0100 0000 e964 0000 0067  u_mapr.....d...g
-0000cac0: 0000 0000 0000 f43f 5a04 626f 6c64 2902  .......?Z.bold).
-0000cad0: da06 7765 6967 6874 722d 0000 00da 0466  ..weightr-.....f
-0000cae0: 6f6e 7472 6600 0000 721c 0100 0072 1b01  ontrf...r....r..
-0000caf0: 0000 72a6 0000 00e9 0c00 0000 720a 0100  ..r.........r...
-0000cb00: 004e 7a18 245c 6d61 7468 726d 7b5c 6570  .Nz.$\mathrm{\ep
-0000cb10: 7369 6c6f 6e5f 7b78 787d 7d24 2901 722d  silon_{xx}}$).r-
-0000cb20: 0000 0054 7a0b 6c6f 7765 7220 7269 6768  ...Tz.lower righ
-0000cb30: 7429 03da 0470 726f 705a 0766 7261 6d65  t)...propZ.frame
-0000cb40: 6f6e da03 6c6f 637a 2272 6f75 6e64 2c20  on..locz"round, 
-0000cb50: 7061 643d 2030 2e2c 2072 6f75 6e64 696e  pad= 0., roundin
-0000cb60: 675f 7369 7a65 3d20 302e 327a 0a6c 6f77  g_size= 0.2z.low
-0000cb70: 6572 206c 6566 7472 2700 0000 da01 6bda  er leftr'.....k.
-0000cb80: 036f 6666 7a18 245c 6d61 7468 726d 7b5c  .offz.$\mathrm{\
-0000cb90: 6570 7369 6c6f 6e5f 7b78 797d 7d24 7a1c  epsilon_{xy}}$z.
-0000cba0: 245c 6d61 7468 726d 7b5c 6570 7369 6c6f  $\mathrm{\epsilo
-0000cbb0: 6e5f 7b5c 7468 6574 617d 7d24 7a18 245c  n_{\theta}}$z.$\
-0000cbc0: 6d61 7468 726d 7b5c 6570 7369 6c6f 6e5f  mathrm{\epsilon_
-0000cbd0: 7b79 797d 7d24 2902 72a6 0000 0072 da00  {yy}}$).r....r..
-0000cbe0: 0000 7257 0000 0072 da00 0000 7221 0100  ..rW...r....r!..
-0000cbf0: 0072 6800 0000 46e9 0800 0000 7225 0000  .rh...F.....r%..
-0000cc00: 0029 04da 0374 6f70 5a06 626f 7474 6f6d  .)...topZ.bottom
-0000cc10: da04 6c65 6674 da05 7269 6768 745a 0562  ..left..rightZ.b
-0000cc20: 6c61 636b 72eb 0000 00da 036f 7574 2904  lackr......out).
-0000cc30: da05 7769 6474 68da 066c 656e 6774 68da  ..width..length.
-0000cc40: 0964 6972 6563 7469 6f6e da03 7061 647a  .direction..padz
-0000cc50: 0a53 7472 6169 6e20 2825 2972 6a00 0000  .Strain (%)rj...
-0000cc60: 2902 da08 666f 6e74 7369 7a65 5a0a 666f  )...fontsizeZ.fo
-0000cc70: 6e74 7765 6967 6874 2901 7226 0100 0029  ntweight).r&...)
-0000cc80: 2a72 0900 0000 7287 0000 0072 1800 0000  *r....r....r....
-0000cc90: 721c 0000 0072 2f00 0000 72f1 0000 0072  r....r/...r....r
-0000cca0: 1f01 0000 da02 7263 726f 0000 0072 7000  ......rcro...rp.
-0000ccb0: 0000 da04 6d70 6773 5a08 4772 6964 5370  ....mpgsZ.GridSp
-0000ccc0: 6563 5a07 7375 6270 6c6f 7472 7100 0000  ecZ.subplotrq...
-0000ccd0: da06 6d70 6c6f 6666 5a0c 416e 6368 6f72  ..mploffZ.Anchor
-0000cce0: 6564 5465 7874 da04 6469 6374 5a05 7061  edText..dictZ.pa
-0000ccf0: 7463 685a 0c73 6574 5f62 6f78 7374 796c  tchZ.set_boxstyl
-0000cd00: 655a 0a61 6464 5f61 7274 6973 74da 046d  eZ.add_artist..m
-0000cd10: 7073 735a 0853 6361 6c65 4261 72da 086c  pssZ.ScaleBar..l
-0000cd20: 6f63 6174 696f 6e5a 0962 6f78 5f61 6c70  ocationZ.box_alp
-0000cd30: 6861 5a05 636f 6c6f 7272 0c00 0000 722e  haZ.colorr....r.
-0000cd40: 0000 0072 db00 0000 721b 0000 0072 1501  ...r....r....r..
-0000cd50: 0000 5a05 7961 7869 735a 0b73 6574 5f76  ..Z.yaxisZ.set_v
-0000cd60: 6973 6962 6c65 5a0a 7365 745f 7874 6963  isibleZ.set_xtic
-0000cd70: 6b73 5a0f 7365 745f 7874 6963 6b6c 6162  ksZ.set_xticklab
-0000cd80: 656c 7372 5900 0000 5a06 7370 696e 6573  elsrY...Z.spines
-0000cd90: 5a0d 7365 745f 6c69 6e65 7769 6474 685a  Z.set_linewidthZ
-0000cda0: 0973 6574 5f63 6f6c 6f72 5a05 7861 7869  .set_colorZ.xaxi
-0000cdb0: 735a 0f73 6574 5f74 6963 6b5f 7061 7261  sZ.set_tick_para
-0000cdc0: 6d73 5a09 7365 745f 7469 746c 655a 0c74  msZ.set_titleZ.t
-0000cdd0: 6967 6874 5f6c 6179 6f75 7429 185a 0365  ight_layout).Z.e
-0000cde0: 7878 5a03 6578 79da 0365 7468 5a03 6579  xxZ.exy..ethZ.ey
-0000cdf0: 7972 8400 0000 5a02 766d 5a05 7363 616c  yr....Z.vmZ.scal
-0000ce00: 655a 0a73 6361 6c65 5f75 6e69 7472 6700  eZ.scale_unitrg.
-0000ce10: 0000 7223 0100 0072 3501 0000 5a07 7363  ..r#...r5...Z.sc
-0000ce20: 5f66 6f6e 745a 0267 735a 0361 7831 5a03  _fontZ.gsZ.ax1Z.
-0000ce30: 6178 325a 0361 7833 5a03 6178 345a 0361  ax2Z.ax3Z.ax4Z.a
-0000ce40: 7835 da02 6174 da08 7363 616c 6562 6172  x5..at..scalebar
-0000ce50: 5a02 7362 7222 0000 00da 0278 3172 0c00  Z.sbr".....x1r..
-0000ce60: 0000 720f 0000 0072 0f00 0000 7210 0000  ..r....r....r...
-0000ce70: 00da 0d73 7472 6169 6e5f 6669 6775 7265  ...strain_figure
-0000ce80: a706 0000 73c6 0000 0000 2b08 0b08 0106  ....s.....+.....
-0000ce90: 0104 020e 010e 010e 010e fc02 ff02 ff06  ................
-0000cea0: 0b12 010a 0110 010c 020c 011a 011a 011a  ................
-0000ceb0: 011a 011a 0216 0104 0102 0108 0102 0102  ................
-0000cec0: fc06 060c 010a 010a 010c 0106 0106 0106  ................
-0000ced0: 010a 010a 0216 0104 0102 0108 0102 0102  ................
-0000cee0: fc06 060c 010a 010a 010c 0106 0106 0106  ................
-0000cef0: 010a 010a 0216 0104 0102 0108 0102 0102  ................
-0000cf00: fc06 060c 010a 010a 010c 0106 0106 0106  ................
-0000cf10: 010a 010a 0216 0104 0102 0108 0102 0102  ................
-0000cf20: fc06 060c 010a 010a 010c 0106 0106 0106  ................
-0000cf30: 010a 010a 0210 010c 0120 010e 010c 010e  ......... ......
-0000cf40: 010a 011e 0108 0110 0114 0114 0110 0272  ...............r
-0000cf50: 4001 0000 a902 72e9 0000 0067 fca9 f1d2  @.....r....g....
-0000cf60: 4d62 503f 72eb 0000 0063 0400 0000 0000  MbP?r....c......
-0000cf70: 0000 0000 0000 1000 0000 0800 0000 4300  ..............C.
-0000cf80: 0000 73da 0100 0074 006a 01a0 027c 0164  ..s....t.j...|.d
-0000cf90: 017c 031b 00a1 027d 0474 006a 01a0 037c  .|.....}.t.j...|
-0000cfa0: 0464 02a1 025c 027d 057d 0674 006a 01a0  .d...\.}.}.t.j..
-0000cfb0: 027c 0064 017c 031b 00a1 027d 0774 006a  .|.d.|.....}.t.j
-0000cfc0: 01a0 047c 05a1 017d 0874 05a0 067c 08a1  ...|...}.t...|..
-0000cfd0: 017c 087c 0864 017c 031b 006b 0419 0018  .|.|.d.|...k....
-0000cfe0: 007c 031b 007d 097c 077c 0864 017c 031b  .|...}.|.|.d.|..
-0000cff0: 006b 0419 007d 0a74 05a0 0774 05a0 087c  .k...}.t...t...|
-0000d000: 0964 01a1 02a1 017d 0b7c 0b7c 0918 007d  .d.....}.|.|...}
-0000d010: 0974 05a0 0974 05a0 0a7c 097c 0a66 02a1  .t...t...|.|.f..
-0000d020: 01a1 017d 0c74 006a 01a0 0b7c 0c7c 02a1  ...}.t.j...|.|..
-0000d030: 027d 0c74 05a0 0c74 0d74 05a0 0e7c 0c64  .}.t...t.t...|.d
-0000d040: 0364 0385 0264 0466 0219 00a1 0183 0164  .d...d.f.......d
-0000d050: 0566 02a1 017d 0d74 05a0 0e7c 0c64 0364  .f...}.t...|.d.d
-0000d060: 0385 0264 0466 0219 00a1 017c 0d64 0364  ...d.f.....|.d.d
-0000d070: 0385 0264 0466 023c 007c 0c64 0364 0385  ...d.f.<.|.d.d..
-0000d080: 0264 0166 0219 007d 0a74 05a0 0f7c 0d6a  .d.f...}.t...|.j
-0000d090: 1064 0419 00a1 0144 005d bc7d 0e74 05a0  .d.....D.].}.t..
-0000d0a0: 117c 0a7c 0c64 0364 0385 0264 0466 0219  .|.|.d.d...d.f..
-0000d0b0: 007c 0d7c 0e64 0466 0219 006b 0219 00a1  .|.|.d.f...k....
-0000d0c0: 017c 0d7c 0e64 0166 023c 0074 0d7c 0a7c  .|.|.d.f.<.t.|.|
-0000d0d0: 0c64 0364 0385 0264 0466 0219 007c 0d7c  .d.d...d.f...|.|
-0000d0e0: 0e64 0466 0219 006b 0219 0083 017d 0f74  .d.f...k.....}.t
-0000d0f0: 05a0 127c 0a7c 0c64 0364 0385 0264 0466  ...|.|.d.d...d.f
-0000d100: 0219 007c 0d7c 0e64 0466 0219 006b 0219  ...|.|.d.f...k..
-0000d110: 00a1 017c 0d7c 0e64 0666 023c 0074 05a0  ...|.|.d.f.<.t..
-0000d120: 127c 0a7c 0c64 0364 0385 0264 0466 0219  .|.|.d.d...d.f..
-0000d130: 007c 0d7c 0e64 0466 0219 006b 0219 00a1  .|.|.d.f...k....
-0000d140: 017c 0f64 0713 001b 007c 0d7c 0e64 0866  .|.d.....|.|.d.f
-0000d150: 023c 0090 0171 127c 0c7c 0d7c 0b66 0353  .<...q.|.|.|.f.S
-0000d160: 0029 0961 9604 0000 0a20 2020 2047 6574  .).a.....    Get
-0000d170: 2073 7472 6169 6e20 6d61 7073 2066 726f   strain maps fro
-0000d180: 6d20 7468 6520 766f 6c75 6d65 2063 616c  m the volume cal
-0000d190: 6375 6c61 7469 6f6e 2061 6e64 2072 6567  culation and reg
-0000d1a0: 696f 6e20 6f66 0a20 2020 2069 6e74 6572  ion of.    inter
-0000d1b0: 6573 740a 0a20 2020 2050 6172 616d 6574  est..    Paramet
-0000d1c0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0000d1d0: 2d2d 0a20 2020 2076 6f6c 756d 653a 2020  --.    volume:  
-0000d1e0: 2020 206e 6461 7272 6179 2c20 666c 6f61     ndarray, floa
-0000d1f0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-0000d200: 2020 4361 6c63 756c 6174 6564 2076 6f6c    Calculated vol
-0000d210: 756d 6520 6672 6f6d 2073 7472 6169 6e0a  ume from strain.
-0000d220: 2020 2020 726f 693a 2020 2020 2020 2020      roi:        
-0000d230: 6e64 6172 7261 792c 2062 6f6f 6c0a 2020  ndarray, bool.  
-0000d240: 2020 2020 2020 2020 2020 2020 2020 5265                Re
-0000d250: 6769 6f6e 2077 6865 7265 2074 6865 2070  gion where the p
-0000d260: 6172 7469 636c 6520 6c69 6573 0a20 2020  article lies.   
-0000d270: 2070 7265 6369 7369 6f6e 3a20 2074 7570   precision:  tup
-0000d280: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
-0000d290: 2020 2054 6865 206e 756d 6265 7220 6f66     The number of
-0000d2a0: 2073 6967 6e69 6669 6361 6e74 2064 6967   significant dig
-0000d2b0: 6974 7320 696e 2065 6163 6820 6178 6573  its in each axes
-0000d2c0: 0a20 2020 2075 7073 616d 706c 696e 673a  .    upsampling:
-0000d2d0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-0000d2e0: 2020 2020 2055 7073 616d 706c 696e 6720       Upsampling 
-0000d2f0: 6661 6374 6f72 2066 6f72 2074 6865 2072  factor for the r
-0000d300: 6567 696f 6e20 6265 666f 7265 2063 616c  egion before cal
-0000d310: 6375 6c61 7469 6f6e 0a0a 2020 2020 5265  culation..    Re
-0000d320: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-0000d330: 2d0a 2020 2020 7261 7776 616c 733a 206e  -.    rawvals: n
-0000d340: 6461 7272 6179 2c20 666c 6f61 740a 2020  darray, float.  
-0000d350: 2020 2020 2020 2020 2020 2054 6865 2072             The r
-0000d360: 6177 2063 616c 6375 6c61 7465 6420 7374  aw calculated st
-0000d370: 7261 696e 2076 616c 7565 7320 6672 6f6d  rain values from
-0000d380: 2074 6865 2072 6567 696f 6e20 6f66 2069   the region of i
-0000d390: 6e74 6572 6573 740a 2020 2020 7374 7261  nterest.    stra
-0000d3a0: 696e 3a20 206e 6461 7272 6179 2c20 666c  in:  ndarray, fl
-0000d3b0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-0000d3c0: 2053 7472 6169 6e20 2873 6563 6f6e 6420   Strain (second 
-0000d3d0: 636f 6c75 6d6e 2920 6173 2061 2066 756e  column) as a fun
-0000d3e0: 6374 696f 6e20 6f66 2064 6973 7461 6e63  ction of distanc
-0000d3f0: 6520 6672 6f6d 2070 6172 7469 636c 650a  e from particle.
-0000d400: 2020 2020 2020 2020 2020 2020 2073 7572               sur
-0000d410: 6661 6365 2028 6669 7273 7420 636f 6c75  face (first colu
-0000d420: 6d6e 292c 2077 6974 6820 7374 616e 6461  mn), with standa
-0000d430: 7264 2065 7272 6f72 2028 7468 6972 6420  rd error (third 
-0000d440: 636f 6c75 6d6e 2920 616e 640a 2020 2020  column) and.    
-0000d450: 2020 2020 2020 2020 2073 7461 6e64 6172           standar
-0000d460: 6420 6465 7669 6174 696f 6e20 2866 6f75  d deviation (fou
-0000d470: 7274 6820 636f 6c75 6d6e 290a 2020 2020  rth column).    
-0000d480: 6d61 7864 6973 743a 2066 6c6f 6174 0a20  maxdist: float. 
-0000d490: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
-0000d4a0: 6d75 6d20 6469 7374 616e 6365 2066 726f  mum distance fro
-0000d4b0: 6d20 7375 7266 6163 650a 0a20 2020 204e  m surface..    N
-0000d4c0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-0000d4d0: 2020 2054 6865 2052 4f49 2069 7320 7570     The ROI is up
-0000d4e0: 7361 6d70 6c65 6420 6279 2074 6865 2075  sampled by the u
-0000d4f0: 7073 616d 706c 6564 2062 7920 7468 6520  psampled by the 
-0000d500: 7570 7361 6d70 6c69 6e67 2066 6163 746f  upsampling facto
-0000d510: 722c 2061 6e64 2074 6865 0a20 2020 2063  r, and the.    c
-0000d520: 6172 7465 7369 616e 2064 6973 7461 6e63  artesian distanc
-0000d530: 6573 2069 6e73 6964 6520 7468 6174 2052  es inside that R
-0000d540: 4f49 2066 726f 6d20 7468 6520 6e65 6172  OI from the near
-0000d550: 6573 7420 6564 6765 2070 6f69 6e74 2061  est edge point a
-0000d560: 7265 0a20 2020 2063 616c 6375 6c61 7465  re.    calculate
-0000d570: 642e 2054 6861 7427 7320 796f 7572 2078  d. That's your x
-0000d580: 2076 616c 7565 732c 2077 6869 6368 2069   values, which i
-0000d590: 7320 7468 6520 6469 7374 616e 6365 2066  s the distance f
-0000d5a0: 726f 6d20 7468 6520 7375 7266 6163 652c  rom the surface,
-0000d5b0: 0a20 2020 2077 6869 6c65 2074 6865 2079  .    while the y
-0000d5c0: 2076 616c 7565 7320 6172 6520 7468 6520   values are the 
-0000d5d0: 6361 6c63 756c 6174 6564 2076 6f6c 756d  calculated volum
-0000d5e0: 6520 7374 7261 696e 2061 7420 7468 6174  e strain at that
-0000d5f0: 2070 6f73 6974 696f 6e0a 2020 2020 7227   position.    r'
-0000d600: 0000 0072 0200 0000 4e72 0100 0000 7261  ...r....Nr....ra
-0000d610: 0000 0072 2500 0000 7216 0000 0072 2600  ...r%...r....r&.
-0000d620: 0000 2913 721d 0000 0072 1e00 0000 7256  ..).r....r....rV
-0000d630: 0000 0072 ad00 0000 72f2 0000 0072 0900  ...r....r....r..
-0000d640: 0000 72f1 0000 0072 8700 0000 7259 0000  ..r....r....rY..
-0000d650: 0072 2800 0000 7218 0000 005a 1372 6564  .r(...r....Z.red
-0000d660: 7563 655f 7072 6563 6973 696f 6e5f 7879  uce_precision_xy
-0000d670: 722e 0000 0072 3a00 0000 da06 756e 6971  r....r:.....uniq
-0000d680: 7565 728b 0000 0072 1900 0000 727e 0000  uer....r....r~..
-0000d690: 0072 9b00 0000 2910 da06 766f 6c75 6d65  .r....)...volume
-0000d6a0: 7222 0100 005a 0970 7265 6369 7369 6f6e  r"...Z.precision
-0000d6b0: 72f4 0000 0072 f500 0000 72f6 0000 0072  r....r....r....r
-0000d6c0: a400 0000 5a07 7570 735f 6d61 7072 f700  ....Z.ups_mapr..
-0000d6d0: 0000 72df 0000 0072 de00 0000 5a07 6d61  ..r....r....Z.ma
-0000d6e0: 7864 6973 745a 0772 6177 7661 6c73 5a06  xdistZ.rawvalsZ.
-0000d6f0: 7374 7261 696e 7222 0000 00da 026e 6e72  strainr".....nnr
-0000d700: 0f00 0000 720f 0000 0072 1000 0000 da0f  ....r....r......
-0000d710: 6765 745f 7374 7261 696e 5f70 6c6f 744a  get_strain_plotJ
-0000d720: 0700 0073 2600 0000 0022 1201 1201 1201  ...s&...."......
-0000d730: 0c01 1e01 1001 1201 0801 1401 0e01 2401  ..............$.
-0000d740: 2201 1001 1401 2e01 2401 2e01 3a01 7245  ".......$...:.rE
-0000d750: 0100 0029 0172 0100 0000 2901 7261 0000  ...).r....).ra..
-0000d760: 0029 0154 2902 727d 0000 0054 2904 7201  .).T).r}...T).r.
-0000d770: 0000 0072 8600 0000 7201 0000 0046 2901  ...r....r....F).
-0000d780: 7201 0000 0029 0572 0100 0000 72a6 0000  r....).r....r...
-0000d790: 0072 2600 0000 72a7 0000 0072 1600 0000  .r&...r....r....
-0000d7a0: 2902 7201 0000 0072 a600 0000 2901 7201  ).r....r....).r.
-0000d7b0: 0000 0029 0172 d200 0000 2902 72d9 0000  ...).r....).r...
-0000d7c0: 0072 2600 0000 2901 7202 0000 0029 0172  .r&...).r....).r
-0000d7d0: e200 0000 2901 72e6 0000 0029 0472 e600  ....).r....).r..
-0000d7e0: 0000 5472 0601 0000 72d2 0000 0029 0272  ..Tr....r....).r
-0000d7f0: e900 0000 7209 0100 0029 0472 0100 0000  ....r....).r....
-0000d800: 7201 0000 0072 1901 0000 721a 0100 0029  r....r....r....)
-0000d810: 0272 4101 0000 72eb 0000 0029 495a 056e  .rA...r....)IZ.n
-0000d820: 756d 7079 7209 0000 005a 0d73 6369 7079  umpyr....Z.scipy
-0000d830: 2e6e 6469 6d61 6765 5a07 6e64 696d 6167  .ndimageZ.ndimag
-0000d840: 6572 0700 0000 5a0e 7363 6970 792e 6f70  er....Z.scipy.op
-0000d850: 7469 6d69 7a65 da08 6f70 7469 6d69 7a65  timize..optimize
-0000d860: 7213 0000 005a 0c73 6369 7079 2e73 6967  r....Z.scipy.sig
-0000d870: 6e61 6cda 0673 6967 6e61 6c5a 0673 6369  nal..signalZ.sci
-0000d880: 7369 675a 0f73 6b69 6d61 6765 2e66 6561  sigZ.skimage.fea
-0000d890: 7475 7265 5a07 6665 6174 7572 6572 ef00  tureZ.featurer..
-0000d8a0: 0000 5a11 6d61 7470 6c6f 746c 6962 2e63  ..Z.matplotlib.c
-0000d8b0: 6f6c 6f72 735a 0663 6f6c 6f72 7372 8e00  olorsZ.colorsr..
-0000d8c0: 0000 5a11 6d61 7470 6c6f 746c 6962 2e70  ..Z.matplotlib.p
-0000d8d0: 7970 6c6f 745a 0670 7970 6c6f 7472 6f00  yplotZ.pyplotro.
-0000d8e0: 0000 5a0a 6d61 7470 6c6f 746c 6962 721f  ..Z.matplotlibr.
-0000d8f0: 0100 00da 0873 7465 6d74 6f6f 6c72 1d00  .....stemtoolr..
-0000d900: 0000 5a14 6d61 7470 6c6f 746c 6962 2e6f  ..Z.matplotlib.o
-0000d910: 6666 7365 7462 6f78 5a09 6f66 6673 6574  ffsetboxZ.offset
-0000d920: 626f 7872 3801 0000 5a13 6d61 7470 6c6f  boxr8...Z.matplo
-0000d930: 746c 6962 2e67 7269 6473 7065 635a 0867  tlib.gridspecZ.g
-0000d940: 7269 6473 7065 6372 3701 0000 5a1c 6d61  ridspecr7...Z.ma
-0000d950: 7470 6c6f 746c 6962 5f73 6361 6c65 6261  tplotlib_scaleba
-0000d960: 722e 7363 616c 6562 6172 723e 0100 0072  r.scalebarr>...r
-0000d970: 3a01 0000 7243 0000 005a 0a64 6173 6b2e  :...rC...Z.dask.
-0000d980: 6172 7261 7972 7a00 0000 723f 0000 005a  arrayrz...r?...Z
-0000d990: 1064 6173 6b2e 6469 7374 7269 6275 7465  .dask.distribute
-0000d9a0: 645a 0b64 6973 7472 6962 7574 6564 723b  dZ.distributedr;
-0000d9b0: 0000 0072 9300 0000 7215 0000 0072 2300  ...r....r....r#.
-0000d9c0: 0000 722c 0000 0072 3600 0000 7256 0000  ..r,...r6...rV..
-0000d9d0: 0072 6000 0000 7263 0000 0072 7900 0000  .r`...rc...ry...
-0000d9e0: 727c 0000 0072 8500 0000 728a 0000 0072  r|...r....r....r
-0000d9f0: 8f00 0000 72a5 0000 0072 cc00 0000 72cf  ....r....r....r.
-0000da00: 0000 0072 d000 0000 72d1 0000 0072 d800  ...r....r....r..
-0000da10: 0000 72dc 0000 0072 e000 0000 72e1 0000  ..r....r....r...
-0000da20: 0072 e500 0000 72e7 0000 0072 e800 0000  .r....r....r....
-0000da30: 7295 0000 0072 f800 0000 7205 0100 0072  r....r....r....r
-0000da40: 0801 0000 7211 0100 0072 1801 0000 7240  ....r....r....r@
-0000da50: 0100 0072 4501 0000 720f 0000 0072 0f00  ...rE...r....r..
-0000da60: 0000 720f 0000 0072 1000 0000 da08 3c6d  ..r....r......<m
-0000da70: 6f64 756c 653e 0100 0000 738c 0000 0008  odule>....s.....
-0000da80: 010c 010c 010c 010c 010c 010c 0108 0108  ................
-0000da90: 010c 010c 010c 0108 010c 010c 0108 030a  ................
-0000daa0: 2508 2d08 1808 1008 1d08 250a 420a 2b08  %.-.......%.B.+.
-0000dab0: 2d0a 0e00 ff0a 4308 130a 7500 0100 0100  -.....C...u.....
-0000dac0: 0100 0100 f60a 7f00 1900 ff0a 270a 2108  ............'.!.
-0000dad0: 090a 300a 4508 0f0a 320a 2f0a 0b08 0f02  ..0.E...2./.....
-0000dae0: 0102 0104 0102 0102 0102 0102 0102 0102  ................
-0000daf0: 0102 0102 f30a 7f00 7f00 3608 3e00 ff0a  ..........6.>...
-0000db00: 630a 4808 6d00 ff0a 7f00 24              c.H.m.....$
+00003bf0: 2064 6973 6b20 706f 7369 7469 6f6e 730a   disk positions.
+00003c00: 2020 2020 6e61 6e5f 6375 746f 6666 3a20      nan_cutoff: 
+00003c10: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
+00003c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003c30: 4f70 7469 6f6e 616c 2070 6172 616d 6574  Optional paramet
+00003c40: 6572 2074 6861 7420 6973 2075 7365 6420  er that is used 
+00003c50: 666f 7220 7468 7265 7368 6f6c 6469 6e67  for thresholding
+00003c60: 2064 6973 6b0a 2020 2020 2020 2020 2020   disk.          
+00003c70: 2020 2020 2020 6669 7473 2e20 4966 2074        fits. If t
+00003c80: 6865 2069 6e74 656e 7369 7479 2072 6174  he intensity rat
+00003c90: 696f 2069 7320 6265 6c6f 7720 7468 6520  io is below the 
+00003ca0: 7468 7265 7368 6f6c 640a 2020 2020 2020  threshold.      
+00003cb0: 2020 2020 2020 2020 2020 7468 6520 706f            the po
+00003cc0: 7369 7469 6f6e 2077 696c 6c20 6e6f 7420  sition will not 
+00003cd0: 6265 2066 6974 2e20 4465 6661 756c 7420  be fit. Default 
+00003ce0: 7661 6c75 6520 6973 2030 0a0a 2020 2020  value is 0..    
+00003cf0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00003d00: 2d2d 2d0a 2020 2020 6669 7474 6564 5f64  ---.    fitted_d
+00003d10: 6973 6b5f 6c69 7374 3a20 6e64 6172 7261  isk_list: ndarra
+00003d20: 7920 6f66 2073 6861 7065 2028 6e2c 3229  y of shape (n,2)
+00003d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003d40: 2020 2020 2020 2053 7562 2d70 6978 656c         Sub-pixel
+00003d50: 2070 7265 6369 7369 6f6e 2047 6175 7373   precision Gauss
+00003d60: 6961 6e20 6669 7474 6564 2064 6973 6b0a  ian fitted disk.
+00003d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d80: 2020 2020 2020 6c6f 6361 7469 6f6e 732e        locations.
+00003d90: 2049 6620 6e61 6e5f 6375 746f 6666 2069   If nan_cutoff i
+00003da0: 7320 6772 6561 7465 7220 7468 616e 207a  s greater than z
+00003db0: 6572 6f2c 2074 6865 6e0a 2020 2020 2020  ero, then.      
+00003dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003dd0: 6f6e 6c79 2074 6865 2070 6f73 6974 696f  only the positio
+00003de0: 6e73 2074 6861 7420 6172 6520 6772 6561  ns that are grea
+00003df0: 7465 7220 7468 616e 2074 6865 2074 6872  ter than the thr
+00003e00: 6573 686f 6c64 0a20 2020 2020 2020 2020  eshold.         
+00003e10: 2020 2020 2020 2020 2020 2020 2061 7265               are
+00003e20: 2072 6574 7572 6e65 642e 0a20 2020 2063   returned..    c
+00003e30: 656e 7465 725f 706f 7369 7469 6f6e 3a20  enter_position: 
+00003e40: 206e 6461 7272 6179 206f 6620 7368 6170   ndarray of shap
+00003e50: 6520 2831 2c32 290a 2020 2020 2020 2020  e (1,2).        
+00003e60: 2020 2020 2020 2020 2020 2020 2020 4c6f                Lo
+00003e70: 6361 7469 6f6e 206f 6620 7468 6520 6365  cation of the ce
+00003e80: 6e74 7261 6c20 2830 2c30 2920 6469 736b  ntral (0,0) disk
+00003e90: 0a20 2020 2066 6974 5f64 6576 6961 7469  .    fit_deviati
+00003ea0: 6f6e 3a20 2020 206e 6461 7272 6179 206f  on:    ndarray o
+00003eb0: 6620 7368 6170 6520 2831 2c32 290a 2020  f shape (1,2).  
+00003ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ed0: 2020 2020 5374 616e 6461 7264 2064 6576      Standard dev
+00003ee0: 6961 7469 6f6e 206f 6620 7468 6520 5820  iation of the X 
+00003ef0: 616e 6420 5920 6469 736b 2066 6974 7320  and Y disk fits 
+00003f00: 6769 7665 6e20 6173 2070 6978 656c 0a20  given as pixel. 
+00003f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003f20: 2020 2020 2072 6174 696f 730a 2020 2020       ratios.    
+00003f30: 6c63 6265 643a 2020 2020 2020 2020 2020  lcbed:          
+00003f40: 2020 6e64 6172 7261 7920 6f66 2073 6861    ndarray of sha
+00003f50: 7065 2028 322c 3229 0a20 2020 2020 2020  pe (2,2).       
+00003f60: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00003f70: 6174 7269 7820 6465 6669 6e69 6e67 2074  atrix defining t
+00003f80: 6865 204d 696c 6c65 7220 696e 6469 6365  he Miller indice
+00003f90: 7320 6178 6573 0a0a 2020 2020 4e6f 7465  s axes..    Note
+00003fa0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+00003fb0: 4576 6572 7920 6469 736b 2070 6f73 6974  Every disk posit
+00003fc0: 696f 6e20 6973 2066 6974 7465 6420 7769  ion is fitted wi
+00003fd0: 7468 2061 2032 4420 4761 7573 7369 616e  th a 2D Gaussian
+00003fe0: 2062 7920 6375 7474 696e 6720 6f66 6620   by cutting off 
+00003ff0: 6120 6369 7263 6c65 0a20 2020 206f 6620  a circle.    of 
+00004000: 7468 6520 7369 7a65 206f 6620 6469 736b  the size of disk
+00004010: 5f73 697a 6520 6172 6f75 6e64 2074 6865  _size around the
+00004020: 2069 6e69 7469 616c 2070 6f69 7374 696f   initial poistio
+00004030: 6e73 2e20 4966 206e 616e 2d63 7574 6f66  ns. If nan-cutof
+00004040: 6620 6973 2061 626f 7665 0a20 2020 207a  f is above.    z
+00004050: 6572 6f20 7468 656e 206f 6e6c 7920 7468  ero then only th
+00004060: 6520 6c6f 6361 7469 6f6e 7320 696e 7369  e locations insi
+00004070: 6465 2074 6869 7320 6375 746f 6666 2077  de this cutoff w
+00004080: 6865 7265 2074 6865 206d 6178 696d 756d  here the maximum
+00004090: 2070 6978 656c 2069 6e74 656e 7369 7479   pixel intensity
+000040a0: 0a20 2020 2069 7320 2831 2b6e 616e 5f63  .    is (1+nan_c
+000040b0: 7574 6f66 6629 2074 696d 6573 2074 6865  utoff) times the
+000040c0: 206d 6564 6961 6e20 7069 7865 6c20 696e   median pixel in
+000040d0: 7465 6e73 6974 7920 7769 6c6c 2062 6520  tensity will be 
+000040e0: 6669 7474 6564 2e20 5573 6520 7468 6973  fitted. Use this
+000040f0: 0a20 2020 2070 6172 616d 6574 6572 2063  .    parameter c
+00004100: 6172 6566 756c 6c79 2c20 6265 6361 7573  arefully, becaus
+00004110: 6520 696e 2073 6f6d 6520 6361 7365 7320  e in some cases 
+00004120: 7468 6973 206d 6179 2072 6573 756c 7420  this may result 
+00004130: 696e 206e 6f20 6469 736b 7320 6265 696e  in no disks bein
+00004140: 6720 6669 7474 6564 0a20 2020 2061 6e64  g fitted.    and
+00004150: 2074 6865 2070 726f 6772 616d 2074 6872   the program thr
+00004160: 6f77 696e 6720 7765 6972 6420 6572 726f  owing weird erro
+00004170: 7273 2061 7420 796f 752e 0a20 2020 20da  rs at you..    .
+00004180: 0669 676e 6f72 6572 0100 0000 725f 0000  .ignorer....r_..
+00004190: 0072 2700 0000 7225 0000 0029 0272 2700  .r'...r%...).r'.
+000041a0: 0000 7225 0000 0072 0600 0000 4e72 8d00  ..r%...r....Nr..
+000041b0: 0000 a902 7201 0000 0072 2700 0000 7216  ....r....r'...r.
+000041c0: 0000 00a9 015a 0572 636f 6e64 291c da08  .....Z.rcond)...
+000041d0: 7761 726e 696e 6773 da0e 6669 6c74 6572  warnings..filter
+000041e0: 7761 726e 696e 6773 722f 0000 0072 0900  warningsr/...r..
+000041f0: 0000 7219 0000 0072 1800 0000 7293 0000  ..r....r....r...
+00004200: 0072 1a00 0000 7274 0000 0072 1b00 0000  .r....rt...r....
+00004210: 728e 0000 0072 8500 0000 da03 6e61 6e72  r....r......nanr
+00004220: 1d00 0000 721e 0000 00da 1366 6974 5f67  ....r......fit_g
+00004230: 6175 7373 6961 6e32 445f 6d61 736b 720a  aussian2D_maskr.
+00004240: 0000 00da 0569 736e 616e 7294 0000 0072  .....isnanr....r
+00004250: 0500 0000 7260 0000 0072 8f00 0000 da06  ....r`...r......
+00004260: 6c69 6e61 6c67 da05 6c73 7473 71da 066d  linalg..lstsq..m
+00004270: 6174 6d75 6cda 0373 7464 da06 6469 7669  atmul..std..divi
+00004280: 6465 da05 7768 6572 6529 1b5a 0a63 6f72  de..where).Z.cor
+00004290: 725f 696d 6167 65da 0964 6973 6b5f 7369  r_image..disk_si
+000042a0: 7a65 da09 706f 7369 7469 6f6e 735a 0a64  ze..positionsZ.d
+000042b0: 6966 665f 7370 6f74 73da 0a6e 616e 5f63  iff_spots..nan_c
+000042c0: 7574 6f66 665a 066e 6f5f 706f 735a 1066  utoffZ.no_posZ.f
+000042d0: 6974 7465 645f 6469 736b 5f6c 6973 7472  itted_disk_listr
+000042e0: 3e00 0000 723f 0000 0072 2200 0000 5a04  >...r?...r"...Z.
+000042f0: 706f 7378 5a04 706f 7379 da03 7265 675a  posxZ.posy..regZ
+00004300: 0a70 6561 6b5f 7261 7469 6fda 0370 6172  .peak_ratio..par
+00004310: 5a08 6e61 6e63 6f75 6e74 5a0f 6365 6e74  Z.nancountZ.cent
+00004320: 6572 5f70 6f73 6974 696f 6e5a 0d66 6974  er_positionZ.fit
+00004330: 5f64 6576 6961 7469 6f6e 5a05 6c63 6265  _deviationZ.lcbe
+00004340: 645a 0e64 6973 6b5f 6c6f 6361 7469 6f6e  dZ.disk_location
+00004350: 7372 7b00 0000 5a02 6378 da02 6379 da01  sr{...Z.cx..cy..
+00004360: 5f5a 0b63 616c 635f 706f 696e 7473 5a04  _Z.calc_pointsZ.
+00004370: 7374 6478 5a04 7374 6479 720f 0000 0072  stdxZ.stdyr....r
+00004380: 0f00 0000 7210 0000 00da 0e66 6974 5f6e  ....r......fit_n
+00004390: 6265 645f 6469 736b 73eb 0100 0073 7600  bed_disks....sv.
+000043a0: 0000 0a2e 1201 1001 0a01 2601 0c01 0c01  ..........&.....
+000043b0: 0c01 2001 1c01 0c01 1401 1202 1a01 1a01  .. .............
+000043c0: 0801 1001 0601 0a01 1002 0801 04ff 1003  ................
+000043d0: 0801 04ff 0a03 2001 0201 3201 04ff 1003  ...... ...2.....
+000043e0: 0801 0801 1601 0e01 1601 0a01 18ff 1a03  ................
+000043f0: 0c01 0401 0401 2001 2001 02fe 04ff 0406  ...... . .......
+00004400: 0401 2001 2001 02fe 04ff 1606 0602 0801  .. . ...........
+00004410: 0602 0601 0601 0c01 72ac 0000 00e9 0a00  ........r.......
+00004420: 0000 7226 0000 00e7 9a99 9999 9999 b93f  ..r&...........?
+00004430: 7216 0000 0063 0a00 0000 0000 0000 0000  r....c..........
+00004440: 0000 2800 0000 0800 0000 4300 0000 73a6  ..(.......C...s.
+00004450: 0300 0074 00a0 0164 01a1 0101 0074 026a  ...t...d.....t.j
+00004460: 0364 027c 006a 0464 0319 0085 0264 027c  .d.|.j.d.....d.|
+00004470: 006a 0464 0419 0085 0266 0219 005c 027d  .j.d.....f...\.}
+00004480: 0a7d 0b7c 0064 0564 0585 0264 0564 0585  .}.|.d.d...d.d..
+00004490: 027c 0a7c 0119 007c 0b7c 0119 0066 0419  .|.|...|.|...f..
+000044a0: 007d 0c7c 0c6a 0464 0619 007d 0d74 02a0  .}.|.j.d...}.t..
+000044b0: 0574 066a 07a0 087c 02a1 01a1 0174 026a  .t.j...|.....t.j
+000044c0: 091b 0064 0713 007d 0e74 02a0 0a64 03a1  ...d...}.t...d..
+000044d0: 01a0 0b74 026a 0ca1 017d 0f74 066a 07a0  ...t.j...}.t.j..
+000044e0: 0d7c 02a1 015c 027d 107d 1174 026a 0e74  .|...\.}.}.t.j.t
+000044f0: 026a 0f7c 0d74 026a 0c64 088d 0214 007d  .j.|.t.j.d.....}
+00004500: 1274 026a 0e74 026a 0f7c 0d74 026a 0c64  .t.j.t.j.|.t.j.d
+00004510: 088d 0214 007d 1374 026a 0e74 026a 0f7c  .....}.t.j.t.j.|
+00004520: 0d74 026a 0c64 088d 0214 007d 1474 026a  .t.j.d.....}.t.j
+00004530: 0e74 026a 0f7c 0d74 026a 0c64 088d 0214  .t.j.|.t.j.d....
+00004540: 007d 1574 026a 0e74 026a 0f7c 0d64 0366  .}.t.j.t.j.|.d.f
+00004550: 0274 026a 0c64 088d 0214 007d 1674 026a  .t.j.d.....}.t.j
+00004560: 0e74 02a0 107c 0aa1 0114 007d 1774 026a  .t...|.....}.t.j
+00004570: 0e74 02a0 107c 0aa1 0114 007d 1874 026a  .t...|.....}.t.j
+00004580: 0e74 02a0 107c 0aa1 0114 007d 1974 026a  .t...|.....}.t.j
+00004590: 0e74 02a0 107c 0aa1 0114 007d 1a74 02a0  .t...|.....}.t..
+000045a0: 117c 05a1 0164 036b 0072 e874 026a 127c  .|...d.k.r.t.j.|
+000045b0: 0c64 0664 098d 027d 1b74 066a 07a0 0d74  .d.d...}.t.j...t
+000045c0: 066a 07a0 137c 1ba1 01a1 015c 027d 1c7d  .j...|.....\.}.}
+000045d0: 1174 02a0 147c 1ca1 017c 1c7c 1c7c 0674  .t...|...|.|.|.t
+000045e0: 02a0 147c 1ca1 0114 006b 043c 0074 066a  ...|.....k.<.t.j
+000045f0: 076a 157c 1c7c 107c 0864 0a8d 037d 1d74  .j.|.|.|.d...}.t
+00004600: 167c 1d7c 0e7c 037c 0483 045c 047d 117d  .|.|.|.|...\.}.}
+00004610: 117d 117d 1e74 026a 17a0 187c 1ea1 017d  .}.}.t.j...|...}
+00004620: 1f6e 0674 026a 17a0 187c 05a1 017d 1f74  .n.t.j...|...}.t
+00004630: 1974 1a7c 0d83 0183 0144 005d 937d 207c  .t.|.....D.].} |
+00004640: 0c64 0564 0585 0264 0564 0585 027c 2066  .d.d...d.d...| f
+00004650: 0319 007d 2174 066a 07a0 0d74 1ba0 1c74  ...}!t.j...t...t
+00004660: 066a 07a0 137c 21a1 017c 07a1 02a1 015c  .j...|!..|.....\
+00004670: 027d 227d 1174 02a0 147c 22a1 017c 0614  .}"}.t...|"..|..
+00004680: 007c 227c 227c 0674 02a0 147c 22a1 0114  .|"|"|.t...|"...
+00004690: 006b 043c 0074 02a0 147c 22a1 017c 061b  .k.<.t...|"..|..
+000046a0: 007c 227c 2274 02a0 147c 22a1 017c 061b  .|"|"t...|"..|..
+000046b0: 006b 003c 0074 066a 076a 157c 227c 107c  .k.<.t.j.j.|"|.|
+000046c0: 0864 0a8d 037d 2374 167c 237c 0e7c 037c  .d...}#t.|#|.|.|
+000046d0: 047c 0983 055c 047d 117d 117d 247d 2574  .|...\.}.}.}$}%t
+000046e0: 02a0 1d74 02a0 1e7c 25a1 01a1 0164 0219  ...t...|%....d..
+000046f0: 000f 0090 0172 877c 247c 167c 2064 0564  .....r.|$|.| d.d
+00004700: 0585 0266 023c 0074 02a0 1f7c 257c 1fa1  ...f.<.t...|%|..
+00004710: 027d 267c 267c 0f18 007d 277c 2764 0b19  .}&|&|...}'|'d..
+00004720: 000b 007c 127c 203c 007c 2764 0c19 007c  ...|.| <.|'d...|
+00004730: 2764 0d19 0017 000b 007c 137c 203c 007c  'd.......|.| <.|
+00004740: 2764 0c19 007c 2764 0d19 0018 007c 147c  'd...|'d.....|.|
+00004750: 203c 007c 2764 0e19 000b 007c 157c 203c   <.|'d.....|.| <
+00004760: 0071 f47c 127c 177c 013c 0064 027c 1774  .q.|.|.|.<.d.|.t
+00004770: 02a0 1d7c 17a1 013c 0074 1ba0 1c7c 1764  ...|...<.t...|.d
+00004780: 0fa1 027d 177c 137c 187c 013c 0064 027c  ...}.|.|.|.<.d.|
+00004790: 1874 02a0 1d7c 18a1 013c 0074 1ba0 1c7c  .t...|...<.t...|
+000047a0: 1864 0fa1 027d 187c 147c 197c 013c 0064  .d...}.|.|.|.<.d
+000047b0: 027c 1974 02a0 1d7c 19a1 013c 0074 1ba0  .|.t...|...<.t..
+000047c0: 1c7c 1964 0fa1 027d 197c 157c 1a7c 013c  .|.d...}.|.|.|.<
+000047d0: 0064 027c 1a74 02a0 1d7c 1aa1 013c 0074  .d.|.t...|...<.t
+000047e0: 1ba0 1c7c 1a64 0fa1 027d 1a7c 177c 187c  ...|.d...}.|.|.|
+000047f0: 197c 1a7c 1666 0553 0029 1061 820c 0000  .|.|.f.S.).a....
+00004800: 0a20 2020 2047 6574 2073 7472 6169 6e20  .    Get strain 
+00004810: 6672 6f6d 2061 2072 6567 696f 6e20 6f66  from a region of
+00004820: 2069 6e74 6572 6573 740a 0a20 2020 2050   interest..    P
+00004830: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00004840: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064 6174  --------.    dat
+00004850: 6134 443a 2020 2020 2020 2020 206e 6461  a4D:         nda
+00004860: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00004870: 2020 2020 2020 2020 2054 6869 7320 6973           This is
+00004880: 2061 2034 4420 6461 7461 7365 7420 7768   a 4D dataset wh
+00004890: 6572 6520 7468 6520 6669 7273 7420 7477  ere the first tw
+000048a0: 6f20 6469 6d65 6e73 696f 6e73 0a20 2020  o dimensions.   
+000048b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000048c0: 2061 7265 2074 6865 2064 6966 6672 6163   are the diffrac
+000048d0: 7469 6f6e 2064 696d 656e 7369 6f6e 7320  tion dimensions 
+000048e0: 616e 6420 7468 6520 6e65 7874 2074 776f  and the next two
+000048f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004900: 2020 2020 2064 696d 656e 7369 6f6e 7320       dimensions 
+00004910: 6172 6520 7468 6520 7363 616e 2064 696d  are the scan dim
+00004920: 656e 7369 6f6e 730a 2020 2020 524f 493a  ensions.    ROI:
+00004930: 2020 2020 2020 2020 2020 2020 6e64 6172              ndar
+00004940: 7261 7920 6f66 2064 7479 7065 2062 6f6f  ray of dtype boo
+00004950: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+00004960: 2020 2020 2020 5265 6769 6f6e 206f 6620        Region of 
+00004970: 696e 7465 7265 7374 0a20 2020 2063 656e  interest.    cen
+00004980: 7465 725f 6469 736b 3a20 2020 206e 6461  ter_disk:    nda
+00004990: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+000049a0: 2020 2020 2020 2020 2054 6865 2062 6c61           The bla
+000049b0: 6e6b 2064 6966 6672 6163 7469 6f6e 2064  nk diffraction d
+000049c0: 6973 6b20 7465 6d70 6c61 7465 2077 6865  isk template whe
+000049d0: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
+000049e0: 2020 2020 2020 2069 7420 6973 2031 2069         it is 1 i
+000049f0: 6e73 6964 6520 7468 6520 6369 7263 6c65  nside the circle
+00004a00: 2061 6e64 2030 206f 7574 7369 6465 0a20   and 0 outside. 
+00004a10: 2020 2064 6973 6b5f 6c69 7374 3a20 2020     disk_list:   
+00004a20: 2020 206e 6461 7272 6179 206f 6620 7368     ndarray of sh
+00004a30: 6170 6520 286e 2c32 290a 2020 2020 2020  ape (n,2).      
+00004a40: 2020 2020 2020 2020 2020 2020 2020 5820                X 
+00004a50: 616e 6420 5920 706f 7369 7469 6f6e 7320  and Y positions 
+00004a60: 7768 6572 6520 6e20 6973 2074 6865 206e  where n is the n
+00004a70: 756d 6265 7220 6f66 2070 6f73 6974 696f  umber of positio
+00004a80: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+00004a90: 2020 2020 2020 2020 5468 6573 6520 6172          These ar
+00004aa0: 6520 7468 6520 696e 6974 6961 6c20 6775  e the initial gu
+00004ab0: 6573 7365 7320 7468 6174 2077 696c 6c20  esses that will 
+00004ac0: 6265 2072 6566 696e 6564 0a20 2020 2070  be refined.    p
+00004ad0: 6f73 5f6c 6973 743a 2020 2020 2020 206e  os_list:       n
+00004ae0: 6461 7272 6179 206f 6620 7368 6170 6520  darray of shape 
+00004af0: 286e 2c32 290a 2020 2020 2020 2020 2020  (n,2).          
+00004b00: 2020 2020 2020 2020 2020 6120 616e 6420            a and 
+00004b10: 6220 4d69 6c6c 6572 2069 6e64 6963 6573  b Miller indices
+00004b20: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
+00004b30: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
+00004b40: 2020 2020 2020 2020 2020 6469 736b 2070            disk p
+00004b50: 6f73 6974 696f 6e73 0a20 2020 2072 6566  ositions.    ref
+00004b60: 6572 656e 6365 5f61 7865 733a 206e 6461  erence_axes: nda
+00004b70: 7272 6179 2c20 6f70 7469 6f6e 616c 0a20  rray, optional. 
+00004b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004b90: 2020 2054 6865 2075 6e69 7420 6365 6c6c     The unit cell
+00004ba0: 2061 7865 7320 6672 6f6d 2074 6865 2072   axes from the r
+00004bb0: 6566 6572 656e 6365 2072 6567 696f 6e2e  eference region.
+00004bc0: 2053 7472 6169 6e20 6973 0a20 2020 2020   Strain is.     
+00004bd0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00004be0: 616c 6375 6c61 7465 6420 6279 2063 6f6d  alculated by com
+00004bf0: 6170 7269 6e67 2074 6865 2061 7865 7320  apring the axes 
+00004c00: 6174 2061 2073 6361 6e20 706f 7369 7469  at a scan positi
+00004c10: 6f6e 2077 6974 680a 2020 2020 2020 2020  on with.        
+00004c20: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00004c30: 7265 6665 7265 6e63 6520 6178 6573 2076  reference axes v
+00004c40: 616c 7565 732e 2049 6620 6974 2069 7320  alues. If it is 
+00004c50: 302c 2074 6865 6e20 7468 6520 6176 6572  0, then the aver
+00004c60: 6167 650a 2020 2020 2020 2020 2020 2020  age.            
+00004c70: 2020 2020 2020 2020 4e42 4544 2061 7865          NBED axe
+00004c80: 7320 7769 6c6c 2062 6520 6361 6c63 756c  s will be calcul
+00004c90: 6174 6564 2061 6e64 2077 696c 6c20 6265  ated and will be
+00004ca0: 2075 7365 6420 6173 2074 6865 0a20 2020   used as the.   
+00004cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004cc0: 2072 6566 6572 656e 6365 2061 7865 732e   reference axes.
+00004cd0: 0a20 2020 206d 6564 5f66 6163 746f 723a  .    med_factor:
+00004ce0: 2020 2020 2066 6c6f 6174 2c20 6f70 7469       float, opti
+00004cf0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00004d00: 2020 2020 2020 2020 2044 7565 2074 6f20           Due to 
+00004d10: 6465 7465 6374 6f72 206e 6f69 7365 2c20  detector noise, 
+00004d20: 736f 6d65 2073 7472 6179 2070 6978 656c  some stray pixel
+00004d30: 7320 6d61 7920 6f66 7465 6e20 6265 2062  s may often be b
+00004d40: 7269 6768 7465 720a 2020 2020 2020 2020  righter.        
+00004d50: 2020 2020 2020 2020 2020 2020 7468 616e              than
+00004d60: 2074 6865 2062 6163 6b67 726f 756e 642e   the background.
+00004d70: 2054 6869 7320 6973 2075 7365 6420 666f   This is used fo
+00004d80: 7220 6461 6d70 696e 6720 616e 7920 7375  r damping any su
+00004d90: 6368 2070 6978 656c 732e 0a20 2020 2020  ch pixels..     
+00004da0: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00004db0: 6566 6175 6c74 2069 7320 3330 0a20 2020  efault is 30.   
+00004dc0: 2067 6175 7373 5f76 616c 3a20 2020 2020   gauss_val:     
+00004dd0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00004de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004df0: 2020 2020 2054 6865 2073 7461 6e64 6172       The standar
+00004e00: 6420 6465 7669 6174 696f 6e20 6f66 2074  d deviation of t
+00004e10: 6865 2047 6175 7373 6961 6e20 6669 6c74  he Gaussian filt
+00004e20: 6572 2061 7070 6c69 6564 2074 6f20 7468  er applied to th
+00004e30: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00004e40: 2020 2020 2020 6c6f 6761 7269 7468 6d20        logarithm 
+00004e50: 6f66 2074 6865 2043 4245 4420 7061 7474  of the CBED patt
+00004e60: 6572 6e2e 2044 6566 6175 6c74 2069 7320  ern. Default is 
+00004e70: 330a 2020 2020 6879 6272 6964 5f63 633a  3.    hybrid_cc:
+00004e80: 2020 2020 2020 666c 6f61 742c 206f 7074        float, opt
+00004e90: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00004ea0: 2020 2020 2020 2020 2020 4879 6272 6964            Hybrid
+00004eb0: 697a 6174 696f 6e20 7061 7261 6d65 7465  ization paramete
+00004ec0: 7220 746f 2062 6520 7573 6564 2066 6f72  r to be used for
+00004ed0: 2063 726f 7373 2d63 6f72 7265 6c61 7469   cross-correlati
+00004ee0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00004ef0: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
+00004f00: 6973 2030 2e31 0a20 2020 206e 616e 5f63  is 0.1.    nan_c
+00004f10: 7574 6f66 663a 2020 2020 2066 6c6f 6174  utoff:     float
+00004f20: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00004f30: 2020 2020 2020 2020 2020 2020 2020 2050                 P
+00004f40: 6172 616d 6574 6572 2074 6861 7420 6973  arameter that is
+00004f50: 2075 7365 6420 666f 7220 7468 7265 7368   used for thresh
+00004f60: 6f6c 6469 6e67 2064 6973 6b0a 2020 2020  olding disk.    
+00004f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f80: 6669 7473 2e20 4966 2074 6865 2069 6e74  fits. If the int
+00004f90: 656e 7369 7479 2072 6174 696f 2069 7320  ensity ratio is 
+00004fa0: 6265 6c6f 7720 7468 6520 7468 7265 7368  below the thresh
+00004fb0: 6f6c 640a 2020 2020 2020 2020 2020 2020  old.            
+00004fc0: 2020 2020 2020 2020 7468 6520 706f 7369          the posi
+00004fd0: 7469 6f6e 2077 696c 6c20 6e6f 7420 6265  tion will not be
+00004fe0: 2066 6974 2e20 4465 6661 756c 7420 7661   fit. Default va
+00004ff0: 6c75 6520 6973 2030 2e35 0a0a 2020 2020  lue is 0.5..    
+00005000: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00005010: 2d2d 2d0a 2020 2020 655f 7878 5f6d 6170  ---.    e_xx_map
+00005020: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
+00005030: 2020 2020 2020 2020 5374 7261 696e 2069          Strain i
+00005040: 6e20 7468 6520 7878 2064 6972 6563 7469  n the xx directi
+00005050: 6f6e 2069 6e20 7468 6520 7265 6769 6f6e  on in the region
+00005060: 206f 6620 696e 7465 7265 7374 0a20 2020   of interest.   
+00005070: 2065 5f78 795f 6d61 703a 206e 6461 7272   e_xy_map: ndarr
+00005080: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00005090: 2053 7472 6169 6e20 696e 2074 6865 2078   Strain in the x
+000050a0: 7920 6469 7265 6374 696f 6e20 696e 2074  y direction in t
+000050b0: 6865 2072 6567 696f 6e20 6f66 2069 6e74  he region of int
+000050c0: 6572 6573 740a 2020 2020 655f 7468 5f6d  erest.    e_th_m
+000050d0: 6170 3a20 6e64 6172 7261 790a 2020 2020  ap: ndarray.    
+000050e0: 2020 2020 2020 2020 2020 416e 6775 6c61            Angula
+000050f0: 7220 7374 7261 696e 2069 6e20 7468 6520  r strain in the 
+00005100: 7265 6769 6f6e 206f 6620 696e 7465 7265  region of intere
+00005110: 7374 0a20 2020 2065 5f79 795f 6d61 703a  st.    e_yy_map:
+00005120: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00005130: 2020 2020 2020 2053 7472 6169 6e20 696e         Strain in
+00005140: 2074 6865 2079 7920 6469 7265 6374 696f   the yy directio
+00005150: 6e20 696e 2074 6865 2072 6567 696f 6e20  n in the region 
+00005160: 6f66 2069 6e74 6572 6573 740a 2020 2020  of interest.    
+00005170: 6669 745f 7374 643a 2020 6e64 6172 7261  fit_std:  ndarra
+00005180: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00005190: 7820 616e 6420 7920 6465 7669 6174 696f  x and y deviatio
+000051a0: 6e73 2069 6e20 6178 6573 2066 6974 7469  ns in axes fitti
+000051b0: 6e67 2066 6f72 2074 6865 2073 6361 6e20  ng for the scan 
+000051c0: 706f 696e 7473 0a0a 2020 2020 4e6f 7465  points..    Note
+000051d0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+000051e0: 4174 2065 7665 7279 2073 6361 6e20 706f  At every scan po
+000051f0: 7369 7469 6f6e 2c20 7468 6520 6469 6666  sition, the diff
+00005200: 7261 6374 696f 6e20 6469 736b 2069 7320  raction disk is 
+00005210: 6669 6c74 6572 6564 2062 7920 6669 7273  filtered by firs
+00005220: 7420 7461 6b69 6e67 0a20 2020 2074 6865  t taking.    the
+00005230: 206c 6f67 206f 6620 7468 6520 4342 4544   log of the CBED
+00005240: 2070 6174 7465 726e 2c20 616e 6420 7468   pattern, and th
+00005250: 656e 2062 7920 6170 706c 7969 6e67 2061  en by applying a
+00005260: 2047 6175 7373 6961 6e20 6669 6c74 6572   Gaussian filter
+00005270: 2e0a 2020 2020 466f 6c6c 6f77 696e 6720  ..    Following 
+00005280: 7468 6973 2074 6865 2053 6f62 656c 206f  this the Sobel o
+00005290: 6620 7468 6520 6669 6c74 6572 6564 2064  f the filtered d
+000052a0: 6174 6173 6574 2069 7320 6361 6c63 756c  ataset is calcul
+000052b0: 6174 6564 2e0a 2020 2020 5468 6520 696e  ated..    The in
+000052c0: 7465 6e73 6974 7920 6f66 2074 6865 2053  tensity of the S
+000052d0: 6f62 656c 2c20 4761 7573 7369 616e 2061  obel, Gaussian a
+000052e0: 6e64 204c 6f67 2066 696c 7465 7265 6420  nd Log filtered 
+000052f0: 4342 4544 2064 6174 6120 6973 2074 6865  CBED data is the
+00005300: 6e0a 2020 2020 696e 7370 6563 7465 6420  n.    inspected 
+00005310: 666f 7220 6f75 746c 6965 7220 7069 7865  for outlier pixe
+00005320: 6c73 2e20 4966 2070 6978 656c 2069 6e74  ls. If pixel int
+00005330: 656e 7369 7469 6573 2061 7265 2068 6967  ensities are hig
+00005340: 6865 7220 6f72 206c 6f77 6572 2074 6861  her or lower tha
+00005350: 6e0a 2020 2020 6120 7468 7265 7368 6f6c  n.    a threshol
+00005360: 6420 6f66 2074 6865 206d 6564 6961 6e20  d of the median 
+00005370: 7069 7865 6c20 696e 7465 6e73 6974 792c  pixel intensity,
+00005380: 2074 6865 7920 6172 6520 7265 706c 6163   they are replac
+00005390: 6564 2062 7920 7468 6520 7468 7265 7368  ed by the thresh
+000053a0: 6f6c 640a 2020 2020 7661 6c75 652e 2054  old.    value. T
+000053b0: 6869 7320 6973 2074 6865 6e20 6879 6272  his is then hybr
+000053c0: 6964 2063 726f 7373 2d63 6f72 7265 6c61  id cross-correla
+000053d0: 7465 6420 7769 7468 2074 6865 2053 6f62  ted with the Sob
+000053e0: 656c 206d 6167 6e69 7475 6465 206f 6620  el magnitude of 
+000053f0: 7468 650a 2020 2020 7465 6d70 6c61 7465  the.    template
+00005400: 2064 6973 6b2e 2049 6620 7468 6520 7061   disk. If the pa
+00005410: 7474 6572 6e20 6178 6573 2072 6574 7572  ttern axes retur
+00005420: 6e20 6120 6e75 6d65 7269 6361 6c20 7661  n a numerical va
+00005430: 6c75 652c 2074 6865 6e20 7468 6520 7374  lue, then the st
+00005440: 7261 696e 0a20 2020 2069 7320 6361 6c63  rain.    is calc
+00005450: 756c 6174 6564 2066 6f72 2074 6861 7420  ulated for that 
+00005460: 7363 616e 2070 6f73 6974 696f 6e2c 2065  scan position, e
+00005470: 6c73 6520 6974 2069 7320 4e61 4e0a 2020  lse it is NaN.  
+00005480: 2020 7297 0000 0072 0100 0000 7225 0000    r....r....r%..
+00005490: 0072 2600 0000 4e72 0600 0000 7216 0000  .r&...Nr....r...
+000054a0: 0072 5f00 0000 7244 0000 00a9 01da 0a68  .r_...rD.......h
+000054b0: 7962 7269 6469 7a65 7272 8d00 0000 7298  ybridizerr....r.
+000054c0: 0000 0072 4500 0000 a902 7227 0000 0072  ...rE.....r'...r
+000054d0: 2700 0000 7227 0000 0029 2072 9a00 0000  '...r'...) r....
+000054e0: 729b 0000 0072 0900 0000 7274 0000 0072  r....r....rt...r
+000054f0: 1900 0000 720a 0000 0072 1d00 0000 721e  ....r....r....r.
+00005500: 0000 0072 7900 0000 da02 7069 da03 6579  ...ry.....pi..ey
+00005510: 6572 3a00 0000 7293 0000 00da 0573 6f62  er:...r......sob
+00005520: 656c 729c 0000 0072 9400 0000 5a09 6f6e  elr....r....Z.on
+00005530: 6573 5f6c 696b 6572 2e00 0000 da04 6d65  es_liker......me
+00005540: 616e da0f 696d 6167 655f 6c6f 6761 7269  an..image_logari
+00005550: 7a65 7272 8500 0000 da0a 6372 6f73 735f  zerr......cross_
+00005560: 636f 7272 72ac 0000 0072 9f00 0000 da03  corrr....r......
+00005570: 696e 7672 1b00 0000 722f 0000 0072 0700  invr....r/...r..
+00005580: 0000 da0f 6761 7573 7369 616e 5f66 696c  ....gaussian_fil
+00005590: 7465 7272 9e00 0000 da05 7261 7665 6c72  terr......ravelr
+000055a0: a100 0000 2928 7229 0000 0072 8b00 0000  ....)(r)...r....
+000055b0: da0b 6365 6e74 6572 5f64 6973 6bda 0964  ..center_disk..d
+000055c0: 6973 6b5f 6c69 7374 da08 706f 735f 6c69  isk_list..pos_li
+000055d0: 7374 da0e 7265 6665 7265 6e63 655f 6178  st..reference_ax
+000055e0: 6573 da0a 6d65 645f 6661 6374 6f72 da09  es..med_factor..
+000055f0: 6761 7573 735f 7661 6cda 0968 7962 7269  gauss_val..hybri
+00005600: 645f 6363 72a7 0000 005a 0673 6361 6e5f  d_ccr....Z.scan_
+00005610: 795a 0673 6361 6e5f 7872 1f00 0000 da0b  yZ.scan_xr......
+00005620: 6e6f 5f6f 665f 6469 736b 7372 a500 0000  no_of_disksr....
+00005630: da08 695f 6d61 7472 6978 da11 736f 6265  ..i_matrix..sobe
+00005640: 6c5f 6365 6e74 6572 5f64 6973 6b72 ab00  l_center_diskr..
+00005650: 0000 da08 655f 7878 5f52 4f49 da08 655f  ....e_xx_ROI..e_
+00005660: 7879 5f52 4f49 da08 655f 7468 5f52 4f49  xy_ROI..e_th_ROI
+00005670: da08 655f 7979 5f52 4f49 5a07 6669 745f  ..e_yy_ROIZ.fit_
+00005680: 7374 64da 0865 5f78 785f 6d61 70da 0865  std..e_xx_map..e
+00005690: 5f78 795f 6d61 70da 0865 5f74 685f 6d61  _xy_map..e_th_ma
+000056a0: 70da 0865 5f79 795f 6d61 70da 096d 6561  p..e_yy_map..mea
+000056b0: 6e5f 6362 6564 5a0d 736f 6265 6c5f 6c6d  n_cbedZ.sobel_lm
+000056c0: 5f63 6265 645a 086c 7363 5f6d 6561 6eda  _cbedZ.lsc_mean.
+000056d0: 096d 6561 6e5f 6178 6573 da0c 696e 7665  .mean_axes..inve
+000056e0: 7273 655f 6178 6573 7222 0000 0072 7a00  rse_axesr"...rz.
+000056f0: 0000 5a11 736f 6265 6c5f 6c6f 675f 7061  ..Z.sobel_log_pa
+00005700: 7474 6572 6e5a 0b6c 7363 5f70 6174 7465  tternZ.lsc_patte
+00005710: 726e 72a2 0000 00da 0c70 6174 7465 726e  rnr......pattern
+00005720: 5f61 7865 73da 0974 5f70 6174 7465 726e  _axes..t_pattern
+00005730: da09 735f 7061 7474 6572 6e72 0f00 0000  ..s_patternr....
+00005740: 720f 0000 0072 1000 0000 da0d 7374 7261  r....r......stra
+00005750: 696e 5f69 6e5f 524f 495a 0200 0073 8c00  in_in_ROIZ...s..
+00005760: 0000 0a4e 2602 2001 0a01 1c01 1201 1001  ...N&. .........
+00005770: 1602 1601 1601 1601 1a01 1001 1001 1001  ................
+00005780: 1001 0e03 0e01 1801 0803 02fe 1001 02ff  ................
+00005790: 0603 0601 06ff 1603 0e01 0c02 1001 1601  ................
+000057a0: 0601 1201 08ff 0c05 02fe 1001 02ff 0c05  ................
+000057b0: 02fe 1001 02ff 0603 0601 06ff 0203 0a01  ................
+000057c0: 0cff 1803 1001 0c01 0801 0e01 1601 1401  ................
+000057d0: 0e01 0280 0801 0e01 0c01 0801 0e01 0c01  ................
+000057e0: 0801 0e01 0c01 0801 0e01 0c01 0e01 72d3  ..............r.
+000057f0: 0000 0063 0600 0000 0000 0000 0000 0000  ...c............
+00005800: 1a00 0000 0600 0000 4300 0000 73aa 0100  ........C...s...
+00005810: 0074 00a0 0164 01a1 0101 007c 006a 0264  .t...d.....|.j.d
+00005820: 0219 007d 0674 03a0 047c 01a1 0174 036a  ...}.t...|...t.j
+00005830: 051b 0064 0313 007d 0774 03a0 0664 04a1  ...d...}.t...d..
+00005840: 01a0 0774 036a 08a1 017d 0874 036a 097c  ...t.j...}.t.j.|
+00005850: 0674 036a 0864 058d 027d 0974 036a 097c  .t.j.d...}.t.j.|
+00005860: 0674 036a 0864 058d 027d 0a74 036a 097c  .t.j.d...}.t.j.|
+00005870: 0674 036a 0864 058d 027d 0b74 036a 097c  .t.j.d...}.t.j.|
+00005880: 0674 036a 0864 058d 027d 0c74 03a0 0a7c  .t.j.d...}.t...|
+00005890: 04a1 0164 046b 0072 6d74 036a 0b7c 0064  ...d.k.rmt.j.|.d
+000058a0: 0264 068d 027d 0d74 0c6a 0da0 0e7c 0da1  .d...}.t.j...|..
+000058b0: 015c 027d 0e7d 0f74 0c6a 0d6a 0f7c 0e7c  .\.}.}.t.j.j.|.|
+000058c0: 0164 0764 088d 037d 1074 107c 107c 077c  .d.d...}.t.|.|.|
+000058d0: 027c 0383 045c 037d 0f7d 0f7d 1174 036a  .|...\.}.}.}.t.j
+000058e0: 11a0 127c 11a1 017d 126e 0674 036a 11a0  ...|...}.n.t.j..
+000058f0: 127c 04a1 017d 1274 1374 147c 0683 0183  .|...}.t.t.|....
+00005900: 0144 005d 557d 137c 0064 0064 0085 0264  .D.]U}.|.d.d...d
+00005910: 0064 0085 027c 1366 0319 007d 1474 0c6a  .d...|.f...}.t.j
+00005920: 0da0 0e7c 14a1 015c 027d 157d 0f74 0c6a  ...|...\.}.}.t.j
+00005930: 0d6a 0f7c 157c 0164 0764 088d 037d 1674  .j.|.|.d.d...}.t
+00005940: 107c 167c 077c 027c 0383 045c 037d 0f7d  .|.|.|.|...\.}.}
+00005950: 0f7d 1774 03a0 157c 177c 12a1 027d 187c  .}.t...|.|...}.|
+00005960: 187c 0818 007d 197c 1964 0919 000b 007c  .|...}.|.d.....|
+00005970: 097c 133c 007c 1964 0a19 007c 1964 0b19  .|.<.|.d...|.d..
+00005980: 0017 000b 007c 0a7c 133c 007c 1964 0a19  .....|.|.<.|.d..
+00005990: 007c 1964 0b19 0018 007c 0b7c 133c 007c  .|.d.....|.|.<.|
+000059a0: 1964 0c19 000b 007c 0c7c 133c 0071 797c  .d.....|.|.<.qy|
+000059b0: 097c 0a7c 0b7c 0c66 0453 00a9 0d4e 7297  .|.|.|.f.S...Nr.
+000059c0: 0000 0072 0600 0000 7216 0000 0072 2500  ...r....r....r%.
+000059d0: 0000 725f 0000 0072 4400 0000 72ae 0000  ..r_...rD...r...
+000059e0: 0072 af00 0000 728d 0000 0072 9800 0000  .r....r....r....
+000059f0: 7245 0000 0072 b100 0000 2916 729a 0000  rE...r....).r...
+00005a00: 0072 9b00 0000 7219 0000 0072 0900 0000  .r....r....r....
+00005a10: 720a 0000 0072 b200 0000 72b3 0000 0072  r....r....r....r
+00005a20: 3a00 0000 7293 0000 0072 4100 0000 722e  :...r....rA...r.
+00005a30: 0000 0072 b500 0000 721d 0000 0072 1e00  ...r....r....r..
+00005a40: 0000 72b6 0000 0072 b700 0000 72ac 0000  ..r....r....r...
+00005a50: 0072 9f00 0000 72b8 0000 0072 1b00 0000  .r....r....r....
+00005a60: 722f 0000 0072 a100 0000 291a 721f 0000  r/...r....).r...
+00005a70: 0072 bb00 0000 72bc 0000 0072 bd00 0000  .r....r....r....
+00005a80: 72be 0000 0072 bf00 0000 72c2 0000 0072  r....r....r....r
+00005a90: a500 0000 72c3 0000 005a 0865 5f78 785f  ....r....Z.e_xx_
+00005aa0: 6c6f 675a 0865 5f78 795f 6c6f 675a 0865  logZ.e_xy_logZ.e
+00005ab0: 5f74 685f 6c6f 675a 0865 5f79 795f 6c6f  _th_logZ.e_yy_lo
+00005ac0: 6772 cd00 0000 da08 6c6f 675f 6362 6564  gr......log_cbed
+00005ad0: 72ab 0000 005a 0b6c 6f67 5f63 635f 6d65  r....Z.log_cc_me
+00005ae0: 616e 72ce 0000 0072 cf00 0000 7222 0000  anr....r....r"..
+00005af0: 0072 7a00 0000 5a0b 6c6f 675f 7061 7474  .rz...Z.log_patt
+00005b00: 6572 6e5a 0e6c 6f67 5f63 635f 7061 7474  ernZ.log_cc_patt
+00005b10: 6572 6e72 d000 0000 72d1 0000 0072 d200  ernr....r....r..
+00005b20: 0000 720f 0000 0072 0f00 0000 7210 0000  ..r....r....r...
+00005b30: 00da 0a73 7472 6169 6e5f 6c6f 67f1 0200  ...strain_log...
+00005b40: 0073 3a00 0000 0a03 0a02 1401 1201 1002  .s:.............
+00005b50: 1001 1001 1001 0e03 0e01 1001 1201 1401  ................
+00005b60: 0e01 0c02 1001 1601 1001 1201 0201 0801  ................
+00005b70: 0aff 0c03 0801 0e01 1601 1401 1001 0c01  ................
+00005b80: 72d6 0000 0063 0500 0000 0000 0000 0000  r....c..........
+00005b90: 0000 1700 0000 0600 0000 4300 0000 738a  ..........C...s.
+00005ba0: 0100 0074 00a0 0164 01a1 0101 007c 006a  ...t...d.....|.j
+00005bb0: 0264 0219 007d 0574 03a0 047c 01a1 0174  .d...}.t...|...t
+00005bc0: 036a 051b 0064 0313 007d 0674 03a0 0664  .j...d...}.t...d
+00005bd0: 04a1 01a0 0774 036a 08a1 017d 0774 036a  .....t.j...}.t.j
+00005be0: 097c 0574 036a 0864 058d 027d 0874 036a  .|.t.j.d...}.t.j
+00005bf0: 097c 0574 036a 0864 058d 027d 0974 036a  .|.t.j.d...}.t.j
+00005c00: 097c 0574 036a 0864 058d 027d 0a74 036a  .|.t.j.d...}.t.j
+00005c10: 097c 0574 036a 0864 058d 027d 0b74 03a0  .|.t.j.d...}.t..
+00005c20: 0a7c 04a1 0164 046b 0072 6574 036a 0b7c  .|...d.k.ret.j.|
+00005c30: 0064 0264 068d 027d 0c74 0c6a 0d6a 0e7c  .d.d...}.t.j.j.|
+00005c40: 0c7c 0164 0764 088d 037d 0d74 0f7c 0d7c  .|.d.d...}.t.|.|
+00005c50: 067c 027c 0383 045c 037d 0e7d 0e7d 0f74  .|.|...\.}.}.}.t
+00005c60: 036a 10a0 117c 0fa1 017d 106e 0674 036a  .j...|...}.n.t.j
+00005c70: 10a0 117c 04a1 017d 1074 1274 137c 0583  ...|...}.t.t.|..
+00005c80: 0183 0144 005d 4d7d 117c 0064 0064 0085  ...D.]M}.|.d.d..
+00005c90: 0264 0064 0085 027c 1166 0319 007d 1274  .d.d...|.f...}.t
+00005ca0: 0c6a 0d6a 0e7c 127c 0164 0764 088d 037d  .j.j.|.|.d.d...}
+00005cb0: 1374 0f7c 137c 067c 027c 0383 045c 037d  .t.|.|.|.|...\.}
+00005cc0: 0e7d 0e7d 1474 03a0 147c 147c 10a1 027d  .}.}.t...|.|...}
+00005cd0: 157c 157c 0718 007d 167c 1664 0919 000b  .|.|...}.|.d....
+00005ce0: 007c 087c 113c 007c 1664 0a19 007c 1664  .|.|.<.|.d...|.d
+00005cf0: 0b19 0017 000b 007c 097c 113c 007c 1664  .......|.|.<.|.d
+00005d00: 0a19 007c 1664 0b19 0018 007c 0a7c 113c  ...|.d.....|.|.<
+00005d10: 007c 1664 0c19 000b 007c 0b7c 113c 0071  .|.d.....|.|.<.q
+00005d20: 717c 087c 097c 0a7c 0b66 0453 0072 d400  q|.|.|.|.f.S.r..
+00005d30: 0000 2915 729a 0000 0072 9b00 0000 7219  ..).r....r....r.
+00005d40: 0000 0072 0900 0000 720a 0000 0072 b200  ...r....r....r..
+00005d50: 0000 72b3 0000 0072 3a00 0000 7293 0000  ..r....r:...r...
+00005d60: 0072 4100 0000 722e 0000 0072 b500 0000  .rA...r....r....
+00005d70: 721d 0000 0072 1e00 0000 72b7 0000 0072  r....r....r....r
+00005d80: ac00 0000 729f 0000 0072 b800 0000 721b  ....r....r....r.
+00005d90: 0000 0072 2f00 0000 72a1 0000 0029 1772  ...r/...r....).r
+00005da0: 1f00 0000 72bb 0000 0072 bc00 0000 72bd  ....r....r....r.
+00005db0: 0000 0072 be00 0000 72c2 0000 0072 a500  ...r....r....r..
+00005dc0: 0000 72c3 0000 0072 c500 0000 72c6 0000  ..r....r....r...
+00005dd0: 0072 c700 0000 72c8 0000 0072 cd00 0000  .r....r....r....
+00005de0: 5a07 6363 5f6d 6561 6e72 ab00 0000 72ce  Z.cc_meanr....r.
+00005df0: 0000 0072 cf00 0000 7222 0000 0072 7a00  ...r....r"...rz.
+00005e00: 0000 5a0a 6363 5f70 6174 7465 726e 72d0  ..Z.cc_patternr.
+00005e10: 0000 0072 d100 0000 72d2 0000 0072 0f00  ...r....r....r..
+00005e20: 0000 720f 0000 0072 1000 0000 da0f 7374  ..r....r......st
+00005e30: 7261 696e 5f6f 6c64 7374 796c 6518 0300  rain_oldstyle...
+00005e40: 0073 3200 0000 0a01 0a02 1401 1201 1002  .s2.............
+00005e50: 1001 1001 1001 0e03 0e01 1201 1401 0e01  ................
+00005e60: 0c02 1001 1601 1201 1401 0c01 0801 0e01  ................
+00005e70: 1601 1401 1001 0c01 72d7 0000 0063 0200  ........r....c..
+00005e80: 0000 0000 0000 0000 0000 0300 0000 0400  ................
+00005e90: 0000 4300 0000 7324 0000 0074 006a 017c  ..C...s$...t.j.|
+00005ea0: 0174 006a 0264 018d 027d 027c 00a0 0374  .t.j.d...}.|...t
+00005eb0: 006a 02a1 017c 027c 013c 007c 0253 0029  .j...|.|.<.|.S.)
+00005ec0: 027a 3d0a 2020 2020 436f 6e76 6572 7420  .z=.    Convert 
+00005ed0: 7468 6520 7374 7261 696e 2069 6e20 7468  the strain in th
+00005ee0: 6520 524f 4920 6172 7261 7920 746f 2061  e ROI array to a
+00005ef0: 2073 7472 6169 6e20 6d61 700a 2020 2020   strain map.    
+00005f00: 725f 0000 0029 0472 0900 0000 721a 0000  r_...).r....r...
+00005f10: 0072 9300 0000 723a 0000 0029 035a 0a73  .r....r:...).Z.s
+00005f20: 7472 6169 6e5f 524f 4972 8b00 0000 5a0a  train_ROIr....Z.
+00005f30: 7374 7261 696e 5f6d 6170 720f 0000 0072  strain_mapr....r
+00005f40: 0f00 0000 7210 0000 00da 0e52 4f49 5f73  ....r......ROI_s
+00005f50: 7472 6169 6e5f 6d61 7039 0300 0073 0600  train_map9...s..
+00005f60: 0000 1004 1001 0401 72d8 0000 00e9 2000  ........r..... .
+00005f70: 0000 6303 0000 0000 0000 0000 0000 0009  ..c.............
+00005f80: 0000 0009 0000 0043 0000 0073 f600 0000  .......C...s....
+00005f90: 6401 7c02 1300 7d03 7400 a001 7c01 a101  d.|...}.t...|...
+00005fa0: 7d01 6402 7c01 7c01 6403 6b00 1900 1700  }.d.|.|.d.k.....
+00005fb0: 7c01 7c01 6403 6b00 3c00 7400 a002 7c01  |.|.d.k.<.t...|.
+00005fc0: a101 7d04 7c04 6401 6b00 7224 7400 a003  ..}.|.d.k.r$t...
+00005fd0: 7c00 6404 a102 7d00 7400 6a04 7c00 7400  |.d...}.t.j.|.t.
+00005fe0: 6a05 6405 8d02 7d05 7406 7c00 6a07 7408  j.d...}.t.|.j.t.
+00005ff0: 7c01 6406 1900 8301 1900 8301 4400 5d37  |.d.........D.]7
+00006000: 7d06 7406 7c00 6a07 7408 7c01 6403 1900  }.t.|.j.t.|.d...
+00006010: 8301 1900 8301 4400 5d29 7d07 7409 6a0a  ......D.])}.t.j.
+00006020: a00b 7c00 6407 6407 8502 6407 6407 8502  ..|.d.d...d.d...
+00006030: 7c07 7c06 6604 1900 a101 7d08 6406 7c03  |.|.f.....}.d.|.
+00006040: 6406 1800 7c08 1400 1700 7d08 7400 a00c  d...|.....}.t...
+00006050: 7c08 a101 7c05 6407 6407 8502 6407 6407  |...|.d.d...d.d.
+00006060: 8502 7c07 7c06 6604 3c00 7144 7137 7c04  ..|.|.f.<.qDq7|.
+00006070: 6401 6b00 7279 7400 a003 7c05 6404 a102  d.k.ryt...|.d...
+00006080: 7d05 7c05 5300 2908 6154 0300 000a 2020  }.|.S.).aT....  
+00006090: 2020 5461 6b65 2074 6865 204c 6f67 6172    Take the Logar
+000060a0: 6974 686d 206f 6620 6120 3444 2064 6174  ithm of a 4D dat
+000060b0: 6173 6574 2e0a 0a20 2020 2050 6172 616d  aset...    Param
+000060c0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+000060d0: 2d2d 2d2d 0a20 2020 2064 6174 6134 443a  ----.    data4D:
+000060e0: 2020 2020 206e 6461 7272 6179 0a20 2020       ndarray.   
+000060f0: 2020 2020 2020 2020 2020 2020 2034 4420               4D 
+00006100: 6461 7461 7365 7420 7768 6f73 6520 4342  dataset whose CB
+00006110: 4544 2070 6174 7465 726e 7320 7769 6c6c  ED patterns will
+00006120: 2062 6520 6669 6c74 6572 6564 0a20 2020   be filtered.   
+00006130: 2073 6361 6e5f 6469 6d73 3a20 2074 7570   scan_dims:  tup
+00006140: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
+00006150: 2020 2053 6361 6e20 6469 6d65 6e73 696f     Scan dimensio
+00006160: 6e73 2e20 4966 2079 6f75 7220 7363 616e  ns. If your scan
+00006170: 6e69 6e67 2070 6978 656c 7320 6172 6520  ning pixels are 
+00006180: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
+00006190: 2020 2020 6578 616d 706c 6520 7468 6520      example the 
+000061a0: 6669 7273 7420 7477 6f20 6469 6d65 6e73  first two dimens
+000061b0: 696f 6e73 2073 7065 6369 6679 2069 7420  ions specify it 
+000061c0: 6173 2028 302c 3129 0a20 2020 2020 2020  as (0,1).       
+000061d0: 2020 2020 2020 2020 2057 696c 6c20 6265           Will be
+000061e0: 2063 6f6e 7665 7274 6564 2074 6f20 6e75   converted to nu
+000061f0: 6d70 7920 6172 7261 7920 736f 2070 6173  mpy array so pas
+00006200: 7320 7475 706c 6520 6f6e 6c79 0a20 2020  s tuple only.   
+00006210: 206d 6564 5f66 6163 746f 723a 2066 6c6f   med_factor: flo
+00006220: 6174 2c20 6f70 7469 6f6e 616c 0a20 2020  at, optional.   
+00006230: 2020 2020 2020 2020 2020 2020 2044 7565               Due
+00006240: 2074 6f20 6465 7465 6374 6f72 206e 6f69   to detector noi
+00006250: 7365 2c20 736f 6d65 2073 7472 6179 2070  se, some stray p
+00006260: 6978 656c 7320 6d61 7920 6f66 7465 6e0a  ixels may often.
+00006270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006280: 6265 2062 7269 6768 7465 7220 7468 616e  be brighter than
+00006290: 2074 6865 2062 6163 6b67 726f 756e 642e   the background.
+000062a0: 2054 6869 7320 6973 2075 7365 6420 666f   This is used fo
+000062b0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000062c0: 2020 6461 6d70 696e 6720 616e 7920 7375    damping any su
+000062d0: 6368 2070 6978 656c 732e 2044 6566 6175  ch pixels. Defau
+000062e0: 6c74 2069 7320 3330 0a0a 2020 2020 5265  lt is 30..    Re
+000062f0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00006300: 2d0a 2020 2020 6461 7461 5f6c 6f67 3a20  -.    data_log: 
+00006310: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00006320: 2020 2020 2020 3444 2064 6174 6173 6574        4D dataset
+00006330: 2077 6865 7265 2065 6163 6820 4342 4544   where each CBED
+00006340: 2070 6174 7465 726e 2068 6173 2062 6565   pattern has bee
+00006350: 6e20 6c6f 670a 0a20 2020 204e 6f74 6573  n log..    Notes
+00006360: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2047  .    -----.    G
+00006370: 656e 6572 6174 6520 7468 6520 6c6f 6761  enerate the loga
+00006380: 7269 7468 6d20 6f66 2074 6865 2034 4420  rithm of the 4D 
+00006390: 6461 7461 7365 742e 0a0a 2020 2020 5365  dataset...    Se
+000063a0: 6520 416c 736f 0a20 2020 202d 2d2d 2d2d  e Also.    -----
+000063b0: 2d2d 2d0a 2020 2020 6c6f 675f 736f 6265  ---.    log_sobe
+000063c0: 6c34 440a 2020 2020 7574 696c 2e69 6d61  l4D.    util.ima
+000063d0: 6765 5f6c 6f67 6172 697a 6572 0a20 2020  ge_logarizer.   
+000063e0: 2072 2500 0000 7268 0000 0072 0100 0000   r%...rh...r....
+000063f0: 7224 0000 0072 5f00 0000 7227 0000 004e  r$...r_...r'...N
+00006400: 290d 7209 0000 0072 1800 0000 720a 0000  ).r....r....r...
+00006410: 0072 2800 0000 721a 0000 005a 0766 6c6f  .r(...r....Z.flo
+00006420: 6174 3332 721b 0000 0072 1900 0000 722f  at32r....r....r/
+00006430: 0000 0072 1d00 0000 721e 0000 0072 7900  ...r....r....ry.
+00006440: 0000 da04 6c6f 6732 2909 7229 0000 00da  ....log2).r)....
+00006450: 0973 6361 6e5f 6469 6d73 da09 6269 745f  .scan_dims..bit_
+00006460: 6465 7074 685a 0762 6974 5f6d 6178 da08  depthZ.bit_max..
+00006470: 7375 6d5f 6469 6d73 5a08 6461 7461 5f6c  sum_dimsZ.data_l
+00006480: 6f67 da02 6a6a 7222 0000 0072 7a00 0000  og..jjr"...rz...
+00006490: 720f 0000 0072 0f00 0000 7210 0000 00da  r....r....r.....
+000064a0: 0b6c 6f67 6172 697a 6572 3444 4203 0000  .logarizer4DB...
+000064b0: 7320 0000 0008 1f0a 0118 010a 0108 010c  s ..............
+000064c0: 0110 011a 011a 0120 0110 0120 0102 fd08  ....... ... ....
+000064d0: 040c 0104 0172 df00 0000 e91e 0000 0063  .....r.........c
+000064e0: 0400 0000 0000 0000 0000 0000 0b00 0000  ................
+000064f0: 0900 0000 4300 0000 7346 0100 0074 00a0  ....C...sF...t..
+00006500: 017c 01a1 017d 0164 017c 017c 0164 026b  .|...}.d.|.|.d.k
+00006510: 0019 0017 007c 017c 0164 026b 003c 0074  .....|.|.d.k.<.t
+00006520: 00a0 027c 01a1 017d 047c 0464 036b 0072  ...|...}.|.d.k.r
+00006530: 2074 00a0 037c 0064 04a1 027d 0074 006a   t...|.d...}.t.j
+00006540: 047c 0074 006a 0564 058d 027d 0574 067c  .|.t.j.d...}.t.|
+00006550: 006a 0774 087c 0164 0619 0083 0119 0083  .j.t.|.d........
+00006560: 0144 005d 637d 0674 067c 006a 0774 087c  .D.]c}.t.|.j.t.|
+00006570: 0164 0219 0083 0119 0083 0144 005d 557d  .d.........D.]U}
+00006580: 077c 0064 0764 0785 0264 0764 0785 027c  .|.d.d...d.d...|
+00006590: 077c 0666 0419 007d 0864 0864 0674 096a  .|.f...}.d.d.t.j
+000065a0: 0aa0 0b7c 08a1 0117 0014 007d 0874 096a  ...|.......}.t.j
+000065b0: 0aa0 0c74 0da0 0e74 096a 0aa0 0f7c 08a1  ...t...t.j...|..
+000065c0: 017c 03a1 0264 09a1 025c 027d 097d 0a74  .|...d...\.}.}.t
+000065d0: 00a0 107c 09a1 017c 0214 007c 097c 097c  ...|...|...|.|.|
+000065e0: 0274 00a0 107c 09a1 0114 006b 043c 0074  .t...|.....k.<.t
+000065f0: 00a0 107c 09a1 017c 021b 007c 097c 0974  ...|...|...|.|.t
+00006600: 00a0 107c 09a1 017c 021b 006b 003c 007c  ...|...|...k.<.|
+00006610: 097c 0564 0764 0785 0264 0764 0785 027c  .|.d.d...d.d...|
+00006620: 077c 0666 043c 0071 4071 337c 0464 036b  .|.f.<.q@q3|.d.k
+00006630: 0072 a174 00a0 037c 0564 04a1 027d 057c  .r.t...|.d...}.|
+00006640: 0553 0029 0a61 3606 0000 0a20 2020 2054  .S.).a6....    T
+00006650: 616b 6520 7468 6520 4c6f 672d 536f 6265  ake the Log-Sobe
+00006660: 6c20 6f66 2061 2070 6174 7465 726e 2e0a  l of a pattern..
+00006670: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00006680: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00006690: 2020 2064 6174 6134 443a 2020 2020 206e     data4D:     n
+000066a0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+000066b0: 2020 2020 2020 2034 4420 6461 7461 7365         4D datase
+000066c0: 7420 7768 6f73 6520 4342 4544 2070 6174  t whose CBED pat
+000066d0: 7465 726e 7320 7769 6c6c 2062 6520 6669  terns will be fi
+000066e0: 6c74 6572 6564 0a20 2020 2073 6361 6e5f  ltered.    scan_
+000066f0: 6469 6d73 3a20 2074 7570 6c65 0a20 2020  dims:  tuple.   
+00006700: 2020 2020 2020 2020 2020 2020 2053 6361               Sca
+00006710: 6e20 6469 6d65 6e73 696f 6e73 2e20 4966  n dimensions. If
+00006720: 2079 6f75 7220 7363 616e 6e69 6e67 2070   your scanning p
+00006730: 6978 656c 7320 6172 6520 666f 720a 2020  ixels are for.  
+00006740: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00006750: 616d 706c 6520 7468 6520 6669 7273 7420  ample the first 
+00006760: 7477 6f20 6469 6d65 6e73 696f 6e73 2073  two dimensions s
+00006770: 7065 6369 6679 2069 7420 6173 2028 302c  pecify it as (0,
+00006780: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+00006790: 2020 2057 696c 6c20 6265 2063 6f6e 7665     Will be conve
+000067a0: 7274 6564 2074 6f20 6e75 6d70 7920 6172  rted to numpy ar
+000067b0: 7261 7920 736f 2070 6173 7320 7475 706c  ray so pass tupl
+000067c0: 6520 6f6e 6c79 0a20 2020 206d 6564 5f66  e only.    med_f
+000067d0: 6163 746f 723a 2066 6c6f 6174 2c20 6f70  actor: float, op
+000067e0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+000067f0: 2020 2020 2020 2044 7565 2074 6f20 6465         Due to de
+00006800: 7465 6374 6f72 206e 6f69 7365 2c20 736f  tector noise, so
+00006810: 6d65 2073 7472 6179 2070 6978 656c 7320  me stray pixels 
+00006820: 6d61 7920 6f66 7465 6e0a 2020 2020 2020  may often.      
+00006830: 2020 2020 2020 2020 2020 6265 2062 7269            be bri
+00006840: 6768 7465 7220 7468 616e 2074 6865 2062  ghter than the b
+00006850: 6163 6b67 726f 756e 642e 2054 6869 7320  ackground. This 
+00006860: 6973 2075 7365 6420 666f 720a 2020 2020  is used for.    
+00006870: 2020 2020 2020 2020 2020 2020 6461 6d70              damp
+00006880: 696e 6720 616e 7920 7375 6368 2070 6978  ing any such pix
+00006890: 656c 732e 2044 6566 6175 6c74 2069 7320  els. Default is 
+000068a0: 3330 0a20 2020 2067 6175 7373 5f76 616c  30.    gauss_val
+000068b0: 3a20 2066 6c6f 6174 2c20 6f70 7469 6f6e  :  float, option
+000068c0: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+000068d0: 2020 2054 6865 2073 7461 6e64 6172 6420     The standard 
+000068e0: 6465 7669 6174 696f 6e20 6f66 2074 6865  deviation of the
+000068f0: 2047 6175 7373 6961 6e20 6669 6c74 6572   Gaussian filter
+00006900: 2061 7070 6c69 6564 0a20 2020 2020 2020   applied.       
+00006910: 2020 2020 2020 2020 2074 6f20 7468 6520           to the 
+00006920: 6c6f 6761 7269 7468 6d20 6f66 2074 6865  logarithm of the
+00006930: 2043 4245 4420 7061 7474 6572 6e2e 2044   CBED pattern. D
+00006940: 6566 6175 6c74 2069 7320 330a 0a20 2020  efault is 3..   
+00006950: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00006960: 2d2d 2d2d 0a20 2020 2064 6174 615f 6c73  ----.    data_ls
+00006970: 623a 206e 6461 7272 6179 0a20 2020 2020  b: ndarray.     
+00006980: 2020 2020 2020 2020 2034 4420 6461 7461           4D data
+00006990: 7365 7420 7768 6572 6520 6561 6368 2043  set where each C
+000069a0: 4245 4420 7061 7474 6572 6e20 6861 7320  BED pattern has 
+000069b0: 6265 656e 206c 6f67 0a20 2020 2020 2020  been log.       
+000069c0: 2020 2020 2020 2053 6f62 656c 2066 696c         Sobel fil
+000069d0: 7465 7265 640a 0a20 2020 204e 6f74 6573  tered..    Notes
+000069e0: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2047  .    -----.    G
+000069f0: 656e 6572 6174 6520 7468 6520 536f 6265  enerate the Sobe
+00006a00: 6c20 6669 6c74 6572 6564 2070 6174 7465  l filtered patte
+00006a10: 726e 206f 6620 7468 6520 6c6f 6761 7269  rn of the logari
+00006a20: 7468 6d20 6f66 0a20 2020 2061 2064 6174  thm of.    a dat
+00006a30: 6173 6574 2e20 436f 6d70 6172 6564 2074  aset. Compared t
+00006a40: 6f20 7275 6e6e 696e 6720 7468 6520 536f  o running the So
+00006a50: 6265 6c20 6669 6c74 6572 2062 6163 6b20  bel filter back 
+00006a60: 6f6e 0a20 2020 2061 206c 6f67 2064 6174  on.    a log dat
+00006a70: 6173 6574 2c20 7468 6973 2074 616b 6573  aset, this takes
+00006a80: 2063 6172 6520 6f66 2073 6f6d 6574 6869   care of somethi
+00006a90: 6e67 7320 2d20 6e6f 7461 626c 790a 2020  ngs - notably.  
+00006aa0: 2020 6120 4761 7573 7369 616e 2062 6c75    a Gaussian blu
+00006ab0: 7220 6973 2061 7070 6c69 6564 2074 6f20  r is applied to 
+00006ac0: 7468 6520 696d 6167 652c 2061 6e64 2053  the image, and S
+00006ad0: 6f62 656c 2073 7069 6b65 730a 2020 2020  obel spikes.    
+00006ae0: 6172 6520 7265 6d6f 7665 6420 7768 656e  are removed when
+00006af0: 2061 6e79 2076 616c 7565 7320 6172 6520   any values are 
+00006b00: 746f 6f20 6869 6768 6572 206f 7220 6c6f  too higher or lo
+00006b10: 7765 7220 7468 616e 0a20 2020 2074 6865  wer than.    the
+00006b20: 206d 6564 6961 6e20 6f66 2074 6865 2069   median of the i
+00006b30: 6d61 6765 2e20 5468 6973 2069 7320 6265  mage. This is be
+00006b40: 6361 7573 6520 7265 616c 2064 6574 6563  cause real detec
+00006b50: 746f 720a 2020 2020 696d 6167 6573 206f  tor.    images o
+00006b60: 6674 656e 2061 7265 2076 6572 7920 6e6f  ften are very no
+00006b70: 6973 792e 2054 6869 7320 636f 6465 2067  isy. This code g
+00006b80: 656e 6572 6174 6573 2074 6865 2066 696c  enerates the fil
+00006b90: 7465 7265 640a 2020 2020 4342 4544 2061  tered.    CBED a
+00006ba0: 7420 6576 6572 7920 7363 616e 2070 6f73  t every scan pos
+00006bb0: 6974 696f 6e2c 2061 6e64 2069 7320 6469  ition, and is di
+00006bc0: 6d65 6e73 696f 6e20 6167 6e6f 7374 6963  mension agnostic
+00006bd0: 2c20 696e 0a20 2020 2074 6861 7420 796f  , in.    that yo
+00006be0: 7572 2043 4245 4420 6469 6d65 6e73 696f  ur CBED dimensio
+00006bf0: 6e73 2063 616e 2065 6974 6865 7220 6265  ns can either be
+00006c00: 2074 6865 2066 6972 7374 2074 776f 206f   the first two o
+00006c10: 7220 6c61 7374 0a20 2020 2074 776f 202d  r last.    two -
+00006c20: 206a 7573 7420 7370 6563 6966 7920 7468   just specify th
+00006c30: 6520 6469 6d65 6e73 696f 6e73 2e20 0a0a  e dimensions. ..
+00006c40: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00006c50: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 6c6f   --------.    lo
+00006c60: 6761 7269 7a65 7234 440a 2020 2020 6470  garizer4D.    dp
+00006c70: 632e 6c6f 675f 736f 6265 6c0a 2020 2020  c.log_sobel.    
+00006c80: 7268 0000 0072 0100 0000 7225 0000 0072  rh...r....r%...r
+00006c90: 2400 0000 725f 0000 0072 2700 0000 4ee9  $...r_...r'...N.
+00006ca0: e803 0000 7202 0000 0029 1172 0900 0000  ....r....).r....
+00006cb0: 7218 0000 0072 0a00 0000 7228 0000 0072  r....r....r(...r
+00006cc0: 1a00 0000 da05 666c 6f61 7472 1b00 0000  ......floatr....
+00006cd0: 7219 0000 0072 2f00 0000 721d 0000 0072  r....r/...r....r
+00006ce0: 1e00 0000 7279 0000 0072 b400 0000 7207  ....ry...r....r.
+00006cf0: 0000 0072 b900 0000 72b6 0000 0072 8500  ...r....r....r..
+00006d00: 0000 290b 7229 0000 0072 db00 0000 72bf  ..).r)...r....r.
+00006d10: 0000 0072 c000 0000 72dd 0000 005a 0864  ...r....r....Z.d
+00006d20: 6174 615f 6c73 6272 de00 0000 7222 0000  ata_lsbr....r"..
+00006d30: 0072 7a00 0000 5a0b 6c73 625f 7061 7474  .rz...Z.lsb_patt
+00006d40: 6572 6e72 ab00 0000 720f 0000 0072 0f00  ernr....r....r..
+00006d50: 0000 7210 0000 00da 0b6c 6f67 5f73 6f62  ..r......log_sob
+00006d60: 656c 3444 7203 0000 732c 0000 000a 2c18  el4Dr...s,....,.
+00006d70: 010a 0108 010c 0110 011a 011a 0118 0114  ................
+00006d80: 0106 0114 0108 ff0c 0414 ff0c 0414 ff1a  ................
+00006d90: 0302 f408 0d0c 0104 0172 e300 0000 6303  .........r....c.
+00006da0: 0000 0000 0000 0000 0000 0006 0000 000a  ................
+00006db0: 0000 0043 0000 0073 b200 0000 7400 a001  ...C...s....t...
+00006dc0: 7400 6a02 7c00 6400 6400 8502 6400 6400  t.j.|.d.d...d.d.
+00006dd0: 8502 7c01 6401 1900 7c01 6402 1900 8502  ..|.d...|.d.....
+00006de0: 7c02 6401 1900 7c02 6402 1900 8502 6604  |.d...|.d.....f.
+00006df0: 1900 6403 7400 6a03 6404 8d03 a101 7d03  ..d.t.j.d.....}.
+00006e00: 7400 6a04 7c00 6405 6406 8d02 7d04 7c04  t.j.|.d.d...}.|.
+00006e10: 7400 a005 7c04 a101 1800 7400 a006 7c04  t...|.....t...|.
+00006e20: a101 7400 a005 7c04 a101 1800 1b00 7d04  ..t...|.......}.
+00006e30: 7400 a007 7c04 a101 7d05 6402 7c05 7c01  t...|...}.d.|.|.
+00006e40: 6401 1900 7c01 6402 1900 8502 7c02 6401  d...|.d.....|.d.
+00006e50: 1900 7c02 6402 1900 8502 6602 3c00 7c03  ..|.d.....f.<.|.
+00006e60: 6407 7c04 7c05 1700 1400 6602 5300 2908  d.|.|.....f.S.).
+00006e70: 4e72 0100 0000 7227 0000 00a9 0272 0600  Nr....r'.....r..
+00006e80: 0000 7217 0000 0029 0272 0c00 0000 724d  ..r....).r....rM
+00006e90: 0000 0072 9800 0000 7244 0000 0072 1600  ...r....rD...r..
+00006ea0: 0000 2908 7209 0000 0072 ba00 0000 72b5  ..).r....r....r.
+00006eb0: 0000 0072 9300 0000 720a 0000 0072 0b00  ...r....r....r..
+00006ec0: 0000 728e 0000 0072 1a00 0000 2906 7229  ..r....r....).r)
+00006ed0: 0000 00da 0579 7661 6c73 da05 7876 616c  .....yvals..xval
+00006ee0: 735a 0c73 7065 6374 7261 5f64 6174 615a  sZ.spectra_dataZ
+00006ef0: 0764 6174 615f 696d 5a07 6f76 6572 6c61  .data_imZ.overla
+00006f00: 7972 0f00 0000 720f 0000 0072 1000 0000  yr....r....r....
+00006f10: da0e 7370 6563 7472 615f 6669 6e64 6572  ..spectra_finder
+00006f20: b703 0000 7318 0000 0004 0104 012e 0102  ....s...........
+00006f30: 0104 0104 fd04 ff0e 0722 010a 0124 0110  ........."...$..
+00006f40: 0172 e700 0000 7202 0000 0063 0200 0000  .r....r....c....
+00006f50: 0000 0000 0000 0000 1d00 0000 0700 0000  ................
+00006f60: 4300 0000 73e6 0200 0074 006a 0164 0174  C...s....t.j.d.t
+00006f70: 00a0 027c 00a1 0164 0119 0085 0264 0174  ...|...d.....d.t
+00006f80: 00a0 027c 00a1 0164 0219 0085 0266 0219  ...|...d.....f..
+00006f90: 005c 027d 027d 037c 027c 0019 007d 047c  .\.}.}.|.|...}.|
+00006fa0: 037c 0019 007d 0574 00a0 037c 04a1 017d  .|...}.t...|...}
+00006fb0: 0674 00a0 047c 06a1 017d 0774 00a0 0574  .t...|...}.t...t
+00006fc0: 00a0 067c 027c 0019 007c 037c 0019 0066  ...|.|...|.|...f
+00006fd0: 02a1 01a1 017d 0874 006a 077c 0664 0366  .....}.t.j.|.d.f
+00006fe0: 0274 0864 048d 027d 0974 00a0 077c 0664  .t.d...}.t...|.d
+00006ff0: 0366 02a1 017d 0a64 017d 0b74 00a0 067c  .f...}.d.}.t...|
+00007000: 0464 0119 007c 0564 0119 0066 02a1 017c  .d...|.d...f...|
+00007010: 0a74 097c 0b83 0164 0164 0385 0266 023c  .t.|...d.d...f.<
+00007020: 0064 057c 0974 097c 0b83 0164 0164 0385  .d.|.t.|...d.d..
+00007030: 0266 023c 0064 027d 0c74 00a0 047c 06a1  .f.<.d.}.t...|..
+00007040: 0144 005d 917d 0d7c 0a74 097c 0c64 0218  .D.].}.|.t.|.d..
+00007050: 0083 0164 0166 0219 007d 0e7c 0a74 097c  ...d.f...}.|.t.|
+00007060: 0c64 0218 0083 0164 0266 0219 007d 0f74  .d.....d.f...}.t
+00007070: 00a0 0a7c 087c 090f 0019 0074 097c 067c  ...|.|.....t.|.|
+00007080: 0c18 0083 0164 0366 02a1 027d 107c 1064  .....d.f...}.|.d
+00007090: 0064 0085 0264 0166 0219 007c 0e18 0064  .d...d.f...|...d
+000070a0: 0313 007c 1064 0064 0085 0264 0266 0219  ...|.d.d...d.f..
+000070b0: 007c 0f18 0064 0313 0017 0064 0613 007d  .|...d.....d...}
+000070c0: 1174 00a0 0b7c 11a1 017d 127c 127c 016b  .t...|...}.|.|.k
+000070d0: 0072 fe7c 107c 117c 126b 0264 0166 0219  .r.|.|.|.k.d.f..
+000070e0: 0064 0119 007d 137c 107c 117c 126b 0264  .d...}.|.|.|.k.d
+000070f0: 0266 0219 0064 0119 007d 147c 077c 0864  .f...d...}.|.|.d
+00007100: 0064 0085 0264 0166 0219 007c 136b 027c  .d...d.f...|.k.|
+00007110: 0864 0064 0085 0264 0266 0219 007c 146b  .d.d...d.f...|.k
+00007120: 0240 0019 0064 0119 007d 0b74 00a0 067c  .@...d...}.t...|
+00007130: 137c 1466 02a1 017c 0a74 097c 0c83 0164  .|.f...|.t.|...d
+00007140: 0164 0385 0266 023c 0064 057c 0974 097c  .d...f.<.d.|.t.|
+00007150: 0b83 0164 0164 0385 0266 023c 007c 0c64  ...d.d...f.<.|.d
+00007160: 0717 007d 0c71 6d74 00a0 0a7c 087c 0919  ...}.qmt...|.|..
+00007170: 0074 097c 0c83 0164 0366 02a1 027d 1574  .t.|...d.f...}.t
+00007180: 00a0 0a7c 087c 090f 0019 0074 097c 067c  ...|.|.....t.|.|
+00007190: 0c18 0083 0164 0366 02a1 027d 1674 00a0  .....d.f...}.t..
+000071a0: 0c7c 00a1 017d 1764 027c 177c 1564 0064  .|...}.d.|.|.d.d
+000071b0: 0085 0264 0166 0219 007c 1564 0064 0085  ...d.f...|.d.d..
+000071c0: 0264 0266 0219 0066 023c 0074 00a0 0c7c  .d.f...f.<.t...|
+000071d0: 00a1 017d 1864 027c 187c 1664 0064 0085  ...}.d.|.|.d.d..
+000071e0: 0264 0166 0219 007c 1664 0064 0085 0264  .d.f...|.d.d...d
+000071f0: 0266 0219 0066 023c 0074 00a0 0d7c 17a1  .f...f.<.t...|..
+00007200: 017d 1974 00a0 0d7c 18a1 017d 1a7c 197c  .}.t...|...}.|.|
+00007210: 1a6b 0490 0172 6574 00a0 0e7c 17a1 017d  .k...ret...|...}
+00007220: 1b74 00a0 0e7c 18a1 017d 1c7c 1b7c 1c66  .t...|...}.|.|.f
+00007230: 0253 0074 00a0 0e7c 18a1 017d 1b74 00a0  .S.t...|...}.t..
+00007240: 0e7c 17a1 017d 1c7c 1b7c 1c66 0253 0029  .|...}.|.|.f.S.)
+00007250: 084e 7201 0000 0072 2700 0000 7225 0000  .Nr....r'...r%..
+00007260: 0072 5f00 0000 5472 1600 0000 6700 0000  .r_...Tr....g...
+00007270: 0000 00f0 3f29 0f72 0900 0000 7274 0000  ....?).r....rt..
+00007280: 0072 1900 0000 722e 0000 0072 9200 0000  .r....r....r....
+00007290: 7228 0000 0072 1800 0000 7241 0000 0072  r(...r....rA...r
+000072a0: 8700 0000 722f 0000 0072 0500 0000 720b  ....r/...r....r.
+000072b0: 0000 0072 1a00 0000 720a 0000 0072 6000  ...r....r....r`.
+000072c0: 0000 291d 5a08 6564 6765 5f6d 6170 5a0d  ..).Z.edge_mapZ.
+000072d0: 6564 6765 5f64 6973 7461 6e63 655a 0279  edge_distanceZ.y
+000072e0: 565a 0278 5672 3e00 0000 723f 0000 005a  VZ.xVr>...r?...Z
+000072f0: 096e 6f5f 706f 696e 7473 5a06 706f 696e  .no_pointsZ.poin
+00007300: 7473 5a0a 706f 696e 745f 6c69 7374 5a0a  tsZ.point_listZ.
+00007310: 7472 7574 685f 6c69 7374 5a0b 6564 6765  truth_listZ.edge
+00007320: 5f6c 6973 745f 315a 0c70 6f69 6e74 5f6e  _list_1Z.point_n
+00007330: 756d 6265 725a 0b65 6467 655f 706f 696e  umberZ.edge_poin
+00007340: 7473 72ab 0000 005a 076c 6173 745f 7979  tsr....Z.last_yy
+00007350: 5a07 6c61 7374 5f78 785a 0c6f 7468 6572  Z.last_xxZ.other
+00007360: 5f70 6f69 6e74 735a 0964 6973 745f 7661  _pointsZ.dist_va
+00007370: 6c73 5a08 6d69 6e5f 6469 7374 5a04 6e5f  lsZ.min_distZ.n_
+00007380: 7979 5a04 6e5f 7878 5a06 6c69 7374 5f31  yyZ.n_xxZ.list_1
+00007390: 5a06 6c69 7374 5f32 5a05 6564 6765 315a  Z.list_2Z.edge1Z
+000073a0: 0565 6467 6532 5a09 6564 6765 315f 7375  .edge2Z.edge1_su
+000073b0: 6d5a 0965 6467 6532 5f73 756d 5a0a 6f75  mZ.edge2_sumZ.ou
+000073c0: 7465 725f 6564 6765 5a0a 696e 6e65 725f  ter_edgeZ.inner_
+000073d0: 6564 6765 720f 0000 0072 0f00 0000 7210  edger....r....r.
+000073e0: 0000 00da 0a73 6f72 745f 6564 6765 73c6  .....sort_edges.
+000073f0: 0300 0073 6600 0000 2e01 0801 0801 0a01  ...sf...........
+00007400: 0a01 1c01 1201 0e01 0401 2601 1401 0401  ..........&.....
+00007410: 0e01 1401 1401 0401 1601 04ff 1604 1601  ................
+00007420: 02ff 0202 04fd 0a04 0801 1401 1401 0201  ................
+00007430: 2601 02ff 0202 04fe 1e03 1401 0801 0280  &...............
+00007440: 1801 1e01 0a01 2401 0a01 2401 0a01 0a01  ......$...$.....
+00007450: 0a01 0a01 0a01 0804 0afe 0a01 0801 72e8  ..............r.
+00007460: 0000 00e7 6666 6666 6666 ee3f 6302 0000  ....ffffff.?c...
+00007470: 0000 0000 0000 0000 0016 0000 0009 0000  ................
+00007480: 0043 0000 0073 8202 0000 6401 7400 a001  .C...s....d.t...
+00007490: 7c00 6a02 a101 1400 a003 7404 a101 7d02  |.j.......t...}.
+000074a0: 6402 7c02 7400 a001 7c00 6a02 a101 1800  d.|.t...|.j.....
+000074b0: 1400 a003 7404 a101 7d03 7400 a005 7c02  ....t...}.t...|.
+000074c0: a101 7d04 7c00 7c04 7c03 6403 1900 7c03  ..}.|.|.|.d...|.
+000074d0: 6403 1900 7c00 6a02 6403 1900 1700 8502  d...|.j.d.......
+000074e0: 7c03 6404 1900 7c03 6404 1900 7c00 6a02  |.d...|.d...|.j.
+000074f0: 6404 1900 1700 8502 6602 3c00 7c04 a003  d.......f.<.|...
+00007500: 7406 a101 7d05 7400 a007 7c04 a101 a003  t...}.t...|.....
+00007510: 7406 a101 7d06 7400 6a08 6403 7c02 6403  t...}.t.j.d.|.d.
+00007520: 1900 8502 6403 7c02 6404 1900 8502 6602  ....d.|.d.....f.
+00007530: 1900 5c02 7d07 7d08 7400 6a05 7c04 6a09  ..\.}.}.t.j.|.j.
+00007540: 6405 6602 7404 6406 8d02 7d09 7400 a00a  d.f.t.d...}.t...
+00007550: 7c07 a101 7c09 6400 6400 8502 6403 6602  |...|.d.d...d.f.
+00007560: 3c00 7400 a00a 7c08 a101 7c09 6400 6400  <.t...|...|.d.d.
+00007570: 8502 6404 6602 3c00 7c07 7c05 1900 7d0a  ..d.f.<.|.|...}.
+00007580: 7c08 7c05 1900 7d0b 7c07 7c06 1900 7d0c  |.|...}.|.|...}.
+00007590: 7c08 7c06 1900 7d0d 7400 6a0b 7c07 7400  |.|...}.t.j.|.t.
+000075a0: 6a0c 6406 8d02 7d0e 7400 6a0b 7c07 7400  j.d...}.t.j.|.t.
+000075b0: 6a0c 6406 8d02 7d0f 740d 740e 7c09 8301  j.d...}.t.t.|...
+000075c0: 8301 4400 5d2f 7d10 6407 7400 6a0f 1b00  ..D.]/}.d.t.j...
+000075d0: 7400 a010 7c0a 7c09 7c10 6403 6602 1900  t...|.|.|.d.f...
+000075e0: 1800 7c0b 7c09 7c10 6404 6602 1900 1800  ..|.|.|.d.f.....
+000075f0: a102 1400 7d11 7400 a011 7c11 a101 7400  ....}.t...|...t.
+00007600: a012 7c11 a101 1800 7c0e 7c09 7c10 6403  ..|.....|.|.|.d.
+00007610: 6602 1900 7c09 7c10 6404 6602 1900 6602  f...|.|.d.f...f.
+00007620: 3c00 719d 740d 740e 7c09 8301 8301 4400  <.q.t.t.|.....D.
+00007630: 5d2f 7d12 6407 7400 6a0f 1b00 7400 a010  ]/}.d.t.j...t...
+00007640: 7c0c 7c09 7c12 6403 6602 1900 1800 7c0d  |.|.|.d.f.....|.
+00007650: 7c09 7c12 6404 6602 1900 1800 a102 1400  |.|.d.f.........
+00007660: 7d13 7400 a011 7c13 a101 7400 a012 7c13  }.t...|...t...|.
+00007670: a101 1800 7c0f 7c09 7c12 6403 6602 1900  ....|.|.|.d.f...
+00007680: 7c09 7c12 6404 6602 1900 6602 3c00 71d3  |.|.d.f...f.<.q.
+00007690: 7400 a007 7c0f a101 7d0f 7400 a013 7c0e  t...|...}.t...|.
+000076a0: 7c01 7400 a011 7c0e a101 1400 6b04 7c0f  |.t...|.....k.|.
+000076b0: 7c01 7400 a011 7c0f a101 1400 6b04 a102  |.t...|.....k...
+000076c0: 7d14 7400 6a0b 7c00 7406 6406 8d02 7d15  }.t.j.|.t.d...}.
+000076d0: 7c14 7c03 6403 1900 7c03 6403 1900 7c00  |.|.d...|.d...|.
+000076e0: 6a02 6403 1900 1700 8502 7c03 6404 1900  j.d.......|.d...
+000076f0: 7c03 6404 1900 7c00 6a02 6404 1900 1700  |.d...|.j.d.....
+00007700: 8502 6602 1900 7d15 7c15 5300 2908 4e67  ..f...}.|.S.).Ng
+00007710: 0000 0000 0000 0440 7216 0000 0072 0100  .......@r....r..
+00007720: 0000 7227 0000 0072 2500 0000 725f 0000  ..r'...r%...r_..
+00007730: 00e9 b400 0000 2914 7209 0000 0072 1800  ......).r....r..
+00007740: 0000 7219 0000 0072 3a00 0000 722f 0000  ..r....r:...r/..
+00007750: 0072 4100 0000 7287 0000 005a 0666 6c69  .rA...r....Z.fli
+00007760: 706c 7272 7400 0000 722e 0000 0072 ba00  plrrt...r....r..
+00007770: 0000 721a 0000 0072 e200 0000 721b 0000  ..r....r....r...
+00007780: 0072 4600 0000 72b2 0000 005a 0761 7263  .rF...r....Z.arc
+00007790: 7461 6e32 728e 0000 0072 0b00 0000 728f  tan2r....r....r.
+000077a0: 0000 0029 165a 0565 6467 6573 da06 6375  ...).Z.edges..cu
+000077b0: 746f 6666 5a08 6269 675f 7369 7a65 5a07  toffZ.big_sizeZ.
+000077c0: 7374 6172 7465 725a 0962 6967 6765 725f  starterZ.bigger_
+000077d0: 6161 5a03 6161 315a 0361 6132 723e 0000  aaZ.aa1Z.aa2r>..
+000077e0: 0072 3f00 0000 72a6 0000 005a 0679 795f  .r?...r....Z.yy_
+000077f0: 6161 315a 0678 785f 6161 315a 0679 795f  aa1Z.xx_aa1Z.yy_
+00007800: 6161 325a 0678 785f 6161 325a 0a61 6e67  aa2Z.xx_aa2Z.ang
+00007810: 5f72 616e 6765 315a 0a61 6e67 5f72 616e  _range1Z.ang_ran
+00007820: 6765 3272 2200 0000 5a07 616e 676c 6573  ge2r"...Z.angles
+00007830: 3172 de00 0000 5a07 616e 676c 6573 325a  1r....Z.angles2Z
+00007840: 0961 6e67 5f72 616e 6765 5a0e 7265 616c  .ang_rangeZ.real
+00007850: 5f61 6e67 5f72 616e 6765 720f 0000 0072  _ang_ranger....r
+00007860: 0f00 0000 7210 0000 00da 0a67 6574 5f69  ....r......get_i
+00007870: 6e73 6964 65f8 0300 0073 5e00 0000 1601  nside....s^.....
+00007880: 1a01 0a01 0204 02fd 1801 1801 02ff 02ff  ................
+00007890: 0a04 1001 2201 1401 1601 1601 0801 0801  ...."...........
+000078a0: 0801 0801 1001 1001 1001 0c01 1c01 06ff  ................
+000078b0: 0c03 0201 20ff 1003 0c01 1c01 06ff 0c03  .... ...........
+000078c0: 0201 20ff 0a03 0401 1001 1001 04fe 0e04  .. .............
+000078d0: 0201 1801 1801 02ff 04ff 0404 72ec 0000  ............r...
+000078e0: 00e9 3200 0000 6302 0000 0000 0000 0000  ..2...c.........
+000078f0: 0000 0004 0000 0007 0000 0043 0000 0073  ...........C...s
+00007900: 5c00 0000 7400 6a01 a002 7400 6a01 a003  \...t.j...t.j...
+00007910: 7c00 a101 a101 5c02 7d02 7d03 7c01 7404  |.....\.}.}.|.t.
+00007920: a005 7c02 a101 1400 7c02 7c02 7c01 7404  ..|.....|.|.|.t.
+00007930: a005 7c02 a101 1400 6b04 3c00 7404 a005  ..|.....k.<.t...
+00007940: 7c02 a101 7c01 1b00 7c02 7c02 7404 a005  |...|...|.|.t...
+00007950: 7c02 a101 7c01 1b00 6b00 3c00 7c02 5300  |...|...k.<.|.S.
+00007960: 2901 4e29 0672 1d00 0000 721e 0000 0072  ).N).r....r....r
+00007970: b400 0000 72b6 0000 0072 0900 0000 7285  ....r....r....r.
+00007980: 0000 0029 0472 8800 0000 5a0a 6d65 645f  ...).r....Z.med_
+00007990: 6669 6c74 6572 5a08 6c73 5f69 6d61 6765  filterZ.ls_image
+000079a0: 72ab 0000 0072 0f00 0000 720f 0000 0072  r....r....r....r
+000079b0: 1000 0000 da0c 736f 6265 6c5f 6669 6c74  ......sobel_filt
+000079c0: 6572 2704 0000 730e 0000 0018 0106 0102  er'...s.........
+000079d0: 0118 ff0c 0414 ff04 0372 ee00 0000 6303  .........r....c.
+000079e0: 0000 0000 0000 0000 0000 0009 0000 0006  ................
+000079f0: 0000 0043 0000 0073 b200 0000 7400 6a01  ...C...s....t.j.
+00007a00: 6401 7c01 6a02 6401 1900 8502 6401 7c01  d.|.j.d.....d.|.
+00007a10: 6a02 6402 1900 8502 6602 1900 5c02 7d03  j.d.....f...\.}.
+00007a20: 7d04 7c03 7c00 6401 1900 1800 6403 1300  }.|.|.d.....d...
+00007a30: 7c04 7c00 6402 1900 1800 6403 1300 1700  |.|.d.....d.....
+00007a40: 7d05 7c01 7c05 7c02 6403 1300 6b00 1900  }.|.|.|.d...k...
+00007a50: 7d06 7c01 7403 7c00 6401 1900 6402 1800  }.|.t.|.d...d...
+00007a60: 8301 7403 7c00 6401 1900 6402 1700 8301  ..t.|.d...d.....
+00007a70: 8502 7403 7c00 6402 1900 6402 1800 8301  ..t.|.d...d.....
+00007a80: 7403 7c00 6402 1900 6402 1700 8301 8502  t.|.d...d.......
+00007a90: 6602 1900 7d07 7400 a004 7c07 a101 7400  f...}.t...|...t.
+00007aa0: a004 7c06 a101 1800 7d08 7c08 5300 2904  ..|.....}.|.S.).
+00007ab0: 4e72 0100 0000 7227 0000 0072 2500 0000  Nr....r'...r%...
+00007ac0: 2905 7209 0000 0072 7400 0000 7219 0000  ).r....rt...r...
+00007ad0: 0072 2f00 0000 72b5 0000 0029 095a 0870  .r/...r....).Z.p
+00007ae0: 6561 6b5f 706f 735a 0770 6561 6b5f 696d  eak_posZ.peak_im
+00007af0: 5a0a 6669 745f 7261 6469 7573 5a06 7072  Z.fit_radiusZ.pr
+00007b00: 6f6d 5f79 5a06 7072 6f6d 5f78 5a06 7072  om_yZ.prom_xZ.pr
+00007b10: 6f6d 5f72 5a09 7072 6f6d 5f76 616c 735a  om_rZ.prom_valsZ
+00007b20: 0970 726f 6d5f 7065 616b 5a0a 7072 6f6d  .prom_peakZ.prom
+00007b30: 696e 656e 6365 720f 0000 0072 0f00 0000  inencer....r....
+00007b40: 7210 0000 00da 0f70 6561 6b5f 7072 6f6d  r......peak_prom
+00007b50: 696e 656e 6365 3204 0000 7314 0000 0026  inence2...s....&
+00007b60: 0120 0110 0102 011e 011e 0102 ff04 ff14  . ..............
+00007b70: 0404 0172 ef00 0000 e79a 9999 9999 99c9  ...r............
+00007b80: 3f63 0d00 0000 0000 0000 0000 0000 4a00  ?c............J.
+00007b90: 0000 0b00 0000 4300 0000 73e8 0900 0074  ......C...s....t
+00007ba0: 00a0 017c 06a1 017d 0674 00a0 0274 00a0  ...|...}.t...t..
+00007bb0: 037c 06a1 0174 00a0 047c 06a1 010b 0066  .|...t...|.....f
+00007bc0: 0274 00a0 047c 06a1 0174 00a0 037c 06a1  .t...|...t...|..
+00007bd0: 0166 0266 02a1 017d 0d74 006a 0564 017c  .f.f...}.t.j.d.|
+00007be0: 006a 0664 0119 0085 0264 017c 006a 0664  .j.d.....d.|.j.d
+00007bf0: 0219 0085 0266 0219 005c 027d 0e7d 0f74  .....f...\.}.}.t
+00007c00: 00a0 0774 00a0 087c 04a1 01a1 0172 4374  ...t...|.....rCt
+00007c10: 00a0 0274 00a0 067c 0ea1 01a1 0164 031b  ...t...|.....d..
+00007c20: 007d 046e 0574 00a0 027c 04a1 017d 047c  .}.n.t...|...}.|
+00007c30: 0e7c 0464 0119 0018 0064 0313 007c 0f7c  .|.d.....d...|.|
+00007c40: 0464 0219 0018 0064 0313 0017 007d 1074  .d.....d.....}.t
+00007c50: 00a0 097c 10a1 017d 1164 027c 117c 107c  ...|...}.d.|.|.|
+00007c60: 0164 0313 006b 003c 0074 0a6a 0ba0 0c7c  .d...k.<.t.j...|
+00007c70: 11a1 015c 027d 127d 1374 00a0 0d7c 02a1  ...\.}.}.t...|..
+00007c80: 0164 016b 0272 8174 006a 0e7c 006a 0664  .d.k.r.t.j.|.j.d
+00007c90: 0164 0385 0219 0074 0f64 048d 027d 146e  .d.....t.d...}.n
+00007ca0: 027c 027d 147c 0064 0564 0585 0264 0564  .|.}.|.d.d...d.d
+00007cb0: 0585 027c 1466 0319 007d 157c 156a 0664  ...|.f...}.|.j.d
+00007cc0: 0619 007d 1674 006a 097c 1574 006a 1064  ...}.t.j.|.t.j.d
+00007cd0: 048d 027d 1774 117c 1683 0144 005d 5d7d  ...}.t.|...D.]]}
+00007ce0: 187c 1564 0564 0585 0264 0564 0585 027c  .|.d.d...d.d...|
+00007cf0: 1866 0319 007d 1964 0274 0a6a 0ba0 127c  .f...}.d.t.j...|
+00007d00: 19a1 0117 007d 1974 13a0 1474 00a0 157c  .....}.t...t...|
+00007d10: 19a1 0164 02a1 027d 1a74 0a6a 0ba0 0c7c  ...d...}.t.j...|
+00007d20: 1aa1 015c 027d 1b7d 1374 00a0 167c 1ba1  ...\.}.}.t...|..
+00007d30: 017c 0714 007c 1b7c 1b7c 0774 00a0 167c  .|...|.|.|.t...|
+00007d40: 1ba1 0114 006b 043c 0074 00a0 167c 1ba1  .....k.<.t...|..
+00007d50: 017c 071b 007c 1b7c 1b74 00a0 167c 1ba1  .|...|.|.t...|..
+00007d60: 017c 071b 006b 003c 0074 0a6a 0ba0 127c  .|...k.<.t.j...|
+00007d70: 1ba1 0174 0a6a 0ba0 127c 12a1 0117 007d  ...t.j...|.....}
+00007d80: 1b7c 1b7c 1764 0564 0585 0264 0564 0585  .|.|.d.d...d.d..
+00007d90: 027c 1866 033c 0071 9f7c 0c90 0172 0874  .|.f.<.q.|...r.t
+00007da0: 006a 167c 1764 0664 078d 027d 1c6e 0774  .j.|.d.d...}.n.t
+00007db0: 006a 087c 1764 0664 078d 027d 1c74 0a6a  .j.|.d.d...}.t.j
+00007dc0: 0ba0 177c 1c7c 127c 09a1 037d 1d74 186a  ...|.|.|...}.t.j
+00007dd0: 197c 1d74 1a64 037c 0114 0083 0164 0864  .|.t.d.|.....d.d
+00007de0: 098d 037d 1e74 136a 1ba0 1c7c 1ea1 0164  ...}.t.j...|...d
+00007df0: 0119 007d 1f74 00a0 0274 136a 1ba0 1d7c  ...}.t...t.j...|
+00007e00: 1e7c 1f74 1164 0274 00a0 1e7c 1fa1 0164  .|.t.d.t...|...d
+00007e10: 0217 0083 02a1 03a1 017d 207c 0564 016b  .........} |.d.k
+00007e20: 0490 0172 6b7c 2064 0564 0585 0264 0166  ...rk| d.d...d.f
+00007e30: 0219 007c 0464 0119 0018 0064 0313 007c  ...|.d.....d...|
+00007e40: 2064 0564 0585 0264 0266 0219 007c 0464   d.d...d.f...|.d
+00007e50: 0219 0018 0064 0313 0017 0064 0a13 007d  .....d.....d...}
+00007e60: 217c 207c 217c 056b 0064 0564 0585 0266  !| |!|.k.d.d...f
+00007e70: 0219 007d 207c 206a 0664 0119 0064 026b  ...} | j.d...d.k
+00007e80: 0290 0172 a774 006a 097c 1474 1064 048d  ...r.t.j.|.t.d..
+00007e90: 027d 2274 006a 097c 1474 1064 048d 027d  .}"t.j.|.t.d...}
+00007ea0: 2374 006a 097c 1474 1064 048d 027d 2474  #t.j.|.t.d...}$t
+00007eb0: 006a 097c 1474 1064 048d 027d 257c 147d  .j.|.t.d...}%|.}
+00007ec0: 2674 00a0 1f7c 167c 206a 0664 0119 007c  &t...|.| j.d...|
+00007ed0: 206a 0664 0219 0066 03a1 017d 277c 227c   j.d...f...}'|"|
+00007ee0: 237c 247c 257c 267c 2766 0653 0074 006a  #|$|%|&|'f.S.t.j
+00007ef0: 097c 2074 006a 2064 048d 027d 2874 006a  .| t.j d...}(t.j
+00007f00: 097c 2074 006a 2064 048d 027d 2974 117c  .| t.j d...})t.|
+00007f10: 206a 0664 0119 0083 0144 005d 237d 2a74   j.d.....D.]#}*t
+00007f20: 0a6a 0ba0 217c 1d7c 207c 2a64 0266 0219  .j..!|.| |*d.f..
+00007f30: 007c 207c 2a64 0166 0219 007c 01a1 047d  .| |*d.f...|...}
+00007f40: 2b74 00a0 227c 2b64 0164 0385 0219 00a1  +t.."|+d.d......
+00007f50: 017c 287c 2a64 0164 0385 0266 023c 0090  .|(|*d.d...f.<..
+00007f60: 0171 be74 006a 0d7c 287c 0418 0064 0313  .q.t.j.|(|...d..
+00007f70: 0064 0264 078d 0264 0a13 007d 2c7c 287c  .d.d...d...},|(|
+00007f80: 2c74 00a0 237c 2ca1 016b 0364 0564 0585  ,t..#|,..k.d.d..
+00007f90: 0266 0219 007c 287c 2c74 00a0 237c 2ca1  .f...|(|,t..#|,.
+00007fa0: 016b 0264 0564 0585 0266 0219 0018 007d  .k.d.d...f.....}
+00007fb0: 2d74 00a0 247c 206a 0664 0119 00a1 017c  -t..$| j.d.....|
+00007fc0: 2c74 00a0 237c 2ca1 016b 0219 0064 0119  ,t..#|,..k...d..
+00007fd0: 007d 2e74 00a0 1f74 1a74 00a0 0d7c 14a1  .}.t...t.t...|..
+00007fe0: 0183 017c 2d6a 0664 0119 007c 2d6a 0664  ...|-j.d...|-j.d
+00007ff0: 0219 0066 03a1 017d 2f74 006a 1f7c 167c  ...f...}/t.j.|.|
+00008000: 206a 0664 0119 0066 0274 006a 1064 048d   j.d...f.t.j.d..
+00008010: 027d 3074 117c 1683 0144 005d 797d 317c  .}0t.|...D.]y}1|
+00008020: 1764 0564 0585 0264 0564 0585 027c 3166  .d.d...d.d...|1f
+00008030: 0319 007d 3274 0a6a 0ba0 177c 327c 127c  ...}2t.j...|2|.|
+00008040: 09a1 037d 3374 117c 206a 0664 0119 0083  ...}3t.| j.d....
+00008050: 0144 005d 367d 3474 0a6a 0ba0 217c 337c  .D.]6}4t.j..!|3|
+00008060: 287c 3464 0266 0219 007c 287c 3464 0166  (|4d.f...|(|4d.f
+00008070: 0219 007c 01a1 047d 3574 00a0 227c 3564  ...|...}5t.."|5d
+00008080: 0164 0385 0219 00a1 017c 297c 3464 0164  .d.......|)|4d.d
+00008090: 0385 0266 023c 0074 0a6a 25a0 2674 00a0  ...f.<.t.j%.&t..
+000080a0: 227c 3564 0164 0385 0219 00a1 017c 337c  "|5d.d.......|3|
+000080b0: 01a1 037c 307c 317c 3466 023c 0090 0271  ...|0|1|4f.<...q
+000080c0: 5a7c 297c 2c74 00a0 237c 2ca1 016b 0364  Z|)|,t..#|,..k.d
+000080d0: 0564 0585 0266 0219 007c 297c 2c74 00a0  .d...f...|)|,t..
+000080e0: 237c 2ca1 016b 0264 0564 0585 0266 0219  #|,..k.d.d...f..
+000080f0: 0018 007d 367c 367c 2f7c 3164 0564 0585  ...}6|6|/|1d.d..
+00008100: 0264 0564 0585 0266 033c 0090 0271 3e74  .d.d...f.<...q>t
+00008110: 00a0 1f7c 146a 0664 0119 007c 146a 0664  ...|.j.d...|.j.d
+00008120: 0219 007c 306a 0664 0619 0066 03a1 017d  ...|0j.d...f...}
+00008130: 3774 00a0 247c 306a 0664 0619 00a1 0144  7t..$|0j.d.....D
+00008140: 005d 0f7d 187c 3064 0564 0585 027c 1866  .].}.|0d.d...|.f
+00008150: 0219 007c 377c 147c 1866 023c 0090 0271  ...|7|.|.f.<...q
+00008160: d174 006a 0e7c 376a 0664 0164 0385 0219  .t.j.|7j.d.d....
+00008170: 007c 376a 2764 048d 027d 3874 117c 306a  .|7j'd...}8t.|0j
+00008180: 0664 0619 0083 0144 005d 157d 187c 187c  .d.....D.].}.|.|
+00008190: 2e6b 0390 0372 097c 387c 3764 0564 0585  .k...r.|8|7d.d..
+000081a0: 0264 0564 0585 027c 1866 0319 0014 007d  .d.d...|.f.....}
+000081b0: 3890 0271 f564 017c 387c 3864 016b 003c  8..q.d.|8|8d.k.<
+000081c0: 007c 3864 027c 306a 0664 0619 0064 0218  .|8d.|0j.d...d..
+000081d0: 001b 0013 007d 3874 13a0 147c 3864 02a1  .....}8t...|8d..
+000081e0: 027d 397c 397c 1419 007d 3a7c 3a74 00a0  .}9|9|...}:|:t..
+000081f0: 287c 3aa1 011b 007d 3b64 017c 3b7c 3b7c  (|:....};d.|;|;|
+00008200: 036b 003c 0074 006a 097c 147c 3b6a 2764  .k.<.t.j.|.|;j'd
+00008210: 048d 027d 3c7c 3b7c 3c7c 143c 007c 3c64  ...}<|;|<|.<.|<d
+00008220: 016b 047d 2674 006a 2974 006a 0e7c 1674  .k.}&t.j)t.j.|.t
+00008230: 006a 2064 048d 0214 007d 3d74 006a 2974  .j d.....}=t.j)t
+00008240: 006a 0e7c 1674 006a 2064 048d 0214 007d  .j.|.t.j d.....}
+00008250: 3e74 006a 2974 006a 0e7c 1674 006a 2064  >t.j)t.j.|.t.j d
+00008260: 048d 0214 007d 3f74 006a 2974 006a 0e7c  .....}?t.j)t.j.|
+00008270: 1674 006a 2064 048d 0214 007d 4074 117c  .t.j d.....}@t.|
+00008280: 1683 0144 005d 4c7d 317c 2f7c 3164 0564  ...D.]L}1|/|1d.d
+00008290: 0585 0264 0564 0585 0266 0319 007d 3674  ...d.d...f...}6t
+000082a0: 006a 2a6a 2b7c 367c 2d64 0564 0b8d 035c  .j*j+|6|-d.d...\
+000082b0: 047d 417d 137d 137d 1374 00a0 2c7c 417c  .}A}.}.}.t..,|A|
+000082c0: 0da1 027d 417c 4174 00a0 2d64 03a1 0118  ...}A|At..-d....
+000082d0: 007d 417c 4164 0c19 007c 3d7c 313c 007c  .}A|Ad...|=|1<.|
+000082e0: 4164 0d19 007c 4164 0e19 0017 0064 031b  Ad...|Ad.....d..
+000082f0: 007c 3e7c 313c 007c 4164 0d19 007c 4164  .|>|1<.|Ad...|Ad
+00008300: 0e19 0018 0064 031b 007c 3f7c 313c 007c  .....d...|?|1<.|
+00008310: 4164 0f19 007c 407c 313c 0090 0371 7364  Ad...|@|1<...qsd
+00008320: 017c 3d74 00a0 077c 3da1 013c 0064 017c  .|=t...|=..<.d.|
+00008330: 3e74 00a0 077c 3ea1 013c 0064 017c 3f74  >t...|>..<.d.|?t
+00008340: 00a0 077c 3fa1 013c 0064 017c 4074 00a0  ...|?..<.d.|@t..
+00008350: 077c 40a1 013c 0074 006a 097c 147c 3d6a  .|@..<.t.j.|.|=j
+00008360: 2764 048d 027d 2274 006a 097c 147c 3d6a  'd...}"t.j.|.|=j
+00008370: 2764 048d 027d 2374 006a 097c 147c 3d6a  'd...}#t.j.|.|=j
+00008380: 2764 048d 027d 2474 006a 097c 147c 3d6a  'd...}$t.j.|.|=j
+00008390: 2764 048d 027d 2564 067c 0b14 007d 427c  'd...}%d.|...}B|
+000083a0: 3d7c 227c 143c 007c 2274 00a0 167c 227c  =|"|.<.|"t...|"|
+000083b0: 2619 00a1 0138 007d 227c 0b7c 227c 227c  &....8.}"|.|"|"|
+000083c0: 0b6b 043c 007c 427c 227c 227c 426b 003c  .k.<.|B|"|"|Bk.<
+000083d0: 007c 227c 26a0 2e74 10a1 0139 007d 227c  .|"|&..t...9.}"|
+000083e0: 3e7c 237c 143c 007c 2374 00a0 167c 237c  >|#|.<.|#t...|#|
+000083f0: 2619 00a1 0138 007d 237c 0b7c 237c 237c  &....8.}#|.|#|#|
+00008400: 0b6b 043c 007c 427c 237c 237c 426b 003c  .k.<.|B|#|#|Bk.<
+00008410: 007c 237c 26a0 2e74 10a1 0139 007d 237c  .|#|&..t...9.}#|
+00008420: 3f7c 247c 143c 007c 2474 00a0 167c 247c  ?|$|.<.|$t...|$|
+00008430: 2619 00a1 0138 007d 247c 0b7c 247c 247c  &....8.}$|.|$|$|
+00008440: 0b6b 043c 007c 427c 247c 247c 426b 003c  .k.<.|B|$|$|Bk.<
+00008450: 007c 247c 26a0 2e74 10a1 0139 007d 247c  .|$|&..t...9.}$|
+00008460: 407c 257c 143c 007c 2574 00a0 167c 257c  @|%|.<.|%t...|%|
+00008470: 2619 00a1 0138 007d 257c 0b7c 257c 257c  &....8.}%|.|%|%|
+00008480: 0b6b 043c 007c 427c 257c 257c 426b 003c  .k.<.|B|%|%|Bk.<
+00008490: 007c 257c 26a0 2e74 10a1 0139 007d 2574  .|%|&..t...9.}%t
+000084a0: 00a0 1f7c 146a 0664 0119 007c 146a 0664  ...|.j.d...|.j.d
+000084b0: 0219 007c 2f6a 0664 0219 007c 2f6a 0664  ...|/j.d...|/j.d
+000084c0: 0319 0066 04a1 017d 437c 2f7c 437c 1464  ...f...}C|/|C|.d
+000084d0: 0564 0585 0264 0564 0585 0266 033c 007c  .d...d.d...f.<.|
+000084e0: 437c 2664 0564 0585 0264 0564 0585 0266  C|&d.d...d.d...f
+000084f0: 0319 007d 4464 107d 4574 0a6a 0ba0 2f7c  ...}Dd.}Et.j../|
+00008500: 2664 027c 451b 00a1 027d 4674 0a6a 0ba0  &d.|E....}Ft.j..
+00008510: 0c7c 4664 11a1 025c 027d 477d 1374 0a6a  .|Fd...\.}G}.t.j
+00008520: 0ba0 307c 47a1 017d 4874 0a6a 0ba0 2f7c  ..0|G..}Ht.j../|
+00008530: 487c 45a1 027d 497c 497c 2619 007d 497c  H|E..}I|I|&..}I|
+00008540: 0a90 0472 eb74 13a0 147c 2264 02a1 027d  ...r.t...|"d...}
+00008550: 2274 13a0 147c 2364 02a1 027d 2374 13a0  "t...|#d...}#t..
+00008560: 147c 2464 02a1 027d 2474 13a0 147c 2564  .|$d...}$t...|%d
+00008570: 02a1 027d 257c 227c 237c 247c 257c 267c  ...}%|"|#|$|%|&|
+00008580: 447c 4966 0753 0029 1261 2e10 0000 0a20  D|If.S.).a..... 
+00008590: 2020 2047 6574 2073 7472 6169 6e20 6672     Get strain fr
+000085a0: 6f6d 2061 2052 4f49 2077 6974 686f 7574  om a ROI without
+000085b0: 2074 6865 206e 6565 6420 666f 720a 2020   the need for.  
+000085c0: 2020 7370 6563 6966 7969 6e67 204d 696c    specifying Mil
+000085d0: 6c65 7220 696e 6469 6365 7320 6f66 2064  ler indices of d
+000085e0: 6966 6672 6163 7469 6f6e 2073 706f 7473  iffraction spots
+000085f0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00008600: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00008610: 2020 2020 6461 7461 3444 3a20 2020 2020      data4D:     
+00008620: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00008630: 2020 2020 2020 2020 2020 5468 6973 2069            This i
+00008640: 7320 6120 3444 2064 6174 6173 6574 2077  s a 4D dataset w
+00008650: 6865 7265 2074 6865 2066 6972 7374 2074  here the first t
+00008660: 776f 2064 696d 656e 7369 6f6e 730a 2020  wo dimensions.  
+00008670: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00008680: 7265 2074 6865 2064 6966 6672 6163 7469  re the diffracti
+00008690: 6f6e 2064 696d 656e 7369 6f6e 7320 616e  on dimensions an
+000086a0: 6420 7468 6520 6e65 7874 2074 776f 0a20  d the next two. 
+000086b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000086c0: 6469 6d65 6e73 696f 6e73 2061 7265 2074  dimensions are t
+000086d0: 6865 2073 6361 6e20 6469 6d65 6e73 696f  he scan dimensio
+000086e0: 6e73 0a20 2020 2064 6973 6b5f 7261 6469  ns.    disk_radi
+000086f0: 7573 3a20 666c 6f61 740a 2020 2020 2020  us: float.      
+00008700: 2020 2020 2020 2020 2020 2052 6164 6975             Radiu
+00008710: 7320 696e 2070 6978 656c 7320 6f66 2074  s in pixels of t
+00008720: 6865 2064 6966 6672 6163 7469 6f6e 2064  he diffraction d
+00008730: 6973 6b73 0a20 2020 2052 4f49 3a20 2020  isks.    ROI:   
+00008740: 2020 2020 2020 6e64 6172 7261 792c 206f        ndarray, o
+00008750: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00008760: 2020 2020 2020 2020 2052 6567 696f 6e20           Region 
+00008770: 6f66 2069 6e74 6572 6573 742e 2049 6620  of interest. If 
+00008780: 6e6f 2052 4f49 2069 7320 7061 7373 6564  no ROI is passed
+00008790: 2074 6865 6e20 7468 6520 656e 7469 7265   then the entire
+000087a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000087b0: 2020 7363 616e 2072 6567 696f 6e20 6973    scan region is
+000087c0: 2074 6865 2052 4f49 0a20 2020 2070 726f   the ROI.    pro
+000087d0: 6d5f 7661 6c3a 2020 2020 666c 6f61 742c  m_val:    float,
+000087e0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000087f0: 2020 2020 2020 2020 2020 204d 696e 696d             Minim
+00008800: 756d 2070 726f 6d69 6e65 6e63 6520 7661  um prominence va
+00008810: 6c75 6520 746f 2075 7365 2074 6f20 7573  lue to use to us
+00008820: 6520 7468 6520 7065 616b 2066 6f72 0a20  e the peak for. 
+00008830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008840: 7374 7261 696e 206d 6170 7069 6e67 2e20  strain mapping. 
+00008850: 4465 6661 756c 7420 6973 2030 0a20 2020  Default is 0.   
+00008860: 2064 6973 6b5f 6365 6e74 6572 3a20 7475   disk_center: tu
+00008870: 706c 652c 206f 7074 696f 6e61 6c0a 2020  ple, optional.  
+00008880: 2020 2020 2020 2020 2020 2020 2020 204c                 L
+00008890: 6f63 6174 696f 6e20 6f66 2074 6865 2063  ocation of the c
+000088a0: 656e 7465 7220 6f66 2074 6865 2064 6966  enter of the dif
+000088b0: 6672 6163 7469 6f6e 2064 6973 6b20 2d20  fraction disk - 
+000088c0: 636c 6f73 6573 7420 746f 0a20 2020 2020  closest to.     
+000088d0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000088e0: 3c30 3030 3e20 756e 6469 6666 7261 6374  <000> undiffract
+000088f0: 6564 2062 6561 6d0a 2020 2020 6d61 785f  ed beam.    max_
+00008900: 7261 6469 7573 3a20 2066 6c6f 6174 2c20  radius:  float, 
+00008910: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00008920: 2020 2020 2020 2020 2020 4d61 7869 6d75            Maximu
+00008930: 6d20 6469 7374 616e 6365 2066 726f 6d20  m distance from 
+00008940: 7468 6520 6365 6e74 6572 2074 6f20 7573  the center to us
+00008950: 6520 666f 7220 6361 6c63 756c 6174 696f  e for calculatio
+00008960: 6e2e 2044 6566 6175 6c74 0a20 2020 2020  n. Default.     
+00008970: 2020 2020 2020 2020 2020 2020 6973 2030              is 0
+00008980: 2c20 7768 656e 2061 6c6c 2064 6973 7461  , when all dista
+00008990: 6e63 6573 2061 7265 2063 6f6e 7369 6465  nces are conside
+000089a0: 7265 642e 0a20 2020 2072 6f74 616e 676c  red..    rotangl
+000089b0: 653a 2020 2020 666c 6f61 742c 206f 7074  e:    float, opt
+000089c0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000089d0: 2020 2020 2020 2041 6e67 6c65 206f 6620         Angle of 
+000089e0: 726f 7461 7469 6f6e 206f 6620 7468 6520  rotation of the 
+000089f0: 4342 4544 2077 6974 6820 7265 7370 6563  CBED with respec
+00008a00: 7420 746f 2074 6865 206f 7074 6963 2061  t to the optic a
+00008a10: 7869 730a 2020 2020 2020 2020 2020 2020  xis.            
+00008a20: 2020 2020 2054 6869 7320 6d75 7374 2062       This must b
+00008a30: 6520 696e 2064 6567 7265 6573 0a20 2020  e in degrees.   
+00008a40: 206d 6564 5f66 6163 746f 723a 2020 666c   med_factor:  fl
+00008a50: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
+00008a60: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00008a70: 7565 2074 6f20 6465 7465 6374 6f72 206e  ue to detector n
+00008a80: 6f69 7365 2c20 736f 6d65 2073 7472 6179  oise, some stray
+00008a90: 2070 6978 656c 7320 6d61 7920 6f66 7465   pixels may ofte
+00008aa0: 6e20 6265 2062 7269 6768 7465 720a 2020  n be brighter.  
+00008ab0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00008ac0: 6861 6e20 7468 6520 6261 636b 6772 6f75  han the backgrou
+00008ad0: 6e64 2e20 5468 6973 2069 7320 7573 6564  nd. This is used
+00008ae0: 2066 6f72 2064 616d 7069 6e67 2061 6e79   for damping any
+00008af0: 2073 7563 6820 7069 7865 6c73 2e0a 2020   such pixels..  
+00008b00: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00008b10: 6566 6175 6c74 2069 7320 3330 0a20 2020  efault is 30.   
+00008b20: 2067 6175 7373 5f76 616c 3a20 2020 666c   gauss_val:   fl
+00008b30: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
+00008b40: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00008b50: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
+00008b60: 6174 696f 6e20 6f66 2074 6865 2047 6175  ation of the Gau
+00008b70: 7373 6961 6e20 6669 6c74 6572 2061 7070  ssian filter app
+00008b80: 6c69 6564 2074 6f20 7468 650a 2020 2020  lied to the.    
+00008b90: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00008ba0: 6172 6974 686d 206f 6620 7468 6520 4342  arithm of the CB
+00008bb0: 4544 2070 6174 7465 726e 2e20 4465 6661  ED pattern. Defa
+00008bc0: 756c 7420 6973 2033 0a20 2020 2068 7962  ult is 3.    hyb
+00008bd0: 7269 645f 6363 3a20 2020 666c 6f61 742c  rid_cc:   float,
+00008be0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00008bf0: 2020 2020 2020 2020 2020 2048 7962 7269             Hybri
+00008c00: 6469 7a61 7469 6f6e 2070 6172 616d 6574  dization paramet
+00008c10: 6572 2074 6f20 6265 2075 7365 6420 666f  er to be used fo
+00008c20: 7220 6372 6f73 732d 636f 7272 656c 6174  r cross-correlat
+00008c30: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00008c40: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
+00008c50: 2030 2e31 0a20 2020 2067 626c 7572 3a20   0.1.    gblur: 
+00008c60: 2020 2020 2020 626f 6f6c 2c20 6f70 7469        bool, opti
+00008c70: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00008c80: 2020 2020 2020 4966 2067 626c 7572 2069        If gblur i
+00008c90: 7320 6f6e 2c20 7468 6520 7374 7261 696e  s on, the strain
+00008ca0: 206d 6170 7320 6172 6520 626c 7572 7265   maps are blurre
+00008cb0: 6420 6279 2061 2073 696e 676c 650a 2020  d by a single.  
+00008cc0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00008cd0: 6978 656c 2e0a 2020 2020 2020 2020 2020  ixel..          
+00008ce0: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
+00008cf0: 7320 5472 7565 2e0a 2020 2020 6d61 785f  s True..    max_
+00008d00: 7374 7261 696e 3a20 2066 6c6f 6174 2c20  strain:  float, 
+00008d10: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00008d20: 2020 2020 2020 2020 2020 5461 6d70 2073            Tamp s
+00008d30: 7472 6169 6e20 7661 6c75 6520 6162 6f76  train value abov
+00008d40: 6520 7468 6973 2076 616c 7565 2e0a 2020  e this value..  
+00008d50: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00008d60: 6566 6175 6c74 2069 7320 302e 310a 2020  efault is 0.1.  
+00008d70: 2020 7461 6b65 5f6d 6564 6961 6e3a 2062    take_median: b
+00008d80: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
+00008d90: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+00008da0: 6620 5472 7565 2c20 7468 6520 4d65 616e  f True, the Mean
+00008db0: 5f43 4245 4420 6973 2074 6865 206d 6564  _CBED is the med
+00008dc0: 6961 6e20 6469 6666 7261 6374 696f 6e20  ian diffraction 
+00008dd0: 7061 7474 6572 6e20 696e 2074 6865 0a20  pattern in the. 
+00008de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008df0: 524f 492e 2049 6620 4661 6c73 652c 2069  ROI. If False, i
+00008e00: 7420 6973 2074 6865 206d 6561 6e20 6469  t is the mean di
+00008e10: 6666 7261 6374 696f 6e20 7061 7474 6572  ffraction patter
+00008e20: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008e30: 2020 2044 6566 6175 6c74 2069 7320 5472     Default is Tr
+00008e40: 7565 0a0a 2020 2020 5265 7475 726e 730a  ue..    Returns.
+00008e50: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00008e60: 655f 7878 5f6d 6170 3a20 206e 6461 7272  e_xx_map:  ndarr
+00008e70: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00008e80: 2020 5374 7261 696e 2069 6e20 7468 6520    Strain in the 
+00008e90: 7878 2064 6972 6563 7469 6f6e 2069 6e20  xx direction in 
+00008ea0: 7468 6520 7265 6769 6f6e 206f 6620 696e  the region of in
+00008eb0: 7465 7265 7374 0a20 2020 2065 5f78 795f  terest.    e_xy_
+00008ec0: 6d61 703a 2020 6e64 6172 7261 790a 2020  map:  ndarray.  
+00008ed0: 2020 2020 2020 2020 2020 2020 2053 7472               Str
+00008ee0: 6169 6e20 696e 2074 6865 2078 7920 6469  ain in the xy di
+00008ef0: 7265 6374 696f 6e20 696e 2074 6865 2072  rection in the r
+00008f00: 6567 696f 6e20 6f66 2069 6e74 6572 6573  egion of interes
+00008f10: 740a 2020 2020 655f 7468 5f6d 6170 3a20  t.    e_th_map: 
+00008f20: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00008f30: 2020 2020 2020 2020 416e 6775 6c61 7220          Angular 
+00008f40: 7374 7261 696e 2069 6e20 7468 6520 7265  strain in the re
+00008f50: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
+00008f60: 0a20 2020 2065 5f79 795f 6d61 703a 2020  .    e_yy_map:  
+00008f70: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00008f80: 2020 2020 2020 2053 7472 6169 6e20 696e         Strain in
+00008f90: 2074 6865 2079 7920 6469 7265 6374 696f   the yy directio
+00008fa0: 6e20 696e 2074 6865 2072 6567 696f 6e20  n in the region 
+00008fb0: 6f66 2069 6e74 6572 6573 740a 2020 2020  of interest.    
+00008fc0: 6e65 7752 4f49 3a20 2020 206e 6461 7272  newROI:    ndarr
+00008fd0: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00008fe0: 2020 4e65 7720 7265 6475 6365 6420 524f    New reduced RO
+00008ff0: 4920 7768 6572 6520 7468 6520 7072 6f6d  I where the prom
+00009000: 696e 656e 6365 206f 6620 7468 6520 6869  inence of the hi
+00009010: 6768 6572 0a20 2020 2020 2020 2020 2020  gher.           
+00009020: 2020 2020 6f72 6465 7220 6469 6666 7261      order diffra
+00009030: 6374 696f 6e20 6469 736b 7320 6973 2061  ction disks is a
+00009040: 626f 7665 2070 726f 6d5f 7661 6c0a 2020  bove prom_val.  
+00009050: 2020 6e65 775f 706f 733a 2020 206e 6461    new_pos:   nda
+00009060: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00009070: 2020 2020 4c69 7374 206f 6620 616c 6c20      List of all 
+00009080: 7468 6520 6869 6768 6572 206f 7264 6572  the higher order
+00009090: 2070 6561 6b20 706f 7369 7469 6f6e 7320   peak positions 
+000090a0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+000090b0: 2020 2020 7265 7370 6563 7420 746f 2074      respect to t
+000090c0: 6865 2063 656e 7472 616c 2064 6973 6b20  he central disk 
+000090d0: 666f 7220 616c 6c20 706f 7369 7469 6f6e  for all position
+000090e0: 7320 696e 2074 6865 2052 4f49 0a20 2020  s in the ROI.   
+000090f0: 2064 6973 7461 6e63 6573 3a20 6e64 6172   distances: ndar
+00009100: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00009110: 2020 204c 6973 7420 6f66 2064 6973 7461     List of dista
+00009120: 6e63 6573 2069 6e20 7468 6520 6e65 776c  nces in the newl
+00009130: 7920 6361 6c63 756c 6174 6564 2052 4f49  y calculated ROI
+00009140: 2066 726f 6d20 7468 650a 2020 2020 2020   from the.      
+00009150: 2020 2020 2020 2020 2070 6172 7469 636c           particl
+00009160: 6520 6564 6765 2e0a 0a20 2020 204e 6f74  e edge...    Not
+00009170: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+00009180: 2057 6520 6669 7273 7420 6f66 2061 6c6c   We first of all
+00009190: 2063 616c 6375 6c61 7465 2074 6865 2070   calculate the p
+000091a0: 7265 636f 6e64 6974 696f 6e65 6420 6461  reconditioned da
+000091b0: 7461 2028 6c6f 6720 2b20 536f 6265 6c20  ta (log + Sobel 
+000091c0: 6669 6c74 6572 6564 290a 2020 2020 666f  filtered).    fo
+000091d0: 7220 6576 6572 7920 4342 4544 2070 6174  r every CBED pat
+000091e0: 7465 726e 2069 6e20 7468 6520 524f 492e  tern in the ROI.
+000091f0: 2054 6865 6e20 7468 6520 6d65 616e 2070   Then the mean p
+00009200: 7265 636f 6e64 6974 696f 6e65 640a 2020  reconditioned.  
+00009210: 2020 7061 7474 6572 6e20 6973 2063 616c    pattern is cal
+00009220: 6375 6c61 7465 6420 616e 6420 6372 6f73  culated and cros
+00009230: 732d 636f 7272 656c 6174 6564 2077 6974  s-correlated wit
+00009240: 6820 7468 6520 536f 6265 6c20 7465 6d70  h the Sobel temp
+00009250: 6c61 7465 2e20 5468 6520 6469 736b 0a20  late. The disk. 
+00009260: 2020 2070 6f73 6974 696f 6e73 2061 7265     positions are
+00009270: 2061 7320 7065 616b 7320 696e 2074 6869   as peaks in thi
+00009280: 7320 6372 6f73 732d 636f 7272 656c 6174  s cross-correlat
+00009290: 6564 2070 6174 7465 726e 2c20 7769 7468  ed pattern, with
+000092a0: 2074 6865 2063 656e 7472 616c 0a20 2020   the central.   
+000092b0: 2064 6973 6b20 7468 6520 6f6e 6520 636c   disk the one cl
+000092c0: 6f73 6573 7420 746f 2074 6865 2063 656e  osest to the cen
+000092d0: 7465 7220 6f66 2074 6865 2043 4245 4420  ter of the CBED 
+000092e0: 7061 7474 6572 6e2e 2055 7369 6e67 2074  pattern. Using t
+000092f0: 6861 7420 696e 7369 6768 740a 2020 2020  hat insight.    
+00009300: 7468 6520 6469 7374 616e 6365 7320 6f66  the distances of
+00009310: 2074 6865 2068 6967 6865 7220 6f72 6465   the higher orde
+00009320: 7220 6469 6666 7261 6374 696f 6e20 6469  r diffraction di
+00009330: 736b 7320 6172 6520 6361 6c63 756c 6174  sks are calculat
+00009340: 6564 2077 6974 6820 7265 7370 6563 740a  ed with respect.
+00009350: 2020 2020 746f 2074 6865 2063 656e 7472      to the centr
+00009360: 616c 2074 7261 6e73 6d69 7474 6564 2062  al transmitted b
+00009370: 6561 6d2e 2054 6869 7320 6973 2074 6865  eam. This is the
+00009380: 6e20 7065 7266 6f72 6d65 6420 666f 7220  n performed for 
+00009390: 616c 6c20 6f74 6865 7220 4342 4544 0a20  all other CBED. 
+000093a0: 2020 2070 6174 7465 726e 732e 2054 6865     patterns. The
+000093b0: 2063 616c 6375 6c61 7465 6420 6869 6768   calculated high
+000093c0: 6572 206f 7264 6572 2064 6973 6b20 6c6f  er order disk lo
+000093d0: 6361 7469 6f6e 7320 6172 6520 7468 656e  cations are then
+000093e0: 2063 6f6d 7061 7265 6420 746f 2074 6865   compared to the
+000093f0: 0a20 2020 2068 6967 6865 7220 6f72 6465  .    higher orde
+00009400: 7220 6469 736b 206c 6f63 6174 696f 6e73  r disk locations
+00009410: 2066 6f72 2074 6865 206d 6564 6961 6e20   for the median 
+00009420: 7061 7474 6572 6e20 746f 2067 656e 6572  pattern to gener
+00009430: 6174 6520 7374 7261 696e 206d 6170 732e  ate strain maps.
+00009440: 0a20 2020 2048 6f77 6576 6572 2c20 736f  .    However, so
+00009450: 6d65 7469 6d65 7320 7468 6520 524f 4920  metimes the ROI 
+00009460: 6d61 7920 636f 6e74 6169 6e20 706f 696e  may contain poin
+00009470: 7473 2077 6865 7265 2074 6865 7265 2069  ts where there i
+00009480: 7320 6e6f 2064 6966 6672 6163 7469 6f6e  s no diffraction
+00009490: 0a20 2020 2070 6174 7465 726e 2061 6374  .    pattern act
+000094a0: 7561 6c6c 792e 2054 6f20 7072 6576 656e  ually. To preven
+000094b0: 7420 7069 636b 696e 6720 7375 6368 2070  t picking such p
+000094c0: 6f69 6e74 7320 616e 6420 6765 6e65 7261  oints and genera
+000094d0: 7469 6e67 2065 7272 6f6e 656f 7573 2072  ting erroneous r
+000094e0: 6573 756c 7473 2c0a 2020 2020 7765 2063  esults,.    we c
+000094f0: 616c 6375 6c61 7465 2074 6865 2070 6561  alculate the pea
+00009500: 6b20 7072 6f6d 696e 656e 6365 206f 6620  k prominence of 
+00009510: 6576 6572 7920 6869 6768 6572 206f 7264  every higher ord
+00009520: 6572 2064 6966 6672 6163 7469 6f6e 2073  er diffraction s
+00009530: 706f 742c 2061 6e64 206f 6e6c 790a 2020  pot, and only.  
+00009540: 2020 6966 2074 6865 7920 6172 6520 6d6f    if they are mo
+00009550: 7265 2070 726f 6d69 6e65 6e74 2074 6861  re prominent tha
+00009560: 6e20 6070 726f 6d5f 7661 6c60 2074 6865  n `prom_val` the
+00009570: 7920 7769 6c6c 2062 6520 6368 6f73 656e  y will be chosen
+00009580: 2e20 4966 2060 7072 6f6d 5f76 616c 6020  . If `prom_val` 
+00009590: 6973 0a20 2020 207a 6572 6f2c 2074 6865  is.    zero, the
+000095a0: 6e20 616c 6c20 7065 616b 7320 6172 6520  n all peaks are 
+000095b0: 6368 6f73 656e 2e0a 2020 2020 7201 0000  chosen..    r...
+000095c0: 0072 2700 0000 7225 0000 0072 5f00 0000  .r'...r%...r_...
+000095d0: 4e72 0600 0000 7244 0000 0046 2902 5a0c  Nr....rD...F).Z.
+000095e0: 6d69 6e5f 6469 7374 616e 6365 da07 696e  min_distance..in
+000095f0: 6469 6365 7372 1600 0000 7299 0000 0072  dicesr....r....r
+00009600: 8d00 0000 7298 0000 0072 4500 0000 72b1  ....r....rE...r.
+00009610: 0000 00e9 0600 0000 7202 0000 0029 3172  ........r....)1r
+00009620: 0900 0000 5a07 6465 6732 7261 6472 1800  ....Z.deg2radr..
+00009630: 0000 da03 636f 73da 0373 696e 7274 0000  ....cos..sinrt..
+00009640: 0072 1900 0000 729e 0000 0072 b500 0000  .r....r....r....
+00009650: 721a 0000 0072 1d00 0000 721e 0000 0072  r....r....r....r
+00009660: b400 0000 720a 0000 0072 9400 0000 7287  ....r....r....r.
+00009670: 0000 0072 e200 0000 721b 0000 0072 7900  ...r....r....ry.
+00009680: 0000 7207 0000 0072 b900 0000 da05 6c6f  ..r....r......lo
+00009690: 6731 3072 8500 0000 72b7 0000 00da 0673  g10r....r......s
+000096a0: 6b66 6561 745a 0e70 6561 6b5f 6c6f 6361  kfeatZ.peak_loca
+000096b0: 6c5f 6d61 7872 2f00 0000 5a0c 6d65 6173  l_maxr/...Z.meas
+000096c0: 7572 656d 656e 7473 da05 6c61 6265 6c5a  urements..labelZ
+000096d0: 0e63 656e 7465 725f 6f66 5f6d 6173 73da  .center_of_mass.
+000096e0: 036d 6178 7241 0000 0072 9300 0000 729d  .maxrA...r....r.
+000096f0: 0000 005a 0466 6c69 7072 0b00 0000 7292  ...Z.flipr....r.
+00009700: 0000 0072 5000 0000 72ef 0000 0072 4d00  ...rP...r....rM.
+00009710: 0000 728e 0000 0072 9c00 0000 729f 0000  ..r....r....r...
+00009720: 0072 a000 0000 72a1 0000 0072 b300 0000  .r....r....r....
+00009730: 723a 0000 0072 5e00 0000 da0e 6575 636c  r:...r^.....eucl
+00009740: 6964 6561 6e5f 6469 7374 294a 7229 0000  idean_dist)Jr)..
+00009750: 005a 0b64 6973 6b5f 7261 6469 7573 728b  .Z.disk_radiusr.
+00009760: 0000 005a 0870 726f 6d5f 7661 6c5a 0b64  ...Z.prom_valZ.d
+00009770: 6973 6b5f 6365 6e74 6572 5a0a 6d61 785f  isk_centerZ.max_
+00009780: 7261 6469 7573 7220 0000 0072 bf00 0000  radiusr ...r....
+00009790: 72c0 0000 0072 c100 0000 5a05 6762 6c75  r....r....Z.gblu
+000097a0: 725a 0a6d 6178 5f73 7472 6169 6e5a 0b74  rZ.max_strainZ.t
+000097b0: 616b 655f 6d65 6469 616e 5a09 726f 746d  ake_medianZ.rotm
+000097c0: 6174 7269 785a 0664 6966 665f 795a 0664  atrixZ.diff_yZ.d
+000097d0: 6966 665f 785a 0972 6164 6961 7469 6e67  iff_xZ.radiating
+000097e0: 5a04 6469 736b 5a0a 736f 6265 6c5f 6469  Z.diskZ.sobel_di
+000097f0: 736b 72ab 0000 005a 0569 6d52 4f49 5a06  skr....Z.imROIZ.
+00009800: 524f 495f 3444 72c2 0000 005a 074c 5342  ROI_4Dr....Z.LSB
+00009810: 5f52 4f49 7222 0000 005a 0463 6265 6472  _ROIr"...Z.cbedr
+00009820: d500 0000 5a08 6c73 625f 6362 6564 5a08  ....Z.lsb_cbedZ.
+00009830: 4d65 616e 5f4c 5342 5a06 4c53 425f 4343  Mean_LSBZ.LSB_CC
+00009840: 5a0a 6461 7461 5f70 6561 6b73 5a0b 7065  Z.data_peaksZ.pe
+00009850: 616b 5f6c 6162 656c 735a 0c6d 6572 6765  ak_labelsZ.merge
+00009860: 645f 7065 616b 735a 0a64 6973 745f 7065  d_peaksZ.dist_pe
+00009870: 616b 7372 c900 0000 72ca 0000 0072 cb00  aksr....r....r..
+00009880: 0000 72cc 0000 005a 066e 6577 524f 495a  ..r....Z.newROIZ
+00009890: 0c6e 6577 5f6c 6973 745f 706f 735a 0b66  .new_list_posZ.f
+000098a0: 6974 7465 645f 6d65 616e 5a0b 6669 7474  itted_meanZ.fitt
+000098b0: 6564 5f73 6361 6e72 de00 0000 72a9 0000  ed_scanr....r...
+000098c0: 005a 0764 6973 7461 7272 5a0a 7065 616b  .Z.distarrZ.peak
+000098d0: 735f 6d65 616e 5a0f 6365 6e74 7261 6c5f  s_meanZ.central_
+000098e0: 6469 736b 5f6e 6f5a 086c 6973 745f 706f  disk_noZ.list_po
+000098f0: 735a 0b70 726f 6d69 6e65 6e63 6573 5a02  sZ.prominencesZ.
+00009900: 6b6b 5a08 7363 616e 5f4c 5342 5a07 7363  kkZ.scan_LSBZ.sc
+00009910: 616e 5f43 435a 0271 715a 0873 6361 6e5f  an_CCZ.qqZ.scan_
+00009920: 7061 725a 0a70 6561 6b73 5f73 6361 6e5a  parZ.peaks_scanZ
+00009930: 0e70 726f 6d69 6e65 6e63 655f 6d61 705a  .prominence_mapZ
+00009940: 0a70 726f 6d5f 6469 736b 735a 0b70 726f  .prom_disksZ.pro
+00009950: 6d5f 6469 736b 7347 5a06 7072 6f6d 7373  m_disksGZ.promss
+00009960: 5a07 7072 6f6d 7373 325a 0b70 726f 6d5f  Z.promss2Z.prom_
+00009970: 6469 736b 7332 5a07 6578 785f 524f 495a  disks2Z.exx_ROIZ
+00009980: 0765 7879 5f52 4f49 5a07 6574 685f 524f  .exy_ROIZ.eth_RO
+00009990: 495a 0765 7979 5f52 4f49 5a0b 7363 616e  IZ.eyy_ROIZ.scan
+000099a0: 5f73 7472 6169 6e5a 0a6d 696e 5f73 7472  _strainZ.min_str
+000099b0: 6169 6e5a 086c 6973 745f 6d61 70da 076e  ainZ.list_map..n
+000099c0: 6577 5f70 6f73 da0a 7570 7361 6d70 6c69  ew_pos..upsampli
+000099d0: 6e67 da07 726f 695f 7570 73da 0872 6f69  ng..roi_ups..roi
+000099e0: 5f65 6467 65da 0972 6f69 5f64 6973 7473  _edge..roi_dists
+000099f0: 5a09 6469 7374 616e 6365 7372 0f00 0000  Z.distancesr....
+00009a00: 720f 0000 0072 1000 0000 da10 7374 7261  r....r......stra
+00009a10: 696e 3444 5f67 656e 6572 616c 3e04 0000  in4D_general>...
+00009a20: 735e 0100 000a 6604 0128 0104 ff26 0310  s^....f..(...&..
+00009a30: 0116 010a 0220 020a 0110 0110 010e 011a  ..... ..........
+00009a40: 0104 0216 010a 0110 010c 0116 0110 0112  ................
+00009a50: 0110 010c 0214 ff0c 0414 ff10 0302 0106  ................
+00009a60: ff18 0306 0110 010e 0210 0104 010e 0106  ................
+00009a70: ff10 0304 0106 0116 0102 ff04 ff0a 051a  ................
+00009a80: 021a 0102 ff02 0204 fd14 0410 020e 010e  ................
+00009a90: 010e 010e 0104 0104 0114 0104 ff10 0310  ................
+00009aa0: 0210 0112 0206 0118 0104 ff22 031a 0118  ..........."....
+00009ab0: 0218 0102 ff02 ff22 0426 021a 010c 0216  .......".&......
+00009ac0: 0110 0112 0106 0118 0104 ff1e 0306 0114  ................
+00009ad0: 0110 ff18 0418 0102 ff02 ff1a 0422 0214  ............."..
+00009ae0: 011c 011a 0212 010a 011a 0104 800c 0116  ................
+00009af0: 010c 0108 020e 010c 0110 0108 0108 0216  ................
+00009b00: 0216 0116 0116 010c 0216 011a 010c 020e  ................
+00009b10: 010c 0118 0118 0110 010e 030e 010e 010e  ................
+00009b20: 0110 0210 0110 0110 0108 0208 0212 010c  ................
+00009b30: 010c 010e 0108 0212 010c 010c 010e 0108  ................
+00009b40: 0212 010c 010c 010e 0108 0212 010c 010c  ................
+00009b50: 010e 0104 0222 0104 ff16 0316 0104 0212  ....."..........
+00009b60: 0112 010c 010e 0108 0106 020c 010c 010c  ................
+00009b70: 010c 0102 0302 0102 0102 0102 0102 0102  ................
+00009b80: 0104 f972 ff00 0000 6302 0000 0000 0000  ...r....c.......
+00009b90: 0000 0000 000f 0000 0009 0000 0043 0000  .............C..
+00009ba0: 0073 8201 0000 7400 6a01 7c01 6401 6402  .s....t.j.|.d.d.
+00009bb0: 8d02 7d01 7400 a002 7c01 a101 7d02 7400  ..}.t...|...}.t.
+00009bc0: a003 6403 a101 7d01 7c02 7c01 6404 6403  ..d...}.|.|.d.d.
+00009bd0: 8502 3c00 7400 a004 7c00 6a05 a101 7d03  ..<.t...|.j...}.
+00009be0: 7400 a006 7c03 7c01 1b00 a101 a007 7408  t...|.|.......t.
+00009bf0: a101 7d04 7c04 7c01 1400 a007 7408 a101  ..}.|.|.....t...
+00009c00: 7d05 7400 6a09 7c04 6405 6403 8502 1900  }.t.j.|.d.d.....
+00009c10: 7c00 6a0a 6406 8d02 7d06 7400 6a09 7c05  |.j.d...}.t.j.|.
+00009c20: 6405 6403 8502 1900 7c00 6a0a 6406 8d02  d.d.....|.j.d...
+00009c30: 7d07 7c00 7c07 6407 6407 8502 6407 6407  }.|.|.d.d...d.d.
+00009c40: 8502 6405 7c03 6404 1900 8502 6405 7c03  ..d.|.d.....d.|.
+00009c50: 6408 1900 8502 6604 3c00 740b 7c04 6404  d.....f.<.t.|.d.
+00009c60: 1900 8301 4400 5d50 7d08 740b 7c04 6408  ....D.]P}.t.|.d.
+00009c70: 1900 8301 4400 5d47 7d09 7408 7c01 6404  ....D.]G}.t.|.d.
+00009c80: 1900 7c08 1400 8301 7d0a 7408 7c01 6404  ..|.....}.t.|.d.
+00009c90: 1900 7c08 6401 1700 1400 8301 7d0b 7408  ..|.d.......}.t.
+00009ca0: 7c01 6408 1900 7c09 1400 8301 7d0c 7408  |.d...|.....}.t.
+00009cb0: 7c01 6408 1900 7c09 6401 1700 1400 8301  |.d...|.d.......
+00009cc0: 7d0d 7400 6a0c 7c07 6407 6407 8502 6407  }.t.j.|.d.d...d.
+00009cd0: 6407 8502 7c0a 7c0b 8502 7c0c 7c0d 8502  d...|.|...|.|...
+00009ce0: 6604 1900 6409 640a 8d02 7d0e 7c0e 7c06  f...d.d...}.|.|.
+00009cf0: 6407 6407 8502 6407 6407 8502 7c08 7c09  d.d...d.d...|.|.
+00009d00: 6604 3c00 7168 7160 7c06 7c01 6404 1900  f.<.qhq`|.|.d...
+00009d10: 7c01 6408 1900 1400 1b00 7d06 7c06 a007  |.d.......}.|...
+00009d20: 7c00 6a0a a101 5300 290b 61c5 0300 000a  |.j...S.).a.....
+00009d30: 2020 2020 4269 6e20 7468 6520 6461 7461      Bin the data
+00009d40: 2069 6e20 7468 6520 7363 616e 2064 696d   in the scan dim
+00009d50: 656e 7369 6f6e 730a 0a20 2020 2050 6172  ensions..    Par
+00009d60: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00009d70: 2d2d 2d2d 2d2d 0a20 2020 2064 6174 6134  ------.    data4
+00009d80: 443a 2020 2020 206e 6461 7272 6179 0a20  D:     ndarray. 
+00009d90: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00009da0: 6869 7320 6973 2061 2034 4420 6461 7461  his is a 4D data
+00009db0: 7365 7420 7768 6572 6520 7468 6520 6669  set where the fi
+00009dc0: 7273 7420 7477 6f20 6469 6d65 6e73 696f  rst two dimensio
+00009dd0: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
+00009de0: 2020 2061 7265 2074 6865 2064 6666 7261     are the dffra
+00009df0: 6374 696f 6e20 6469 6d65 6e73 696f 6e73  ction dimensions
+00009e00: 2061 6e64 2074 6865 206e 6578 7420 7477   and the next tw
+00009e10: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
+00009e20: 2020 6469 6d65 6e73 696f 6e73 2061 7265    dimensions are
+00009e30: 2074 6865 2073 6361 6e20 6469 6d65 6e73   the scan dimens
+00009e40: 696f 6e73 0a20 2020 2062 696e 5f66 6163  ions.    bin_fac
+00009e50: 746f 723a 2069 6e74 206f 7220 7475 706c  tor: int or tupl
+00009e60: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00009e70: 2020 4269 6e6e 696e 6720 6661 6374 6f72    Binning factor
+00009e80: 2066 6f72 2073 6361 6e20 6469 6d65 6e73   for scan dimens
+00009e90: 696f 6e73 0a0a 2020 2020 5265 7475 726e  ions..    Return
+00009ea0: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+00009eb0: 2020 6269 6e6e 6564 5f34 443a 206e 6461    binned_4D: nda
+00009ec0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00009ed0: 2020 2020 5468 6520 6461 7461 2062 696e      The data bin
+00009ee0: 6e65 6420 696e 2074 6865 2073 6361 6e6e  ned in the scann
+00009ef0: 6564 2064 696d 656e 7369 6f6e 732e 0a0a  ed dimensions...
+00009f00: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+00009f10: 2d2d 2d0a 2020 2020 596f 7520 6361 6e20  ---.    You can 
+00009f20: 7370 6563 6966 7920 7468 6520 6269 6e20  specify the bin 
+00009f30: 6661 6374 6f72 2074 6f20 6265 2065 6974  factor to be eit
+00009f40: 6865 7220 616e 2069 6e74 6567 6572 206f  her an integer o
+00009f50: 720a 2020 2020 6120 7475 706c 652e 2049  r.    a tuple. I
+00009f60: 6620 796f 7520 7370 6563 6966 7920 616e  f you specify an
+00009f70: 2069 6e74 6567 6572 2074 6865 2073 616d   integer the sam
+00009f80: 6520 6269 6e6e 696e 6720 7769 6c6c 0a20  e binning will. 
+00009f90: 2020 2062 6520 7573 6564 2069 6e20 626f     be used in bo
+00009fa0: 7468 2074 6865 2073 6361 6e20 5820 616e  th the scan X an
+00009fb0: 6420 7363 616e 2059 2064 696d 656e 7369  d scan Y dimensi
+00009fc0: 6f6e 732c 2077 6869 6c65 2069 660a 2020  ons, while if.  
+00009fd0: 2020 796f 7520 7370 6563 6966 7920 6120    you specify a 
+00009fe0: 7475 706c 6520 7468 656e 2064 6966 6665  tuple then diffe
+00009ff0: 7265 6e74 2062 696e 6e69 6e67 2066 6163  rent binning fac
+0000a000: 746f 7273 2066 6f72 2065 6163 680a 2020  tors for each.  
+0000a010: 2020 6469 6d65 6e73 696f 6e73 2e0a 0a20    dimensions... 
+0000a020: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0000a030: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2052 756e  --------.    Run
+0000a040: 2061 733a 0a0a 2020 2020 3e3e 3e20 6269   as:..    >>> bi
+0000a050: 6e6e 6564 5f34 4420 3d20 6269 6e5f 7363  nned_4D = bin_sc
+0000a060: 616e 2864 6174 6134 442c 2034 290a 0a20  an(data4D, 4).. 
+0000a070: 2020 2054 6869 7320 7769 6c6c 2062 696e     This will bin
+0000a080: 2074 6865 2073 6361 6e20 6469 6d65 6e73   the scan dimens
+0000a090: 696f 6e73 2062 7920 342e 2054 6869 7320  ions by 4. This 
+0000a0a0: 6973 2066 756e 6374 696f 6e61 6c6c 790a  is functionally.
+0000a0b0: 2020 2020 6964 656e 7469 6361 6c20 746f      identical to
+0000a0c0: 3a0a 0a20 2020 203e 3e3e 2062 696e 6e65  :..    >>> binne
+0000a0d0: 645f 3444 203d 2062 696e 5f73 6361 6e28  d_4D = bin_scan(
+0000a0e0: 6461 7461 3444 2c20 2834 2c20 3429 290a  data4D, (4, 4)).
+0000a0f0: 2020 2020 7227 0000 00a9 015a 056e 646d      r'.....Z.ndm
+0000a100: 696e 7268 0000 0072 2500 0000 7201 0000  inrh...r%...r...
+0000a110: 0072 5f00 0000 4e72 2600 0000 72e4 0000  .r_...Nr&...r...
+0000a120: 0072 4400 0000 290d 7209 0000 0072 8100  .rD...).r....r..
+0000a130: 0000 7260 0000 0072 9400 0000 7218 0000  ..r`...r....r...
+0000a140: 0072 1900 0000 da04 6365 696c 723a 0000  .r......ceilr:..
+0000a150: 0072 2f00 0000 7241 0000 0072 4d00 0000  .r/...rA...rM...
+0000a160: 721b 0000 0072 0a00 0000 290f 7229 0000  r....r....).r)..
+0000a170: 0072 6100 0000 da02 6266 da09 696e 695f  .ra.....bf..ini_
+0000a180: 7368 6170 65da 0966 696e 5f73 6861 7065  shape..fin_shape
+0000a190: 5a09 6269 675f 7368 6170 65da 0962 696e  Z.big_shape..bin
+0000a1a0: 6e65 645f 3444 da05 6269 6734 4472 2200  ned_4D..big4Dr".
+0000a1b0: 0000 72de 0000 00da 0a73 7461 7274 6572  ..r......starter
+0000a1c0: 5f69 69da 0a73 746f 7070 6572 5f69 69da  _ii..stopper_ii.
+0000a1d0: 0a73 7461 7274 6572 5f6a 6ada 0a73 746f  .starter_jj..sto
+0000a1e0: 7070 6572 5f6a 6ada 0b73 756d 6d65 645f  pper_jj..summed_
+0000a1f0: 6362 6564 720f 0000 0072 0f00 0000 7210  cbedr....r....r.
+0000a200: 0000 00da 0862 696e 5f73 6361 6e72 0500  .....bin_scanr..
+0000a210: 0073 2e00 0000 0e25 0a01 0a01 0c01 0c01  .s.....%........
+0000a220: 1401 0e01 1801 1801 2801 1001 1001 1001  ........(.......
+0000a230: 1401 1001 1401 0401 2001 06ff 1a03 02f8  ........ .......
+0000a240: 1409 0c01 720c 0100 00e7 0000 0000 0000  ....r...........
+0000a250: d03f 6306 0000 0000 0000 0000 0000 000c  .?c.............
+0000a260: 0000 0008 0000 0043 0000 0073 0601 0000  .......C...s....
+0000a270: 7400 6a01 a002 7403 a004 7c00 6a05 a101  t.j...t...|.j...
+0000a280: 7c00 6a05 6401 1900 6402 1b00 7c00 6a05  |.j.d...d...|.j.
+0000a290: 6403 1900 6402 1b00 7c01 a104 7d06 7400  d...d...|...}.t.
+0000a2a0: 6a01 a006 7c06 a101 5c02 7d07 7d08 7403  j...|...\.}.}.t.
+0000a2b0: a007 7c00 a101 7d09 7c02 7403 a008 7c09  ..|...}.|.t...|.
+0000a2c0: a101 1400 7c09 7c09 7c02 7403 a008 7c09  ....|.|.|.t...|.
+0000a2d0: a101 1400 6b04 3c00 7403 a008 7c09 a101  ....k.<.t...|...
+0000a2e0: 7c02 1b00 7c09 7c09 7403 a008 7c09 a101  |...|.|.t...|...
+0000a2f0: 7c02 1b00 6b00 3c00 7400 6a01 a006 7409  |...k.<.t.j...t.
+0000a300: a00a 7400 6a01 a00b 7c09 7c05 a102 6401  ..t.j...|.|...d.
+0000a310: a102 a101 5c02 7d0a 7d08 7c03 7277 7c02  ....\.}.}.|.rw|.
+0000a320: 7403 a008 7c0a a101 1400 7c0a 7c0a 7c02  t...|.....|.|.|.
+0000a330: 7403 a008 7c0a a101 1400 6b04 3c00 7403  t...|.....k.<.t.
+0000a340: a008 7c0a a101 7c02 1b00 7c0a 7c0a 7403  ..|...|...|.|.t.
+0000a350: a008 7c0a a101 7c02 1b00 6b00 3c00 7400  ..|...|...k.<.t.
+0000a360: 6a01 a00c 7c0a 7c07 7c04 a103 7d0b 7c0a  j...|.|.|...}.|.
+0000a370: 7c0b 6602 5300 2904 61a1 0a00 000a 2020  |.f.S.).a.....  
+0000a380: 2020 4765 6e65 7261 7465 2074 6865 2066    Generate the f
+0000a390: 696c 7465 7265 6420 6372 6f73 732d 636f  iltered cross-co
+0000a3a0: 7272 656c 6174 6564 2069 6d61 6765 2066  rrelated image f
+0000a3b0: 6f72 206c 6f63 6174 696e 6720 6469 736b  or locating disk
+0000a3c0: 0a20 2020 2070 6f73 6974 696f 6e73 0a0a  .    positions..
+0000a3d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000a3e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0000a3f0: 2020 696d 6167 653a 2020 2020 2020 6e64    image:      nd
+0000a400: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+0000a410: 2020 2020 2020 5468 6520 696d 6167 6520        The image 
+0000a420: 746f 2062 6520 6669 6c74 6572 6564 0a20  to be filtered. 
+0000a430: 2020 2062 6561 6d5f 7261 643a 2020 2066     beam_rad:   f
+0000a440: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
+0000a450: 2020 2020 2052 6164 6975 7320 6f66 2074       Radius of t
+0000a460: 6865 2063 6972 636c 652e 2054 6865 2063  he circle. The c
+0000a470: 6972 636c 6520 7573 6564 2066 6f72 0a20  ircle used for. 
+0000a480: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000a490: 726f 7373 2d63 6f72 7265 6c61 7469 6e67  ross-correlating
+0000a4a0: 2069 7320 616c 7761 7973 2063 656e 7465   is always cente
+0000a4b0: 7265 6420 6174 2074 6865 2069 6d61 6765  red at the image
+0000a4c0: 2063 656e 7465 722e 0a20 2020 206d 6564   center..    med
+0000a4d0: 5f76 616c 3a20 2020 2066 6c6f 6174 2c20  _val:    float, 
+0000a4e0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000a4f0: 2020 2020 2020 2020 2044 6576 6961 7469           Deviati
+0000a500: 6f6e 2066 726f 6d20 6d65 6469 616e 2076  on from median v
+0000a510: 616c 7565 2074 6f20 6163 6365 7074 2069  alue to accept i
+0000a520: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
+0000a530: 2020 2020 2020 536f 6265 6c20 6669 6c74        Sobel filt
+0000a540: 6572 6564 2069 6d61 6765 2e20 4465 6661  ered image. Defa
+0000a550: 756c 7420 6973 2035 300a 2020 2020 7365  ult is 50.    se
+0000a560: 635f 6d65 643a 2020 2020 626f 6f6c 2c20  c_med:    bool, 
+0000a570: 4f70 7469 6f6e 616c 0a20 2020 2020 2020  Optional.       
+0000a580: 2020 2020 2020 2020 2054 616d 7073 206f           Tamps o
+0000a590: 7574 2064 6576 6961 7469 6f6e 2066 726f  ut deviation fro
+0000a5a0: 6d20 6d65 6469 616e 2076 616c 7565 7320  m median values 
+0000a5b0: 696e 2074 6865 0a20 2020 2020 2020 2020  in the.         
+0000a5c0: 2020 2020 2020 2053 6f62 656c 2066 696c         Sobel fil
+0000a5d0: 7465 7265 6420 696d 6167 6520 746f 6f20  tered image too 
+0000a5e0: 6966 2054 7275 650a 2020 2020 6879 6272  if True.    hybr
+0000a5f0: 6964 697a 6572 3a20 666c 6f61 742c 206f  idizer: float, o
+0000a600: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000a610: 2020 2020 2020 2020 5468 6520 7661 6c75          The valu
+0000a620: 6520 746f 2075 7365 2066 6f72 2068 7962  e to use for hyb
+0000a630: 7269 6420 6372 6f73 732d 636f 7272 656c  rid cross-correl
+0000a640: 6174 696f 6e2e 0a20 2020 2020 2020 2020  ation..         
+0000a650: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
+0000a660: 7320 302e 3235 2e20 3020 6769 7665 7320  s 0.25. 0 gives 
+0000a670: 7075 7265 2063 726f 7373 2063 6f72 7265  pure cross corre
+0000a680: 6c61 7469 6f6e 2c0a 2020 2020 2020 2020  lation,.        
+0000a690: 2020 2020 2020 2020 7768 696c 6520 3120          while 1 
+0000a6a0: 6769 7665 7320 7075 7265 2070 6861 7365  gives pure phase
+0000a6b0: 2063 6f72 7265 6c61 7469 6f6e 0a20 2020   correlation.   
+0000a6c0: 2062 6974 5f64 6570 7468 3a20 2069 6e74   bit_depth:  int
+0000a6d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000a6e0: 2020 2020 2020 2020 2020 204d 6178 696d             Maxim
+0000a6f0: 756d 2070 6f77 6572 206f 6620 3220 746f  um power of 2 to
+0000a700: 2062 6520 7573 6564 2066 6f72 2073 6361   be used for sca
+0000a710: 6c69 6e67 2074 6865 2069 6d61 6765 0a20  ling the image. 
+0000a720: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0000a730: 6865 6e20 7461 6b69 6e67 206c 6f67 6172  hen taking logar
+0000a740: 6974 686d 732e 2044 6566 6175 6c74 2069  ithms. Default i
+0000a750: 7320 3332 0a0a 2020 2020 5265 7475 726e  s 32..    Return
+0000a760: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0000a770: 2020 736c 6d5f 696d 6167 653a 206e 6461    slm_image: nda
+0000a780: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+0000a790: 2020 2020 5468 6520 6669 6c74 6572 6564      The filtered
+0000a7a0: 2069 6d61 6765 2e0a 0a20 2020 206c 7363   image...    lsc
+0000a7b0: 5f69 6d61 6765 3a20 6e64 6172 7261 790a  _image: ndarray.
+0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0000a7d0: 6865 2066 696c 7465 7265 6420 696d 6167  he filtered imag
+0000a7e0: 6520 6372 6f73 732d 636f 7272 656c 6174  e cross-correlat
+0000a7f0: 6564 2077 6974 6820 7468 6520 6369 7263  ed with the circ
+0000a800: 6c65 2065 6467 650a 0a20 2020 204e 6f74  le edge..    Not
+0000a810: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+0000a820: 2057 6520 6669 7273 7420 6765 6e65 7261   We first genera
+0000a830: 7465 2074 6865 2063 6972 636c 6520 6365  te the circle ce
+0000a840: 6e74 6572 6564 2061 7420 7468 6520 5820  ntered at the X 
+0000a850: 616e 6420 5920 636f 2d6f 7264 696e 6174  and Y co-ordinat
+0000a860: 6573 2c20 7769 7468 0a20 2020 2074 6865  es, with.    the
+0000a870: 2072 6164 6975 7320 6769 7665 6e20 696e   radius given in
+0000a880: 7369 6465 2074 6865 2063 6972 635f 7661  side the circ_va
+0000a890: 6c73 2074 7570 6c65 2e20 5468 6973 2067  ls tuple. This g
+0000a8a0: 656e 6572 6174 6564 2063 6972 636c 6520  enerated circle 
+0000a8b0: 6973 0a20 2020 2074 6865 2053 6f62 656c  is.    the Sobel
+0000a8c0: 2066 696c 7465 7265 6420 746f 2067 656e   filtered to gen
+0000a8d0: 6572 6174 6520 616e 2065 6467 6520 6f66  erate an edge of
+0000a8e0: 2074 6865 2063 6972 636c 652e 0a0a 2020   the circle...  
+0000a8f0: 2020 4f66 7465 6e20 6475 6520 746f 2064    Often due to d
+0000a900: 6574 6563 746f 7220 6973 7375 6573 2c20  etector issues, 
+0000a910: 6f72 2073 7472 6179 206d 756f 6e73 2061  or stray muons a
+0000a920: 2073 696e 676c 6520 7069 7865 6c20 6d61   single pixel ma
+0000a930: 7920 6265 0a20 2020 206d 7563 6820 6272  y be.    much br
+0000a940: 6967 6874 6572 2e20 416c 736f 2064 6561  ighter. Also dea
+0000a950: 6420 7069 7865 6c73 2063 616e 2063 6175  d pixels can cau
+0000a960: 7365 2069 6e64 6976 6964 7561 6c20 7069  se individual pi
+0000a970: 7865 6c73 2074 6f20 6265 0a20 2020 206d  xels to be.    m
+0000a980: 7563 6820 6461 726b 6572 2e20 546f 2072  uch darker. To r
+0000a990: 656d 6f76 6520 7375 6368 2065 7272 6f72  emove such error
+0000a9a0: 732c 2061 6e64 2076 616c 7565 7320 696e  s, and values in
+0000a9b0: 2074 6865 2069 6d61 6765 2c20 7765 2074   the image, we t
+0000a9c0: 616b 650a 2020 2020 7468 6520 6d65 6469  ake.    the medi
+0000a9d0: 616e 2076 616c 7565 206f 6620 7468 6520  an value of the 
+0000a9e0: 696d 6167 6520 616e 6420 7468 656e 2074  image and then t
+0000a9f0: 6872 6f77 2061 6e79 2076 616c 7565 7320  hrow any values 
+0000aa00: 7468 6174 2061 7265 206d 6564 5f76 616c  that are med_val
+0000aa10: 0a20 2020 2074 696d 6573 206c 6172 6765  .    times large
+0000aa20: 7220 6f72 206d 6564 5f76 616c 2074 696d  r or med_val tim
+0000aa30: 6573 2073 6d61 6c6c 6572 2074 6861 6e20  es smaller than 
+0000aa40: 7468 6520 6d65 6469 616e 2e20 5468 656e  the median. Then
+0000aa50: 2077 6520 6e6f 726d 616c 697a 650a 2020   we normalize.  
+0000aa60: 2020 7468 6520 696d 6167 6520 6672 6f6d    the image from
+0000aa70: 2031 2074 6f20 7468 6520 325e 6269 745f   1 to the 2^bit_
+0000aa80: 6465 7074 6820 616e 6420 7468 656e 2074  depth and then t
+0000aa90: 616b 6520 7468 6520 6c6f 6720 6f66 2074  ake the log of t
+0000aaa0: 6861 7420 696d 6167 652e 0a20 2020 2054  hat image..    T
+0000aab0: 6869 7320 6765 6e65 7261 7465 7320 616e  his generates an
+0000aac0: 2069 6d61 6765 2077 686f 7365 2073 6361   image whose sca
+0000aad0: 6c65 2069 7320 6265 7477 6565 6e20 3020  le is between 0 
+0000aae0: 616e 6420 7468 6520 6269 745f 6465 7074  and the bit_dept
+0000aaf0: 682e 2054 6f0a 2020 2020 6675 7274 6865  h. To.    furthe
+0000ab00: 7220 6465 6372 6561 7365 2064 6574 6563  r decrease detec
+0000ab10: 746f 7220 6e6f 6973 652c 2074 6869 7320  tor noise, this 
+0000ab20: 7363 616c 6564 2069 6d61 6765 2069 7320  scaled image is 
+0000ab30: 7468 656e 2047 6175 7373 6961 6e20 6669  then Gaussian fi
+0000ab40: 6c74 6572 6564 0a20 2020 2077 6974 6820  ltered.    with 
+0000ab50: 6120 7369 6e67 6c65 2070 6978 656c 2062  a single pixel b
+0000ab60: 6c75 722c 2061 6e64 2074 6865 6e20 6669  lur, and then fi
+0000ab70: 6e61 6c6c 7920 536f 6265 6c20 6669 6c74  nally Sobel filt
+0000ab80: 6572 6564 2e20 5468 6973 2053 6f62 656c  ered. This Sobel
+0000ab90: 0a20 2020 2066 696c 7465 7265 6420 696d  .    filtered im
+0000aba0: 6167 6520 6973 2074 6865 6e20 6372 6f73  age is then cros
+0000abb0: 732d 636f 7272 656c 6174 6564 2077 6974  s-correlated wit
+0000abc0: 6820 7468 6520 536f 6265 6c20 6669 6c74  h the Sobel filt
+0000abd0: 6572 6564 2063 6972 636c 6520 6564 6765  ered circle edge
+0000abe0: 2e0a 0a20 2020 2049 6620 7468 6572 6520  ...    If there 
+0000abf0: 6172 6520 6469 736b 7320 696e 2074 6865  are disks in the
+0000ac00: 2069 6d61 6765 2077 686f 7365 2073 697a   image whose siz
+0000ac10: 6520 6973 2063 6c6f 7365 2074 6f20 7468  e is close to th
+0000ac20: 6520 7261 6469 7573 206f 6620 7468 650a  e radius of the.
+0000ac30: 2020 2020 6369 7263 6c65 2c20 7468 656e      circle, then
+0000ac40: 2074 6865 206c 6f63 6174 696f 6e73 206f   the locations o
+0000ac50: 6620 7468 656d 206e 6f77 2062 6563 6f6d  f them now becom
+0000ac60: 6520 3244 2070 6561 6b73 2e20 4966 2074  e 2D peaks. If t
+0000ac70: 6865 0a20 2020 2063 6972 636c 6520 7261  he.    circle ra
+0000ac80: 6469 7573 2069 7320 686f 7765 7665 7220  dius is however 
+0000ac90: 746f 6f20 736d 616c 6c2f 6c61 7267 6520  too small/large 
+0000aca0: 7261 7468 6572 2074 6861 6e20 3244 2070  rather than 2D p
+0000acb0: 6561 6b73 2061 740a 2020 2020 6469 6666  eaks at.    diff
+0000acc0: 7261 6374 696f 6e20 6469 736b 206c 6f63  raction disk loc
+0000acd0: 6174 696f 6e73 2c20 7765 2077 696c 6c20  ations, we will 
+0000ace0: 6f62 7365 7276 6520 6369 7263 6c65 732e  observe circles.
+0000acf0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+0000ad00: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0000ad10: 5468 6973 2069 7320 6578 7472 656d 656c  This is extremel
+0000ad20: 7920 7573 6566 756c 2066 6f72 206c 6f63  y useful for loc
+0000ad30: 6174 696e 6720 4e42 4544 2064 6966 6672  ating NBED diffr
+0000ad40: 6163 7469 6f6e 2070 6f73 6974 696f 6e73  action positions
+0000ad50: 2e20 4966 2079 6f75 206b 6e6f 770a 2020  . If you know.  
+0000ad60: 2020 7468 6520 7369 7a65 2061 6e64 206f    the size and o
+0000ad70: 6620 7468 6520 6365 6e74 7261 6c20 6469  f the central di
+0000ad80: 736b 2079 6f75 2075 7365 2074 6865 206f  sk you use the o
+0000ad90: 6e20 7468 6520 4d65 616e 5f43 4245 4420  n the Mean_CBED 
+0000ada0: 746f 2063 616c 6375 6c61 7465 2074 6865  to calculate the
+0000adb0: 0a20 2020 2064 6973 6b20 706f 7369 7469  .    disk positi
+0000adc0: 6f6e 7320 6672 6f6d 3a0a 0a20 2020 203e  ons from:..    >
+0000add0: 3e3e 2073 6c6d 5f72 6566 6572 656e 6365  >> slm_reference
+0000ade0: 2c20 6c73 635f 7265 6665 7265 6e63 6520  , lsc_reference 
+0000adf0: 3d20 7374 2e6e 6265 642e 6362 6564 5f66  = st.nbed.cbed_f
+0000ae00: 696c 7465 7228 4d65 616e 5f43 4245 442c  ilter(Mean_CBED,
+0000ae10: 2062 6561 6d5f 7229 0a0a 2020 2020 7227   beam_r)..    r'
+0000ae20: 0000 0072 2500 0000 7201 0000 0029 0d72  ...r%...r....).r
+0000ae30: 1d00 0000 721e 0000 00da 0b6d 616b 655f  ....r......make_
+0000ae40: 6369 7263 6c65 7209 0000 0072 1800 0000  circler....r....
+0000ae50: 7219 0000 0072 b400 0000 7260 0000 0072  r....r....r`...r
+0000ae60: 8500 0000 7207 0000 0072 b900 0000 72b6  ....r....r....r.
+0000ae70: 0000 0072 b700 0000 290c 7288 0000 005a  ...r....).r....Z
+0000ae80: 0862 6561 6d5f 7261 6472 8900 0000 5a07  .beam_radr....Z.
+0000ae90: 7365 635f 6d65 6472 b000 0000 72dc 0000  sec_medr....r...
+0000aea0: 0072 bb00 0000 72c4 0000 0072 ab00 0000  .r....r....r....
+0000aeb0: 5a09 6d65 645f 696d 6167 655a 0973 6c6d  Z.med_imageZ.slm
+0000aec0: 5f69 6d61 6765 5a09 6c73 635f 696d 6167  _imageZ.lsc_imag
+0000aed0: 6572 0f00 0000 720f 0000 0072 1000 0000  er....r....r....
+0000aee0: da0b 6362 6564 5f66 696c 7465 72af 0500  ..cbed_filter...
+0000aef0: 0073 2a00 0000 0644 2401 04ff 1003 0a03  .s*....D$.......
+0000af00: 0601 0201 18ff 0c04 14ff 0605 1401 08ff  ................
+0000af10: 0403 0601 0201 18ff 0c04 14ff 1005 0801  ................
+0000af20: 720f 0100 00e7 2d43 1ceb e236 1a3f 6303  r.....-C...6.?c.
+0000af30: 0000 0000 0000 0000 0000 0011 0000 0009  ................
+0000af40: 0000 0003 0000 0073 7401 0000 7400 a001  .......st...t...
+0000af50: 7c00 6a02 a101 8900 7403 6a04 a005 7c00  |.j.....t.j...|.
+0000af60: a101 5c02 8901 7d03 7406 6401 7c02 1b00  ..\...}.t.d.|...
+0000af70: 6402 1b00 8301 7d04 7400 a007 7c04 6403  d.....}.t...|.d.
+0000af80: 6602 a101 7d05 6401 7400 a008 7c04 a101  f...}.d.t...|...
+0000af90: 1700 7c01 7400 a009 8800 a101 1400 7c04  ..|.t.........|.
+0000afa0: 1b00 1400 7c05 6404 6404 8502 6405 6602  ....|.d.d...d.f.
+0000afb0: 3c00 740a 7c04 8301 4400 5d41 7d06 7403  <.t.|...D.]A}.t.
+0000afc0: 6a04 a00b 7400 a001 8800 a101 8800 6401  j...t.........d.
+0000afd0: 1900 6403 1b00 8800 6405 1900 6403 1b00  ..d.....d...d...
+0000afe0: 7c05 7c06 6405 6602 1900 a104 7d07 7403  |.|.d.f.....}.t.
+0000aff0: 6a04 a005 7c07 a101 5c02 7d08 7d03 7403  j...|...\.}.}.t.
+0000b000: 6a04 a00c 8801 7c08 a102 7d09 7c09 7406  j.....|...}.|.t.
+0000b010: 7c09 6a02 6405 1900 6403 1b00 8301 7406  |.j.d...d.....t.
+0000b020: 7c09 6a02 6401 1900 6403 1b00 8301 6602  |.j.d...d.....f.
+0000b030: 1900 7c05 7c06 6401 6602 3c00 7137 7c05  ..|.|.d.f.<.q7|.
+0000b040: 7c05 6404 6404 8502 6401 6602 1900 7400  |.d.d...d.f...t.
+0000b050: a00d 7c05 6404 6404 8502 6401 6602 1900  ..|.d.d...d.f...
+0000b060: a101 6b02 6405 6602 1900 6405 1900 7d0a  ..k.d.f...d...}.
+0000b070: 7c01 7400 a009 8800 a101 1400 6406 1b00  |.t.........d...
+0000b080: 7d0b 7c0a 7c0b 1800 7d0c 7c0a 7c0b 1700  }.|.|...}.|.|...
+0000b090: 7d0d 8700 8701 6602 6407 6408 8408 7d0e  }.....f.d.d...}.
+0000b0a0: 740e 6a0f 7c0e 7c0c 7c0d 6602 7c02 6409  t.j.|.|.|.f.|.d.
+0000b0b0: 640a 8d04 7d0f 7c0f 6a10 7d10 7c10 5300  d...}.|.j.}.|.S.
+0000b0c0: 290b 612f 0500 000a 2020 2020 4669 6e64  ).a/....    Find
+0000b0d0: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
+0000b0e0: 2063 656e 7472 616c 2064 6973 6b20 6672   central disk fr
+0000b0f0: 6f6d 2064 6966 6672 6163 7469 6f6e 0a20  om diffraction. 
+0000b100: 2020 2070 6174 7465 726e 732e 0a0a 2020     patterns...  
+0000b110: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000b120: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000b130: 6362 6564 5f69 6d61 6765 3a20 6e64 6172  cbed_image: ndar
+0000b140: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+0000b150: 2020 2020 5468 6520 4342 4544 2069 6d61      The CBED ima
+0000b160: 6765 2074 6f20 6265 2075 7365 6420 666f  ge to be used fo
+0000b170: 7220 6361 6c63 756c 6174 696e 670a 2020  r calculating.  
+0000b180: 2020 2020 2020 2020 2020 2020 2020 7468                th
+0000b190: 6520 6365 6e74 7261 6c20 636f 6e76 6572  e central conver
+0000b1a0: 6765 6e63 6520 616e 676c 6520 7369 7a65  gence angle size
+0000b1b0: 2066 726f 6d0a 2020 2020 7562 6f75 6e64   from.    ubound
+0000b1c0: 3a20 2020 2020 666c 6f61 742c 206f 7074  :     float, opt
+0000b1d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000b1e0: 2020 2020 2020 5468 6520 7261 7469 6f20        The ratio 
+0000b1f0: 6f66 2074 6865 2073 697a 6520 6f66 2074  of the size of t
+0000b200: 6865 2069 6d61 6765 2074 6f20 6265 2075  he image to be u
+0000b210: 7365 640a 2020 2020 2020 2020 2020 2020  sed.            
+0000b220: 2020 2020 6173 2074 6865 2075 7070 6572      as the upper
+0000b230: 2062 6f75 6e64 2066 6f72 2074 6865 2072   bound for the r
+0000b240: 6164 6975 7320 7369 7a65 2e20 4465 6661  adius size. Defa
+0000b250: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
+0000b260: 2020 2020 6973 2030 2e32 2e20 5468 6520      is 0.2. The 
+0000b270: 6c6f 7765 7220 626f 756e 6420 6973 2061  lower bound is a
+0000b280: 6c77 6179 7320 3120 7069 7865 6c73 0a20  lways 1 pixels. 
+0000b290: 2020 2074 6f6c 3a20 2020 2020 2020 2066     tol:        f
+0000b2a0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+0000b2b0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0000b2c0: 6865 2074 6f6c 6572 616e 6365 206f 6620  he tolerance of 
+0000b2d0: 7468 6520 7363 6970 792e 6f70 7469 6d69  the scipy.optimi
+0000b2e0: 7a65 2066 6974 7469 6e67 2066 756e 6374  ze fitting funct
+0000b2f0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+0000b300: 2020 2020 4465 6661 756c 7420 6973 2030      Default is 0
+0000b310: 2e30 310a 0a20 2020 2052 6574 7572 6e73  .01..    Returns
+0000b320: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+0000b330: 2072 6164 3a20 666c 6f61 740a 2020 2020   rad: float.    
+0000b340: 2020 2020 2054 6865 2072 6164 6975 7320       The radius 
+0000b350: 696e 2070 6978 656c 7320 6f66 2074 6865  in pixels of the
+0000b360: 2063 6f6e 7665 7267 656e 6365 2061 7065   convergence ape
+0000b370: 7274 7572 650a 0a20 2020 204e 6f74 6573  rture..    Notes
+0000b380: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2054  .    -----.    T
+0000b390: 6869 7320 6973 2062 6173 6564 206f 6e20  his is based on 
+0000b3a0: 7468 6520 6964 6561 2074 6861 7420 6966  the idea that if
+0000b3b0: 2061 2053 6f62 656c 2066 696c 7465 7265   a Sobel filtere
+0000b3c0: 6420 4342 4544 2070 6174 7465 726e 0a20  d CBED pattern. 
+0000b3d0: 2020 2069 7320 6372 6f73 732d 636f 7272     is cross-corr
+0000b3e0: 656c 6174 6564 2077 6974 6820 6120 6369  elated with a ci
+0000b3f0: 7263 6c65 2065 6467 652c 2061 2073 6861  rcle edge, a sha
+0000b400: 7270 2070 6561 6b20 6973 206f 6274 6169  rp peak is obtai
+0000b410: 6e65 640a 2020 2020 6f6e 6c79 2069 6620  ned.    only if 
+0000b420: 7468 6520 7261 6469 7573 206f 6620 7468  the radius of th
+0000b430: 6174 2063 6972 636c 6520 6973 2074 6865  at circle is the
+0000b440: 2073 616d 6520 6173 2074 6865 2072 6164   same as the rad
+0000b450: 6975 7320 696e 0a20 2020 2070 6978 656c  ius in.    pixel
+0000b460: 7320 6f66 2074 6865 2043 4245 4420 7061  s of the CBED pa
+0000b470: 7474 6572 6e2e 2049 6620 7468 6520 6369  ttern. If the ci
+0000b480: 7263 6c65 2069 7320 6120 6c6f 7420 736d  rcle is a lot sm
+0000b490: 616c 6c65 7220 6f72 206c 6172 6765 722c  aller or larger,
+0000b4a0: 0a20 2020 2074 6865 6e20 6120 646f 6e75  .    then a donu
+0000b4b0: 7420 6c69 6b65 2072 696e 6720 6973 2066  t like ring is f
+0000b4c0: 6f72 6d65 6420 6174 2074 6865 2063 656e  ormed at the cen
+0000b4d0: 7465 7220 6f66 2074 6865 2063 726f 7373  ter of the cross
+0000b4e0: 2d63 6f72 7265 6c61 7465 640a 2020 2020  -correlated.    
+0000b4f0: 7061 7474 6572 6e2e 2049 6620 7468 6520  pattern. If the 
+0000b500: 7261 6469 7573 2069 7320 6120 6269 7420  radius is a bit 
+0000b510: 6f66 6620 2d20 7468 656e 2074 6865 2070  off - then the p
+0000b520: 6561 6b20 6973 2061 2062 6974 2064 6966  eak is a bit dif
+0000b530: 6675 7365 2e0a 2020 2020 5468 7573 2074  fuse..    Thus t
+0000b540: 6865 2063 6f72 7265 6374 2072 6164 6975  he correct radiu
+0000b550: 7320 696e 2070 6978 656c 7320 7769 6c6c  s in pixels will
+0000b560: 2067 6976 6520 7468 6520 7368 6172 7065   give the sharpe
+0000b570: 7374 2070 6561 6b2c 2077 6869 6368 0a20  st peak, which. 
+0000b580: 2020 2069 7320 686f 7720 7765 2066 696e     is how we fin
+0000b590: 6420 7468 6520 7261 6469 7573 2062 7920  d the radius by 
+0000b5a0: 7573 696e 6720 6073 6369 7079 2e6f 7074  using `scipy.opt
+0000b5b0: 696d 697a 652e 6d69 6e69 6d69 7a65 5f73  imize.minimize_s
+0000b5c0: 6361 6c61 7260 0a0a 2020 2020 5365 6520  calar`..    See 
+0000b5d0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
+0000b5e0: 2d0a 2020 2020 6362 6564 5f66 696c 7465  -.    cbed_filte
+0000b5f0: 720a 2020 2020 7227 0000 00e9 1400 0000  r.    r'........
+0000b600: 7225 0000 004e 7201 0000 0072 ad00 0000  r%...Nr....r....
+0000b610: 6301 0000 0000 0000 0000 0000 0006 0000  c...............
+0000b620: 0006 0000 0013 0000 0073 7400 0000 7400  .........st...t.
+0000b630: 6a01 a002 7403 a004 8800 a101 8800 6401  j...t.........d.
+0000b640: 1900 6402 1b00 8800 6403 1900 6402 1b00  ..d.....d...d...
+0000b650: 7c00 a104 7d01 7400 6a01 a005 7c01 a101  |...}.t.j...|...
+0000b660: 5c02 7d02 7d03 7400 6a01 a006 8801 7c02  \.}.}.t.j.....|.
+0000b670: a102 7d04 7c04 7407 7c04 6a08 6403 1900  ..}.|.t.|.j.d...
+0000b680: 6402 1b00 8301 7407 7c04 6a08 6401 1900  d.....t.|.j.d...
+0000b690: 6402 1b00 8301 6602 1900 7d05 7c05 0b00  d.....f...}.|...
+0000b6a0: 5300 2904 4e72 2700 0000 7225 0000 0072  S.).Nr'...r%...r
+0000b6b0: 0100 0000 2909 721d 0000 0072 1e00 0000  ....).r....r....
+0000b6c0: 720e 0100 0072 0900 0000 7218 0000 0072  r....r....r....r
+0000b6d0: b400 0000 72b7 0000 0072 2f00 0000 7219  ....r....r/...r.
+0000b6e0: 0000 0029 0672 7c00 0000 da02 6364 5a08  ...).r|.....cdZ.
+0000b6f0: 736f 6265 6c5f 6364 72ab 0000 005a 0974  sobel_cdr....Z.t
+0000b700: 6573 745f 636f 7272 5a07 7261 645f 7661  est_corrZ.rad_va
+0000b710: 6ca9 025a 0769 6d73 6861 7065 5a0a 736f  l..Z.imshapeZ.so
+0000b720: 6265 6c5f 6362 6564 720f 0000 0072 1000  bel_cbedr....r..
+0000b730: 0000 da08 7261 645f 6675 6e63 4c06 0000  ....rad_funcL...
+0000b740: 730e 0000 0006 011e 0104 ff10 030e 0128  s..............(
+0000b750: 0106 017a 1c67 6574 5f72 6164 6975 732e  ...z.get_radius.
+0000b760: 3c6c 6f63 616c 733e 2e72 6164 5f66 756e  <locals>.rad_fun
+0000b770: 635a 0762 6f75 6e64 6564 2903 da06 626f  cZ.bounded)...bo
+0000b780: 756e 6473 da03 746f 6cda 066d 6574 686f  unds..tol..metho
+0000b790: 6429 1172 0900 0000 7218 0000 0072 1900  d).r....r....r..
+0000b7a0: 0000 721d 0000 0072 1e00 0000 72b4 0000  ..r....r....r...
+0000b7b0: 0072 2f00 0000 7241 0000 0072 9200 0000  .r/...rA...r....
+0000b7c0: 728e 0000 0072 1b00 0000 720e 0100 0072  r....r....r....r
+0000b7d0: b700 0000 72f8 0000 0072 1300 0000 5a0f  ....r....r....Z.
+0000b7e0: 6d69 6e69 6d69 7a65 5f73 6361 6c61 7272  minimize_scalarr
+0000b7f0: 1400 0000 2911 5a0a 6362 6564 5f69 6d61  ....).Z.cbed_ima
+0000b800: 6765 5a06 7562 6f75 6e64 7216 0100 0072  geZ.uboundr....r
+0000b810: ab00 0000 5a0d 7465 7374 5f70 7265 6369  ....Z.test_preci
+0000b820: 736f 6e5a 0974 6573 745f 7661 6c73 7222  sonZ.test_valsr"
+0000b830: 0000 0072 bb00 0000 72c4 0000 005a 0274  ...r....r....Z.t
+0000b840: 635a 0966 6972 7374 5f6d 6178 5a09 7661  cZ.first_maxZ.va
+0000b850: 7269 6174 696f 6e5a 026c 625a 0275 6272  riationZ.lbZ.ubr
+0000b860: 1401 0000 7231 0000 005a 0372 6164 720f  ....r1...Z.radr.
+0000b870: 0000 0072 1301 0000 7210 0000 00da 0a67  ...r....r......g
+0000b880: 6574 5f72 6164 6975 7312 0600 0073 2c00  et_radius....s,.
+0000b890: 0000 0c26 1001 1001 0e01 0c01 1001 10ff  ...&............
+0000b8a0: 0c03 0601 2601 04ff 1003 0e01 3201 3202  ....&.......2.2.
+0000b8b0: 1201 0801 0801 0e02 1609 0601 0401 7218  ..............r.
+0000b8c0: 0100 0063 0200 0000 0000 0000 0000 0000  ...c............
+0000b8d0: 1d00 0000 0b00 0000 4300 0000 731a 0600  ........C...s...
+0000b8e0: 0074 006a 017c 0164 0164 028d 027d 0174  .t.j.|.d.d...}.t
+0000b8f0: 00a0 027c 01a1 017d 0274 00a0 0364 03a1  ...|...}.t...d..
+0000b900: 017d 017c 027c 0164 0464 0385 023c 0074  .}.|.|.d.d...<.t
+0000b910: 00a0 047c 006a 05a1 017d 0374 00a0 067c  ...|.j...}.t...|
+0000b920: 037c 011b 00a1 01a0 0774 08a1 017d 047c  .|.......t...}.|
+0000b930: 0364 0419 007c 0464 0419 001b 007d 057c  .d...|.d.....}.|
+0000b940: 0364 0519 007c 0464 0519 001b 007d 0674  .d...|.d.....}.t
+0000b950: 00a0 097c 0464 0419 0064 0466 02a1 017d  ...|.d...d.f...}
+0000b960: 0774 00a0 097c 0464 0519 0064 0466 02a1  .t...|.d...d.f..
+0000b970: 017d 0874 006a 0a64 067c 0364 0419 007c  .}.t.j.d.|.d...|
+0000b980: 0464 0419 0064 0117 0064 078d 0364 067c  .d...d...d...d.|
+0000b990: 0464 0419 0085 0219 007c 0764 0064 0085  .d.......|.d.d..
+0000b9a0: 0264 0666 023c 0074 006a 0a64 067c 0364  .d.f.<.t.j.d.|.d
+0000b9b0: 0419 007c 0464 0419 0064 0117 0064 078d  ...|.d...d...d..
+0000b9c0: 0364 017c 0464 0419 0064 0117 0085 0219  .d.|.d...d......
+0000b9d0: 007c 0764 0064 0085 0264 0166 023c 0074  .|.d.d...d.f.<.t
+0000b9e0: 006a 0a64 067c 0364 0519 007c 0464 0519  .j.d.|.d...|.d..
+0000b9f0: 0064 0117 0064 078d 0364 067c 0464 0519  .d...d...d.|.d..
+0000ba00: 0085 0219 007c 0864 0064 0085 0264 0666  .....|.d.d...d.f
+0000ba10: 023c 0074 006a 0a64 067c 0364 0519 007c  .<.t.j.d.|.d...|
+0000ba20: 0464 0519 0064 0117 0064 078d 0364 017c  .d...d...d...d.|
+0000ba30: 0464 0519 0064 0117 0085 0219 007c 0864  .d...d.......|.d
+0000ba40: 0064 0085 0264 0166 023c 0074 006a 097c  .d...d.f.<.t.j.|
+0000ba50: 0464 0664 0385 0219 007c 006a 0b64 088d  .d.d.....|.j.d..
+0000ba60: 027d 0974 0874 00a0 0c7c 0764 0919 00a1  .}.t.t...|.d....
+0000ba70: 0183 017d 0a74 00a0 0d7c 0764 0919 0064  ...}.t...|.d...d
+0000ba80: 01a1 027d 0b74 0874 00a0 0c7c 0864 0919  ...}.t.t...|.d..
+0000ba90: 00a1 0183 017d 0c74 00a0 0d7c 0864 0919  .....}.t...|.d..
+0000baa0: 0064 01a1 027d 0d74 006a 0e7c 0064 0064  .d...}.t.j.|.d.d
+0000bab0: 0085 0264 0064 0085 0264 067c 0a85 0264  ...d.d...d.|...d
+0000bac0: 067c 0c85 0266 0419 0064 0a64 0b8d 027c  .|...f...d.d...|
+0000bad0: 0964 0064 0085 0264 0064 0085 0264 0664  .d.d...d.d...d.d
+0000bae0: 0666 043c 007c 0964 0064 0085 0264 0064  .f.<.|.d.d...d.d
+0000baf0: 0085 0264 0664 0666 0419 007c 0b7c 0064  ...d.d.f...|.|.d
+0000bb00: 0064 0085 0264 0064 0085 0274 087c 0a64  .d...d.d...t.|.d
+0000bb10: 0117 0083 017c 0c66 0419 0014 0017 007c  .....|.f.......|
+0000bb20: 0d7c 0064 0064 0085 0264 0064 0085 027c  .|.d.d...d.d...|
+0000bb30: 0a74 087c 0c64 0117 0083 0166 0419 0014  .t.|.d.....f....
+0000bb40: 0017 007c 0b7c 0d14 007c 0064 0064 0085  ...|.|...|.d.d..
+0000bb50: 0264 0064 0085 0274 087c 0a64 0117 0083  .d.d...t.|.d....
+0000bb60: 0174 087c 0c64 0117 0083 0166 0419 0014  .t.|.d.....f....
+0000bb70: 0017 007c 0964 0064 0085 0264 0064 0085  ...|.d.d...d.d..
+0000bb80: 0264 0664 0666 043c 0074 0874 00a0 067c  .d.d.f.<.t.t...|
+0000bb90: 0764 0c19 00a1 0183 017d 0e64 0174 00a0  .d.......}.d.t..
+0000bba0: 0d7c 0764 0c19 0064 01a1 0218 007d 0f74  .|.d...d.....}.t
+0000bbb0: 0874 00a0 067c 0764 0c19 00a1 0183 017d  .t...|.d.......}
+0000bbc0: 1064 0174 00a0 0d7c 0864 0c19 0064 01a1  .d.t...|.d...d..
+0000bbd0: 0218 007d 1174 006a 0e7c 0064 0064 0085  ...}.t.j.|.d.d..
+0000bbe0: 0264 0064 0085 027c 0e74 087c 0764 0d19  .d.d...|.t.|.d..
+0000bbf0: 0083 0185 027c 1074 087c 0864 0d19 0083  .....|.t.|.d....
+0000bc00: 0185 0266 0419 0064 0a64 0b8d 027c 0964  ...f...d.d...|.d
+0000bc10: 0064 0085 0264 0064 0085 0264 0e64 0e66  .d...d.d...d.d.f
+0000bc20: 043c 007c 0964 0064 0085 0264 0064 0085  .<.|.d.d...d.d..
+0000bc30: 0264 0e64 0e66 0419 007c 0f7c 0064 0064  .d.d.f...|.|.d.d
+0000bc40: 0085 0264 0064 0085 0274 087c 0e64 0118  ...d.d...t.|.d..
+0000bc50: 0083 017c 1066 0419 0014 0017 007c 117c  ...|.f.......|.|
+0000bc60: 0064 0064 0085 0264 0064 0085 027c 0e74  .d.d...d.d...|.t
+0000bc70: 087c 1064 0118 0083 0166 0419 0014 0017  .|.d.....f......
+0000bc80: 007c 0f7c 1114 007c 0064 0064 0085 0264  .|.|...|.d.d...d
+0000bc90: 0064 0085 0274 087c 0e64 0118 0083 0174  .d...t.|.d.....t
+0000bca0: 087c 1064 0118 0083 0166 0419 0014 0017  .|.d.....f......
+0000bcb0: 007c 0964 0064 0085 0264 0064 0085 0264  .|.d.d...d.d...d
+0000bcc0: 0e64 0e66 043c 0074 00a0 0f64 017c 0464  .d.f.<.t...d.|.d
+0000bcd0: 0419 0064 0118 00a1 0244 0090 015d 067d  ...d.....D...].}
+0000bce0: 1274 00a0 0f64 017c 0464 0519 0064 0118  .t...d.|.d...d..
+0000bcf0: 00a1 0244 005d f87d 1374 0874 00a0 067c  ...D.].}.t.t...|
+0000bd00: 077c 1264 0666 0219 00a1 0183 017d 1474  .|.d.f.......}.t
+0000bd10: 0874 00a0 0c7c 077c 1264 0166 0219 00a1  .t...|.|.d.f....
+0000bd20: 0183 017d 1564 0174 00a0 0d7c 077c 1264  ...}.d.t...|.|.d
+0000bd30: 0666 0219 0064 01a1 0218 007d 1674 00a0  .f...d.....}.t..
+0000bd40: 0d7c 077c 1264 0166 0219 0064 01a1 027d  .|.|.d.f...d...}
+0000bd50: 1774 0874 00a0 067c 087c 1364 0666 0219  .t.t...|.|.d.f..
+0000bd60: 00a1 0183 017d 1874 0874 00a0 0c7c 087c  .....}.t.t...|.|
+0000bd70: 1364 0166 0219 00a1 0183 017d 1964 0174  .d.f.......}.d.t
+0000bd80: 00a0 0d7c 087c 1364 0666 0219 0064 01a1  ...|.|.d.f...d..
+0000bd90: 0218 007d 1a74 00a0 0d7c 087c 1364 0166  ...}.t...|.|.d.f
+0000bda0: 0219 0064 01a1 027d 1b74 006a 0e7c 0064  ...d...}.t.j.|.d
+0000bdb0: 0064 0085 0264 0064 0085 027c 147c 1585  .d...d.d...|.|..
+0000bdc0: 027c 187c 1985 0266 0419 0064 0a64 0b8d  .|.|...f...d.d..
+0000bdd0: 027d 1c7c 1c7c 167c 0064 0064 0085 0264  .}.|.|.|.d.d...d
+0000bde0: 0064 0085 0274 087c 1464 0118 0083 017c  .d...t.|.d.....|
+0000bdf0: 1866 0419 0014 0017 007c 1a7c 0064 0064  .f.......|.|.d.d
+0000be00: 0085 0264 0064 0085 027c 1474 087c 1864  ...d.d...|.t.|.d
+0000be10: 0118 0083 0166 0419 0014 0017 007c 167c  .....f.......|.|
+0000be20: 1a14 007c 0064 0064 0085 0264 0064 0085  ...|.d.d...d.d..
+0000be30: 0274 087c 1464 0118 0083 0174 087c 1864  .t.|.d.....t.|.d
+0000be40: 0118 0083 0166 0419 0014 0017 007d 1c7c  .....f.......}.|
+0000be50: 1c7c 177c 0064 0064 0085 0264 0064 0085  .|.|.d.d...d.d..
+0000be60: 0274 087c 1564 0117 0083 017c 1966 0419  .t.|.d.....|.f..
+0000be70: 0014 0017 007c 1b7c 0064 0064 0085 0264  .....|.|.d.d...d
+0000be80: 0064 0085 027c 1574 087c 1964 0117 0083  .d...|.t.|.d....
+0000be90: 0166 0419 0014 0017 007c 177c 1b14 007c  .f.......|.|...|
+0000bea0: 0064 0064 0085 0264 0064 0085 0274 087c  .d.d...d.d...t.|
+0000beb0: 1564 0117 0083 0174 087c 1964 0117 0083  .d.....t.|.d....
+0000bec0: 0166 0419 0014 0017 007d 1c7c 1c7c 0964  .f.......}.|.|.d
+0000bed0: 0064 0085 0264 0064 0085 027c 127c 1366  .d...d.d...|.|.f
+0000bee0: 043c 0090 0271 0a90 0171 fd7c 097c 067c  .<...q...q.|.|.|
+0000bef0: 0514 001b 007d 097c 0953 0029 0f4e 7227  .....}.|.S.).Nr'
+0000bf00: 0000 0072 0001 0000 7268 0000 0072 2500  ...r....rh...r%.
+0000bf10: 0000 7226 0000 0072 0100 0000 2903 da05  ..r&...r....)...
+0000bf20: 7374 6172 74da 0473 746f 70da 036e 756d  start..stop..num
+0000bf30: 725f 0000 0072 9800 0000 72e4 0000 0072  r_...r....r....r
+0000bf40: 4400 0000 2902 7206 0000 0072 0100 0000  D...).r....r....
+0000bf50: 2902 7206 0000 0072 2700 0000 7206 0000  ).r....r'...r...
+0000bf60: 0029 1072 0900 0000 7281 0000 0072 6000  .).r....r....r`.
+0000bf70: 0000 7294 0000 0072 1800 0000 7219 0000  ..r....r....r...
+0000bf80: 0072 0101 0000 723a 0000 0072 2f00 0000  .r....r:...r/...
+0000bf90: 7241 0000 00da 086c 696e 7370 6163 6572  rA.....linspacer
+0000bfa0: 4d00 0000 da05 666c 6f6f 72da 036d 6f64  M.....floor..mod
+0000bfb0: 720a 0000 0072 9200 0000 291d 7206 0100  r....r....).r...
+0000bfc0: 0072 6100 0000 7202 0100 0072 0301 0000  .ra...r....r....
+0000bfd0: 7204 0100 005a 0564 6269 6e79 5a05 6462  r....Z.dbinyZ.db
+0000bfe0: 696e 785a 0562 696e 5f79 5a05 6269 6e5f  inxZ.bin_yZ.bin_
+0000bff0: 7872 0501 0000 5a0a 7374 6f70 7065 725f  xr....Z.stopper_
+0000c000: 3069 5a09 746f 7070 6572 5f30 695a 0a73  0iZ.topper_0iZ.s
+0000c010: 746f 7070 6572 5f30 6a5a 0974 6f70 7065  topper_0jZ.toppe
+0000c020: 725f 306a 5a0a 7374 6172 7465 725f 3169  r_0jZ.starter_1i
+0000c030: 5a08 6c6f 7765 725f 3169 5a0a 7374 6172  Z.lower_1iZ.star
+0000c040: 7465 725f 316a 5a08 6c6f 7765 725f 316a  ter_1jZ.lower_1j
+0000c050: 7222 0000 0072 de00 0000 7207 0100 0072  r"...r....r....r
+0000c060: 0801 0000 5a08 6c6f 7765 725f 6969 5a09  ....Z.lower_iiZ.
+0000c070: 746f 7070 6572 5f69 6972 0901 0000 720a  topper_iir....r.
+0000c080: 0100 005a 086c 6f77 6572 5f6a 6a5a 0974  ...Z.lower_jjZ.t
+0000c090: 6f70 7065 725f 6a6a 720b 0100 0072 0f00  opper_jjr....r..
+0000c0a0: 0000 720f 0000 0072 1000 0000 da0d 6269  ..r....r......bi
+0000c0b0: 6e5f 7363 616e 5f74 6573 745a 0600 0073  n_scan_testZ...s
+0000c0c0: c600 0000 0e01 0a01 0a01 0c01 0c01 1401  ................
+0000c0d0: 1002 1001 1202 1201 1a02 0a01 10ff 1a03  ................
+0000c0e0: 0e01 10ff 1a03 0a01 10ff 1a03 0e01 10ff  ................
+0000c0f0: 1804 1202 1001 1201 1001 0401 2001 1aff  ............ ...
+0000c100: 1604 2201 02ff 2202 02fe 0204 0201 02ff  .."...".........
+0000c110: 2602 02fe 02fc 16ff 120b 1401 1201 1401  &...............
+0000c120: 0401 2e01 0201 1afe 1605 2201 02ff 2202  .........."...".
+0000c130: 02fe 2e03 02fd 16ff 1a07 1801 1601 1601  ................
+0000c140: 1801 1401 1602 1601 1801 1401 0402 2001  .............. .
+0000c150: 06ff 0206 2201 02ff 2202 02fe 0204 0201  ...."...".......
+0000c160: 02ff 2602 02fe 02fc 02ff 020d 2201 02ff  ..&........."...
+0000c170: 2202 02fe 0204 0201 02ff 2602 02fe 02fc  ".........&.....
+0000c180: 02ff 1c0b 04d9 0c29 0401 721f 0100 00da  .......)..r.....
+0000c190: 026e 6da9 02e9 1600 0000 e915 0000 0063  .nm............c
+0000c1a0: 0900 0000 0000 0000 0000 0000 1800 0000  ................
+0000c1b0: 0d00 0000 4300 0000 7308 0400 0064 0164  ....C...s....d.d
+0000c1c0: 0284 007d 097c 0564 036b 0272 2e64 0474  ...}.|.d.k.r.d.t
+0000c1d0: 00a0 0174 00a0 0274 00a0 0174 00a0 037c  ...t...t...t...|
+0000c1e0: 00a1 01a1 0174 00a0 0174 00a0 037c 01a1  .....t...t...|..
+0000c1f0: 01a1 0174 00a0 0174 00a0 037c 02a1 01a1  ...t...t...|....
+0000c200: 0174 00a0 0174 00a0 037c 03a1 01a1 0166  .t...t...|.....f
+0000c210: 04a1 01a1 0114 007d 0574 0464 0574 00a0  .......}.t.d.t..
+0000c220: 057c 08a1 0114 0083 017d 0a64 067c 0a64  .|.......}.d.|.d
+0000c230: 079c 027d 0b74 066a 0764 2d69 007c 0ba4  ...}.t.j.d-i.|..
+0000c240: 018e 0101 0074 086a 097c 0864 098d 0101  .....t.j.|.d....
+0000c250: 0074 0aa0 0b64 0a64 0ba1 027d 0c74 08a0  .t...d.d...}.t..
+0000c260: 0c7c 0c64 0364 0c85 0264 0364 0c85 0266  .|.d.d...d.d...f
+0000c270: 0219 00a1 017d 0d74 08a0 0c7c 0c64 0364  .....}.t...|.d.d
+0000c280: 0c85 0264 0d64 0b85 0266 0219 00a1 017d  ...d.d...f.....}
+0000c290: 0e74 08a0 0c7c 0c64 0c64 0e85 0264 0364  .t...|.d.d...d.d
+0000c2a0: 0c85 0266 0219 00a1 017d 0f74 08a0 0c7c  ...f.....}.t...|
+0000c2b0: 0c64 0c64 0e85 0264 0d64 0b85 0266 0219  .d.d...d.d...f..
+0000c2c0: 00a1 017d 1074 08a0 0c7c 0c64 0e64 0a85  ...}.t...|.d.d..
+0000c2d0: 0264 0f64 0f85 0266 0219 00a1 017d 117c  .d.d...f.....}.|
+0000c2e0: 0da0 0d7c 0964 047c 0014 007c 047c 0583  ...|.d.|...|.|..
+0000c2f0: 03a1 0101 0074 0e6a 0f64 1074 107c 0a64  .....t.j.d.t.|.d
+0000c300: 118d 0164 1264 1364 148d 047d 127c 126a  ...d.d.d...}.|.j
+0000c310: 11a0 1264 15a1 0101 007c 0da0 137c 12a1  ...d.....|...|..
+0000c320: 0101 007c 0664 036b 0472 cb74 14a0 157c  ...|.d.k.r.t...|
+0000c330: 067c 07a1 027d 1364 167c 135f 1664 177c  .|...}.d.|._.d.|
+0000c340: 135f 1764 187c 135f 187c 0da0 137c 13a1  ._.d.|._.|...|..
+0000c350: 0101 007c 0da0 1964 19a1 0101 007c 0ea0  ...|...d.....|..
+0000c360: 0d7c 0964 047c 0114 007c 047c 0583 03a1  .|.d.|...|.|....
+0000c370: 0101 0074 0e6a 0f64 1a74 107c 0a64 118d  ...t.j.d.t.|.d..
+0000c380: 0164 1264 1364 148d 047d 127c 126a 11a0  .d.d.d...}.|.j..
+0000c390: 1264 15a1 0101 007c 0ea0 137c 12a1 0101  .d.....|...|....
+0000c3a0: 007c 0664 036b 0490 0172 0b74 14a0 157c  .|.d.k...r.t...|
+0000c3b0: 067c 07a1 027d 1364 167c 135f 1664 177c  .|...}.d.|._.d.|
+0000c3c0: 135f 1764 187c 135f 187c 0ea0 137c 13a1  ._.d.|._.|...|..
+0000c3d0: 0101 007c 0ea0 1964 19a1 0101 007c 0fa0  ...|...d.....|..
+0000c3e0: 0d7c 0964 047c 0214 007c 047c 0583 03a1  .|.d.|...|.|....
+0000c3f0: 0101 0074 0e6a 0f64 1b74 107c 0a64 118d  ...t.j.d.t.|.d..
+0000c400: 0164 1264 1364 148d 047d 127c 126a 11a0  .d.d.d...}.|.j..
+0000c410: 1264 15a1 0101 007c 0fa0 137c 12a1 0101  .d.....|...|....
+0000c420: 007c 0664 036b 0490 0172 4b74 14a0 157c  .|.d.k...rKt...|
+0000c430: 067c 07a1 027d 1364 167c 135f 1664 177c  .|...}.d.|._.d.|
+0000c440: 135f 1764 187c 135f 187c 0fa0 137c 13a1  ._.d.|._.|...|..
+0000c450: 0101 007c 0fa0 1964 19a1 0101 007c 10a0  ...|...d.....|..
+0000c460: 0d7c 0964 047c 0314 007c 047c 0583 03a1  .|.d.|...|.|....
+0000c470: 0101 0074 0e6a 0f64 1c74 107c 0a64 118d  ...t.j.d.t.|.d..
+0000c480: 0164 1264 1364 148d 047d 127c 126a 11a0  .d.d.d...}.|.j..
+0000c490: 1264 15a1 0101 007c 10a0 137c 12a1 0101  .d.....|...|....
+0000c4a0: 007c 0664 036b 0490 0172 8b74 14a0 157c  .|.d.k...r.t...|
+0000c4b0: 067c 07a1 027d 1364 167c 135f 1664 177c  .|...}.d.|._.d.|
+0000c4c0: 135f 1764 187c 135f 187c 10a0 137c 13a1  ._.d.|._.|...|..
+0000c4d0: 0101 007c 10a0 1964 19a1 0101 0074 006a  ...|...d.....t.j
+0000c4e0: 1a64 1d74 006a 1b64 1e8d 027d 1474 1c64  .d.t.j.d...}.t.d
+0000c4f0: 0c83 0144 005d 117d 1574 00a0 1d7c 050b  ...D.].}.t...|..
+0000c500: 007c 0564 1fa1 037c 147c 1564 0f64 0f85  .|.d...|.|.d.d..
+0000c510: 0266 023c 0090 0171 9c7c 116a 0d7c 1464  .f.<...q.|.j.|.d
+0000c520: 2064 218d 0201 007c 116a 1ea0 1f64 22a1   d!....|.j...d".
+0000c530: 0101 0074 00a0 1d64 0364 1f64 23a1 037d  ...t...d.d.d#..}
+0000c540: 167c 11a0 207c 16a1 0101 007c 11a0 2174  .|.. |.....|..!t
+0000c550: 00a0 2274 00a0 1d7c 050b 007c 0564 23a1  .."t...|...|.d#.
+0000c560: 0364 24a1 02a1 0101 0064 2544 005d 137d  .d$......d%D.].}
+0000c570: 177c 116a 237c 1719 00a0 2464 24a1 0101  .|.j#|....$d$...
+0000c580: 007c 116a 237c 1719 00a0 2564 26a1 0101  .|.j#|....%d&...
+0000c590: 0090 0171 d87c 116a 266a 2764 2464 2764  ...q.|.j&j'd$d'd
+0000c5a0: 2864 0c64 298d 0401 007c 116a 2864 2a64  (d.d)....|.j(d*d
+0000c5b0: 2b64 0664 2c8d 0301 0074 08a0 29a1 0001  +d.d,....t..)...
+0000c5c0: 0064 0f53 0029 2e61 f105 0000 0a20 2020  .d.S.).a.....   
+0000c5d0: 2050 6c6f 7420 7468 6520 7374 7261 696e   Plot the strain
+0000c5e0: 206d 6170 7320 6672 6f6d 2061 2067 6976   maps from a giv
+0000c5f0: 656e 2073 6574 206f 6620 7374 7261 696e  en set of strain
+0000c600: 732c 2077 6865 7265 2074 6865 2073 7472  s, where the str
+0000c610: 6169 6e20 6973 0a20 2020 206d 6170 7065  ain is.    mappe
+0000c620: 6420 6f6e 6c79 2069 6e20 7468 6520 7265  d only in the re
+0000c630: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
+0000c640: 2c20 7768 696c 6520 616e 7974 6869 6e67  , while anything
+0000c650: 206f 7574 7369 6465 2074 6865 2072 6567   outside the reg
+0000c660: 696f 6e0a 2020 2020 6f66 2069 6e74 6572  ion.    of inter
+0000c670: 6573 7420 6973 2062 6c61 636b 2e0a 0a20  est is black... 
+0000c680: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0000c690: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0000c6a0: 2065 7878 3a20 2020 2020 2020 206e 6461   exx:        nda
+0000c6b0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+0000c6c0: 2020 2020 2032 4420 6172 7261 7920 6f66       2D array of
+0000c6d0: 2065 5f78 7820 7374 7261 696e 730a 2020   e_xx strains.  
+0000c6e0: 2020 6579 793a 2020 2020 2020 2020 6e64    eyy:        nd
+0000c6f0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+0000c700: 2020 2020 2020 3244 2061 7272 6179 206f        2D array o
+0000c710: 6620 655f 7979 2073 7472 6169 6e73 0a20  f e_yy strains. 
+0000c720: 2020 2065 7468 3a20 2020 2020 2020 206e     eth:        n
+0000c730: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+0000c740: 2020 2020 2020 2032 4420 6172 7261 7920         2D array 
+0000c750: 6f66 2065 5f74 6865 7461 2073 7472 6169  of e_theta strai
+0000c760: 6e73 0a20 2020 2065 7979 3a20 2020 2020  ns.    eyy:     
+0000c770: 2020 206e 6461 7272 6179 0a20 2020 2020     ndarray.     
+0000c780: 2020 2020 2020 2020 2020 2032 4420 6172             2D ar
+0000c790: 7261 7920 6f66 2065 5f79 7920 7374 7261  ray of e_yy stra
+0000c7a0: 696e 730a 2020 2020 524f 493a 2020 2020  ins.    ROI:    
+0000c7b0: 2020 2020 6e64 6172 7261 7920 6f66 2074      ndarray of t
+0000c7c0: 7970 6520 626f 6f6c 0a20 2020 2020 2020  ype bool.       
+0000c7d0: 2020 2020 2020 2020 2052 6567 696f 6e20           Region 
+0000c7e0: 6f66 2069 6e74 6572 6573 740a 2020 2020  of interest.    
+0000c7f0: 766d 3a20 2020 2020 2020 2020 666c 6f61  vm:         floa
+0000c800: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000c810: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
+0000c820: 6d75 6d20 7661 6c75 6520 6f66 2073 7472  mum value of str
+0000c830: 6169 6e20 6d61 700a 2020 2020 2020 2020  ain map.        
+0000c840: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
+0000c850: 6973 2030 2c20 616e 6420 7768 656e 2069  is 0, and when i
+0000c860: 7427 7320 7a65 726f 2c0a 2020 2020 2020  t's zero,.      
+0000c870: 2020 2020 2020 2020 2020 6974 2077 696c            it wil
+0000c880: 6c20 6361 6c63 756c 6174 6520 7468 6520  l calculate the 
+0000c890: 6d61 7869 6d75 6d20 6162 736f 6c75 7465  maximum absolute
+0000c8a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c8b0: 2073 7472 6169 6e20 7661 6c75 6520 616e   strain value an
+0000c8c0: 6420 7573 6520 7468 6174 2e0a 2020 2020  d use that..    
+0000c8d0: 7363 616c 653a 2020 2020 2020 666c 6f61  scale:      floa
+0000c8e0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000c8f0: 2020 2020 2020 2020 2020 2020 5069 7865              Pixe
+0000c900: 6c20 7369 7a65 2e20 4465 6661 756c 7420  l size. Default 
+0000c910: 6973 2030 0a20 2020 2073 6361 6c65 5f75  is 0.    scale_u
+0000c920: 6e69 743a 2063 6861 722c 206f 7074 696f  nit: char, optio
+0000c930: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000c940: 2020 2020 556e 6974 7320 6f66 2074 6865      Units of the
+0000c950: 2063 616c 6962 7261 7469 6f6e 2e20 4465   calibration. De
+0000c960: 6661 756c 7420 6973 2027 6e6d 270a 2020  fault is 'nm'.  
+0000c970: 2020 6669 6773 697a 653a 2020 2020 7475    figsize:    tu
+0000c980: 706c 652c 206f 7074 696f 6e61 6c0a 2020  ple, optional.  
+0000c990: 2020 2020 2020 2020 2020 2020 2020 5369                Si
+0000c9a0: 7a65 206f 6620 7468 6520 6669 6e61 6c20  ze of the final 
+0000c9b0: 6669 6775 7265 0a0a 2020 2020 4e6f 7465  figure..    Note
+0000c9c0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+0000c9d0: 5468 6973 2069 7320 6261 7369 6361 6c6c  This is basicall
+0000c9e0: 7920 6120 6e69 6365 2066 756e 6374 696f  y a nice functio
+0000c9f0: 6e20 666f 7220 706c 6f74 7469 6e67 2063  n for plotting c
+0000ca00: 616c 6375 6c61 7465 6420 7374 7261 696e  alculated strain
+0000ca10: 206d 6170 730a 2020 2020 6672 6f6d 2061   maps.    from a
+0000ca20: 2072 6567 696f 6e20 6f66 2069 6e74 6572   region of inter
+0000ca30: 6573 742e 2057 6520 7573 6520 7468 6520  est. We use the 
+0000ca40: 5264 4275 5f72 2c20 7768 6963 6820 6973  RdBu_r, which is
+0000ca50: 2074 6865 2052 6442 7520 7265 7665 7273   the RdBu revers
+0000ca60: 6564 0a20 2020 2063 6f6c 6f72 2073 6368  ed.    color sch
+0000ca70: 656d 652c 2077 6865 7265 2030 2069 7320  eme, where 0 is 
+0000ca80: 7768 6974 652c 206e 6567 6174 6976 6520  white, negative 
+0000ca90: 7661 6c75 6573 2061 7265 2069 6e63 7265  values are incre
+0000caa0: 6173 696e 676c 7920 626c 7565 2074 6865  asingly blue the
+0000cab0: 0a20 2020 206d 6f72 6520 6e65 6761 7469  .    more negati
+0000cac0: 7665 2074 6865 7920 6172 652c 2077 6869  ve they are, whi
+0000cad0: 6c65 2070 6f73 6974 6976 6520 7661 6c75  le positive valu
+0000cae0: 6573 2061 7265 2069 6e63 7265 6173 696e  es are increasin
+0000caf0: 676c 7920 7265 6420 7468 6520 6d6f 7265  gly red the more
+0000cb00: 0a20 2020 2070 6f73 6974 6976 6520 7468  .    positive th
+0000cb10: 6579 2061 7265 2e20 416e 7974 6869 6e67  ey are. Anything
+0000cb20: 206f 7574 7369 6465 2074 6865 2072 6567   outside the reg
+0000cb30: 696f 6e20 6f66 2069 6e74 6572 6573 7420  ion of interest 
+0000cb40: 6973 2062 6c61 636b 2c20 616e 6420 7468  is black, and th
+0000cb50: 7573 0a20 2020 2074 6f20 616e 206f 6273  us.    to an obs
+0000cb60: 6572 7665 7220 7468 6520 524f 4920 6361  erver the ROI ca
+0000cb70: 6e20 6265 2076 6973 7561 6c69 7a65 6420  n be visualized 
+0000cb80: 636c 6561 726c 792e 204f 7074 696f 6e61  clearly. Optiona
+0000cb90: 6c6c 792c 2061 2073 6361 6c65 6261 7220  lly, a scalebar 
+0000cba0: 6361 6e0a 2020 2020 6265 2061 7373 6967  can.    be assig
+0000cbb0: 6e65 6420 746f 6f2e 0a20 2020 2063 0300  ned too..    c..
+0000cbc0: 0000 0000 0000 0000 0000 0700 0000 0600  ................
+0000cbd0: 0000 5300 0000 73b6 0000 0074 006a 0164  ..S...s....t.j.d
+0000cbe0: 0174 006a 0264 028d 027d 0374 0364 0383  .t.j.d...}.t.d..
+0000cbf0: 0144 005d 157d 0474 00a0 0474 056a 06a0  .D.].}.t...t.j..
+0000cc00: 077c 04a1 0164 0464 0585 0219 00a1 017c  .|...d.d.......|
+0000cc10: 037c 0464 0464 0585 0266 023c 0071 0c74  .|.d.d...f.<.q.t
+0000cc20: 00a0 017c 006a 0864 0419 007c 006a 0864  ...|.j.d...|.j.d
+0000cc30: 0619 0064 0566 03a1 017d 0564 037c 007c  ...d.f...}.d.|.|
+0000cc40: 0119 007c 0217 0064 077c 0214 001b 0014  ...|...d.|......
+0000cc50: 00a0 0974 0aa1 017d 0664 037c 067c 0664  ...t...}.d.|.|.d
+0000cc60: 036b 043c 0064 047c 067c 0664 046b 003c  .k.<.d.|.|.d.k.<
+0000cc70: 007c 037c 0664 0064 0085 0266 0219 007c  .|.|.d.d...f...|
+0000cc80: 057c 0164 0464 0585 0266 023c 007c 0553  .|.d.d...f.<.|.S
+0000cc90: 0029 084e 2902 e900 0100 0072 2600 0000  .).N)......r&...
+0000cca0: 725f 0000 00e9 ff00 0000 7201 0000 0072  r_........r....r
+0000ccb0: 2600 0000 7227 0000 0072 2500 0000 290b  &...r'...r%...).
+0000ccc0: 7209 0000 0072 4100 0000 72e2 0000 0072  r....rA...r....r
+0000ccd0: 1b00 0000 7218 0000 00da 036d 706c da02  ....r......mpl..
+0000cce0: 636d da06 5264 4275 5f72 7219 0000 0072  cm..RdBu_rr....r
+0000ccf0: 3a00 0000 722f 0000 0029 075a 0676 616c  :...r/...).Z.val
+0000cd00: 6d61 70da 0372 6f69 5a08 7661 6c72 616e  map..roiZ.valran
+0000cd10: 6765 5a08 706c 6f74 5f63 6f6c 7222 0000  geZ.plot_colr"..
+0000cd20: 005a 076d 6170 5f63 6f6c 5a09 636f 6c6f  .Z.map_colZ.colo
+0000cd30: 7276 616c 7372 0f00 0000 720f 0000 0072  rvalsr....r....r
+0000cd40: 1000 0000 da0c 524f 495f 5264 4275 5f6d  ......ROI_RdBu_m
+0000cd50: 6170 f106 0000 7312 0000 0010 010c 0128  ap....s........(
+0000cd60: 011c 011e 010c 010c 011c 0104 017a 2373  .............z#s
+0000cd70: 7472 6169 6e5f 6669 6775 7265 2e3c 6c6f  train_figure.<lo
+0000cd80: 6361 6c73 3e2e 524f 495f 5264 4275 5f6d  cals>.ROI_RdBu_m
+0000cd90: 6170 7201 0000 00e9 6400 0000 6700 0000  apr.....d...g...
+0000cda0: 0000 00f4 3f5a 0462 6f6c 6429 02da 0677  ....?Z.bold)...w
+0000cdb0: 6569 6768 7472 2e00 0000 da04 666f 6e74  eightr......font
+0000cdc0: 726d 0000 0072 2301 0000 7222 0100 0072  rm...r#...r"...r
+0000cdd0: ad00 0000 e90c 0000 0072 1101 0000 4e7a  .........r....Nz
+0000cde0: 1824 5c6d 6174 6872 6d7b 5c65 7073 696c  .$\mathrm{\epsil
+0000cdf0: 6f6e 5f7b 7878 7d7d 2429 0172 2e00 0000  on_{xx}}$).r....
+0000ce00: 547a 0b6c 6f77 6572 2072 6967 6874 2903  Tz.lower right).
+0000ce10: da04 7072 6f70 5a07 6672 616d 656f 6eda  ..propZ.frameon.
+0000ce20: 036c 6f63 7a22 726f 756e 642c 2070 6164  .locz"round, pad
+0000ce30: 3d20 302e 2c20 726f 756e 6469 6e67 5f73  = 0., rounding_s
+0000ce40: 697a 653d 2030 2e32 7a0a 6c6f 7765 7220  ize= 0.2z.lower 
+0000ce50: 6c65 6674 7227 0000 00da 016b da03 6f66  leftr'.....k..of
+0000ce60: 667a 1824 5c6d 6174 6872 6d7b 5c65 7073  fz.$\mathrm{\eps
+0000ce70: 696c 6f6e 5f7b 7879 7d7d 247a 1c24 5c6d  ilon_{xy}}$z.$\m
+0000ce80: 6174 6872 6d7b 5c65 7073 696c 6f6e 5f7b  athrm{\epsilon_{
+0000ce90: 5c74 6865 7461 7d7d 247a 1824 5c6d 6174  \theta}}$z.$\mat
+0000cea0: 6872 6d7b 5c65 7073 696c 6f6e 5f7b 7979  hrm{\epsilon_{yy
+0000ceb0: 7d7d 2429 0272 ad00 0000 72e1 0000 0072  }}$).r....r....r
+0000cec0: 5f00 0000 72e1 0000 0072 2801 0000 726f  _...r....r(...ro
+0000ced0: 0000 0046 e908 0000 0072 2500 0000 2904  ...F.....r%...).
+0000cee0: da03 746f 705a 0662 6f74 746f 6dda 046c  ..topZ.bottom..l
+0000cef0: 6566 74da 0572 6967 6874 5a05 626c 6163  eft..rightZ.blac
+0000cf00: 6b72 f200 0000 da03 6f75 7429 04da 0577  kr......out)...w
+0000cf10: 6964 7468 da06 6c65 6e67 7468 da09 6469  idth..length..di
+0000cf20: 7265 6374 696f 6eda 0370 6164 7a0a 5374  rection..padz.St
+0000cf30: 7261 696e 2028 2529 7271 0000 0029 02da  rain (%)rq...)..
+0000cf40: 0866 6f6e 7473 697a 655a 0a66 6f6e 7477  .fontsizeZ.fontw
+0000cf50: 6569 6768 7429 0172 2d01 0000 292a 7209  eight).r-...)*r.
+0000cf60: 0000 0072 8e00 0000 7218 0000 0072 1c00  ...r....r....r..
+0000cf70: 0000 722f 0000 0072 f800 0000 7226 0100  ..r/...r....r&..
+0000cf80: 00da 0272 6372 7600 0000 7277 0000 00da  ...rcrv...rw....
+0000cf90: 046d 7067 735a 0847 7269 6453 7065 635a  .mpgsZ.GridSpecZ
+0000cfa0: 0773 7562 706c 6f74 7278 0000 00da 066d  .subplotrx.....m
+0000cfb0: 706c 6f66 665a 0c41 6e63 686f 7265 6454  ploffZ.AnchoredT
+0000cfc0: 6578 74da 0464 6963 745a 0570 6174 6368  ext..dictZ.patch
+0000cfd0: 5a0c 7365 745f 626f 7873 7479 6c65 5a0a  Z.set_boxstyleZ.
+0000cfe0: 6164 645f 6172 7469 7374 da04 6d70 7373  add_artist..mpss
+0000cff0: 5a08 5363 616c 6542 6172 da08 6c6f 6361  Z.ScaleBar..loca
+0000d000: 7469 6f6e 5a09 626f 785f 616c 7068 615a  tionZ.box_alphaZ
+0000d010: 0563 6f6c 6f72 720c 0000 0072 4100 0000  .colorr....rA...
+0000d020: 72e2 0000 0072 1b00 0000 721c 0100 005a  r....r....r....Z
+0000d030: 0579 6178 6973 5a0b 7365 745f 7669 7369  .yaxisZ.set_visi
+0000d040: 626c 655a 0a73 6574 5f78 7469 636b 735a  bleZ.set_xticksZ
+0000d050: 0f73 6574 5f78 7469 636b 6c61 6265 6c73  .set_xticklabels
+0000d060: 7239 0000 005a 0673 7069 6e65 735a 0d73  r9...Z.spinesZ.s
+0000d070: 6574 5f6c 696e 6577 6964 7468 5a09 7365  et_linewidthZ.se
+0000d080: 745f 636f 6c6f 725a 0578 6178 6973 5a0f  t_colorZ.xaxisZ.
+0000d090: 7365 745f 7469 636b 5f70 6172 616d 735a  set_tick_paramsZ
+0000d0a0: 0973 6574 5f74 6974 6c65 5a0c 7469 6768  .set_titleZ.tigh
+0000d0b0: 745f 6c61 796f 7574 2918 5a03 6578 785a  t_layout).Z.exxZ
+0000d0c0: 0365 7879 da03 6574 685a 0365 7979 728b  .exy..ethZ.eyyr.
+0000d0d0: 0000 005a 0276 6d5a 0573 6361 6c65 5a0a  ...Z.vmZ.scaleZ.
+0000d0e0: 7363 616c 655f 756e 6974 726e 0000 0072  scale_unitrn...r
+0000d0f0: 2a01 0000 723c 0100 005a 0773 635f 666f  *...r<...Z.sc_fo
+0000d100: 6e74 5a02 6773 5a03 6178 315a 0361 7832  ntZ.gsZ.ax1Z.ax2
+0000d110: 5a03 6178 335a 0361 7834 5a03 6178 35da  Z.ax3Z.ax4Z.ax5.
+0000d120: 0261 74da 0873 6361 6c65 6261 725a 0273  .at..scalebarZ.s
+0000d130: 6272 2200 0000 da02 7831 720c 0000 0072  br".....x1r....r
+0000d140: 0f00 0000 720f 0000 0072 1000 0000 da0d  ....r....r......
+0000d150: 7374 7261 696e 5f66 6967 7572 65c6 0600  strain_figure...
+0000d160: 0073 c600 0000 082b 080b 0601 0401 0e02  .s.....+........
+0000d170: 0e01 0e01 0e01 02fc 02ff 06ff 120b 0a01  ................
+0000d180: 1001 0c01 0c02 1a01 1a01 1a01 1a01 1a01  ................
+0000d190: 1602 0401 0201 0801 0201 0201 06fc 0c06  ................
+0000d1a0: 0a01 0801 0c01 0601 0601 0601 0a01 0a01  ................
+0000d1b0: 1602 0401 0201 0801 0201 0201 06fc 0c06  ................
+0000d1c0: 0a01 0a01 0c01 0601 0601 0601 0a01 0a01  ................
+0000d1d0: 1602 0401 0201 0801 0201 0201 06fc 0c06  ................
+0000d1e0: 0a01 0a01 0c01 0601 0601 0601 0a01 0a01  ................
+0000d1f0: 1602 0401 0201 0801 0201 0201 06fc 0c06  ................
+0000d200: 0a01 0a01 0c01 0601 0601 0601 0a01 0a01  ................
+0000d210: 1002 0c01 2001 0e01 0c01 0e01 0a01 1e01  .... ...........
+0000d220: 0801 1001 1401 1401 1001 0c02 7247 0100  ............rG..
+0000d230: 00a9 0272 f000 0000 67fc a9f1 d24d 6250  ...r....g....MbP
+0000d240: 3f72 f200 0000 6304 0000 0000 0000 0000  ?r....c.........
+0000d250: 0000 0010 0000 0008 0000 0043 0000 0073  ...........C...s
+0000d260: d801 0000 7400 6a01 a002 7c01 6401 7c03  ....t.j...|.d.|.
+0000d270: 1b00 a102 7d04 7400 6a01 a003 7c04 6402  ....}.t.j...|.d.
+0000d280: a102 5c02 7d05 7d06 7400 6a01 a002 7c00  ..\.}.}.t.j...|.
+0000d290: 6401 7c03 1b00 a102 7d07 7400 6a01 a004  d.|.....}.t.j...
+0000d2a0: 7c05 a101 7d08 7405 a006 7c08 a101 7c08  |...}.t...|...|.
+0000d2b0: 7c08 6401 7c03 1b00 6b04 1900 1800 7c03  |.d.|...k.....|.
+0000d2c0: 1b00 7d09 7c07 7c08 6401 7c03 1b00 6b04  ..}.|.|.d.|...k.
+0000d2d0: 1900 7d0a 7405 a007 7405 a008 7c09 6401  ..}.t...t...|.d.
+0000d2e0: a102 a101 7d0b 7c0b 7c09 1800 7d09 7405  ....}.|.|...}.t.
+0000d2f0: a009 7405 a00a 7c09 7c0a 6602 a101 a101  ..t...|.|.f.....
+0000d300: 7d0c 7400 6a01 a00b 7c0c 7c02 a102 7d0c  }.t.j...|.|...}.
+0000d310: 7405 a00c 740d 7405 a00e 7c0c 6403 6403  t...t.t...|.d.d.
+0000d320: 8502 6404 6602 1900 a101 8301 6405 6602  ..d.f.......d.f.
+0000d330: a101 7d0d 7405 a00e 7c0c 6403 6403 8502  ..}.t...|.d.d...
+0000d340: 6404 6602 1900 a101 7c0d 6403 6403 8502  d.f.....|.d.d...
+0000d350: 6404 6602 3c00 7c0c 6403 6403 8502 6401  d.f.<.|.d.d...d.
+0000d360: 6602 1900 7d0a 7405 a00f 7c0d 6a10 6404  f...}.t...|.j.d.
+0000d370: 1900 a101 4400 5d5d 7d0e 7405 a011 7c0a  ....D.]]}.t...|.
+0000d380: 7c0c 6403 6403 8502 6404 6602 1900 7c0d  |.d.d...d.f...|.
+0000d390: 7c0e 6404 6602 1900 6b02 1900 a101 7c0d  |.d.f...k.....|.
+0000d3a0: 7c0e 6401 6602 3c00 740d 7c0a 7c0c 6403  |.d.f.<.t.|.|.d.
+0000d3b0: 6403 8502 6404 6602 1900 7c0d 7c0e 6404  d...d.f...|.|.d.
+0000d3c0: 6602 1900 6b02 1900 8301 7d0f 7405 a012  f...k.....}.t...
+0000d3d0: 7c0a 7c0c 6403 6403 8502 6404 6602 1900  |.|.d.d...d.f...
+0000d3e0: 7c0d 7c0e 6404 6602 1900 6b02 1900 a101  |.|.d.f...k.....
+0000d3f0: 7c0d 7c0e 6406 6602 3c00 7405 a012 7c0a  |.|.d.f.<.t...|.
+0000d400: 7c0c 6403 6403 8502 6404 6602 1900 7c0d  |.d.d...d.f...|.
+0000d410: 7c0e 6404 6602 1900 6b02 1900 a101 7c0f  |.d.f...k.....|.
+0000d420: 6407 1300 1b00 7c0d 7c0e 6408 6602 3c00  d.....|.|.d.f.<.
+0000d430: 7189 7c0c 7c0d 7c0b 6603 5300 2909 6196  q.|.|.|.f.S.).a.
+0000d440: 0400 000a 2020 2020 4765 7420 7374 7261  ....    Get stra
+0000d450: 696e 206d 6170 7320 6672 6f6d 2074 6865  in maps from the
+0000d460: 2076 6f6c 756d 6520 6361 6c63 756c 6174   volume calculat
+0000d470: 696f 6e20 616e 6420 7265 6769 6f6e 206f  ion and region o
+0000d480: 660a 2020 2020 696e 7465 7265 7374 0a0a  f.    interest..
+0000d490: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000d4a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0000d4b0: 2020 766f 6c75 6d65 3a20 2020 2020 6e64    volume:     nd
+0000d4c0: 6172 7261 792c 2066 6c6f 6174 0a20 2020  array, float.   
+0000d4d0: 2020 2020 2020 2020 2020 2020 2043 616c               Cal
+0000d4e0: 6375 6c61 7465 6420 766f 6c75 6d65 2066  culated volume f
+0000d4f0: 726f 6d20 7374 7261 696e 0a20 2020 2072  rom strain.    r
+0000d500: 6f69 3a20 2020 2020 2020 206e 6461 7272  oi:        ndarr
+0000d510: 6179 2c20 626f 6f6c 0a20 2020 2020 2020  ay, bool.       
+0000d520: 2020 2020 2020 2020 2052 6567 696f 6e20           Region 
+0000d530: 7768 6572 6520 7468 6520 7061 7274 6963  where the partic
+0000d540: 6c65 206c 6965 730a 2020 2020 7072 6563  le lies.    prec
+0000d550: 6973 696f 6e3a 2020 7475 706c 650a 2020  ision:  tuple.  
+0000d560: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0000d570: 6520 6e75 6d62 6572 206f 6620 7369 676e  e number of sign
+0000d580: 6966 6963 616e 7420 6469 6769 7473 2069  ificant digits i
+0000d590: 6e20 6561 6368 2061 7865 730a 2020 2020  n each axes.    
+0000d5a0: 7570 7361 6d70 6c69 6e67 3a20 696e 740a  upsampling: int.
+0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5c0: 5570 7361 6d70 6c69 6e67 2066 6163 746f  Upsampling facto
+0000d5d0: 7220 666f 7220 7468 6520 7265 6769 6f6e  r for the region
+0000d5e0: 2062 6566 6f72 6520 6361 6c63 756c 6174   before calculat
+0000d5f0: 696f 6e0a 0a20 2020 2052 6574 7572 6e73  ion..    Returns
+0000d600: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+0000d610: 2072 6177 7661 6c73 3a20 6e64 6172 7261   rawvals: ndarra
+0000d620: 792c 2066 6c6f 6174 0a20 2020 2020 2020  y, float.       
+0000d630: 2020 2020 2020 5468 6520 7261 7720 6361        The raw ca
+0000d640: 6c63 756c 6174 6564 2073 7472 6169 6e20  lculated strain 
+0000d650: 7661 6c75 6573 2066 726f 6d20 7468 6520  values from the 
+0000d660: 7265 6769 6f6e 206f 6620 696e 7465 7265  region of intere
+0000d670: 7374 0a20 2020 2073 7472 6169 6e3a 2020  st.    strain:  
+0000d680: 6e64 6172 7261 792c 2066 6c6f 6174 0a20  ndarray, float. 
+0000d690: 2020 2020 2020 2020 2020 2020 5374 7261              Stra
+0000d6a0: 696e 2028 7365 636f 6e64 2063 6f6c 756d  in (second colum
+0000d6b0: 6e29 2061 7320 6120 6675 6e63 7469 6f6e  n) as a function
+0000d6c0: 206f 6620 6469 7374 616e 6365 2066 726f   of distance fro
+0000d6d0: 6d20 7061 7274 6963 6c65 0a20 2020 2020  m particle.     
+0000d6e0: 2020 2020 2020 2020 7375 7266 6163 6520          surface 
+0000d6f0: 2866 6972 7374 2063 6f6c 756d 6e29 2c20  (first column), 
+0000d700: 7769 7468 2073 7461 6e64 6172 6420 6572  with standard er
+0000d710: 726f 7220 2874 6869 7264 2063 6f6c 756d  ror (third colum
+0000d720: 6e29 2061 6e64 0a20 2020 2020 2020 2020  n) and.         
+0000d730: 2020 2020 7374 616e 6461 7264 2064 6576      standard dev
+0000d740: 6961 7469 6f6e 2028 666f 7572 7468 2063  iation (fourth c
+0000d750: 6f6c 756d 6e29 0a20 2020 206d 6178 6469  olumn).    maxdi
+0000d760: 7374 3a20 666c 6f61 740a 2020 2020 2020  st: float.      
+0000d770: 2020 2020 2020 204d 6178 696d 756d 2064         Maximum d
+0000d780: 6973 7461 6e63 6520 6672 6f6d 2073 7572  istance from sur
+0000d790: 6661 6365 0a0a 2020 2020 4e6f 7465 730a  face..    Notes.
+0000d7a0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5468      -----.    Th
+0000d7b0: 6520 524f 4920 6973 2075 7073 616d 706c  e ROI is upsampl
+0000d7c0: 6564 2062 7920 7468 6520 7570 7361 6d70  ed by the upsamp
+0000d7d0: 6c65 6420 6279 2074 6865 2075 7073 616d  led by the upsam
+0000d7e0: 706c 696e 6720 6661 6374 6f72 2c20 616e  pling factor, an
+0000d7f0: 6420 7468 650a 2020 2020 6361 7274 6573  d the.    cartes
+0000d800: 6961 6e20 6469 7374 616e 6365 7320 696e  ian distances in
+0000d810: 7369 6465 2074 6861 7420 524f 4920 6672  side that ROI fr
+0000d820: 6f6d 2074 6865 206e 6561 7265 7374 2065  om the nearest e
+0000d830: 6467 6520 706f 696e 7420 6172 650a 2020  dge point are.  
+0000d840: 2020 6361 6c63 756c 6174 6564 2e20 5468    calculated. Th
+0000d850: 6174 2773 2079 6f75 7220 7820 7661 6c75  at's your x valu
+0000d860: 6573 2c20 7768 6963 6820 6973 2074 6865  es, which is the
+0000d870: 2064 6973 7461 6e63 6520 6672 6f6d 2074   distance from t
+0000d880: 6865 2073 7572 6661 6365 2c0a 2020 2020  he surface,.    
+0000d890: 7768 696c 6520 7468 6520 7920 7661 6c75  while the y valu
+0000d8a0: 6573 2061 7265 2074 6865 2063 616c 6375  es are the calcu
+0000d8b0: 6c61 7465 6420 766f 6c75 6d65 2073 7472  lated volume str
+0000d8c0: 6169 6e20 6174 2074 6861 7420 706f 7369  ain at that posi
+0000d8d0: 7469 6f6e 0a20 2020 2072 2700 0000 7202  tion.    r'...r.
+0000d8e0: 0000 004e 7201 0000 0072 6800 0000 7225  ...Nr....rh...r%
+0000d8f0: 0000 0072 1600 0000 7226 0000 0029 1372  ...r....r&...).r
+0000d900: 1d00 0000 721e 0000 0072 5e00 0000 72b4  ....r....r^...r.
+0000d910: 0000 0072 f900 0000 7209 0000 0072 f800  ...r....r....r..
+0000d920: 0000 728e 0000 0072 3900 0000 7228 0000  ..r....r9...r(..
+0000d930: 0072 1800 0000 5a13 7265 6475 6365 5f70  .r....Z.reduce_p
+0000d940: 7265 6369 7369 6f6e 5f78 7972 4100 0000  recision_xyrA...
+0000d950: 7246 0000 00da 0675 6e69 7175 6572 9200  rF.....uniquer..
+0000d960: 0000 7219 0000 0072 8500 0000 72a2 0000  ..r....r....r...
+0000d970: 0029 10da 0676 6f6c 756d 6572 2901 0000  .)...volumer)...
+0000d980: 5a09 7072 6563 6973 696f 6e72 fb00 0000  Z.precisionr....
+0000d990: 72fc 0000 0072 fd00 0000 72ab 0000 005a  r....r....r....Z
+0000d9a0: 0775 7073 5f6d 6170 72fe 0000 0072 e600  .ups_mapr....r..
+0000d9b0: 0000 72e5 0000 005a 076d 6178 6469 7374  ..r....Z.maxdist
+0000d9c0: 5a07 7261 7776 616c 735a 0673 7472 6169  Z.rawvalsZ.strai
+0000d9d0: 6e72 2200 0000 da02 6e6e 720f 0000 0072  nr".....nnr....r
+0000d9e0: 0f00 0000 7210 0000 00da 0f67 6574 5f73  ....r......get_s
+0000d9f0: 7472 6169 6e5f 706c 6f74 6907 0000 7326  train_ploti...s&
+0000da00: 0000 0012 2212 0112 010c 011e 0110 0112  ...."...........
+0000da10: 0108 0114 010e 0124 0122 0110 0114 012e  .......$."......
+0000da20: 0124 012e 0138 010a 0172 4c01 0000 2901  .$...8...rL...).
+0000da30: 7201 0000 0029 0172 6800 0000 2901 5429  r....).rh...).T)
+0000da40: 0272 8400 0000 5429 0472 0100 0000 728d  .r....T).r....r.
+0000da50: 0000 0072 0100 0000 4629 0572 0100 0000  ...r....F).r....
+0000da60: 72ad 0000 0072 2600 0000 72ae 0000 0072  r....r&...r....r
+0000da70: 1600 0000 2902 7201 0000 0072 ad00 0000  ....).r....r....
+0000da80: 2901 72d9 0000 0029 0272 e000 0000 7226  ).r....).r....r&
+0000da90: 0000 0029 0172 0200 0000 2901 72e9 0000  ...).r....).r...
+0000daa0: 0029 0172 ed00 0000 2904 72ed 0000 0054  .).r....).r....T
+0000dab0: 720d 0100 0072 d900 0000 2902 72f0 0000  r....r....).r...
+0000dac0: 0072 1001 0000 2904 7201 0000 0072 0100  .r....).r....r..
+0000dad0: 0000 7220 0100 0072 2101 0000 2902 7248  ..r ...r!...).rH
+0000dae0: 0100 0072 f200 0000 294b 5a05 6e75 6d70  ...r....)KZ.nump
+0000daf0: 7972 0900 0000 5a0d 7363 6970 792e 6e64  yr....Z.scipy.nd
+0000db00: 696d 6167 655a 076e 6469 6d61 6765 7207  imageZ.ndimager.
+0000db10: 0000 005a 0e73 6369 7079 2e6f 7074 696d  ...Z.scipy.optim
+0000db20: 697a 65da 086f 7074 696d 697a 6572 1300  ize..optimizer..
+0000db30: 0000 5a0c 7363 6970 792e 7369 676e 616c  ..Z.scipy.signal
+0000db40: da06 7369 676e 616c 5a06 7363 6973 6967  ..signalZ.scisig
+0000db50: 5a0f 736b 696d 6167 652e 6665 6174 7572  Z.skimage.featur
+0000db60: 655a 0766 6561 7475 7265 72f6 0000 005a  eZ.featurer....Z
+0000db70: 116d 6174 706c 6f74 6c69 622e 636f 6c6f  .matplotlib.colo
+0000db80: 7273 5a06 636f 6c6f 7273 7295 0000 005a  rsZ.colorsr....Z
+0000db90: 116d 6174 706c 6f74 6c69 622e 7079 706c  .matplotlib.pypl
+0000dba0: 6f74 5a06 7079 706c 6f74 7276 0000 005a  otZ.pyplotrv...Z
+0000dbb0: 0a6d 6174 706c 6f74 6c69 6272 2601 0000  .matplotlibr&...
+0000dbc0: da08 7374 656d 746f 6f6c 721d 0000 005a  ..stemtoolr....Z
+0000dbd0: 146d 6174 706c 6f74 6c69 622e 6f66 6673  .matplotlib.offs
+0000dbe0: 6574 626f 785a 096f 6666 7365 7462 6f78  etboxZ.offsetbox
+0000dbf0: 723f 0100 005a 136d 6174 706c 6f74 6c69  r?...Z.matplotli
+0000dc00: 622e 6772 6964 7370 6563 5a08 6772 6964  b.gridspecZ.grid
+0000dc10: 7370 6563 723e 0100 005a 1c6d 6174 706c  specr>...Z.matpl
+0000dc20: 6f74 6c69 625f 7363 616c 6562 6172 2e73  otlib_scalebar.s
+0000dc30: 6361 6c65 6261 7272 4501 0000 7241 0100  calebarrE...rA..
+0000dc40: 0072 4e00 0000 5a0a 6461 736b 2e61 7272  .rN...Z.dask.arr
+0000dc50: 6179 7281 0000 0072 4b00 0000 5a10 6461  ayr....rK...Z.da
+0000dc60: 736b 2e64 6973 7472 6962 7574 6564 5a0b  sk.distributedZ.
+0000dc70: 6469 7374 7269 6275 7465 6472 4700 0000  distributedrG...
+0000dc80: 729a 0000 0072 1500 0000 7223 0000 0072  r....r....r#...r
+0000dc90: 2c00 0000 7238 0000 0072 4000 0000 7242  ,...r8...r@...rB
+0000dca0: 0000 0072 5e00 0000 7267 0000 0072 6a00  ...r^...rg...rj.
+0000dcb0: 0000 7280 0000 0072 8300 0000 728c 0000  ..r....r....r...
+0000dcc0: 0072 9100 0000 7296 0000 0072 ac00 0000  .r....r....r....
+0000dcd0: 72d3 0000 0072 d600 0000 72d7 0000 0072  r....r....r....r
+0000dce0: d800 0000 72df 0000 0072 e300 0000 72e7  ....r....r....r.
+0000dcf0: 0000 0072 e800 0000 72ec 0000 0072 ee00  ...r....r....r..
+0000dd00: 0000 72ef 0000 0072 9c00 0000 72ff 0000  ..r....r....r...
+0000dd10: 0072 0c01 0000 720f 0100 0072 1801 0000  .r....r....r....
+0000dd20: 721f 0100 0072 4701 0000 724c 0100 0072  r....rG...rL...r
+0000dd30: 0f00 0000 720f 0000 0072 0f00 0000 7210  ....r....r....r.
+0000dd40: 0000 00da 083c 6d6f 6475 6c65 3e01 0000  .....<module>...
+0000dd50: 0073 9200 0000 0800 0c01 0c01 0c01 0c01  .s..............
+0000dd60: 0c01 0c01 0801 0801 0c01 0c01 0c01 0801  ................
+0000dd70: 0c01 0c01 0801 0a03 0825 082d 0818 080f  .........%.-....
+0000dd80: 080e 0810 081d 0a27 0a42 082b 0a2d 020e  .......'.B.+.-..
+0000dd90: 0aff 0843 0a13 0275 0201 0201 0201 0201  ...C...u........
+0000dda0: 0af6 007f 0219 0aff 0a27 0821 0a09 0a30  .........'.!...0
+0000ddb0: 0845 0a0f 0a32 0a2f 080b 020f 0201 0401  .E...2./........
+0000ddc0: 0201 0201 0201 0201 0201 0201 0201 0201  ................
+0000ddd0: 0af3 007f 007f 0836 023e 0aff 0a63 0848  .......6.>...c.H
+0000dde0: 026d 0aff 007f 0e24                      .m.....$
```

## Comparing `stemtool/sim/__pycache__/multislice.cpython-39.pyc` & `stemtool/sim/__pycache__/multislice.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Sat Nov  6 00:05:42 2021 UTC, .py size: 16438 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 3% similar despite different names*

```diff
@@ -1,73 +1,73 @@
-00000000: 610d 0d0a 0000 0000 d6c6 8561 3640 0000  a..........a6@..
+00000000: 6f0d 0d0a 0000 0000 fa75 6f64 3340 0000  o........uod3@..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 b800 0000 6400  .....@...s....d.
+00000020: 0003 0000 0040 0000 0073 be00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 6d03 5a04  d.l.Z.d.d.l.m.Z.
 00000040: 0100 6400 6401 6c05 5a05 6400 6401 6c06  ..d.d.l.Z.d.d.l.
 00000050: 5a07 6402 6403 8400 5a08 6404 6405 8400  Z.d.d...Z.d.d...
 00000060: 5a09 6406 6407 8400 5a0a 6408 6409 8400  Z.d.d...Z.d.d...
 00000070: 5a0b 640a 640b 8400 5a0c 6428 640c 640d  Z.d.d...Z.d(d.d.
-00000080: 8401 5a0d 6429 640e 640f 8401 5a0e 642a  ..Z.d)d.d...Z.d*
-00000090: 6413 6414 8401 5a0f 6415 6416 8400 5a10  d.d...Z.d.d...Z.
-000000a0: 6417 6418 8400 5a11 6419 641a 8400 5a12  d.d...Z.d.d...Z.
-000000b0: 641b 641c 8400 5a13 642b 641e 641f 8401  d.d...Z.d+d.d...
-000000c0: 5a14 6420 6421 8400 5a15 6422 6423 8400  Z.d d!..Z.d"d#..
-000000d0: 5a16 6424 6425 8400 5a17 6426 6427 8400  Z.d$d%..Z.d&d'..
-000000e0: 5a18 6401 5300 292c e900 0000 004e 6301  Z.d.S.),.....Nc.
-000000f0: 0000 0000 0000 0000 0000 0009 0000 0004  ................
-00000100: 0000 0043 0000 0073 5c00 0000 6401 7d01  ...C...s\...d.}.
-00000110: 6402 7d02 6403 7d03 6404 7d04 7c00 6405  d.}.d.}.d.}.|.d.
-00000120: 1400 7d05 7c04 6406 1300 7c03 6406 1300  ..}.|.d...|.d...
-00000130: 1400 7d06 7c02 7c05 1400 6406 7c01 1400  ..}.|.|...d.|...
-00000140: 7c03 6406 1300 1400 7c02 7c05 1400 1700  |.d.....|.|.....
-00000150: 1400 7d07 6407 7c06 7c07 1b00 6408 1300  ..}.d.|.|...d...
-00000160: 1400 7d08 7c08 5300 2909 61bd 0100 000a  ..}.|.S.).a.....
-00000170: 2020 2020 4361 6c63 756c 6174 6573 2074      Calculates t
-00000180: 6865 2072 656c 6174 6976 6973 7469 6320  he relativistic 
-00000190: 656c 6563 7472 6f6e 2077 6176 656c 656e  electron wavelen
-000001a0: 6774 680a 2020 2020 696e 2061 6e67 7374  gth.    in angst
-000001b0: 726f 6d73 2062 6173 6564 206f 6e20 7468  roms based on th
-000001c0: 6520 6d69 6372 6f73 636f 7065 2061 6363  e microscope acc
-000001d0: 656c 6572 6174 696e 670a 2020 2020 766f  elerating.    vo
-000001e0: 6c74 6167 650a 0a20 2020 2050 6172 616d  ltage..    Param
-000001f0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00000200: 2d2d 2d2d 0a20 2020 2076 6f6c 7461 6765  ----.    voltage
-00000210: 5f6b 563a 2066 6c6f 6174 0a20 2020 2020  _kV: float.     
-00000220: 2020 2020 2020 2020 2020 206d 6963 726f             micro
-00000230: 7363 6f70 6520 6f70 6572 6174 696e 6720  scope operating 
-00000240: 766f 6c74 6167 6520 696e 206b 696c 6f0a  voltage in kilo.
-00000250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000260: 656c 6563 7472 6f6e 566f 6c74 730a 0a20  electronVolts.. 
-00000270: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00000280: 2d2d 2d2d 2d2d 0a20 2020 2077 6176 656c  ------.    wavel
-00000290: 656e 6774 683a 2066 6c6f 6174 0a20 2020  ength: float.   
-000002a0: 2020 2020 2020 2020 2020 2020 2072 656c               rel
-000002b0: 6174 6976 6973 7469 6320 656c 6563 7472  ativistic electr
-000002c0: 6f6e 2077 6176 656c 656e 6774 6820 696e  on wavelength in
-000002d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000002e0: 2061 6e67 7374 726f 6d73 0a0a 2020 2020   angstroms..    
-000002f0: 3a41 7574 686f 7273 3a0a 2020 2020 4465  :Authors:.    De
-00000300: 6261 6e67 7368 7520 4d75 6b68 6572 6a65  bangshu Mukherje
-00000310: 6520 3c6d 756b 6865 726a 6565 6440 6f72  e <mukherjeed@or
-00000320: 6e6c 2e67 6f76 3e0a 2020 2020 e7a6 cad7  nl.gov>.    ....
-00000330: b0dc 79b2 39e7 db17 aa83 daa4 073c e94a  ..y.9........<.J
-00000340: 78de 11e7 2d1a 8ed3 0b86 0b39 e9e8 0300  x...-......9....
-00000350: 00e9 0200 0000 ec03 0000 0000 6417 2809  ............d.(.
-00000360: 00e7 0000 0000 0000 e03f a900 2909 da0a  .........?..)...
-00000370: 766f 6c74 6167 655f 6b56 da01 6dda 0165  voltage_kV..m..e
-00000380: da01 63da 0168 da07 766f 6c74 6167 65da  ..c..h..voltage.
-00000390: 096e 756d 6572 6174 6f72 da0b 6465 6e6f  .numerator..deno
-000003a0: 6d69 6e61 746f 72da 0e77 6176 656c 656e  minator..wavelen
-000003b0: 6774 685f 616e 6772 0a00 0000 720a 0000  gth_angr....r...
-000003c0: 00fa 3d62 7569 6c64 2f62 6469 7374 2e6d  ..=build/bdist.m
-000003d0: 6163 6f73 782d 3130 2e39 2d78 3836 5f36  acosx-10.9-x86_6
+00000080: 8401 5a0d 6428 640e 640f 8401 5a0e 0910  ..Z.d(d.d...Z...
+00000090: 0911 0912 6429 6413 6414 8401 5a0f 6415  ....d)d.d...Z.d.
+000000a0: 6416 8400 5a10 6417 6418 8400 5a11 6419  d...Z.d.d...Z.d.
+000000b0: 641a 8400 5a12 641b 641c 8400 5a13 642a  d...Z.d.d...Z.d*
+000000c0: 641e 641f 8401 5a14 6420 6421 8400 5a15  d.d...Z.d d!..Z.
+000000d0: 6422 6423 8400 5a16 6424 6425 8400 5a17  d"d#..Z.d$d%..Z.
+000000e0: 6426 6427 8400 5a18 6401 5300 292b e900  d&d'..Z.d.S.)+..
+000000f0: 0000 004e 6301 0000 0000 0000 0000 0000  ...Nc...........
+00000100: 0009 0000 0004 0000 0043 0000 0073 5c00  .........C...s\.
+00000110: 0000 6401 7d01 6402 7d02 6403 7d03 6404  ..d.}.d.}.d.}.d.
+00000120: 7d04 7c00 6405 1400 7d05 7c04 6406 1300  }.|.d...}.|.d...
+00000130: 7c03 6406 1300 1400 7d06 7c02 7c05 1400  |.d.....}.|.|...
+00000140: 6406 7c01 1400 7c03 6406 1300 1400 7c02  d.|...|.d.....|.
+00000150: 7c05 1400 1700 1400 7d07 6407 7c06 7c07  |.......}.d.|.|.
+00000160: 1b00 6408 1300 1400 7d08 7c08 5300 2909  ..d.....}.|.S.).
+00000170: 61bd 0100 000a 2020 2020 4361 6c63 756c  a.....    Calcul
+00000180: 6174 6573 2074 6865 2072 656c 6174 6976  ates the relativ
+00000190: 6973 7469 6320 656c 6563 7472 6f6e 2077  istic electron w
+000001a0: 6176 656c 656e 6774 680a 2020 2020 696e  avelength.    in
+000001b0: 2061 6e67 7374 726f 6d73 2062 6173 6564   angstroms based
+000001c0: 206f 6e20 7468 6520 6d69 6372 6f73 636f   on the microsco
+000001d0: 7065 2061 6363 656c 6572 6174 696e 670a  pe accelerating.
+000001e0: 2020 2020 766f 6c74 6167 650a 0a20 2020      voltage..   
+000001f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00000200: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2076  ----------.    v
+00000210: 6f6c 7461 6765 5f6b 563a 2066 6c6f 6174  oltage_kV: float
+00000220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000230: 206d 6963 726f 7363 6f70 6520 6f70 6572   microscope oper
+00000240: 6174 696e 6720 766f 6c74 6167 6520 696e  ating voltage in
+00000250: 206b 696c 6f0a 2020 2020 2020 2020 2020   kilo.          
+00000260: 2020 2020 2020 656c 6563 7472 6f6e 566f        electronVo
+00000270: 6c74 730a 0a20 2020 2052 6574 7572 6e73  lts..    Returns
+00000280: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00000290: 2077 6176 656c 656e 6774 683a 2066 6c6f   wavelength: flo
+000002a0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+000002b0: 2020 2072 656c 6174 6976 6973 7469 6320     relativistic 
+000002c0: 656c 6563 7472 6f6e 2077 6176 656c 656e  electron wavelen
+000002d0: 6774 6820 696e 0a20 2020 2020 2020 2020  gth in.         
+000002e0: 2020 2020 2020 2061 6e67 7374 726f 6d73         angstroms
+000002f0: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
+00000300: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
+00000310: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
+00000320: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 2020  eed@ornl.gov>.  
+00000330: 2020 e7a6 cad7 b0dc 79b2 39e7 db17 aa83    ......y.9.....
+00000340: daa4 073c e94a 78de 11e7 2d1a 8ed3 0b86  ...<.Jx...-.....
+00000350: 0b39 e9e8 0300 00e9 0200 0000 ec03 0000  .9..............
+00000360: 0000 6417 2809 00e7 0000 0000 0000 e03f  ..d.(..........?
+00000370: a900 2909 da0a 766f 6c74 6167 655f 6b56  ..)...voltage_kV
+00000380: da01 6dda 0165 da01 63da 0168 da07 766f  ..m..e..c..h..vo
+00000390: 6c74 6167 65da 096e 756d 6572 6174 6f72  ltage..numerator
+000003a0: da0b 6465 6e6f 6d69 6e61 746f 72da 0e77  ..denominator..w
+000003b0: 6176 656c 656e 6774 685f 616e 6772 0a00  avelength_angr..
+000003c0: 0000 720a 0000 00fa 3762 7569 6c64 2f62  ..r.....7build/b
+000003d0: 6469 7374 2e6c 696e 7578 2d78 3836 5f36  dist.linux-x86_6
 000003e0: 342f 6567 672f 7374 656d 746f 6f6c 2f73  4/egg/stemtool/s
 000003f0: 696d 2f6d 756c 7469 736c 6963 652e 7079  im/multislice.py
-00000400: 7213 0000 0007 0000 0073 1200 0000 0015  r........s......
-00000410: 0401 0401 0401 0401 0801 1001 2001 1001  ............ ...
+00000400: 7213 0000 0007 0000 0073 1200 0000 0415  r........s......
+00000410: 0401 0401 0401 0801 1001 2001 1001 0401  .......... .....
 00000420: 7213 0000 0063 0200 0000 0000 0000 0000  r....c..........
 00000430: 0000 0b00 0000 0400 0000 4300 0000 73c0  ..........C...s.
 00000440: 0000 0064 017d 0264 027d 0364 037d 0464  ...d.}.d.}.d.}.d
 00000450: 047d 057c 0564 0513 007c 0464 0513 0014  .}.|.d...|.d....
 00000460: 007d 067c 037c 0114 0064 0614 0064 057c  .}.|.|...d...d.|
 00000470: 0214 007c 0464 0513 0014 007c 037c 0114  ...|.d.....|.|..
 00000480: 0064 0614 0017 0014 007d 0764 077c 067c  .d.......}.d.|.|
@@ -119,17 +119,17 @@
 00000760: 7479 7065 da09 636f 6d70 6c65 7836 3429  type..complex64)
 00000770: 0b5a 0970 6f74 5f73 6c69 6365 720b 0000  .Z.pot_slicer...
 00000780: 005a 036d 5f65 5a03 655f 6572 0e00 0000  .Z.m_eZ.e_er....
 00000790: 720f 0000 0072 1100 0000 7212 0000 0072  r....r....r....r
 000007a0: 1300 0000 da05 7369 676d 615a 0574 7261  ......sigmaZ.tra
 000007b0: 6e73 720a 0000 0072 0a00 0000 7214 0000  nsr....r....r...
 000007c0: 00da 1174 7261 6e73 6d69 7373 696f 6e5f  ...transmission_
-000007d0: 6675 6e63 2700 0000 7324 0000 0000 1704  func'...s$......
-000007e0: 0104 0104 0104 0110 010a 011a ff04 0302  ................
-000007f0: 010a ff04 0414 0116 ff02 021a fd04 0412  ................
+000007d0: 6675 6e63 2700 0000 7324 0000 0004 1704  func'...s$......
+000007e0: 0104 0104 0110 010a 011a 0104 ff02 030a  ................
+000007f0: 0104 ff14 0416 0102 ff1a 0204 fd12 040c  ................
 00000800: 0172 1c00 0000 6304 0000 0000 0000 0000  .r....c.........
 00000810: 0000 0012 0000 0005 0000 0043 0000 0073  ...........C...s
 00000820: 0001 0000 7c00 6401 1900 7c03 1400 7d04  ....|.d...|...}.
 00000830: 7c00 6402 1900 7c03 1400 7d05 7400 a001  |.d...|...}.t...
 00000840: 7c00 6401 1900 0b00 6403 1b00 7c00 6401  |.d.....d...|.d.
 00000850: 1900 6403 1b00 6402 a103 7c04 1b00 7d06  ..d...d...|...}.
 00000860: 7400 a001 7c00 6402 1900 0b00 6403 1b00  t...|.d.....d...
@@ -203,17 +203,17 @@
 00000ca0: 565f 78da 0271 79da 0271 78da 0973 6869  V_x..qy..qx..shi
 00000cb0: 6674 6572 5f79 da09 7368 6966 7465 725f  fter_y..shifter_
 00000cc0: 78da 024c 79da 024c 78da 034c 7961 da03  x..Ly..Lx..Lya..
 00000cd0: 4c78 61da 024c 3272 1300 0000 da04 7072  Lxa..L2r......pr
 00000ce0: 6f70 5a0a 7072 6f70 5f73 6869 6674 720a  opZ.prop_shiftr.
 00000cf0: 0000 0072 0a00 0000 7214 0000 00da 1070  ...r....r......p
 00000d00: 726f 7061 6761 7469 6f6e 5f66 756e 6351  ropagation_funcQ
-00000d10: 0000 0073 1c00 0000 0019 0c01 0c01 2401  ...s..........$.
-00000d20: 2401 1001 1001 0c01 0c01 1001 1801 0c01  $...............
-00000d30: 1c01 0c01 7233 0000 0063 0200 0000 0000  ....r3...c......
+00000d10: 0000 0073 1c00 0000 0c19 0c01 2401 2401  ...s........$.$.
+00000d20: 1001 1001 0c01 0c01 1001 1801 0c01 1c01  ................
+00000d30: 0c01 0c01 7233 0000 0063 0200 0000 0000  ....r3...c......
 00000d40: 0000 0000 0000 0b00 0000 0500 0000 4300  ..............C.
 00000d50: 0000 7394 0000 007c 0164 0119 007c 0014  ..s....|.d...|..
 00000d60: 007d 0274 00a0 017c 0164 0119 000b 0064  .}.t...|.d.....d
 00000d70: 021b 007c 0164 0119 0064 021b 0064 03a1  ...|.d...d...d..
 00000d80: 037c 021b 007d 0374 027c 0164 0119 0064  .|...}.t.|.d...d
 00000d90: 021b 0083 017d 0474 00a0 037c 037c 04a1  .....}.t...|.|..
 00000da0: 027d 0574 00a0 047c 057c 05a1 025c 027d  .}.t...|.|...\.}
@@ -227,16 +227,16 @@
 00000e20: 0000 290b da0b 6361 6c69 6272 6174 696f  ..)...calibratio
 00000e30: 6eda 0873 697a 6562 6561 6d5a 0346 4f56  n..sizebeamZ.FOV
 00000e40: 722a 0000 005a 0773 6869 6674 6572 722e  r*...Z.shifterr.
 00000e50: 0000 0072 2f00 0000 7230 0000 0072 3100  ...r/...r0...r1.
 00000e60: 0000 5a02 4c31 5a02 644c 720a 0000 0072  ..Z.L1Z.dLr....r
 00000e70: 0a00 0000 7214 0000 00da 0d46 6f75 7269  ....r......Fouri
 00000e80: 6572 436f 6f72 6473 7a00 0000 7312 0000  erCoordsz...s...
-00000e90: 0000 010c 0124 0110 010c 0110 0118 0108  .....$..........
-00000ea0: 0110 0172 3600 0000 6302 0000 0000 0000  ...r6...c.......
+00000e90: 000c 0124 0110 010c 0110 0118 0108 0110  ...$............
+00000ea0: 0108 0172 3600 0000 6302 0000 0000 0000  ...r6...c.......
 00000eb0: 0000 0000 000c 0000 0005 0000 0043 0000  .............C..
 00000ec0: 0073 c600 0000 7c01 6401 1900 7c00 1400  .s....|.d...|...
 00000ed0: 7d02 7c01 6402 1900 7c00 1400 7d03 7400  }.|.d...|...}.t.
 00000ee0: a001 7c01 6401 1900 0b00 6403 1b00 7c01  ..|.d.....d...|.
 00000ef0: 6401 1900 6403 1b00 6402 a103 7c02 1b00  d...d...d...|...
 00000f00: 7d04 7400 a001 7c01 6402 1900 0b00 6403  }.t...|.d.....d.
 00000f10: 1b00 7c01 6402 1900 6403 1b00 6402 a103  ..|.d...d...d...
@@ -252,16 +252,16 @@
 00000fb0: 2100 0000 da07 6173 6172 7261 7929 0c72  !.....asarray).r
 00000fc0: 3400 0000 7235 0000 0072 2700 0000 7228  4...r5...r'...r(
 00000fd0: 0000 0072 2900 0000 722a 0000 0072 2b00  ...r)...r*...r+.
 00000fe0: 0000 722c 0000 0072 2d00 0000 722e 0000  ..r,...r-...r...
 00000ff0: 005a 0464 4c5f 795a 0464 4c5f 7872 0a00  .Z.dL_yZ.dL_xr..
 00001000: 0000 720a 0000 0072 1400 0000 da0c 466f  ..r....r......Fo
 00001010: 7572 6965 7243 616c 6962 8600 0000 7316  urierCalib....s.
-00001020: 0000 0000 010c 010c 0124 0124 0110 0110  .........$.$....
-00001030: 010c 010c 0110 0110 0172 3800 0000 6307  .........r8...c.
+00001020: 0000 000c 010c 0124 0124 0110 0110 010c  .......$.$......
+00001030: 010c 0110 0110 010e 0172 3800 0000 6307  .........r8...c.
 00001040: 0000 0000 0000 0000 0000 001b 0000 0006  ................
 00001050: 0000 0043 0000 0073 4401 0000 7c00 6401  ...C...sD...|.d.
 00001060: 1b00 7d00 7400 7c01 8301 7d07 7c00 7c07  ..}.t.|...}.|.|.
 00001070: 1b00 7d08 7c02 6402 1900 7d09 7c02 6403  ..}.|.d...}.|.d.
 00001080: 1900 7d0a 7c0a 6404 1400 7c03 1400 7d0b  ..}.|.d...|...}.
 00001090: 7c09 6404 1400 7c03 1400 7d0c 7401 a002  |.d...|...}.t...
 000010a0: 7c0a 0b00 6405 1b00 7c0a 6405 1b00 6403  |...d...|.d...d.
@@ -316,17 +316,17 @@
 000013b0: 7273 655f 7265 616c 5f6d 6174 7269 785a  rse_real_matrixZ
 000013c0: 1766 6f75 7269 6572 5f73 6361 6e5f 636f  .fourier_scan_co
 000013d0: 6f72 6469 6e61 7465 5a05 4164 6973 74da  ordinateZ.Adist.
 000013e0: 0963 6869 5f70 726f 6265 5a10 7072 6f62  .chi_probeZ.prob
 000013f0: 655f 7265 616c 5f73 7061 6365 720a 0000  e_real_spacer...
 00001400: 0072 0a00 0000 7214 0000 00da 0a6d 616b  .r....r......mak
 00001410: 655f 7072 6f62 6594 0000 0073 2c00 0000  e_probe....s,...
-00001420: 0007 0801 0801 0801 0801 0801 0c01 0c01  ................
-00001430: 1c01 1001 1c01 1001 0c01 0c01 1001 1801  ................
-00001440: 0801 1001 1201 1001 1201 1401 7243 0000  ............rC..
+00001420: 0807 0801 0801 0801 0801 0c01 0c01 1c01  ................
+00001430: 1001 1c01 1001 0c01 0c01 1001 1801 0801  ................
+00001440: 1001 1201 1001 1201 1401 0c01 7243 0000  ............rC..
 00001450: 0063 0500 0000 0000 0000 0000 0000 0800  .c..............
 00001460: 0000 0600 0000 4300 0000 7362 0000 007c  ......C...sb...|
 00001470: 017c 0014 007d 057c 0274 00a0 017c 0564  .|...}.|.t...|.d
 00001480: 01a1 0214 0064 011b 007c 0364 0214 0074  .....d...|.d...t
 00001490: 00a0 017c 0564 03a1 0214 0064 031b 0017  ...|.d.....d....
 000014a0: 007c 0464 0214 0074 00a0 017c 0564 04a1  .|.d...t...|.d..
 000014b0: 0214 0064 041b 0017 007d 0664 0174 006a  ...d.....}.d.t.j
@@ -335,16 +335,16 @@
 000014e0: 6341 e904 0000 00e9 0600 0000 2903 7216  cA..........).r.
 000014f0: 0000 00da 0570 6f77 6572 7217 0000 0029  .....powerr....)
 00001500: 085a 0d66 6f75 7269 6572 5f63 6f6f 7264  .Z.fourier_coord
 00001510: 7213 0000 0072 3f00 0000 7240 0000 0072  r....r?...r@...r
 00001520: 4100 0000 5a08 705f 6d61 7472 6978 da03  A...Z.p_matrix..
 00001530: 6368 6972 4200 0000 720a 0000 0072 0a00  chirB...r....r..
 00001540: 0000 7214 0000 0072 3c00 0000 b300 0000  ..r....r<.......
-00001550: 7312 0000 0000 0108 0212 0116 ff02 0216  s...............
-00001560: fe02 ff02 0512 0172 3c00 0000 e910 0000  .......r<.......
+00001550: 7312 0000 0008 0112 0216 0102 ff16 0202  s...............
+00001560: fe02 ff12 0504 0172 3c00 0000 e910 0000  .......r<.......
 00001570: 0072 4400 0000 fa17 4b69 726b 6c61 6e64  .rD.....Kirkland
 00001580: 5f50 6f74 656e 7469 616c 732e 6e70 7963  _Potentials.npyc
 00001590: 0500 0000 0000 0000 0000 0000 1700 0000  ................
 000015a0: 0f00 0000 4300 0000 7346 0200 0064 017d  ....C...sF...d.}
 000015b0: 0564 027d 0664 0374 006a 0164 0413 0014  .d.}.d.t.j.d....
 000015c0: 007c 0514 007c 0614 007d 0764 0474 006a  .|...|...}.d.t.j
 000015d0: 0164 0413 0014 007c 0514 007c 0614 007d  .d.....|...|...}
@@ -487,359 +487,358 @@
 00001e60: 7375 625a 086b 6972 6b5f 6675 6e5a 0279  subZ.kirk_funZ.y
 00001e70: 615a 0278 615a 0272 32da 0172 5a05 7061  aZ.xaZ.r2..rZ.pa
 00001e80: 7274 315a 0570 6172 7432 5a05 7373 706f  rt1Z.part2Z.sspo
 00001e90: 745a 0966 696e 616c 7369 7a65 5a08 7373  tZ.finalsizeZ.ss
 00001ea0: 706f 745f 696d 5a09 706f 7465 6e74 6961  pot_imZ.potentia
 00001eb0: 6c72 0a00 0000 720a 0000 0072 1400 0000  lr....r....r....
 00001ec0: da10 6174 6f6d 6963 5f70 6f74 656e 7469  ..atomic_potenti
-00001ed0: 616c be00 0000 7354 0000 0000 2e04 0104  al....sT........
-00001ee0: 0116 0116 010a 0114 0114 0114 0110 0118  ................
-00001ef0: 010c 010a 010a 010a 0102 0104 0106 0128  ...............(
-00001f00: fe02 0404 0106 0128 fe02 fc02 0804 0106  .......(........
-00001f10: 0128 fe02 f802 ff04 0e02 012c 012c ff02  .(.........,.,..
-00001f20: 022c fe02 ff04 0508 0116 010c 0118 0172  .,.............r
+00001ed0: 616c be00 0000 7354 0000 0004 2e04 0116  al....sT........
+00001ee0: 0116 010a 0114 0114 0114 0110 0118 010c  ................
+00001ef0: 010a 010a 010a 0102 0104 0106 0128 0102  .............(..
+00001f00: fe04 0406 0128 0102 fe02 fc04 0806 0128  .....(.........(
+00001f10: 0102 fe02 f804 ff02 0e2c 012c 0102 ff2c  .........,.,...,
+00001f20: 0202 fe04 ff08 0516 010c 0118 0104 0172  ...............r
 00001f30: 5900 0000 6302 0000 0000 0000 0000 0000  Y...c...........
 00001f40: 0008 0000 0009 0000 0043 0000 0073 f800  .........C...s..
-00001f50: 0000 7400 a001 7c00 a101 7d02 7402 a003  ..t...|...}.t...
-00001f60: 7404 7c02 8301 a101 4400 5d74 7d03 7405  t.|.....D.]t}.t.
-00001f70: 7404 7c01 8301 8301 4400 5d62 7d04 7c00  t.|.....D.]b}.|.
+00001f50: 0000 7400 a001 7c00 a101 7d02 7400 a002  ..t...|...}.t...
+00001f60: 7403 7c02 8301 a101 4400 5d3a 7d03 7404  t.|.....D.]:}.t.
+00001f70: 7403 7c01 8301 8301 4400 5d31 7d04 7c00  t.|.....D.]1}.|.
 00001f80: 7c03 6400 6400 8502 6602 1900 7c01 7c04  |.d.d...f...|.|.
 00001f90: 6400 6400 8502 6602 1900 1b00 7d05 7c05  d.d...f.....}.|.
 00001fa0: 7c05 6401 6b00 0500 1900 6402 3700 0300  |.d.k.....d.7...
-00001fb0: 3c00 6401 7c05 7c05 7400 6a06 6b02 3c00  <.d.|.|.t.j.k.<.
+00001fb0: 3c00 6401 7c05 7c05 7400 6a05 6b02 3c00  <.d.|.|.t.j.k.<.
 00001fc0: 7c05 7c05 6403 6b04 1900 0100 7c05 7c04  |.|.d.k.....|.|.
-00001fd0: 1900 7c02 7c03 7c04 6602 3c00 7128 7118  ..|.|.|.f.<.q(q.
+00001fd0: 1900 7c02 7c03 7c04 6602 3c00 7114 710c  ..|.|.|.f.<.q.q.
 00001fe0: 7c02 6401 6b03 7d06 6402 7c02 7c06 1900  |.d.k.}.d.|.|...
-00001ff0: 1b00 7d07 7400 a007 7c07 7400 a008 7c07  ..}.t...|.t...|.
-00002000: 7400 a007 7c07 a101 1800 a101 6403 6b00  t...|.......d.k.
-00002010: 1900 a101 7c07 7400 a008 7c07 7400 a007  ....|.t...|.t...
+00001ff0: 1b00 7d07 7400 a006 7c07 7400 a007 7c07  ..}.t...|.t...|.
+00002000: 7400 a006 7c07 a101 1800 a101 6403 6b00  t...|.......d.k.
+00002010: 1900 a101 7c07 7400 a007 7c07 7400 a006  ....|.t...|.t...
 00002020: 7c07 a101 1800 a101 6403 6b00 3c00 6402  |.......d.k.<.d.
 00002030: 7c07 1b00 7c02 7c06 3c00 6401 7c02 7c02  |...|.|.<.d.|.|.
 00002040: 6402 6b02 3c00 7c02 5300 2904 4e72 0100  d.k.<.|.S.).Nr..
 00002050: 0000 721d 0000 0067 fca9 f1d2 4d62 503f  ..r....g....MbP?
-00002060: 2909 7216 0000 0072 5200 0000 5a05 6e75  ).r....rR...Z.nu
-00002070: 6d62 615a 0670 7261 6e67 65da 036c 656e  mbaZ.prange..len
-00002080: da05 7261 6e67 65da 0369 6e66 723a 0000  ..range..infr:..
-00002090: 00da 0361 6273 2908 5a08 6174 6f6d 5f70  ...abs).Z.atom_p
-000020a0: 6f73 da08 6365 6c6c 5f64 696d 5a06 7563  os..cell_dimZ.uc
-000020b0: 5f70 6f73 da02 6969 da02 6a6a da02 6363  _pos..ii..jj..cc
-000020c0: 5a0a 7563 5f6e 6f6e 7a65 726f 5a06 7563  Z.uc_nonzeroZ.uc
-000020d0: 5f69 6e76 720a 0000 0072 0a00 0000 7214  _invr....r....r.
-000020e0: 0000 00da 0b66 696e 645f 7563 5f70 6f73  .....find_uc_pos
-000020f0: 1401 0000 7320 0000 0000 010a 0112 0110  ....s ..........
-00002100: 0120 0114 010e 010c 0114 0108 010c 0104  . ..............
-00002110: 011a ff1c 030c 010c 0172 6200 0000 6301  .........rb...c.
-00002120: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-00002130: 0000 0043 0000 0073 3800 0000 7400 6a01  ...C...s8...t.j.
-00002140: 7c00 7400 6a02 6401 8d02 7d01 6402 7c01  |.t.j.d...}.d.|.
-00002150: 7c00 6402 6b02 3c00 6403 7c00 7c00 6402  |.d.k.<.d.|.|.d.
-00002160: 6b03 1900 1b00 7c01 7c00 6402 6b03 3c00  k.....|.|.d.k.<.
-00002170: 7c01 5300 2904 4e72 3900 0000 7201 0000  |.S.).Nr9...r...
-00002180: 0072 1d00 0000 2903 7216 0000 005a 0a65  .r....).r....Z.e
-00002190: 6d70 7479 5f6c 696b 65da 0566 6c6f 6174  mpty_like..float
-000021a0: 2902 5a06 6d69 6c6c 6572 5a0a 6d69 6c6c  ).Z.millerZ.mill
-000021b0: 6572 5f69 6e76 720a 0000 0072 0a00 0000  er_invr....r....
-000021c0: 7214 0000 00da 0e6d 696c 6c65 725f 696e  r......miller_in
-000021d0: 7665 7273 6527 0100 0073 0800 0000 0001  verse'...s......
-000021e0: 1001 0c01 1801 7264 0000 0063 0300 0000  ......rd...c....
-000021f0: 0000 0000 0000 0000 0600 0000 0700 0000  ................
-00002200: 4300 0000 7338 0000 0074 007c 0083 017d  C...s8...t.|...}
-00002210: 0374 01a0 0274 01a0 037c 02a1 017c 03a1  .t...t...|...|..
-00002220: 027d 0474 01a0 047c 037c 0174 016a 05a0  .}.t...|.|.t.j..
-00002230: 067c 04a1 011b 0014 00a1 017d 057c 0553  .|.........}.|.S
-00002240: 0029 014e 2907 7264 0000 0072 1600 0000  .).N).rd...r....
-00002250: da06 6d61 746d 756c da09 7472 616e 7370  ..matmul..transp
-00002260: 6f73 6572 3a00 0000 5a06 6c69 6e61 6c67  oser:...Z.linalg
-00002270: 5a04 6e6f 726d 2906 da0a 6d69 6c6c 6572  Z.norm)...miller
-00002280: 5f64 6972 da06 6c65 6e67 7468 725e 0000  _dir..lengthr^..
-00002290: 005a 086d 696e 7665 7273 655a 0873 6c69  .Z.minverseZ.sli
-000022a0: 6365 6469 72da 086e 6f5f 6365 6c6c 7372  cedir..no_cellsr
-000022b0: 0a00 0000 720a 0000 0072 1400 0000 da10  ....r....r......
-000022c0: 6765 745f 6e75 6d62 6572 5f63 656c 6c73  get_number_cells
-000022d0: 2e01 0000 7308 0000 0000 0108 0112 011a  ....s...........
-000022e0: 0172 6a00 0000 6303 0000 0000 0000 0000  .rj...c.........
-000022f0: 0000 0014 0000 000a 0000 0043 0000 0073  ...........C...s
-00002300: 2a02 0000 7400 a001 7400 a002 6401 7403  *...t...t...d.t.
-00002310: 7c01 6402 1900 8301 6402 a103 7400 a002  |.d.....d...t...
-00002320: 6401 7403 7c01 6401 1900 8301 6402 a103  d.t.|.d.....d...
-00002330: a102 5c02 7d03 7d04 7c03 a004 a100 7d03  ..\.}.}.|.....}.
-00002340: 7c04 a004 a100 7d04 7400 a002 7400 a005  |.....}.t...t...
-00002350: 7400 a005 7c03 a101 7400 a006 7c04 a101  t...|...t...|...
-00002360: 6602 a101 a101 7d05 7c05 7c00 6401 1900  f.....}.|.|.d...
-00002370: 7c00 6402 1900 1b00 1400 7d06 7400 a007  |.d.......}.t...
-00002380: 7c00 6402 1900 7c03 1400 7c00 6401 1900  |.d...|...|.d...
-00002390: 7c04 1400 1800 a101 7c00 6402 1900 6403  |.......|.d...d.
-000023a0: 1300 7c00 6401 1900 6403 1300 1700 6404  ..|.d...d.....d.
-000023b0: 1300 1b00 7d07 7400 a001 7400 a002 6401  ....}.t...t...d.
-000023c0: 7400 a008 7c02 a101 1800 7403 7c01 6402  t...|.....t.|.d.
-000023d0: 1900 8301 7400 a008 7c02 a101 1700 6402  ....t...|.....d.
-000023e0: a103 7400 a002 6401 7400 a008 7c02 a101  ..t...d.t...|...
-000023f0: 1800 7403 7c01 6401 1900 8301 7400 a008  ..t.|.d.....t...
-00002400: 7c02 a101 1700 6402 a103 a102 5c02 7d08  |.....d.....\.}.
-00002410: 7d09 7c08 a004 a100 7d08 7c09 a004 a100  }.|.....}.|.....
-00002420: 7d09 7400 a007 7c00 6402 1900 7c08 1400  }.t...|.d...|...
-00002430: 7c00 6401 1900 7c09 1400 1800 a101 7c00  |.d...|.......|.
-00002440: 6402 1900 6403 1300 7c00 6401 1900 6403  d...d...|.d...d.
-00002450: 1300 1700 6404 1300 1b00 7d0a 7c09 7c0a  ....d.....}.|.|.
-00002460: 7c02 6b00 1900 7d0b 7c08 7c0a 7c02 6b00  |.k...}.|.|.|.k.
-00002470: 1900 7d0c 7400 a007 7400 a009 7c0c 6401  ..}.t...t...|.d.
-00002480: 1800 7c0b 6401 1800 a102 7400 a009 7c00  ..|.d.....t...|.
-00002490: 6401 1900 7c00 6402 1900 a102 1800 a101  d...|.d.........
-000024a0: 7d0d 7c0b 7c0d 7400 6a0a 6403 1b00 6b00  }.|.|.t.j.d...k.
-000024b0: 1900 7d0e 7c0c 7c0d 7400 6a0a 6403 1b00  ..}.|.|.t.j.d...
-000024c0: 6b00 1900 7d0f 7400 a007 7400 a009 7c0f  k...}.t...t...|.
-000024d0: 6405 1800 7c0e 6406 1800 a102 7400 a009  d...|.d.....t...
-000024e0: 7c00 6401 1900 7c00 6402 1900 a102 1800  |.d...|.d.......
-000024f0: a101 7d10 7c0e 7c10 7400 6a0a 6403 1b00  ..}.|.|.t.j.d...
-00002500: 6b04 1900 7d11 7c0f 7c10 7400 6a0a 6403  k...}.|.|.t.j.d.
-00002510: 1b00 6b04 1900 7d12 7400 a00b 7c12 7c11  ..k...}.t...|.|.
-00002520: 6602 a101 7d13 7c13 a00c a100 5300 2907  f...}.|.....S.).
-00002530: 4e72 0100 0000 721d 0000 0072 0700 0000  Nr....r....r....
-00002540: 7209 0000 00e9 5100 0000 e928 0000 0029  r.....Q....(...)
-00002550: 0d72 1600 0000 7222 0000 0072 1f00 0000  .r....r"...r....
-00002560: 7220 0000 005a 0572 6176 656c da04 616d  r ...Z.ravel..am
-00002570: 6178 da03 6d61 7872 5d00 0000 da04 6365  ax..maxr].....ce
-00002580: 696c 5a07 6172 6374 616e 3272 1700 0000  ilZ.arctan2r....
-00002590: 7237 0000 0072 6600 0000 2914 7267 0000  r7...rf...).rg..
-000025a0: 0072 6900 0000 5a09 6d61 785f 6864 6973  .ri...Z.max_hdis
-000025b0: 74da 0279 795a 0278 785a 0278 705a 0279  t..yyZ.xxZ.xpZ.y
-000025c0: 705a 0f70 6f69 6e74 5f64 6973 7461 6e63  pZ.point_distanc
-000025d0: 6573 5a06 7979 5f6e 6577 5a06 7878 5f6e  esZ.yy_newZ.xx_n
-000025e0: 6577 da05 6469 7374 735a 0c78 785f 6669  ew..distsZ.xx_fi
-000025f0: 7273 7470 6173 735a 0c79 795f 6669 7273  rstpassZ.yy_firs
-00002600: 7470 6173 735a 0b64 6973 745f 616e 676c  tpassZ.dist_angl
-00002610: 6573 5a0d 7878 5f73 6563 6f6e 6470 6173  esZ.xx_secondpas
-00002620: 735a 0d79 795f 7365 636f 6e64 7061 7373  sZ.yy_secondpass
-00002630: 5a0c 6469 7374 5f61 6e67 6c65 7332 5a0c  Z.dist_angles2Z.
-00002640: 7878 5f74 6869 7264 7061 7373 5a0c 7979  xx_thirdpassZ.yy
-00002650: 5f74 6869 7264 7061 7373 da04 7661 6c73  _thirdpass..vals
-00002660: 720a 0000 0072 0a00 0000 7214 0000 00da  r....r....r.....
-00002670: 0b73 6c61 6262 696e 675f 3244 3501 0000  .slabbing_2D5...
-00002680: 734a 0000 0000 0104 0128 ff08 0308 0108  sJ.......(......
-00002690: 0120 0114 011c 011a ff04 0304 0128 0128  . ...........(.(
-000026a0: fe08 0408 0108 011c 011a ff04 030c 010c  ................
-000026b0: 0104 0112 0112 ff02 ff04 0412 0112 0104  ................
-000026c0: 0112 0112 ff02 ff04 0412 0112 010e 0172  ...............r
-000026d0: 7300 0000 7209 0000 0063 0300 0000 0000  s...r....c......
-000026e0: 0000 0000 0000 0700 0000 0300 0000 4300  ..............C.
-000026f0: 0000 733c 0000 0074 00a0 017c 00a1 017d  ..s<...t...|...}
-00002700: 0374 00a0 027c 03a1 017d 047c 037c 027c  .t...|...}.|.|.|
-00002710: 0414 006b 047d 0574 00a0 037c 05a1 0174  ...k.}.t...|...t
-00002720: 006a 041b 0064 0113 007d 067c 067c 0114  .j...d...}.|.|..
-00002730: 0053 0029 024e 7209 0000 0029 0572 1600  .S.).Nr....).r..
-00002740: 0000 725d 0000 0072 6d00 0000 da03 7375  ..r]...rm.....su
-00002750: 6d72 1700 0000 2907 5a07 7072 6f62 6532  mr....).Z.probe2
-00002760: 44da 0570 7369 7a65 da01 78da 0270 325a  D..psize..x..p2Z
-00002770: 0470 6d61 785a 0270 725a 0672 6164 6975  .pmaxZ.prZ.radiu
-00002780: 7372 0a00 0000 720a 0000 0072 1400 0000  sr....r....r....
-00002790: da04 6677 786d 5b01 0000 730a 0000 0000  ..fwxm[...s.....
-000027a0: 010a 010a 010c 0114 0172 7800 0000 6304  .........rx...c.
-000027b0: 0000 0000 0000 0000 0000 0008 0000 0006  ................
-000027c0: 0000 0043 0000 0073 5200 0000 7400 a001  ...C...sR...t...
-000027d0: 7c00 6a02 a101 7d04 7c01 7c04 6401 1b00  |.j...}.|.|.d...
-000027e0: 1800 7d05 7400 a003 7c03 7c05 6402 1900  ..}.t...|.|.d...
-000027f0: 1400 7c02 7c05 6403 1900 1400 1700 a101  ..|.|.d.........
-00002800: 7d06 7400 6a04 a005 7c06 7400 6a04 a006  }.t.j...|.t.j...
-00002810: 7c00 a101 1400 a101 7d07 7c07 5300 2904  |.......}.|.S.).
-00002820: 4e72 0700 0000 721d 0000 0072 0100 0000  Nr....r....r....
-00002830: 2907 7216 0000 0072 3700 0000 7254 0000  ).r....r7...rT..
-00002840: 0072 1800 0000 7226 0000 0072 3d00 0000  .r....r&...r=...
-00002850: da04 6666 7432 2908 da05 7072 6f62 65da  ..fft2)...probe.
-00002860: 0370 6f73 5a06 666d 6573 6879 5a06 666d  .posZ.fmeshyZ.fm
-00002870: 6573 6878 723e 0000 005a 0772 656c 5f70  eshxr>...Z.rel_p
-00002880: 6f73 5a08 6d6f 7665 5f6d 6174 da0b 6d6f  osZ.move_mat..mo
-00002890: 7665 645f 7072 6f62 6572 0a00 0000 720a  ved_prober....r.
-000028a0: 0000 0072 1400 0000 da0f 6d6f 7665 5f70  ...r......move_p
-000028b0: 726f 6265 5f6d 6573 6863 0100 0073 0a00  robe_meshc...s..
-000028c0: 0000 0001 0c01 0c01 1e01 1801 727d 0000  ............r}..
-000028d0: 0063 0200 0000 0000 0000 0000 0000 0400  .c..............
-000028e0: 0000 0800 0000 4300 0000 7354 0000 0074  ......C...sT...t
-000028f0: 006a 017c 016a 0264 0119 0074 006a 0364  .j.|.j.d...t.j.d
-00002900: 028d 027d 0274 00a0 047c 016a 0264 0119  ...}.t...|.j.d..
-00002910: 00a1 0144 005d 287d 0374 00a0 057c 007c  ...D.](}.t...|.|
-00002920: 0164 0064 0085 0264 0064 0085 027c 0366  .d.d...d.d...|.f
-00002930: 0319 0019 00a1 017c 027c 033c 0071 267c  .......|.|.<.q&|
-00002940: 0253 0029 034e e9ff ffff ff72 3900 0000  .S.).N.....r9...
-00002950: 2906 7216 0000 00da 057a 6572 6f73 7254  ).r......zerosrT
-00002960: 0000 005a 0766 6c6f 6174 3332 721f 0000  ...Z.float32r...
-00002970: 0072 7400 0000 2904 da0c 6362 6564 5f70  .rt...)...cbed_p
-00002980: 6174 7465 726e 5a08 6465 7465 6374 6f72  atternZ.detector
-00002990: da03 7661 6c72 5f00 0000 720a 0000 0072  ..valr_...r....r
-000029a0: 0a00 0000 7214 0000 00da 0a64 6966 665f  ....r......diff_
-000029b0: 746f 5f69 6d6b 0100 0073 0800 0000 0001  to_imk...s......
-000029c0: 1601 1401 2601 7282 0000 0063 0700 0000  ....&.r....c....
-000029d0: 0000 0000 0000 0000 2500 0000 0900 0000  ........%.......
-000029e0: 4300 0000 73d8 0200 007c 0364 0119 007d  C...s....|.d...}
-000029f0: 077c 0364 0219 007d 0874 00a0 017c 077c  .|.d...}.t...|.|
-00002a00: 08a1 025c 027d 087d 0774 00a0 027c 006a  ...\.}.}.t...|.j
-00002a10: 0364 0119 000b 0064 031b 007c 006a 0364  .d.....d...|.j.d
-00002a20: 0119 0064 031b 0064 0218 007c 006a 0364  ...d...d...|.j.d
-00002a30: 0119 00a1 037c 006a 0364 0119 001b 007d  .....|.j.d.....}
-00002a40: 0974 00a0 027c 006a 0364 0219 000b 0064  .t...|.j.d.....d
-00002a50: 031b 007c 006a 0364 0219 0064 031b 0064  ...|.j.d...d...d
-00002a60: 0218 007c 006a 0364 0219 00a1 037c 006a  ...|.j.d.....|.j
-00002a70: 0364 0219 001b 007d 0a74 00a0 017c 0a7c  .d.....}.t...|.|
-00002a80: 09a1 025c 027d 0b7d 0c64 0474 006a 0414  ...\.}.}.d.t.j..
-00002a90: 0064 0514 007c 0b14 00a0 0574 006a 06a1  .d...|.....t.j..
-00002aa0: 017d 0d64 0474 006a 0414 0064 0514 007c  .}.d.t.j...d...|
-00002ab0: 0c14 00a0 0574 006a 06a1 017d 0e7c 0b64  .....t.j...}.|.d
-00002ac0: 0313 007c 0c64 0313 0017 0064 0613 007c  ...|.d.....d...|
-00002ad0: 051b 007d 0f7c 0f74 076a 08a0 097c 06a1  ...}.|.t.j...|..
-00002ae0: 0114 007d 1074 006a 0a7c 106a 0364 0119  ...}.t.j.|.j.d..
-00002af0: 007c 106a 0364 0219 007c 046a 0364 0119  .|.j.d...|.j.d..
-00002b00: 0066 0374 0b64 078d 027d 1174 00a0 0c7c  .f.t.d...}.t...|
-00002b10: 046a 0364 0119 00a1 0144 005d 4c7d 127c  .j.d.....D.]L}.|
-00002b20: 047c 1264 0166 0219 007d 137c 047c 1264  .|.d.f...}.|.|.d
-00002b30: 0266 0219 007d 1474 00a0 0d7c 1364 081b  .f...}.t...|.d..
-00002b40: 007c 106b 007c 107c 1464 081b 006b 00a1  .|.k.|.|.d...k..
-00002b50: 027c 1164 0064 0085 0264 0064 0085 027c  .|.d.d...d.d...|
-00002b60: 1266 033c 0090 0171 3274 0ea0 0f7c 07a1  .f.<...q2t...|..
-00002b70: 017d 1574 0ea0 0f7c 08a1 017d 1674 106a  .}.t...|...}.t.j
-00002b80: 117c 0064 0964 0a8d 027d 1774 106a 117c  .|.d.d...}.t.j.|
-00002b90: 0264 0964 0a8d 027d 1874 106a 117c 0e64  .d.d...}.t.j.|.d
-00002ba0: 0964 0a8d 027d 1974 106a 117c 0d64 0964  .d...}.t.j.|.d.d
-00002bb0: 0a8d 027d 1a74 106a 117c 0164 0964 0a8d  ...}.t.j.|.d.d..
-00002bc0: 027d 1b74 106a 117c 1164 0964 0a8d 027d  .}.t.j.|.d.d...}
-00002bd0: 1c67 007d 1d74 127c 076a 0364 0119 0064  .g.}.t.|.j.d...d
-00002be0: 0b8d 018f bc7d 1e74 00a0 0c7c 076a 0364  .....}.t...|.j.d
-00002bf0: 0119 00a1 0144 005d 9a7d 1f67 007d 2074  .....D.].}.g.} t
-00002c00: 00a0 0c7c 076a 0364 0219 00a1 0144 005d  ...|.j.d.....D.]
-00002c10: 5a7d 2174 13a0 1474 15a1 017c 177c 157c  Z}!t...t...|.|.|
-00002c20: 1f7c 2166 0219 007c 167c 1f7c 2166 0219  .|!f...|.|.|!f..
-00002c30: 0066 027c 197c 1a83 047d 2274 13a0 1474  .f.|.|...}"t...t
-00002c40: 16a1 017c 227c 1b7c 1883 037d 2374 13a0  ...|"|.|...}#t..
-00002c50: 1474 17a1 017c 237c 1c83 027d 247c 20a0  .t...|#|...}$| .
-00002c60: 187c 24a1 0101 0090 0271 2674 00a0 1974  .|$......q&t...t
-00002c70: 136a 1a7c 208e 00a1 017d 207c 1da0 187c  .j.| ....} |...|
-00002c80: 20a1 0101 007c 1ea0 1b64 02a1 0101 0090   ....|...d......
-00002c90: 0271 0e57 0064 0004 0004 0083 0301 006e  .q.W.d.........n
-00002ca0: 1231 0090 0273 c030 0001 0001 0001 0059  .1...s.0.......Y
-00002cb0: 0001 0074 00a0 197c 1da1 017d 1d7c 1d53  ...t...|...}.|.S
-00002cc0: 0029 0c4e 7201 0000 0072 1d00 0000 7207  .).Nr....r....r.
-00002cd0: 0000 00e9 feff ffff 7215 0000 0072 0900  ........r....r..
-00002ce0: 0000 7239 0000 0072 0600 0000 54a9 015a  ..r9...r....T..Z
-00002cf0: 0962 726f 6164 6361 7374 a901 da05 746f  .broadcast....to
-00002d00: 7461 6c29 1c72 1600 0000 7222 0000 00da  tal).r....r"....
-00002d10: 086c 696e 7370 6163 6572 5400 0000 7217  .linspacerT...r.
-00002d20: 0000 0072 1900 0000 721a 0000 0072 2400  ...r....r....r$.
-00002d30: 0000 7225 0000 0072 1300 0000 727f 0000  ..r%...r....r...
-00002d40: 00da 0462 6f6f 6c72 1f00 0000 5a0b 6c6f  ...boolr....Z.lo
-00002d50: 6769 6361 6c5f 616e 64da 0264 61da 0a66  gical_and..da..f
-00002d60: 726f 6d5f 6172 7261 79da 0663 6c69 656e  rom_array..clien
-00002d70: 74da 0773 6361 7474 6572 da04 7471 646d  t..scatter..tqdm
-00002d80: da04 6461 736b da07 6465 6c61 7965 6472  ..dask..delayedr
-00002d90: 7d00 0000 da04 6362 6564 7282 0000 00da  }.....cbedr.....
-00002da0: 0661 7070 656e 6472 3700 0000 da07 636f  .appendr7.....co
-00002db0: 6d70 7574 65da 0675 7064 6174 6529 2572  mpute..update)%r
-00002dc0: 7a00 0000 da0b 7472 616e 735f 6172 7261  z.....trans_arra
-00002dd0: 7972 3200 0000 727b 0000 005a 0b63 6f6c  yr2...r{...Z.col
-00002de0: 6c5f 616e 676c 6573 7257 0000 005a 0a76  l_anglesrW...Z.v
-00002df0: 6f6c 7461 6765 5f6b 76da 0479 706f 73da  oltage_kv..ypos.
-00002e00: 0478 706f 73da 0666 6361 6c5f 79da 0666  .xpos..fcal_y..f
-00002e10: 6361 6c5f 78da 0766 6d65 7368 5f78 da07  cal_x..fmesh_x..
-00002e20: 666d 6573 685f 79da 076d 6d65 7368 5f78  fmesh_y..mmesh_x
-00002e30: da07 6d6d 6573 685f 795a 0766 6d65 7368  ..mmesh_yZ.fmesh
-00002e40: 5f72 5a09 7261 6469 616e 735f 725a 0964  _rZ.radians_rZ.d
-00002e50: 6574 6563 746f 7273 7261 0000 005a 0b69  etectorsra...Z.i
-00002e60: 6e6e 6572 5f61 6e67 6c65 5a0b 6f75 7465  nner_angleZ.oute
-00002e70: 725f 616e 676c 65da 0779 706f 735f 6461  r_angle..ypos_da
-00002e80: da07 7870 6f73 5f64 61da 0870 726f 6265  ..xpos_da..probe
-00002e90: 5f73 63da 0770 726f 705f 7363 da0a 6d6d  _sc..prop_sc..mm
-00002ea0: 6573 685f 795f 7363 da0a 6d6d 6573 685f  esh_y_sc..mmesh_
-00002eb0: 785f 7363 da0e 7472 616e 735f 6172 7261  x_sc..trans_arra
-00002ec0: 795f 7363 5a0c 6465 7465 6374 6f72 735f  y_scZ.detectors_
-00002ed0: 7363 5a0a 7374 656d 5f69 6d61 6765 da04  scZ.stem_image..
-00002ee0: 7062 6172 725f 0000 00da 0769 6d5f 7661  pbarr_.....im_va
-00002ef0: 6c73 7260 0000 0072 7c00 0000 7280 0000  lsr`...r|...r...
-00002f00: 005a 0d61 7065 7274 7572 655f 7661 6c73  .Z.aperture_vals
-00002f10: 720a 0000 0072 0a00 0000 7214 0000 00da  r....r....r.....
-00002f20: 0c61 6e6e 756c 6172 5f73 7465 6d72 0100  .annular_stemr..
-00002f30: 0073 5e00 0000 0001 0801 0801 1002 2c01  .s^...........,.
-00002f40: 08fe 0404 2c01 08fe 0403 1001 1a01 1a01  ....,...........
-00002f50: 1801 1001 0401 1cff 0604 1401 0c01 0c01  ................
-00002f60: 0401 14ff 1a04 0a01 0a01 0e01 0e01 0e01  ................
-00002f70: 0e01 0e01 0e01 0402 1201 1401 0401 1401  ................
-00002f80: 0801 1cff 0403 1201 1001 0e01 1001 0a01  ................
-00002f90: 2e01 0a01 72a6 0000 0063 0400 0000 0000  ....r....c......
-00002fa0: 0000 0000 0000 1b00 0000 0900 0000 4300  ..............C.
-00002fb0: 0000 733a 0200 007c 0364 0119 007d 047c  ..s:...|.d...}.|
-00002fc0: 0364 0219 007d 0574 006a 01a0 027c 00a1  .d...}.t.j...|..
-00002fd0: 017d 067c 0674 00a0 0374 00a0 047c 06a1  .}.|.t...t...|..
-00002fe0: 01a1 011d 007d 0674 006a 01a0 057c 06a1  .....}.t.j...|..
-00002ff0: 017d 0074 00a0 067c 047c 05a1 025c 027d  .}.t...|.|...\.}
-00003000: 057d 0474 00a0 077c 006a 0864 0119 000b  .}.t...|.j.d....
-00003010: 0064 031b 007c 006a 0864 0119 0064 031b  .d...|.j.d...d..
-00003020: 0064 0218 007c 006a 0864 0119 00a1 037c  .d...|.j.d.....|
-00003030: 006a 0864 0119 001b 007d 0774 00a0 077c  .j.d.....}.t...|
-00003040: 006a 0864 0219 000b 0064 031b 007c 006a  .j.d.....d...|.j
-00003050: 0864 0219 0064 031b 0064 0218 007c 006a  .d...d...d...|.j
-00003060: 0864 0219 00a1 037c 006a 0864 0219 001b  .d.....|.j.d....
-00003070: 007d 0874 00a0 067c 087c 07a1 025c 027d  .}.t...|.|...\.}
-00003080: 097d 0a64 0474 006a 0914 0064 0514 007c  .}.d.t.j...d...|
-00003090: 0914 00a0 0a74 006a 0ba1 017d 0b64 0474  .....t.j...}.d.t
-000030a0: 006a 0914 0064 0514 007c 0a14 00a0 0a74  .j...d...|.....t
-000030b0: 006a 0ba1 017d 0c74 0ca0 0d7c 04a1 017d  .j...}.t...|...}
-000030c0: 0d74 0ca0 0d7c 05a1 017d 0e74 0e6a 0f7c  .t...|...}.t.j.|
-000030d0: 0064 0664 078d 027d 0f74 0e6a 0f7c 0264  .d.d...}.t.j.|.d
-000030e0: 0664 078d 027d 1074 0e6a 0f7c 0c64 0664  .d...}.t.j.|.d.d
-000030f0: 078d 027d 1174 0e6a 0f7c 0b64 0664 078d  ...}.t.j.|.d.d..
-00003100: 027d 1274 0e6a 0f7c 0164 0664 078d 027d  .}.t.j.|.d.d...}
-00003110: 1367 007d 1474 107c 046a 0864 0119 0064  .g.}.t.|.j.d...d
-00003120: 088d 018f ac7d 1574 00a0 117c 046a 0864  .....}.t...|.j.d
-00003130: 0119 00a1 0144 005d 8a7d 1667 007d 1774  .....D.].}.g.}.t
-00003140: 00a0 117c 046a 0864 0219 00a1 0144 005d  ...|.j.d.....D.]
-00003150: 4a7d 1874 12a0 1374 14a1 017c 0f7c 0d7c  J}.t...t...|.|.|
-00003160: 167c 1866 0219 007c 0e7c 167c 1866 0219  .|.f...|.|.|.f..
-00003170: 0066 027c 117c 1283 047d 1974 12a0 1374  .f.|.|...}.t...t
-00003180: 15a1 017c 197c 137c 1083 037d 1a7c 17a0  ...|.|.|...}.|..
-00003190: 167c 1aa1 0101 0090 0171 9874 00a0 1774  .|.......q.t...t
-000031a0: 126a 187c 178e 00a1 017d 177c 14a0 167c  .j.|.....}.|...|
-000031b0: 17a1 0101 007c 15a0 1964 02a1 0101 0090  .....|...d......
-000031c0: 0171 8057 0064 0004 0004 0083 0301 006e  .q.W.d.........n
-000031d0: 1231 0090 0273 2230 0001 0001 0001 0059  .1...s"0.......Y
-000031e0: 0001 0074 00a0 177c 14a1 017d 147c 1453  ...t...|...}.|.S
-000031f0: 0029 094e 7201 0000 0072 1d00 0000 7207  .).Nr....r....r.
-00003200: 0000 0072 8300 0000 7215 0000 0054 7284  ...r....r....Tr.
-00003210: 0000 0072 8500 0000 291a 7216 0000 0072  ...r....).r....r
-00003220: 2600 0000 7279 0000 0072 7400 0000 725d  &...ry...rt...r]
-00003230: 0000 0072 3d00 0000 7222 0000 0072 8700  ...r=...r"...r..
-00003240: 0000 7254 0000 0072 1700 0000 7219 0000  ..rT...r....r...
-00003250: 0072 1a00 0000 7289 0000 0072 8a00 0000  .r....r....r....
-00003260: 728b 0000 0072 8c00 0000 728d 0000 0072  r....r....r....r
-00003270: 1f00 0000 728e 0000 0072 8f00 0000 727d  ....r....r....r}
-00003280: 0000 0072 9000 0000 7291 0000 0072 3700  ...r....r....r7.
-00003290: 0000 7292 0000 0072 9300 0000 291b 727a  ..r....r....).rz
-000032a0: 0000 0072 9400 0000 7232 0000 0072 7b00  ...r....r2...r{.
-000032b0: 0000 7295 0000 0072 9600 0000 5a07 7072  ..r....r....Z.pr
-000032c0: 6f62 6566 7472 9700 0000 7298 0000 0072  obeftr....r....r
-000032d0: 9900 0000 729a 0000 0072 9b00 0000 729c  ....r....r....r.
-000032e0: 0000 0072 9d00 0000 729e 0000 0072 9f00  ...r....r....r..
-000032f0: 0000 72a0 0000 0072 a100 0000 72a2 0000  ..r....r....r...
-00003300: 0072 a300 0000 5a07 7374 656d 5f34 4472  .r....Z.stem_4Dr
-00003310: a400 0000 725f 0000 0072 a500 0000 7260  ....r_...r....r`
-00003320: 0000 0072 7c00 0000 5a03 6362 6472 0a00  ...r|...Z.cbdr..
-00003330: 0000 720a 0000 0072 1400 0000 da0f 7069  ..r....r......pi
-00003340: 7865 6c6c 6174 6564 5f73 7465 6da7 0100  xellated_stem...
-00003350: 0073 4a00 0000 0001 0801 0801 0c01 1401  .sJ.............
-00003360: 0c01 1002 2c01 08fe 0404 2c01 08fe 0403  ....,.....,.....
-00003370: 1001 1a01 1a02 0a01 0a01 0e01 0e01 0e01  ................
-00003380: 0e01 0e01 0402 1201 1401 0401 1401 0801  ................
-00003390: 1cff 0403 1201 0e01 1001 0a01 2e01 0a01  ................
-000033a0: 72a7 0000 0029 0372 0100 0000 7201 0000  r....).r....r...
-000033b0: 0072 0100 0000 2903 7201 0000 0072 0100  .r....).r....r..
-000033c0: 0000 7201 0000 0029 0372 4800 0000 7244  ..r....).rH...rD
-000033d0: 0000 0072 4900 0000 2901 7209 0000 0029  ...rI...).r....)
-000033e0: 195a 056e 756d 7079 7216 0000 005a 0d73  .Z.numpyr....Z.s
-000033f0: 6369 7079 2e73 7065 6369 616c da07 7370  cipy.special..sp
-00003400: 6563 6961 6c72 5300 0000 7255 0000 00da  ecialrS...rU....
-00003410: 0873 7465 6d74 6f6f 6c72 2400 0000 7213  .stemtoolr$...r.
-00003420: 0000 0072 1c00 0000 7233 0000 0072 3600  ...r....r3...r6.
-00003430: 0000 7238 0000 0072 4300 0000 723c 0000  ..r8...rC...r<..
-00003440: 0072 5900 0000 7262 0000 0072 6400 0000  .rY...rb...rd...
-00003450: 726a 0000 0072 7300 0000 7278 0000 0072  rj...rs...rx...r
-00003460: 7d00 0000 7282 0000 0072 a600 0000 72a7  }...r....r....r.
-00003470: 0000 0072 0a00 0000 720a 0000 0072 0a00  ...r....r....r..
-00003480: 0000 7214 0000 00da 083c 6d6f 6475 6c65  ..r......<module
-00003490: 3e01 0000 0073 2e00 0000 0801 0c01 0801  >....s..........
-000034a0: 0803 0820 082a 0829 080c 080e 0a1f 0a0e  ... .*.)........
-000034b0: 0001 0001 00fb 0a56 0813 0807 0807 0826  .......V.......&
-000034c0: 0a08 0808 0807 0835                      .......5
+00002060: 2908 7216 0000 0072 5200 0000 721f 0000  ).r....rR...r...
+00002070: 00da 036c 656e da05 7261 6e67 65da 0369  ...len..range..i
+00002080: 6e66 723a 0000 00da 0361 6273 2908 5a08  nfr:.....abs).Z.
+00002090: 6174 6f6d 5f70 6f73 da08 6365 6c6c 5f64  atom_pos..cell_d
+000020a0: 696d 5a06 7563 5f70 6f73 da02 6969 da02  imZ.uc_pos..ii..
+000020b0: 6a6a da02 6363 5a0a 7563 5f6e 6f6e 7a65  jj..ccZ.uc_nonze
+000020c0: 726f 5a06 7563 5f69 6e76 720a 0000 0072  roZ.uc_invr....r
+000020d0: 0a00 0000 7214 0000 00da 0b66 696e 645f  ....r......find_
+000020e0: 7563 5f70 6f73 1401 0000 7322 0000 000a  uc_pos....s"....
+000020f0: 0112 0110 0120 0114 010e 010c 0112 0102  ..... ..........
+00002100: fb08 060c 0104 011a 011c ff0c 030c 0104  ................
+00002110: 0172 6200 0000 6301 0000 0000 0000 0000  .rb...c.........
+00002120: 0000 0002 0000 0004 0000 0043 0000 0073  ...........C...s
+00002130: 3800 0000 7400 6a01 7c00 7400 6a02 6401  8...t.j.|.t.j.d.
+00002140: 8d02 7d01 6402 7c01 7c00 6402 6b02 3c00  ..}.d.|.|.d.k.<.
+00002150: 6403 7c00 7c00 6402 6b03 1900 1b00 7c01  d.|.|.d.k.....|.
+00002160: 7c00 6402 6b03 3c00 7c01 5300 2904 4e72  |.d.k.<.|.S.).Nr
+00002170: 3900 0000 7201 0000 0072 1d00 0000 2903  9...r....r....).
+00002180: 7216 0000 005a 0a65 6d70 7479 5f6c 696b  r....Z.empty_lik
+00002190: 65da 0566 6c6f 6174 2902 5a06 6d69 6c6c  e..float).Z.mill
+000021a0: 6572 5a0a 6d69 6c6c 6572 5f69 6e76 720a  erZ.miller_invr.
+000021b0: 0000 0072 0a00 0000 7214 0000 00da 0e6d  ...r....r......m
+000021c0: 696c 6c65 725f 696e 7665 7273 6527 0100  iller_inverse'..
+000021d0: 0073 0800 0000 1001 0c01 1801 0401 7264  .s............rd
+000021e0: 0000 0063 0300 0000 0000 0000 0000 0000  ...c............
+000021f0: 0600 0000 0700 0000 4300 0000 7338 0000  ........C...s8..
+00002200: 0074 007c 0083 017d 0374 01a0 0274 01a0  .t.|...}.t...t..
+00002210: 037c 02a1 017c 03a1 027d 0474 01a0 047c  .|...|...}.t...|
+00002220: 037c 0174 016a 05a0 067c 04a1 011b 0014  .|.t.j...|......
+00002230: 00a1 017d 057c 0553 0029 014e 2907 7264  ...}.|.S.).N).rd
+00002240: 0000 0072 1600 0000 da06 6d61 746d 756c  ...r......matmul
+00002250: da09 7472 616e 7370 6f73 6572 3a00 0000  ..transposer:...
+00002260: 5a06 6c69 6e61 6c67 5a04 6e6f 726d 2906  Z.linalgZ.norm).
+00002270: da0a 6d69 6c6c 6572 5f64 6972 da06 6c65  ..miller_dir..le
+00002280: 6e67 7468 725e 0000 005a 086d 696e 7665  ngthr^...Z.minve
+00002290: 7273 655a 0873 6c69 6365 6469 72da 086e  rseZ.slicedir..n
+000022a0: 6f5f 6365 6c6c 7372 0a00 0000 720a 0000  o_cellsr....r...
+000022b0: 0072 1400 0000 da10 6765 745f 6e75 6d62  .r......get_numb
+000022c0: 6572 5f63 656c 6c73 2e01 0000 7308 0000  er_cells....s...
+000022d0: 0008 0112 011a 0104 0172 6a00 0000 6303  .........rj...c.
+000022e0: 0000 0000 0000 0000 0000 0014 0000 000a  ................
+000022f0: 0000 0043 0000 0073 2a02 0000 7400 a001  ...C...s*...t...
+00002300: 7400 a002 6401 7403 7c01 6402 1900 8301  t...d.t.|.d.....
+00002310: 6402 a103 7400 a002 6401 7403 7c01 6401  d...t...d.t.|.d.
+00002320: 1900 8301 6402 a103 a102 5c02 7d03 7d04  ....d.....\.}.}.
+00002330: 7c03 a004 a100 7d03 7c04 a004 a100 7d04  |.....}.|.....}.
+00002340: 7400 a002 7400 a005 7400 a005 7c03 a101  t...t...t...|...
+00002350: 7400 a006 7c04 a101 6602 a101 a101 7d05  t...|...f.....}.
+00002360: 7c05 7c00 6401 1900 7c00 6402 1900 1b00  |.|.d...|.d.....
+00002370: 1400 7d06 7400 a007 7c00 6402 1900 7c03  ..}.t...|.d...|.
+00002380: 1400 7c00 6401 1900 7c04 1400 1800 a101  ..|.d...|.......
+00002390: 7c00 6402 1900 6403 1300 7c00 6401 1900  |.d...d...|.d...
+000023a0: 6403 1300 1700 6404 1300 1b00 7d07 7400  d.....d.....}.t.
+000023b0: a001 7400 a002 6401 7400 a008 7c02 a101  ..t...d.t...|...
+000023c0: 1800 7403 7c01 6402 1900 8301 7400 a008  ..t.|.d.....t...
+000023d0: 7c02 a101 1700 6402 a103 7400 a002 6401  |.....d...t...d.
+000023e0: 7400 a008 7c02 a101 1800 7403 7c01 6401  t...|.....t.|.d.
+000023f0: 1900 8301 7400 a008 7c02 a101 1700 6402  ....t...|.....d.
+00002400: a103 a102 5c02 7d08 7d09 7c08 a004 a100  ....\.}.}.|.....
+00002410: 7d08 7c09 a004 a100 7d09 7400 a007 7c00  }.|.....}.t...|.
+00002420: 6402 1900 7c08 1400 7c00 6401 1900 7c09  d...|...|.d...|.
+00002430: 1400 1800 a101 7c00 6402 1900 6403 1300  ......|.d...d...
+00002440: 7c00 6401 1900 6403 1300 1700 6404 1300  |.d...d.....d...
+00002450: 1b00 7d0a 7c09 7c0a 7c02 6b00 1900 7d0b  ..}.|.|.|.k...}.
+00002460: 7c08 7c0a 7c02 6b00 1900 7d0c 7400 a007  |.|.|.k...}.t...
+00002470: 7400 a009 7c0c 6401 1800 7c0b 6401 1800  t...|.d...|.d...
+00002480: a102 7400 a009 7c00 6401 1900 7c00 6402  ..t...|.d...|.d.
+00002490: 1900 a102 1800 a101 7d0d 7c0b 7c0d 7400  ........}.|.|.t.
+000024a0: 6a0a 6403 1b00 6b00 1900 7d0e 7c0c 7c0d  j.d...k...}.|.|.
+000024b0: 7400 6a0a 6403 1b00 6b00 1900 7d0f 7400  t.j.d...k...}.t.
+000024c0: a007 7400 a009 7c0f 6405 1800 7c0e 6406  ..t...|.d...|.d.
+000024d0: 1800 a102 7400 a009 7c00 6401 1900 7c00  ....t...|.d...|.
+000024e0: 6402 1900 a102 1800 a101 7d10 7c0e 7c10  d.........}.|.|.
+000024f0: 7400 6a0a 6403 1b00 6b04 1900 7d11 7c0f  t.j.d...k...}.|.
+00002500: 7c10 7400 6a0a 6403 1b00 6b04 1900 7d12  |.t.j.d...k...}.
+00002510: 7400 a00b 7c12 7c11 6602 a101 7d13 7c13  t...|.|.f...}.|.
+00002520: a00c a100 5300 2907 4e72 0100 0000 721d  ....S.).Nr....r.
+00002530: 0000 0072 0700 0000 7209 0000 00e9 5100  ...r....r.....Q.
+00002540: 0000 e928 0000 0029 0d72 1600 0000 7222  ...(...).r....r"
+00002550: 0000 0072 1f00 0000 7220 0000 005a 0572  ...r....r ...Z.r
+00002560: 6176 656c da04 616d 6178 da03 6d61 7872  avel..amax..maxr
+00002570: 5d00 0000 da04 6365 696c 5a07 6172 6374  ].....ceilZ.arct
+00002580: 616e 3272 1700 0000 7237 0000 0072 6600  an2r....r7...rf.
+00002590: 0000 2914 7267 0000 0072 6900 0000 5a09  ..).rg...ri...Z.
+000025a0: 6d61 785f 6864 6973 74da 0279 795a 0278  max_hdist..yyZ.x
+000025b0: 785a 0278 705a 0279 705a 0f70 6f69 6e74  xZ.xpZ.ypZ.point
+000025c0: 5f64 6973 7461 6e63 6573 5a06 7979 5f6e  _distancesZ.yy_n
+000025d0: 6577 5a06 7878 5f6e 6577 da05 6469 7374  ewZ.xx_new..dist
+000025e0: 735a 0c78 785f 6669 7273 7470 6173 735a  sZ.xx_firstpassZ
+000025f0: 0c79 795f 6669 7273 7470 6173 735a 0b64  .yy_firstpassZ.d
+00002600: 6973 745f 616e 676c 6573 5a0d 7878 5f73  ist_anglesZ.xx_s
+00002610: 6563 6f6e 6470 6173 735a 0d79 795f 7365  econdpassZ.yy_se
+00002620: 636f 6e64 7061 7373 5a0c 6469 7374 5f61  condpassZ.dist_a
+00002630: 6e67 6c65 7332 5a0c 7878 5f74 6869 7264  ngles2Z.xx_third
+00002640: 7061 7373 5a0c 7979 5f74 6869 7264 7061  passZ.yy_thirdpa
+00002650: 7373 da04 7661 6c73 720a 0000 0072 0a00  ss..valsr....r..
+00002660: 0000 7214 0000 00da 0b73 6c61 6262 696e  ..r......slabbin
+00002670: 675f 3244 3501 0000 734a 0000 0004 0128  g_2D5...sJ.....(
+00002680: 0108 ff08 0308 0120 0114 011c 011a 0104  ....... ........
+00002690: ff04 0328 0128 0108 fe08 0408 011c 011a  ...(.(..........
+000026a0: 0104 ff0c 030c 0104 0112 0112 0102 ff04  ................
+000026b0: ff12 0412 0104 0112 0112 0102 ff04 ff12  ................
+000026c0: 0412 010e 0108 0172 7300 0000 7209 0000  .......rs...r...
+000026d0: 0063 0300 0000 0000 0000 0000 0000 0700  .c..............
+000026e0: 0000 0300 0000 4300 0000 733c 0000 0074  ......C...s<...t
+000026f0: 00a0 017c 00a1 017d 0374 00a0 027c 03a1  ...|...}.t...|..
+00002700: 017d 047c 037c 027c 0414 006b 047d 0574  .}.|.|.|...k.}.t
+00002710: 00a0 037c 05a1 0174 006a 041b 0064 0113  ...|...t.j...d..
+00002720: 007d 067c 067c 0114 0053 0029 024e 7209  .}.|.|...S.).Nr.
+00002730: 0000 0029 0572 1600 0000 725d 0000 0072  ...).r....r]...r
+00002740: 6d00 0000 da03 7375 6d72 1700 0000 2907  m.....sumr....).
+00002750: 5a07 7072 6f62 6532 44da 0570 7369 7a65  Z.probe2D..psize
+00002760: da01 78da 0270 325a 0470 6d61 785a 0270  ..x..p2Z.pmaxZ.p
+00002770: 725a 0672 6164 6975 7372 0a00 0000 720a  rZ.radiusr....r.
+00002780: 0000 0072 1400 0000 da04 6677 786d 5b01  ...r......fwxm[.
+00002790: 0000 730a 0000 000a 010a 010c 0114 0108  ..s.............
+000027a0: 0172 7800 0000 6304 0000 0000 0000 0000  .rx...c.........
+000027b0: 0000 0008 0000 0006 0000 0043 0000 0073  ...........C...s
+000027c0: 5200 0000 7400 a001 7c00 6a02 a101 7d04  R...t...|.j...}.
+000027d0: 7c01 7c04 6401 1b00 1800 7d05 7400 a003  |.|.d.....}.t...
+000027e0: 7c03 7c05 6402 1900 1400 7c02 7c05 6403  |.|.d.....|.|.d.
+000027f0: 1900 1400 1700 a101 7d06 7400 6a04 a005  ........}.t.j...
+00002800: 7c06 7400 6a04 a006 7c00 a101 1400 a101  |.t.j...|.......
+00002810: 7d07 7c07 5300 2904 4e72 0700 0000 721d  }.|.S.).Nr....r.
+00002820: 0000 0072 0100 0000 2907 7216 0000 0072  ...r....).r....r
+00002830: 3700 0000 7254 0000 0072 1800 0000 7226  7...rT...r....r&
+00002840: 0000 0072 3d00 0000 da04 6666 7432 2908  ...r=.....fft2).
+00002850: da05 7072 6f62 65da 0370 6f73 5a06 666d  ..probe..posZ.fm
+00002860: 6573 6879 5a06 666d 6573 6878 723e 0000  eshyZ.fmeshxr>..
+00002870: 005a 0772 656c 5f70 6f73 5a08 6d6f 7665  .Z.rel_posZ.move
+00002880: 5f6d 6174 da0b 6d6f 7665 645f 7072 6f62  _mat..moved_prob
+00002890: 6572 0a00 0000 720a 0000 0072 1400 0000  er....r....r....
+000028a0: da0f 6d6f 7665 5f70 726f 6265 5f6d 6573  ..move_probe_mes
+000028b0: 6863 0100 0073 0a00 0000 0c01 0c01 1e01  hc...s..........
+000028c0: 1801 0401 727d 0000 0063 0200 0000 0000  ....r}...c......
+000028d0: 0000 0000 0000 0400 0000 0800 0000 4300  ..............C.
+000028e0: 0000 7354 0000 0074 006a 017c 016a 0264  ..sT...t.j.|.j.d
+000028f0: 0119 0074 006a 0364 028d 027d 0274 00a0  ...t.j.d...}.t..
+00002900: 047c 016a 0264 0119 00a1 0144 005d 147d  .|.j.d.....D.].}
+00002910: 0374 00a0 057c 007c 0164 0064 0085 0264  .t...|.|.d.d...d
+00002920: 0064 0085 027c 0366 0319 0019 00a1 017c  .d...|.f.......|
+00002930: 027c 033c 0071 137c 0253 0029 034e e9ff  .|.<.q.|.S.).N..
+00002940: ffff ff72 3900 0000 2906 7216 0000 00da  ...r9...).r.....
+00002950: 057a 6572 6f73 7254 0000 005a 0766 6c6f  .zerosrT...Z.flo
+00002960: 6174 3332 721f 0000 0072 7400 0000 2904  at32r....rt...).
+00002970: da0c 6362 6564 5f70 6174 7465 726e 5a08  ..cbed_patternZ.
+00002980: 6465 7465 6374 6f72 da03 7661 6c72 5f00  detector..valr_.
+00002990: 0000 720a 0000 0072 0a00 0000 7214 0000  ..r....r....r...
+000029a0: 00da 0a64 6966 665f 746f 5f69 6d6b 0100  ...diff_to_imk..
+000029b0: 0073 0800 0000 1601 1401 2601 0401 7282  .s........&...r.
+000029c0: 0000 0063 0700 0000 0000 0000 0000 0000  ...c............
+000029d0: 2500 0000 0900 0000 4300 0000 73d6 0200  %.......C...s...
+000029e0: 007c 0364 0119 007d 077c 0364 0219 007d  .|.d...}.|.d...}
+000029f0: 0874 00a0 017c 077c 08a1 025c 027d 087d  .t...|.|...\.}.}
+00002a00: 0774 00a0 027c 006a 0364 0119 000b 0064  .t...|.j.d.....d
+00002a10: 031b 007c 006a 0364 0119 0064 031b 0064  ...|.j.d...d...d
+00002a20: 0218 007c 006a 0364 0119 00a1 037c 006a  ...|.j.d.....|.j
+00002a30: 0364 0119 001b 007d 0974 00a0 027c 006a  .d.....}.t...|.j
+00002a40: 0364 0219 000b 0064 031b 007c 006a 0364  .d.....d...|.j.d
+00002a50: 0219 0064 031b 0064 0218 007c 006a 0364  ...d...d...|.j.d
+00002a60: 0219 00a1 037c 006a 0364 0219 001b 007d  .....|.j.d.....}
+00002a70: 0a74 00a0 017c 0a7c 09a1 025c 027d 0b7d  .t...|.|...\.}.}
+00002a80: 0c64 0474 006a 0414 0064 0514 007c 0b14  .d.t.j...d...|..
+00002a90: 00a0 0574 006a 06a1 017d 0d64 0474 006a  ...t.j...}.d.t.j
+00002aa0: 0414 0064 0514 007c 0c14 00a0 0574 006a  ...d...|.....t.j
+00002ab0: 06a1 017d 0e7c 0b64 0313 007c 0c64 0313  ...}.|.d...|.d..
+00002ac0: 0017 0064 0613 007c 051b 007d 0f7c 0f74  ...d...|...}.|.t
+00002ad0: 076a 08a0 097c 06a1 0114 007d 1074 006a  .j...|.....}.t.j
+00002ae0: 0a7c 106a 0364 0119 007c 106a 0364 0219  .|.j.d...|.j.d..
+00002af0: 007c 046a 0364 0119 0066 0374 0b64 078d  .|.j.d...f.t.d..
+00002b00: 027d 1174 00a0 0c7c 046a 0364 0119 00a1  .}.t...|.j.d....
+00002b10: 0144 005d 257d 127c 047c 1264 0166 0219  .D.]%}.|.|.d.f..
+00002b20: 007d 137c 047c 1264 0266 0219 007d 1474  .}.|.|.d.f...}.t
+00002b30: 00a0 0d7c 1364 081b 007c 106b 007c 107c  ...|.d...|.k.|.|
+00002b40: 1464 081b 006b 00a1 027c 1164 0064 0085  .d...k...|.d.d..
+00002b50: 0264 0064 0085 027c 1266 033c 0071 9974  .d.d...|.f.<.q.t
+00002b60: 0ea0 0f7c 07a1 017d 1574 0ea0 0f7c 08a1  ...|...}.t...|..
+00002b70: 017d 1674 106a 117c 0064 0964 0a8d 027d  .}.t.j.|.d.d...}
+00002b80: 1774 106a 117c 0264 0964 0a8d 027d 1874  .t.j.|.d.d...}.t
+00002b90: 106a 117c 0e64 0964 0a8d 027d 1974 106a  .j.|.d.d...}.t.j
+00002ba0: 117c 0d64 0964 0a8d 027d 1a74 106a 117c  .|.d.d...}.t.j.|
+00002bb0: 0164 0964 0a8d 027d 1b74 106a 117c 1164  .d.d...}.t.j.|.d
+00002bc0: 0964 0a8d 027d 1c67 007d 1d74 127c 076a  .d...}.g.}.t.|.j
+00002bd0: 0364 0119 0064 0b8d 018f 5e7d 1e74 00a0  .d...d....^}.t..
+00002be0: 0c7c 076a 0364 0119 00a1 0144 005d 4d7d  .|.j.d.....D.]M}
+00002bf0: 1f67 007d 2074 00a0 0c7c 076a 0364 0219  .g.} t...|.j.d..
+00002c00: 00a1 0144 005d 2d7d 2174 13a0 1474 15a1  ...D.]-}!t...t..
+00002c10: 017c 177c 157c 1f7c 2166 0219 007c 167c  .|.|.|.|!f...|.|
+00002c20: 1f7c 2166 0219 0066 027c 197c 1a83 047d  .|!f...f.|.|...}
+00002c30: 2274 13a0 1474 16a1 017c 227c 1b7c 1883  "t...t...|"|.|..
+00002c40: 037d 2374 13a0 1474 17a1 017c 237c 1c83  .}#t...t...|#|..
+00002c50: 027d 247c 20a0 187c 24a1 0101 0090 0171  .}$| ..|$......q
+00002c60: 1274 00a0 1974 136a 1a7c 208e 00a1 017d  .t...t.j.| ....}
+00002c70: 207c 1da0 187c 20a1 0101 007c 1ea0 1b64   |...| ....|...d
+00002c80: 02a1 0101 0090 0171 0657 0064 0004 0004  .......q.W.d....
+00002c90: 0083 0301 006e 0931 0090 0173 5f77 0101  .....n.1...s_w..
+00002ca0: 0001 0001 0059 0001 0074 00a0 197c 1da1  .....Y...t...|..
+00002cb0: 017d 1d7c 1d53 0029 0c4e 7201 0000 0072  .}.|.S.).Nr....r
+00002cc0: 1d00 0000 7207 0000 00e9 feff ffff 7215  ....r.........r.
+00002cd0: 0000 0072 0900 0000 7239 0000 0072 0600  ...r....r9...r..
+00002ce0: 0000 54a9 015a 0962 726f 6164 6361 7374  ..T..Z.broadcast
+00002cf0: a901 da05 746f 7461 6c29 1c72 1600 0000  ....total).r....
+00002d00: 7222 0000 00da 086c 696e 7370 6163 6572  r".....linspacer
+00002d10: 5400 0000 7217 0000 0072 1900 0000 721a  T...r....r....r.
+00002d20: 0000 0072 2400 0000 7225 0000 0072 1300  ...r$...r%...r..
+00002d30: 0000 727f 0000 00da 0462 6f6f 6c72 1f00  ..r......boolr..
+00002d40: 0000 5a0b 6c6f 6769 6361 6c5f 616e 64da  ..Z.logical_and.
+00002d50: 0264 61da 0a66 726f 6d5f 6172 7261 79da  .da..from_array.
+00002d60: 0663 6c69 656e 74da 0773 6361 7474 6572  .client..scatter
+00002d70: da04 7471 646d da04 6461 736b da07 6465  ..tqdm..dask..de
+00002d80: 6c61 7965 6472 7d00 0000 da04 6362 6564  layedr}.....cbed
+00002d90: 7282 0000 00da 0661 7070 656e 6472 3700  r......appendr7.
+00002da0: 0000 da07 636f 6d70 7574 65da 0675 7064  ....compute..upd
+00002db0: 6174 6529 2572 7a00 0000 da0b 7472 616e  ate)%rz.....tran
+00002dc0: 735f 6172 7261 7972 3200 0000 727b 0000  s_arrayr2...r{..
+00002dd0: 005a 0b63 6f6c 6c5f 616e 676c 6573 7257  .Z.coll_anglesrW
+00002de0: 0000 005a 0a76 6f6c 7461 6765 5f6b 76da  ...Z.voltage_kv.
+00002df0: 0479 706f 73da 0478 706f 73da 0666 6361  .ypos..xpos..fca
+00002e00: 6c5f 79da 0666 6361 6c5f 78da 0766 6d65  l_y..fcal_x..fme
+00002e10: 7368 5f78 da07 666d 6573 685f 79da 076d  sh_x..fmesh_y..m
+00002e20: 6d65 7368 5f78 da07 6d6d 6573 685f 795a  mesh_x..mmesh_yZ
+00002e30: 0766 6d65 7368 5f72 5a09 7261 6469 616e  .fmesh_rZ.radian
+00002e40: 735f 725a 0964 6574 6563 746f 7273 7261  s_rZ.detectorsra
+00002e50: 0000 005a 0b69 6e6e 6572 5f61 6e67 6c65  ...Z.inner_angle
+00002e60: 5a0b 6f75 7465 725f 616e 676c 65da 0779  Z.outer_angle..y
+00002e70: 706f 735f 6461 da07 7870 6f73 5f64 61da  pos_da..xpos_da.
+00002e80: 0870 726f 6265 5f73 63da 0770 726f 705f  .probe_sc..prop_
+00002e90: 7363 da0a 6d6d 6573 685f 795f 7363 da0a  sc..mmesh_y_sc..
+00002ea0: 6d6d 6573 685f 785f 7363 da0e 7472 616e  mmesh_x_sc..tran
+00002eb0: 735f 6172 7261 795f 7363 5a0c 6465 7465  s_array_scZ.dete
+00002ec0: 6374 6f72 735f 7363 5a0a 7374 656d 5f69  ctors_scZ.stem_i
+00002ed0: 6d61 6765 da04 7062 6172 725f 0000 00da  mage..pbarr_....
+00002ee0: 0769 6d5f 7661 6c73 7260 0000 0072 7c00  .im_valsr`...r|.
+00002ef0: 0000 7280 0000 005a 0d61 7065 7274 7572  ..r....Z.apertur
+00002f00: 655f 7661 6c73 720a 0000 0072 0a00 0000  e_valsr....r....
+00002f10: 7214 0000 00da 0c61 6e6e 756c 6172 5f73  r......annular_s
+00002f20: 7465 6d72 0100 0073 6200 0000 0801 0801  temr...sb.......
+00002f30: 1001 2c02 0801 04fe 2c04 0801 04fe 1003  ..,.....,.......
+00002f40: 1a01 1a01 1801 1001 0401 1c01 06ff 1404  ................
+00002f50: 0c01 0c01 0401 1401 18ff 0a04 0a01 0e01  ................
+00002f60: 0e01 0e01 0e01 0e01 0e01 0401 1202 1401  ................
+00002f70: 0401 1401 0801 1c01 04ff 1203 1001 0e01  ................
+00002f80: 1001 0a01 0e01 02f5 1eff 0a0d 0401 72a6  ..............r.
+00002f90: 0000 0063 0400 0000 0000 0000 0000 0000  ...c............
+00002fa0: 1b00 0000 0900 0000 4300 0000 7336 0200  ........C...s6..
+00002fb0: 007c 0364 0119 007d 047c 0364 0219 007d  .|.d...}.|.d...}
+00002fc0: 0574 006a 01a0 027c 00a1 017d 067c 0674  .t.j...|...}.|.t
+00002fd0: 00a0 0374 00a0 047c 06a1 01a1 011d 007d  ...t...|.......}
+00002fe0: 0674 006a 01a0 057c 06a1 017d 0074 00a0  .t.j...|...}.t..
+00002ff0: 067c 047c 05a1 025c 027d 057d 0474 00a0  .|.|...\.}.}.t..
+00003000: 077c 006a 0864 0119 000b 0064 031b 007c  .|.j.d.....d...|
+00003010: 006a 0864 0119 0064 031b 0064 0218 007c  .j.d...d...d...|
+00003020: 006a 0864 0119 00a1 037c 006a 0864 0119  .j.d.....|.j.d..
+00003030: 001b 007d 0774 00a0 077c 006a 0864 0219  ...}.t...|.j.d..
+00003040: 000b 0064 031b 007c 006a 0864 0219 0064  ...d...|.j.d...d
+00003050: 031b 0064 0218 007c 006a 0864 0219 00a1  ...d...|.j.d....
+00003060: 037c 006a 0864 0219 001b 007d 0874 00a0  .|.j.d.....}.t..
+00003070: 067c 087c 07a1 025c 027d 097d 0a64 0474  .|.|...\.}.}.d.t
+00003080: 006a 0914 0064 0514 007c 0914 00a0 0a74  .j...d...|.....t
+00003090: 006a 0ba1 017d 0b64 0474 006a 0914 0064  .j...}.d.t.j...d
+000030a0: 0514 007c 0a14 00a0 0a74 006a 0ba1 017d  ...|.....t.j...}
+000030b0: 0c74 0ca0 0d7c 04a1 017d 0d74 0ca0 0d7c  .t...|...}.t...|
+000030c0: 05a1 017d 0e74 0e6a 0f7c 0064 0664 078d  ...}.t.j.|.d.d..
+000030d0: 027d 0f74 0e6a 0f7c 0264 0664 078d 027d  .}.t.j.|.d.d...}
+000030e0: 1074 0e6a 0f7c 0c64 0664 078d 027d 1174  .t.j.|.d.d...}.t
+000030f0: 0e6a 0f7c 0b64 0664 078d 027d 1274 0e6a  .j.|.d.d...}.t.j
+00003100: 0f7c 0164 0664 078d 027d 1367 007d 1474  .|.d.d...}.g.}.t
+00003110: 107c 046a 0864 0119 0064 088d 018f 547d  .|.j.d...d....T}
+00003120: 1574 00a0 117c 046a 0864 0119 00a1 0144  .t...|.j.d.....D
+00003130: 005d 437d 1667 007d 1774 00a0 117c 046a  .]C}.g.}.t...|.j
+00003140: 0864 0219 00a1 0144 005d 247d 1874 12a0  .d.....D.]$}.t..
+00003150: 1374 14a1 017c 0f7c 0d7c 167c 1866 0219  .t...|.|.|.|.f..
+00003160: 007c 0e7c 167c 1866 0219 0066 027c 117c  .|.|.|.f...f.|.|
+00003170: 1283 047d 1974 12a0 1374 15a1 017c 197c  ...}.t...t...|.|
+00003180: 137c 1083 037d 1a7c 17a0 167c 1aa1 0101  .|...}.|...|....
+00003190: 0071 cc74 00a0 1774 126a 187c 178e 00a1  .q.t...t.j.|....
+000031a0: 017d 177c 14a0 167c 17a1 0101 007c 15a0  .}.|...|.....|..
+000031b0: 1964 02a1 0101 0071 c057 0064 0004 0004  .d.....q.W.d....
+000031c0: 0083 0301 006e 0931 0090 0173 0f77 0101  .....n.1...s.w..
+000031d0: 0001 0001 0059 0001 0074 00a0 177c 14a1  .....Y...t...|..
+000031e0: 017d 147c 1453 0029 094e 7201 0000 0072  .}.|.S.).Nr....r
+000031f0: 1d00 0000 7207 0000 0072 8300 0000 7215  ....r....r....r.
+00003200: 0000 0054 7284 0000 0072 8500 0000 291a  ...Tr....r....).
+00003210: 7216 0000 0072 2600 0000 7279 0000 0072  r....r&...ry...r
+00003220: 7400 0000 725d 0000 0072 3d00 0000 7222  t...r]...r=...r"
+00003230: 0000 0072 8700 0000 7254 0000 0072 1700  ...r....rT...r..
+00003240: 0000 7219 0000 0072 1a00 0000 7289 0000  ..r....r....r...
+00003250: 0072 8a00 0000 728b 0000 0072 8c00 0000  .r....r....r....
+00003260: 728d 0000 0072 1f00 0000 728e 0000 0072  r....r....r....r
+00003270: 8f00 0000 727d 0000 0072 9000 0000 7291  ....r}...r....r.
+00003280: 0000 0072 3700 0000 7292 0000 0072 9300  ...r7...r....r..
+00003290: 0000 291b 727a 0000 0072 9400 0000 7232  ..).rz...r....r2
+000032a0: 0000 0072 7b00 0000 7295 0000 0072 9600  ...r{...r....r..
+000032b0: 0000 5a07 7072 6f62 6566 7472 9700 0000  ..Z.probeftr....
+000032c0: 7298 0000 0072 9900 0000 729a 0000 0072  r....r....r....r
+000032d0: 9b00 0000 729c 0000 0072 9d00 0000 729e  ....r....r....r.
+000032e0: 0000 0072 9f00 0000 72a0 0000 0072 a100  ...r....r....r..
+000032f0: 0000 72a2 0000 0072 a300 0000 5a07 7374  ..r....r....Z.st
+00003300: 656d 5f34 4472 a400 0000 725f 0000 0072  em_4Dr....r_...r
+00003310: a500 0000 7260 0000 0072 7c00 0000 5a03  ....r`...r|...Z.
+00003320: 6362 6472 0a00 0000 720a 0000 0072 1400  cbdr....r....r..
+00003330: 0000 da0f 7069 7865 6c6c 6174 6564 5f73  ....pixellated_s
+00003340: 7465 6da7 0100 0073 4e00 0000 0801 0801  tem....sN.......
+00003350: 0c01 1401 0c01 1001 2c02 0801 04fe 2c04  ........,.....,.
+00003360: 0801 04fe 1003 1a01 1a01 0a02 0a01 0e01  ................
+00003370: 0e01 0e01 0e01 0e01 0401 1202 1401 0401  ................
+00003380: 1401 0801 1c01 04ff 1203 0c01 1001 0a01  ................
+00003390: 0c01 02f6 1eff 0a0c 0401 72a7 0000 0029  ..........r....)
+000033a0: 0372 0100 0000 7201 0000 0072 0100 0000  .r....r....r....
+000033b0: 2903 7248 0000 0072 4400 0000 7249 0000  ).rH...rD...rI..
+000033c0: 0029 0172 0900 0000 2919 5a05 6e75 6d70  .).r....).Z.nump
+000033d0: 7972 1600 0000 5a0d 7363 6970 792e 7370  yr....Z.scipy.sp
+000033e0: 6563 6961 6cda 0773 7065 6369 616c 7253  ecial..specialrS
+000033f0: 0000 0072 5500 0000 da08 7374 656d 746f  ...rU.....stemto
+00003400: 6f6c 7224 0000 0072 1300 0000 721c 0000  olr$...r....r...
+00003410: 0072 3300 0000 7236 0000 0072 3800 0000  .r3...r6...r8...
+00003420: 7243 0000 0072 3c00 0000 7259 0000 0072  rC...r<...rY...r
+00003430: 6200 0000 7264 0000 0072 6a00 0000 7273  b...rd...rj...rs
+00003440: 0000 0072 7800 0000 727d 0000 0072 8200  ...rx...r}...r..
+00003450: 0000 72a6 0000 0072 a700 0000 720a 0000  ..r....r....r...
+00003460: 0072 0a00 0000 720a 0000 0072 1400 0000  .r....r....r....
+00003470: da08 3c6d 6f64 756c 653e 0100 0000 7330  ..<module>....s0
+00003480: 0000 0008 000c 0108 0108 0108 0308 2008  .............. .
+00003490: 2a08 2908 0c0a 0e0a 1f02 0e02 0102 010a  *.).............
+000034a0: fb08 5608 1308 0708 070a 2608 0808 0808  ..V.......&.....
+000034b0: 070c 35                                  ..5
```

## Comparing `stemtool/util/__pycache__/fourier_reg.cpython-39.pyc` & `stemtool/util/__pycache__/fourier_reg.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:07:48 2023 UTC, .py size: 15999 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 5% similar despite different names*

```diff
@@ -1,785 +1,786 @@
-00000000: 610d 0d0a 0000 0000 e433 e163 7f3e 0000  a........3.c.>..
+00000000: 6f0d 0d0a 0000 0000 13a7 3c63 7f3e 0000  o.........<c.>..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 000c 0000 0040 0000 0073 3e01 0000 6400  .....@...s>...d.
+00000020: 0011 0000 0040 0000 0073 6801 0000 6400  .....@...sh...d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c04 6d05 5a05 6d06 5a06 0100 6400  d.l.m.Z.m.Z...d.
 00000050: 6403 6c07 6d08 5a08 6d09 5a09 6d0a 5a0a  d.l.m.Z.m.Z.m.Z.
-00000060: 6d0b 5a0b 6d0c 5a0c 0100 6508 6509 6404  m.Z.m.Z...e.e.d.
-00000070: 1900 6505 6602 1900 6506 650a 650a 6602  ..e.f...e.e.e.f.
-00000080: 1900 6405 9c02 6406 6407 8404 5a0d 6417  ..d...d.d...Z.d.
-00000090: 6508 6509 6404 1900 6505 6602 1900 650e  e.e.d...e.f...e.
-000000a0: 6506 650a 650a 6602 1900 6409 9c03 640a  e.e.e.f...d...d.
-000000b0: 640b 8405 5a0f 6508 6509 6404 1900 650c  d...Z.e.e.d...e.
-000000c0: 6602 1900 6508 6509 640c 1900 650b 6602  f...e.e.d...e.f.
-000000d0: 1900 6508 6509 6404 1900 650c 6602 1900  ..e.e.d...e.f...
-000000e0: 640d 9c03 640e 640f 8404 5a10 6418 6508  d...d.d...Z.d.e.
-000000f0: 6509 6404 1900 6505 6602 1900 650a 650a  e.d...e.f...e.e.
-00000100: 650a 650a 650a 6508 6509 6404 1900 650c  e.e.e.e.e.d...e.
-00000110: 6602 1900 6411 9c07 6412 6413 8405 5a11  f...d...d.d...Z.
-00000120: 6419 6508 6509 6404 1900 650c 6602 1900  d.e.e.d...e.f...
-00000130: 6508 6509 6404 1900 650c 6602 1900 650b  e.e.d...e.f...e.
-00000140: 6506 650a 650a 650b 650b 6508 6509 6404  e.e.e.e.e.e.e.d.
-00000150: 1900 650c 6602 1900 6605 1900 6414 9c04  ..e.f...f...d...
-00000160: 6415 6416 8405 5a12 6401 5300 291a e900  d.d...Z.d.S.)...
-00000170: 0000 004e 2902 da03 416e 79da 0554 7570  ...N)...Any..Tup
-00000180: 6c65 2905 da07 4e44 4172 7261 79da 0553  le)...NDArray..S
-00000190: 6861 7065 da03 496e 74da 0546 6c6f 6174  hape..Int..Float
-000001a0: da07 436f 6d70 6c65 787a 042a 2c20 2a29  ..Complexz.*, *)
-000001b0: 02da 0569 6d61 6765 da06 7265 7475 726e  ...image..return
-000001c0: 6301 0000 0000 0000 0000 0000 0005 0000  c...............
-000001d0: 0005 0000 0043 0000 0073 5a00 0000 7400  .....C...sZ...t.
-000001e0: 6a01 6401 7c00 6a02 6401 1900 8502 6401  j.d.|.j.d.....d.
-000001f0: 7c00 6a02 6402 1900 8502 6602 1900 5c02  |.j.d.....f...\.
-00000200: 7d01 7d02 7c01 7c00 7400 a003 7c00 a101  }.}.|.|.t...|...
-00000210: 6b02 1900 6401 1900 7d03 7c02 7c00 7400  k...d...}.|.|.t.
-00000220: a003 7c00 a101 6b02 1900 6401 1900 7d04  ..|...k...d...}.
-00000230: 7c03 7c04 6602 5300 2903 616f 0100 000a  |.|.f.S.).ao....
-00000240: 2020 2020 4669 6e64 206d 6178 696d 6120      Find maxima 
-00000250: 696e 2069 6d61 6765 0a0a 2020 2020 5061  in image..    Pa
-00000260: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00000270: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
-00000280: 653a 2049 6e70 7574 2069 6d61 6765 0a0a  e: Input image..
-00000290: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000002a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 796d 6178  -------.    ymax
-000002b0: 3a20 792d 696e 6465 7820 706f 7369 7469  : y-index positi
-000002c0: 6f6e 206f 6620 6d61 7869 6d61 0a20 2020  on of maxima.   
-000002d0: 2078 6d61 783a 2078 2d69 6e64 6578 2070   xmax: x-index p
-000002e0: 6f73 6974 696f 6e20 6f66 206d 6178 696d  osition of maxim
-000002f0: 610a 0a20 2020 204e 6f74 6573 0a20 2020  a..    Notes.   
-00000300: 202d 2d2d 2d2d 0a20 2020 2046 696e 6473   -----.    Finds
-00000310: 2074 6865 2069 6d61 6765 206d 6178 696d   the image maxim
-00000320: 612c 2061 6e64 2074 6865 6e20 6c6f 6361  a, and then loca
-00000330: 7465 7320 7468 6520 790a 2020 2020 616e  tes the y.    an
-00000340: 6420 7820 696e 6469 6365 7320 636f 7272  d x indices corr
-00000350: 6573 706f 6e64 696e 6720 746f 2074 6865  esponding to the
-00000360: 206d 6178 696d 610a 0a20 2020 2045 7861   maxima..    Exa
-00000370: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-00000380: 2d2d 0a20 2020 203e 3e3e 2079 6d2c 2078  --.    >>> ym, x
-00000390: 6d20 3d20 6669 6e64 5f6d 6178 5f69 6e64  m = find_max_ind
-000003a0: 6578 2869 6d61 6765 290a 2020 2020 7201  ex(image).    r.
-000003b0: 0000 00e9 0100 0000 2904 da02 6e70 da05  ........)...np..
-000003c0: 6d67 7269 64da 0573 6861 7065 da04 616d  mgrid..shape..am
-000003d0: 6178 2905 7209 0000 00da 0279 79da 0278  ax).r......yy..x
-000003e0: 78da 0479 6d61 78da 0478 6d61 78a9 0072  x..ymax..xmax..r
-000003f0: 1400 0000 fa3f 6275 696c 642f 6264 6973  .....?build/bdis
-00000400: 742e 6d61 636f 7378 2d31 302e 392d 7838  t.macosx-10.9-x8
-00000410: 365f 3634 2f65 6767 2f73 7465 6d74 6f6f  6_64/egg/stemtoo
-00000420: 6c2f 7574 696c 2f66 6f75 7269 6572 5f72  l/util/fourier_r
-00000430: 6567 2e70 79da 0e66 696e 645f 6d61 785f  eg.py..find_max_
-00000440: 696e 6465 7807 0000 0073 0800 0000 0016  index....s......
-00000450: 2601 1601 1601 7216 0000 00da 0143 2903  &.....r......C).
-00000460: 7209 0000 00da 056f 7264 6572 720a 0000  r......orderr...
-00000470: 0063 0200 0000 0000 0000 0000 0000 0b00  .c..............
-00000480: 0000 0700 0000 4300 0000 7390 0000 0074  ......C...s....t
-00000490: 006a 0164 017c 006a 0264 0119 0085 0264  .j.d.|.j.d.....d
-000004a0: 017c 006a 0264 0219 0085 0266 0219 005c  .|.j.d.....f...\
-000004b0: 027d 027d 0374 00a0 037c 027c 01a1 027d  .}.}.t...|.|...}
-000004c0: 0474 00a0 037c 037c 01a1 027d 0574 00a0  .t...|.|...}.t..
-000004d0: 037c 007c 01a1 027d 0674 006a 0474 00a0  .|.|...}.t.j.t..
-000004e0: 057c 06a1 0174 006a 0664 038d 027d 0774  .|...t.j.d...}.t
-000004f0: 00a0 077c 077c 0674 00a0 087c 06a1 016b  ...|.|.t...|...k
-00000500: 0219 00a1 017d 087c 047c 0819 007d 097c  .....}.|.|...}.|
-00000510: 057c 0819 007d 0a7c 097c 0a66 0253 0029  .|...}.|.|.f.S.)
-00000520: 0461 9f05 0000 0a20 2020 2046 6972 7374  .a.....    First
-00000530: 206d 6178 696d 6120 696e 2069 6d61 6765   maxima in image
-00000540: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00000550: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00000560: 2020 2020 696d 6167 653a 2049 6e70 7574      image: Input
-00000570: 2069 6d61 6765 0a20 2020 206f 7264 6572   image.    order
-00000580: 203a 207b 2743 272c 2746 272c 2027 4127   : {'C','F', 'A'
-00000590: 2c20 274b 277d 2c0a 2020 2020 2020 2020  , 'K'},.        
-000005a0: 2020 2020 6f70 7469 6f6e 616c 0a20 2020      optional.   
-000005b0: 2020 2020 2020 2020 2054 6865 2065 6c65           The ele
-000005c0: 6d65 6e74 7320 6f66 2060 6160 2061 7265  ments of `a` are
-000005d0: 2072 6561 6420 7573 696e 6720 7468 6973   read using this
-000005e0: 2069 6e64 6578 206f 7264 6572 2e20 2743   index order. 'C
-000005f0: 2720 6d65 616e 730a 2020 2020 2020 2020  ' means.        
-00000600: 2020 2020 746f 2069 6e64 6578 2074 6865      to index the
-00000610: 2065 6c65 6d65 6e74 7320 696e 2072 6f77   elements in row
-00000620: 2d6d 616a 6f72 2c20 432d 7374 796c 6520  -major, C-style 
-00000630: 6f72 6465 722c 0a20 2020 2020 2020 2020  order,.         
-00000640: 2020 2077 6974 6820 7468 6520 6c61 7374     with the last
-00000650: 2061 7869 7320 696e 6465 7820 6368 616e   axis index chan
-00000660: 6769 6e67 2066 6173 7465 7374 2c20 6261  ging fastest, ba
-00000670: 636b 2074 6f20 7468 6520 6669 7273 740a  ck to the first.
-00000680: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00000690: 2069 6e64 6578 2063 6861 6e67 696e 6720   index changing 
-000006a0: 736c 6f77 6573 742e 2020 2746 2720 6d65  slowest.  'F' me
-000006b0: 616e 7320 746f 2069 6e64 6578 2074 6865  ans to index the
-000006c0: 2065 6c65 6d65 6e74 730a 2020 2020 2020   elements.      
-000006d0: 2020 2020 2020 696e 2063 6f6c 756d 6e2d        in column-
-000006e0: 6d61 6a6f 722c 2046 6f72 7472 616e 2d73  major, Fortran-s
-000006f0: 7479 6c65 206f 7264 6572 2c20 7769 7468  tyle order, with
-00000700: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00000710: 2066 6972 7374 2069 6e64 6578 2063 6861   first index cha
-00000720: 6e67 696e 6720 6661 7374 6573 742c 2061  nging fastest, a
-00000730: 6e64 2074 6865 206c 6173 7420 696e 6465  nd the last inde
-00000740: 7820 6368 616e 6769 6e67 0a20 2020 2020  x changing.     
-00000750: 2020 2020 2020 2073 6c6f 7765 7374 2e20         slowest. 
-00000760: 4e6f 7465 2074 6861 7420 7468 6520 2743  Note that the 'C
-00000770: 2720 616e 6420 2746 2720 6f70 7469 6f6e  ' and 'F' option
-00000780: 7320 7461 6b65 206e 6f20 6163 636f 756e  s take no accoun
-00000790: 7420 6f66 0a20 2020 2020 2020 2020 2020  t of.           
-000007a0: 2074 6865 206d 656d 6f72 7920 6c61 796f   the memory layo
-000007b0: 7574 206f 6620 7468 6520 756e 6465 726c  ut of the underl
-000007c0: 7969 6e67 2061 7272 6179 2c20 616e 6420  ying array, and 
-000007d0: 6f6e 6c79 2072 6566 6572 2074 6f0a 2020  only refer to.  
-000007e0: 2020 2020 2020 2020 2020 7468 6520 6f72            the or
-000007f0: 6465 7220 6f66 2061 7869 7320 696e 6465  der of axis inde
-00000800: 7869 6e67 2e20 2027 4127 206d 6561 6e73  xing.  'A' means
-00000810: 2074 6f20 7265 6164 2074 6865 2065 6c65   to read the ele
-00000820: 6d65 6e74 7320 696e 0a20 2020 2020 2020  ments in.       
-00000830: 2020 2020 2046 6f72 7472 616e 2d6c 696b       Fortran-lik
-00000840: 6520 696e 6465 7820 6f72 6465 7220 6966  e index order if
-00000850: 2060 6160 2069 7320 466f 7274 7261 6e20   `a` is Fortran 
-00000860: 2a63 6f6e 7469 6775 6f75 732a 2069 6e0a  *contiguous* in.
-00000870: 2020 2020 2020 2020 2020 2020 6d65 6d6f              memo
-00000880: 7279 2c20 432d 6c69 6b65 206f 7264 6572  ry, C-like order
-00000890: 206f 7468 6572 7769 7365 2e20 2027 4b27   otherwise.  'K'
-000008a0: 206d 6561 6e73 2074 6f20 7265 6164 2074   means to read t
-000008b0: 6865 0a20 2020 2020 2020 2020 2020 2065  he.            e
-000008c0: 6c65 6d65 6e74 7320 696e 2074 6865 206f  lements in the o
-000008d0: 7264 6572 2074 6865 7920 6f63 6375 7220  rder they occur 
-000008e0: 696e 206d 656d 6f72 792c 2065 7863 6570  in memory, excep
-000008f0: 7420 666f 720a 2020 2020 2020 2020 2020  t for.          
-00000900: 2020 7265 7665 7273 696e 6720 7468 6520    reversing the 
-00000910: 6461 7461 2077 6865 6e20 7374 7269 6465  data when stride
-00000920: 7320 6172 6520 6e65 6761 7469 7665 2e20  s are negative. 
-00000930: 2042 7920 6465 6661 756c 742c 2027 4327   By default, 'C'
-00000940: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00000950: 6578 206f 7264 6572 2069 7320 7573 6564  ex order is used
-00000960: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-00000970: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2079     -------.    y
-00000980: 6d61 783a 2079 2d69 6e64 6578 2070 6f73  max: y-index pos
-00000990: 6974 696f 6e20 6f66 206d 6178 696d 610a  ition of maxima.
-000009a0: 2020 2020 786d 6178 3a20 782d 696e 6465      xmax: x-inde
-000009b0: 7820 706f 7369 7469 6f6e 206f 6620 6d61  x position of ma
-000009c0: 7869 6d61 0a0a 2020 2020 4e6f 7465 730a  xima..    Notes.
-000009d0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 4669      -----.    Fi
-000009e0: 6e64 7320 7468 6520 6669 7273 7420 696d  nds the first im
-000009f0: 6167 6520 6d61 7869 6d61 2069 6620 7468  age maxima if th
-00000a00: 6572 6520 6172 6520 6d75 6c74 6970 6c65  ere are multiple
-00000a10: 0a20 2020 2070 6f69 6e74 7320 7769 7468  .    points with
-00000a20: 2074 6865 2073 616d 6520 6d61 7869 6d75   the same maximu
-00000a30: 6d20 7661 6c75 652c 2061 6e64 2074 6865  m value, and the
-00000a40: 6e20 6c6f 6361 7465 730a 2020 2020 7468  n locates.    th
-00000a50: 6520 7920 616e 6420 7820 696e 6469 6365  e y and x indice
-00000a60: 7320 636f 7272 6573 706f 6e64 696e 6720  s corresponding 
-00000a70: 746f 2074 6865 206d 6178 696d 610a 0a20  to the maxima.. 
-00000a80: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00000a90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-00000aa0: 2079 6d2c 2078 6d20 3d20 6669 7273 745f   ym, xm = first_
-00000ab0: 6d61 785f 696e 6465 7828 696d 6167 6529  max_index(image)
-00000ac0: 0a20 2020 2072 0100 0000 720b 0000 00a9  .    r....r.....
-00000ad0: 01da 0564 7479 7065 2909 720c 0000 0072  ...dtype).r....r
-00000ae0: 0d00 0000 720e 0000 005a 0572 6176 656c  ....r....Z.ravel
-00000af0: da06 6172 616e 6765 da04 7369 7a65 5a04  ..arange..sizeZ.
-00000b00: 696e 745f da04 616d 696e 720f 0000 0029  int_..aminr....)
-00000b10: 0b72 0900 0000 7218 0000 0072 1000 0000  .r....r....r....
-00000b20: 7211 0000 005a 0679 795f 7276 6c5a 0678  r....Z.yy_rvlZ.x
-00000b30: 785f 7276 6c5a 0969 6d61 6765 5f72 766c  x_rvlZ.image_rvl
-00000b40: da07 696e 6469 6365 73da 0569 6e64 6578  ..indices..index
-00000b50: 7212 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
-00000b60: 1400 0000 7215 0000 00da 0f66 6972 7374  ....r......first
-00000b70: 5f6d 6178 5f69 6e64 6578 2300 0000 7312  _max_index#...s.
-00000b80: 0000 0000 2926 010c 010c 010c 0116 0118  ....)&..........
-00000b90: 0108 0108 0172 2000 0000 da01 3229 03da  .....r .....2)..
-00000ba0: 0469 6d46 54da 076f 7574 7369 7a65 720a  .imFT..outsizer.
-00000bb0: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
-00000bc0: 0b00 0000 0a00 0000 4300 0000 737e 0100  ........C...s~..
-00000bd0: 0074 006a 017c 006a 0274 006a 0364 018d  .t.j.|.j.t.j.d..
-00000be0: 027d 0274 006a 017c 0174 006a 0364 018d  .}.t.j.|.t.j.d..
-00000bf0: 027d 0374 006a 04a0 057c 00a1 017d 0474  .}.t.j...|...}.t
-00000c00: 00a0 0174 066a 07a0 0874 00a0 097c 04a1  ...t.j...t...|..
-00000c10: 01a1 01a1 017d 0574 006a 0a7c 017c 046a  .....}.t.j.|.|.j
-00000c20: 0b64 018d 027d 067c 057c 037c 021b 0014  .d...}.|.|.|....
-00000c30: 00a0 0c74 0da1 017d 0774 00a0 0e7c 037c  ...t...}.t...|.|
-00000c40: 021b 00a1 017d 087c 077c 0518 007d 097c  .....}.|.|...}.|
-00000c50: 0474 0d74 00a0 0f7c 0964 0219 000b 0064  .t.t...|.d.....d
-00000c60: 0266 02a1 0183 0174 0d74 00a0 107c 0964  .f.....t.t...|.d
-00000c70: 0219 000b 007c 0364 0219 0017 007c 0264  .....|.d.....|.d
-00000c80: 0219 0066 02a1 0183 0185 0274 0d74 00a0  ...f.......t.t..
-00000c90: 0f7c 0964 0319 000b 0064 0266 02a1 0183  .|.d.....d.f....
-00000ca0: 0174 0d74 00a0 107c 0964 0319 000b 007c  .t.t...|.d.....|
-00000cb0: 0364 0319 0017 007c 0264 0319 0066 02a1  .d.....|.d...f..
-00000cc0: 0183 0185 0266 0219 007c 0674 0d74 00a0  .....f...|.t.t..
-00000cd0: 0f7c 0964 0219 0064 0266 02a1 0183 0174  .|.d...d.f.....t
-00000ce0: 0d74 00a0 107c 0964 0219 007c 0264 0219  .t...|.d...|.d..
-00000cf0: 0017 007c 0364 0219 0066 02a1 0183 0185  ...|.d...f......
-00000d00: 0274 0d74 00a0 0f7c 0964 0319 0064 0266  .t.t...|.d...d.f
-00000d10: 02a1 0183 0174 0d74 00a0 107c 0964 0319  .....t.t...|.d..
-00000d20: 007c 0264 0319 0017 007c 0364 0319 0066  .|.d.....|.d...f
-00000d30: 02a1 0183 0185 0266 023c 0074 006a 04a0  .......f.<.t.j..
-00000d40: 117c 06a1 017c 0814 007d 0a7c 0a53 0029  .|...|...}.|.S.)
-00000d50: 0461 5202 0000 0a20 2020 2050 6164 2046  .aR....    Pad F
-00000d60: 6f75 7269 6572 2069 6d61 6765 730a 0a20  ourier images.. 
-00000d70: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00000d80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00000d90: 2069 6d46 543a 2020 2020 6e64 6172 7261   imFT:    ndarra
-00000da0: 790a 2020 2020 2020 2020 2020 2020 2049  y.             I
-00000db0: 6e70 7574 2063 6f6d 706c 6578 2061 7272  nput complex arr
-00000dc0: 6179 2077 6974 6820 4443 2069 6e20 5b31  ay with DC in [1
-00000dd0: 2c31 5d0a 0a20 2020 206f 7574 7369 7a65  ,1]..    outsize
-00000de0: 3a20 6e64 6172 7261 7920 7769 7468 2028  : ndarray with (
-00000df0: 322c 3129 2073 6861 7065 0a20 2020 2020  2,1) shape.     
-00000e00: 2020 2020 2020 2020 6e79 2c20 6e78 206f          ny, nx o
-00000e10: 6620 6f75 7470 7574 2073 697a 650a 0a20  f output size.. 
-00000e20: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00000e30: 2d2d 2d2d 2d2d 0a20 2020 2069 6d6f 7574  ------.    imout
-00000e40: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
-00000e50: 2020 2020 204f 7574 7075 7420 636f 6d70       Output comp
-00000e60: 6c65 7820 696d 6167 6520 7769 7468 2044  lex image with D
-00000e70: 4320 696e 205b 312c 315d 0a0a 2020 2020  C in [1,1]..    
-00000e80: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-00000e90: 2020 2020 5061 6473 206f 7220 6372 6f70      Pads or crop
-00000ea0: 7320 7468 6520 466f 7572 6965 7220 7472  s the Fourier tr
-00000eb0: 616e 7366 6f72 6d20 746f 2074 6865 2064  ansform to the d
-00000ec0: 6573 6972 6564 206f 7570 7574 2073 697a  esired ouput siz
-00000ed0: 652e 2054 616b 696e 670a 2020 2020 6361  e. Taking.    ca
-00000ee0: 7265 2074 6861 7420 7468 6520 7a65 726f  re that the zero
-00000ef0: 2066 7265 7175 656e 6379 2069 7320 7075   frequency is pu
-00000f00: 7420 696e 2074 6865 2063 6f72 7265 6374  t in the correct
-00000f10: 2070 6c61 6365 2066 6f72 2074 6865 206f   place for the o
-00000f20: 7574 7075 740a 2020 2020 666f 7220 7375  utput.    for su
-00000f30: 6273 6571 7565 6e74 2046 5420 6f72 2049  bsequent FT or I
-00000f40: 4654 2e20 4361 6e20 6265 2075 7365 6420  FT. Can be used 
-00000f50: 666f 7220 466f 7572 6965 7220 7472 616e  for Fourier tran
-00000f60: 7366 6f72 6d20 6261 7365 640a 2020 2020  sform based.    
-00000f70: 696e 7465 7270 6f6c 6174 696f 6e2c 2069  interpolation, i
-00000f80: 2e65 2e20 6469 7269 6368 6c65 7420 6b65  .e. dirichlet ke
-00000f90: 726e 656c 2069 6e74 6572 706f 6c61 7469  rnel interpolati
-00000fa0: 6f6e 2e0a 2020 2020 7219 0000 0072 0100  on..    r....r..
-00000fb0: 0000 720b 0000 0029 1272 0c00 0000 da07  ..r....).r......
-00000fc0: 6173 6172 7261 7972 0e00 0000 5a07 666c  asarrayr....Z.fl
-00000fd0: 6f61 7436 34da 0366 6674 5a08 6666 7473  oat64..fftZ.ffts
-00000fe0: 6869 6674 da02 7374 da04 7574 696c 7220  hift..st..utilr 
-00000ff0: 0000 00da 0361 6273 5a05 7a65 726f 7372  .....absZ.zerosr
-00001000: 1a00 0000 5a06 6173 7479 7065 da03 696e  ....Z.astype..in
-00001010: 74da 0470 726f 6472 0f00 0000 721d 0000  t..prodr....r...
-00001020: 00da 0969 6666 7473 6869 6674 290b 7222  ...ifftshift).r"
-00001030: 0000 0072 2300 0000 5a04 6e5f 696e 5a04  ...r#...Z.n_inZ.
-00001040: 6e6f 7574 5a0a 696d 4654 5f73 6869 6674  noutZ.imFT_shift
-00001050: 5a09 6365 6e74 6572 5f69 6e5a 0769 6d46  Z.center_inZ.imF
-00001060: 546f 7574 5a0a 6365 6e74 6572 5f6f 7574  ToutZ.center_out
-00001070: 5a06 6674 5f76 616c 5a0b 6365 6e74 6572  Z.ft_valZ.center
-00001080: 5f64 6966 665a 0569 6d6f 7574 7214 0000  _diffZ.imoutr...
-00001090: 0072 1400 0000 7215 0000 00da 0b66 6f75  .r....r......fou
-000010a0: 7269 6572 5f70 6164 5700 0000 7340 0000  rier_padW...s@..
-000010b0: 0000 1a12 0110 010c 0204 0110 ff04 0304  ................
-000010c0: 0106 ff06 0312 010e 0108 0a02 0118 011e  ................
-000010d0: ff04 0318 011e ff04 fd02 ff02 f902 0116  ................
-000010e0: 011c ff04 0316 011c ff04 fd02 ff02 0f10  ................
-000010f0: 0172 2c00 0000 720b 0000 0029 07da 0b69  .r,...r....)...i
-00001100: 6e70 7574 5f69 6d61 6765 da05 7573 6661  nput_image..usfa
-00001110: 63da 036e 6f72 da03 6e6f 63da 0472 6f66  c..nor..noc..rof
-00001120: 66da 0463 6f66 6672 0a00 0000 6306 0000  f..coffr....c...
-00001130: 0000 0000 0000 0000 000f 0000 0007 0000  ................
-00001140: 0043 0000 0073 1e01 0000 7400 a001 7c00  .C...s....t...|.
-00001150: a101 5c02 7d06 7d07 7c03 6401 6b02 721a  ..\.}.}.|.d.k.r.
-00001160: 7c07 7d03 7c02 6401 6b02 7226 7c06 7d02  |.}.|.d.k.r&|.}.
-00001170: 7400 6a02 a003 7400 a004 7c07 a101 a101  t.j...t...|.....
-00001180: 7400 a005 7c07 6402 1b00 a101 1800 a006  t...|.d.........
-00001190: 7407 7c07 8301 6403 6602 a101 7d08 7400  t.|...d.f...}.t.
-000011a0: a004 7c03 a101 7c05 1800 a006 7407 7c03  ..|...|.....t.|.
-000011b0: 8301 6403 6602 a101 7d09 7400 a004 7c02  ..d.f...}.t...|.
-000011c0: a101 7c04 1800 a006 7407 7c02 8301 6403  ..|.....t.|...d.
-000011d0: 6602 a101 7d0a 7400 6a02 a003 7400 a004  f...}.t.j...t...
-000011e0: 7c06 a101 a101 7400 a005 7c06 6402 1b00  |.....t...|.d...
-000011f0: a101 1800 a006 7407 7c06 8301 6403 6602  ......t.|...d.f.
-00001200: a101 7d0b 7400 a008 6404 7400 6a09 1400  ..}.t...d.t.j...
-00001210: 7c07 7c01 1400 1b00 7400 a00a 7c08 7c09  |.|.....t...|.|.
-00001220: 6a0b a102 1400 a101 7d0c 7400 a008 6404  j.......}.t...d.
-00001230: 7400 6a09 1400 7c06 7c01 1400 1b00 7400  t.j...|.|.....t.
-00001240: a00a 7c0a 7c0b 6a0b a102 1400 a101 7d0d  ..|.|.j.......}.
-00001250: 7400 a00a 7400 a00a 7c0d 7c00 a102 7c0c  t...t...|.|...|.
-00001260: a102 7d0e 7c0e 5300 2905 61a8 0500 000a  ..}.|.S.).a.....
-00001270: 2020 2020 5570 7361 6d70 6c65 6420 6469      Upsampled di
-00001280: 7363 7265 7465 2046 6f75 7269 6572 2074  screte Fourier t
-00001290: 7261 6e73 666f 726d 0a0a 2020 2020 5061  ransform..    Pa
-000012a0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000012b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 696e 7075  -------.    inpu
-000012c0: 745f 696d 6167 653a 2049 6e70 7574 2069  t_image: Input i
-000012d0: 6d61 6765 0a20 2020 2075 7366 6163 3a20  mage.    usfac: 
-000012e0: 2020 2020 2020 5570 7361 6d70 6c69 6e67        Upsampling
-000012f0: 2046 6163 746f 722e 2044 6566 6175 6c74   Factor. Default
-00001300: 2069 7320 310a 2020 2020 6e6f 723a 2020   is 1.    nor:  
-00001310: 2020 2020 2020 204e 756d 6265 7220 6f66         Number of
-00001320: 2070 6978 656c 7320 696e 2074 6865 206f   pixels in the o
-00001330: 7574 7075 7420 7570 7361 6d70 6c65 6420  utput upsampled 
-00001340: 4446 542c 2069 6e0a 2020 2020 2020 2020  DFT, in.        
-00001350: 2020 2020 2020 2020 2075 6e69 7473 206f           units o
-00001360: 6620 7570 7361 6d70 6c65 6420 7069 7865  f upsampled pixe
-00001370: 6c73 2028 6465 6661 756c 7420 3d20 7369  ls (default = si
-00001380: 7a65 2869 6e29 290a 2020 2020 6e6f 633a  ze(in)).    noc:
-00001390: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-000013a0: 6f66 2070 6978 656c 7320 696e 2074 6865  of pixels in the
-000013b0: 206f 7574 7075 7420 7570 7361 6d70 6c65   output upsample
-000013c0: 6420 4446 542c 2069 6e0a 2020 2020 2020  d DFT, in.      
-000013d0: 2020 2020 2020 2020 2020 2075 6e69 7473             units
-000013e0: 206f 6620 7570 7361 6d70 6c65 6420 7069   of upsampled pi
-000013f0: 7865 6c73 2028 6465 6661 756c 7420 3d20  xels (default = 
-00001400: 7369 7a65 2869 6e29 290a 2020 2020 726f  size(in)).    ro
-00001410: 6666 3a20 2020 2020 2020 2052 6f77 206f  ff:        Row o
-00001420: 6666 7365 7473 2c20 616c 6c6f 7720 746f  ffsets, allow to
-00001430: 2073 6869 6674 2074 6865 206f 7574 7075   shift the outpu
-00001440: 7420 6172 7261 7920 746f 0a20 2020 2020  t array to.     
-00001450: 2020 2020 2020 2020 2020 2020 6120 7265              a re
-00001460: 6769 6f6e 206f 6620 696e 7465 7265 7374  gion of interest
-00001470: 206f 6e20 7468 6520 4446 5420 2864 6566   on the DFT (def
-00001480: 6175 6c74 203d 2030 290a 2020 2020 636f  ault = 0).    co
-00001490: 6666 3a20 2020 2020 2020 2043 6f6c 756d  ff:        Colum
-000014a0: 6e20 6f66 6673 6574 732c 2061 6c6c 6f77  n offsets, allow
-000014b0: 2074 6f20 7368 6966 7420 7468 6520 6f75   to shift the ou
-000014c0: 7470 7574 2061 7272 6179 2074 6f0a 2020  tput array to.  
-000014d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000014e0: 2072 6567 696f 6e20 6f66 2069 6e74 6572   region of inter
-000014f0: 6573 7420 6f6e 2074 6865 2044 4654 2028  est on the DFT (
-00001500: 6465 6661 756c 7420 3d20 3029 0a0a 0a20  default = 0)... 
-00001510: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00001520: 2d2d 2d2d 2d2d 0a20 2020 206f 7574 5f66  ------.    out_f
-00001530: 6674 3a20 5570 7361 6d70 6c65 6420 466f  ft: Upsampled Fo
-00001540: 7572 6965 7220 7472 616e 7366 6f72 6d0a  urier transform.
-00001550: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-00001560: 2d2d 2d2d 0a20 2020 2052 6563 6965 7665  ----.    Recieve
-00001570: 7320 4443 2069 6e20 7570 7065 7220 6c65  s DC in upper le
-00001580: 6674 2063 6f72 6e65 722c 2069 6d61 6765  ft corner, image
-00001590: 2063 656e 7465 7220 6d75 7374 2062 6520   center must be 
-000015a0: 696e 205b 302c 305d 0a20 2020 2054 6869  in [0,0].    Thi
-000015b0: 7320 636f 6465 2069 7320 696e 7465 6e64  s code is intend
-000015c0: 6564 2074 6f20 7072 6f76 6964 6520 7468  ed to provide th
-000015d0: 6520 7361 6d65 2072 6573 756c 7420 6173  e same result as
-000015e0: 2069 6620 7468 6520 666f 6c6c 6f77 696e   if the followin
-000015f0: 670a 2020 2020 6f70 6572 6174 696f 6e73  g.    operations
-00001600: 2077 6572 6520 7065 7266 6f72 6d65 640a   were performed.
-00001610: 2020 2020 2d20 456d 6265 6420 7468 6520      - Embed the 
-00001620: 6172 7261 7920 2269 6e70 7574 5f69 6d61  array "input_ima
-00001630: 6765 2220 696e 2061 6e20 6172 7261 7920  ge" in an array 
-00001640: 7468 6174 2069 7320 7573 6661 6320 7469  that is usfac ti
-00001650: 6d65 7320 6c61 7267 6572 2069 6e20 6561  mes larger in ea
-00001660: 6368 0a20 2020 2064 696d 656e 7369 6f6e  ch.    dimension
-00001670: 2e20 6966 6674 7368 6966 7420 746f 2062  . ifftshift to b
-00001680: 7269 6e67 2074 6865 2063 656e 7465 7220  ring the center 
-00001690: 6f66 2074 6865 2069 6d61 6765 2074 6f20  of the image to 
-000016a0: 2831 2c31 292e 0a20 2020 202d 2054 616b  (1,1)..    - Tak
-000016b0: 6520 7468 6520 4646 5420 6f66 2074 6865  e the FFT of the
-000016c0: 206c 6172 6765 7220 6172 7261 790a 2020   larger array.  
-000016d0: 2020 2d20 4578 7472 6163 7420 616e 205b    - Extract an [
-000016e0: 6e6f 722c 206e 6f63 5d20 7265 6769 6f6e  nor, noc] region
-000016f0: 206f 6620 7468 6520 7265 7375 6c74 2e20   of the result. 
-00001700: 5374 6172 7469 6e67 2077 6974 6820 7468  Starting with th
-00001710: 650a 2020 2020 5b72 6f66 662b 3120 636f  e.    [roff+1 co
-00001720: 6666 2b31 5d20 656c 656d 656e 742e 0a20  ff+1] element.. 
-00001730: 2020 2049 7420 6163 6869 6576 6573 2074     It achieves t
-00001740: 6869 7320 7265 7375 6c74 2062 7920 636f  his result by co
-00001750: 6d70 7574 696e 6720 7468 6520 4446 5420  mputing the DFT 
-00001760: 696e 2074 6865 206f 7574 7075 7420 6172  in the output ar
-00001770: 7261 7920 7769 7468 6f75 740a 2020 2020  ray without.    
-00001780: 7468 6520 6e65 6564 2074 6f20 7a65 726f  the need to zero
-00001790: 7061 642e 204d 7563 6820 6661 7374 6572  pad. Much faster
-000017a0: 2061 6e64 206d 656d 6f72 7920 6566 6669   and memory effi
-000017b0: 6369 656e 7420 7468 616e 2074 6865 0a20  cient than the. 
-000017c0: 2020 207a 6572 6f2d 7061 6464 6564 2046     zero-padded F
-000017d0: 4654 2061 7070 726f 6163 6820 6966 205b  FT approach if [
-000017e0: 6e6f 7220 6e6f 635d 2061 7265 206d 7563  nor noc] are muc
-000017f0: 6820 736d 616c 6c65 7220 7468 616e 205b  h smaller than [
-00001800: 6e72 2a75 7366 6163 206e 632a 7573 6661  nr*usfac nc*usfa
-00001810: 635d 0a20 2020 2072 0100 0000 e902 0000  c].    r........
-00001820: 0072 0b00 0000 7900 0000 0000 0000 0000  .r....y.........
-00001830: 0000 0000 0000 c029 0c72 0c00 0000 720e  .......).r....r.
-00001840: 0000 0072 2500 0000 722b 0000 0072 1b00  ...r%...r+...r..
-00001850: 0000 da05 666c 6f6f 725a 0772 6573 6861  ....floorZ.resha
-00001860: 7065 7229 0000 00da 0365 7870 da02 7069  per).....exp..pi
-00001870: da06 6d61 746d 756c da01 5429 0f72 2d00  ..matmul..T).r-.
-00001880: 0000 722e 0000 0072 2f00 0000 7230 0000  ..r....r/...r0..
-00001890: 0072 3100 0000 7232 0000 00da 026e 72da  .r1...r2.....nr.
-000018a0: 026e 635a 066e 635f 6172 725a 076e 6f63  .ncZ.nc_arrZ.noc
-000018b0: 5f61 7272 5a07 6e6f 725f 6172 725a 066e  _arrZ.nor_arrZ.n
-000018c0: 725f 6172 725a 056b 6572 6e63 5a05 6b65  r_arrZ.kerncZ.ke
-000018d0: 726e 725a 076f 7574 5f66 6674 7214 0000  rnrZ.out_fftr...
-000018e0: 0072 1400 0000 7215 0000 00da 0664 6674  .r....r......dft
-000018f0: 7570 7393 0000 0073 3a00 0000 002b 0e02  ups....s:....+..
-00001900: 0801 0401 0801 0402 1eff 0202 0afe 0403  ................
-00001910: 0e01 0aff 0403 0e01 0aff 0404 1eff 0202  ................
-00001920: 0afe 0403 0401 1eff 0403 0401 1eff 0403  ................
-00001930: 0401 0cff 0403 723b 0000 0029 04da 0662  ......r;...)...b
-00001940: 7566 3166 74da 0662 7566 3266 7472 2e00  uf1ft..buf2ftr..
-00001950: 0000 720a 0000 0063 0300 0000 0000 0000  ..r....c........
-00001960: 0000 0000 1f00 0000 0b00 0000 4300 0000  ............C...
-00001970: 73ce 0300 0074 00a0 017c 01a1 015c 027d  s....t...|...\.}
-00001980: 037d 0474 006a 02a0 0374 006a 0474 00a0  .}.t.j...t.j.t..
-00001990: 057c 0364 011b 00a1 010b 0074 00a0 067c  .|.d.......t...|
-000019a0: 0364 011b 00a1 0164 0264 038d 03a1 017d  .d.....d.d.....}
-000019b0: 0574 006a 02a0 0374 006a 0474 00a0 057c  .t.j...t.j.t...|
-000019c0: 0464 011b 00a1 010b 0074 00a0 067c 0464  .d.......t...|.d
-000019d0: 011b 00a1 0164 0264 038d 03a1 017d 0664  .....d.d.....}.d
-000019e0: 047d 0774 00a0 077c 0074 00a0 087c 01a1  .}.t...|.t...|..
-000019f0: 01a1 027d 0864 047d 0964 047d 0a7c 0264  ...}.d.}.d.}.|.d
-00001a00: 046b 0272 b07c 0774 00a0 0974 00a0 077c  .k.r.|.t...t...|
-00001a10: 0074 00a0 087c 01a1 01a1 02a1 0137 007d  .t...|.......7.}
-00001a20: 0790 026e 207c 0264 026b 0290 0172 0c74  ...n |.d.k...r.t
-00001a30: 006a 02a0 0a7c 08a1 017d 0b74 00a0 0b7c  .j...|...}.t...|
-00001a40: 0ba1 017d 0c74 0c6a 0da0 0e7c 0ca1 015c  ...}.t.j...|...\
-00001a50: 027d 097d 0a7c 077c 0b7c 097c 0a66 0219  .}.}.|.|.|.|.f..
-00001a60: 007c 0314 007c 0414 0037 007d 077c 057c  .|...|...7.}.|.|
-00001a70: 0919 007d 097c 067c 0a19 007d 0a90 016e  ...}.|.|...}...n
-00001a80: c47c 0264 026b 0490 0272 d074 006a 02a0  .|.d.k...r.t.j..
-00001a90: 0a74 0c6a 0da0 0f7c 0874 00a0 1064 017c  .t.j...|.t...d.|
-00001aa0: 0314 0064 017c 0414 0066 02a1 01a1 02a1  ...d.|...f......
-00001ab0: 017d 0d74 00a0 0b7c 0da1 017d 0e74 0c6a  .}.t...|...}.t.j
-00001ac0: 0da0 0e7c 0ea1 015c 027d 097d 0a7c 077c  ...|...\.}.}.|.|
-00001ad0: 0d7c 097c 0a66 0219 007c 0314 007c 0414  .|.|.f...|...|..
-00001ae0: 0037 007d 0774 006a 02a0 0374 006a 0474  .7.}.t.j...t.j.t
-00001af0: 00a0 057c 03a1 010b 0074 00a0 067c 03a1  ...|.....t...|..
-00001b00: 0164 0264 038d 03a1 017d 0f74 006a 02a0  .d.d.....}.t.j..
-00001b10: 0374 006a 0474 00a0 057c 04a1 010b 0074  .t.j.t...|.....t
-00001b20: 00a0 067c 04a1 0164 0264 038d 03a1 017d  ...|...d.d.....}
-00001b30: 107c 0f7c 0919 0064 011b 007d 097c 107c  .|.|...d...}.|.|
-00001b40: 0a19 0064 011b 007d 0a7c 0264 016b 0490  ...d...}.|.d.k..
-00001b50: 0272 b474 00a0 117c 097c 0214 00a1 017c  .r.t...|.|.....|
-00001b60: 021b 007d 0974 00a0 117c 0a7c 0214 00a1  ...}.t...|.|....
-00001b70: 017c 021b 007d 0a74 00a0 0574 00a0 067c  .|...}.t...t...|
-00001b80: 0264 0514 00a1 0164 011b 00a1 017d 117c  .d.....d.....}.|
-00001b90: 117c 097c 0214 0018 007d 127c 117c 0a7c  .|.|.....}.|.|.|
-00001ba0: 0214 0018 007d 1374 00a0 0874 0c6a 0da0  .....}.t...t.j..
-00001bb0: 127c 0874 00a0 067c 0264 0514 00a1 0174  .|.t...|.d.....t
-00001bc0: 00a0 067c 0264 0514 00a1 017c 027c 127c  ...|.d.....|.|.|
-00001bd0: 13a1 06a1 017d 1474 00a0 0b7c 14a1 017d  .....}.t...|...}
-00001be0: 1574 0c6a 0da0 0e7c 15a1 015c 027d 167d  .t.j...|...\.}.}
-00001bf0: 177c 077c 147c 167c 1766 0219 0037 007d  .|.|.|.|.f...7.}
-00001c00: 077c 167c 1118 007d 167c 177c 1118 007d  .|.|...}.|.|...}
-00001c10: 177c 097c 167c 021b 0017 007d 097c 0a7c  .|.|.|.....}.|.|
-00001c20: 177c 021b 0017 007d 0a7c 0364 026b 0290  .|.....}.|.d.k..
-00001c30: 0272 c264 047d 097c 0464 026b 0290 0272  .r.d.}.|.d.k...r
-00001c40: d064 047d 0a74 00a0 0974 00a0 0b7c 00a1  .d.}.t...t...|..
-00001c50: 0164 0113 00a1 017d 1874 00a0 0974 00a0  .d.....}.t...t..
-00001c60: 0b7c 01a1 0164 0113 00a1 017d 1974 00a0  .|...d.....}.t..
-00001c70: 0b64 0674 00a0 0b7c 07a1 0164 0113 007c  .d.t...|...d...|
-00001c80: 187c 1914 001b 0018 00a1 0164 0713 007d  .|.........d...}
-00001c90: 1a74 00a0 137c 07a1 017d 1b74 006a 147c  .t...|...}.t.j.|
-00001ca0: 017c 016a 1564 088d 027d 1c7c 0264 046b  .|.j.d...}.|.d.k
-00001cb0: 0490 0372 a074 00a0 167c 067c 05a1 025c  ...r.t...|.|...\
-00001cc0: 027d 1d7d 1e7c 1e7c 031b 007d 1e7c 1d7c  .}.}.|.|...}.|.|
-00001cd0: 041b 007d 1d7c 1c74 00a0 1764 097c 1b14  ...}.|.t...d.|..
-00001ce0: 00a1 0174 00a0 077c 0174 00a0 1764 0a74  ...t...|.t...d.t
-00001cf0: 006a 1814 0064 0b14 007c 097c 1e14 007c  .j...d...|.|...|
-00001d00: 0a7c 1d14 0017 0014 00a1 01a1 0214 0037  .|.............7
-00001d10: 007d 1c6e 207c 0264 046b 0290 0372 c07c  .}.n |.d.k...r.|
-00001d20: 1c7c 0174 00a0 1764 097c 1b14 00a1 0114  .|.t...d.|......
-00001d30: 0037 007d 1c7c 097c 0a7c 1b7c 1a7c 1c66  .7.}.|.|.|.|.|.f
-00001d40: 0553 0029 0c61 ee0f 0000 0a20 2020 2055  .S.).a.....    U
-00001d50: 7073 616d 706c 6564 2046 4654 2072 6567  psampled FFT reg
-00001d60: 6973 7472 6174 696f 6e20 6265 7477 6565  istration betwee
-00001d70: 6e20 7477 6f20 696d 6167 6573 0a0a 2020  n two images..  
-00001d80: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00001d90: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00001da0: 6275 6631 6674 3a20 6e64 6172 7261 790a  buf1ft: ndarray.
-00001db0: 2020 2020 2020 2020 2020 2020 466f 7572              Four
-00001dc0: 6965 7220 7472 616e 7366 6f72 6d20 6f66  ier transform of
-00001dd0: 2072 6566 6572 656e 6365 2069 6d61 6765   reference image
-00001de0: 2c0a 2020 2020 2020 2020 2020 2020 4443  ,.            DC
-00001df0: 2069 6e20 2831 2c31 2920 2020 5b44 4f20   in (1,1)   [DO 
-00001e00: 4e4f 5420 4646 5453 4849 4654 5d0a 2020  NOT FFTSHIFT].  
-00001e10: 2020 6275 6632 6674 3a20 6e64 6172 7261    buf2ft: ndarra
-00001e20: 790a 2020 2020 2020 2020 2020 2020 466f  y.            Fo
-00001e30: 7572 6965 7220 7472 616e 7366 6f72 6d20  urier transform 
-00001e40: 6f66 2069 6d61 6765 2074 6f20 7265 6769  of image to regi
-00001e50: 7374 6572 2c0a 2020 2020 2020 2020 2020  ster,.          
-00001e60: 2020 4443 2069 6e20 2831 2c31 2920 5b44    DC in (1,1) [D
-00001e70: 4f20 4e4f 5420 4646 5453 4849 4654 5d0a  O NOT FFTSHIFT].
-00001e80: 2020 2020 7573 6661 633a 2020 696e 740a      usfac:  int.
-00001e90: 2020 2020 2020 2020 2020 2020 5570 7361              Upsa
-00001ea0: 6d70 6c69 6e67 2066 6163 746f 7220 2869  mpling factor (i
-00001eb0: 6e74 6567 6572 292e 2049 6d61 6765 7320  nteger). Images 
-00001ec0: 7769 6c6c 2062 6520 7265 6769 7374 6572  will be register
-00001ed0: 6564 2074 6f0a 2020 2020 2020 2020 2020  ed to.          
-00001ee0: 2020 7769 7468 696e 2031 2f75 7366 6163    within 1/usfac
-00001ef0: 206f 6620 6120 7069 7865 6c2e 2046 6f72   of a pixel. For
-00001f00: 2065 7861 6d70 6c65 2075 7366 6163 203d   example usfac =
-00001f10: 2032 3020 6d65 616e 7320 7468 650a 2020   20 means the.  
-00001f20: 2020 2020 2020 2020 2020 696d 6167 6573            images
-00001f30: 2077 696c 6c20 6265 2072 6567 6973 7465   will be registe
-00001f40: 7265 6420 7769 7468 696e 2031 2f32 3020  red within 1/20 
-00001f50: 6f66 2061 2070 6978 656c 2e20 2864 6566  of a pixel. (def
-00001f60: 6175 6c74 203d 2031 290a 0a20 2020 2052  ault = 1)..    R
-00001f70: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00001f80: 2d2d 0a20 2020 2072 6f77 5f73 6869 6674  --.    row_shift
-00001f90: 3a20 2020 2020 2066 6c6f 6174 0a20 2020  :      float.   
-00001fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fb0: 2050 6978 656c 2073 6869 6674 2069 6e20   Pixel shift in 
-00001fc0: 6361 7274 6573 6961 6e20 7920 6469 7265  cartesian y dire
-00001fd0: 6374 696f 6e0a 2020 2020 636f 6c5f 7368  ction.    col_sh
-00001fe0: 6966 743a 2020 2020 2020 666c 6f61 740a  ift:      float.
-00001ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002000: 2020 2020 5069 7865 6c20 7368 6966 7420      Pixel shift 
-00002010: 696e 2063 6172 7465 7369 616e 2078 2064  in cartesian x d
-00002020: 6972 6563 7469 6f6e 0a20 2020 2065 7272  irection.    err
-00002030: 6f72 3a20 2020 2020 2020 2020 2066 6c6f  or:          flo
-00002040: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-00002050: 2020 2020 2020 2054 7261 6e73 6c61 7469         Translati
-00002060: 6f6e 2069 6e76 6172 6961 6e74 206e 6f72  on invariant nor
-00002070: 6d61 6c69 7a65 6420 524d 5320 6572 726f  malized RMS erro
-00002080: 7220 6265 7477 6565 6e20 6620 616e 6420  r between f and 
-00002090: 670a 2020 2020 7068 6173 655f 6469 6666  g.    phase_diff
-000020a0: 3a20 2020 2020 666c 6f61 740a 2020 2020  :     float.    
-000020b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000020c0: 476c 6f62 616c 2070 6861 7365 2064 6966  Global phase dif
-000020d0: 6665 7265 6e63 6520 6265 7477 6565 6e20  ference between 
-000020e0: 7468 6520 7477 6f20 696d 6167 6573 2028  the two images (
-000020f0: 7368 6f75 6c64 2062 650a 2020 2020 2020  should be.      
-00002100: 2020 2020 2020 2020 2020 2020 2020 7a65                ze
-00002110: 726f 2069 6620 696d 6167 6573 2061 7265  ro if images are
-00002120: 206e 6f6e 2d6e 6567 6174 6976 6529 2e0a   non-negative)..
-00002130: 2020 2020 7265 6769 7374 6572 6564 5f66      registered_f
-00002140: 6674 3a20 6e64 6172 7261 790a 2020 2020  ft: ndarray.    
-00002150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002160: 466f 7572 6965 7220 7472 616e 7366 6f72  Fourier transfor
-00002170: 6d20 6f66 2072 6567 6973 7465 7265 6420  m of registered 
-00002180: 7665 7273 696f 6e20 6f66 2062 7566 3266  version of buf2f
-00002190: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-000021a0: 2020 2020 2020 2074 6865 2067 6c6f 6261         the globa
-000021b0: 6c20 7068 6173 6520 6469 6666 6572 656e  l phase differen
-000021c0: 6365 2069 7320 636f 6d70 656e 7361 7465  ce is compensate
-000021d0: 6420 666f 722e 0a0a 2020 2020 4e6f 7465  d for...    Note
-000021e0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
-000021f0: 4566 6669 6369 656e 7420 7375 6270 6978  Efficient subpix
-00002200: 656c 2069 6d61 6765 2072 6567 6973 7472  el image registr
-00002210: 6174 696f 6e20 6279 2063 726f 7373 636f  ation by crossco
-00002220: 7272 656c 6174 696f 6e2e 2054 6869 7320  rrelation. This 
-00002230: 636f 6465 0a20 2020 2067 6976 6573 2074  code.    gives t
-00002240: 6865 2073 616d 6520 7072 6563 6973 696f  he same precisio
-00002250: 6e20 6173 2074 6865 2046 4654 2075 7073  n as the FFT ups
-00002260: 616d 706c 6564 2063 726f 7373 2063 6f72  ampled cross cor
-00002270: 7265 6c61 7469 6f6e 2069 6e20 610a 2020  relation in a.  
-00002280: 2020 736d 616c 6c20 6672 6163 7469 6f6e    small fraction
-00002290: 206f 6620 7468 6520 636f 6d70 7574 6174   of the computat
-000022a0: 696f 6e20 7469 6d65 2061 6e64 2077 6974  ion time and wit
-000022b0: 6820 7265 6475 6365 6420 6d65 6d6f 7279  h reduced memory
-000022c0: 0a20 2020 2072 6571 7569 7265 6d65 6e74  .    requirement
-000022d0: 732e 2049 7420 6f62 7461 696e 7320 616e  s. It obtains an
-000022e0: 2069 6e69 7469 616c 2065 7374 696d 6174   initial estimat
-000022f0: 6520 6f66 2074 6865 2063 726f 7373 636f  e of the crossco
-00002300: 7272 656c 6174 696f 6e20 7065 616b 0a20  rrelation peak. 
-00002310: 2020 2062 7920 616e 2046 4654 2061 6e64     by an FFT and
-00002320: 2074 6865 6e20 7265 6669 6e65 7320 7468   then refines th
-00002330: 6520 7368 6966 7420 6573 7469 6d61 7469  e shift estimati
-00002340: 6f6e 2062 7920 7570 7361 6d70 6c69 6e67  on by upsampling
-00002350: 2074 6865 2044 4654 0a20 2020 206f 6e6c   the DFT.    onl
-00002360: 7920 696e 2061 2073 6d61 6c6c 206e 6569  y in a small nei
-00002370: 6768 626f 7268 6f6f 6420 6f66 2074 6861  ghborhood of tha
-00002380: 7420 6573 7469 6d61 7465 2062 7920 6d65  t estimate by me
-00002390: 616e 7320 6f66 2061 0a20 2020 206d 6174  ans of a.    mat
-000023a0: 7269 782d 6d75 6c74 6970 6c79 2044 4654  rix-multiply DFT
-000023b0: 2e20 5769 7468 2074 6869 7320 7072 6f63  . With this proc
-000023c0: 6564 7572 6520 616c 6c20 7468 6520 696d  edure all the im
-000023d0: 6167 6520 706f 696e 7473 2061 7265 2075  age points are u
-000023e0: 7365 6420 746f 0a20 2020 2063 6f6d 7075  sed to.    compu
-000023f0: 7465 2074 6865 2075 7073 616d 706c 6564  te the upsampled
-00002400: 2063 726f 7373 636f 7272 656c 6174 696f   crosscorrelatio
-00002410: 6e2e 0a0a 2020 2020 5265 6665 7265 6e63  n...    Referenc
-00002420: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  es.    ---------
-00002430: 2d0a 2020 2020 2e2e 205b 315d 204d 616e  -.    .. [1] Man
-00002440: 7565 6c20 4775 697a 6172 2d53 6963 6169  uel Guizar-Sicai
-00002450: 726f 732c 2053 616d 7565 6c20 542e 2054  ros, Samuel T. T
-00002460: 6875 726d 616e 2c20 616e 6420 4a61 6d65  hurman, and Jame
-00002470: 7320 522e 2046 6965 6e75 702c 0a20 2020  s R. Fienup,.   
-00002480: 2020 2020 2245 6666 6963 6965 6e74 2073      "Efficient s
-00002490: 7562 7069 7865 6c20 696d 6167 6520 7265  ubpixel image re
-000024a0: 6769 7374 7261 7469 6f6e 2061 6c67 6f72  gistration algor
-000024b0: 6974 686d 732c 2220 4f70 742e 204c 6574  ithms," Opt. Let
-000024c0: 742e 2033 332c 0a20 2020 2020 2020 3135  t. 33,.       15
-000024d0: 362d 3135 3820 2832 3030 3829 2e0a 0a20  6-158 (2008)... 
-000024e0: 2020 2043 6f70 7972 6967 6874 0a20 2020     Copyright.   
-000024f0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00002500: 436f 7079 7269 6768 7420 2863 2920 3230  Copyright (c) 20
-00002510: 3136 2c20 4d61 6e75 656c 2047 7569 7a61  16, Manuel Guiza
-00002520: 7220 5369 6361 6972 6f73 2c20 4a61 6d65  r Sicairos, Jame
-00002530: 7320 522e 2046 6965 6e75 702c 2055 6e69  s R. Fienup, Uni
-00002540: 7665 7273 6974 7920 6f66 2052 6f63 6865  versity of Roche
-00002550: 7374 6572 0a20 2020 2041 6c6c 2072 6967  ster.    All rig
-00002560: 6874 7320 7265 7365 7276 6564 2e0a 0a20  hts reserved... 
-00002570: 2020 2052 6564 6973 7472 6962 7574 696f     Redistributio
-00002580: 6e20 616e 6420 7573 6520 696e 2073 6f75  n and use in sou
-00002590: 7263 6520 616e 6420 6269 6e61 7279 2066  rce and binary f
-000025a0: 6f72 6d73 2c20 7769 7468 206f 7220 7769  orms, with or wi
-000025b0: 7468 6f75 740a 2020 2020 6d6f 6469 6669  thout.    modifi
-000025c0: 6361 7469 6f6e 2c20 6172 6520 7065 726d  cation, are perm
-000025d0: 6974 7465 6420 7072 6f76 6964 6564 2074  itted provided t
-000025e0: 6861 7420 7468 6520 666f 6c6c 6f77 696e  hat the followin
-000025f0: 6720 636f 6e64 6974 696f 6e73 2061 7265  g conditions are
-00002600: 0a20 2020 206d 6574 3a0a 2020 2020 2a20  .    met:.    * 
-00002610: 5265 6469 7374 7269 6275 7469 6f6e 7320  Redistributions 
-00002620: 6f66 2073 6f75 7263 6520 636f 6465 206d  of source code m
-00002630: 7573 7420 7265 7461 696e 2074 6865 2061  ust retain the a
-00002640: 626f 7665 2063 6f70 7972 6967 6874 0a20  bove copyright. 
-00002650: 2020 2020 206e 6f74 6963 652c 2074 6869       notice, thi
-00002660: 7320 6c69 7374 206f 6620 636f 6e64 6974  s list of condit
-00002670: 696f 6e73 2061 6e64 2074 6865 2066 6f6c  ions and the fol
-00002680: 6c6f 7769 6e67 2064 6973 636c 6169 6d65  lowing disclaime
-00002690: 722e 0a20 2020 202a 2052 6564 6973 7472  r..    * Redistr
-000026a0: 6962 7574 696f 6e73 2069 6e20 6269 6e61  ibutions in bina
-000026b0: 7279 2066 6f72 6d20 6d75 7374 2072 6570  ry form must rep
-000026c0: 726f 6475 6365 2074 6865 2061 626f 7665  roduce the above
-000026d0: 2063 6f70 7972 6967 6874 0a20 2020 2020   copyright.     
-000026e0: 206e 6f74 6963 652c 2074 6869 7320 6c69   notice, this li
-000026f0: 7374 206f 6620 636f 6e64 6974 696f 6e73  st of conditions
-00002700: 2061 6e64 2074 6865 2066 6f6c 6c6f 7769   and the followi
-00002710: 6e67 2064 6973 636c 6169 6d65 7220 696e  ng disclaimer in
-00002720: 0a20 2020 2020 2074 6865 2064 6f63 756d  .      the docum
-00002730: 656e 7461 7469 6f6e 2061 6e64 2f6f 7220  entation and/or 
-00002740: 6f74 6865 7220 6d61 7465 7269 616c 7320  other materials 
-00002750: 7072 6f76 6964 6564 2077 6974 6820 7468  provided with th
-00002760: 6520 6469 7374 7269 6275 7469 6f6e 0a20  e distribution. 
-00002770: 2020 202a 204e 6569 7468 6572 2074 6865     * Neither the
-00002780: 206e 616d 6520 6f66 2074 6865 2055 6e69   name of the Uni
-00002790: 7665 7273 6974 7920 6f66 2052 6f63 6865  versity of Roche
-000027a0: 7374 6572 206e 6f72 2074 6865 206e 616d  ster nor the nam
-000027b0: 6573 0a20 2020 2020 206f 6620 6974 7320  es.      of its 
-000027c0: 636f 6e74 7269 6275 746f 7273 206d 6179  contributors may
-000027d0: 2062 6520 7573 6564 2074 6f20 656e 646f   be used to endo
-000027e0: 7273 6520 6f72 2070 726f 6d6f 7465 2070  rse or promote p
-000027f0: 726f 6475 6374 7320 6465 7269 7665 640a  roducts derived.
-00002800: 2020 2020 2020 6672 6f6d 2074 6869 7320        from this 
-00002810: 736f 6674 7761 7265 2077 6974 686f 7574  software without
-00002820: 2073 7065 6369 6669 6320 7072 696f 7220   specific prior 
-00002830: 7772 6974 7465 6e20 7065 726d 6973 7369  written permissi
-00002840: 6f6e 2e0a 0a20 2020 2054 4849 5320 534f  on...    THIS SO
-00002850: 4654 5741 5245 2049 5320 5052 4f56 4944  FTWARE IS PROVID
-00002860: 4544 2042 5920 5448 4520 434f 5059 5249  ED BY THE COPYRI
-00002870: 4748 5420 484f 4c44 4552 5320 414e 4420  GHT HOLDERS AND 
-00002880: 434f 4e54 5249 4255 544f 5253 2022 4153  CONTRIBUTORS "AS
-00002890: 2049 5322 0a20 2020 2041 4e44 2041 4e59   IS".    AND ANY
-000028a0: 2045 5850 5245 5353 204f 5220 494d 504c   EXPRESS OR IMPL
-000028b0: 4945 4420 5741 5252 414e 5449 4553 2c20  IED WARRANTIES, 
-000028c0: 494e 434c 5544 494e 472c 2042 5554 204e  INCLUDING, BUT N
-000028d0: 4f54 204c 494d 4954 4544 2054 4f2c 2054  OT LIMITED TO, T
-000028e0: 4845 0a20 2020 2049 4d50 4c49 4544 2057  HE.    IMPLIED W
-000028f0: 4152 5241 4e54 4945 5320 4f46 204d 4552  ARRANTIES OF MER
-00002900: 4348 414e 5441 4249 4c49 5459 2041 4e44  CHANTABILITY AND
-00002910: 2046 4954 4e45 5353 2046 4f52 2041 2050   FITNESS FOR A P
-00002920: 4152 5449 4355 4c41 5220 5055 5250 4f53  ARTICULAR PURPOS
-00002930: 450a 2020 2020 4152 4520 4449 5343 4c41  E.    ARE DISCLA
-00002940: 494d 4544 2e20 494e 204e 4f20 4556 454e  IMED. IN NO EVEN
-00002950: 5420 5348 414c 4c20 5448 4520 434f 5059  T SHALL THE COPY
-00002960: 5249 4748 5420 4f57 4e45 5220 4f52 2043  RIGHT OWNER OR C
-00002970: 4f4e 5452 4942 5554 4f52 5320 4245 0a20  ONTRIBUTORS BE. 
-00002980: 2020 204c 4941 424c 4520 464f 5220 414e     LIABLE FOR AN
-00002990: 5920 4449 5245 4354 2c20 494e 4449 5245  Y DIRECT, INDIRE
-000029a0: 4354 2c20 494e 4349 4445 4e54 414c 2c20  CT, INCIDENTAL, 
-000029b0: 5350 4543 4941 4c2c 2045 5845 4d50 4c41  SPECIAL, EXEMPLA
-000029c0: 5259 2c20 4f52 0a20 2020 2043 4f4e 5345  RY, OR.    CONSE
-000029d0: 5155 454e 5449 414c 2044 414d 4147 4553  QUENTIAL DAMAGES
-000029e0: 2028 494e 434c 5544 494e 472c 2042 5554   (INCLUDING, BUT
-000029f0: 204e 4f54 204c 494d 4954 4544 2054 4f2c   NOT LIMITED TO,
-00002a00: 2050 524f 4355 5245 4d45 4e54 204f 460a   PROCUREMENT OF.
-00002a10: 2020 2020 5355 4253 5449 5455 5445 2047      SUBSTITUTE G
-00002a20: 4f4f 4453 204f 5220 5345 5256 4943 4553  OODS OR SERVICES
-00002a30: 3b20 4c4f 5353 204f 4620 5553 452c 2044  ; LOSS OF USE, D
-00002a40: 4154 412c 204f 5220 5052 4f46 4954 533b  ATA, OR PROFITS;
-00002a50: 204f 5220 4255 5349 4e45 5353 0a20 2020   OR BUSINESS.   
-00002a60: 2049 4e54 4552 5255 5054 494f 4e29 2048   INTERRUPTION) H
-00002a70: 4f57 4556 4552 2043 4155 5345 4420 414e  OWEVER CAUSED AN
-00002a80: 4420 4f4e 2041 4e59 2054 4845 4f52 5920  D ON ANY THEORY 
-00002a90: 4f46 204c 4941 4249 4c49 5459 2c20 5748  OF LIABILITY, WH
-00002aa0: 4554 4845 5220 494e 0a20 2020 2043 4f4e  ETHER IN.    CON
-00002ab0: 5452 4143 542c 2053 5452 4943 5420 4c49  TRACT, STRICT LI
-00002ac0: 4142 494c 4954 592c 204f 5220 544f 5254  ABILITY, OR TORT
-00002ad0: 2028 494e 434c 5544 494e 4720 4e45 474c   (INCLUDING NEGL
-00002ae0: 4947 454e 4345 204f 5220 4f54 4845 5257  IGENCE OR OTHERW
-00002af0: 4953 4529 0a20 2020 2041 5249 5349 4e47  ISE).    ARISING
-00002b00: 2049 4e20 414e 5920 5741 5920 4f55 5420   IN ANY WAY OUT 
-00002b10: 4f46 2054 4845 2055 5345 204f 4620 5448  OF THE USE OF TH
-00002b20: 4953 2053 4f46 5457 4152 452c 2045 5645  IS SOFTWARE, EVE
-00002b30: 4e20 4946 2041 4456 4953 4544 204f 4620  N IF ADVISED OF 
-00002b40: 5448 450a 2020 2020 504f 5353 4942 494c  THE.    POSSIBIL
-00002b50: 4954 5920 4f46 2053 5543 4820 4441 4d41  ITY OF SUCH DAMA
-00002b60: 4745 2e0a 0a20 2020 2045 7861 6d70 6c65  GE...    Example
-00002b70: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
-00002b80: 2020 2049 6620 796f 7520 6861 7665 2074     If you have t
-00002b90: 776f 2069 6d61 6765 7320 696d 3120 616e  wo images im1 an
-00002ba0: 6420 696d 322c 2072 756e 2061 733a 0a0a  d im2, run as:..
-00002bb0: 2020 2020 3e3e 3e20 726f 775f 7368 6966      >>> row_shif
-00002bc0: 742c 636f 6c5f 7368 6966 742c 7068 6173  t,col_shift,phas
-00002bd0: 655f 6469 6666 2c65 7272 6f72 2c72 6567  e_diff,error,reg
-00002be0: 6973 7465 7265 645f 6666 7420 3d20 6466  istered_fft = df
-00002bf0: 7472 6567 6973 7472 6174 696f 6e28 6e70  tregistration(np
-00002c00: 2e66 6674 2e66 6674 3228 696d 3129 2c6e  .fft.fft2(im1),n
-00002c10: 702e 6666 742e 6666 7432 2869 6d32 292c  p.fft.fft2(im2),
-00002c20: 7570 7361 6d70 6c69 6e67 290a 0a20 2020  upsampling)..   
-00002c30: 2059 6f75 2063 616e 2074 6573 7420 6279   You can test by
-00002c40: 2072 6576 6572 7369 6e67 2074 6865 206f   reversing the o
-00002c50: 7264 6572 0a0a 2020 2020 3e3e 3e20 726f  rder..    >>> ro
-00002c60: 775f 7368 6966 745f 722c 636f 6c5f 7368  w_shift_r,col_sh
-00002c70: 6966 745f 722c 7068 6173 655f 6469 6666  ift_r,phase_diff
-00002c80: 2c65 7272 6f72 2c72 6567 6973 7465 7265  ,error,registere
-00002c90: 645f 6666 7420 3d20 6466 7472 6567 6973  d_fft = dftregis
-00002ca0: 7472 6174 696f 6e28 6e70 2e66 6674 2e66  tration(np.fft.f
-00002cb0: 6674 3228 696d 3229 2c6e 702e 6666 742e  ft2(im2),np.fft.
-00002cc0: 6666 7432 2869 6d31 292c 7570 7361 6d70  fft2(im1),upsamp
-00002cd0: 6c69 6e67 290a 2020 2020 3e3e 3e20 726f  ling).    >>> ro
-00002ce0: 775f 7368 6966 7420 3d3d 202d 726f 775f  w_shift == -row_
-00002cf0: 7368 6966 745f 720a 2020 2020 3e3e 3e20  shift_r.    >>> 
-00002d00: 5472 7565 0a20 2020 203e 3e3e 2063 6f6c  True.    >>> col
-00002d10: 5f73 6869 6674 203d 3d20 2d63 6f6c 5f73  _shift == -col_s
-00002d20: 6869 6674 5f72 0a20 2020 203e 3e3e 2054  hift_r.    >>> T
-00002d30: 7275 650a 2020 2020 7233 0000 0072 0b00  rue.    r3...r..
-00002d40: 0000 2903 da05 7374 6172 74da 0473 746f  ..)...start..sto
-00002d50: 70da 0473 7465 7072 0100 0000 6700 0000  p..stepr....g...
-00002d60: 0000 00f8 3f67 0000 0000 0000 f03f 6700  ....?g.......?g.
-00002d70: 0000 0000 00e0 3f72 1900 0000 7900 0000  ......?r....y...
-00002d80: 0000 0000 0000 0000 0000 00f0 3f79 0000  ............?y..
-00002d90: 0000 0000 0000 0000 0000 0000 0040 e9ff  .............@..
-00002da0: ffff ff29 1972 0c00 0000 720e 0000 0072  ...).r....r....r
-00002db0: 2500 0000 722b 0000 0072 1b00 0000 5a03  %...r+...r....Z.
-00002dc0: 6669 78da 0463 6569 6c5a 086d 756c 7469  fix..ceilZ.multi
-00002dd0: 706c 795a 0463 6f6e 6ada 0373 756d 5a05  plyZ.conj..sumZ.
-00002de0: 6966 6674 3272 2800 0000 7226 0000 0072  ifft2r(...r&...r
-00002df0: 2700 0000 7220 0000 0072 2c00 0000 7224  '...r ...r,...r$
-00002e00: 0000 00da 0572 6f75 6e64 723b 0000 005a  .....roundr;...Z
-00002e10: 0561 6e67 6c65 5a0a 7a65 726f 735f 6c69  .angleZ.zeros_li
-00002e20: 6b65 721a 0000 005a 086d 6573 6867 7269  ker....Z.meshgri
-00002e30: 6472 3500 0000 7236 0000 0029 1f72 3c00  dr5...r6...).r<.
-00002e40: 0000 723d 0000 0072 2e00 0000 7239 0000  ..r=...r....r9..
-00002e50: 0072 3a00 0000 5a02 4e72 5a02 4e63 5a05  .r:...Z.NrZ.NcZ.
-00002e60: 4343 6d61 785a 0766 745f 6d75 6c74 5a09  CCmaxZ.ft_multZ.
-00002e70: 726f 775f 7368 6966 745a 0963 6f6c 5f73  row_shiftZ.col_s
-00002e80: 6869 6674 5a04 4343 5f31 5a07 4343 6162  hiftZ.CC_1Z.CCab
-00002e90: 735f 315a 0443 435f 325a 0743 4361 6273  s_1Z.CC_2Z.CCabs
-00002ea0: 5f32 5a03 4e72 325a 034e 6332 5a08 6466  _2Z.Nr2Z.Nc2Z.df
-00002eb0: 7473 6869 6674 5a06 6466 7472 6f77 5a06  tshiftZ.dftrowZ.
-00002ec0: 6466 7463 6f6c 5a04 4343 5f6d 5a07 4343  dftcolZ.CC_mZ.CC
-00002ed0: 6162 735f 6d5a 0472 6c6f 635a 0463 6c6f  abs_mZ.rlocZ.clo
-00002ee0: 635a 0472 6730 305a 0472 6630 30da 0565  cZ.rg00Z.rf00..e
-00002ef0: 7272 6f72 5a0a 7068 6173 655f 6469 6666  rrorZ.phase_diff
-00002f00: 5a0e 7265 6769 7374 6572 6564 5f66 6674  Z.registered_fft
-00002f10: 5a07 4e63 5f67 7269 645a 074e 725f 6772  Z.Nc_gridZ.Nr_gr
-00002f20: 6964 7214 0000 0072 1400 0000 7215 0000  idr....r....r...
-00002f30: 00da 0f64 6674 7265 6769 7374 7261 7469  ...dftregistrati
-00002f40: 6f6e dc00 0000 73b0 0000 0000 600e 0106  on....s.....`...
-00002f50: 0124 ff04 0306 0124 ff04 0304 0112 0104  .$.....$........
-00002f60: 0104 0108 0220 010a 020c 010a 0110 0118  ..... ..........
-00002f70: 0208 010c 010a 0228 010a 0110 0118 0206  .......(........
-00002f80: 011c ff04 0306 011c ff04 030c 010c 020a  ................
-00002f90: 0312 0112 0118 010c 010c 0304 0106 0102  ................
-00002fa0: 010c 010c 0102 0102 0102 fa02 ff04 0b0a  ................
-00002fb0: 0110 0110 0108 0108 010c 010c 030a 0104  ................
-00002fc0: 010a 0104 0114 0114 0124 010a 0304 0106  .........$......
-00002fd0: ff06 030a 0110 0108 0108 010e 0104 0102  ................
-00002fe0: 0104 0102 0204 fe02 0302 fd02 040e fc02  ................
-00002ff0: ff02 fe02 ff08 0c0a 0116 0172 4600 0000  ...........rF...
-00003000: 2901 7217 0000 0029 0572 0b00 0000 7201  ).r....).r....r.
-00003010: 0000 0072 0100 0000 7201 0000 0072 0100  ...r....r....r..
-00003020: 0000 2901 720b 0000 0029 135a 056e 756d  ..).r....).Z.num
-00003030: 7079 720c 0000 00da 0873 7465 6d74 6f6f  pyr......stemtoo
-00003040: 6c72 2600 0000 da06 7479 7069 6e67 7202  lr&.....typingr.
-00003050: 0000 0072 0300 0000 5a08 6e70 7479 7069  ...r....Z.nptypi
-00003060: 6e67 7204 0000 0072 0500 0000 7206 0000  ngr....r....r...
-00003070: 0072 0700 0000 7208 0000 0072 1600 0000  .r....r....r....
-00003080: da03 7374 7272 2000 0000 722c 0000 0072  ..strr ...r,...r
-00003090: 3b00 0000 7246 0000 0072 1400 0000 7214  ;...rF...r....r.
-000030a0: 0000 0072 1400 0000 7215 0000 00da 083c  ...r....r......<
-000030b0: 6d6f 6475 6c65 3e01 0000 0073 4200 0000  module>....sB...
-000030c0: 0801 0801 1001 1c03 241d 00ff 0201 1001  ........$.......
-000030d0: 0afe 0c35 1c01 0efe 0c3e 0001 0001 0001  ...5.....>......
-000030e0: 0001 00fa 0201 0e01 0201 0201 0201 0201  ................
-000030f0: 0201 0ef9 0c4c 00fd 0201 0e01 0e01 0201  .....L..........
-00003100: 1cfc                                     ..
+00000060: 6d0b 5a0b 6d0c 5a0c 0100 6404 6508 6509  m.Z.m.Z...d.e.e.
+00000070: 6405 1900 6505 6602 1900 6406 6506 650a  d...e.f...d.e.e.
+00000080: 650a 6602 1900 6604 6407 6408 8404 5a0d  e.f...f.d.d...Z.
+00000090: 0909 641f 6404 6508 6509 6405 1900 6505  ..d.d.e.e.d...e.
+000000a0: 6602 1900 640a 650e 6406 6506 650a 650a  f...d.e.d.e.e.e.
+000000b0: 6602 1900 6606 640b 640c 8405 5a0f 640d  f...f.d.d...Z.d.
+000000c0: 6508 6509 6405 1900 650c 6602 1900 640e  e.e.d...e.f...d.
+000000d0: 6508 6509 640f 1900 650b 6602 1900 6406  e.e.d...e.f...d.
+000000e0: 6508 6509 6405 1900 650c 6602 1900 6606  e.e.d...e.f...f.
+000000f0: 6410 6411 8404 5a10 0912 0900 0900 0900  d.d...Z.........
+00000100: 0900 6420 6413 6508 6509 6405 1900 6505  ..d d.e.e.d...e.
+00000110: 6602 1900 6414 650a 6415 650a 6416 650a  f...d.e.d.e.d.e.
+00000120: 6417 650a 6418 650a 6406 6508 6509 6405  d.e.d.e.d.e.e.d.
+00000130: 1900 650c 6602 1900 660e 6419 641a 8405  ..e.f...f.d.d...
+00000140: 5a11 0912 6421 641b 6508 6509 6405 1900  Z...d!d.e.e.d...
+00000150: 650c 6602 1900 641c 6508 6509 6405 1900  e.f...d.e.e.d...
+00000160: 650c 6602 1900 6414 650b 6406 6506 650a  e.f...d.e.d.e.e.
+00000170: 650a 650b 650b 6508 6509 6405 1900 650c  e.e.e.e.e.d...e.
+00000180: 6602 1900 6605 1900 6608 641d 641e 8405  f...f...f.d.d...
+00000190: 5a12 6401 5300 2922 e900 0000 004e 2902  Z.d.S.)".....N).
+000001a0: da03 416e 79da 0554 7570 6c65 2905 da07  ..Any..Tuple)...
+000001b0: 4e44 4172 7261 79da 0553 6861 7065 da03  NDArray..Shape..
+000001c0: 496e 74da 0546 6c6f 6174 da07 436f 6d70  Int..Float..Comp
+000001d0: 6c65 78da 0569 6d61 6765 7a04 2a2c 202a  lex..imagez.*, *
+000001e0: da06 7265 7475 726e 6301 0000 0000 0000  ..returnc.......
+000001f0: 0000 0000 0005 0000 0005 0000 0043 0000  .............C..
+00000200: 0073 5a00 0000 7400 6a01 6401 7c00 6a02  .sZ...t.j.d.|.j.
+00000210: 6401 1900 8502 6401 7c00 6a02 6402 1900  d.....d.|.j.d...
+00000220: 8502 6602 1900 5c02 7d01 7d02 7c01 7c00  ..f...\.}.}.|.|.
+00000230: 7400 a003 7c00 a101 6b02 1900 6401 1900  t...|...k...d...
+00000240: 7d03 7c02 7c00 7400 a003 7c00 a101 6b02  }.|.|.t...|...k.
+00000250: 1900 6401 1900 7d04 7c03 7c04 6602 5300  ..d...}.|.|.f.S.
+00000260: 2903 616f 0100 000a 2020 2020 4669 6e64  ).ao....    Find
+00000270: 206d 6178 696d 6120 696e 2069 6d61 6765   maxima in image
+00000280: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00000290: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000002a0: 2020 2020 696d 6167 653a 2049 6e70 7574      image: Input
+000002b0: 2069 6d61 6765 0a0a 2020 2020 5265 7475   image..    Retu
+000002c0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+000002d0: 2020 2020 796d 6178 3a20 792d 696e 6465      ymax: y-inde
+000002e0: 7820 706f 7369 7469 6f6e 206f 6620 6d61  x position of ma
+000002f0: 7869 6d61 0a20 2020 2078 6d61 783a 2078  xima.    xmax: x
+00000300: 2d69 6e64 6578 2070 6f73 6974 696f 6e20  -index position 
+00000310: 6f66 206d 6178 696d 610a 0a20 2020 204e  of maxima..    N
+00000320: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+00000330: 2020 2046 696e 6473 2074 6865 2069 6d61     Finds the ima
+00000340: 6765 206d 6178 696d 612c 2061 6e64 2074  ge maxima, and t
+00000350: 6865 6e20 6c6f 6361 7465 7320 7468 6520  hen locates the 
+00000360: 790a 2020 2020 616e 6420 7820 696e 6469  y.    and x indi
+00000370: 6365 7320 636f 7272 6573 706f 6e64 696e  ces correspondin
+00000380: 6720 746f 2074 6865 206d 6178 696d 610a  g to the maxima.
+00000390: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+000003a0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+000003b0: 3e3e 2079 6d2c 2078 6d20 3d20 6669 6e64  >> ym, xm = find
+000003c0: 5f6d 6178 5f69 6e64 6578 2869 6d61 6765  _max_index(image
+000003d0: 290a 2020 2020 7201 0000 00e9 0100 0000  ).    r.........
+000003e0: 2904 da02 6e70 da05 6d67 7269 64da 0573  )...np..mgrid..s
+000003f0: 6861 7065 da04 616d 6178 2905 7209 0000  hape..amax).r...
+00000400: 00da 0279 79da 0278 78da 0479 6d61 78da  ...yy..xx..ymax.
+00000410: 0478 6d61 78a9 0072 1400 0000 fa39 6275  .xmax..r.....9bu
+00000420: 696c 642f 6264 6973 742e 6c69 6e75 782d  ild/bdist.linux-
+00000430: 7838 365f 3634 2f65 6767 2f73 7465 6d74  x86_64/egg/stemt
+00000440: 6f6f 6c2f 7574 696c 2f66 6f75 7269 6572  ool/util/fourier
+00000450: 5f72 6567 2e70 79da 0e66 696e 645f 6d61  _reg.py..find_ma
+00000460: 785f 696e 6465 7807 0000 0073 0800 0000  x_index....s....
+00000470: 2616 1601 1601 0801 7216 0000 00da 0143  &.......r......C
+00000480: da05 6f72 6465 7263 0200 0000 0000 0000  ..orderc........
+00000490: 0000 0000 0b00 0000 0700 0000 4300 0000  ............C...
+000004a0: 7390 0000 0074 006a 0164 017c 006a 0264  s....t.j.d.|.j.d
+000004b0: 0119 0085 0264 017c 006a 0264 0219 0085  .....d.|.j.d....
+000004c0: 0266 0219 005c 027d 027d 0374 00a0 037c  .f...\.}.}.t...|
+000004d0: 027c 01a1 027d 0474 00a0 037c 037c 01a1  .|...}.t...|.|..
+000004e0: 027d 0574 00a0 037c 007c 01a1 027d 0674  .}.t...|.|...}.t
+000004f0: 006a 0474 00a0 057c 06a1 0174 006a 0664  .j.t...|...t.j.d
+00000500: 038d 027d 0774 00a0 077c 077c 0674 00a0  ...}.t...|.|.t..
+00000510: 087c 06a1 016b 0219 00a1 017d 087c 047c  .|...k.....}.|.|
+00000520: 0819 007d 097c 057c 0819 007d 0a7c 097c  ...}.|.|...}.|.|
+00000530: 0a66 0253 0029 0461 9f05 0000 0a20 2020  .f.S.).a.....   
+00000540: 2046 6972 7374 206d 6178 696d 6120 696e   First maxima in
+00000550: 2069 6d61 6765 0a0a 2020 2020 5061 7261   image..    Para
+00000560: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00000570: 2d2d 2d2d 2d0a 2020 2020 696d 6167 653a  -----.    image:
+00000580: 2049 6e70 7574 2069 6d61 6765 0a20 2020   Input image.   
+00000590: 206f 7264 6572 203a 207b 2743 272c 2746   order : {'C','F
+000005a0: 272c 2027 4127 2c20 274b 277d 2c0a 2020  ', 'A', 'K'},.  
+000005b0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+000005c0: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+000005d0: 6865 2065 6c65 6d65 6e74 7320 6f66 2060  he elements of `
+000005e0: 6160 2061 7265 2072 6561 6420 7573 696e  a` are read usin
+000005f0: 6720 7468 6973 2069 6e64 6578 206f 7264  g this index ord
+00000600: 6572 2e20 2743 2720 6d65 616e 730a 2020  er. 'C' means.  
+00000610: 2020 2020 2020 2020 2020 746f 2069 6e64            to ind
+00000620: 6578 2074 6865 2065 6c65 6d65 6e74 7320  ex the elements 
+00000630: 696e 2072 6f77 2d6d 616a 6f72 2c20 432d  in row-major, C-
+00000640: 7374 796c 6520 6f72 6465 722c 0a20 2020  style order,.   
+00000650: 2020 2020 2020 2020 2077 6974 6820 7468           with th
+00000660: 6520 6c61 7374 2061 7869 7320 696e 6465  e last axis inde
+00000670: 7820 6368 616e 6769 6e67 2066 6173 7465  x changing faste
+00000680: 7374 2c20 6261 636b 2074 6f20 7468 6520  st, back to the 
+00000690: 6669 7273 740a 2020 2020 2020 2020 2020  first.          
+000006a0: 2020 6178 6973 2069 6e64 6578 2063 6861    axis index cha
+000006b0: 6e67 696e 6720 736c 6f77 6573 742e 2020  nging slowest.  
+000006c0: 2746 2720 6d65 616e 7320 746f 2069 6e64  'F' means to ind
+000006d0: 6578 2074 6865 2065 6c65 6d65 6e74 730a  ex the elements.
+000006e0: 2020 2020 2020 2020 2020 2020 696e 2063              in c
+000006f0: 6f6c 756d 6e2d 6d61 6a6f 722c 2046 6f72  olumn-major, For
+00000700: 7472 616e 2d73 7479 6c65 206f 7264 6572  tran-style order
+00000710: 2c20 7769 7468 2074 6865 0a20 2020 2020  , with the.     
+00000720: 2020 2020 2020 2066 6972 7374 2069 6e64         first ind
+00000730: 6578 2063 6861 6e67 696e 6720 6661 7374  ex changing fast
+00000740: 6573 742c 2061 6e64 2074 6865 206c 6173  est, and the las
+00000750: 7420 696e 6465 7820 6368 616e 6769 6e67  t index changing
+00000760: 0a20 2020 2020 2020 2020 2020 2073 6c6f  .            slo
+00000770: 7765 7374 2e20 4e6f 7465 2074 6861 7420  west. Note that 
+00000780: 7468 6520 2743 2720 616e 6420 2746 2720  the 'C' and 'F' 
+00000790: 6f70 7469 6f6e 7320 7461 6b65 206e 6f20  options take no 
+000007a0: 6163 636f 756e 7420 6f66 0a20 2020 2020  account of.     
+000007b0: 2020 2020 2020 2074 6865 206d 656d 6f72         the memor
+000007c0: 7920 6c61 796f 7574 206f 6620 7468 6520  y layout of the 
+000007d0: 756e 6465 726c 7969 6e67 2061 7272 6179  underlying array
+000007e0: 2c20 616e 6420 6f6e 6c79 2072 6566 6572  , and only refer
+000007f0: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+00000800: 7468 6520 6f72 6465 7220 6f66 2061 7869  the order of axi
+00000810: 7320 696e 6465 7869 6e67 2e20 2027 4127  s indexing.  'A'
+00000820: 206d 6561 6e73 2074 6f20 7265 6164 2074   means to read t
+00000830: 6865 2065 6c65 6d65 6e74 7320 696e 0a20  he elements in. 
+00000840: 2020 2020 2020 2020 2020 2046 6f72 7472             Fortr
+00000850: 616e 2d6c 696b 6520 696e 6465 7820 6f72  an-like index or
+00000860: 6465 7220 6966 2060 6160 2069 7320 466f  der if `a` is Fo
+00000870: 7274 7261 6e20 2a63 6f6e 7469 6775 6f75  rtran *contiguou
+00000880: 732a 2069 6e0a 2020 2020 2020 2020 2020  s* in.          
+00000890: 2020 6d65 6d6f 7279 2c20 432d 6c69 6b65    memory, C-like
+000008a0: 206f 7264 6572 206f 7468 6572 7769 7365   order otherwise
+000008b0: 2e20 2027 4b27 206d 6561 6e73 2074 6f20  .  'K' means to 
+000008c0: 7265 6164 2074 6865 0a20 2020 2020 2020  read the.       
+000008d0: 2020 2020 2065 6c65 6d65 6e74 7320 696e       elements in
+000008e0: 2074 6865 206f 7264 6572 2074 6865 7920   the order they 
+000008f0: 6f63 6375 7220 696e 206d 656d 6f72 792c  occur in memory,
+00000900: 2065 7863 6570 7420 666f 720a 2020 2020   except for.    
+00000910: 2020 2020 2020 2020 7265 7665 7273 696e          reversin
+00000920: 6720 7468 6520 6461 7461 2077 6865 6e20  g the data when 
+00000930: 7374 7269 6465 7320 6172 6520 6e65 6761  strides are nega
+00000940: 7469 7665 2e20 2042 7920 6465 6661 756c  tive.  By defaul
+00000950: 742c 2027 4327 0a20 2020 2020 2020 2020  t, 'C'.         
+00000960: 2020 2069 6e64 6578 206f 7264 6572 2069     index order i
+00000970: 7320 7573 6564 2e0a 0a20 2020 2052 6574  s used...    Ret
+00000980: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00000990: 0a20 2020 2079 6d61 783a 2079 2d69 6e64  .    ymax: y-ind
+000009a0: 6578 2070 6f73 6974 696f 6e20 6f66 206d  ex position of m
+000009b0: 6178 696d 610a 2020 2020 786d 6178 3a20  axima.    xmax: 
+000009c0: 782d 696e 6465 7820 706f 7369 7469 6f6e  x-index position
+000009d0: 206f 6620 6d61 7869 6d61 0a0a 2020 2020   of maxima..    
+000009e0: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+000009f0: 2020 2020 4669 6e64 7320 7468 6520 6669      Finds the fi
+00000a00: 7273 7420 696d 6167 6520 6d61 7869 6d61  rst image maxima
+00000a10: 2069 6620 7468 6572 6520 6172 6520 6d75   if there are mu
+00000a20: 6c74 6970 6c65 0a20 2020 2070 6f69 6e74  ltiple.    point
+00000a30: 7320 7769 7468 2074 6865 2073 616d 6520  s with the same 
+00000a40: 6d61 7869 6d75 6d20 7661 6c75 652c 2061  maximum value, a
+00000a50: 6e64 2074 6865 6e20 6c6f 6361 7465 730a  nd then locates.
+00000a60: 2020 2020 7468 6520 7920 616e 6420 7820      the y and x 
+00000a70: 696e 6469 6365 7320 636f 7272 6573 706f  indices correspo
+00000a80: 6e64 696e 6720 746f 2074 6865 206d 6178  nding to the max
+00000a90: 696d 610a 0a20 2020 2045 7861 6d70 6c65  ima..    Example
+00000aa0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+00000ab0: 2020 203e 3e3e 2079 6d2c 2078 6d20 3d20     >>> ym, xm = 
+00000ac0: 6669 7273 745f 6d61 785f 696e 6465 7828  first_max_index(
+00000ad0: 696d 6167 6529 0a20 2020 2072 0100 0000  image).    r....
+00000ae0: 720b 0000 00a9 01da 0564 7479 7065 2909  r........dtype).
+00000af0: 720c 0000 0072 0d00 0000 720e 0000 005a  r....r....r....Z
+00000b00: 0572 6176 656c da06 6172 616e 6765 da04  .ravel..arange..
+00000b10: 7369 7a65 5a04 696e 745f da04 616d 696e  sizeZ.int_..amin
+00000b20: 720f 0000 0029 0b72 0900 0000 7218 0000  r....).r....r...
+00000b30: 0072 1000 0000 7211 0000 005a 0679 795f  .r....r....Z.yy_
+00000b40: 7276 6c5a 0678 785f 7276 6c5a 0969 6d61  rvlZ.xx_rvlZ.ima
+00000b50: 6765 5f72 766c da07 696e 6469 6365 73da  ge_rvl..indices.
+00000b60: 0569 6e64 6578 7212 0000 0072 1300 0000  .indexr....r....
+00000b70: 7214 0000 0072 1400 0000 7215 0000 00da  r....r....r.....
+00000b80: 0f66 6972 7374 5f6d 6178 5f69 6e64 6578  .first_max_index
+00000b90: 2300 0000 7312 0000 0026 290c 010c 010c  #...s....&).....
+00000ba0: 0116 0118 0108 0108 0108 0172 2000 0000  ...........r ...
+00000bb0: da04 696d 4654 da07 6f75 7473 697a 65da  ..imFT..outsize.
+00000bc0: 0132 6302 0000 0000 0000 0000 0000 000b  .2c.............
+00000bd0: 0000 000a 0000 0043 0000 0073 7e01 0000  .......C...s~...
+00000be0: 7400 6a01 7c00 6a02 7400 6a03 6401 8d02  t.j.|.j.t.j.d...
+00000bf0: 7d02 7400 6a01 7c01 7400 6a03 6401 8d02  }.t.j.|.t.j.d...
+00000c00: 7d03 7400 6a04 a005 7c00 a101 7d04 7400  }.t.j...|...}.t.
+00000c10: a001 7406 6a07 a008 7400 a009 7c04 a101  ..t.j...t...|...
+00000c20: a101 a101 7d05 7400 6a0a 7c01 7c04 6a0b  ....}.t.j.|.|.j.
+00000c30: 6401 8d02 7d06 7c05 7c03 7c02 1b00 1400  d...}.|.|.|.....
+00000c40: a00c 740d a101 7d07 7400 a00e 7c03 7c02  ..t...}.t...|.|.
+00000c50: 1b00 a101 7d08 7c07 7c05 1800 7d09 7c04  ....}.|.|...}.|.
+00000c60: 740d 7400 a00f 7c09 6402 1900 0b00 6402  t.t...|.d.....d.
+00000c70: 6602 a101 8301 740d 7400 a010 7c09 6402  f.....t.t...|.d.
+00000c80: 1900 0b00 7c03 6402 1900 1700 7c02 6402  ....|.d.....|.d.
+00000c90: 1900 6602 a101 8301 8502 740d 7400 a00f  ..f.......t.t...
+00000ca0: 7c09 6403 1900 0b00 6402 6602 a101 8301  |.d.....d.f.....
+00000cb0: 740d 7400 a010 7c09 6403 1900 0b00 7c03  t.t...|.d.....|.
+00000cc0: 6403 1900 1700 7c02 6403 1900 6602 a101  d.....|.d...f...
+00000cd0: 8301 8502 6602 1900 7c06 740d 7400 a00f  ....f...|.t.t...
+00000ce0: 7c09 6402 1900 6402 6602 a101 8301 740d  |.d...d.f.....t.
+00000cf0: 7400 a010 7c09 6402 1900 7c02 6402 1900  t...|.d...|.d...
+00000d00: 1700 7c03 6402 1900 6602 a101 8301 8502  ..|.d...f.......
+00000d10: 740d 7400 a00f 7c09 6403 1900 6402 6602  t.t...|.d...d.f.
+00000d20: a101 8301 740d 7400 a010 7c09 6403 1900  ....t.t...|.d...
+00000d30: 7c02 6403 1900 1700 7c03 6403 1900 6602  |.d.....|.d...f.
+00000d40: a101 8301 8502 6602 3c00 7400 6a04 a011  ......f.<.t.j...
+00000d50: 7c06 a101 7c08 1400 7d0a 7c0a 5300 2904  |...|...}.|.S.).
+00000d60: 6152 0200 000a 2020 2020 5061 6420 466f  aR....    Pad Fo
+00000d70: 7572 6965 7220 696d 6167 6573 0a0a 2020  urier images..  
+00000d80: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00000d90: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00000da0: 696d 4654 3a20 2020 206e 6461 7272 6179  imFT:    ndarray
+00000db0: 0a20 2020 2020 2020 2020 2020 2020 496e  .             In
+00000dc0: 7075 7420 636f 6d70 6c65 7820 6172 7261  put complex arra
+00000dd0: 7920 7769 7468 2044 4320 696e 205b 312c  y with DC in [1,
+00000de0: 315d 0a0a 2020 2020 6f75 7473 697a 653a  1]..    outsize:
+00000df0: 206e 6461 7272 6179 2077 6974 6820 2832   ndarray with (2
+00000e00: 2c31 2920 7368 6170 650a 2020 2020 2020  ,1) shape.      
+00000e10: 2020 2020 2020 206e 792c 206e 7820 6f66         ny, nx of
+00000e20: 206f 7574 7075 7420 7369 7a65 0a0a 2020   output size..  
+00000e30: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+00000e40: 2d2d 2d2d 2d0a 2020 2020 696d 6f75 743a  -----.    imout:
+00000e50: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00000e60: 2020 2020 4f75 7470 7574 2063 6f6d 706c      Output compl
+00000e70: 6578 2069 6d61 6765 2077 6974 6820 4443  ex image with DC
+00000e80: 2069 6e20 5b31 2c31 5d0a 0a20 2020 204e   in [1,1]..    N
+00000e90: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+00000ea0: 2020 2050 6164 7320 6f72 2063 726f 7073     Pads or crops
+00000eb0: 2074 6865 2046 6f75 7269 6572 2074 7261   the Fourier tra
+00000ec0: 6e73 666f 726d 2074 6f20 7468 6520 6465  nsform to the de
+00000ed0: 7369 7265 6420 6f75 7075 7420 7369 7a65  sired ouput size
+00000ee0: 2e20 5461 6b69 6e67 0a20 2020 2063 6172  . Taking.    car
+00000ef0: 6520 7468 6174 2074 6865 207a 6572 6f20  e that the zero 
+00000f00: 6672 6571 7565 6e63 7920 6973 2070 7574  frequency is put
+00000f10: 2069 6e20 7468 6520 636f 7272 6563 7420   in the correct 
+00000f20: 706c 6163 6520 666f 7220 7468 6520 6f75  place for the ou
+00000f30: 7470 7574 0a20 2020 2066 6f72 2073 7562  tput.    for sub
+00000f40: 7365 7175 656e 7420 4654 206f 7220 4946  sequent FT or IF
+00000f50: 542e 2043 616e 2062 6520 7573 6564 2066  T. Can be used f
+00000f60: 6f72 2046 6f75 7269 6572 2074 7261 6e73  or Fourier trans
+00000f70: 666f 726d 2062 6173 6564 0a20 2020 2069  form based.    i
+00000f80: 6e74 6572 706f 6c61 7469 6f6e 2c20 692e  nterpolation, i.
+00000f90: 652e 2064 6972 6963 686c 6574 206b 6572  e. dirichlet ker
+00000fa0: 6e65 6c20 696e 7465 7270 6f6c 6174 696f  nel interpolatio
+00000fb0: 6e2e 0a20 2020 2072 1900 0000 7201 0000  n..    r....r...
+00000fc0: 0072 0b00 0000 2912 720c 0000 00da 0761  .r....).r......a
+00000fd0: 7361 7272 6179 720e 0000 005a 0766 6c6f  sarrayr....Z.flo
+00000fe0: 6174 3634 da03 6666 745a 0866 6674 7368  at64..fftZ.fftsh
+00000ff0: 6966 74da 0273 74da 0475 7469 6c72 2000  ift..st..utilr .
+00001000: 0000 da03 6162 735a 057a 6572 6f73 721a  ....absZ.zerosr.
+00001010: 0000 005a 0661 7374 7970 65da 0369 6e74  ...Z.astype..int
+00001020: da04 7072 6f64 720f 0000 0072 1d00 0000  ..prodr....r....
+00001030: da09 6966 6674 7368 6966 7429 0b72 2100  ..ifftshift).r!.
+00001040: 0000 7222 0000 005a 046e 5f69 6e5a 046e  ..r"...Z.n_inZ.n
+00001050: 6f75 745a 0a69 6d46 545f 7368 6966 745a  outZ.imFT_shiftZ
+00001060: 0963 656e 7465 725f 696e 5a07 696d 4654  .center_inZ.imFT
+00001070: 6f75 745a 0a63 656e 7465 725f 6f75 745a  outZ.center_outZ
+00001080: 0666 745f 7661 6c5a 0b63 656e 7465 725f  .ft_valZ.center_
+00001090: 6469 6666 5a05 696d 6f75 7472 1400 0000  diffZ.imoutr....
+000010a0: 7214 0000 0072 1500 0000 da0b 666f 7572  r....r......four
+000010b0: 6965 725f 7061 6457 0000 0073 4000 0000  ier_padW...s@...
+000010c0: 121a 1001 0c01 0402 1001 04ff 0403 0601  ................
+000010d0: 06ff 1203 0e01 0801 020a 1801 1e01 04ff  ................
+000010e0: 1803 1e01 04ff 02fd 02ff 02f9 1601 1c01  ................
+000010f0: 04ff 1603 1c01 04ff 02fd 02ff 100f 0401  ................
+00001100: 722c 0000 0072 0b00 0000 da0b 696e 7075  r,...r......inpu
+00001110: 745f 696d 6167 65da 0575 7366 6163 da03  t_image..usfac..
+00001120: 6e6f 72da 036e 6f63 da04 726f 6666 da04  nor..noc..roff..
+00001130: 636f 6666 6306 0000 0000 0000 0000 0000  coffc...........
+00001140: 000f 0000 0007 0000 0043 0000 0073 1e01  .........C...s..
+00001150: 0000 7400 a001 7c00 a101 5c02 7d06 7d07  ..t...|...\.}.}.
+00001160: 7c03 6401 6b02 720d 7c07 7d03 7c02 6401  |.d.k.r.|.}.|.d.
+00001170: 6b02 7213 7c06 7d02 7400 6a02 a003 7400  k.r.|.}.t.j...t.
+00001180: a004 7c07 a101 a101 7400 a005 7c07 6402  ..|.....t...|.d.
+00001190: 1b00 a101 1800 a006 7407 7c07 8301 6403  ........t.|...d.
+000011a0: 6602 a101 7d08 7400 a004 7c03 a101 7c05  f...}.t...|...|.
+000011b0: 1800 a006 7407 7c03 8301 6403 6602 a101  ....t.|...d.f...
+000011c0: 7d09 7400 a004 7c02 a101 7c04 1800 a006  }.t...|...|.....
+000011d0: 7407 7c02 8301 6403 6602 a101 7d0a 7400  t.|...d.f...}.t.
+000011e0: 6a02 a003 7400 a004 7c06 a101 a101 7400  j...t...|.....t.
+000011f0: a005 7c06 6402 1b00 a101 1800 a006 7407  ..|.d.........t.
+00001200: 7c06 8301 6403 6602 a101 7d0b 7400 a008  |...d.f...}.t...
+00001210: 6404 7400 6a09 1400 7c07 7c01 1400 1b00  d.t.j...|.|.....
+00001220: 7400 a00a 7c08 7c09 6a0b a102 1400 a101  t...|.|.j.......
+00001230: 7d0c 7400 a008 6404 7400 6a09 1400 7c06  }.t...d.t.j...|.
+00001240: 7c01 1400 1b00 7400 a00a 7c0a 7c0b 6a0b  |.....t...|.|.j.
+00001250: a102 1400 a101 7d0d 7400 a00a 7400 a00a  ......}.t...t...
+00001260: 7c0d 7c00 a102 7c0c a102 7d0e 7c0e 5300  |.|...|...}.|.S.
+00001270: 2905 61a8 0500 000a 2020 2020 5570 7361  ).a.....    Upsa
+00001280: 6d70 6c65 6420 6469 7363 7265 7465 2046  mpled discrete F
+00001290: 6f75 7269 6572 2074 7261 6e73 666f 726d  ourier transform
+000012a0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000012b0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000012c0: 2020 2020 696e 7075 745f 696d 6167 653a      input_image:
+000012d0: 2049 6e70 7574 2069 6d61 6765 0a20 2020   Input image.   
+000012e0: 2075 7366 6163 3a20 2020 2020 2020 5570   usfac:       Up
+000012f0: 7361 6d70 6c69 6e67 2046 6163 746f 722e  sampling Factor.
+00001300: 2044 6566 6175 6c74 2069 7320 310a 2020   Default is 1.  
+00001310: 2020 6e6f 723a 2020 2020 2020 2020 204e    nor:         N
+00001320: 756d 6265 7220 6f66 2070 6978 656c 7320  umber of pixels 
+00001330: 696e 2074 6865 206f 7574 7075 7420 7570  in the output up
+00001340: 7361 6d70 6c65 6420 4446 542c 2069 6e0a  sampled DFT, in.
+00001350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001360: 2075 6e69 7473 206f 6620 7570 7361 6d70   units of upsamp
+00001370: 6c65 6420 7069 7865 6c73 2028 6465 6661  led pixels (defa
+00001380: 756c 7420 3d20 7369 7a65 2869 6e29 290a  ult = size(in)).
+00001390: 2020 2020 6e6f 633a 2020 2020 2020 2020      noc:        
+000013a0: 204e 756d 6265 7220 6f66 2070 6978 656c   Number of pixel
+000013b0: 7320 696e 2074 6865 206f 7574 7075 7420  s in the output 
+000013c0: 7570 7361 6d70 6c65 6420 4446 542c 2069  upsampled DFT, i
+000013d0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+000013e0: 2020 2075 6e69 7473 206f 6620 7570 7361     units of upsa
+000013f0: 6d70 6c65 6420 7069 7865 6c73 2028 6465  mpled pixels (de
+00001400: 6661 756c 7420 3d20 7369 7a65 2869 6e29  fault = size(in)
+00001410: 290a 2020 2020 726f 6666 3a20 2020 2020  ).    roff:     
+00001420: 2020 2052 6f77 206f 6666 7365 7473 2c20     Row offsets, 
+00001430: 616c 6c6f 7720 746f 2073 6869 6674 2074  allow to shift t
+00001440: 6865 206f 7574 7075 7420 6172 7261 7920  he output array 
+00001450: 746f 0a20 2020 2020 2020 2020 2020 2020  to.             
+00001460: 2020 2020 6120 7265 6769 6f6e 206f 6620      a region of 
+00001470: 696e 7465 7265 7374 206f 6e20 7468 6520  interest on the 
+00001480: 4446 5420 2864 6566 6175 6c74 203d 2030  DFT (default = 0
+00001490: 290a 2020 2020 636f 6666 3a20 2020 2020  ).    coff:     
+000014a0: 2020 2043 6f6c 756d 6e20 6f66 6673 6574     Column offset
+000014b0: 732c 2061 6c6c 6f77 2074 6f20 7368 6966  s, allow to shif
+000014c0: 7420 7468 6520 6f75 7470 7574 2061 7272  t the output arr
+000014d0: 6179 2074 6f0a 2020 2020 2020 2020 2020  ay to.          
+000014e0: 2020 2020 2020 2061 2072 6567 696f 6e20         a region 
+000014f0: 6f66 2069 6e74 6572 6573 7420 6f6e 2074  of interest on t
+00001500: 6865 2044 4654 2028 6465 6661 756c 7420  he DFT (default 
+00001510: 3d20 3029 0a0a 0a20 2020 2052 6574 7572  = 0)...    Retur
+00001520: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00001530: 2020 206f 7574 5f66 6674 3a20 5570 7361     out_fft: Upsa
+00001540: 6d70 6c65 6420 466f 7572 6965 7220 7472  mpled Fourier tr
+00001550: 616e 7366 6f72 6d0a 0a20 2020 204e 6f74  ansform..    Not
+00001560: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+00001570: 2052 6563 6965 7665 7320 4443 2069 6e20   Recieves DC in 
+00001580: 7570 7065 7220 6c65 6674 2063 6f72 6e65  upper left corne
+00001590: 722c 2069 6d61 6765 2063 656e 7465 7220  r, image center 
+000015a0: 6d75 7374 2062 6520 696e 205b 302c 305d  must be in [0,0]
+000015b0: 0a20 2020 2054 6869 7320 636f 6465 2069  .    This code i
+000015c0: 7320 696e 7465 6e64 6564 2074 6f20 7072  s intended to pr
+000015d0: 6f76 6964 6520 7468 6520 7361 6d65 2072  ovide the same r
+000015e0: 6573 756c 7420 6173 2069 6620 7468 6520  esult as if the 
+000015f0: 666f 6c6c 6f77 696e 670a 2020 2020 6f70  following.    op
+00001600: 6572 6174 696f 6e73 2077 6572 6520 7065  erations were pe
+00001610: 7266 6f72 6d65 640a 2020 2020 2d20 456d  rformed.    - Em
+00001620: 6265 6420 7468 6520 6172 7261 7920 2269  bed the array "i
+00001630: 6e70 7574 5f69 6d61 6765 2220 696e 2061  nput_image" in a
+00001640: 6e20 6172 7261 7920 7468 6174 2069 7320  n array that is 
+00001650: 7573 6661 6320 7469 6d65 7320 6c61 7267  usfac times larg
+00001660: 6572 2069 6e20 6561 6368 0a20 2020 2064  er in each.    d
+00001670: 696d 656e 7369 6f6e 2e20 6966 6674 7368  imension. ifftsh
+00001680: 6966 7420 746f 2062 7269 6e67 2074 6865  ift to bring the
+00001690: 2063 656e 7465 7220 6f66 2074 6865 2069   center of the i
+000016a0: 6d61 6765 2074 6f20 2831 2c31 292e 0a20  mage to (1,1).. 
+000016b0: 2020 202d 2054 616b 6520 7468 6520 4646     - Take the FF
+000016c0: 5420 6f66 2074 6865 206c 6172 6765 7220  T of the larger 
+000016d0: 6172 7261 790a 2020 2020 2d20 4578 7472  array.    - Extr
+000016e0: 6163 7420 616e 205b 6e6f 722c 206e 6f63  act an [nor, noc
+000016f0: 5d20 7265 6769 6f6e 206f 6620 7468 6520  ] region of the 
+00001700: 7265 7375 6c74 2e20 5374 6172 7469 6e67  result. Starting
+00001710: 2077 6974 6820 7468 650a 2020 2020 5b72   with the.    [r
+00001720: 6f66 662b 3120 636f 6666 2b31 5d20 656c  off+1 coff+1] el
+00001730: 656d 656e 742e 0a20 2020 2049 7420 6163  ement..    It ac
+00001740: 6869 6576 6573 2074 6869 7320 7265 7375  hieves this resu
+00001750: 6c74 2062 7920 636f 6d70 7574 696e 6720  lt by computing 
+00001760: 7468 6520 4446 5420 696e 2074 6865 206f  the DFT in the o
+00001770: 7574 7075 7420 6172 7261 7920 7769 7468  utput array with
+00001780: 6f75 740a 2020 2020 7468 6520 6e65 6564  out.    the need
+00001790: 2074 6f20 7a65 726f 7061 642e 204d 7563   to zeropad. Muc
+000017a0: 6820 6661 7374 6572 2061 6e64 206d 656d  h faster and mem
+000017b0: 6f72 7920 6566 6669 6369 656e 7420 7468  ory efficient th
+000017c0: 616e 2074 6865 0a20 2020 207a 6572 6f2d  an the.    zero-
+000017d0: 7061 6464 6564 2046 4654 2061 7070 726f  padded FFT appro
+000017e0: 6163 6820 6966 205b 6e6f 7220 6e6f 635d  ach if [nor noc]
+000017f0: 2061 7265 206d 7563 6820 736d 616c 6c65   are much smalle
+00001800: 7220 7468 616e 205b 6e72 2a75 7366 6163  r than [nr*usfac
+00001810: 206e 632a 7573 6661 635d 0a20 2020 2072   nc*usfac].    r
+00001820: 0100 0000 e902 0000 0072 0b00 0000 7900  .........r....y.
+00001830: 0000 0000 0000 0000 0000 0000 0000 c029  ...............)
+00001840: 0c72 0c00 0000 720e 0000 0072 2500 0000  .r....r....r%...
+00001850: 722b 0000 0072 1b00 0000 da05 666c 6f6f  r+...r......floo
+00001860: 725a 0772 6573 6861 7065 7229 0000 00da  rZ.reshaper)....
+00001870: 0365 7870 da02 7069 da06 6d61 746d 756c  .exp..pi..matmul
+00001880: da01 5429 0f72 2d00 0000 722e 0000 0072  ..T).r-...r....r
+00001890: 2f00 0000 7230 0000 0072 3100 0000 7232  /...r0...r1...r2
+000018a0: 0000 00da 026e 72da 026e 635a 066e 635f  .....nr..ncZ.nc_
+000018b0: 6172 725a 076e 6f63 5f61 7272 5a07 6e6f  arrZ.noc_arrZ.no
+000018c0: 725f 6172 725a 066e 725f 6172 725a 056b  r_arrZ.nr_arrZ.k
+000018d0: 6572 6e63 5a05 6b65 726e 725a 076f 7574  erncZ.kernrZ.out
+000018e0: 5f66 6674 7214 0000 0072 1400 0000 7215  _fftr....r....r.
+000018f0: 0000 00da 0664 6674 7570 7393 0000 0073  .....dftups....s
+00001900: 3600 0000 0e2b 0802 0401 0801 0401 1e02  6....+..........
+00001910: 0e01 02fe 0e03 0a01 04ff 0e03 0a01 04ff  ................
+00001920: 1e04 0e01 02fe 0403 1e01 04ff 0403 1e01  ................
+00001930: 04ff 0403 0c01 04ff 0403 723b 0000 00da  ..........r;....
+00001940: 0662 7566 3166 74da 0662 7566 3266 7463  .buf1ft..buf2ftc
+00001950: 0300 0000 0000 0000 0000 0000 1f00 0000  ................
+00001960: 0b00 0000 4300 0000 73ca 0300 0074 00a0  ....C...s....t..
+00001970: 017c 01a1 015c 027d 037d 0474 006a 02a0  .|...\.}.}.t.j..
+00001980: 0374 006a 0474 00a0 057c 0364 011b 00a1  .t.j.t...|.d....
+00001990: 010b 0074 00a0 067c 0364 011b 00a1 0164  ...t...|.d.....d
+000019a0: 0264 038d 03a1 017d 0574 006a 02a0 0374  .d.....}.t.j...t
+000019b0: 006a 0474 00a0 057c 0464 011b 00a1 010b  .j.t...|.d......
+000019c0: 0074 00a0 067c 0464 011b 00a1 0164 0264  .t...|.d.....d.d
+000019d0: 038d 03a1 017d 0664 047d 0774 00a0 077c  .....}.d.}.t...|
+000019e0: 0074 00a0 087c 01a1 01a1 027d 0864 047d  .t...|.....}.d.}
+000019f0: 0964 047d 0a7c 0264 046b 0272 587c 0774  .d.}.|.d.k.rX|.t
+00001a00: 00a0 0974 00a0 077c 0074 00a0 087c 01a1  ...t...|.t...|..
+00001a10: 01a1 02a1 0137 007d 0790 016e 0e7c 0264  .....7.}...n.|.d
+00001a20: 026b 0272 8474 006a 02a0 0a7c 08a1 017d  .k.r.t.j...|...}
+00001a30: 0b74 00a0 0b7c 0ba1 017d 0c74 0c6a 0da0  .t...|...}.t.j..
+00001a40: 0e7c 0ca1 015c 027d 097d 0a7c 077c 0b7c  .|...\.}.}.|.|.|
+00001a50: 097c 0a66 0219 007c 0314 007c 0414 0037  .|.f...|...|...7
+00001a60: 007d 077c 057c 0919 007d 097c 067c 0a19  .}.|.|...}.|.|..
+00001a70: 007d 0a6e e27c 0264 026b 0490 0172 6674  .}.n.|.d.k...rft
+00001a80: 006a 02a0 0a74 0c6a 0da0 0f7c 0874 00a0  .j...t.j...|.t..
+00001a90: 1064 017c 0314 0064 017c 0414 0066 02a1  .d.|...d.|...f..
+00001aa0: 01a1 02a1 017d 0d74 00a0 0b7c 0da1 017d  .....}.t...|...}
+00001ab0: 0e74 0c6a 0da0 0e7c 0ea1 015c 027d 097d  .t.j...|...\.}.}
+00001ac0: 0a7c 077c 0d7c 097c 0a66 0219 007c 0314  .|.|.|.|.f...|..
+00001ad0: 007c 0414 0037 007d 0774 006a 02a0 0374  .|...7.}.t.j...t
+00001ae0: 006a 0474 00a0 057c 03a1 010b 0074 00a0  .j.t...|.....t..
+00001af0: 067c 03a1 0164 0264 038d 03a1 017d 0f74  .|...d.d.....}.t
+00001b00: 006a 02a0 0374 006a 0474 00a0 057c 04a1  .j...t.j.t...|..
+00001b10: 010b 0074 00a0 067c 04a1 0164 0264 038d  ...t...|...d.d..
+00001b20: 03a1 017d 107c 0f7c 0919 0064 011b 007d  ...}.|.|...d...}
+00001b30: 097c 107c 0a19 0064 011b 007d 0a7c 0264  .|.|...d...}.|.d
+00001b40: 016b 0490 0172 5874 00a0 117c 097c 0214  .k...rXt...|.|..
+00001b50: 00a1 017c 021b 007d 0974 00a0 117c 0a7c  ...|...}.t...|.|
+00001b60: 0214 00a1 017c 021b 007d 0a74 00a0 0574  .....|...}.t...t
+00001b70: 00a0 067c 0264 0514 00a1 0164 011b 00a1  ...|.d.....d....
+00001b80: 017d 117c 117c 097c 0214 0018 007d 127c  .}.|.|.|.....}.|
+00001b90: 117c 0a7c 0214 0018 007d 1374 00a0 0874  .|.|.....}.t...t
+00001ba0: 0c6a 0da0 127c 0874 00a0 067c 0264 0514  .j...|.t...|.d..
+00001bb0: 00a1 0174 00a0 067c 0264 0514 00a1 017c  ...t...|.d.....|
+00001bc0: 027c 127c 13a1 06a1 017d 1474 00a0 0b7c  .|.|.....}.t...|
+00001bd0: 14a1 017d 1574 0c6a 0da0 0e7c 15a1 015c  ...}.t.j...|...\
+00001be0: 027d 167d 177c 077c 147c 167c 1766 0219  .}.}.|.|.|.|.f..
+00001bf0: 0037 007d 077c 167c 1118 007d 167c 177c  .7.}.|.|...}.|.|
+00001c00: 1118 007d 177c 097c 167c 021b 0017 007d  ...}.|.|.|.....}
+00001c10: 097c 0a7c 177c 021b 0017 007d 0a7c 0364  .|.|.|.....}.|.d
+00001c20: 026b 0290 0172 5f64 047d 097c 0464 026b  .k...r_d.}.|.d.k
+00001c30: 0290 0172 6664 047d 0a74 00a0 0974 00a0  ...rfd.}.t...t..
+00001c40: 0b7c 00a1 0164 0113 00a1 017d 1874 00a0  .|...d.....}.t..
+00001c50: 0974 00a0 0b7c 01a1 0164 0113 00a1 017d  .t...|...d.....}
+00001c60: 1974 00a0 0b64 0674 00a0 0b7c 07a1 0164  .t...d.t...|...d
+00001c70: 0113 007c 187c 1914 001b 0018 00a1 0164  ...|.|.........d
+00001c80: 0713 007d 1a74 00a0 137c 07a1 017d 1b74  ...}.t...|...}.t
+00001c90: 006a 147c 017c 016a 1564 088d 027d 1c7c  .j.|.|.j.d...}.|
+00001ca0: 0264 046b 0490 0172 ce74 00a0 167c 067c  .d.k...r.t...|.|
+00001cb0: 05a1 025c 027d 1d7d 1e7c 1e7c 031b 007d  ...\.}.}.|.|...}
+00001cc0: 1e7c 1d7c 041b 007d 1d7c 1c74 00a0 1764  .|.|...}.|.t...d
+00001cd0: 097c 1b14 00a1 0174 00a0 077c 0174 00a0  .|.....t...|.t..
+00001ce0: 1764 0a74 006a 1814 0064 0b14 007c 097c  .d.t.j...d...|.|
+00001cf0: 1e14 007c 0a7c 1d14 0017 0014 00a1 01a1  ...|.|..........
+00001d00: 0214 0037 007d 1c6e 107c 0264 046b 0290  ...7.}.n.|.d.k..
+00001d10: 0172 de7c 1c7c 0174 00a0 1764 097c 1b14  .r.|.|.t...d.|..
+00001d20: 00a1 0114 0037 007d 1c7c 097c 0a7c 1b7c  .....7.}.|.|.|.|
+00001d30: 1a7c 1c66 0553 0029 0c61 ee0f 0000 0a20  .|.f.S.).a..... 
+00001d40: 2020 2055 7073 616d 706c 6564 2046 4654     Upsampled FFT
+00001d50: 2072 6567 6973 7472 6174 696f 6e20 6265   registration be
+00001d60: 7477 6565 6e20 7477 6f20 696d 6167 6573  tween two images
+00001d70: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00001d80: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00001d90: 2020 2020 6275 6631 6674 3a20 6e64 6172      buf1ft: ndar
+00001da0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00001db0: 466f 7572 6965 7220 7472 616e 7366 6f72  Fourier transfor
+00001dc0: 6d20 6f66 2072 6566 6572 656e 6365 2069  m of reference i
+00001dd0: 6d61 6765 2c0a 2020 2020 2020 2020 2020  mage,.          
+00001de0: 2020 4443 2069 6e20 2831 2c31 2920 2020    DC in (1,1)   
+00001df0: 5b44 4f20 4e4f 5420 4646 5453 4849 4654  [DO NOT FFTSHIFT
+00001e00: 5d0a 2020 2020 6275 6632 6674 3a20 6e64  ].    buf2ft: nd
+00001e10: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00001e20: 2020 466f 7572 6965 7220 7472 616e 7366    Fourier transf
+00001e30: 6f72 6d20 6f66 2069 6d61 6765 2074 6f20  orm of image to 
+00001e40: 7265 6769 7374 6572 2c0a 2020 2020 2020  register,.      
+00001e50: 2020 2020 2020 4443 2069 6e20 2831 2c31        DC in (1,1
+00001e60: 2920 5b44 4f20 4e4f 5420 4646 5453 4849  ) [DO NOT FFTSHI
+00001e70: 4654 5d0a 2020 2020 7573 6661 633a 2020  FT].    usfac:  
+00001e80: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
+00001e90: 5570 7361 6d70 6c69 6e67 2066 6163 746f  Upsampling facto
+00001ea0: 7220 2869 6e74 6567 6572 292e 2049 6d61  r (integer). Ima
+00001eb0: 6765 7320 7769 6c6c 2062 6520 7265 6769  ges will be regi
+00001ec0: 7374 6572 6564 2074 6f0a 2020 2020 2020  stered to.      
+00001ed0: 2020 2020 2020 7769 7468 696e 2031 2f75        within 1/u
+00001ee0: 7366 6163 206f 6620 6120 7069 7865 6c2e  sfac of a pixel.
+00001ef0: 2046 6f72 2065 7861 6d70 6c65 2075 7366   For example usf
+00001f00: 6163 203d 2032 3020 6d65 616e 7320 7468  ac = 20 means th
+00001f10: 650a 2020 2020 2020 2020 2020 2020 696d  e.            im
+00001f20: 6167 6573 2077 696c 6c20 6265 2072 6567  ages will be reg
+00001f30: 6973 7465 7265 6420 7769 7468 696e 2031  istered within 1
+00001f40: 2f32 3020 6f66 2061 2070 6978 656c 2e20  /20 of a pixel. 
+00001f50: 2864 6566 6175 6c74 203d 2031 290a 0a20  (default = 1).. 
+00001f60: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00001f70: 2d2d 2d2d 2d2d 0a20 2020 2072 6f77 5f73  ------.    row_s
+00001f80: 6869 6674 3a20 2020 2020 2066 6c6f 6174  hift:      float
+00001f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001fa0: 2020 2020 2050 6978 656c 2073 6869 6674       Pixel shift
+00001fb0: 2069 6e20 6361 7274 6573 6961 6e20 7920   in cartesian y 
+00001fc0: 6469 7265 6374 696f 6e0a 2020 2020 636f  direction.    co
+00001fd0: 6c5f 7368 6966 743a 2020 2020 2020 666c  l_shift:      fl
+00001fe0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+00001ff0: 2020 2020 2020 2020 5069 7865 6c20 7368          Pixel sh
+00002000: 6966 7420 696e 2063 6172 7465 7369 616e  ift in cartesian
+00002010: 2078 2064 6972 6563 7469 6f6e 0a20 2020   x direction.   
+00002020: 2065 7272 6f72 3a20 2020 2020 2020 2020   error:         
+00002030: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
+00002040: 2020 2020 2020 2020 2020 2054 7261 6e73             Trans
+00002050: 6c61 7469 6f6e 2069 6e76 6172 6961 6e74  lation invariant
+00002060: 206e 6f72 6d61 6c69 7a65 6420 524d 5320   normalized RMS 
+00002070: 6572 726f 7220 6265 7477 6565 6e20 6620  error between f 
+00002080: 616e 6420 670a 2020 2020 7068 6173 655f  and g.    phase_
+00002090: 6469 6666 3a20 2020 2020 666c 6f61 740a  diff:     float.
+000020a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000020b0: 2020 2020 476c 6f62 616c 2070 6861 7365      Global phase
+000020c0: 2064 6966 6665 7265 6e63 6520 6265 7477   difference betw
+000020d0: 6565 6e20 7468 6520 7477 6f20 696d 6167  een the two imag
+000020e0: 6573 2028 7368 6f75 6c64 2062 650a 2020  es (should be.  
+000020f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002100: 2020 7a65 726f 2069 6620 696d 6167 6573    zero if images
+00002110: 2061 7265 206e 6f6e 2d6e 6567 6174 6976   are non-negativ
+00002120: 6529 2e0a 2020 2020 7265 6769 7374 6572  e)..    register
+00002130: 6564 5f66 6674 3a20 6e64 6172 7261 790a  ed_fft: ndarray.
+00002140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002150: 2020 2020 466f 7572 6965 7220 7472 616e      Fourier tran
+00002160: 7366 6f72 6d20 6f66 2072 6567 6973 7465  sform of registe
+00002170: 7265 6420 7665 7273 696f 6e20 6f66 2062  red version of b
+00002180: 7566 3266 742c 0a20 2020 2020 2020 2020  uf2ft,.         
+00002190: 2020 2020 2020 2020 2020 2074 6865 2067             the g
+000021a0: 6c6f 6261 6c20 7068 6173 6520 6469 6666  lobal phase diff
+000021b0: 6572 656e 6365 2069 7320 636f 6d70 656e  erence is compen
+000021c0: 7361 7465 6420 666f 722e 0a0a 2020 2020  sated for...    
+000021d0: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+000021e0: 2020 2020 4566 6669 6369 656e 7420 7375      Efficient su
+000021f0: 6270 6978 656c 2069 6d61 6765 2072 6567  bpixel image reg
+00002200: 6973 7472 6174 696f 6e20 6279 2063 726f  istration by cro
+00002210: 7373 636f 7272 656c 6174 696f 6e2e 2054  sscorrelation. T
+00002220: 6869 7320 636f 6465 0a20 2020 2067 6976  his code.    giv
+00002230: 6573 2074 6865 2073 616d 6520 7072 6563  es the same prec
+00002240: 6973 696f 6e20 6173 2074 6865 2046 4654  ision as the FFT
+00002250: 2075 7073 616d 706c 6564 2063 726f 7373   upsampled cross
+00002260: 2063 6f72 7265 6c61 7469 6f6e 2069 6e20   correlation in 
+00002270: 610a 2020 2020 736d 616c 6c20 6672 6163  a.    small frac
+00002280: 7469 6f6e 206f 6620 7468 6520 636f 6d70  tion of the comp
+00002290: 7574 6174 696f 6e20 7469 6d65 2061 6e64  utation time and
+000022a0: 2077 6974 6820 7265 6475 6365 6420 6d65   with reduced me
+000022b0: 6d6f 7279 0a20 2020 2072 6571 7569 7265  mory.    require
+000022c0: 6d65 6e74 732e 2049 7420 6f62 7461 696e  ments. It obtain
+000022d0: 7320 616e 2069 6e69 7469 616c 2065 7374  s an initial est
+000022e0: 696d 6174 6520 6f66 2074 6865 2063 726f  imate of the cro
+000022f0: 7373 636f 7272 656c 6174 696f 6e20 7065  sscorrelation pe
+00002300: 616b 0a20 2020 2062 7920 616e 2046 4654  ak.    by an FFT
+00002310: 2061 6e64 2074 6865 6e20 7265 6669 6e65   and then refine
+00002320: 7320 7468 6520 7368 6966 7420 6573 7469  s the shift esti
+00002330: 6d61 7469 6f6e 2062 7920 7570 7361 6d70  mation by upsamp
+00002340: 6c69 6e67 2074 6865 2044 4654 0a20 2020  ling the DFT.   
+00002350: 206f 6e6c 7920 696e 2061 2073 6d61 6c6c   only in a small
+00002360: 206e 6569 6768 626f 7268 6f6f 6420 6f66   neighborhood of
+00002370: 2074 6861 7420 6573 7469 6d61 7465 2062   that estimate b
+00002380: 7920 6d65 616e 7320 6f66 2061 0a20 2020  y means of a.   
+00002390: 206d 6174 7269 782d 6d75 6c74 6970 6c79   matrix-multiply
+000023a0: 2044 4654 2e20 5769 7468 2074 6869 7320   DFT. With this 
+000023b0: 7072 6f63 6564 7572 6520 616c 6c20 7468  procedure all th
+000023c0: 6520 696d 6167 6520 706f 696e 7473 2061  e image points a
+000023d0: 7265 2075 7365 6420 746f 0a20 2020 2063  re used to.    c
+000023e0: 6f6d 7075 7465 2074 6865 2075 7073 616d  ompute the upsam
+000023f0: 706c 6564 2063 726f 7373 636f 7272 656c  pled crosscorrel
+00002400: 6174 696f 6e2e 0a0a 2020 2020 5265 6665  ation...    Refe
+00002410: 7265 6e63 6573 0a20 2020 202d 2d2d 2d2d  rences.    -----
+00002420: 2d2d 2d2d 2d0a 2020 2020 2e2e 205b 315d  -----.    .. [1]
+00002430: 204d 616e 7565 6c20 4775 697a 6172 2d53   Manuel Guizar-S
+00002440: 6963 6169 726f 732c 2053 616d 7565 6c20  icairos, Samuel 
+00002450: 542e 2054 6875 726d 616e 2c20 616e 6420  T. Thurman, and 
+00002460: 4a61 6d65 7320 522e 2046 6965 6e75 702c  James R. Fienup,
+00002470: 0a20 2020 2020 2020 2245 6666 6963 6965  .       "Efficie
+00002480: 6e74 2073 7562 7069 7865 6c20 696d 6167  nt subpixel imag
+00002490: 6520 7265 6769 7374 7261 7469 6f6e 2061  e registration a
+000024a0: 6c67 6f72 6974 686d 732c 2220 4f70 742e  lgorithms," Opt.
+000024b0: 204c 6574 742e 2033 332c 0a20 2020 2020   Lett. 33,.     
+000024c0: 2020 3135 362d 3135 3820 2832 3030 3829    156-158 (2008)
+000024d0: 2e0a 0a20 2020 2043 6f70 7972 6967 6874  ...    Copyright
+000024e0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000024f0: 2020 2020 436f 7079 7269 6768 7420 2863      Copyright (c
+00002500: 2920 3230 3136 2c20 4d61 6e75 656c 2047  ) 2016, Manuel G
+00002510: 7569 7a61 7220 5369 6361 6972 6f73 2c20  uizar Sicairos, 
+00002520: 4a61 6d65 7320 522e 2046 6965 6e75 702c  James R. Fienup,
+00002530: 2055 6e69 7665 7273 6974 7920 6f66 2052   University of R
+00002540: 6f63 6865 7374 6572 0a20 2020 2041 6c6c  ochester.    All
+00002550: 2072 6967 6874 7320 7265 7365 7276 6564   rights reserved
+00002560: 2e0a 0a20 2020 2052 6564 6973 7472 6962  ...    Redistrib
+00002570: 7574 696f 6e20 616e 6420 7573 6520 696e  ution and use in
+00002580: 2073 6f75 7263 6520 616e 6420 6269 6e61   source and bina
+00002590: 7279 2066 6f72 6d73 2c20 7769 7468 206f  ry forms, with o
+000025a0: 7220 7769 7468 6f75 740a 2020 2020 6d6f  r without.    mo
+000025b0: 6469 6669 6361 7469 6f6e 2c20 6172 6520  dification, are 
+000025c0: 7065 726d 6974 7465 6420 7072 6f76 6964  permitted provid
+000025d0: 6564 2074 6861 7420 7468 6520 666f 6c6c  ed that the foll
+000025e0: 6f77 696e 6720 636f 6e64 6974 696f 6e73  owing conditions
+000025f0: 2061 7265 0a20 2020 206d 6574 3a0a 2020   are.    met:.  
+00002600: 2020 2a20 5265 6469 7374 7269 6275 7469    * Redistributi
+00002610: 6f6e 7320 6f66 2073 6f75 7263 6520 636f  ons of source co
+00002620: 6465 206d 7573 7420 7265 7461 696e 2074  de must retain t
+00002630: 6865 2061 626f 7665 2063 6f70 7972 6967  he above copyrig
+00002640: 6874 0a20 2020 2020 206e 6f74 6963 652c  ht.      notice,
+00002650: 2074 6869 7320 6c69 7374 206f 6620 636f   this list of co
+00002660: 6e64 6974 696f 6e73 2061 6e64 2074 6865  nditions and the
+00002670: 2066 6f6c 6c6f 7769 6e67 2064 6973 636c   following discl
+00002680: 6169 6d65 722e 0a20 2020 202a 2052 6564  aimer..    * Red
+00002690: 6973 7472 6962 7574 696f 6e73 2069 6e20  istributions in 
+000026a0: 6269 6e61 7279 2066 6f72 6d20 6d75 7374  binary form must
+000026b0: 2072 6570 726f 6475 6365 2074 6865 2061   reproduce the a
+000026c0: 626f 7665 2063 6f70 7972 6967 6874 0a20  bove copyright. 
+000026d0: 2020 2020 206e 6f74 6963 652c 2074 6869       notice, thi
+000026e0: 7320 6c69 7374 206f 6620 636f 6e64 6974  s list of condit
+000026f0: 696f 6e73 2061 6e64 2074 6865 2066 6f6c  ions and the fol
+00002700: 6c6f 7769 6e67 2064 6973 636c 6169 6d65  lowing disclaime
+00002710: 7220 696e 0a20 2020 2020 2074 6865 2064  r in.      the d
+00002720: 6f63 756d 656e 7461 7469 6f6e 2061 6e64  ocumentation and
+00002730: 2f6f 7220 6f74 6865 7220 6d61 7465 7269  /or other materi
+00002740: 616c 7320 7072 6f76 6964 6564 2077 6974  als provided wit
+00002750: 6820 7468 6520 6469 7374 7269 6275 7469  h the distributi
+00002760: 6f6e 0a20 2020 202a 204e 6569 7468 6572  on.    * Neither
+00002770: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
+00002780: 2055 6e69 7665 7273 6974 7920 6f66 2052   University of R
+00002790: 6f63 6865 7374 6572 206e 6f72 2074 6865  ochester nor the
+000027a0: 206e 616d 6573 0a20 2020 2020 206f 6620   names.      of 
+000027b0: 6974 7320 636f 6e74 7269 6275 746f 7273  its contributors
+000027c0: 206d 6179 2062 6520 7573 6564 2074 6f20   may be used to 
+000027d0: 656e 646f 7273 6520 6f72 2070 726f 6d6f  endorse or promo
+000027e0: 7465 2070 726f 6475 6374 7320 6465 7269  te products deri
+000027f0: 7665 640a 2020 2020 2020 6672 6f6d 2074  ved.      from t
+00002800: 6869 7320 736f 6674 7761 7265 2077 6974  his software wit
+00002810: 686f 7574 2073 7065 6369 6669 6320 7072  hout specific pr
+00002820: 696f 7220 7772 6974 7465 6e20 7065 726d  ior written perm
+00002830: 6973 7369 6f6e 2e0a 0a20 2020 2054 4849  ission...    THI
+00002840: 5320 534f 4654 5741 5245 2049 5320 5052  S SOFTWARE IS PR
+00002850: 4f56 4944 4544 2042 5920 5448 4520 434f  OVIDED BY THE CO
+00002860: 5059 5249 4748 5420 484f 4c44 4552 5320  PYRIGHT HOLDERS 
+00002870: 414e 4420 434f 4e54 5249 4255 544f 5253  AND CONTRIBUTORS
+00002880: 2022 4153 2049 5322 0a20 2020 2041 4e44   "AS IS".    AND
+00002890: 2041 4e59 2045 5850 5245 5353 204f 5220   ANY EXPRESS OR 
+000028a0: 494d 504c 4945 4420 5741 5252 414e 5449  IMPLIED WARRANTI
+000028b0: 4553 2c20 494e 434c 5544 494e 472c 2042  ES, INCLUDING, B
+000028c0: 5554 204e 4f54 204c 494d 4954 4544 2054  UT NOT LIMITED T
+000028d0: 4f2c 2054 4845 0a20 2020 2049 4d50 4c49  O, THE.    IMPLI
+000028e0: 4544 2057 4152 5241 4e54 4945 5320 4f46  ED WARRANTIES OF
+000028f0: 204d 4552 4348 414e 5441 4249 4c49 5459   MERCHANTABILITY
+00002900: 2041 4e44 2046 4954 4e45 5353 2046 4f52   AND FITNESS FOR
+00002910: 2041 2050 4152 5449 4355 4c41 5220 5055   A PARTICULAR PU
+00002920: 5250 4f53 450a 2020 2020 4152 4520 4449  RPOSE.    ARE DI
+00002930: 5343 4c41 494d 4544 2e20 494e 204e 4f20  SCLAIMED. IN NO 
+00002940: 4556 454e 5420 5348 414c 4c20 5448 4520  EVENT SHALL THE 
+00002950: 434f 5059 5249 4748 5420 4f57 4e45 5220  COPYRIGHT OWNER 
+00002960: 4f52 2043 4f4e 5452 4942 5554 4f52 5320  OR CONTRIBUTORS 
+00002970: 4245 0a20 2020 204c 4941 424c 4520 464f  BE.    LIABLE FO
+00002980: 5220 414e 5920 4449 5245 4354 2c20 494e  R ANY DIRECT, IN
+00002990: 4449 5245 4354 2c20 494e 4349 4445 4e54  DIRECT, INCIDENT
+000029a0: 414c 2c20 5350 4543 4941 4c2c 2045 5845  AL, SPECIAL, EXE
+000029b0: 4d50 4c41 5259 2c20 4f52 0a20 2020 2043  MPLARY, OR.    C
+000029c0: 4f4e 5345 5155 454e 5449 414c 2044 414d  ONSEQUENTIAL DAM
+000029d0: 4147 4553 2028 494e 434c 5544 494e 472c  AGES (INCLUDING,
+000029e0: 2042 5554 204e 4f54 204c 494d 4954 4544   BUT NOT LIMITED
+000029f0: 2054 4f2c 2050 524f 4355 5245 4d45 4e54   TO, PROCUREMENT
+00002a00: 204f 460a 2020 2020 5355 4253 5449 5455   OF.    SUBSTITU
+00002a10: 5445 2047 4f4f 4453 204f 5220 5345 5256  TE GOODS OR SERV
+00002a20: 4943 4553 3b20 4c4f 5353 204f 4620 5553  ICES; LOSS OF US
+00002a30: 452c 2044 4154 412c 204f 5220 5052 4f46  E, DATA, OR PROF
+00002a40: 4954 533b 204f 5220 4255 5349 4e45 5353  ITS; OR BUSINESS
+00002a50: 0a20 2020 2049 4e54 4552 5255 5054 494f  .    INTERRUPTIO
+00002a60: 4e29 2048 4f57 4556 4552 2043 4155 5345  N) HOWEVER CAUSE
+00002a70: 4420 414e 4420 4f4e 2041 4e59 2054 4845  D AND ON ANY THE
+00002a80: 4f52 5920 4f46 204c 4941 4249 4c49 5459  ORY OF LIABILITY
+00002a90: 2c20 5748 4554 4845 5220 494e 0a20 2020  , WHETHER IN.   
+00002aa0: 2043 4f4e 5452 4143 542c 2053 5452 4943   CONTRACT, STRIC
+00002ab0: 5420 4c49 4142 494c 4954 592c 204f 5220  T LIABILITY, OR 
+00002ac0: 544f 5254 2028 494e 434c 5544 494e 4720  TORT (INCLUDING 
+00002ad0: 4e45 474c 4947 454e 4345 204f 5220 4f54  NEGLIGENCE OR OT
+00002ae0: 4845 5257 4953 4529 0a20 2020 2041 5249  HERWISE).    ARI
+00002af0: 5349 4e47 2049 4e20 414e 5920 5741 5920  SING IN ANY WAY 
+00002b00: 4f55 5420 4f46 2054 4845 2055 5345 204f  OUT OF THE USE O
+00002b10: 4620 5448 4953 2053 4f46 5457 4152 452c  F THIS SOFTWARE,
+00002b20: 2045 5645 4e20 4946 2041 4456 4953 4544   EVEN IF ADVISED
+00002b30: 204f 4620 5448 450a 2020 2020 504f 5353   OF THE.    POSS
+00002b40: 4942 494c 4954 5920 4f46 2053 5543 4820  IBILITY OF SUCH 
+00002b50: 4441 4d41 4745 2e0a 0a20 2020 2045 7861  DAMAGE...    Exa
+00002b60: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00002b70: 2d2d 0a20 2020 2049 6620 796f 7520 6861  --.    If you ha
+00002b80: 7665 2074 776f 2069 6d61 6765 7320 696d  ve two images im
+00002b90: 3120 616e 6420 696d 322c 2072 756e 2061  1 and im2, run a
+00002ba0: 733a 0a0a 2020 2020 3e3e 3e20 726f 775f  s:..    >>> row_
+00002bb0: 7368 6966 742c 636f 6c5f 7368 6966 742c  shift,col_shift,
+00002bc0: 7068 6173 655f 6469 6666 2c65 7272 6f72  phase_diff,error
+00002bd0: 2c72 6567 6973 7465 7265 645f 6666 7420  ,registered_fft 
+00002be0: 3d20 6466 7472 6567 6973 7472 6174 696f  = dftregistratio
+00002bf0: 6e28 6e70 2e66 6674 2e66 6674 3228 696d  n(np.fft.fft2(im
+00002c00: 3129 2c6e 702e 6666 742e 6666 7432 2869  1),np.fft.fft2(i
+00002c10: 6d32 292c 7570 7361 6d70 6c69 6e67 290a  m2),upsampling).
+00002c20: 0a20 2020 2059 6f75 2063 616e 2074 6573  .    You can tes
+00002c30: 7420 6279 2072 6576 6572 7369 6e67 2074  t by reversing t
+00002c40: 6865 206f 7264 6572 0a0a 2020 2020 3e3e  he order..    >>
+00002c50: 3e20 726f 775f 7368 6966 745f 722c 636f  > row_shift_r,co
+00002c60: 6c5f 7368 6966 745f 722c 7068 6173 655f  l_shift_r,phase_
+00002c70: 6469 6666 2c65 7272 6f72 2c72 6567 6973  diff,error,regis
+00002c80: 7465 7265 645f 6666 7420 3d20 6466 7472  tered_fft = dftr
+00002c90: 6567 6973 7472 6174 696f 6e28 6e70 2e66  egistration(np.f
+00002ca0: 6674 2e66 6674 3228 696d 3229 2c6e 702e  ft.fft2(im2),np.
+00002cb0: 6666 742e 6666 7432 2869 6d31 292c 7570  fft.fft2(im1),up
+00002cc0: 7361 6d70 6c69 6e67 290a 2020 2020 3e3e  sampling).    >>
+00002cd0: 3e20 726f 775f 7368 6966 7420 3d3d 202d  > row_shift == -
+00002ce0: 726f 775f 7368 6966 745f 720a 2020 2020  row_shift_r.    
+00002cf0: 3e3e 3e20 5472 7565 0a20 2020 203e 3e3e  >>> True.    >>>
+00002d00: 2063 6f6c 5f73 6869 6674 203d 3d20 2d63   col_shift == -c
+00002d10: 6f6c 5f73 6869 6674 5f72 0a20 2020 203e  ol_shift_r.    >
+00002d20: 3e3e 2054 7275 650a 2020 2020 7233 0000  >> True.    r3..
+00002d30: 0072 0b00 0000 2903 da05 7374 6172 74da  .r....)...start.
+00002d40: 0473 746f 70da 0473 7465 7072 0100 0000  .stop..stepr....
+00002d50: 6700 0000 0000 00f8 3f67 0000 0000 0000  g.......?g......
+00002d60: f03f 6700 0000 0000 00e0 3f72 1900 0000  .?g.......?r....
+00002d70: 7900 0000 0000 0000 0000 0000 0000 00f0  y...............
+00002d80: 3f79 0000 0000 0000 0000 0000 0000 0000  ?y..............
+00002d90: 0040 e9ff ffff ff29 1972 0c00 0000 720e  .@.....).r....r.
+00002da0: 0000 0072 2500 0000 722b 0000 0072 1b00  ...r%...r+...r..
+00002db0: 0000 5a03 6669 78da 0463 6569 6c5a 086d  ..Z.fix..ceilZ.m
+00002dc0: 756c 7469 706c 795a 0463 6f6e 6ada 0373  ultiplyZ.conj..s
+00002dd0: 756d 5a05 6966 6674 3272 2800 0000 7226  umZ.ifft2r(...r&
+00002de0: 0000 0072 2700 0000 7220 0000 0072 2c00  ...r'...r ...r,.
+00002df0: 0000 7224 0000 00da 0572 6f75 6e64 723b  ..r$.....roundr;
+00002e00: 0000 005a 0561 6e67 6c65 5a0a 7a65 726f  ...Z.angleZ.zero
+00002e10: 735f 6c69 6b65 721a 0000 005a 086d 6573  s_liker....Z.mes
+00002e20: 6867 7269 6472 3500 0000 7236 0000 0029  hgridr5...r6...)
+00002e30: 1f72 3c00 0000 723d 0000 0072 2e00 0000  .r<...r=...r....
+00002e40: 7239 0000 0072 3a00 0000 5a02 4e72 5a02  r9...r:...Z.NrZ.
+00002e50: 4e63 5a05 4343 6d61 785a 0766 745f 6d75  NcZ.CCmaxZ.ft_mu
+00002e60: 6c74 5a09 726f 775f 7368 6966 745a 0963  ltZ.row_shiftZ.c
+00002e70: 6f6c 5f73 6869 6674 5a04 4343 5f31 5a07  ol_shiftZ.CC_1Z.
+00002e80: 4343 6162 735f 315a 0443 435f 325a 0743  CCabs_1Z.CC_2Z.C
+00002e90: 4361 6273 5f32 5a03 4e72 325a 034e 6332  Cabs_2Z.Nr2Z.Nc2
+00002ea0: 5a08 6466 7473 6869 6674 5a06 6466 7472  Z.dftshiftZ.dftr
+00002eb0: 6f77 5a06 6466 7463 6f6c 5a04 4343 5f6d  owZ.dftcolZ.CC_m
+00002ec0: 5a07 4343 6162 735f 6d5a 0472 6c6f 635a  Z.CCabs_mZ.rlocZ
+00002ed0: 0463 6c6f 635a 0472 6730 305a 0472 6630  .clocZ.rg00Z.rf0
+00002ee0: 30da 0565 7272 6f72 5a0a 7068 6173 655f  0..errorZ.phase_
+00002ef0: 6469 6666 5a0e 7265 6769 7374 6572 6564  diffZ.registered
+00002f00: 5f66 6674 5a07 4e63 5f67 7269 645a 074e  _fftZ.Nc_gridZ.N
+00002f10: 725f 6772 6964 7214 0000 0072 1400 0000  r_gridr....r....
+00002f20: 7215 0000 00da 0f64 6674 7265 6769 7374  r......dftregist
+00002f30: 7261 7469 6f6e dc00 0000 73b0 0000 000e  ration....s.....
+00002f40: 6006 0124 0104 ff06 0324 0104 ff04 0312  `..$.....$......
+00002f50: 0104 0104 0108 0120 0208 010c 020a 0110  ....... ........
+00002f60: 0118 0108 020a 010a 0128 020a 0110 0118  .........(......
+00002f70: 0106 021c 0104 ff06 031c 0104 ff0c 030c  ................
+00002f80: 010a 0212 0312 0118 010c 010c 0104 0306  ................
+00002f90: 0102 010c 010c 0102 0102 0102 0102 fa04  ................
+00002fa0: ff0a 0b10 0110 0108 0108 010c 010c 010a  ................
+00002fb0: 0304 010a 0104 0114 0114 0124 010a 0104  ...........$....
+00002fc0: 0306 0106 ff0a 0310 0108 0108 010e 0104  ................
+00002fd0: 0102 0104 0102 0104 0202 fe02 0302 fd0e  ................
+00002fe0: 0402 fc02 ff02 fe08 ff0a 0c16 010e 0172  ...............r
+00002ff0: 4600 0000 2901 7217 0000 0029 0572 0b00  F...).r....).r..
+00003000: 0000 7201 0000 0072 0100 0000 7201 0000  ..r....r....r...
+00003010: 0072 0100 0000 2901 720b 0000 0029 135a  .r....).r....).Z
+00003020: 056e 756d 7079 720c 0000 00da 0873 7465  .numpyr......ste
+00003030: 6d74 6f6f 6c72 2600 0000 da06 7479 7069  mtoolr&.....typi
+00003040: 6e67 7202 0000 0072 0300 0000 5a08 6e70  ngr....r....Z.np
+00003050: 7479 7069 6e67 7204 0000 0072 0500 0000  typingr....r....
+00003060: 7206 0000 0072 0700 0000 7208 0000 0072  r....r....r....r
+00003070: 1600 0000 da03 7374 7272 2000 0000 722c  ......strr ...r,
+00003080: 0000 0072 3b00 0000 7246 0000 0072 1400  ...r;...rF...r..
+00003090: 0000 7214 0000 0072 1400 0000 7215 0000  ..r....r....r...
+000030a0: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
+000030b0: 6400 0000 0800 0801 1001 1c01 2603 021d  d...........&...
+000030c0: 04ff 0e01 02ff 0201 02ff 0a02 0afe 0234  ...............4
+000030d0: 0e01 02ff 0e01 02ff 0e02 0afe 023e 0201  .............>..
+000030e0: 0201 0201 0201 04fa 0e01 02ff 0202 02fe  ................
+000030f0: 0203 02fd 0204 02fc 0205 02fb 0206 02fa  ................
+00003100: 0e07 0af9 024c 04fd 0e01 02ff 0e02 02fe  .....L..........
+00003110: 0203 02fd 1c04 0efc                      ........
```

## Comparing `stemtool/util/__pycache__/gauss_utils.cpython-39.pyc` & `stemtool/util/__pycache__/gauss_utils.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:07:48 2023 UTC, .py size: 13446 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 2% similar despite different names*

```diff
@@ -1,740 +1,739 @@
-00000000: 610d 0d0a 0000 0000 e433 e163 8634 0000  a........3.c.4..
+00000000: 6f0d 0d0a 0000 0000 12a7 3c63 8634 0000  o.........<c.4..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 6c00 0000 6400  .....@...sl...d.
+00000020: 0003 0000 0040 0000 0073 6e00 0000 6400  .....@...sn...d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 6d03 5a04  d.l.Z.d.d.l.m.Z.
 00000040: 0100 6400 6401 6c05 6d06 5a07 0100 6400  ..d.d.l.m.Z...d.
 00000050: 6401 6c08 5a09 6402 6403 8400 5a0a 6404  d.l.Z.d.d...Z.d.
 00000060: 6405 8400 5a0b 6412 6407 6408 8401 5a0c  d...Z.d.d.d...Z.
-00000070: 6413 640a 640b 8401 5a0d 640c 640d 8400  d.d.d...Z.d.d...
-00000080: 5a0e 6414 640e 640f 8401 5a0f 6415 6410  Z.d.d.d...Z.d.d.
-00000090: 6411 8401 5a10 6401 5300 2916 e900 0000  d...Z.d.S.).....
-000000a0: 004e 6307 0000 0000 0000 0000 0000 0010  .Nc.............
-000000b0: 0000 0008 0000 0043 0000 0073 fc00 0000  .......C...s....
-000000c0: 7c00 6401 1900 7c01 1800 7d07 7c00 6402  |.d...|...}.|.d.
-000000d0: 1900 7c02 1800 7d08 7400 a001 7c03 a101  ..|...}.t...|...
-000000e0: 6403 1300 6403 7c04 6403 1300 1400 1b00  d...d.|.d.......
-000000f0: 7400 a002 7c03 a101 6403 1300 6403 7c05  t...|...d...d.|.
-00000100: 6403 1300 1400 1b00 1700 7d09 7400 a002  d.........}.t...
-00000110: 6403 7c03 1400 a101 6403 7c04 6403 1300  d.|.....d.|.d...
-00000120: 1400 1b00 7400 a002 6403 7c03 1400 a101  ....t...d.|.....
-00000130: 6403 7c05 6403 1300 1400 1b00 1800 7d0a  d.|.d.........}.
-00000140: 7400 a002 7c03 a101 6403 1300 6403 7c04  t...|...d...d.|.
-00000150: 6403 1300 1400 1b00 7400 a001 7c03 a101  d.......t...|...
-00000160: 6403 1300 6403 7c05 6403 1300 1400 1b00  d...d.|.d.......
-00000170: 1700 7d0b 7c09 7c07 6403 1300 1400 7d0c  ..}.|.|.d.....}.
-00000180: 7c0a 7c07 1400 7c08 1400 7d0d 7c0b 7c08  |.|...|...}.|.|.
-00000190: 6403 1300 1400 7d0e 7400 a003 7c06 7400  d.....}.t...|.t.
-000001a0: a004 6404 7c0c 7c0d 1700 7c0e 1700 1400  ..d.|.|...|.....
-000001b0: a101 1400 a101 7d0f 7c0f 5300 2905 61b2  ......}.|.S.).a.
-000001c0: 0300 000a 2020 2020 5468 6520 756e 6465  ....    The unde
-000001d0: 726c 7969 6e67 2032 4420 4761 7573 7369  rlying 2D Gaussi
-000001e0: 616e 2066 756e 6374 696f 6e0a 0a20 2020  an function..   
-000001f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00000200: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078  ----------.    x
-00000210: 793a 2020 2020 2020 2020 7475 706c 650a  y:        tuple.
-00000220: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00000230: 2061 6e64 2079 2070 6f73 6974 696f 6e73   and y positions
-00000240: 0a20 2020 2078 303a 2020 2020 2020 2020  .    x0:        
-00000250: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-00000260: 2020 2020 2078 2063 656e 7465 7220 6f66       x center of
-00000270: 2047 6175 7373 6961 6e20 7065 616b 0a20   Gaussian peak. 
-00000280: 2020 2079 303a 2020 2020 2020 2020 666c     y0:        fl
-00000290: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-000002a0: 2020 2079 2063 656e 7465 7220 6f66 2047     y center of G
-000002b0: 6175 7373 6961 6e20 7065 616b 0a20 2020  aussian peak.   
-000002c0: 2074 6865 7461 3a20 2020 2020 666c 6f61   theta:     floa
-000002d0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-000002e0: 2052 6f74 6174 696f 6e20 6f66 2074 6865   Rotation of the
-000002f0: 2032 4420 6761 7573 7369 616e 2070 6561   2D gaussian pea
-00000300: 6b20 696e 2072 6164 6961 6e73 0a20 2020  k in radians.   
-00000310: 2073 6967 6d61 5f78 3a20 2020 666c 6f61   sigma_x:   floa
-00000320: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00000330: 2053 7461 6e64 6172 6420 6465 7669 6174   Standard deviat
-00000340: 696f 6e20 6f66 2074 6865 2032 4420 4761  ion of the 2D Ga
-00000350: 7573 7369 616e 2061 6c6f 6e67 2078 0a20  ussian along x. 
-00000360: 2020 2073 6967 6d61 5f79 3a20 2020 666c     sigma_y:   fl
-00000370: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-00000380: 2020 2053 7461 6e64 6172 6420 6465 7669     Standard devi
-00000390: 6174 696f 6e20 6f66 2074 6865 2032 4420  ation of the 2D 
-000003a0: 4761 7573 7369 616e 2061 6c6f 6e67 2079  Gaussian along y
-000003b0: 0a20 2020 2061 6d70 6c69 7475 6465 3a20  .    amplitude: 
-000003c0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-000003d0: 2020 2020 2050 6561 6b20 696e 7465 6e73       Peak intens
-000003e0: 6974 790a 0a20 2020 2052 6574 7572 6e73  ity..    Returns
-000003f0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00000400: 2067 6175 7373 7661 6c73 3a20 6e64 6172   gaussvals: ndar
-00000410: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00000420: 2020 2041 2047 6175 7369 616e 2070 6561     A Gausian pea
-00000430: 6b20 6365 6e74 6572 6564 2061 7420 7830  k centered at x0
-00000440: 2c20 7930 2062 6173 6564 206f 6e20 7468  , y0 based on th
-00000450: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00000460: 2070 6172 616d 6574 6572 7320 6769 7665   parameters give
-00000470: 6e0a 0a20 2020 204e 6f74 6573 0a20 2020  n..    Notes.   
-00000480: 202d 2d2d 2d2d 0a20 2020 2054 6865 2047   -----.    The G
-00000490: 6175 7373 6961 6e20 3244 2066 756e 6374  aussian 2D funct
-000004a0: 696f 6e20 6973 2063 616c 6375 6c61 7465  ion is calculate
-000004b0: 6420 6174 2065 7665 7279 2078 2061 6e64  d at every x and
-000004c0: 2079 2070 6f73 6974 696f 6e0a 2020 2020   y position.    
-000004d0: 666f 7220 6120 6c69 7374 206f 6620 706f  for a list of po
-000004e0: 7369 7469 6f6e 2076 616c 7565 7320 6261  sition values ba
-000004f0: 7365 6420 6f6e 2074 6865 2070 6172 616d  sed on the param
-00000500: 6574 6572 7320 6769 7665 6e2e 0a0a 2020  eters given...  
-00000510: 2020 5365 6520 616c 736f 0a20 2020 202d    See also.    -
-00000520: 2d2d 2d2d 2d2d 2d0a 2020 2020 6761 7573  -------.    gaus
-00000530: 7332 440a 0a20 2020 203a 4175 7468 6f72  s2D..    :Author
-00000540: 733a 0a20 2020 2044 6562 616e 6773 6875  s:.    Debangshu
-00000550: 204d 756b 6865 726a 6565 203c 6d75 6b68   Mukherjee <mukh
-00000560: 6572 6a65 6564 406f 726e 6c2e 676f 763e  erjeed@ornl.gov>
-00000570: 0a20 2020 2072 0100 0000 e901 0000 00e9  .    r..........
-00000580: 0200 0000 e9ff ffff ff29 05da 026e 70da  .........)...np.
-00000590: 0363 6f73 da03 7369 6e5a 0572 6176 656c  .cos..sinZ.ravel
-000005a0: da03 6578 7029 10da 0278 79da 0278 30da  ..exp)...xy..x0.
-000005b0: 0279 30da 0574 6865 7461 da07 7369 676d  .y0..theta..sigm
-000005c0: 615f 78da 0773 6967 6d61 5f79 da09 616d  a_x..sigma_y..am
-000005d0: 706c 6974 7564 65da 0178 da01 79da 0674  plitude..x..y..t
-000005e0: 6572 6d5f 31da 0674 6572 6d5f 32da 0674  erm_1..term_2..t
-000005f0: 6572 6d5f 33da 0665 7870 6f5f 31da 0665  erm_3..expo_1..e
-00000600: 7870 6f5f 32da 0665 7870 6f5f 33da 0967  xpo_2..expo_3..g
-00000610: 6175 7373 7661 6c73 a900 7219 0000 00fa  aussvals..r.....
-00000620: 3f62 7569 6c64 2f62 6469 7374 2e6d 6163  ?build/bdist.mac
-00000630: 6f73 782d 3130 2e39 2d78 3836 5f36 342f  osx-10.9-x86_64/
-00000640: 6567 672f 7374 656d 746f 6f6c 2f75 7469  egg/stemtool/uti
-00000650: 6c2f 6761 7573 735f 7574 696c 732e 7079  l/gauss_utils.py
-00000660: da14 6761 7573 7369 616e 5f32 445f 6675  ..gaussian_2D_fu
-00000670: 6e63 7469 6f6e 0700 0000 7320 0000 0000  nction....s ....
-00000680: 270c 010c 0118 0118 ff04 0318 0118 ff04  '...............
-00000690: 0318 0118 ff04 030c 010c 010c 0120 0172  ............. .r
-000006a0: 1b00 0000 6307 0000 0000 0000 0000 0000  ....c...........
-000006b0: 0012 0000 0006 0000 0043 0000 0073 3401  .........C...s4.
-000006c0: 0000 7400 6a01 6401 7c00 6401 1900 8502  ..t.j.d.|.d.....
-000006d0: 6401 7c00 6402 1900 8502 6602 1900 5c02  d.|.d.....f...\.
-000006e0: 7d07 7d08 7400 6a02 7c07 7400 6a03 6403  }.}.t.j.|.t.j.d.
-000006f0: 8d02 7d09 7c08 7c01 1800 7d0a 7c07 7c02  ..}.|.|...}.|.|.
-00000700: 1800 7d0b 7400 a004 7c03 a101 6404 1300  ..}.t...|...d...
-00000710: 6404 7c04 6404 1300 1400 1b00 7400 a005  d.|.d.......t...
-00000720: 7c03 a101 6404 1300 6404 7c05 6404 1300  |...d...d.|.d...
-00000730: 1400 1b00 1700 7d0c 7400 a005 6404 7c03  ......}.t...d.|.
-00000740: 1400 a101 6404 7c04 6404 1300 1400 1b00  ....d.|.d.......
-00000750: 7400 a005 6404 7c03 1400 a101 6404 7c05  t...d.|.....d.|.
-00000760: 6404 1300 1400 1b00 1800 7d0d 7400 a005  d.........}.t...
-00000770: 7c03 a101 6404 1300 6404 7c04 6404 1300  |...d...d.|.d...
-00000780: 1400 1b00 7400 a004 7c03 a101 6404 1300  ....t...|...d...
-00000790: 6404 7c05 6404 1300 1400 1b00 1700 7d0e  d.|.d.........}.
-000007a0: 7c0c 7400 a006 7c0a 7c0a a102 1400 7d0f  |.t...|.|.....}.
-000007b0: 7c0d 7400 a006 7c0a 7c0b a102 1400 7d10  |.t...|.|.....}.
-000007c0: 7c0e 7400 a006 7c0b 7c0b a102 1400 7d11  |.t...|.|.....}.
-000007d0: 7c06 7400 a007 6405 7c0f 7c10 1700 7c11  |.t...d.|.|...|.
-000007e0: 1700 1400 a101 1400 7c09 7c07 7c08 6602  ........|.|.|.f.
-000007f0: 3c00 7c09 5300 2906 61de 0300 000a 2020  <.|.S.).a.....  
-00000800: 2020 5265 7475 726e 2061 2032 4420 4761    Return a 2D Ga
-00000810: 7573 7369 616e 2066 756e 6374 696f 6e20  ussian function 
-00000820: 6365 6e74 6572 6564 2061 7420 7830 2c20  centered at x0, 
-00000830: 7930 0a0a 2020 2020 5061 7261 6d65 7465  y0..    Paramete
-00000840: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00000850: 2d0a 2020 2020 696d 5f73 697a 653a 2020  -.    im_size:  
-00000860: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
-00000870: 2020 2020 2020 5369 7a65 206f 6620 7468        Size of th
-00000880: 6520 696d 6167 6520 7768 6572 6520 6120  e image where a 
-00000890: 4761 7573 7369 616e 2070 6561 6b0a 2020  Gaussian peak.  
-000008a0: 2020 2020 2020 2020 2020 2020 2069 7320               is 
-000008b0: 746f 2062 6520 6765 6e65 7261 7465 640a  to be generated.
-000008c0: 2020 2020 7830 3a20 2020 2020 2020 2066      x0:        f
-000008d0: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-000008e0: 2020 2020 7820 6365 6e74 6572 206f 6620      x center of 
-000008f0: 4761 7573 7369 616e 2070 6561 6b0a 2020  Gaussian peak.  
-00000900: 2020 7930 3a20 2020 2020 2020 2066 6c6f    y0:        flo
-00000910: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-00000920: 2020 7920 6365 6e74 6572 206f 6620 4761    y center of Ga
-00000930: 7573 7369 616e 2070 6561 6b0a 2020 2020  ussian peak.    
-00000940: 7468 6574 613a 2020 2020 2066 6c6f 6174  theta:     float
-00000950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000960: 526f 7461 7469 6f6e 206f 6620 7468 6520  Rotation of the 
-00000970: 3244 2067 6175 7373 6961 6e20 7065 616b  2D gaussian peak
-00000980: 2069 6e20 7261 6469 616e 730a 2020 2020   in radians.    
-00000990: 7369 676d 615f 783a 2020 2066 6c6f 6174  sigma_x:   float
-000009a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000009b0: 5374 616e 6461 7264 2064 6576 6961 7469  Standard deviati
-000009c0: 6f6e 206f 6620 7468 6520 3244 2047 6175  on of the 2D Gau
-000009d0: 7373 6961 6e20 616c 6f6e 6720 780a 2020  ssian along x.  
-000009e0: 2020 7369 676d 615f 793a 2020 2066 6c6f    sigma_y:   flo
-000009f0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-00000a00: 2020 5374 616e 6461 7264 2064 6576 6961    Standard devia
-00000a10: 7469 6f6e 206f 6620 7468 6520 3244 2047  tion of the 2D G
-00000a20: 6175 7373 6961 6e20 616c 6f6e 6720 790a  aussian along y.
-00000a30: 2020 2020 616d 706c 6974 7564 653a 2066      amplitude: f
-00000a40: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00000a50: 2020 2020 5065 616b 2069 6e74 656e 7369      Peak intensi
-00000a60: 7479 0a0a 2020 2020 5265 7475 726e 730a  ty..    Returns.
-00000a70: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00000a80: 6761 7573 7332 443a 206e 6461 7272 6179  gauss2D: ndarray
-00000a90: 0a20 2020 2020 2020 2020 2020 2020 3244  .             2D
-00000aa0: 2047 6175 7373 6961 6e20 7065 616b 206f   Gaussian peak o
-00000ab0: 6620 7368 6170 6520 696d 5f73 697a 650a  f shape im_size.
-00000ac0: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-00000ad0: 2d2d 2d2d 0a20 2020 2054 6869 7320 7265  ----.    This re
-00000ae0: 7475 726e 7320 6120 3244 206e 6461 7272  turns a 2D ndarr
-00000af0: 6179 2077 6974 6820 7468 6520 7468 6520  ay with the the 
-00000b00: 7369 7a65 2061 7320 696d 5f73 697a 652c  size as im_size,
-00000b10: 2077 6974 680a 2020 2020 6120 3244 2067   with.    a 2D g
-00000b20: 6175 7373 6961 6e20 6675 6e63 7469 6f6e  aussian function
-00000b30: 2063 656e 7465 7265 6420 6174 2028 7830   centered at (x0
-00000b40: 2c79 3029 2064 6566 696e 6564 2062 7920  ,y0) defined by 
-00000b50: 7468 650a 2020 2020 696e 7075 7420 7061  the.    input pa
-00000b60: 7261 6d65 7465 7273 2e0a 0a20 2020 2053  rameters...    S
-00000b70: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
-00000b80: 2d2d 2d2d 0a20 2020 2067 6175 7373 3244  ----.    gauss2D
-00000b90: 5f66 756e 6374 696f 6e0a 0a20 2020 203a  _function..    :
-00000ba0: 4175 7468 6f72 733a 0a20 2020 2044 6562  Authors:.    Deb
-00000bb0: 616e 6773 6875 204d 756b 6865 726a 6565  angshu Mukherjee
-00000bc0: 203c 6d75 6b68 6572 6a65 6564 406f 726e   <mukherjeed@orn
-00000bd0: 6c2e 676f 763e 0a20 2020 2072 0100 0000  l.gov>.    r....
-00000be0: 7202 0000 00a9 015a 0564 7479 7065 7203  r......Z.dtyper.
-00000bf0: 0000 0072 0400 0000 2908 7205 0000 00da  ...r....).r.....
-00000c00: 056d 6772 6964 5a05 7a65 726f 73da 0566  .mgridZ.zeros..f
-00000c10: 6c6f 6174 7206 0000 0072 0700 0000 da08  loatr....r......
-00000c20: 6d75 6c74 6970 6c79 7208 0000 0029 125a  multiplyr....).Z
-00000c30: 0769 6d5f 7369 7a65 720a 0000 0072 0b00  .im_sizer....r..
-00000c40: 0000 720c 0000 0072 0d00 0000 720e 0000  ..r....r....r...
-00000c50: 0072 0f00 0000 5a02 7972 5a02 7872 da07  .r....Z.yrZ.xr..
-00000c60: 6761 7573 7332 4472 1000 0000 7211 0000  gauss2Dr....r...
-00000c70: 0072 1200 0000 7213 0000 0072 1400 0000  .r....r....r....
-00000c80: 7215 0000 0072 1600 0000 7217 0000 0072  r....r....r....r
-00000c90: 1900 0000 7219 0000 0072 1a00 0000 7220  ....r....r....r 
-00000ca0: 0000 0040 0000 0073 2400 0000 0028 2201  ...@...s$....(".
-00000cb0: 1001 0801 0801 1801 18ff 0403 1801 18ff  ................
-00000cc0: 0403 1801 18ff 0403 1001 1001 1001 2201  ..............".
-00000cd0: 7220 0000 00da 0343 4f4d 6304 0000 0000  r .....COMc.....
-00000ce0: 0000 0000 0000 000e 0000 0006 0000 0043  ...............C
-00000cf0: 0000 0073 0c01 0000 7c03 6401 6b02 722e  ...s....|.d.k.r.
-00000d00: 7c00 7c02 7400 a001 7c02 a101 6b02 1900  |.|.t...|...k...
-00000d10: 7d04 7c01 7c02 7400 a001 7c02 a101 6b02  }.|.|.t...|...k.
-00000d20: 1900 7d05 6e40 7c03 6402 6b02 7266 7400  ..}.n@|.d.k.rft.
-00000d30: a002 7c02 a101 7d06 7400 a002 7c00 7c02  ..|...}.t...|.|.
-00000d40: 1400 a101 7c06 1b00 7d04 7400 a002 7c01  ....|...}.t...|.
-00000d50: 7c02 1400 a101 7c06 1b00 7d05 6e08 7403  |.....|...}.n.t.
-00000d60: 6403 8301 8201 7404 6a05 a006 7c02 a101  d.....t.j...|...
-00000d70: 7d07 7c00 7c07 6404 6b04 1900 7d08 7400  }.|.|.d.k...}.t.
-00000d80: a007 7c08 7c04 1800 a101 7d08 7c01 7c07  ..|.|.....}.|.|.
-00000d90: 6404 6b04 1900 7d09 7400 a007 7c09 7c05  d.k...}.t...|.|.
-00000da0: 1800 a101 7d09 7400 a001 7c08 a101 6405  ....}.t...|...d.
-00000db0: 6405 7400 a008 6405 a101 1400 6404 1300  d.t...d.....d...
-00000dc0: 1400 1b00 7d0a 7400 a001 7c09 a101 6405  ....}.t...|...d.
-00000dd0: 6405 7400 a008 6405 a101 1400 6404 1300  d.t...d.....d...
-00000de0: 1400 1b00 7d0b 7400 a001 7c02 a101 7d0c  ....}.t...|...}.
-00000df0: 7c04 7c05 6406 7c0a 7c0b 7c0c 6606 7d0d  |.|.d.|.|.|.f.}.
-00000e00: 7c0d 5300 2907 6143 0400 000a 2020 2020  |.S.).aC....    
-00000e10: 4765 6e65 7261 7465 2061 6e20 6170 7072  Generate an appr
-00000e20: 6f78 696d 6174 6520 4761 7573 7369 616e  oximate Gaussian
-00000e30: 2062 6173 6564 206f 6e20 696d 6167 650a   based on image.
-00000e40: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-00000e50: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00000e60: 2020 2078 783a 2020 2020 2020 2020 2020     xx:          
-00000e70: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00000e80: 2020 2020 2020 2020 2058 2070 6f73 6974           X posit
-00000e90: 696f 6e73 0a20 2020 2079 793a 2020 2020  ions.    yy:    
-00000ea0: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-00000eb0: 2020 2020 2020 2020 2020 2020 2020 2059                 Y
-00000ec0: 2050 6f73 6974 696f 6e73 0a20 2020 207a   Positions.    z
-00000ed0: 7a3a 2020 2020 2020 2020 2020 6e64 6172  z:          ndar
-00000ee0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00000ef0: 2020 2020 2049 6d61 6765 2076 616c 7565       Image value
-00000f00: 2061 7420 7468 6520 706f 7369 7469 6f6e   at the position
-00000f10: 730a 2020 2020 6365 6e74 6572 5f74 7970  s.    center_typ
-00000f20: 653a 2073 7472 0a20 2020 2020 2020 2020  e: str.         
-00000f30: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-00000f40: 6973 2060 434f 4d60 2077 6869 6368 2075  is `COM` which u
-00000f50: 7365 7320 7468 6520 6365 6e74 6572 0a20  ses the center. 
-00000f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000f70: 6f66 206d 6173 7320 6f66 2074 6865 2067  of mass of the g
-00000f80: 6976 656e 2070 6f73 6974 696f 6e73 2074  iven positions t
-00000f90: 6f20 6765 6e65 7261 7465 0a20 2020 2020  o generate.     
-00000fa0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00000fb0: 7374 6172 7469 6e67 2067 6175 7373 6961  starting gaussia
-00000fc0: 6e20 6365 6e74 6572 2e20 5468 6520 6f74  n center. The ot
-00000fd0: 6865 7220 6f70 7469 6f6e 0a20 2020 2020  her option.     
-00000fe0: 2020 2020 2020 2020 2020 2020 6973 2060              is `
-00000ff0: 6d61 7869 6d61 6020 7768 6963 6820 7461  maxima` which ta
-00001000: 6b65 7320 7468 6520 6d61 7869 6d75 6d20  kes the maximum 
-00001010: 696e 7465 6e73 6974 790a 2020 2020 2020  intensity.      
-00001020: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00001030: 2061 7320 7468 6520 7374 6172 7469 6e67   as the starting
-00001040: 2070 6f69 6e74 2e0a 0a20 2020 2052 6574   point...    Ret
-00001050: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00001060: 0a20 2020 2067 6175 7373 5f69 6e69 3a20  .    gauss_ini: 
-00001070: 7475 706c 650a 2020 2020 2020 2020 2020  tuple.          
-00001080: 2020 2020 2058 5f63 656e 7465 722c 2059       X_center, Y
-00001090: 5f63 656e 7465 722c 2041 6e67 6c65 2c20  _center, Angle, 
-000010a0: 585f 7374 642c 2059 5f73 7464 2c20 416d  X_std, Y_std, Am
-000010b0: 706c 6974 7564 650a 0a20 2020 204e 6f74  plitude..    Not
-000010c0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-000010d0: 2046 6f72 2061 2067 6976 656e 206c 6973   For a given lis
-000010e0: 7420 6f66 2078 2070 6f73 6974 696f 6e73  t of x positions
-000010f0: 2c20 7920 706f 7369 7469 6f6e 7320 616e  , y positions an
-00001100: 6420 636f 7272 6573 706f 6e64 696e 670a  d corresponding.
-00001110: 2020 2020 696e 7465 6e73 6974 7920 7661      intensity va
-00001120: 6c75 6573 2c20 7468 6973 2063 6f64 6520  lues, this code 
-00001130: 7265 7475 726e 7320 6120 6669 7273 7420  returns a first 
-00001140: 7061 7373 2061 7070 726f 7869 6d61 7469  pass approximati
-00001150: 6f6e 0a20 2020 206f 6620 6120 4761 7573  on.    of a Gaus
-00001160: 7369 616e 2066 756e 6374 696f 6e2e 2054  sian function. T
-00001170: 6865 2063 656e 7465 7220 6f66 2074 6865  he center of the
-00001180: 2067 6175 7373 6961 6e20 3244 2066 756e   gaussian 2D fun
-00001190: 6374 696f 6e0a 2020 2020 6361 6e20 6569  ction.    can ei
-000011a0: 7468 6572 2062 6520 7468 6520 6365 6e74  ther be the cent
-000011b0: 6572 206f 6620 6d61 7373 206f 7220 7468  er of mass or th
-000011c0: 6520 696e 7465 6e73 6974 7920 6d61 7869  e intensity maxi
-000011d0: 6d61 2c20 616e 6420 6973 0a20 2020 2075  ma, and is.    u
-000011e0: 7365 7220 6465 6669 6e65 642e 2054 6865  ser defined. The
-000011f0: 2061 6e67 6c65 2069 7320 616c 7761 7973   angle is always
-00001200: 2067 6976 656e 2061 7320 302e 0a0a 2020   given as 0...  
-00001210: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
-00001220: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
-00001230: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
-00001240: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 da06  ornl.gov>.    ..
-00001250: 6d61 7869 6d61 7221 0000 00fa 1349 6e76  maximar!.....Inv
-00001260: 616c 6964 2043 656e 7465 7220 5479 7065  alid Center Type
-00001270: e700 0000 0000 00e0 3f72 0300 0000 7201  ........?r....r.
-00001280: 0000 0029 0972 0500 0000 da04 616d 6178  ...).r......amax
-00001290: da03 7375 6dda 0a56 616c 7565 4572 726f  ..sum..ValueErro
-000012a0: 72da 0273 74da 0475 7469 6cda 1069 6d61  r..st..util..ima
-000012b0: 6765 5f6e 6f72 6d61 6c69 7a65 72da 0361  ge_normalizer..a
-000012c0: 6273 da03 6c6f 6729 0eda 0278 78da 0279  bs..log)...xx..y
-000012d0: 79da 027a 7ada 0b63 656e 7465 725f 7479  y..zz..center_ty
-000012e0: 7065 da05 785f 636f 6d5a 0579 5f63 6f6d  pe..x_comZ.y_com
-000012f0: da05 746f 7461 6c5a 077a 7a5f 6e6f 726d  ..totalZ.zz_norm
-00001300: da06 785f 6677 686d 5a06 795f 6677 686d  ..x_fwhmZ.y_fwhm
-00001310: 720d 0000 0072 0e00 0000 da06 6865 6967  r....r......heig
-00001320: 6874 5a09 6761 7573 735f 696e 6972 1900  htZ.gauss_inir..
-00001330: 0000 7219 0000 0072 1a00 0000 da12 696e  ..r....r......in
-00001340: 6974 6961 6c69 7a65 5f67 6175 7373 3244  itialize_gauss2D
-00001350: 7c00 0000 7324 0000 0000 2308 0112 0114  |...s$....#.....
-00001360: 0108 010a 0112 0114 0208 020c 010c 010e  ................
-00001370: 010c 010e 0220 0120 010a 0110 0172 3500  ..... . .....r5.
-00001380: 0000 da08 6369 7263 756c 6172 6306 0000  ....circularc...
-00001390: 0000 0000 0000 0000 0017 0000 0009 0000  ................
-000013a0: 0043 0000 0073 e201 0000 7400 a001 7c00  .C...s....t...|.
-000013b0: a101 5c02 7d06 7d07 7400 6a02 6401 7c06  ..\.}.}.t.j.d.|.
-000013c0: 8502 6401 7c07 8502 6602 1900 5c02 7d08  ..d.|...f...\.}.
-000013d0: 7d09 7c04 6402 6b02 7252 7c08 7c02 1800  }.|.d.k.rR|.|...
-000013e0: 6403 1300 7c09 7c01 1800 6403 1300 1700  d...|.|...d.....
-000013f0: 6404 1300 7c03 6b00 7d0a 6e3a 7c04 6405  d...|.k.}.n:|.d.
-00001400: 6b02 7284 7400 a003 7400 a004 7c08 7c02  k.r.t...t...|.|.
-00001410: 1800 a101 7c03 6b00 7400 a004 7c09 7c01  ....|.k.t...|.|.
-00001420: 1800 a101 7c03 6b00 a102 7d0a 6e08 7405  ....|.k...}.n.t.
-00001430: 6406 8301 8201 7400 6a06 7c09 7c0a 1900  d.....t.j.|.|...
-00001440: 7400 6a07 6407 8d02 7d0b 7400 6a06 7c08  t.j.d...}.t.j.|.
-00001450: 7c0a 1900 7400 6a07 6407 8d02 7d0c 7400  |...t.j.d...}.t.
-00001460: 6a06 7c00 7c0a 1900 7400 6a07 6407 8d02  j.|.|...t.j.d...
-00001470: 7d0d 7400 a008 7c0d a101 7d0e 7400 a009  }.t...|...}.t...
-00001480: 7c0d a101 7d0f 7c05 6408 6b02 9001 7206  |...}.|.d.k...r.
-00001490: 7c0d 7c0f 1800 7c0e 7c0f 1800 1b00 7d10  |.|...|.|.....}.
-000014a0: 740a 7c0b 7c0c 7c10 6409 8304 7d11 6e1e  t.|.|.|.d...}.n.
-000014b0: 7c0d 7c0e 1800 7c0f 7c0e 1800 1b00 7d10  |.|...|.|.....}.
-000014c0: 740a 7c0b 7c0c 7c10 7c05 8304 7d11 7c11  t.|.|.|.|...}.|.
-000014d0: 6401 1900 7c03 1800 7c11 640a 1900 7c03  d...|...|.d...|.
-000014e0: 1800 640b 6401 6401 640c 7c11 640d 1900  ..d.d.d.d.|.d...
-000014f0: 1400 6606 7d12 7c11 6401 1900 7c03 1700  ..f.}.|.d...|...
-00001500: 7c11 640a 1900 7c03 1700 640e 640f 7c03  |.d...|...d.d.|.
-00001510: 1400 640f 7c03 1400 640f 7c11 640d 1900  ..d.|...d.|.d...
-00001520: 1400 6606 7d13 7c0b 7c0c 6602 7d14 740b  ..f.}.|.|.f.}.t.
-00001530: 6a0c 740d 7c14 7c10 7c11 7c12 7c13 6602  j.t.|.|.|.|.|.f.
-00001540: 6410 6410 6411 8d07 5c02 7d15 7d16 7c05  d.d.d...\.}.}.|.
-00001550: 6408 6b02 9001 72c6 7c15 6412 1900 7c0e  d.k...r.|.d...|.
-00001560: 7c0f 1800 1400 7c0f 1700 7c15 6412 3c00  |.....|...|.d.<.
-00001570: 7c15 6412 1900 7c0f 7c0e 1800 1400 7c0e  |.d...|.|.....|.
-00001580: 1700 7c15 6412 3c00 7c15 5300 2913 61f3  ..|.d.<.|.S.).a.
-00001590: 0500 000a 2020 2020 4669 7420 6120 3244  ....    Fit a 2D
-000015a0: 2067 6175 7373 6961 6e20 746f 2061 206d   gaussian to a m
-000015b0: 6173 6b65 6420 696d 6167 6520 6261 7365  asked image base
-000015c0: 6420 6f6e 0a20 2020 2074 6865 206c 6f63  d on.    the loc
-000015d0: 6174 696f 6e20 6f66 2074 6865 206d 6173  ation of the mas
-000015e0: 6b2c 2073 697a 6520 6f66 2074 6865 206d  k, size of the m
-000015f0: 6173 6b20 616e 640a 2020 2020 7468 6520  ask and.    the 
-00001600: 7479 7065 206f 6620 7468 6520 6d61 736b  type of the mask
-00001610: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00001620: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00001630: 2020 2020 696d 6167 655f 6461 7461 3a20      image_data: 
-00001640: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00001650: 2020 2020 2020 2020 2020 5468 6520 696d            The im
-00001660: 6167 6520 7468 6174 2077 696c 6c20 6265  age that will be
-00001670: 2066 6974 7465 6420 7769 7468 2074 6865   fitted with the
-00001680: 2047 6175 7373 6961 6e0a 2020 2020 6d61   Gaussian.    ma
-00001690: 736b 5f78 3a20 2020 2020 2066 6c6f 6174  sk_x:      float
-000016a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000016b0: 2020 7820 6365 6e74 6572 206f 6620 7468    x center of th
-000016c0: 6520 6d61 736b 0a20 2020 206d 6173 6b5f  e mask.    mask_
-000016d0: 793a 2020 2020 2020 666c 6f61 740a 2020  y:      float.  
-000016e0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-000016f0: 2063 656e 7465 7220 6f66 2074 6865 206d   center of the m
-00001700: 6173 6b0a 2020 2020 6d61 736b 5f72 6164  ask.    mask_rad
-00001710: 6975 733a 2066 6c6f 6174 0a20 2020 2020  ius: float.     
-00001720: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00001730: 7369 7a65 206f 6620 7468 6520 6d61 736b  size of the mask
-00001740: 2e20 466f 7220 6120 6369 7263 756c 6174  . For a circulat
-00001750: 206d 6173 6b20 7468 6973 0a20 2020 2020   mask this.     
-00001760: 2020 2020 2020 2020 2020 2020 7265 6665              refe
-00001770: 7273 2074 6f20 7468 6520 6d61 736b 2072  rs to the mask r
-00001780: 6164 6975 732c 2077 6869 6c65 2066 6f72  adius, while for
-00001790: 2061 2073 7175 6172 6520 6d61 736b 0a20   a square mask. 
-000017a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000017b0: 7468 6973 2072 6566 6572 7320 746f 2068  this refers to h
-000017c0: 616c 6620 7468 6520 7369 6465 206f 6620  alf the side of 
-000017d0: 7468 6520 7371 7561 7265 0a20 2020 206d  the square.    m
-000017e0: 6173 6b5f 7479 7065 3a20 2020 7374 720a  ask_type:   str.
-000017f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001800: 2044 6566 6175 6c74 2069 7320 6063 6972   Default is `cir
-00001810: 6375 6c61 7260 2c20 7768 696c 6520 7468  cular`, while th
-00001820: 6520 6f74 6865 7220 6f70 7469 6f6e 2069  e other option i
-00001830: 7320 6073 7175 6172 6560 0a20 2020 2063  s `square`.    c
-00001840: 656e 7465 725f 7479 7065 3a20 7374 720a  enter_type: str.
-00001850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001860: 2043 656e 7465 7220 6c6f 6361 7469 6f6e   Center location
-00001870: 2066 6f72 2074 6865 2066 6972 7374 2070   for the first p
-00001880: 6173 7320 6f66 2074 6865 2047 6175 7373  ass of the Gauss
-00001890: 6961 6e2e 0a20 2020 2020 2020 2020 2020  ian..           
-000018a0: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
-000018b0: 2060 434f 4d60 2c20 7768 696c 6520 7468   `COM`, while th
-000018c0: 6520 6f74 6865 7220 6f70 7469 6f6e 7320  e other options 
-000018d0: 6172 6520 606d 696e 696d 6160 0a20 2020  are `minima`.   
-000018e0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-000018f0: 2060 6d61 7869 6d61 602e 0a0a 2020 2020   `maxima`...    
-00001900: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-00001910: 2d2d 2d0a 2020 2020 706f 7074 3a20 7475  ---.    popt: tu
-00001920: 706c 650a 2020 2020 2020 2020 2020 5265  ple.          Re
-00001930: 6669 6e65 6420 5820 706f 7369 7469 6f6e  fined X position
-00001940: 2c20 5265 6669 6e65 6420 5920 506f 7369  , Refined Y Posi
-00001950: 7469 6f6e 2c20 526f 7461 7469 6f6e 2061  tion, Rotation a
-00001960: 6e67 6c65 206f 660a 2020 2020 2020 2020  ngle of.        
-00001970: 2020 3244 2047 6175 7373 6961 6e2c 2053    2D Gaussian, S
-00001980: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
-00001990: 6e28 7329 2c20 416d 706c 6974 7564 650a  n(s), Amplitude.
-000019a0: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-000019b0: 2d2d 2d2d 0a20 2020 2054 6869 7320 636f  ----.    This co
-000019c0: 6465 2075 7365 7320 7468 6520 6073 6369  de uses the `sci
-000019d0: 7079 2e6f 7074 696d 697a 652e 6375 7276  py.optimize.curv
-000019e0: 655f 6669 7460 206d 6f64 756c 6520 746f  e_fit` module to
-000019f0: 2066 6974 2061 2032 440a 2020 2020 4761   fit a 2D.    Ga
-00001a00: 7573 7369 616e 2070 6561 6b20 746f 206d  ussian peak to m
-00001a10: 6173 6b65 6420 6461 7461 2e20 606d 6173  asked data. `mas
-00001a20: 6b5f 7860 2061 6e64 2060 6d61 736b 5f79  k_x` and `mask_y
-00001a30: 6020 7265 6665 7220 746f 2074 6865 0a20  ` refer to the. 
-00001a40: 2020 2069 6e69 7469 616c 2073 7461 7274     initial start
-00001a50: 696e 6720 706f 7369 7469 6f6e 732e 2041  ing positions. A
-00001a60: 6c73 6f2c 2074 6869 7320 6361 6e20 7461  lso, this can ta
-00001a70: 6b65 2069 6e20 606d 696e 696d 6160 2061  ke in `minima` a
-00001a80: 7320 610a 2020 2020 7374 7269 6e67 2066  s a.    string f
-00001a90: 6f72 2069 6e69 7469 616c 697a 696e 6720  or initializing 
-00001aa0: 4761 7573 7369 616e 2070 6561 6b73 2c20  Gaussian peaks, 
-00001ab0: 7768 6963 6820 616c 6c6f 7773 2066 6f72  which allows for
-00001ac0: 2061 746f 6d20 636f 6c75 6d6e 0a20 2020   atom column.   
-00001ad0: 206d 6170 7069 6e67 2069 6e20 696e 7665   mapping in inve
-00001ae0: 7274 6564 2063 6f6e 7472 6173 7420 696d  rted contrast im
-00001af0: 6167 6573 2074 6f6f 2e0a 0a20 2020 2053  ages too...    S
-00001b00: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
-00001b10: 2d2d 2d2d 0a20 2020 2067 6175 7373 6961  ----.    gaussia
-00001b20: 6e5f 3244 5f66 756e 6374 696f 6e0a 2020  n_2D_function.  
-00001b30: 2020 696e 6974 6961 6c69 7a65 5f67 6175    initialize_gau
-00001b40: 7373 3244 0a0a 2020 2020 3a41 7574 686f  ss2D..    :Autho
-00001b50: 7273 3a0a 2020 2020 4465 6261 6e67 7368  rs:.    Debangsh
-00001b60: 7520 4d75 6b68 6572 6a65 6520 3c6d 756b  u Mukherjee <muk
-00001b70: 6865 726a 6565 6440 6f72 6e6c 2e67 6f76  herjeed@ornl.gov
-00001b80: 3e0a 2020 2020 7201 0000 0072 3600 0000  >.    r....r6...
-00001b90: 7203 0000 0072 2400 0000 5a06 7371 7561  r....r$...Z.squa
-00001ba0: 7265 7a11 556e 6b6e 6f77 6e20 4d61 736b  rez.Unknown Mask
-00001bb0: 2054 7970 6572 1c00 0000 da06 6d69 6e69   Typer......mini
-00001bc0: 6d61 7222 0000 0072 0200 0000 694c ffff  mar"...r....iL..
-00001bd0: ffe7 0000 0000 0000 04c0 e905 0000 00e9  ................
-00001be0: b400 0000 e700 0000 0000 0004 40e7 7b14  ............@.{.
-00001bf0: ae47 e17a 843f a903 da06 626f 756e 6473  .G.z.?....bounds
-00001c00: 5a04 6674 6f6c 5a04 7874 6f6c 7204 0000  Z.ftolZ.xtolr...
-00001c10: 0029 0e72 0500 0000 da05 7368 6170 6572  .).r......shaper
-00001c20: 1d00 0000 5a0b 6c6f 6769 6361 6c5f 616e  ....Z.logical_an
-00001c30: 6472 2b00 0000 7227 0000 00da 0761 7361  dr+...r'.....asa
-00001c40: 7272 6179 5a07 666c 6f61 7436 34da 0461  rrayZ.float64..a
-00001c50: 6d69 6e72 2500 0000 7235 0000 00da 0373  minr%...r5.....s
-00001c60: 706f da09 6375 7276 655f 6669 7472 1b00  po..curve_fitr..
-00001c70: 0000 2917 5a0a 696d 6167 655f 6461 7461  ..).Z.image_data
-00001c80: 5a06 6d61 736b 5f78 5a06 6d61 736b 5f79  Z.mask_xZ.mask_y
-00001c90: 5a0b 6d61 736b 5f72 6164 6975 735a 096d  Z.mask_radiusZ.m
-00001ca0: 6173 6b5f 7479 7065 7230 0000 00da 0170  ask_typer0.....p
-00001cb0: da01 715a 0279 56da 0278 56da 0373 7562  ..qZ.yV..xV..sub
-00001cc0: da05 785f 706f 735a 0579 5f70 6f73 5a0c  ..x_posZ.y_posZ.
-00001cd0: 6d61 736b 6564 5f69 6d61 6765 da06 6d69  masked_image..mi
-00001ce0: 5f6d 696e da06 6d69 5f6d 6178 5a0a 6361  _min..mi_maxZ.ca
-00001cf0: 6c63 5f69 6d61 6765 da0d 696e 6974 6961  lc_image..initia
-00001d00: 6c5f 6775 6573 73da 0b6c 6f77 6572 5f62  l_guess..lower_b
-00001d10: 6f75 6e64 da0b 7570 7065 725f 626f 756e  ound..upper_boun
-00001d20: 6472 0900 0000 da04 706f 7074 da01 5f72  dr......popt.._r
-00001d30: 1900 0000 7219 0000 0072 1a00 0000 da13  ....r....r......
-00001d40: 6669 745f 6761 7573 7369 616e 3244 5f6d  fit_gaussian2D_m
-00001d50: 6173 6bb6 0000 0073 5e00 0000 0031 0e01  ask....s^....1..
-00001d60: 1a01 0801 2201 0801 0401 20ff 0604 0801  ...."..... .....
-00001d70: 1401 1401 1401 0a01 0a01 0a01 1001 1002  ................
-00001d80: 1001 0e02 0a01 0a01 0201 0201 0201 0afa  ................
-00001d90: 0409 0a01 0a01 0201 0601 0601 0afa 0408  ................
-00001da0: 0801 0401 0201 0201 0201 0201 0601 0201  ................
-00001db0: 02f9 0a09 0a01 1801 1801 7250 0000 0063  ..........rP...c
-00001dc0: 0400 0000 0000 0000 0000 0000 0600 0000  ................
-00001dd0: 0500 0000 4300 0000 7332 0000 007c 007c  ....C...s2...|.|
-00001de0: 0118 007d 007c 0064 0113 0064 017c 0264  ...}.|.d...d.|.d
-00001df0: 0113 0014 001b 007d 047c 0374 00a0 0164  .......}.|.t...d
-00001e00: 027c 0414 00a1 0114 007d 057c 0553 0029  .|.......}.|.S.)
-00001e10: 0361 c302 0000 0a20 2020 2054 6865 2075  .a.....    The u
-00001e20: 6e64 6572 6c79 696e 6720 3144 2047 6175  nderlying 1D Gau
-00001e30: 7373 6961 6e20 6675 6e63 7469 6f6e 0a0a  ssian function..
-00001e40: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00001e50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00001e60: 2020 783a 2020 2020 2020 2020 206e 6461    x:         nda
-00001e70: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00001e80: 2020 2020 7820 706f 7369 7469 6f6e 730a      x positions.
-00001e90: 2020 2020 7830 3a20 2020 2020 2020 2066      x0:        f
-00001ea0: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00001eb0: 2020 2020 7820 6365 6e74 6572 206f 6620      x center of 
-00001ec0: 4761 7573 7369 616e 2070 6561 6b0a 2020  Gaussian peak.  
-00001ed0: 2020 7369 676d 615f 783a 2020 2066 6c6f    sigma_x:   flo
-00001ee0: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-00001ef0: 2020 5374 616e 6461 7264 2064 6576 6961    Standard devia
-00001f00: 7469 6f6e 206f 6620 7468 6520 3244 2047  tion of the 2D G
-00001f10: 6175 7373 6961 6e20 616c 6f6e 6720 780a  aussian along x.
-00001f20: 2020 2020 616d 706c 6974 7564 653a 2066      amplitude: f
-00001f30: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00001f40: 2020 2020 5065 616b 2069 6e74 656e 7369      Peak intensi
-00001f50: 7479 0a0a 2020 2020 5265 7475 726e 730a  ty..    Returns.
-00001f60: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00001f70: 6761 7573 7376 616c 733a 206e 6461 7272  gaussvals: ndarr
-00001f80: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-00001f90: 2020 4120 4761 7573 6961 6e20 7065 616b    A Gausian peak
-00001fa0: 2063 656e 7465 7265 6420 6174 2078 3020   centered at x0 
-00001fb0: 6261 7365 6420 6f6e 2074 6865 0a20 2020  based on the.   
-00001fc0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00001fd0: 6d65 7465 7273 2067 6976 656e 0a0a 2020  meters given..  
-00001fe0: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00001ff0: 2d0a 2020 2020 5468 6520 4761 7573 7369  -.    The Gaussi
-00002000: 616e 2031 4420 6675 6e63 7469 6f6e 2069  an 1D function i
-00002010: 7320 6361 6c63 756c 6174 6564 2061 7420  s calculated at 
-00002020: 6576 6572 7920 7820 706f 7369 7469 6f6e  every x position
-00002030: 2066 6f72 0a20 2020 2061 206c 6973 7420   for.    a list 
-00002040: 6f66 2070 6f73 6974 696f 6e20 7661 6c75  of position valu
-00002050: 6573 2062 6173 6564 206f 6e20 7468 6520  es based on the 
-00002060: 7061 7261 6d65 7465 7273 2067 6976 656e  parameters given
-00002070: 2e0a 0a20 2020 2053 6565 2061 6c73 6f0a  ...    See also.
-00002080: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00002090: 2067 6175 7373 6961 6e5f 3244 5f66 756e   gaussian_2D_fun
-000020a0: 6374 696f 6e0a 2020 2020 696e 6974 6961  ction.    initia
-000020b0: 6c69 7a65 5f67 6175 7373 3144 0a20 2020  lize_gauss1D.   
-000020c0: 2066 6974 5f67 6175 7373 6961 6e31 445f   fit_gaussian1D_
-000020d0: 6d61 736b 0a20 2020 2072 0300 0000 7204  mask.    r....r.
-000020e0: 0000 0029 0272 0500 0000 7208 0000 0029  ...).r....r....)
-000020f0: 0672 1000 0000 720a 0000 0072 0d00 0000  .r....r....r....
-00002100: 720f 0000 005a 0474 6572 6d72 1800 0000  r....Z.termr....
-00002110: 7219 0000 0072 1900 0000 721a 0000 00da  r....r....r.....
-00002120: 1467 6175 7373 6961 6e5f 3144 5f66 756e  .gaussian_1D_fun
-00002130: 6374 696f 6e1c 0100 0073 0800 0000 0020  ction....s..... 
-00002140: 0801 1401 1201 7251 0000 0063 0300 0000  ......rQ...c....
-00002150: 0000 0000 0000 0000 0900 0000 0600 0000  ................
-00002160: 4300 0000 73b0 0000 007c 0264 016b 0272  C...s....|.d.k.r
-00002170: 247c 007c 0174 00a0 017c 01a1 016b 0219  $|.|.t...|...k..
-00002180: 007d 037c 0364 0219 007d 036e 327c 0264  .}.|.d...}.n2|.d
-00002190: 036b 0272 4e74 00a0 027c 01a1 017d 0474  .k.rNt...|...}.t
-000021a0: 00a0 0274 00a0 037c 007c 01a1 02a1 017c  ...t...|.|.....|
-000021b0: 041b 007d 036e 0874 0464 0483 0182 0174  ...}.n.t.d.....t
-000021c0: 056a 06a0 077c 01a1 017d 057c 007c 0564  .j...|...}.|.|.d
-000021d0: 056b 0419 007d 0674 00a0 087c 067c 0318  .k...}.t...|.|..
-000021e0: 00a1 017d 0674 00a0 017c 06a1 0164 0664  ...}.t...|...d.d
-000021f0: 0674 00a0 0964 06a1 0114 0064 0513 0014  .t...d.....d....
-00002200: 001b 007d 0774 00a0 017c 01a1 017d 087c  ...}.t...|...}.|
-00002210: 037c 077c 0866 0353 0029 0761 8103 0000  .|.|.f.S.).a....
-00002220: 0a20 2020 2047 656e 6572 6174 6520 616e  .    Generate an
-00002230: 2061 7070 726f 7869 6d61 7465 2047 6175   approximate Gau
-00002240: 7373 6961 6e20 6261 7365 6420 6f6e 2073  ssian based on s
-00002250: 6967 6e61 6c0a 0a20 2020 2050 6172 616d  ignal..    Param
-00002260: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00002270: 2d2d 2d2d 0a20 2020 2078 783a 2020 2020  ----.    xx:    
-00002280: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-00002290: 2020 2020 2020 2020 2020 2020 2020 2058                 X
-000022a0: 2070 6f73 6974 696f 6e73 0a20 2020 2079   positions.    y
-000022b0: 793a 2020 2020 2020 2020 2020 6e64 6172  y:          ndar
-000022c0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-000022d0: 2020 2020 2053 6967 6e61 6c20 7661 6c75       Signal valu
-000022e0: 6520 6174 2074 6865 2070 6f73 6974 696f  e at the positio
-000022f0: 6e73 0a20 2020 2063 656e 7465 725f 7479  ns.    center_ty
-00002300: 7065 3a20 7374 720a 2020 2020 2020 2020  pe: str.        
-00002310: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00002320: 2069 7320 6043 4f4d 6020 7768 6963 6820   is `COM` which 
-00002330: 7573 6573 2074 6865 2063 656e 7465 720a  uses the center.
-00002340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002350: 206f 6620 6d61 7373 206f 6620 7468 6520   of mass of the 
-00002360: 6769 7665 6e20 706f 7369 7469 6f6e 7320  given positions 
-00002370: 746f 2067 656e 6572 6174 650a 2020 2020  to generate.    
-00002380: 2020 2020 2020 2020 2020 2020 2074 6865               the
-00002390: 2073 7461 7274 696e 6720 6761 7573 7369   starting gaussi
-000023a0: 616e 2063 656e 7465 722e 2054 6865 206f  an center. The o
-000023b0: 7468 6572 206f 7074 696f 6e0a 2020 2020  ther option.    
-000023c0: 2020 2020 2020 2020 2020 2020 2069 7320               is 
-000023d0: 606d 6178 696d 6160 2077 6869 6368 2074  `maxima` which t
-000023e0: 616b 6573 2074 6865 206d 6178 696d 756d  akes the maximum
-000023f0: 2069 6e74 656e 7369 7479 0a20 2020 2020   intensity.     
-00002400: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00002410: 6520 6173 2074 6865 2073 7461 7274 696e  e as the startin
-00002420: 6720 706f 696e 742e 0a0a 2020 2020 5265  g point...    Re
-00002430: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00002440: 2d0a 2020 2020 6761 7573 735f 696e 693a  -.    gauss_ini:
-00002450: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
-00002460: 2020 2020 2020 585f 6365 6e74 6572 2c20        X_center, 
-00002470: 585f 7374 642c 2041 6d70 6c69 7475 6465  X_std, Amplitude
-00002480: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
-00002490: 2d2d 2d2d 2d0a 2020 2020 466f 7220 6120  -----.    For a 
-000024a0: 6769 7665 6e20 6c69 7374 206f 6620 7820  given list of x 
-000024b0: 706f 7369 7469 6f6e 7320 616e 6420 636f  positions and co
-000024c0: 7272 6573 706f 6e64 696e 6720 7369 676e  rresponding sign
-000024d0: 616c 0a20 2020 2076 616c 7565 732c 2074  al.    values, t
-000024e0: 6869 7320 636f 6465 2072 6574 7572 6e73  his code returns
-000024f0: 2061 2066 6972 7374 2070 6173 7320 6170   a first pass ap
-00002500: 7072 6f78 696d 6174 696f 6e20 6f66 2061  proximation of a
-00002510: 0a20 2020 2031 4420 4761 7573 7369 616e  .    1D Gaussian
-00002520: 2066 756e 6374 696f 6e2e 2054 6865 2063   function. The c
-00002530: 656e 7465 7220 6f66 2074 6865 2066 756e  enter of the fun
-00002540: 6374 696f 6e20 6361 6e20 6569 7468 6572  ction can either
-00002550: 0a20 2020 2062 6520 7468 6520 6365 6e74  .    be the cent
-00002560: 6572 206f 6620 6d61 7373 206f 7220 7468  er of mass or th
-00002570: 6520 696e 7465 6e73 6974 7920 6d61 7869  e intensity maxi
-00002580: 6d61 2c20 616e 6420 6973 2075 7365 720a  ma, and is user.
-00002590: 2020 2020 6465 6669 6e65 642e 0a20 2020      defined..   
-000025a0: 2072 2200 0000 7201 0000 0072 2100 0000   r"...r....r!...
-000025b0: 7223 0000 0072 2400 0000 7203 0000 0029  r#...r$...r....)
-000025c0: 0a72 0500 0000 7225 0000 0072 2600 0000  .r....r%...r&...
-000025d0: 721f 0000 0072 2700 0000 7228 0000 0072  r....r'...r(...r
-000025e0: 2900 0000 722a 0000 0072 2b00 0000 722c  )...r*...r+...r,
-000025f0: 0000 0029 0972 2d00 0000 722e 0000 0072  ...).r-...r....r
-00002600: 3000 0000 7231 0000 0072 3200 0000 5a07  0...r1...r2...Z.
-00002610: 7979 5f6e 6f72 6d72 3300 0000 720d 0000  yy_normr3...r...
-00002620: 0072 3400 0000 7219 0000 0072 1900 0000  .r4...r....r....
-00002630: 721a 0000 00da 1269 6e69 7469 616c 697a  r......initializ
-00002640: 655f 6761 7573 7331 4442 0100 0073 1a00  e_gauss1DB...s..
-00002650: 0000 001e 0801 1201 0a01 0801 0a01 1802  ................
-00002660: 0801 0c01 0c01 0e01 2001 0a01 7252 0000  ........ ...rR..
-00002670: 0063 0400 0000 0000 0000 0000 0000 1000  .c..............
-00002680: 0000 0900 0000 4300 0000 7336 0100 0074  ......C...s6...t
-00002690: 00a0 0174 00a0 027c 00a1 01a1 017d 0474  ...t...|.....}.t
-000026a0: 00a0 037c 047c 0118 00a1 017c 026b 007d  ...|.|.....|.k.}
-000026b0: 0574 006a 047c 047c 0519 0074 006a 0564  .t.j.|.|...t.j.d
-000026c0: 018d 027d 0674 006a 047c 007c 0519 0074  ...}.t.j.|.|...t
-000026d0: 006a 0564 018d 027d 0774 00a0 067c 07a1  .j.d...}.t...|..
-000026e0: 017d 0874 00a0 077c 07a1 017d 097c 0364  .}.t...|...}.|.d
-000026f0: 026b 0272 847c 077c 0918 007c 087c 0918  .k.r.|.|...|.|..
-00002700: 001b 007d 0a74 087c 067c 0a64 0383 037d  ...}.t.|.|.d...}
-00002710: 0b6e 1c7c 077c 0818 007c 097c 0818 001b  .n.|.|...|.|....
-00002720: 007d 0a74 087c 067c 0a7c 0383 037d 0b7c  .}.t.|.|.|...}.|
-00002730: 0b64 0419 007c 0218 0064 0464 057c 0b64  .d...|...d.d.|.d
-00002740: 0619 0014 0066 037d 0c7c 0b64 0419 007c  .....f.}.|.d...|
-00002750: 0217 0064 077c 0214 0064 077c 0b64 0619  ...d.|...d.|.d..
-00002760: 0014 0066 037d 0d74 096a 0a74 0b7c 067c  ...f.}.t.j.t.|.|
-00002770: 0a7c 0b7c 0c7c 0d66 0264 0864 0864 098d  .|.|.|.f.d.d.d..
-00002780: 075c 027d 0e7d 0f7c 0364 026b 0290 0172  .\.}.}.|.d.k...r
-00002790: 1a7c 0e64 0a19 007c 087c 0918 0014 007c  .|.d...|.|.....|
-000027a0: 0917 007c 0e64 0a3c 007c 0e64 0a19 007c  ...|.d.<.|.d...|
-000027b0: 097c 0818 0014 007c 0817 007c 0e64 0a3c  .|.....|...|.d.<
-000027c0: 007c 0e53 0029 0b61 4204 0000 0a20 2020  .|.S.).aB....   
-000027d0: 2046 6974 2061 2032 4420 6761 7573 7369   Fit a 2D gaussi
-000027e0: 616e 2074 6f20 6120 6d61 736b 6564 2069  an to a masked i
-000027f0: 6d61 6765 2062 6173 6564 206f 6e0a 2020  mage based on.  
-00002800: 2020 7468 6520 6c6f 6361 7469 6f6e 206f    the location o
-00002810: 6620 7468 6520 6d61 736b 2c20 7369 7a65  f the mask, size
-00002820: 206f 6620 7468 6520 6d61 736b 2061 6e64   of the mask and
-00002830: 0a20 2020 2074 6865 2074 7970 6520 6f66  .    the type of
-00002840: 2074 6865 206d 6173 6b0a 0a20 2020 2050   the mask..    P
-00002850: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00002860: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073 6967  --------.    sig
-00002870: 6e61 6c3a 2020 2020 2020 6e64 6172 7261  nal:      ndarra
-00002880: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00002890: 2020 2054 6865 2031 4420 7369 676e 616c     The 1D signal
-000028a0: 2074 6861 7420 7769 6c6c 2062 6520 6669   that will be fi
-000028b0: 7474 6564 2077 6974 6820 7468 6520 4761  tted with the Ga
-000028c0: 7573 7369 616e 0a20 2020 2070 6f73 6974  ussian.    posit
-000028d0: 696f 6e3a 2020 2020 666c 6f61 740a 2020  ion:    float.  
-000028e0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-000028f0: 2063 656e 7465 7220 6f66 2074 6865 206d   center of the m
-00002900: 6173 6b0a 2020 2020 6d61 736b 5f77 6964  ask.    mask_wid
-00002910: 7468 3a20 2066 6c6f 6174 0a20 2020 2020  th:  float.     
-00002920: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00002930: 7369 7a65 206f 6620 7468 6520 6d61 736b  size of the mask
-00002940: 2e0a 2020 2020 6365 6e74 6572 5f74 7970  ..    center_typ
-00002950: 653a 2073 7472 0a20 2020 2020 2020 2020  e: str.         
-00002960: 2020 2020 2020 2020 4365 6e74 6572 206c          Center l
-00002970: 6f63 6174 696f 6e20 666f 7220 7468 6520  ocation for the 
-00002980: 6669 7273 7420 7061 7373 206f 6620 7468  first pass of th
-00002990: 6520 4761 7573 7369 616e 2e0a 2020 2020  e Gaussian..    
-000029a0: 2020 2020 2020 2020 2020 2020 2044 6566               Def
-000029b0: 6175 6c74 2069 7320 6043 4f4d 602c 2077  ault is `COM`, w
-000029c0: 6869 6c65 2074 6865 206f 7468 6572 206f  hile the other o
-000029d0: 7074 696f 6e73 2061 7265 2060 6d69 6e69  ptions are `mini
-000029e0: 6d61 600a 2020 2020 2020 2020 2020 2020  ma`.            
-000029f0: 2020 2020 206f 7220 606d 6178 696d 6160       or `maxima`
-00002a00: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-00002a10: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2070     -------.    p
-00002a20: 6f70 743a 2074 7570 6c65 0a20 2020 2020  opt: tuple.     
-00002a30: 2020 2020 2052 6566 696e 6564 2058 2070       Refined X p
-00002a40: 6f73 6974 696f 6e2c 2053 7461 6e64 6172  osition, Standar
-00002a50: 6420 6465 7669 6174 696f 6e2c 2041 6d70  d deviation, Amp
-00002a60: 6c69 7475 6465 0a0a 2020 2020 4e6f 7465  litude..    Note
-00002a70: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
-00002a80: 5468 6973 2063 6f64 6520 7573 6573 2074  This code uses t
-00002a90: 6865 2060 7363 6970 792e 6f70 7469 6d69  he `scipy.optimi
-00002aa0: 7a65 2e63 7572 7665 5f66 6974 6020 6d6f  ze.curve_fit` mo
-00002ab0: 6475 6c65 2074 6f20 6669 7420 6120 3144  dule to fit a 1D
-00002ac0: 0a20 2020 2047 6175 7373 6961 6e20 7065  .    Gaussian pe
-00002ad0: 616b 2074 6f20 6d61 736b 6564 2064 6174  ak to masked dat
-00002ae0: 612e 2060 6d61 736b 5f78 6020 7265 6665  a. `mask_x` refe
-00002af0: 7273 2074 6f20 7468 6520 696e 6974 6961  rs to the initia
-00002b00: 6c0a 2020 2020 7374 6172 7469 6e67 2070  l.    starting p
-00002b10: 6f73 6974 696f 6e2e 2041 6c73 6f2c 2074  osition. Also, t
-00002b20: 6869 7320 6361 6e20 7461 6b65 2069 6e20  his can take in 
-00002b30: 606d 696e 696d 6160 2061 7320 6120 7374  `minima` as a st
-00002b40: 7269 6e67 0a20 2020 2066 6f72 2069 6e69  ring.    for ini
-00002b50: 7469 616c 697a 696e 6720 4761 7573 7369  tializing Gaussi
-00002b60: 616e 2070 6561 6b73 2e0a 0a20 2020 2053  an peaks...    S
-00002b70: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
-00002b80: 2d2d 2d2d 0a20 2020 2066 6974 5f67 6175  ----.    fit_gau
-00002b90: 7373 6961 6e32 445f 6d61 736b 0a20 2020  ssian2D_mask.   
-00002ba0: 2069 6e69 7469 616c 697a 655f 6761 7573   initialize_gaus
-00002bb0: 7331 440a 2020 2020 6761 7573 7369 616e  s1D.    gaussian
-00002bc0: 5f31 445f 6675 6e63 7469 6f6e 0a0a 2020  _1D_function..  
-00002bd0: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
-00002be0: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
-00002bf0: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
-00002c00: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 721c  ornl.gov>.    r.
-00002c10: 0000 0072 3700 0000 7222 0000 0072 0100  ...r7...r"...r..
-00002c20: 0000 7238 0000 0072 3900 0000 723b 0000  ..r8...r9...r;..
-00002c30: 0072 3c00 0000 723d 0000 0072 0400 0000  .r<...r=...r....
-00002c40: 290c 7205 0000 005a 0661 7261 6e67 65da  ).r....Z.arange.
-00002c50: 036c 656e 722b 0000 0072 4000 0000 721e  .lenr+...r@...r.
-00002c60: 0000 0072 4100 0000 7225 0000 0072 5200  ...rA...r%...rR.
-00002c70: 0000 7242 0000 0072 4300 0000 7251 0000  ..rB...rC...rQ..
-00002c80: 0029 10da 0673 6967 6e61 6cda 0870 6f73  .)...signal..pos
-00002c90: 6974 696f 6e5a 0a6d 6173 6b5f 7769 6474  itionZ.mask_widt
-00002ca0: 6872 3000 0000 7246 0000 0072 4700 0000  hr0...rF...rG...
-00002cb0: 7248 0000 005a 0d6d 6173 6b65 645f 7369  rH...Z.masked_si
-00002cc0: 676e 616c 7249 0000 0072 4a00 0000 5a0b  gnalrI...rJ...Z.
-00002cd0: 6361 6c63 5f73 6967 6e61 6c72 4b00 0000  calc_signalrK...
-00002ce0: 724c 0000 0072 4d00 0000 724e 0000 0072  rL...rM...rN...r
-00002cf0: 4f00 0000 7219 0000 0072 1900 0000 721a  O...r....r....r.
-00002d00: 0000 00da 1366 6974 5f67 6175 7373 6961  .....fit_gaussia
-00002d10: 6e31 445f 6d61 736b 7001 0000 733a 0000  n1D_maskp...s:..
-00002d20: 0000 2810 0112 0114 0114 010a 010a 0108  ..(.............
-00002d30: 0110 010e 0210 010c 011a 020a 0106 010a  ................
-00002d40: fd04 0504 0102 0102 0102 0102 0106 0102  ................
-00002d50: 0102 f90a 090a 0118 0118 0172 5600 0000  ...........rV...
-00002d60: 2901 7221 0000 0029 0272 3600 0000 7221  ).r!...).r6...r!
-00002d70: 0000 0029 0172 2100 0000 2901 7221 0000  ...).r!...).r!..
-00002d80: 0029 115a 056e 756d 7079 7205 0000 005a  .).Z.numpyr....Z
-00002d90: 0e73 6369 7079 2e6f 7074 696d 697a 65da  .scipy.optimize.
-00002da0: 086f 7074 696d 697a 6572 4200 0000 5a0d  .optimizerB...Z.
-00002db0: 7363 6970 792e 6e64 696d 6167 655a 076e  scipy.ndimageZ.n
-00002dc0: 6469 6d61 6765 5a04 7363 6e64 da08 7374  dimageZ.scnd..st
-00002dd0: 656d 746f 6f6c 7228 0000 0072 1b00 0000  emtoolr(...r....
-00002de0: 7220 0000 0072 3500 0000 7250 0000 0072  r ...r5...rP...r
-00002df0: 5100 0000 7252 0000 0072 5600 0000 7219  Q...rR...rV...r.
-00002e00: 0000 0072 1900 0000 7219 0000 0072 1a00  ...r....r....r..
-00002e10: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
-00002e20: 7316 0000 0008 010c 010c 0108 0308 3908  s.............9.
-00002e30: 3c0a 3b00 ff0a 6608 260a 2e              <.;...f.&..
+00000070: 0906 6413 640a 640b 8401 5a0d 640c 640d  ..d.d.d...Z.d.d.
+00000080: 8400 5a0e 6412 640e 640f 8401 5a0f 6412  ..Z.d.d.d...Z.d.
+00000090: 6410 6411 8401 5a10 6401 5300 2914 e900  d.d...Z.d.S.)...
+000000a0: 0000 004e 6307 0000 0000 0000 0000 0000  ...Nc...........
+000000b0: 0010 0000 0008 0000 0043 0000 0073 fc00  .........C...s..
+000000c0: 0000 7c00 6401 1900 7c01 1800 7d07 7c00  ..|.d...|...}.|.
+000000d0: 6402 1900 7c02 1800 7d08 7400 a001 7c03  d...|...}.t...|.
+000000e0: a101 6403 1300 6403 7c04 6403 1300 1400  ..d...d.|.d.....
+000000f0: 1b00 7400 a002 7c03 a101 6403 1300 6403  ..t...|...d...d.
+00000100: 7c05 6403 1300 1400 1b00 1700 7d09 7400  |.d.........}.t.
+00000110: a002 6403 7c03 1400 a101 6403 7c04 6403  ..d.|.....d.|.d.
+00000120: 1300 1400 1b00 7400 a002 6403 7c03 1400  ......t...d.|...
+00000130: a101 6403 7c05 6403 1300 1400 1b00 1800  ..d.|.d.........
+00000140: 7d0a 7400 a002 7c03 a101 6403 1300 6403  }.t...|...d...d.
+00000150: 7c04 6403 1300 1400 1b00 7400 a001 7c03  |.d.......t...|.
+00000160: a101 6403 1300 6403 7c05 6403 1300 1400  ..d...d.|.d.....
+00000170: 1b00 1700 7d0b 7c09 7c07 6403 1300 1400  ....}.|.|.d.....
+00000180: 7d0c 7c0a 7c07 1400 7c08 1400 7d0d 7c0b  }.|.|...|...}.|.
+00000190: 7c08 6403 1300 1400 7d0e 7400 a003 7c06  |.d.....}.t...|.
+000001a0: 7400 a004 6404 7c0c 7c0d 1700 7c0e 1700  t...d.|.|...|...
+000001b0: 1400 a101 1400 a101 7d0f 7c0f 5300 2905  ........}.|.S.).
+000001c0: 61b2 0300 000a 2020 2020 5468 6520 756e  a.....    The un
+000001d0: 6465 726c 7969 6e67 2032 4420 4761 7573  derlying 2D Gaus
+000001e0: 7369 616e 2066 756e 6374 696f 6e0a 0a20  sian function.. 
+000001f0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00000200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00000210: 2078 793a 2020 2020 2020 2020 7475 706c   xy:        tupl
+00000220: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00000230: 2078 2061 6e64 2079 2070 6f73 6974 696f   x and y positio
+00000240: 6e73 0a20 2020 2078 303a 2020 2020 2020  ns.    x0:      
+00000250: 2020 666c 6f61 740a 2020 2020 2020 2020    float.        
+00000260: 2020 2020 2020 2078 2063 656e 7465 7220         x center 
+00000270: 6f66 2047 6175 7373 6961 6e20 7065 616b  of Gaussian peak
+00000280: 0a20 2020 2079 303a 2020 2020 2020 2020  .    y0:        
+00000290: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+000002a0: 2020 2020 2079 2063 656e 7465 7220 6f66       y center of
+000002b0: 2047 6175 7373 6961 6e20 7065 616b 0a20   Gaussian peak. 
+000002c0: 2020 2074 6865 7461 3a20 2020 2020 666c     theta:     fl
+000002d0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+000002e0: 2020 2052 6f74 6174 696f 6e20 6f66 2074     Rotation of t
+000002f0: 6865 2032 4420 6761 7573 7369 616e 2070  he 2D gaussian p
+00000300: 6561 6b20 696e 2072 6164 6961 6e73 0a20  eak in radians. 
+00000310: 2020 2073 6967 6d61 5f78 3a20 2020 666c     sigma_x:   fl
+00000320: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+00000330: 2020 2053 7461 6e64 6172 6420 6465 7669     Standard devi
+00000340: 6174 696f 6e20 6f66 2074 6865 2032 4420  ation of the 2D 
+00000350: 4761 7573 7369 616e 2061 6c6f 6e67 2078  Gaussian along x
+00000360: 0a20 2020 2073 6967 6d61 5f79 3a20 2020  .    sigma_y:   
+00000370: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+00000380: 2020 2020 2053 7461 6e64 6172 6420 6465       Standard de
+00000390: 7669 6174 696f 6e20 6f66 2074 6865 2032  viation of the 2
+000003a0: 4420 4761 7573 7369 616e 2061 6c6f 6e67  D Gaussian along
+000003b0: 2079 0a20 2020 2061 6d70 6c69 7475 6465   y.    amplitude
+000003c0: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+000003d0: 2020 2020 2020 2050 6561 6b20 696e 7465         Peak inte
+000003e0: 6e73 6974 790a 0a20 2020 2052 6574 7572  nsity..    Retur
+000003f0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00000400: 2020 2067 6175 7373 7661 6c73 3a20 6e64     gaussvals: nd
+00000410: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00000420: 2020 2020 2041 2047 6175 7369 616e 2070       A Gausian p
+00000430: 6561 6b20 6365 6e74 6572 6564 2061 7420  eak centered at 
+00000440: 7830 2c20 7930 2062 6173 6564 206f 6e20  x0, y0 based on 
+00000450: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00000460: 2020 2070 6172 616d 6574 6572 7320 6769     parameters gi
+00000470: 7665 6e0a 0a20 2020 204e 6f74 6573 0a20  ven..    Notes. 
+00000480: 2020 202d 2d2d 2d2d 0a20 2020 2054 6865     -----.    The
+00000490: 2047 6175 7373 6961 6e20 3244 2066 756e   Gaussian 2D fun
+000004a0: 6374 696f 6e20 6973 2063 616c 6375 6c61  ction is calcula
+000004b0: 7465 6420 6174 2065 7665 7279 2078 2061  ted at every x a
+000004c0: 6e64 2079 2070 6f73 6974 696f 6e0a 2020  nd y position.  
+000004d0: 2020 666f 7220 6120 6c69 7374 206f 6620    for a list of 
+000004e0: 706f 7369 7469 6f6e 2076 616c 7565 7320  position values 
+000004f0: 6261 7365 6420 6f6e 2074 6865 2070 6172  based on the par
+00000500: 616d 6574 6572 7320 6769 7665 6e2e 0a0a  ameters given...
+00000510: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
+00000520: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 6761   --------.    ga
+00000530: 7573 7332 440a 0a20 2020 203a 4175 7468  uss2D..    :Auth
+00000540: 6f72 733a 0a20 2020 2044 6562 616e 6773  ors:.    Debangs
+00000550: 6875 204d 756b 6865 726a 6565 203c 6d75  hu Mukherjee <mu
+00000560: 6b68 6572 6a65 6564 406f 726e 6c2e 676f  kherjeed@ornl.go
+00000570: 763e 0a20 2020 2072 0100 0000 e901 0000  v>.    r........
+00000580: 00e9 0200 0000 e9ff ffff ff29 05da 026e  ...........)...n
+00000590: 70da 0363 6f73 da03 7369 6e5a 0572 6176  p..cos..sinZ.rav
+000005a0: 656c da03 6578 7029 10da 0278 79da 0278  el..exp)...xy..x
+000005b0: 30da 0279 30da 0574 6865 7461 da07 7369  0..y0..theta..si
+000005c0: 676d 615f 78da 0773 6967 6d61 5f79 da09  gma_x..sigma_y..
+000005d0: 616d 706c 6974 7564 65da 0178 da01 79da  amplitude..x..y.
+000005e0: 0674 6572 6d5f 31da 0674 6572 6d5f 32da  .term_1..term_2.
+000005f0: 0674 6572 6d5f 33da 0665 7870 6f5f 31da  .term_3..expo_1.
+00000600: 0665 7870 6f5f 32da 0665 7870 6f5f 33da  .expo_2..expo_3.
+00000610: 0967 6175 7373 7661 6c73 a900 7219 0000  .gaussvals..r...
+00000620: 00fa 3962 7569 6c64 2f62 6469 7374 2e6c  ..9build/bdist.l
+00000630: 696e 7578 2d78 3836 5f36 342f 6567 672f  inux-x86_64/egg/
+00000640: 7374 656d 746f 6f6c 2f75 7469 6c2f 6761  stemtool/util/ga
+00000650: 7573 735f 7574 696c 732e 7079 da14 6761  uss_utils.py..ga
+00000660: 7573 7369 616e 5f32 445f 6675 6e63 7469  ussian_2D_functi
+00000670: 6f6e 0700 0000 7320 0000 000c 270c 0118  on....s ....'...
+00000680: 0118 0104 ff18 0318 0104 ff18 0318 0104  ................
+00000690: ff0c 030c 010c 0120 0104 0172 1b00 0000  ....... ...r....
+000006a0: 6307 0000 0000 0000 0000 0000 0012 0000  c...............
+000006b0: 0006 0000 0043 0000 0073 3401 0000 7400  .....C...s4...t.
+000006c0: 6a01 6401 7c00 6401 1900 8502 6401 7c00  j.d.|.d.....d.|.
+000006d0: 6402 1900 8502 6602 1900 5c02 7d07 7d08  d.....f...\.}.}.
+000006e0: 7400 6a02 7c07 7400 6a03 6403 8d02 7d09  t.j.|.t.j.d...}.
+000006f0: 7c08 7c01 1800 7d0a 7c07 7c02 1800 7d0b  |.|...}.|.|...}.
+00000700: 7400 a004 7c03 a101 6404 1300 6404 7c04  t...|...d...d.|.
+00000710: 6404 1300 1400 1b00 7400 a005 7c03 a101  d.......t...|...
+00000720: 6404 1300 6404 7c05 6404 1300 1400 1b00  d...d.|.d.......
+00000730: 1700 7d0c 7400 a005 6404 7c03 1400 a101  ..}.t...d.|.....
+00000740: 6404 7c04 6404 1300 1400 1b00 7400 a005  d.|.d.......t...
+00000750: 6404 7c03 1400 a101 6404 7c05 6404 1300  d.|.....d.|.d...
+00000760: 1400 1b00 1800 7d0d 7400 a005 7c03 a101  ......}.t...|...
+00000770: 6404 1300 6404 7c04 6404 1300 1400 1b00  d...d.|.d.......
+00000780: 7400 a004 7c03 a101 6404 1300 6404 7c05  t...|...d...d.|.
+00000790: 6404 1300 1400 1b00 1700 7d0e 7c0c 7400  d.........}.|.t.
+000007a0: a006 7c0a 7c0a a102 1400 7d0f 7c0d 7400  ..|.|.....}.|.t.
+000007b0: a006 7c0a 7c0b a102 1400 7d10 7c0e 7400  ..|.|.....}.|.t.
+000007c0: a006 7c0b 7c0b a102 1400 7d11 7c06 7400  ..|.|.....}.|.t.
+000007d0: a007 6405 7c0f 7c10 1700 7c11 1700 1400  ..d.|.|...|.....
+000007e0: a101 1400 7c09 7c07 7c08 6602 3c00 7c09  ....|.|.|.f.<.|.
+000007f0: 5300 2906 61de 0300 000a 2020 2020 5265  S.).a.....    Re
+00000800: 7475 726e 2061 2032 4420 4761 7573 7369  turn a 2D Gaussi
+00000810: 616e 2066 756e 6374 696f 6e20 6365 6e74  an function cent
+00000820: 6572 6564 2061 7420 7830 2c20 7930 0a0a  ered at x0, y0..
+00000830: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00000840: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00000850: 2020 696d 5f73 697a 653a 2020 2074 7570    im_size:   tup
+00000860: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
+00000870: 2020 5369 7a65 206f 6620 7468 6520 696d    Size of the im
+00000880: 6167 6520 7768 6572 6520 6120 4761 7573  age where a Gaus
+00000890: 7369 616e 2070 6561 6b0a 2020 2020 2020  sian peak.      
+000008a0: 2020 2020 2020 2020 2069 7320 746f 2062           is to b
+000008b0: 6520 6765 6e65 7261 7465 640a 2020 2020  e generated.    
+000008c0: 7830 3a20 2020 2020 2020 2066 6c6f 6174  x0:        float
+000008d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000008e0: 7820 6365 6e74 6572 206f 6620 4761 7573  x center of Gaus
+000008f0: 7369 616e 2070 6561 6b0a 2020 2020 7930  sian peak.    y0
+00000900: 3a20 2020 2020 2020 2066 6c6f 6174 0a20  :        float. 
+00000910: 2020 2020 2020 2020 2020 2020 2020 7920                y 
+00000920: 6365 6e74 6572 206f 6620 4761 7573 7369  center of Gaussi
+00000930: 616e 2070 6561 6b0a 2020 2020 7468 6574  an peak.    thet
+00000940: 613a 2020 2020 2066 6c6f 6174 0a20 2020  a:     float.   
+00000950: 2020 2020 2020 2020 2020 2020 526f 7461              Rota
+00000960: 7469 6f6e 206f 6620 7468 6520 3244 2067  tion of the 2D g
+00000970: 6175 7373 6961 6e20 7065 616b 2069 6e20  aussian peak in 
+00000980: 7261 6469 616e 730a 2020 2020 7369 676d  radians.    sigm
+00000990: 615f 783a 2020 2066 6c6f 6174 0a20 2020  a_x:   float.   
+000009a0: 2020 2020 2020 2020 2020 2020 5374 616e              Stan
+000009b0: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
+000009c0: 6620 7468 6520 3244 2047 6175 7373 6961  f the 2D Gaussia
+000009d0: 6e20 616c 6f6e 6720 780a 2020 2020 7369  n along x.    si
+000009e0: 676d 615f 793a 2020 2066 6c6f 6174 0a20  gma_y:   float. 
+000009f0: 2020 2020 2020 2020 2020 2020 2020 5374                St
+00000a00: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
+00000a10: 206f 6620 7468 6520 3244 2047 6175 7373   of the 2D Gauss
+00000a20: 6961 6e20 616c 6f6e 6720 790a 2020 2020  ian along y.    
+00000a30: 616d 706c 6974 7564 653a 2066 6c6f 6174  amplitude: float
+00000a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000a50: 5065 616b 2069 6e74 656e 7369 7479 0a0a  Peak intensity..
+00000a60: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00000a70: 2d2d 2d2d 2d2d 2d0a 2020 2020 6761 7573  -------.    gaus
+00000a80: 7332 443a 206e 6461 7272 6179 0a20 2020  s2D: ndarray.   
+00000a90: 2020 2020 2020 2020 2020 3244 2047 6175            2D Gau
+00000aa0: 7373 6961 6e20 7065 616b 206f 6620 7368  ssian peak of sh
+00000ab0: 6170 6520 696d 5f73 697a 650a 0a20 2020  ape im_size..   
+00000ac0: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
+00000ad0: 0a20 2020 2054 6869 7320 7265 7475 726e  .    This return
+00000ae0: 7320 6120 3244 206e 6461 7272 6179 2077  s a 2D ndarray w
+00000af0: 6974 6820 7468 6520 7468 6520 7369 7a65  ith the the size
+00000b00: 2061 7320 696d 5f73 697a 652c 2077 6974   as im_size, wit
+00000b10: 680a 2020 2020 6120 3244 2067 6175 7373  h.    a 2D gauss
+00000b20: 6961 6e20 6675 6e63 7469 6f6e 2063 656e  ian function cen
+00000b30: 7465 7265 6420 6174 2028 7830 2c79 3029  tered at (x0,y0)
+00000b40: 2064 6566 696e 6564 2062 7920 7468 650a   defined by the.
+00000b50: 2020 2020 696e 7075 7420 7061 7261 6d65      input parame
+00000b60: 7465 7273 2e0a 0a20 2020 2053 6565 2061  ters...    See a
+00000b70: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
+00000b80: 0a20 2020 2067 6175 7373 3244 5f66 756e  .    gauss2D_fun
+00000b90: 6374 696f 6e0a 0a20 2020 203a 4175 7468  ction..    :Auth
+00000ba0: 6f72 733a 0a20 2020 2044 6562 616e 6773  ors:.    Debangs
+00000bb0: 6875 204d 756b 6865 726a 6565 203c 6d75  hu Mukherjee <mu
+00000bc0: 6b68 6572 6a65 6564 406f 726e 6c2e 676f  kherjeed@ornl.go
+00000bd0: 763e 0a20 2020 2072 0100 0000 7202 0000  v>.    r....r...
+00000be0: 00a9 015a 0564 7479 7065 7203 0000 0072  ...Z.dtyper....r
+00000bf0: 0400 0000 2908 7205 0000 00da 056d 6772  ....).r......mgr
+00000c00: 6964 5a05 7a65 726f 73da 0566 6c6f 6174  idZ.zeros..float
+00000c10: 7206 0000 0072 0700 0000 da08 6d75 6c74  r....r......mult
+00000c20: 6970 6c79 7208 0000 0029 125a 0769 6d5f  iplyr....).Z.im_
+00000c30: 7369 7a65 720a 0000 0072 0b00 0000 720c  sizer....r....r.
+00000c40: 0000 0072 0d00 0000 720e 0000 0072 0f00  ...r....r....r..
+00000c50: 0000 5a02 7972 5a02 7872 da07 6761 7573  ..Z.yrZ.xr..gaus
+00000c60: 7332 4472 1000 0000 7211 0000 0072 1200  s2Dr....r....r..
+00000c70: 0000 7213 0000 0072 1400 0000 7215 0000  ..r....r....r...
+00000c80: 0072 1600 0000 7217 0000 0072 1900 0000  .r....r....r....
+00000c90: 7219 0000 0072 1a00 0000 7220 0000 0040  r....r....r ...@
+00000ca0: 0000 0073 2400 0000 2228 1001 0801 0801  ...s$..."(......
+00000cb0: 1801 1801 04ff 1803 1801 04ff 1803 1801  ................
+00000cc0: 04ff 1003 1001 1001 2201 0401 7220 0000  ........"...r ..
+00000cd0: 00da 0343 4f4d 6304 0000 0000 0000 0000  ...COMc.........
+00000ce0: 0000 000e 0000 0006 0000 0043 0000 0073  ...........C...s
+00000cf0: 0c01 0000 7c03 6401 6b02 7217 7c00 7c02  ....|.d.k.r.|.|.
+00000d00: 7400 a001 7c02 a101 6b02 1900 7d04 7c01  t...|...k...}.|.
+00000d10: 7c02 7400 a001 7c02 a101 6b02 1900 7d05  |.t...|...k...}.
+00000d20: 6e20 7c03 6402 6b02 7233 7400 a002 7c02  n |.d.k.r3t...|.
+00000d30: a101 7d06 7400 a002 7c00 7c02 1400 a101  ..}.t...|.|.....
+00000d40: 7c06 1b00 7d04 7400 a002 7c01 7c02 1400  |...}.t...|.|...
+00000d50: a101 7c06 1b00 7d05 6e04 7403 6403 8301  ..|...}.n.t.d...
+00000d60: 8201 7404 6a05 a006 7c02 a101 7d07 7c00  ..t.j...|...}.|.
+00000d70: 7c07 6404 6b04 1900 7d08 7400 a007 7c08  |.d.k...}.t...|.
+00000d80: 7c04 1800 a101 7d08 7c01 7c07 6404 6b04  |.....}.|.|.d.k.
+00000d90: 1900 7d09 7400 a007 7c09 7c05 1800 a101  ..}.t...|.|.....
+00000da0: 7d09 7400 a001 7c08 a101 6405 6405 7400  }.t...|...d.d.t.
+00000db0: a008 6405 a101 1400 6404 1300 1400 1b00  ..d.....d.......
+00000dc0: 7d0a 7400 a001 7c09 a101 6405 6405 7400  }.t...|...d.d.t.
+00000dd0: a008 6405 a101 1400 6404 1300 1400 1b00  ..d.....d.......
+00000de0: 7d0b 7400 a001 7c02 a101 7d0c 7c04 7c05  }.t...|...}.|.|.
+00000df0: 6406 7c0a 7c0b 7c0c 6606 7d0d 7c0d 5300  d.|.|.|.f.}.|.S.
+00000e00: 2907 6143 0400 000a 2020 2020 4765 6e65  ).aC....    Gene
+00000e10: 7261 7465 2061 6e20 6170 7072 6f78 696d  rate an approxim
+00000e20: 6174 6520 4761 7573 7369 616e 2062 6173  ate Gaussian bas
+00000e30: 6564 206f 6e20 696d 6167 650a 0a20 2020  ed on image..   
+00000e40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00000e50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078  ----------.    x
+00000e60: 783a 2020 2020 2020 2020 2020 6e64 6172  x:          ndar
+00000e70: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+00000e80: 2020 2020 2058 2070 6f73 6974 696f 6e73       X positions
+00000e90: 0a20 2020 2079 793a 2020 2020 2020 2020  .    yy:        
+00000ea0: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
+00000eb0: 2020 2020 2020 2020 2020 2059 2050 6f73             Y Pos
+00000ec0: 6974 696f 6e73 0a20 2020 207a 7a3a 2020  itions.    zz:  
+00000ed0: 2020 2020 2020 2020 6e64 6172 7261 790a          ndarray.
+00000ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ef0: 2049 6d61 6765 2076 616c 7565 2061 7420   Image value at 
+00000f00: 7468 6520 706f 7369 7469 6f6e 730a 2020  the positions.  
+00000f10: 2020 6365 6e74 6572 5f74 7970 653a 2073    center_type: s
+00000f20: 7472 0a20 2020 2020 2020 2020 2020 2020  tr.             
+00000f30: 2020 2020 4465 6661 756c 7420 6973 2060      Default is `
+00000f40: 434f 4d60 2077 6869 6368 2075 7365 7320  COM` which uses 
+00000f50: 7468 6520 6365 6e74 6572 0a20 2020 2020  the center.     
+00000f60: 2020 2020 2020 2020 2020 2020 6f66 206d              of m
+00000f70: 6173 7320 6f66 2074 6865 2067 6976 656e  ass of the given
+00000f80: 2070 6f73 6974 696f 6e73 2074 6f20 6765   positions to ge
+00000f90: 6e65 7261 7465 0a20 2020 2020 2020 2020  nerate.         
+00000fa0: 2020 2020 2020 2020 7468 6520 7374 6172          the star
+00000fb0: 7469 6e67 2067 6175 7373 6961 6e20 6365  ting gaussian ce
+00000fc0: 6e74 6572 2e20 5468 6520 6f74 6865 7220  nter. The other 
+00000fd0: 6f70 7469 6f6e 0a20 2020 2020 2020 2020  option.         
+00000fe0: 2020 2020 2020 2020 6973 2060 6d61 7869          is `maxi
+00000ff0: 6d61 6020 7768 6963 6820 7461 6b65 7320  ma` which takes 
+00001000: 7468 6520 6d61 7869 6d75 6d20 696e 7465  the maximum inte
+00001010: 6e73 6974 790a 2020 2020 2020 2020 2020  nsity.          
+00001020: 2020 2020 2020 2076 616c 7565 2061 7320         value as 
+00001030: 7468 6520 7374 6172 7469 6e67 2070 6f69  the starting poi
+00001040: 6e74 2e0a 0a20 2020 2052 6574 7572 6e73  nt...    Returns
+00001050: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00001060: 2067 6175 7373 5f69 6e69 3a20 7475 706c   gauss_ini: tupl
+00001070: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00001080: 2058 5f63 656e 7465 722c 2059 5f63 656e   X_center, Y_cen
+00001090: 7465 722c 2041 6e67 6c65 2c20 585f 7374  ter, Angle, X_st
+000010a0: 642c 2059 5f73 7464 2c20 416d 706c 6974  d, Y_std, Amplit
+000010b0: 7564 650a 0a20 2020 204e 6f74 6573 0a20  ude..    Notes. 
+000010c0: 2020 202d 2d2d 2d2d 0a20 2020 2046 6f72     -----.    For
+000010d0: 2061 2067 6976 656e 206c 6973 7420 6f66   a given list of
+000010e0: 2078 2070 6f73 6974 696f 6e73 2c20 7920   x positions, y 
+000010f0: 706f 7369 7469 6f6e 7320 616e 6420 636f  positions and co
+00001100: 7272 6573 706f 6e64 696e 670a 2020 2020  rresponding.    
+00001110: 696e 7465 6e73 6974 7920 7661 6c75 6573  intensity values
+00001120: 2c20 7468 6973 2063 6f64 6520 7265 7475  , this code retu
+00001130: 726e 7320 6120 6669 7273 7420 7061 7373  rns a first pass
+00001140: 2061 7070 726f 7869 6d61 7469 6f6e 0a20   approximation. 
+00001150: 2020 206f 6620 6120 4761 7573 7369 616e     of a Gaussian
+00001160: 2066 756e 6374 696f 6e2e 2054 6865 2063   function. The c
+00001170: 656e 7465 7220 6f66 2074 6865 2067 6175  enter of the gau
+00001180: 7373 6961 6e20 3244 2066 756e 6374 696f  ssian 2D functio
+00001190: 6e0a 2020 2020 6361 6e20 6569 7468 6572  n.    can either
+000011a0: 2062 6520 7468 6520 6365 6e74 6572 206f   be the center o
+000011b0: 6620 6d61 7373 206f 7220 7468 6520 696e  f mass or the in
+000011c0: 7465 6e73 6974 7920 6d61 7869 6d61 2c20  tensity maxima, 
+000011d0: 616e 6420 6973 0a20 2020 2075 7365 7220  and is.    user 
+000011e0: 6465 6669 6e65 642e 2054 6865 2061 6e67  defined. The ang
+000011f0: 6c65 2069 7320 616c 7761 7973 2067 6976  le is always giv
+00001200: 656e 2061 7320 302e 0a0a 2020 2020 3a41  en as 0...    :A
+00001210: 7574 686f 7273 3a0a 2020 2020 4465 6261  uthors:.    Deba
+00001220: 6e67 7368 7520 4d75 6b68 6572 6a65 6520  ngshu Mukherjee 
+00001230: 3c6d 756b 6865 726a 6565 6440 6f72 6e6c  <mukherjeed@ornl
+00001240: 2e67 6f76 3e0a 2020 2020 da06 6d61 7869  .gov>.    ..maxi
+00001250: 6d61 7221 0000 00fa 1349 6e76 616c 6964  mar!.....Invalid
+00001260: 2043 656e 7465 7220 5479 7065 e700 0000   Center Type....
+00001270: 0000 00e0 3f72 0300 0000 7201 0000 0029  ....?r....r....)
+00001280: 0972 0500 0000 da04 616d 6178 da03 7375  .r......amax..su
+00001290: 6dda 0a56 616c 7565 4572 726f 72da 0273  m..ValueError..s
+000012a0: 74da 0475 7469 6cda 1069 6d61 6765 5f6e  t..util..image_n
+000012b0: 6f72 6d61 6c69 7a65 72da 0361 6273 da03  ormalizer..abs..
+000012c0: 6c6f 6729 0eda 0278 78da 0279 79da 027a  log)...xx..yy..z
+000012d0: 7ada 0b63 656e 7465 725f 7479 7065 da05  z..center_type..
+000012e0: 785f 636f 6d5a 0579 5f63 6f6d da05 746f  x_comZ.y_com..to
+000012f0: 7461 6c5a 077a 7a5f 6e6f 726d da06 785f  talZ.zz_norm..x_
+00001300: 6677 686d 5a06 795f 6677 686d 720d 0000  fwhmZ.y_fwhmr...
+00001310: 0072 0e00 0000 da06 6865 6967 6874 5a09  .r......heightZ.
+00001320: 6761 7573 735f 696e 6972 1900 0000 7219  gauss_inir....r.
+00001330: 0000 0072 1a00 0000 da12 696e 6974 6961  ...r......initia
+00001340: 6c69 7a65 5f67 6175 7373 3244 7c00 0000  lize_gauss2D|...
+00001350: 7324 0000 0008 2312 0114 0108 010a 0112  s$....#.........
+00001360: 0114 0108 020c 020c 010e 010c 010e 0120  ............... 
+00001370: 0220 010a 0110 0104 0172 3500 0000 da08  . .......r5.....
+00001380: 6369 7263 756c 6172 6306 0000 0000 0000  circularc.......
+00001390: 0000 0000 0017 0000 0009 0000 0043 0000  .............C..
+000013a0: 0073 de01 0000 7400 a001 7c00 a101 5c02  .s....t...|...\.
+000013b0: 7d06 7d07 7400 6a02 6401 7c06 8502 6401  }.}.t.j.d.|...d.
+000013c0: 7c07 8502 6602 1900 5c02 7d08 7d09 7c04  |...f...\.}.}.|.
+000013d0: 6402 6b02 7229 7c08 7c02 1800 6403 1300  d.k.r)|.|...d...
+000013e0: 7c09 7c01 1800 6403 1300 1700 6404 1300  |.|...d.....d...
+000013f0: 7c03 6b00 7d0a 6e1d 7c04 6405 6b02 7242  |.k.}.n.|.d.k.rB
+00001400: 7400 a003 7400 a004 7c08 7c02 1800 a101  t...t...|.|.....
+00001410: 7c03 6b00 7400 a004 7c09 7c01 1800 a101  |.k.t...|.|.....
+00001420: 7c03 6b00 a102 7d0a 6e04 7405 6406 8301  |.k...}.n.t.d...
+00001430: 8201 7400 6a06 7c09 7c0a 1900 7400 6a07  ..t.j.|.|...t.j.
+00001440: 6407 8d02 7d0b 7400 6a06 7c08 7c0a 1900  d...}.t.j.|.|...
+00001450: 7400 6a07 6407 8d02 7d0c 7400 6a06 7c00  t.j.d...}.t.j.|.
+00001460: 7c0a 1900 7400 6a07 6407 8d02 7d0d 7400  |...t.j.d...}.t.
+00001470: a008 7c0d a101 7d0e 7400 a009 7c0d a101  ..|...}.t...|...
+00001480: 7d0f 7c05 6408 6b02 7282 7c0d 7c0f 1800  }.|.d.k.r.|.|...
+00001490: 7c0e 7c0f 1800 1b00 7d10 740a 7c0b 7c0c  |.|.....}.t.|.|.
+000014a0: 7c10 6409 8304 7d11 6e0f 7c0d 7c0e 1800  |.d...}.n.|.|...
+000014b0: 7c0f 7c0e 1800 1b00 7d10 740a 7c0b 7c0c  |.|.....}.t.|.|.
+000014c0: 7c10 7c05 8304 7d11 7c11 6401 1900 7c03  |.|...}.|.d...|.
+000014d0: 1800 7c11 640a 1900 7c03 1800 640b 6401  ..|.d...|...d.d.
+000014e0: 6401 640c 7c11 640d 1900 1400 6606 7d12  d.d.|.d.....f.}.
+000014f0: 7c11 6401 1900 7c03 1700 7c11 640a 1900  |.d...|...|.d...
+00001500: 7c03 1700 640e 640f 7c03 1400 640f 7c03  |...d.d.|...d.|.
+00001510: 1400 640f 7c11 640d 1900 1400 6606 7d13  ..d.|.d.....f.}.
+00001520: 7c0b 7c0c 6602 7d14 740b 6a0c 740d 7c14  |.|.f.}.t.j.t.|.
+00001530: 7c10 7c11 7c12 7c13 6602 6410 6410 6411  |.|.|.|.f.d.d.d.
+00001540: 8d07 5c02 7d15 7d16 7c05 6408 6b02 72e1  ..\.}.}.|.d.k.r.
+00001550: 7c15 6412 1900 7c0e 7c0f 1800 1400 7c0f  |.d...|.|.....|.
+00001560: 1700 7c15 6412 3c00 7c15 6412 1900 7c0f  ..|.d.<.|.d...|.
+00001570: 7c0e 1800 1400 7c0e 1700 7c15 6412 3c00  |.....|...|.d.<.
+00001580: 7c15 5300 2913 61f3 0500 000a 2020 2020  |.S.).a.....    
+00001590: 4669 7420 6120 3244 2067 6175 7373 6961  Fit a 2D gaussia
+000015a0: 6e20 746f 2061 206d 6173 6b65 6420 696d  n to a masked im
+000015b0: 6167 6520 6261 7365 6420 6f6e 0a20 2020  age based on.   
+000015c0: 2074 6865 206c 6f63 6174 696f 6e20 6f66   the location of
+000015d0: 2074 6865 206d 6173 6b2c 2073 697a 6520   the mask, size 
+000015e0: 6f66 2074 6865 206d 6173 6b20 616e 640a  of the mask and.
+000015f0: 2020 2020 7468 6520 7479 7065 206f 6620      the type of 
+00001600: 7468 6520 6d61 736b 0a0a 2020 2020 5061  the mask..    Pa
+00001610: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00001620: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
+00001630: 655f 6461 7461 3a20 206e 6461 7272 6179  e_data:  ndarray
+00001640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001650: 2020 5468 6520 696d 6167 6520 7468 6174    The image that
+00001660: 2077 696c 6c20 6265 2066 6974 7465 6420   will be fitted 
+00001670: 7769 7468 2074 6865 2047 6175 7373 6961  with the Gaussia
+00001680: 6e0a 2020 2020 6d61 736b 5f78 3a20 2020  n.    mask_x:   
+00001690: 2020 2066 6c6f 6174 0a20 2020 2020 2020     float.       
+000016a0: 2020 2020 2020 2020 2020 7820 6365 6e74            x cent
+000016b0: 6572 206f 6620 7468 6520 6d61 736b 0a20  er of the mask. 
+000016c0: 2020 206d 6173 6b5f 793a 2020 2020 2020     mask_y:      
+000016d0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
+000016e0: 2020 2020 2020 2079 2063 656e 7465 7220         y center 
+000016f0: 6f66 2074 6865 206d 6173 6b0a 2020 2020  of the mask.    
+00001700: 6d61 736b 5f72 6164 6975 733a 2066 6c6f  mask_radius: flo
+00001710: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+00001720: 2020 2020 5468 6520 7369 7a65 206f 6620      The size of 
+00001730: 7468 6520 6d61 736b 2e20 466f 7220 6120  the mask. For a 
+00001740: 6369 7263 756c 6174 206d 6173 6b20 7468  circulat mask th
+00001750: 6973 0a20 2020 2020 2020 2020 2020 2020  is.             
+00001760: 2020 2020 7265 6665 7273 2074 6f20 7468      refers to th
+00001770: 6520 6d61 736b 2072 6164 6975 732c 2077  e mask radius, w
+00001780: 6869 6c65 2066 6f72 2061 2073 7175 6172  hile for a squar
+00001790: 6520 6d61 736b 0a20 2020 2020 2020 2020  e mask.         
+000017a0: 2020 2020 2020 2020 7468 6973 2072 6566          this ref
+000017b0: 6572 7320 746f 2068 616c 6620 7468 6520  ers to half the 
+000017c0: 7369 6465 206f 6620 7468 6520 7371 7561  side of the squa
+000017d0: 7265 0a20 2020 206d 6173 6b5f 7479 7065  re.    mask_type
+000017e0: 3a20 2020 7374 720a 2020 2020 2020 2020  :   str.        
+000017f0: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+00001800: 2069 7320 6063 6972 6375 6c61 7260 2c20   is `circular`, 
+00001810: 7768 696c 6520 7468 6520 6f74 6865 7220  while the other 
+00001820: 6f70 7469 6f6e 2069 7320 6073 7175 6172  option is `squar
+00001830: 6560 0a20 2020 2063 656e 7465 725f 7479  e`.    center_ty
+00001840: 7065 3a20 7374 720a 2020 2020 2020 2020  pe: str.        
+00001850: 2020 2020 2020 2020 2043 656e 7465 7220           Center 
+00001860: 6c6f 6361 7469 6f6e 2066 6f72 2074 6865  location for the
+00001870: 2066 6972 7374 2070 6173 7320 6f66 2074   first pass of t
+00001880: 6865 2047 6175 7373 6961 6e2e 0a20 2020  he Gaussian..   
+00001890: 2020 2020 2020 2020 2020 2020 2020 4465                De
+000018a0: 6661 756c 7420 6973 2060 434f 4d60 2c20  fault is `COM`, 
+000018b0: 7768 696c 6520 7468 6520 6f74 6865 7220  while the other 
+000018c0: 6f70 7469 6f6e 7320 6172 6520 606d 696e  options are `min
+000018d0: 696d 6160 0a20 2020 2020 2020 2020 2020  ima`.           
+000018e0: 2020 2020 2020 6f72 2060 6d61 7869 6d61        or `maxima
+000018f0: 602e 0a0a 2020 2020 5265 7475 726e 730a  `...    Returns.
+00001900: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00001910: 706f 7074 3a20 7475 706c 650a 2020 2020  popt: tuple.    
+00001920: 2020 2020 2020 5265 6669 6e65 6420 5820        Refined X 
+00001930: 706f 7369 7469 6f6e 2c20 5265 6669 6e65  position, Refine
+00001940: 6420 5920 506f 7369 7469 6f6e 2c20 526f  d Y Position, Ro
+00001950: 7461 7469 6f6e 2061 6e67 6c65 206f 660a  tation angle of.
+00001960: 2020 2020 2020 2020 2020 3244 2047 6175            2D Gau
+00001970: 7373 6961 6e2c 2053 7461 6e64 6172 6420  ssian, Standard 
+00001980: 6465 7669 6174 696f 6e28 7329 2c20 416d  deviation(s), Am
+00001990: 706c 6974 7564 650a 0a20 2020 204e 6f74  plitude..    Not
+000019a0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+000019b0: 2054 6869 7320 636f 6465 2075 7365 7320   This code uses 
+000019c0: 7468 6520 6073 6369 7079 2e6f 7074 696d  the `scipy.optim
+000019d0: 697a 652e 6375 7276 655f 6669 7460 206d  ize.curve_fit` m
+000019e0: 6f64 756c 6520 746f 2066 6974 2061 2032  odule to fit a 2
+000019f0: 440a 2020 2020 4761 7573 7369 616e 2070  D.    Gaussian p
+00001a00: 6561 6b20 746f 206d 6173 6b65 6420 6461  eak to masked da
+00001a10: 7461 2e20 606d 6173 6b5f 7860 2061 6e64  ta. `mask_x` and
+00001a20: 2060 6d61 736b 5f79 6020 7265 6665 7220   `mask_y` refer 
+00001a30: 746f 2074 6865 0a20 2020 2069 6e69 7469  to the.    initi
+00001a40: 616c 2073 7461 7274 696e 6720 706f 7369  al starting posi
+00001a50: 7469 6f6e 732e 2041 6c73 6f2c 2074 6869  tions. Also, thi
+00001a60: 7320 6361 6e20 7461 6b65 2069 6e20 606d  s can take in `m
+00001a70: 696e 696d 6160 2061 7320 610a 2020 2020  inima` as a.    
+00001a80: 7374 7269 6e67 2066 6f72 2069 6e69 7469  string for initi
+00001a90: 616c 697a 696e 6720 4761 7573 7369 616e  alizing Gaussian
+00001aa0: 2070 6561 6b73 2c20 7768 6963 6820 616c   peaks, which al
+00001ab0: 6c6f 7773 2066 6f72 2061 746f 6d20 636f  lows for atom co
+00001ac0: 6c75 6d6e 0a20 2020 206d 6170 7069 6e67  lumn.    mapping
+00001ad0: 2069 6e20 696e 7665 7274 6564 2063 6f6e   in inverted con
+00001ae0: 7472 6173 7420 696d 6167 6573 2074 6f6f  trast images too
+00001af0: 2e0a 0a20 2020 2053 6565 2061 6c73 6f0a  ...    See also.
+00001b00: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00001b10: 2067 6175 7373 6961 6e5f 3244 5f66 756e   gaussian_2D_fun
+00001b20: 6374 696f 6e0a 2020 2020 696e 6974 6961  ction.    initia
+00001b30: 6c69 7a65 5f67 6175 7373 3244 0a0a 2020  lize_gauss2D..  
+00001b40: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
+00001b50: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
+00001b60: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
+00001b70: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 7201  ornl.gov>.    r.
+00001b80: 0000 0072 3600 0000 7203 0000 0072 2400  ...r6...r....r$.
+00001b90: 0000 5a06 7371 7561 7265 7a11 556e 6b6e  ..Z.squarez.Unkn
+00001ba0: 6f77 6e20 4d61 736b 2054 7970 6572 1c00  own Mask Typer..
+00001bb0: 0000 da06 6d69 6e69 6d61 7222 0000 0072  ....minimar"...r
+00001bc0: 0200 0000 694c ffff ffe7 0000 0000 0000  ....iL..........
+00001bd0: 04c0 e905 0000 00e9 b400 0000 e700 0000  ................
+00001be0: 0000 0004 40e7 7b14 ae47 e17a 843f a903  ....@.{..G.z.?..
+00001bf0: da06 626f 756e 6473 5a04 6674 6f6c 5a04  ..boundsZ.ftolZ.
+00001c00: 7874 6f6c 7204 0000 0029 0e72 0500 0000  xtolr....).r....
+00001c10: da05 7368 6170 6572 1d00 0000 5a0b 6c6f  ..shaper....Z.lo
+00001c20: 6769 6361 6c5f 616e 6472 2b00 0000 7227  gical_andr+...r'
+00001c30: 0000 00da 0761 7361 7272 6179 5a07 666c  .....asarrayZ.fl
+00001c40: 6f61 7436 34da 0461 6d69 6e72 2500 0000  oat64..aminr%...
+00001c50: 7235 0000 00da 0373 706f da09 6375 7276  r5.....spo..curv
+00001c60: 655f 6669 7472 1b00 0000 2917 5a0a 696d  e_fitr....).Z.im
+00001c70: 6167 655f 6461 7461 5a06 6d61 736b 5f78  age_dataZ.mask_x
+00001c80: 5a06 6d61 736b 5f79 5a0b 6d61 736b 5f72  Z.mask_yZ.mask_r
+00001c90: 6164 6975 735a 096d 6173 6b5f 7479 7065  adiusZ.mask_type
+00001ca0: 7230 0000 00da 0170 da01 715a 0279 56da  r0.....p..qZ.yV.
+00001cb0: 0278 56da 0373 7562 da05 785f 706f 735a  .xV..sub..x_posZ
+00001cc0: 0579 5f70 6f73 5a0c 6d61 736b 6564 5f69  .y_posZ.masked_i
+00001cd0: 6d61 6765 da06 6d69 5f6d 696e da06 6d69  mage..mi_min..mi
+00001ce0: 5f6d 6178 5a0a 6361 6c63 5f69 6d61 6765  _maxZ.calc_image
+00001cf0: da0d 696e 6974 6961 6c5f 6775 6573 73da  ..initial_guess.
+00001d00: 0b6c 6f77 6572 5f62 6f75 6e64 da0b 7570  .lower_bound..up
+00001d10: 7065 725f 626f 756e 6472 0900 0000 da04  per_boundr......
+00001d20: 706f 7074 da01 5f72 1900 0000 7219 0000  popt.._r....r...
+00001d30: 0072 1a00 0000 da13 6669 745f 6761 7573  .r......fit_gaus
+00001d40: 7369 616e 3244 5f6d 6173 6bb6 0000 0073  sian2D_mask....s
+00001d50: 5e00 0000 0e31 1a01 0801 2201 0801 0401  ^....1....".....
+00001d60: 2001 06ff 0804 1401 1401 1401 0a01 0a01   ...............
+00001d70: 0801 1001 1001 1002 0e01 0a02 0a01 0201  ................
+00001d80: 0201 0201 0a01 04fa 0a09 0a01 0201 0601  ................
+00001d90: 0601 0a01 04fa 0808 0401 0201 0201 0201  ................
+00001da0: 0201 0601 0201 0201 0af9 0809 1801 1801  ................
+00001db0: 0401 7250 0000 0063 0400 0000 0000 0000  ..rP...c........
+00001dc0: 0000 0000 0600 0000 0500 0000 4300 0000  ............C...
+00001dd0: 7332 0000 007c 007c 0118 007d 007c 0064  s2...|.|...}.|.d
+00001de0: 0113 0064 017c 0264 0113 0014 001b 007d  ...d.|.d.......}
+00001df0: 047c 0374 00a0 0164 027c 0414 00a1 0114  .|.t...d.|......
+00001e00: 007d 057c 0553 0029 0361 c302 0000 0a20  .}.|.S.).a..... 
+00001e10: 2020 2054 6865 2075 6e64 6572 6c79 696e     The underlyin
+00001e20: 6720 3144 2047 6175 7373 6961 6e20 6675  g 1D Gaussian fu
+00001e30: 6e63 7469 6f6e 0a0a 2020 2020 5061 7261  nction..    Para
+00001e40: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00001e50: 2d2d 2d2d 2d0a 2020 2020 783a 2020 2020  -----.    x:    
+00001e60: 2020 2020 206e 6461 7272 6179 0a20 2020       ndarray.   
+00001e70: 2020 2020 2020 2020 2020 2020 7820 706f              x po
+00001e80: 7369 7469 6f6e 730a 2020 2020 7830 3a20  sitions.    x0: 
+00001e90: 2020 2020 2020 2066 6c6f 6174 0a20 2020         float.   
+00001ea0: 2020 2020 2020 2020 2020 2020 7820 6365              x ce
+00001eb0: 6e74 6572 206f 6620 4761 7573 7369 616e  nter of Gaussian
+00001ec0: 2070 6561 6b0a 2020 2020 7369 676d 615f   peak.    sigma_
+00001ed0: 783a 2020 2066 6c6f 6174 0a20 2020 2020  x:   float.     
+00001ee0: 2020 2020 2020 2020 2020 5374 616e 6461            Standa
+00001ef0: 7264 2064 6576 6961 7469 6f6e 206f 6620  rd deviation of 
+00001f00: 7468 6520 3244 2047 6175 7373 6961 6e20  the 2D Gaussian 
+00001f10: 616c 6f6e 6720 780a 2020 2020 616d 706c  along x.    ampl
+00001f20: 6974 7564 653a 2066 6c6f 6174 0a20 2020  itude: float.   
+00001f30: 2020 2020 2020 2020 2020 2020 5065 616b              Peak
+00001f40: 2069 6e74 656e 7369 7479 0a0a 2020 2020   intensity..    
+00001f50: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00001f60: 2d2d 2d0a 2020 2020 6761 7573 7376 616c  ---.    gaussval
+00001f70: 733a 206e 6461 7272 6179 0a20 2020 2020  s: ndarray.     
+00001f80: 2020 2020 2020 2020 2020 4120 4761 7573            A Gaus
+00001f90: 6961 6e20 7065 616b 2063 656e 7465 7265  ian peak centere
+00001fa0: 6420 6174 2078 3020 6261 7365 6420 6f6e  d at x0 based on
+00001fb0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00001fc0: 2020 2020 7061 7261 6d65 7465 7273 2067      parameters g
+00001fd0: 6976 656e 0a0a 2020 2020 4e6f 7465 730a  iven..    Notes.
+00001fe0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5468      -----.    Th
+00001ff0: 6520 4761 7573 7369 616e 2031 4420 6675  e Gaussian 1D fu
+00002000: 6e63 7469 6f6e 2069 7320 6361 6c63 756c  nction is calcul
+00002010: 6174 6564 2061 7420 6576 6572 7920 7820  ated at every x 
+00002020: 706f 7369 7469 6f6e 2066 6f72 0a20 2020  position for.   
+00002030: 2061 206c 6973 7420 6f66 2070 6f73 6974   a list of posit
+00002040: 696f 6e20 7661 6c75 6573 2062 6173 6564  ion values based
+00002050: 206f 6e20 7468 6520 7061 7261 6d65 7465   on the paramete
+00002060: 7273 2067 6976 656e 2e0a 0a20 2020 2053  rs given...    S
+00002070: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
+00002080: 2d2d 2d2d 0a20 2020 2067 6175 7373 6961  ----.    gaussia
+00002090: 6e5f 3244 5f66 756e 6374 696f 6e0a 2020  n_2D_function.  
+000020a0: 2020 696e 6974 6961 6c69 7a65 5f67 6175    initialize_gau
+000020b0: 7373 3144 0a20 2020 2066 6974 5f67 6175  ss1D.    fit_gau
+000020c0: 7373 6961 6e31 445f 6d61 736b 0a20 2020  ssian1D_mask.   
+000020d0: 2072 0300 0000 7204 0000 0029 0272 0500   r....r....).r..
+000020e0: 0000 7208 0000 0029 0672 1000 0000 720a  ..r....).r....r.
+000020f0: 0000 0072 0d00 0000 720f 0000 005a 0474  ...r....r....Z.t
+00002100: 6572 6d72 1800 0000 7219 0000 0072 1900  ermr....r....r..
+00002110: 0000 721a 0000 00da 1467 6175 7373 6961  ..r......gaussia
+00002120: 6e5f 3144 5f66 756e 6374 696f 6e1c 0100  n_1D_function...
+00002130: 0073 0800 0000 0820 1401 1201 0401 7251  .s..... ......rQ
+00002140: 0000 0063 0300 0000 0000 0000 0000 0000  ...c............
+00002150: 0900 0000 0600 0000 4300 0000 73b0 0000  ........C...s...
+00002160: 007c 0264 016b 0272 127c 007c 0174 00a0  .|.d.k.r.|.|.t..
+00002170: 017c 01a1 016b 0219 007d 037c 0364 0219  .|...k...}.|.d..
+00002180: 007d 036e 197c 0264 036b 0272 2774 00a0  .}.n.|.d.k.r't..
+00002190: 027c 01a1 017d 0474 00a0 0274 00a0 037c  .|...}.t...t...|
+000021a0: 007c 01a1 02a1 017c 041b 007d 036e 0474  .|.....|...}.n.t
+000021b0: 0464 0483 0182 0174 056a 06a0 077c 01a1  .d.....t.j...|..
+000021c0: 017d 057c 007c 0564 056b 0419 007d 0674  .}.|.|.d.k...}.t
+000021d0: 00a0 087c 067c 0318 00a1 017d 0674 00a0  ...|.|.....}.t..
+000021e0: 017c 06a1 0164 0664 0674 00a0 0964 06a1  .|...d.d.t...d..
+000021f0: 0114 0064 0513 0014 001b 007d 0774 00a0  ...d.......}.t..
+00002200: 017c 01a1 017d 087c 037c 077c 0866 0353  .|...}.|.|.|.f.S
+00002210: 0029 0761 8103 0000 0a20 2020 2047 656e  .).a.....    Gen
+00002220: 6572 6174 6520 616e 2061 7070 726f 7869  erate an approxi
+00002230: 6d61 7465 2047 6175 7373 6961 6e20 6261  mate Gaussian ba
+00002240: 7365 6420 6f6e 2073 6967 6e61 6c0a 0a20  sed on signal.. 
+00002250: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00002260: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00002270: 2078 783a 2020 2020 2020 2020 2020 6e64   xx:          nd
+00002280: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00002290: 2020 2020 2020 2058 2070 6f73 6974 696f         X positio
+000022a0: 6e73 0a20 2020 2079 793a 2020 2020 2020  ns.    yy:      
+000022b0: 2020 2020 6e64 6172 7261 790a 2020 2020      ndarray.    
+000022c0: 2020 2020 2020 2020 2020 2020 2053 6967               Sig
+000022d0: 6e61 6c20 7661 6c75 6520 6174 2074 6865  nal value at the
+000022e0: 2070 6f73 6974 696f 6e73 0a20 2020 2063   positions.    c
+000022f0: 656e 7465 725f 7479 7065 3a20 7374 720a  enter_type: str.
+00002300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002310: 2044 6566 6175 6c74 2069 7320 6043 4f4d   Default is `COM
+00002320: 6020 7768 6963 6820 7573 6573 2074 6865  ` which uses the
+00002330: 2063 656e 7465 720a 2020 2020 2020 2020   center.        
+00002340: 2020 2020 2020 2020 206f 6620 6d61 7373           of mass
+00002350: 206f 6620 7468 6520 6769 7665 6e20 706f   of the given po
+00002360: 7369 7469 6f6e 7320 746f 2067 656e 6572  sitions to gener
+00002370: 6174 650a 2020 2020 2020 2020 2020 2020  ate.            
+00002380: 2020 2020 2074 6865 2073 7461 7274 696e       the startin
+00002390: 6720 6761 7573 7369 616e 2063 656e 7465  g gaussian cente
+000023a0: 722e 2054 6865 206f 7468 6572 206f 7074  r. The other opt
+000023b0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+000023c0: 2020 2020 2069 7320 606d 6178 696d 6160       is `maxima`
+000023d0: 2077 6869 6368 2074 616b 6573 2074 6865   which takes the
+000023e0: 206d 6178 696d 756d 2069 6e74 656e 7369   maximum intensi
+000023f0: 7479 0a20 2020 2020 2020 2020 2020 2020  ty.             
+00002400: 2020 2020 7661 6c75 6520 6173 2074 6865      value as the
+00002410: 2073 7461 7274 696e 6720 706f 696e 742e   starting point.
+00002420: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00002430: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6761    -------.    ga
+00002440: 7573 735f 696e 693a 2074 7570 6c65 0a20  uss_ini: tuple. 
+00002450: 2020 2020 2020 2020 2020 2020 2020 585f                X_
+00002460: 6365 6e74 6572 2c20 585f 7374 642c 2041  center, X_std, A
+00002470: 6d70 6c69 7475 6465 0a0a 2020 2020 4e6f  mplitude..    No
+00002480: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
+00002490: 2020 466f 7220 6120 6769 7665 6e20 6c69    For a given li
+000024a0: 7374 206f 6620 7820 706f 7369 7469 6f6e  st of x position
+000024b0: 7320 616e 6420 636f 7272 6573 706f 6e64  s and correspond
+000024c0: 696e 6720 7369 676e 616c 0a20 2020 2076  ing signal.    v
+000024d0: 616c 7565 732c 2074 6869 7320 636f 6465  alues, this code
+000024e0: 2072 6574 7572 6e73 2061 2066 6972 7374   returns a first
+000024f0: 2070 6173 7320 6170 7072 6f78 696d 6174   pass approximat
+00002500: 696f 6e20 6f66 2061 0a20 2020 2031 4420  ion of a.    1D 
+00002510: 4761 7573 7369 616e 2066 756e 6374 696f  Gaussian functio
+00002520: 6e2e 2054 6865 2063 656e 7465 7220 6f66  n. The center of
+00002530: 2074 6865 2066 756e 6374 696f 6e20 6361   the function ca
+00002540: 6e20 6569 7468 6572 0a20 2020 2062 6520  n either.    be 
+00002550: 7468 6520 6365 6e74 6572 206f 6620 6d61  the center of ma
+00002560: 7373 206f 7220 7468 6520 696e 7465 6e73  ss or the intens
+00002570: 6974 7920 6d61 7869 6d61 2c20 616e 6420  ity maxima, and 
+00002580: 6973 2075 7365 720a 2020 2020 6465 6669  is user.    defi
+00002590: 6e65 642e 0a20 2020 2072 2200 0000 7201  ned..    r"...r.
+000025a0: 0000 0072 2100 0000 7223 0000 0072 2400  ...r!...r#...r$.
+000025b0: 0000 7203 0000 0029 0a72 0500 0000 7225  ..r....).r....r%
+000025c0: 0000 0072 2600 0000 721f 0000 0072 2700  ...r&...r....r'.
+000025d0: 0000 7228 0000 0072 2900 0000 722a 0000  ..r(...r)...r*..
+000025e0: 0072 2b00 0000 722c 0000 0029 0972 2d00  .r+...r,...).r-.
+000025f0: 0000 722e 0000 0072 3000 0000 7231 0000  ..r....r0...r1..
+00002600: 0072 3200 0000 5a07 7979 5f6e 6f72 6d72  .r2...Z.yy_normr
+00002610: 3300 0000 720d 0000 0072 3400 0000 7219  3...r....r4...r.
+00002620: 0000 0072 1900 0000 721a 0000 00da 1269  ...r....r......i
+00002630: 6e69 7469 616c 697a 655f 6761 7573 7331  nitialize_gauss1
+00002640: 4442 0100 0073 1a00 0000 081e 1201 0a01  DB...s..........
+00002650: 0801 0a01 1801 0802 0c01 0c01 0e01 2001  .............. .
+00002660: 0a01 0a01 7252 0000 0063 0400 0000 0000  ....rR...c......
+00002670: 0000 0000 0000 1000 0000 0900 0000 4300  ..............C.
+00002680: 0000 7334 0100 0074 00a0 0174 00a0 027c  ..s4...t...t...|
+00002690: 00a1 01a1 017d 0474 00a0 037c 047c 0118  .....}.t...|.|..
+000026a0: 00a1 017c 026b 007d 0574 006a 047c 047c  ...|.k.}.t.j.|.|
+000026b0: 0519 0074 006a 0564 018d 027d 0674 006a  ...t.j.d...}.t.j
+000026c0: 047c 007c 0519 0074 006a 0564 018d 027d  .|.|...t.j.d...}
+000026d0: 0774 00a0 067c 07a1 017d 0874 00a0 077c  .t...|...}.t...|
+000026e0: 07a1 017d 097c 0364 026b 0272 427c 077c  ...}.|.d.k.rB|.|
+000026f0: 0918 007c 087c 0918 001b 007d 0a74 087c  ...|.|.....}.t.|
+00002700: 067c 0a64 0383 037d 0b6e 0e7c 077c 0818  .|.d...}.n.|.|..
+00002710: 007c 097c 0818 001b 007d 0a74 087c 067c  .|.|.....}.t.|.|
+00002720: 0a7c 0383 037d 0b7c 0b64 0419 007c 0218  .|...}.|.d...|..
+00002730: 0064 0464 057c 0b64 0619 0014 0066 037d  .d.d.|.d.....f.}
+00002740: 0c7c 0b64 0419 007c 0217 0064 077c 0214  .|.d...|...d.|..
+00002750: 0064 077c 0b64 0619 0014 0066 037d 0d74  .d.|.d.....f.}.t
+00002760: 096a 0a74 0b7c 067c 0a7c 0b7c 0c7c 0d66  .j.t.|.|.|.|.|.f
+00002770: 0264 0864 0864 098d 075c 027d 0e7d 0f7c  .d.d.d...\.}.}.|
+00002780: 0364 026b 0272 8c7c 0e64 0a19 007c 087c  .d.k.r.|.d...|.|
+00002790: 0918 0014 007c 0917 007c 0e64 0a3c 007c  .....|...|.d.<.|
+000027a0: 0e64 0a19 007c 097c 0818 0014 007c 0817  .d...|.|.....|..
+000027b0: 007c 0e64 0a3c 007c 0e53 0029 0b61 4204  .|.d.<.|.S.).aB.
+000027c0: 0000 0a20 2020 2046 6974 2061 2032 4420  ...    Fit a 2D 
+000027d0: 6761 7573 7369 616e 2074 6f20 6120 6d61  gaussian to a ma
+000027e0: 736b 6564 2069 6d61 6765 2062 6173 6564  sked image based
+000027f0: 206f 6e0a 2020 2020 7468 6520 6c6f 6361   on.    the loca
+00002800: 7469 6f6e 206f 6620 7468 6520 6d61 736b  tion of the mask
+00002810: 2c20 7369 7a65 206f 6620 7468 6520 6d61  , size of the ma
+00002820: 736b 2061 6e64 0a20 2020 2074 6865 2074  sk and.    the t
+00002830: 7970 6520 6f66 2074 6865 206d 6173 6b0a  ype of the mask.
+00002840: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00002850: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00002860: 2020 2073 6967 6e61 6c3a 2020 2020 2020     signal:      
+00002870: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00002880: 2020 2020 2020 2020 2054 6865 2031 4420           The 1D 
+00002890: 7369 676e 616c 2074 6861 7420 7769 6c6c  signal that will
+000028a0: 2062 6520 6669 7474 6564 2077 6974 6820   be fitted with 
+000028b0: 7468 6520 4761 7573 7369 616e 0a20 2020  the Gaussian.   
+000028c0: 2070 6f73 6974 696f 6e3a 2020 2020 666c   position:    fl
+000028d0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+000028e0: 2020 2020 2078 2063 656e 7465 7220 6f66       x center of
+000028f0: 2074 6865 206d 6173 6b0a 2020 2020 6d61   the mask.    ma
+00002900: 736b 5f77 6964 7468 3a20 2066 6c6f 6174  sk_width:  float
+00002910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002920: 2020 5468 6520 7369 7a65 206f 6620 7468    The size of th
+00002930: 6520 6d61 736b 2e0a 2020 2020 6365 6e74  e mask..    cent
+00002940: 6572 5f74 7970 653a 2073 7472 0a20 2020  er_type: str.   
+00002950: 2020 2020 2020 2020 2020 2020 2020 4365                Ce
+00002960: 6e74 6572 206c 6f63 6174 696f 6e20 666f  nter location fo
+00002970: 7220 7468 6520 6669 7273 7420 7061 7373  r the first pass
+00002980: 206f 6620 7468 6520 4761 7573 7369 616e   of the Gaussian
+00002990: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000029a0: 2020 2044 6566 6175 6c74 2069 7320 6043     Default is `C
+000029b0: 4f4d 602c 2077 6869 6c65 2074 6865 206f  OM`, while the o
+000029c0: 7468 6572 206f 7074 696f 6e73 2061 7265  ther options are
+000029d0: 2060 6d69 6e69 6d61 600a 2020 2020 2020   `minima`.      
+000029e0: 2020 2020 2020 2020 2020 206f 7220 606d             or `m
+000029f0: 6178 696d 6160 2e0a 0a20 2020 2052 6574  axima`...    Ret
+00002a00: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00002a10: 0a20 2020 2070 6f70 743a 2074 7570 6c65  .    popt: tuple
+00002a20: 0a20 2020 2020 2020 2020 2052 6566 696e  .          Refin
+00002a30: 6564 2058 2070 6f73 6974 696f 6e2c 2053  ed X position, S
+00002a40: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+00002a50: 6e2c 2041 6d70 6c69 7475 6465 0a0a 2020  n, Amplitude..  
+00002a60: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
+00002a70: 2d0a 2020 2020 5468 6973 2063 6f64 6520  -.    This code 
+00002a80: 7573 6573 2074 6865 2060 7363 6970 792e  uses the `scipy.
+00002a90: 6f70 7469 6d69 7a65 2e63 7572 7665 5f66  optimize.curve_f
+00002aa0: 6974 6020 6d6f 6475 6c65 2074 6f20 6669  it` module to fi
+00002ab0: 7420 6120 3144 0a20 2020 2047 6175 7373  t a 1D.    Gauss
+00002ac0: 6961 6e20 7065 616b 2074 6f20 6d61 736b  ian peak to mask
+00002ad0: 6564 2064 6174 612e 2060 6d61 736b 5f78  ed data. `mask_x
+00002ae0: 6020 7265 6665 7273 2074 6f20 7468 6520  ` refers to the 
+00002af0: 696e 6974 6961 6c0a 2020 2020 7374 6172  initial.    star
+00002b00: 7469 6e67 2070 6f73 6974 696f 6e2e 2041  ting position. A
+00002b10: 6c73 6f2c 2074 6869 7320 6361 6e20 7461  lso, this can ta
+00002b20: 6b65 2069 6e20 606d 696e 696d 6160 2061  ke in `minima` a
+00002b30: 7320 6120 7374 7269 6e67 0a20 2020 2066  s a string.    f
+00002b40: 6f72 2069 6e69 7469 616c 697a 696e 6720  or initializing 
+00002b50: 4761 7573 7369 616e 2070 6561 6b73 2e0a  Gaussian peaks..
+00002b60: 0a20 2020 2053 6565 2061 6c73 6f0a 2020  .    See also.  
+00002b70: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066    --------.    f
+00002b80: 6974 5f67 6175 7373 6961 6e32 445f 6d61  it_gaussian2D_ma
+00002b90: 736b 0a20 2020 2069 6e69 7469 616c 697a  sk.    initializ
+00002ba0: 655f 6761 7573 7331 440a 2020 2020 6761  e_gauss1D.    ga
+00002bb0: 7573 7369 616e 5f31 445f 6675 6e63 7469  ussian_1D_functi
+00002bc0: 6f6e 0a0a 2020 2020 3a41 7574 686f 7273  on..    :Authors
+00002bd0: 3a0a 2020 2020 4465 6261 6e67 7368 7520  :.    Debangshu 
+00002be0: 4d75 6b68 6572 6a65 6520 3c6d 756b 6865  Mukherjee <mukhe
+00002bf0: 726a 6565 6440 6f72 6e6c 2e67 6f76 3e0a  rjeed@ornl.gov>.
+00002c00: 2020 2020 721c 0000 0072 3700 0000 7222      r....r7...r"
+00002c10: 0000 0072 0100 0000 7238 0000 0072 3900  ...r....r8...r9.
+00002c20: 0000 723b 0000 0072 3c00 0000 723d 0000  ..r;...r<...r=..
+00002c30: 0072 0400 0000 290c 7205 0000 005a 0661  .r....).r....Z.a
+00002c40: 7261 6e67 65da 036c 656e 722b 0000 0072  range..lenr+...r
+00002c50: 4000 0000 721e 0000 0072 4100 0000 7225  @...r....rA...r%
+00002c60: 0000 0072 5200 0000 7242 0000 0072 4300  ...rR...rB...rC.
+00002c70: 0000 7251 0000 0029 10da 0673 6967 6e61  ..rQ...)...signa
+00002c80: 6cda 0870 6f73 6974 696f 6e5a 0a6d 6173  l..positionZ.mas
+00002c90: 6b5f 7769 6474 6872 3000 0000 7246 0000  k_widthr0...rF..
+00002ca0: 0072 4700 0000 7248 0000 005a 0d6d 6173  .rG...rH...Z.mas
+00002cb0: 6b65 645f 7369 676e 616c 7249 0000 0072  ked_signalrI...r
+00002cc0: 4a00 0000 5a0b 6361 6c63 5f73 6967 6e61  J...Z.calc_signa
+00002cd0: 6c72 4b00 0000 724c 0000 0072 4d00 0000  lrK...rL...rM...
+00002ce0: 724e 0000 0072 4f00 0000 7219 0000 0072  rN...rO...r....r
+00002cf0: 1900 0000 721a 0000 00da 1366 6974 5f67  ....r......fit_g
+00002d00: 6175 7373 6961 6e31 445f 6d61 736b 7001  aussian1D_maskp.
+00002d10: 0000 733a 0000 0010 2812 0114 0114 010a  ..s:....(.......
+00002d20: 010a 0108 0110 010e 0110 020c 011a 010a  ................
+00002d30: 0206 010a 0104 fd04 0502 0102 0102 0102  ................
+00002d40: 0106 0102 0102 010a f908 0918 0118 0104  ................
+00002d50: 0172 5600 0000 2901 7221 0000 0029 0272  .rV...).r!...).r
+00002d60: 3600 0000 7221 0000 0029 115a 056e 756d  6...r!...).Z.num
+00002d70: 7079 7205 0000 005a 0e73 6369 7079 2e6f  pyr....Z.scipy.o
+00002d80: 7074 696d 697a 65da 086f 7074 696d 697a  ptimize..optimiz
+00002d90: 6572 4200 0000 5a0d 7363 6970 792e 6e64  erB...Z.scipy.nd
+00002da0: 696d 6167 655a 076e 6469 6d61 6765 5a04  imageZ.ndimageZ.
+00002db0: 7363 6e64 da08 7374 656d 746f 6f6c 7228  scnd..stemtoolr(
+00002dc0: 0000 0072 1b00 0000 7220 0000 0072 3500  ...r....r ...r5.
+00002dd0: 0000 7250 0000 0072 5100 0000 7252 0000  ..rP...rQ...rR..
+00002de0: 0072 5600 0000 7219 0000 0072 1900 0000  .rV...r....r....
+00002df0: 7219 0000 0072 1a00 0000 da08 3c6d 6f64  r....r......<mod
+00002e00: 756c 653e 0100 0000 7318 0000 0008 000c  ule>....s.......
+00002e10: 010c 0108 0108 0308 390a 3c02 3b0a ff08  ........9.<.;...
+00002e20: 660a 260e 2e                             f.&..
```

## Comparing `stemtool/util/__pycache__/image_utils.cpython-39.pyc` & `stemtool/util/__pycache__/image_utils.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:51:32 2023 UTC, .py size: 23884 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 6% similar despite different names*

```diff
@@ -1,1366 +1,1373 @@
-00000000: 610d 0d0a 0000 0000 243e e163 4c5d 0000  a.......$>.cL]..
+00000000: 6f0d 0d0a 0000 0000 4f76 6f64 ee5d 0000  o.......Ovod.]..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 6601 0000 6400  .....@...sf...d.
+00000020: 0003 0000 0040 0000 0073 5601 0000 6400  .....@...sV...d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c04 6d05 5a06 0100 6400 6401 6c07  d.l.m.Z...d.d.l.
 00000050: 6d08 5a09 0100 6400 6401 6c0a 6d0b 5a0c  m.Z...d.d.l.m.Z.
-00000060: 0100 6400 6401 6c0d 6d0e 5a0f 0100 6400  ..d.d.l.m.Z...d.
-00000070: 6401 6c10 6d11 5a12 0100 6400 6401 6c13  d.l.m.Z...d.d.l.
-00000080: 6d14 5a15 0100 6400 6401 6c16 6d17 5a18  m.Z...d.d.l.m.Z.
-00000090: 0100 6400 6401 6c19 6d1a 5a1b 0100 6400  ..d.d.l.m.Z...d.
-000000a0: 6401 6c1c 5a1d 6402 6403 8400 5a1e 6404  d.l.Z.d.d...Z.d.
-000000b0: 6405 8400 5a1f 6442 6407 6408 8401 5a20  d...Z.dBd.d...Z 
-000000c0: 6443 640b 640c 8401 5a21 640d 640e 8400  dCd.d...Z!d.d...
-000000d0: 5a22 640f 6410 8400 5a23 6411 6412 8400  Z"d.d...Z#d.d...
-000000e0: 5a24 6444 6414 6415 8401 5a25 6445 6417  Z$dDd.d...Z%dEd.
-000000f0: 6418 8401 5a26 6446 641a 641b 8401 5a27  d...Z&dFd.d...Z'
-00000100: 6447 641c 641d 8401 5a28 641e 641f 8400  dGd.d...Z(d.d...
-00000110: 5a29 6448 6421 6422 8401 5a2a 6423 6424  Z)dHd!d"..Z*d#d$
-00000120: 8400 5a2b 6425 6426 8400 5a2c 6427 6428  ..Z+d%d&..Z,d'd(
-00000130: 8400 5a2d 6429 642a 8400 5a2e 6449 642c  ..Z-d)d*..Z.dId,
-00000140: 642d 8401 5a2f 642e 642f 8400 5a30 6430  d-..Z/d.d/..Z0d0
-00000150: 6431 8400 5a31 6432 6433 8400 5a32 6434  d1..Z1d2d3..Z2d4
-00000160: 6435 8400 5a33 644a 6438 6439 8401 5a34  d5..Z3dJd8d9..Z4
-00000170: 643a 643b 8400 5a35 643c 643d 8400 5a36  d:d;..Z5d<d=..Z6
-00000180: 643e 643f 8400 5a37 6440 6441 8400 5a38  d>d?..Z7d@dA..Z8
-00000190: 6401 5300 294b e900 0000 004e 6303 0000  d.S.)K.....Nc...
-000001a0: 0000 0000 0000 0000 000d 0000 0006 0000  ................
-000001b0: 0043 0000 0073 fa00 0000 7400 a001 7c00  .C...s....t...|.
-000001c0: 6a02 a101 a003 7404 a101 7d03 7400 a005  j.....t...}.t...
-000001d0: 7c03 6401 1900 0b00 6402 1b00 7c03 6401  |.d.....d...|.d.
-000001e0: 1900 6402 1b00 6403 1800 7c03 6401 1900  ..d...d...|.d...
-000001f0: a103 7d04 7c04 7c03 6401 1900 a003 7400  ..}.|.|.d.....t.
-00000200: 6a06 a101 1b00 7d04 7400 a005 7c03 6403  j.....}.t...|.d.
-00000210: 1900 0b00 6402 1b00 7c03 6403 1900 6402  ....d...|.d...d.
-00000220: 1b00 6403 1800 7c03 6403 1900 a103 7d05  ..d...|.d.....}.
-00000230: 7c05 7c03 6403 1900 a003 7400 6a06 a101  |.|.d.....t.j...
-00000240: 1b00 7d05 7400 a007 7c05 7c04 a102 5c02  ..}.t...|.|...\.
-00000250: 7d06 7d07 7400 a008 7c06 7c01 a102 7400  }.}.t...|.|...t.
-00000260: a008 7c07 7c02 a102 1700 7d08 7400 a009  ..|.|.....}.t...
-00000270: 6404 7400 6a0a 1400 6405 1400 7c08 1400  d.t.j...d...|...
-00000280: a101 7d09 7400 6a0b a00c 7400 6a0b a00d  ..}.t.j...t.j...
-00000290: 7c00 a101 a101 7d0a 7400 a008 7c09 7c0a  |.....}.t...|.|.
-000002a0: a102 7d0b 7400 6a0b a00e 7c0b a101 7d0c  ..}.t.j...|...}.
-000002b0: 7c0c 5300 2906 6142 0300 000a 2020 2020  |.S.).aB....    
-000002c0: 4d6f 7665 2049 6d61 6765 7320 7769 7468  Move Images with
-000002d0: 2073 7562 2d70 6978 656c 2070 7265 6369   sub-pixel preci
-000002e0: 7369 6f6e 0a0a 2020 2020 5061 7261 6d65  sion..    Parame
-000002f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-00000300: 2d2d 2d0a 2020 2020 696d 6167 655f 746f  ---.    image_to
-00000310: 5f6d 6f76 653a 206e 6461 7272 6179 0a20  _move: ndarray. 
-00000320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000330: 2020 4f72 6967 696e 616c 2049 6d61 6765    Original Image
-00000340: 2074 6f20 6265 206d 6f76 6564 0a20 2020   to be moved.   
-00000350: 2078 5f70 6978 656c 733a 2066 6c6f 6174   x_pixels: float
-00000360: 0a20 2020 2020 2020 2020 2020 2020 2050  .              P
-00000370: 6978 656c 7320 746f 2073 6869 6674 2069  ixels to shift i
-00000380: 6e20 5820 6469 7265 6374 696f 6e0a 2020  n X direction.  
-00000390: 2020 795f 7069 7865 6c73 3a20 666c 6f61    y_pixels: floa
-000003a0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-000003b0: 5069 7865 6c73 2074 6f20 5368 6966 7420  Pixels to Shift 
-000003c0: 696e 2059 2064 6972 6563 7469 6f6e 0a0a  in Y direction..
-000003d0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000003e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6d6f 7665  -------.    move
-000003f0: 645f 696d 6167 653a 206e 6461 7272 6179  d_image: ndarray
-00000400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000410: 2020 4d6f 7665 6420 496d 6167 650a 0a20    Moved Image.. 
-00000420: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
-00000430: 2d2d 0a20 2020 2054 6865 2075 6e64 6572  --.    The under
-00000440: 6c79 696e 6720 6964 6561 2069 7320 7468  lying idea is th
-00000450: 6174 2061 2073 6869 6674 2069 6e20 7468  at a shift in th
-00000460: 6520 7265 616c 2073 7061 6365 0a20 2020  e real space.   
-00000470: 2069 7320 7068 6173 6520 7368 6966 7420   is phase shift 
-00000480: 696e 2046 6f75 7269 6572 2073 7061 6365  in Fourier space
-00000490: 2e20 536f 2077 6520 7461 6b65 2074 6865  . So we take the
-000004a0: 206f 7269 6769 6e61 6c0a 2020 2020 696d   original.    im
-000004b0: 6167 652c 2061 6e64 2074 616b 6520 6974  age, and take it
-000004c0: 2773 2046 6f75 7269 6572 2074 7261 6e73  's Fourier trans
-000004d0: 666f 726d 2e20 416c 736f 2c20 7765 2063  form. Also, we c
-000004e0: 616c 6375 6c61 7465 0a20 2020 2068 6f77  alculate.    how
-000004f0: 206d 7563 6820 7468 6520 696d 6167 6520   much the image 
-00000500: 7368 6966 7473 2072 6573 756c 7420 696e  shifts result in
-00000510: 2074 6865 2070 6861 7365 2063 6861 6e67   the phase chang
-00000520: 652c 2062 790a 2020 2020 6361 6c63 756c  e, by.    calcul
-00000530: 6174 696e 6720 7468 6520 466f 7572 6965  ating the Fourie
-00000540: 7220 7069 7865 6c20 6469 6d65 6e73 696f  r pixel dimensio
-00000550: 6e73 2e20 5765 2074 6865 6e20 6d75 6c74  ns. We then mult
-00000560: 6970 6c79 0a20 2020 2074 6865 2046 4654  iply.    the FFT
-00000570: 206f 6620 7468 6520 696d 6167 6520 7769   of the image wi
-00000580: 7468 2074 6865 2070 6861 7365 2073 6869  th the phase shi
-00000590: 6674 2076 616c 7565 2061 6e64 2074 6865  ft value and the
-000005a0: 6e0a 2020 2020 7461 6b65 2074 6865 2069  n.    take the i
-000005b0: 6e76 6572 7365 2046 4654 2e0a 0a20 2020  nverse FFT...   
-000005c0: 203a 4175 7468 6f72 733a 0a20 2020 2044   :Authors:.    D
-000005d0: 6562 616e 6773 6875 204d 756b 6865 726a  ebangshu Mukherj
-000005e0: 6565 203c 6d75 6b68 6572 6a65 6564 406f  ee <mukherjeed@o
-000005f0: 726e 6c2e 676f 763e 0a20 2020 2072 0100  rnl.gov>.    r..
-00000600: 0000 e902 0000 00e9 0100 0000 e9fe ffff  ................
-00000610: ff79 0000 0000 0000 0000 0000 0000 0000  .y..............
-00000620: f03f 290f da02 6e70 da07 6173 6172 7261  .?)...np..asarra
-00000630: 79da 0573 6861 7065 da06 6173 7479 7065  y..shape..astype
-00000640: da03 696e 745a 086c 696e 7370 6163 65da  ..intZ.linspace.
-00000650: 0766 6c6f 6174 3634 5a08 6d65 7368 6772  .float64Z.meshgr
-00000660: 6964 da08 6d75 6c74 6970 6c79 da03 6578  id..multiply..ex
-00000670: 70da 0270 69da 0366 6674 5a08 6666 7473  p..pi..fftZ.ffts
-00000680: 6869 6674 da04 6666 7432 da05 6966 6674  hift..fft2..ifft
-00000690: 3229 0d5a 0d69 6d61 6765 5f74 6f5f 6d6f  2).Z.image_to_mo
-000006a0: 7665 5a08 785f 7069 7865 6c73 5a08 795f  veZ.x_pixelsZ.y_
-000006b0: 7069 7865 6c73 da0a 696d 6167 655f 7369  pixels..image_si
-000006c0: 7a65 5a0d 666f 7572 6965 725f 6361 6c5f  zeZ.fourier_cal_
-000006d0: 795a 0d66 6f75 7269 6572 5f63 616c 5f78  yZ.fourier_cal_x
-000006e0: 5a0e 666f 7572 6965 725f 6d65 7368 5f78  Z.fourier_mesh_x
-000006f0: 5a0e 666f 7572 6965 725f 6d65 7368 5f79  Z.fourier_mesh_y
-00000700: 5a0b 6d6f 7665 5f6d 6174 7269 785a 0a6d  Z.move_matrixZ.m
-00000710: 6f76 655f 7068 6173 655a 126f 7269 6769  ove_phaseZ.origi
-00000720: 6e61 6c5f 696d 6167 655f 6666 745a 106d  nal_image_fftZ.m
-00000730: 6f76 6564 5f69 6e5f 666f 7572 6965 725a  oved_in_fourierZ
-00000740: 0b6d 6f76 6564 5f69 6d61 6765 a900 7212  .moved_image..r.
-00000750: 0000 00fa 3f62 7569 6c64 2f62 6469 7374  ....?build/bdist
-00000760: 2e6d 6163 6f73 782d 3130 2e39 2d78 3836  .macosx-10.9-x86
-00000770: 5f36 342f 6567 672f 7374 656d 746f 6f6c  _64/egg/stemtool
-00000780: 2f75 7469 6c2f 696d 6167 655f 7574 696c  /util/image_util
-00000790: 732e 7079 da0d 6d6f 7665 5f62 795f 7068  s.py..move_by_ph
-000007a0: 6173 650e 0000 0073 2400 0000 001f 1201  ase....s$.......
-000007b0: 0401 20ff 0403 1401 0401 20ff 0403 1401  .. ....... .....
-000007c0: 1001 0e01 04ff 0603 1801 1401 0c01 0c01  ................
-000007d0: 7214 0000 0063 0100 0000 0000 0000 0000  r....c..........
-000007e0: 0000 0200 0000 0500 0000 4300 0000 7336  ..........C...s6
-000007f0: 0000 0074 006a 017c 0074 006a 0264 018d  ...t.j.|.t.j.d..
-00000800: 027d 017c 0074 00a0 037c 00a1 0118 0074  .}.|.t...|.....t
-00000810: 00a0 047c 00a1 0174 00a0 037c 00a1 0118  ...|...t...|....
-00000820: 001b 007d 017c 0153 0029 0261 5b02 0000  ...}.|.S.).a[...
-00000830: 0a20 2020 204e 6f72 6d61 6c69 7a69 6e67  .    Normalizing
-00000840: 2049 6d61 6765 0a0a 2020 2020 5061 7261   Image..    Para
-00000850: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00000860: 2d2d 2d2d 2d0a 2020 2020 696d 6167 655f  -----.    image_
-00000870: 6f72 6967 3a20 6e64 6172 7261 790a 2020  orig: ndarray.  
-00000880: 2020 2020 2020 2020 2020 2020 2020 2769                'i
-00000890: 6d61 6765 5f6f 7269 6727 2069 7320 7468  mage_orig' is th
-000008a0: 6520 6f72 6967 696e 616c 2069 6e70 7574  e original input
-000008b0: 2069 6d61 6765 2074 6f20 6265 206e 6f72   image to be nor
-000008c0: 6d61 6c69 7a65 640a 0a20 2020 2052 6574  malized..    Ret
-000008d0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-000008e0: 0a20 2020 2069 6d61 6765 5f6e 6f72 6d3a  .    image_norm:
-000008f0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00000900: 2020 2020 2020 2020 204e 6f72 6d61 6c69           Normali
-00000910: 7a65 6420 496d 6167 650a 0a20 2020 204e  zed Image..    N
-00000920: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-00000930: 2020 2057 6520 6e6f 726d 616c 697a 6520     We normalize 
-00000940: 6120 7265 616c 2076 616c 7565 6420 696d  a real valued im
-00000950: 6167 6520 6865 7265 0a20 2020 2073 6f20  age here.    so 
-00000960: 7468 6174 2069 7427 7320 7661 6c75 6573  that it's values
-00000970: 206c 6965 2062 6574 7765 656e 206f 2061   lie between o a
-00000980: 6e64 2031 2e0a 2020 2020 5468 6973 2069  nd 1..    This i
-00000990: 7320 646f 6e65 2062 7920 6669 7273 7420  s done by first 
-000009a0: 7375 6274 7261 6374 696e 6720 7468 650a  subtracting the.
-000009b0: 2020 2020 6d69 6e69 6d75 6d20 7661 6c75      minimum valu
-000009c0: 6520 6f66 2074 6865 2069 6d61 6765 2066  e of the image f
-000009d0: 726f 6d20 7468 650a 2020 2020 696d 6167  rom the.    imag
-000009e0: 6520 6974 7365 6c66 2c20 616e 6420 7468  e itself, and th
-000009f0: 656e 2073 7562 7365 7175 656e 746c 790a  en subsequently.
-00000a00: 2020 2020 6469 7669 6469 6e67 2074 6865      dividing the
-00000a10: 2069 6d61 6765 2062 7920 7468 6520 6d61   image by the ma
-00000a20: 7869 6d75 6d20 7661 6c75 650a 2020 2020  ximum value.    
-00000a30: 6f66 2074 6865 2073 7562 7472 6163 7465  of the subtracte
-00000a40: 6420 696d 6167 652e 0a0a 2020 2020 3a41  d image...    :A
-00000a50: 7574 686f 7273 3a0a 2020 2020 4465 6261  uthors:.    Deba
-00000a60: 6e67 7368 7520 4d75 6b68 6572 6a65 6520  ngshu Mukherjee 
-00000a70: 3c6d 756b 6865 726a 6565 6440 6f72 6e6c  <mukherjeed@ornl
-00000a80: 2e67 6f76 3e0a 0a20 2020 20a9 01da 0564  .gov>..    ....d
-00000a90: 7479 7065 2905 7205 0000 00da 0a7a 6572  type).r......zer
-00000aa0: 6f73 5f6c 696b 6572 0a00 0000 da04 616d  os_liker......am
-00000ab0: 696e da04 616d 6178 2902 da0a 696d 6167  in..amax)...imag
-00000ac0: 655f 6f72 6967 da0a 696d 6167 655f 6e6f  e_orig..image_no
-00000ad0: 726d 7212 0000 0072 1200 0000 7213 0000  rmr....r....r...
-00000ae0: 00da 1069 6d61 6765 5f6e 6f72 6d61 6c69  ...image_normali
-00000af0: 7a65 7241 0000 0073 0a00 0000 001c 1001  zerA...s........
-00000b00: 0c01 12ff 0403 721c 0000 00e9 4000 0000  ......r.....@...
-00000b10: 6302 0000 0000 0000 0000 0000 0006 0000  c...............
-00000b20: 0004 0000 0043 0000 0073 5200 0000 6401  .....C...sR...d.
-00000b30: 7c01 1300 7d02 7400 6a01 a002 7c00 a101  |...}.t.j...|...
-00000b40: 7d03 7403 6a04 7c03 7403 6a05 6402 8d02  }.t.j.|.t.j.d...
-00000b50: 7d04 7403 6a04 7c03 7403 6a05 6402 8d02  }.t.j.|.t.j.d...
-00000b60: 7d05 6403 7c02 6403 1800 7c03 1400 1700  }.d.|.d...|.....
-00000b70: 7d04 7403 a006 7c04 a101 7d05 7c05 5300  }.t...|...}.|.S.
-00000b80: 2904 61df 0100 000a 2020 2020 4e6f 726d  ).a.....    Norm
-00000b90: 616c 697a 6564 206c 6f67 206f 6620 696d  alized log of im
-00000ba0: 6167 650a 0a20 2020 2050 6172 616d 6574  age..    Paramet
-00000bb0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00000bc0: 2d2d 0a20 2020 2069 6d61 6765 5f6f 7269  --.    image_ori
-00000bd0: 673a 206e 6461 7272 6179 0a20 2020 2020  g: ndarray.     
-00000be0: 2020 2020 2020 2020 2020 204e 756d 7079             Numpy
-00000bf0: 2061 7272 6179 206f 6620 7265 616c 2076   array of real v
-00000c00: 616c 7565 6420 696d 6167 650a 2020 2020  alued image.    
-00000c10: 6269 745f 6465 7074 683a 2069 6e74 0a20  bit_depth: int. 
-00000c20: 2020 2020 2020 2020 2020 2020 2020 4269                Bi
-00000c30: 7420 6465 7074 6820 6f66 206f 7574 7075  t depth of outpu
-00000c40: 7420 696d 6167 650a 2020 2020 2020 2020  t image.        
-00000c50: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
-00000c60: 7320 3332 0a0a 2020 2020 5265 7475 726e  s 32..    Return
-00000c70: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-00000c80: 2020 696d 6167 655f 6c6f 673a 206e 6461    image_log: nda
-00000c90: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00000ca0: 2020 2020 4e6f 726d 616c 697a 6564 206c      Normalized l
-00000cb0: 6f67 0a0a 2020 2020 4e6f 7465 730a 2020  og..    Notes.  
-00000cc0: 2020 2d2d 2d2d 2d0a 2020 2020 4e6f 726d    -----.    Norm
-00000cd0: 616c 697a 6520 7468 6520 696d 6167 652c  alize the image,
-00000ce0: 2061 6e64 2073 6361 6c65 2069 7420 325e   and scale it 2^
-00000cf0: 3020 746f 2032 5e62 6974 5f64 6570 7468  0 to 2^bit_depth
-00000d00: 2e0a 2020 2020 5461 6b65 206c 6f67 3220  ..    Take log2 
-00000d10: 6f66 2074 6865 2073 6361 6c65 6420 696d  of the scaled im
-00000d20: 6167 652e 0a0a 2020 2020 3a41 7574 686f  age...    :Autho
-00000d30: 7273 3a0a 2020 2020 4465 6261 6e67 7368  rs:.    Debangsh
-00000d40: 7520 4d75 6b68 6572 6a65 6520 3c6d 756b  u Mukherjee <muk
-00000d50: 6865 726a 6565 6440 6f72 6e6c 2e67 6f76  herjeed@ornl.gov
-00000d60: 3e0a 2020 2020 7202 0000 0072 1500 0000  >.    r....r....
-00000d70: 7203 0000 0029 07da 0273 74da 0475 7469  r....)...st..uti
-00000d80: 6c72 1c00 0000 7205 0000 0072 1700 0000  lr....r....r....
-00000d90: 720a 0000 00da 046c 6f67 3229 0672 1a00  r......log2).r..
-00000da0: 0000 da09 6269 745f 6465 7074 685a 0762  ....bit_depthZ.b
-00000db0: 6974 5f6d 6178 721b 0000 005a 0b69 6d61  it_maxr....Z.ima
-00000dc0: 6765 5f73 6361 6c65 5a09 696d 6167 655f  ge_scaleZ.image_
-00000dd0: 6c6f 6772 1200 0000 7212 0000 0072 1300  logr....r....r..
-00000de0: 0000 da0f 696d 6167 655f 6c6f 6761 7269  ....image_logari
-00000df0: 7a65 7264 0000 0073 0e00 0000 0019 0801  zerd...s........
-00000e00: 0c01 1001 1001 1001 0a01 7222 0000 0072  ..........r"...r
-00000e10: 0300 0000 e910 2700 0063 0300 0000 0000  ......'..c......
-00000e20: 0000 0000 0000 0a00 0000 0600 0000 4300  ..............C.
-00000e30: 0000 73a4 0000 0074 006a 0164 017c 006a  ..s....t.j.d.|.j
-00000e40: 0264 0119 0085 0264 017c 006a 0264 0219  .d.....d.|.j.d..
-00000e50: 0085 0266 0219 005c 027d 037d 0474 00a0  ...f...\.}.}.t..
-00000e60: 037c 03a1 017d 0574 047c 0183 0144 005d  .|...}.t.|...D.]
-00000e70: 667d 0474 00a0 057c 00a1 017d 067c 007c  f}.t...|...}.|.|
-00000e80: 0618 007d 0774 00a0 037c 037c 0764 016b  ...}.t...|.|.d.k
-00000e90: 0219 00a1 017d 087c 087c 057c 021b 006b  .....}.|.|.|...k
-00000ea0: 0072 7e74 00a0 057c 077c 0764 016b 0419  .r~t...|.|.d.k..
-00000eb0: 00a1 017d 097c 077c 0918 007d 0764 017c  ...}.|.|...}.d.|
-00000ec0: 077c 0764 016b 003c 007c 077c 0917 007c  .|.d.k.<.|.|...|
-00000ed0: 0617 007d 0071 387c 0053 0029 0361 e602  ...}.q8|.S.).a..
-00000ee0: 0000 0a20 2020 2052 656d 6f76 6520 6465  ...    Remove de
-00000ef0: 6164 2070 6978 656c 730a 0a20 2020 2050  ad pixels..    P
-00000f00: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000f10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2069 6d61  --------.    ima
-00000f20: 6765 5f6f 7269 673a 206e 6461 7272 6179  ge_orig: ndarray
-00000f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000f40: 204e 756d 7079 2061 7272 6179 206f 6620   Numpy array of 
-00000f50: 7265 616c 2076 616c 7565 6420 696d 6167  real valued imag
-00000f60: 650a 2020 2020 6974 6572 5f63 6f75 6e74  e.    iter_count
-00000f70: 3a20 696e 740a 2020 2020 2020 2020 2020  : int.          
-00000f80: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
-00000f90: 6974 6572 6174 696f 6e73 2074 6f20 7275  iterations to ru
-00000fa0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-00000fb0: 2020 7468 6520 7072 6f63 6573 732e 2044    the process. D
-00000fc0: 6566 6175 6c74 2069 7320 310a 2020 2020  efault is 1.    
-00000fd0: 6c65 7665 6c3a 2020 2020 2020 696e 742c  level:      int,
-00000fe0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-00000ff0: 2020 2020 2020 5261 7469 6f20 6f66 206d        Ratio of m
-00001000: 696e 696d 6120 7069 7865 6c73 2074 6f20  inima pixels to 
-00001010: 746f 7461 6c0a 2020 2020 2020 2020 2020  total.          
-00001020: 2020 2020 2020 7069 7865 6c73 2e20 4465        pixels. De
-00001030: 6661 756c 7420 6973 2031 302c 3030 300a  fault is 10,000.
-00001040: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00001050: 202d 2d2d 2d2d 2d2d 0a20 2020 2069 6d61   -------.    ima
-00001060: 6765 5f6f 7269 673a 206e 6461 7272 6179  ge_orig: ndarray
-00001070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001080: 2049 6d61 6765 2077 6974 6820 6465 6164   Image with dead
-00001090: 2070 6978 656c 7320 636f 6e76 6572 7465   pixels converte
-000010a0: 640a 0a20 2020 204e 6f74 6573 0a20 2020  d..    Notes.   
-000010b0: 202d 2d2d 2d2d 0a20 2020 2053 7562 7472   -----.    Subtr
-000010c0: 6163 7420 7468 6520 6d69 6e69 6d61 2066  act the minima f
-000010d0: 726f 6d20 7468 6520 696d 6167 652c 2061  rom the image, a
-000010e0: 6e64 2069 6620 7468 650a 2020 2020 6e75  nd if the.    nu
-000010f0: 6d62 6572 206f 6620 7069 7865 6c73 2077  mber of pixels w
-00001100: 6974 6820 6d69 6e69 6d61 2076 616c 7565  ith minima value
-00001110: 7320 6973 206c 6573 7320 7468 616e 0a20  s is less than. 
-00001120: 2020 2074 6865 2031 2f6c 6576 656c 206f     the 1/level o
-00001130: 6620 7468 6520 746f 7461 6c20 7069 7865  f the total pixe
-00001140: 6c73 2c20 7468 656e 2074 686f 7365 2061  ls, then those a
-00001150: 7265 0a20 2020 2064 6563 6964 6564 2074  re.    decided t
-00001160: 6f20 6265 2064 6561 6420 7069 7865 6c73  o be dead pixels
-00001170: 2e20 4974 6572 6174 6520 6966 206e 6563  . Iterate if nec
-00001180: 6573 7361 7279 0a0a 2020 2020 3a41 7574  essary..    :Aut
-00001190: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
-000011a0: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
-000011b0: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
-000011c0: 6f76 3e0a 2020 2020 7201 0000 0072 0300  ov>.    r....r..
-000011d0: 0000 2906 7205 0000 00da 056d 6772 6964  ..).r......mgrid
-000011e0: 7207 0000 00da 0473 697a 65da 0572 616e  r......size..ran
-000011f0: 6765 7218 0000 0029 0a72 1a00 0000 5a0a  ger....).r....Z.
-00001200: 6974 6572 5f63 6f75 6e74 da05 6c65 7665  iter_count..leve
-00001210: 6cda 0270 70da 015f 5a09 6e6f 5f70 6f69  l..pp.._Z.no_poi
-00001220: 6e74 735a 0c6f 7269 6769 6e61 6c5f 6d69  ntsZ.original_mi
-00001230: 6e5a 0969 6d61 6765 5f70 6f73 5a09 6e6f  nZ.image_posZ.no
-00001240: 5f6d 696e 696d 615a 0b6e 6577 5f6d 696e  _minimaZ.new_min
-00001250: 696d 756d 7212 0000 0072 1200 0000 7213  imumr....r....r.
-00001260: 0000 00da 1272 656d 6f76 655f 6465 6164  .....remove_dead
-00001270: 5f70 6978 656c 7386 0000 0073 1800 0000  _pixels....s....
-00001280: 001e 2601 0a01 0c01 0a01 0801 1201 0c01  ..&.............
-00001290: 1201 0801 0c01 0e01 722a 0000 0063 0100  ........r*...c..
-000012a0: 0000 0000 0000 0000 0000 0600 0000 0500  ................
-000012b0: 0000 4300 0000 7388 0000 0074 006a 0174  ..C...s....t.j.t
-000012c0: 00a0 027c 00a1 0174 0364 018d 027d 0174  ...|...t.d...}.t
-000012d0: 00a0 047c 0164 0219 0064 0366 02a1 017d  ...|.d...d.f...}
-000012e0: 0274 00a0 057c 0164 0219 00a1 017c 0264  .t...|.d.....|.d
-000012f0: 0464 0485 0264 0266 023c 0074 00a0 0464  .d...d.f.<.t...d
-00001300: 037c 0164 0319 0066 02a1 017d 0374 00a0  .|.d...f...}.t..
-00001310: 057c 0164 0319 00a1 017c 0364 0264 0464  .|.d.....|.d.d.d
-00001320: 0485 0266 023c 0074 00a0 067c 027c 03a1  ...f.<.t...|.|..
-00001330: 027d 0474 00a0 067c 007c 04a1 027d 057c  .}.t...|.|...}.|
-00001340: 0553 0029 0561 6801 0000 0a20 2020 2032  .S.).ah....    2
-00001350: 4420 6861 6e6e 696e 6720 6669 6c74 6572  D hanning filter
-00001360: 2066 6f72 2069 6d61 6765 730a 0a20 2020   for images..   
-00001370: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00001380: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2069  ----------.    i
-00001390: 6d61 6765 3a20 6e64 6172 7261 790a 2020  mage: ndarray.  
-000013a0: 2020 2020 2020 2020 204f 7269 6769 6e61           Origina
-000013b0: 6c20 496d 6167 6520 6f6e 2077 6869 6368  l Image on which
-000013c0: 2074 6865 2048 616e 6e69 6e67 2066 696c   the Hanning fil
-000013d0: 7465 720a 2020 2020 2020 2020 2020 2069  ter.           i
-000013e0: 7320 746f 2062 6520 6170 706c 6965 640a  s to be applied.
-000013f0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00001400: 202d 2d2d 2d2d 2d2d 0a20 2020 2068 616e   -------.    han
-00001410: 6e65 645f 696d 6167 653a 206e 6461 7272  ned_image: ndarr
-00001420: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-00001430: 2020 2020 2049 6d61 6765 2077 6974 6820       Image with 
-00001440: 7468 6520 6861 6e6e 696e 6720 6669 6c74  the hanning filt
-00001450: 6572 2061 7070 6c69 6564 0a0a 2020 2020  er applied..    
-00001460: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-00001470: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
-00001480: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
-00001490: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
-000014a0: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 2020  eed@ornl.gov>.  
-000014b0: 2020 7215 0000 0072 0100 0000 7203 0000    r....r....r...
-000014c0: 004e 2907 7205 0000 0072 0600 0000 7207  .N).r....r....r.
-000014d0: 0000 0072 0900 0000 da05 7a65 726f 735a  ...r......zerosZ
-000014e0: 0768 616e 6e69 6e67 720b 0000 0029 06da  .hanningr....)..
-000014f0: 0569 6d61 6765 5a0a 7369 7a65 5f69 6d61  .imageZ.size_ima
-00001500: 6765 5a08 726f 775f 6861 6e6e 5a08 636f  geZ.row_hannZ.co
-00001510: 6c5f 6861 6e6e 5a0b 6861 6e6e 5f77 696e  l_hannZ.hann_win
-00001520: 646f 77da 0c68 616e 6e65 645f 696d 6167  dow..hanned_imag
-00001530: 6572 1200 0000 7212 0000 0072 1300 0000  er....r....r....
-00001540: 722d 0000 00b2 0000 0073 1000 0000 0016  r-.......s......
-00001550: 1401 1201 1a01 1201 1a01 0c01 0c01 722d  ..............r-
-00001560: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00001570: 0500 0000 0500 0000 4300 0000 7334 0000  ........C...s4..
-00001580: 007c 006a 007d 017c 016a 017d 0274 02a0  .|.j.}.|.j.}.t..
-00001590: 037c 01a1 017d 037c 036a 0464 0164 0264  .|...}.|.j.d.d.d
-000015a0: 0364 048d 037d 047c 026a 057c 007c 0464  .d...}.|.j.|.|.d
-000015b0: 058d 0253 0029 064e da05 7269 6768 747a  ...S.).N..rightz
-000015c0: 0235 2567 9a99 9999 9999 a93f 2902 7225  .5%g.......?).r%
-000015d0: 0000 00da 0370 6164 2901 da03 6361 7829  .....pad)...cax)
-000015e0: 065a 0461 7865 735a 0666 6967 7572 65da  .Z.axesZ.figure.
-000015f0: 056d 706c 6178 5a13 6d61 6b65 5f61 7865  .mplaxZ.make_axe
-00001600: 735f 6c6f 6361 7461 626c 655a 0b61 7070  s_locatableZ.app
-00001610: 656e 645f 6178 6573 5a08 636f 6c6f 7262  end_axesZ.colorb
-00001620: 6172 2905 5a08 6d61 7070 6162 6c65 5a02  ar).Z.mappableZ.
-00001630: 6178 5a03 6669 675a 0764 6976 6964 6572  axZ.figZ.divider
-00001640: 7230 0000 0072 1200 0000 7212 0000 0072  r0...r....r....r
-00001650: 1300 0000 da0d 7361 6e65 5f63 6f6c 6f72  ......sane_color
-00001660: 6261 72d2 0000 0073 0a00 0000 0001 0601  bar....s........
-00001670: 0601 0a01 1001 7232 0000 0063 0100 0000  ......r2...c....
-00001680: 0000 0000 0000 0000 0800 0000 0700 0000  ................
-00001690: 4300 0000 7388 0100 0074 006a 0174 00a0  C...s....t.j.t..
-000016a0: 027c 00a1 0174 0364 018d 027d 0174 00a0  .|...t.d...}.t..
-000016b0: 047c 0164 0219 007c 0164 0319 0064 0466  .|.d...|.d...d.f
-000016c0: 03a1 017d 027c 0064 0574 006a 0514 0017  ...}.|.d.t.j....
-000016d0: 0064 0574 006a 0514 001b 007c 0264 0064  .d.t.j.....|.d.d
-000016e0: 0085 0264 0064 0085 0264 0266 033c 007c  ...d.d...d.f.<.|
-000016f0: 0264 0064 0085 0264 0064 0085 0264 0266  .d.d...d.d...d.f
-00001700: 0319 0074 00a0 067c 0264 0064 0085 0264  ...t...|.d.d...d
-00001710: 0064 0085 0264 0266 0319 00a1 0118 007c  .d...d.f.......|
-00001720: 0264 0064 0085 0264 0064 0085 0264 0266  .d.d...d.d...d.f
-00001730: 033c 0074 07a0 087c 02a1 017d 037c 0364  .<.t...|...}.|.d
-00001740: 0064 0085 0264 0064 0085 0264 0266 0319  .d...d.d...d.f..
-00001750: 007c 0364 0064 0085 0264 0064 0085 0264  .|.d.d...d.d...d
-00001760: 0366 0319 007c 0364 0064 0085 0264 0064  .f...|.d.d...d.d
-00001770: 0085 0264 0566 0319 0003 0002 007d 047d  ...d.f.......}.}
-00001780: 057d 0664 067c 0414 0064 077c 0514 0017  .}.d.|...d.|....
-00001790: 0064 087c 0614 0017 007d 077c 077d 0774  .d.|.....}.|.}.t
-000017a0: 00a0 097c 0264 0064 0085 0264 0064 0085  ...|.d.d...d.d..
-000017b0: 0264 0566 0319 007c 07a1 027c 0264 0064  .d.f...|...|.d.d
-000017c0: 0085 0264 0064 0085 0264 0566 033c 007c  ...d.d...d.f.<.|
-000017d0: 0264 0064 0085 0264 0064 0085 0264 0566  .d.d...d.d...d.f
-000017e0: 0319 0074 00a0 0a7c 0264 0064 0085 0264  ...t...|.d.d...d
-000017f0: 0064 0085 0264 0566 0319 00a1 011b 007c  .d...d.f.......|
-00001800: 0264 0064 0085 0264 0064 0085 0264 0566  .d.d...d.d...d.f
-00001810: 033c 0074 07a0 087c 02a1 017d 037c 0353  .<.t...|...}.|.S
-00001820: 0029 094e 7215 0000 0072 0100 0000 7203  .).Nr....r....r.
-00001830: 0000 00e9 0300 0000 7202 0000 0067 c58f  ........r....g..
-00001840: 3177 2d21 d33f 6762 1058 39b4 c8e2 3f67  1w-!.?gb.X9...?g
-00001850: c976 be9f 1a2f bd3f 290b 7205 0000 0072  .v.../.?).r....r
-00001860: 0600 0000 7207 0000 0072 0900 0000 da04  ....r....r......
-00001870: 6f6e 6573 720d 0000 00da 0566 6c6f 6f72  onesr......floor
-00001880: da04 6d70 6c63 da0a 6873 765f 746f 5f72  ..mplc..hsv_to_r
-00001890: 6762 da06 6469 7669 6465 7219 0000 0029  gb..divider....)
-000018a0: 085a 0b70 6861 7365 5f69 6d61 6765 5a07  .Z.phase_imageZ.
-000018b0: 7369 7a65 5f69 6d5a 0668 7376 5f69 6d5a  size_imZ.hsv_imZ
-000018c0: 0672 6762 5f69 6dda 0172 da01 67da 0162  .rgb_im..r..g..b
-000018d0: 5a07 6772 6179 5f69 6d72 1200 0000 7212  Z.gray_imr....r.
-000018e0: 0000 0072 1300 0000 da0b 7068 6173 655f  ...r......phase_
-000018f0: 636f 6c6f 72da 0000 0073 1800 0000 0001  color....s......
-00001900: 1401 1801 2a01 4401 0a01 4601 1801 0401  ....*.D...F.....
-00001910: 3001 4401 0a01 723c 0000 00e9 0800 0000  0.D...r<........
-00001920: 6305 0000 0000 0000 0000 0000 000a 0000  c...............
-00001930: 0007 0000 0043 0000 0073 b200 0000 6401  .....C...s....d.
-00001940: 7c04 1300 7d05 7400 a001 7c02 7c05 a102  |...}.t...|.|...
-00001950: 7d06 7c03 6400 6b02 722e 7402 a003 7402  }.|.d.k.r.t...t.
-00001960: a004 7c00 a101 a101 7d07 6e04 7c03 7d07  ..|.....}.n.|.}.
-00001970: 6402 7c00 6401 7c07 1400 1b00 1700 7d00  d.|.d.|.......}.
-00001980: 7402 a005 7c06 7c00 8301 6400 6400 8502  t...|.|...d.d...
-00001990: 6400 6400 8502 6403 6404 8502 6603 1900  d.d...d.d...f...
-000019a0: a101 7d08 7406 a007 7c08 a101 7d09 7c01  ..}.t...|...}.|.
-000019b0: 7402 a008 7c01 a101 1800 7402 a003 7c01  t...|.....t...|.
-000019c0: a101 7402 a008 7c01 a101 1800 1b00 7c09  ..t...|.......|.
-000019d0: 6400 6400 8502 6400 6400 8502 6405 6603  d.d...d.d...d.f.
-000019e0: 3c00 7406 a009 7c09 a101 7d08 7c08 5300  <.t...|...}.|.S.
-000019f0: 2906 4e72 0200 0000 e700 0000 0000 00e0  ).Nr............
-00001a00: 3f72 0100 0000 7233 0000 00e9 ffff ffff  ?r....r3........
-00001a10: 290a da05 6d70 6c63 6d5a 0867 6574 5f63  )...mplcmZ.get_c
-00001a20: 6d61 7072 0500 0000 7219 0000 00da 0361  mapr....r......a
-00001a30: 6273 7206 0000 0072 3600 0000 5a0a 7267  bsr....r6...Z.rg
-00001a40: 625f 746f 5f68 7376 7218 0000 0072 3700  b_to_hsvr....r7.
-00001a50: 0000 290a da04 6461 7461 722c 0000 00da  ..)...datar,....
-00001a60: 0563 6f6c 6f72 5a06 636c 696d 6974 7221  .colorZ.climitr!
-00001a70: 0000 005a 0962 6974 5f72 616e 6765 5a06  ...Z.bit_rangeZ.
-00001a80: 696d 5f6d 6170 5a08 6461 7461 5f6c 696d  im_mapZ.data_lim
-00001a90: 5a09 7267 625f 696d 6167 65da 0968 7376  Z.rgb_image..hsv
-00001aa0: 5f69 6d61 6765 7212 0000 0072 1200 0000  _imager....r....
-00001ab0: 7213 0000 00da 0b68 7376 5f6f 7665 726c  r......hsv_overl
-00001ac0: 6179 e900 0000 7316 0000 0000 0108 010c  ay....s.........
-00001ad0: 0108 0112 0204 0110 0124 010a 0134 010a  .........$...4..
-00001ae0: 0172 4500 0000 e920 0000 0063 0300 0000  .rE.... ...c....
-00001af0: 0000 0000 0000 0000 0b00 0000 0400 0000  ................
-00001b00: 4300 0000 7370 0000 0064 017c 0213 007d  C...sp...d.|...}
-00001b10: 0374 00a0 017c 01a1 017d 0474 00a0 017c  .t...|...}.t...|
-00001b20: 00a1 017d 0574 00a0 027c 04a1 017c 031b  ...}.t...|...|..
-00001b30: 007d 0674 00a0 027c 05a1 017c 031b 007d  .}.t...|...|...}
-00001b40: 077c 047c 066b 007d 087c 057c 076b 007d  .|.|.k.}.|.|.k.}
-00001b50: 0964 027c 017c 083c 0064 037c 007c 093c  .d.|.|.<.d.|.|.<
-00001b60: 0074 00a0 037c 007c 01a1 027d 0a64 037c  .t...|.|...}.d.|
-00001b70: 0a7c 083c 007c 0a53 0029 0461 5403 0000  .|.<.|.S.).aT...
-00001b80: 0a20 2020 2044 6976 6964 6520 7477 6f20  .    Divide two 
-00001b90: 7370 6172 7365 206d 6174 7269 6365 7320  sparse matrices 
-00001ba0: 656c 656d 656e 7420 7769 7365 2074 6f20  element wise to 
-00001bb0: 7072 6576 656e 7420 7a65 726f 730a 0a20  prevent zeros.. 
-00001bc0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00001bd0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00001be0: 2073 7061 7365 5f6e 756d 6572 3a20 6e64   spase_numer: nd
-00001bf0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00001c00: 2020 2020 2020 204e 756d 7079 2061 7272         Numpy arr
-00001c10: 6179 206f 6620 7265 616c 2076 616c 7565  ay of real value
-00001c20: 6420 6e75 6d65 7261 746f 720a 2020 2020  d numerator.    
-00001c30: 7370 6172 7365 5f64 656e 6f6d 3a20 6e64  sparse_denom: nd
-00001c40: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00001c50: 2020 2020 2020 2020 4e75 6d70 7920 6172          Numpy ar
-00001c60: 7261 7920 6f66 2072 6561 6c20 7661 6c75  ray of real valu
-00001c70: 6564 2064 656e 6f6d 696e 6174 6f72 0a20  ed denominator. 
-00001c80: 2020 2062 6974 5f64 6570 7468 3a20 696e     bit_depth: in
-00001c90: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00001ca0: 2042 6974 2064 6570 7468 206f 6620 6f75   Bit depth of ou
-00001cb0: 7470 7574 2069 6d61 6765 0a20 2020 2020  tput image.     
-00001cc0: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
-00001cd0: 7420 6973 2033 320a 0a20 2020 2052 6574  t is 32..    Ret
-00001ce0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00001cf0: 0a20 2020 2064 6976 6964 6564 5f6d 6174  .    divided_mat
-00001d00: 7269 783a 206e 6461 7272 6179 0a20 2020  rix: ndarray.   
-00001d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d20: 2051 756f 7469 656e 7420 6d61 7472 6978   Quotient matrix
-00001d30: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
-00001d40: 2d2d 2d2d 2d0a 2020 2020 4465 6369 6465  -----.    Decide
-00001d50: 206f 6e20 6120 6269 7420 6465 7074 6820   on a bit depth 
-00001d60: 6265 6c6f 7720 7768 6963 680a 2020 2020  below which.    
-00001d70: 7468 6520 7661 6c75 6573 2069 6e20 7468  the values in th
-00001d80: 6520 6465 6e6f 6d69 6e61 746f 7220 6172  e denominator ar
-00001d90: 650a 2020 2020 6a75 7374 206e 6f69 7365  e.    just noise
-00001da0: 2c20 6173 2074 6865 7920 6172 6520 6265  , as they are be
-00001db0: 6c6f 7720 7468 650a 2020 2020 6269 7420  low the.    bit 
-00001dc0: 6465 7074 682e 2044 6f20 7468 6520 7361  depth. Do the sa
-00001dd0: 6d65 2066 6f72 2074 6865 0a20 2020 206e  me for the.    n
-00001de0: 756d 6572 6174 6f72 2e20 5475 726e 2074  umerator. Turn t
-00001df0: 686f 7365 2076 616c 7565 7320 746f 2031  hose values to 1
-00001e00: 2069 6e0a 2020 2020 7468 6520 6465 6e6f   in.    the deno
-00001e10: 6d69 6e61 746f 7220 616e 6420 3020 696e  minator and 0 in
-00001e20: 2074 6865 206e 756d 6572 6174 6f72 2e0a   the numerator..
-00001e30: 2020 2020 5468 656e 2069 6e20 7468 6520      Then in the 
-00001e40: 7175 6f74 6965 6e74 206d 6174 7269 782c  quotient matrix,
-00001e50: 2074 7572 6e20 7468 650a 2020 2020 6465   turn the.    de
-00001e60: 6e6f 6d69 6e61 746f 7220 7661 6c75 6573  nominator values
-00001e70: 2062 656c 6f77 2074 6865 2074 6872 6573   below the thres
-00001e80: 686f 6c64 0a20 2020 2074 6f20 3020 746f  hold.    to 0 to
-00001e90: 6f2e 0a0a 2020 2020 3a41 7574 686f 7273  o...    :Authors
-00001ea0: 3a0a 2020 2020 4465 6261 6e67 7368 7520  :.    Debangshu 
-00001eb0: 4d75 6b68 6572 6a65 6520 3c6d 756b 6865  Mukherjee <mukhe
-00001ec0: 726a 6565 6440 6f72 6e6c 2e67 6f76 3e0a  rjeed@ornl.gov>.
-00001ed0: 2020 2020 7202 0000 0072 0300 0000 7201      r....r....r.
-00001ee0: 0000 0029 0472 0500 0000 7241 0000 0072  ...).r....rA...r
-00001ef0: 1900 0000 7238 0000 0029 0b5a 0c73 7061  ....r8...).Z.spa
-00001f00: 7273 655f 6e75 6d65 725a 0c73 7061 7273  rse_numerZ.spars
-00001f10: 655f 6465 6e6f 6d72 2100 0000 5a0b 6465  e_denomr!...Z.de
-00001f20: 7074 685f 7261 7469 6f5a 0964 656e 6f6d  pth_ratioZ.denom
-00001f30: 5f61 6273 5a09 6e75 6d65 725f 6162 735a  _absZ.numer_absZ
-00001f40: 0f74 6872 6573 686f 6c64 5f64 656e 6f6d  .threshold_denom
-00001f50: 5a0f 7468 7265 7368 6f6c 645f 6e75 6d65  Z.threshold_nume
-00001f60: 725a 1374 6872 6573 686f 6c64 5f69 6e64  rZ.threshold_ind
-00001f70: 5f64 656e 6f6d 5a13 7468 7265 7368 6f6c  _denomZ.threshol
-00001f80: 645f 696e 645f 6e75 6d65 725a 0e64 6976  d_ind_numerZ.div
-00001f90: 6964 6564 5f6d 6174 7269 7872 1200 0000  ided_matrixr....
-00001fa0: 7212 0000 0072 1300 0000 da0f 7370 6172  r....r......spar
-00001fb0: 7365 5f64 6976 6973 696f 6ef8 0000 0073  se_division....s
-00001fc0: 1800 0000 0022 0801 0a01 0a01 0e01 0e01  ....."..........
-00001fd0: 0801 0801 0801 0801 0c01 0801 7247 0000  ............rG..
-00001fe0: 0054 6303 0000 0000 0000 0000 0000 0008  .Tc.............
-00001ff0: 0000 0008 0000 0043 0000 0073 9000 0000  .......C...s....
-00002000: 7c02 7250 7c00 7400 a001 7c00 6401 1300  |.rP|.t...|.d...
-00002010: a101 6402 1300 1b00 7d03 7c01 7400 a001  ..d.....}.|.t...
-00002020: 7c01 6401 1300 a101 6402 1300 1b00 7d04  |.d.....d.....}.
-00002030: 7400 6a02 a003 7c03 a101 7d05 7400 a004  t.j...|...}.t...
-00002040: 7400 6a02 a003 7c04 a101 a101 7d06 6e1e  t.j...|.....}.n.
-00002050: 7400 6a02 a003 7c00 a101 7d05 7400 a004  t.j...|...}.t...
-00002060: 7400 6a02 a003 7c01 a101 a101 7d06 7400  t.j...|.....}.t.
-00002070: a005 7400 6a02 a006 7400 6a02 a007 7c05  ..t.j...t.j...|.
-00002080: 7c06 1400 a101 a101 a101 7d07 7c07 5300  |.........}.|.S.
-00002090: a903 4e72 0200 0000 723e 0000 0029 0872  ..Nr....r>...).r
-000020a0: 0500 0000 da03 7375 6d72 0e00 0000 720f  ......sumr....r.
-000020b0: 0000 00da 0463 6f6e 6a72 4100 0000 da09  .....conjrA.....
-000020c0: 6966 6674 7368 6966 7472 1000 0000 2908  ifftshiftr....).
-000020d0: da07 696d 6167 655f 31da 0769 6d61 6765  ..image_1..image
-000020e0: 5f32 da06 6e6f 726d 616c da08 696d 315f  _2..normal..im1_
-000020f0: 6e6f 726d da08 696d 325f 6e6f 726d da07  norm..im2_norm..
-00002100: 696d 315f 6666 74da 0769 6d32 5f66 6674  im1_fft..im2_fft
-00002110: da08 636f 7272 5f66 6674 7212 0000 0072  ..corr_fftr....r
-00002120: 1200 0000 7213 0000 00da 1363 726f 7373  ....r......cross
-00002130: 5f63 6f72 725f 756e 7061 6464 6564 2801  _corr_unpadded(.
-00002140: 0000 7312 0000 0000 0104 0116 0116 010c  ..s.............
-00002150: 0114 020c 0112 011e 0172 5400 0000 6304  .........rT...c.
-00002160: 0000 0000 0000 0000 0000 0011 0000 0006  ................
-00002170: 0000 0043 0000 0073 4e01 0000 7400 a001  ...C...sN...t...
-00002180: 7400 a002 7c00 a101 a101 7d04 7400 a003  t...|.....}.t...
-00002190: 7c04 6401 1b00 a101 a004 7405 a101 7d05  |.d.......t...}.
-000021a0: 7c03 7294 7c00 7400 a006 7c00 6401 1300  |.r.|.t...|.d...
-000021b0: a101 6402 1300 1b00 7d06 7400 6a07 7c06  ..d.....}.t.j.|.
-000021c0: 7c05 6403 6404 8d03 7d07 7c01 7400 a006  |.d.d...}.|.t...
-000021d0: 7c01 6401 1300 a101 6402 1300 1b00 7d08  |.d.....d.....}.
-000021e0: 7400 6a07 7c08 7c05 6403 6404 8d03 7d09  t.j.|.|.d.d...}.
-000021f0: 7400 6a08 a009 7c07 a101 7d0a 7400 a00a  t.j...|...}.t...
-00002200: 7400 6a08 a009 7c09 a101 a101 7d0b 6e3e  t.j...|.....}.n>
-00002210: 7400 6a07 7c00 7c05 6403 6404 8d03 7d07  t.j.|.|.d.d...}.
-00002220: 7400 6a07 7c01 7c05 6403 6404 8d03 7d09  t.j.|.|.d.d...}.
-00002230: 7400 6a08 a009 7c07 a101 7d0a 7400 a00a  t.j...|...}.t...
-00002240: 7400 6a08 a009 7c09 a101 a101 7d0b 7400  t.j...|.....}.t.
-00002250: a00b 7c0a 7c0b a102 7d0c 7400 a00c 7c0c  ..|.|...}.t...|.
-00002260: a101 7c02 1300 7d0d 740d 7c0c 7c0d 6405  ..|...}.t.|.|.d.
-00002270: 8303 7d0e 7400 6a08 a00e 7c0e a101 7d0f  ..}.t.j...|...}.
-00002280: 7400 a00c 7400 6a08 a00f 7c0f a101 a101  t...t.j...|.....
-00002290: 7d0f 7c0f 7c05 6406 1900 7c05 6406 1900  }.|.|.d...|.d...
-000022a0: 7c04 6406 1900 1700 8502 7c05 6407 1900  |.d.......|.d...
-000022b0: 7c05 6407 1900 7c04 6407 1900 1700 8502  |.d...|.d.......
-000022c0: 6602 1900 7d10 7c10 5300 2908 616d 0600  f...}.|.S.).am..
-000022d0: 000a 2020 2020 4e6f 726d 616c 697a 6564  ..    Normalized
-000022e0: 2043 6f72 7265 6c61 7469 6f6e 2c20 616c   Correlation, al
-000022f0: 6c6f 7769 6e67 2066 6f72 2068 7962 7269  lowing for hybri
-00002300: 6469 7a61 7469 6f6e 0a20 2020 2077 6974  dization.    wit
-00002310: 6820 6372 6f73 7320 636f 7272 656c 6174  h cross correlat
-00002320: 696f 6e20 6265 696e 6720 7468 6520 6465  ion being the de
-00002330: 6661 756c 7420 6f75 7470 7574 2069 660a  fault output if.
-00002340: 2020 2020 6e6f 2068 7962 7269 6469 7a61      no hybridiza
-00002350: 7469 6f6e 2070 6172 616d 6574 6572 2069  tion parameter i
-00002360: 7320 6769 7665 6e0a 0a20 2020 2050 6172  s given..    Par
-00002370: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00002380: 2d2d 2d2d 2d2d 0a20 2020 2069 6d61 6765  ------.    image
-00002390: 5f31 3a20 6e64 6172 7261 790a 2020 2020  _1: ndarray.    
-000023a0: 2020 2020 2020 2020 2046 6972 7374 2069           First i
-000023b0: 6d61 6765 0a20 2020 2069 6d61 6765 5f32  mage.    image_2
-000023c0: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
-000023d0: 2020 2020 2020 2053 6563 6f6e 6420 696d         Second im
-000023e0: 6167 650a 2020 2020 6879 6272 6964 697a  age.    hybridiz
-000023f0: 6572 3a20 666c 6f61 740a 2020 2020 2020  er: float.      
-00002400: 2020 2020 2020 2020 2020 4879 6272 6964            Hybrid
-00002410: 697a 6174 696f 6e20 7061 7261 6d65 7465  ization paramete
-00002420: 7220 6265 7477 6565 6e20 3020 616e 6420  r between 0 and 
-00002430: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00002440: 2020 3020 6973 2070 7572 6520 6372 6f73    0 is pure cros
-00002450: 7320 636f 7272 656c 6174 696f 6e0a 2020  s correlation.  
-00002460: 2020 2020 2020 2020 2020 2020 2020 3120                1 
-00002470: 6973 2070 7572 6520 7068 6173 6520 636f  is pure phase co
-00002480: 7272 656c 6174 696f 6e0a 0a20 2020 2052  rrelation..    R
-00002490: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-000024a0: 2d2d 0a20 2020 2063 6f72 725f 6879 6272  --.    corr_hybr
-000024b0: 6964 3a20 6e64 6172 7261 790a 2020 2020  id: ndarray.    
-000024c0: 2020 2020 2020 2020 2020 2020 2043 6f6d               Com
-000024d0: 706c 6578 2076 616c 7565 6420 636f 7272  plex valued corr
-000024e0: 656c 6174 696f 6e20 6f75 7470 7574 0a0a  elation output..
-000024f0: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
-00002500: 2d2d 2d0a 2020 2020 5468 6520 6372 6f73  ---.    The cros
-00002510: 732d 636f 7272 656c 6174 696f 6e20 7468  s-correlation th
-00002520: 656f 7265 6d20 6361 6e20 6265 2073 7461  eorem can be sta
-00002530: 7465 6420 6173 3a0a 2020 2020 2e2e 206d  ted as:.    .. m
-00002540: 6174 683a 3a0a 2020 2020 2020 2020 2047  ath::.         G
-00002550: 5f63 203d 2047 5f31 2009 696d 6573 2047  _c = G_1 .imes G
-00002560: 5f32 5e2a 0a0a 2020 2020 7768 6572 6520  _2^*..    where 
-00002570: 3a6d 6174 683a 6047 5f63 6020 6973 2074  :math:`G_c` is t
-00002580: 6865 2046 6f75 7269 6572 2074 7261 6e73  he Fourier trans
-00002590: 666f 726d 206f 6620 7468 6520 6372 6f73  form of the cros
-000025a0: 730a 2020 2020 636f 7272 656c 6174 6564  s.    correlated
-000025b0: 206d 6174 7269 7820 616e 6420 3a6d 6174   matrix and :mat
-000025c0: 683a 6047 5f31 6020 616e 6420 3a6d 6174  h:`G_1` and :mat
-000025d0: 683a 6047 5f32 6020 6172 650a 2020 2020  h:`G_2` are.    
-000025e0: 7468 6520 466f 7572 6965 7220 7472 616e  the Fourier tran
-000025f0: 7366 6f72 6d73 206f 6620 3a6d 6174 683a  sforms of :math:
-00002600: 6067 5f31 6020 616e 6420 3a6d 6174 683a  `g_1` and :math:
-00002610: 6067 5f32 600a 2020 2020 7265 7370 6563  `g_2`.    respec
-00002620: 7469 7665 6c79 2c20 7768 6963 6820 6172  tively, which ar
-00002630: 6520 7468 6520 6f72 6967 696e 616c 206d  e the original m
-00002640: 6174 7269 6365 732e 2054 6869 7320 6973  atrices. This is
-00002650: 2070 7572 650a 2020 2020 6372 6f73 732d   pure.    cross-
-00002660: 636f 7272 656c 6174 696f 6e2e 2050 6861  correlation. Pha
-00002670: 7365 2063 6f72 7265 6c61 7469 6f6e 2063  se correlation c
-00002680: 616e 2062 6520 6578 7072 6573 7365 6420  an be expressed 
-00002690: 6173 3a0a 2020 2020 2e2e 206d 6174 683a  as:.    .. math:
-000026a0: 3a0a 2020 2020 2020 2020 2047 5f63 203d  :.         G_c =
-000026b0: 200c 7261 637b 475f 3120 0969 6d65 7320   .rac{G_1 .imes 
-000026c0: 475f 325e 2a7d 7b5c 6d69 6420 475f 3120  G_2^*}{\mid G_1 
-000026d0: 0969 6d65 7320 475f 325e 2a20 5c6d 6964  .imes G_2^* \mid
-000026e0: 7d0a 0a20 2020 2054 6875 732c 2077 6520  }..    Thus, we 
-000026f0: 6361 6e20 6e6f 7720 6465 6669 6e65 2061  can now define a
-00002700: 2068 7962 7269 6420 6372 6f73 732d 636f   hybrid cross-co
-00002710: 7272 656c 6174 696f 6e20 7768 6572 650a  rrelation where.
-00002720: 2020 2020 2e2e 206d 6174 683a 3a0a 2020      .. math::.  
-00002730: 2020 2020 2020 2047 5f63 203d 200c 7261         G_c = .ra
-00002740: 637b 475f 3120 0969 6d65 7320 475f 325e  c{G_1 .imes G_2^
-00002750: 2a7d 7b5c 6d69 6420 475f 3120 0969 6d65  *}{\mid G_1 .ime
-00002760: 7320 475f 325e 2a20 5c6d 6964 205e 6e7d  s G_2^* \mid ^n}
-00002770: 0a0a 2020 2020 4966 206e 2069 7320 302c  ..    If n is 0,
-00002780: 2077 6520 6861 7665 2063 726f 7373 2063   we have cross c
-00002790: 6f72 7265 6c61 7469 6f6e 2c20 616e 6420  orrelation, and 
-000027a0: 6966 206e 2069 7320 3120 7765 0a20 2020  if n is 1 we.   
-000027b0: 2068 6176 6520 7068 6173 6520 636f 7272   have phase corr
-000027c0: 656c 6174 696f 6e2e 0a0a 2020 2020 5265  elation...    Re
-000027d0: 6665 7265 6e63 6573 0a20 2020 202d 2d2d  ferences.    ---
-000027e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 315d 5f2c  -------.    1]_,
-000027f0: 2050 656b 696e 2c20 542e 432e 2c20 4761   Pekin, T.C., Ga
-00002800: 6d6d 6572 2c20 432e 2c20 4369 7374 6f6e  mmer, C., Ciston
-00002810: 2c20 4a2e 2c20 4d69 6e6f 722c 2041 2e4d  , J., Minor, A.M
-00002820: 2e20 616e 6420 4f70 6875 732c 2043 2e2c  . and Ophus, C.,
-00002830: 0a20 2020 2020 2020 2020 3230 3137 2e20  .         2017. 
-00002840: 4f70 7469 6d69 7a69 6e67 2064 6973 6b20  Optimizing disk 
-00002850: 7265 6769 7374 7261 7469 6f6e 2061 6c67  registration alg
-00002860: 6f72 6974 686d 7320 666f 7220 6e61 6e6f  orithms for nano
-00002870: 6265 616d 0a20 2020 2020 2020 2020 656c  beam.         el
-00002880: 6563 7472 6f6e 2064 6966 6672 6163 7469  ectron diffracti
-00002890: 6f6e 2073 7472 6169 6e20 6d61 7070 696e  on strain mappin
-000028a0: 672e 2055 6c74 7261 6d69 6372 6f73 636f  g. Ultramicrosco
-000028b0: 7079 2c20 3137 362c 0a20 2020 2020 2020  py, 176,.       
-000028c0: 2020 7070 2e31 3730 2d31 3736 2e0a 0a20    pp.170-176... 
-000028d0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-000028e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073 7061  --------.    spa
-000028f0: 7273 655f 6469 7669 7369 6f6e 0a0a 2020  rse_division..  
-00002900: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
-00002910: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
-00002920: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
-00002930: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 7202  ornl.gov>.    r.
-00002940: 0000 0072 3e00 0000 da06 6d65 6469 616e  ...r>.....median
-00002950: 2902 5a09 7061 645f 7769 6474 68da 046d  ).Z.pad_width..m
-00002960: 6f64 6572 4600 0000 7201 0000 0072 0300  oderF...r....r..
-00002970: 0000 2910 7205 0000 0072 0600 0000 7207  ..).r....r....r.
-00002980: 0000 00da 0572 6f75 6e64 7208 0000 0072  .....roundr....r
-00002990: 0900 0000 7249 0000 0072 2f00 0000 720e  ....rI...r/...r.
-000029a0: 0000 0072 0f00 0000 724a 0000 0072 0b00  ...r....rJ...r..
-000029b0: 0000 7241 0000 0072 4700 0000 7210 0000  ..rA...rG...r...
-000029c0: 0072 4b00 0000 2911 724c 0000 0072 4d00  .rK...).rL...rM.
-000029d0: 0000 5a0a 6879 6272 6964 697a 6572 724e  ..Z.hybridizerrN
-000029e0: 0000 005a 0769 6d5f 7369 7a65 5a08 7061  ...Z.im_sizeZ.pa
-000029f0: 645f 7369 7a65 724f 0000 005a 0769 6d31  d_sizerO...Z.im1
-00002a00: 5f70 6164 7250 0000 005a 0769 6d32 5f70  _padrP...Z.im2_p
-00002a10: 6164 7251 0000 0072 5200 0000 7253 0000  adrQ...rR...rS..
-00002a20: 005a 0863 6f72 725f 6162 735a 0f63 6f72  .Z.corr_absZ.cor
-00002a30: 725f 6879 6272 6964 5f66 6674 5a0b 636f  r_hybrid_fftZ.co
-00002a40: 7272 5f68 7962 7269 645a 0d63 6f72 725f  rr_hybridZ.corr_
-00002a50: 756e 7061 6464 6564 7212 0000 0072 1200  unpaddedr....r..
-00002a60: 0000 7213 0000 00da 0a63 726f 7373 5f63  ..r......cross_c
-00002a70: 6f72 7235 0100 0073 2c00 0000 0039 1001  orr5...s,....9..
-00002a80: 1401 0401 1601 1001 1601 1001 0c01 1402  ................
-00002a90: 1001 1001 0c01 1201 0c01 0e01 0c01 0c01  ................
-00002aa0: 1201 0201 2eff 0403 7258 0000 0063 0400  ........rX...c..
-00002ab0: 0000 0000 0000 0000 0000 0a00 0000 0400  ................
-00002ac0: 0000 4300 0000 735e 0000 007c 0064 0119  ..C...s^...|.d..
-00002ad0: 007d 047c 0064 0219 007d 0574 006a 0164  .}.|.d...}.t.j.d
-00002ae0: 017c 0485 0264 017c 0585 0266 0219 005c  .|...d.|...f...\
-00002af0: 027d 067d 077c 067c 0218 0064 0313 007c  .}.}.|.|...d...|
-00002b00: 077c 0118 0064 0313 0017 0064 0413 007c  .|...d.....d...|
-00002b10: 036b 007d 0874 006a 027c 0874 006a 0364  .k.}.t.j.|.t.j.d
-00002b20: 058d 027d 097c 0953 0029 0661 0602 0000  ...}.|.S.).a....
-00002b30: 0a20 2020 204d 616b 6520 6120 6369 7263  .    Make a circ
-00002b40: 6c65 0a0a 2020 2020 5061 7261 6d65 7465  le..    Paramete
-00002b50: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00002b60: 2d0a 2020 2020 7369 7a65 5f63 6972 633a  -.    size_circ:
-00002b70: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00002b80: 2020 2020 2020 2020 3220 656c 656d 656e          2 elemen
-00002b90: 7420 6172 7261 7920 6769 7669 6e67 2074  t array giving t
-00002ba0: 6865 2073 697a 6520 6f66 2074 6865 206f  he size of the o
-00002bb0: 7574 7075 7420 6d61 7472 6978 0a20 2020  utput matrix.   
-00002bc0: 2063 656e 7465 725f 783a 2066 6c6f 6174   center_x: float
-00002bd0: 0a20 2020 2020 2020 2020 2020 2020 2078  .              x
-00002be0: 2070 6f73 6974 696f 6e20 6f66 2063 6972   position of cir
-00002bf0: 636c 6520 6365 6e74 6572 0a20 2020 2063  cle center.    c
-00002c00: 656e 7465 725f 793a 2066 6c6f 6174 0a20  enter_y: float. 
-00002c10: 2020 2020 2020 2020 2020 2020 2079 2070               y p
-00002c20: 6f73 6974 696f 6e20 6f66 2063 6972 636c  osition of circl
-00002c30: 6520 6365 6e74 6572 0a20 2020 2072 6164  e center.    rad
-00002c40: 6975 733a 2066 6c6f 6174 0a20 2020 2020  ius: float.     
-00002c50: 2020 2020 2020 2072 6164 6975 7320 6f66         radius of
-00002c60: 2074 6865 2063 6972 636c 650a 0a20 2020   the circle..   
-00002c70: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00002c80: 2d2d 2d2d 0a20 2020 2063 6972 636c 653a  ----.    circle:
-00002c90: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00002ca0: 2020 2020 2070 2058 2071 2073 697a 6564       p X q sized
-00002cb0: 2061 7272 6179 2077 6865 7265 2074 6865   array where the
-00002cc0: 2069 7420 6973 2031 0a20 2020 2020 2020   it is 1.       
-00002cd0: 2020 2020 2069 6e73 6964 6520 7468 6520       inside the 
-00002ce0: 6369 7263 6c65 2061 6e64 2030 206f 7574  circle and 0 out
-00002cf0: 7369 6465 0a0a 2020 2020 3a41 7574 686f  side..    :Autho
-00002d00: 7273 3a0a 2020 2020 4465 6261 6e67 7368  rs:.    Debangsh
-00002d10: 7520 4d75 6b68 6572 6a65 6520 3c6d 756b  u Mukherjee <muk
-00002d20: 6865 726a 6565 6440 6f72 6e6c 2e67 6f76  herjeed@ornl.gov
-00002d30: 3e0a 2020 2020 7201 0000 0072 0300 0000  >.    r....r....
-00002d40: 7202 0000 0072 3e00 0000 7215 0000 0029  r....r>...r....)
-00002d50: 0472 0500 0000 7224 0000 0072 0600 0000  .r....r$...r....
-00002d60: 720a 0000 0029 0a5a 0973 697a 655f 6369  r....).Z.size_ci
-00002d70: 7263 da08 6365 6e74 6572 5f78 da08 6365  rc..center_x..ce
-00002d80: 6e74 6572 5f79 da06 7261 6469 7573 da01  nter_y..radius..
-00002d90: 70da 0171 da02 7956 da02 7856 da03 7375  p..q..yV..xV..su
-00002da0: 625a 0663 6972 636c 6572 1200 0000 7212  bZ.circler....r.
-00002db0: 0000 0072 1300 0000 da0b 6d61 6b65 5f63  ...r......make_c
-00002dc0: 6972 636c 6587 0100 0073 0c00 0000 0018  ircle....s......
-00002dd0: 0801 0801 1a01 2001 1001 7261 0000 00e9  ...... ...ra....
-00002de0: 0400 0000 6303 0000 0000 0000 0000 0000  ....c...........
-00002df0: 0011 0000 0007 0000 0043 0000 0073 8c01  .........C...s..
-00002e00: 0000 7400 a001 7c00 6a02 a101 a003 7404  ..t...|.j.....t.
-00002e10: a101 7d03 7c00 7400 a005 7c00 a101 1800  ..}.|.t...|.....
-00002e20: 7400 a006 7c00 a101 7400 a005 7c00 a101  t...|...t...|...
-00002e30: 1800 1b00 7d04 7400 a007 6401 a101 7d05  ....}.t...d...}.
-00002e40: 7400 a008 7c03 6402 6401 8502 1900 6403  t...|.d.d.....d.
-00002e50: 7c01 1b00 1400 a101 7c05 6402 6401 8502  |.......|.d.d...
-00002e60: 3c00 7c05 a003 7404 a101 7d05 7400 a009  <.|...t...}.t...
-00002e70: 7c05 7c03 6401 1900 7c03 6404 1900 6602  |.|.d...|.d...f.
-00002e80: a102 7d06 7400 a007 7c06 a101 7d07 740a  ..}.t...|...}.t.
-00002e90: 7c03 6404 1900 8301 4400 5dc0 7d08 740a  |.d.....D.].}.t.
-00002ea0: 7c03 6401 1900 8301 4400 5dae 7d09 7c04  |.d.....D.].}.|.
-00002eb0: 6405 6405 8502 6405 6405 8502 7c09 7c08  d.d...d.d...|.|.
-00002ec0: 6604 1900 7d0a 7c09 7c05 6402 1900 1400  f...}.|.|.d.....
-00002ed0: 7400 a00b 7c05 6402 1900 a101 1700 7d0b  t...|.d.......}.
-00002ee0: 7404 7c0b 6402 1900 8301 7d0c 6403 7404  t.|.d.....}.d.t.
-00002ef0: 7c0b 6406 1900 8301 1700 7d0d 7c08 7c05  |.d.......}.|.|.
-00002f00: 6403 1900 1400 7400 a00b 7c05 6403 1900  d.....t...|.d...
-00002f10: a101 1700 7d0e 7404 7c0e 6402 1900 8301  ....}.t.|.d.....
-00002f20: 7d0f 6403 7404 7c0e 6406 1900 8301 1700  }.d.t.|.d.......
-00002f30: 7d10 740c 6a0d a00e 7c0a 6403 1700 7c01  }.t.j...|.d...|.
-00002f40: a102 6403 1800 7c07 7c0c 7c0d 8502 7c0f  ..d...|.|.|...|.
-00002f50: 7c10 8502 6602 3c00 71a8 7198 7c07 7400  |...f.<.q.q.|.t.
-00002f60: a005 7c07 a101 1800 7d07 6401 7c02 1300  ..|.....}.d.|...
-00002f70: 7c07 7400 a006 7c07 a101 1b00 1400 7d07  |.t...|.......}.
-00002f80: 7c07 a003 7404 a101 7d07 7c07 5300 2907  |...t...}.|.S.).
-00002f90: 7a3a 0a20 2020 2047 656e 6572 6174 6520  z:.    Generate 
-00002fa0: 6120 7469 6c65 6420 7061 7474 6572 6e20  a tiled pattern 
-00002fb0: 6f66 2074 6865 2034 442d 5354 454d 2064  of the 4D-STEM d
-00002fc0: 6174 6173 6574 0a0a 2020 2020 7202 0000  ataset..    r...
-00002fd0: 0072 0100 0000 7203 0000 0072 3300 0000  .r....r....r3...
-00002fe0: 4e72 3f00 0000 290f 7205 0000 0072 0600  Nr?...).r....r..
-00002ff0: 0000 7207 0000 0072 0800 0000 7209 0000  ..r....r....r...
-00003000: 0072 1800 0000 7219 0000 0072 2b00 0000  .r....r....r+...
-00003010: 7257 0000 0072 0b00 0000 7226 0000 00da  rW...r....r&....
-00003020: 0661 7261 6e67 6572 1e00 0000 721f 0000  .aranger....r...
-00003030: 00da 0972 6573 697a 6572 3244 2911 5a0a  ...resizer2D).Z.
-00003040: 6461 7461 7365 745f 3444 da07 7265 6475  dataset_4D..redu
-00003050: 6365 7272 2100 0000 5a09 7369 7a65 5f64  cerr!...Z.size_d
-00003060: 6174 615a 0d6e 6f72 6d61 6c69 7a65 645f  ataZ.normalized_
-00003070: 3444 5a0c 7265 6475 6365 645f 7369 7a65  4DZ.reduced_size
-00003080: 5a09 7469 6c65 5f73 697a 655a 0a69 6d61  Z.tile_sizeZ.ima
-00003090: 6765 5f74 696c 65da 026a 6ada 0269 69da  ge_tile..jj..ii.
-000030a0: 0672 6f6e 6368 695a 0678 5261 6e67 655a  .ronchiZ.xRangeZ
-000030b0: 0678 5374 6172 745a 0478 456e 645a 0679  .xStartZ.xEndZ.y
-000030c0: 5261 6e67 655a 0679 5374 6172 745a 0479  RangeZ.yStartZ.y
-000030d0: 456e 6472 1200 0000 7212 0000 0072 1300  Endr....r....r..
-000030e0: 0000 da0b 696d 6167 655f 7469 6c65 72a7  ....image_tiler.
-000030f0: 0100 0073 3000 0000 0005 1201 0c01 12ff  ...s0...........
-00003100: 0403 0a01 2201 0a01 1801 0a01 1001 1001  ...."...........
-00003110: 1801 1a01 0c01 1001 1a01 0c01 1002 14ff  ................
-00003120: 1603 0e01 1601 0a01 7269 0000 0063 0100  ........ri...c..
-00003130: 0000 0000 0000 0000 0000 0700 0000 0800  ................
-00003140: 0000 4300 0000 7396 0000 0074 00a0 017c  ..C...s....t...|
-00003150: 006a 02a1 01a0 0374 04a1 017d 0174 00a0  .j.....t...}.t..
-00003160: 057c 0164 0119 007c 0164 0219 007c 0164  .|.d...|.d...|.d
-00003170: 0319 007c 0164 0419 0066 04a1 017d 0274  ...|.d...f...}.t
-00003180: 067c 0164 0419 0083 0144 005d 507d 0374  .|.d.....D.]P}.t
-00003190: 067c 0164 0319 0083 0144 005d 3e7d 047c  .|.d.....D.]>}.|
-000031a0: 0064 0564 0585 0264 0564 0585 027c 047c  .d.d...d.d...|.|
-000031b0: 0366 0419 007d 0574 00a0 077c 05a1 017d  .f...}.t...|...}
-000031c0: 067c 067c 0264 0564 0585 0264 0564 0585  .|.|.d.d...d.d..
-000031d0: 027c 047c 0366 043c 0071 5071 407c 0253  .|.|.f.<.qPq@|.S
-000031e0: 0029 0661 db01 0000 0a20 2020 2043 6f72  .).a.....    Cor
-000031f0: 7265 6374 696e 6720 496d 6167 6520 466c  recting Image Fl
-00003200: 6970 0a0a 2020 2020 5061 7261 6d65 7465  ip..    Paramete
-00003210: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00003220: 2d0a 2020 2020 696d 6167 655f 6f72 6967  -.    image_orig
-00003230: 3a20 6e64 6172 7261 790a 2020 2020 2020  : ndarray.      
-00003240: 2020 2020 2020 2020 2020 2764 6174 6134            'data4
-00003250: 4427 2069 7320 7468 6520 6f72 6967 696e  D' is the origin
-00003260: 616c 2034 4420 6461 7461 7365 7420 696e  al 4D dataset in
-00003270: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00003280: 2020 2020 2066 6f72 6d20 4469 6666 582c       form DiffX,
-00003290: 4469 6666 592c 5363 616e 582c 5363 616e  DiffY,ScanX,Scan
-000032a0: 590a 0a20 2020 2052 6574 7572 6e73 0a20  Y..    Returns. 
-000032b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2069     -------.    i
-000032c0: 6d61 6765 5f6e 6f72 6d3a 206e 6461 7272  mage_norm: ndarr
-000032d0: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-000032e0: 2020 2046 6c69 7020 636f 7272 6563 7465     Flip correcte
-000032f0: 6420 3444 2064 6174 6173 6574 0a0a 2020  d 4D dataset..  
-00003300: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
-00003310: 2d0a 2020 2020 5468 6520 6d69 6372 6f73  -.    The micros
-00003320: 636f 7065 206c 656e 7365 7320 6d61 7920  cope lenses may 
-00003330: 6164 6420 6120 666c 6970 2069 6e0a 2020  add a flip in.  
-00003340: 2020 7468 6520 5820 6469 7265 6374 696f    the X directio
-00003350: 6e20 6f66 2074 6865 2072 6f6e 6368 6967  n of the ronchig
-00003360: 7261 6d2e 2054 6869 730a 2020 2020 636f  ram. This.    co
-00003370: 7272 6563 7473 2066 6f72 2074 6861 742e  rrects for that.
-00003380: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
-00003390: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
-000033a0: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
-000033b0: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 0a20  eed@ornl.gov>.. 
-000033c0: 2020 2072 0100 0000 7203 0000 0072 0200     r....r....r..
-000033d0: 0000 7233 0000 004e 2908 7205 0000 0072  ..r3...N).r....r
-000033e0: 0600 0000 7207 0000 0072 0800 0000 7209  ....r....r....r.
-000033f0: 0000 0072 2b00 0000 7226 0000 005a 0666  ...r+...r&...Z.f
-00003400: 6c69 706c 7229 075a 0664 6174 6134 445a  liplr).Z.data4DZ
-00003410: 0864 6174 6173 697a 655a 0966 6c69 7070  .datasizeZ.flipp
-00003420: 6564 3444 7266 0000 0072 6700 0000 7268  ed4Drf...rg...rh
-00003430: 0000 005a 0b72 6f6e 6368 695f 666c 6970  ...Z.ronchi_flip
-00003440: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
-00003450: 0e66 6c69 705f 636f 7272 6563 746f 72c7  .flip_corrector.
-00003460: 0100 0073 1000 0000 0019 1201 2201 1001  ...s........"...
-00003470: 1001 1801 0a01 1c01 726a 0000 0063 0100  ........rj...c..
-00003480: 0000 0000 0000 0000 0000 0400 0000 0300  ................
-00003490: 0000 4300 0000 731e 0000 007c 0064 0113  ..C...s....|.d..
-000034a0: 007d 0174 00a0 017c 01a1 017d 027c 0264  .}.t...|...}.|.d
-000034b0: 0213 007d 037c 0353 0072 4800 0000 2902  ...}.|.S.rH...).
-000034c0: 7205 0000 00da 046d 6561 6e29 045a 0361  r......mean).Z.a
-000034d0: 7272 5a06 6172 725f 7371 5a08 6172 725f  rrZ.arr_sqZ.arr_
-000034e0: 6d65 616e 5a07 6172 725f 726d 7372 1200  meanZ.arr_rmsr..
-000034f0: 0000 7212 0000 0072 1300 0000 da09 6172  ..r....r......ar
-00003500: 7261 795f 726d 73ea 0100 0073 0800 0000  ray_rms....s....
-00003510: 0001 0801 0a01 0801 726c 0000 0063 0100  ........rl...c..
-00003520: 0000 0000 0000 0000 0000 0b00 0000 0600  ................
-00003530: 0000 4300 0000 73bc 0000 0074 006a 01a0  ..C...s....t.j..
-00003540: 027c 00a1 015c 027d 017d 0274 036a 0464  .|...\.}.}.t.j.d
-00003550: 017c 016a 0564 0119 0085 0264 017c 016a  .|.j.d.....d.|.j
-00003560: 0564 0219 0085 0266 0219 005c 027d 037d  .d.....f...\.}.}
-00003570: 0474 03a0 0674 076a 08a0 097c 01a1 01a1  .t...t.j...|....
-00003580: 015c 027d 057d 067c 037c 0518 0064 0313  .\.}.}.|.|...d..
-00003590: 007c 047c 0618 0064 0313 0017 0064 0413  .|.|...d.....d..
-000035a0: 007d 0774 006a 01a0 0a74 03a0 0b7c 07a1  .}.t.j...t...|..
-000035b0: 0174 03a0 0b7c 01a1 0164 05a1 037d 0874  .t...|...d...}.t
-000035c0: 0c6a 0d74 006a 016a 0e74 03a0 0b7c 07a1  .j.t.j.j.t...|..
-000035d0: 0174 03a0 0b7c 01a1 017c 0864 068d 045c  .t...|...|.d...\
-000035e0: 027d 097d 027c 0964 0119 007d 0a7c 067c  .}.}.|.d...}.|.|
-000035f0: 057c 0a66 0353 0029 074e 7201 0000 0072  .|.f.S.).Nr....r
-00003600: 0300 0000 7202 0000 0072 3e00 0000 5a06  ....r....r>...Z.
-00003610: 6d61 7869 6d61 2903 5a05 7864 6174 615a  maxima).Z.xdataZ
-00003620: 0579 6461 7461 5a02 7030 290f 721e 0000  .ydataZ.p0).r...
-00003630: 0072 1f00 0000 5a05 736f 6265 6c72 0500  .r....Z.sobelr..
-00003640: 0000 7224 0000 0072 0700 0000 7206 0000  ..r$...r....r...
-00003650: 00da 0473 636e 645a 0c6d 6561 7375 7265  ...scndZ.measure
-00003660: 6d65 6e74 735a 0e63 656e 7465 725f 6f66  mentsZ.center_of
-00003670: 5f6d 6173 735a 1269 6e69 7469 616c 697a  _massZ.initializ
-00003680: 655f 6761 7573 7331 44da 0572 6176 656c  e_gauss1D..ravel
-00003690: da03 7370 6fda 0963 7572 7665 5f66 6974  ..spo..curve_fit
-000036a0: 5a14 6761 7573 7369 616e 5f31 445f 6675  Z.gaussian_1D_fu
-000036b0: 6e63 7469 6f6e 290b 722c 0000 005a 0b73  nction).r,...Z.s
-000036c0: 6f62 656c 5f69 6d61 6765 7229 0000 00da  obel_imager)....
-000036d0: 0279 79da 0278 7872 5a00 0000 7259 0000  .yy..xxrZ...rY..
-000036e0: 005a 0272 72da 0d69 6e69 7469 616c 5f67  .Z.rr..initial_g
-000036f0: 7565 7373 da04 706f 7074 725b 0000 0072  uess..poptr[...r
-00003700: 1200 0000 7212 0000 0072 1300 0000 da0c  ....r....r......
-00003710: 736f 6265 6c5f 6369 7263 6c65 f101 0000  sobel_circle....
-00003720: 731e 0000 0000 0110 0126 0116 011c 0106  s........&......
-00003730: 0112 ff04 0304 0106 0108 0108 0102 fc0a  ................
-00003740: 0608 0172 7500 0000 6304 0000 0000 0000  ...ru...c.......
-00003750: 0000 0000 0007 0000 0004 0000 0043 0000  .............C..
-00003760: 0073 4800 0000 7c00 6401 1900 7c01 1800  .sH...|.d...|...
-00003770: 7d04 7c00 6402 1900 7c02 1800 7d05 7c04  }.|.d...|...}.|.
-00003780: 6403 1300 7c05 6403 1300 1700 6404 1300  d...|.d.....d...
-00003790: 7d06 6401 7c06 7c06 7c03 6b04 3c00 6402  }.d.|.|.|.k.<.d.
-000037a0: 7c06 7c06 6401 6b04 3c00 7c06 5300 2905  |.|.d.k.<.|.S.).
-000037b0: 4e72 0100 0000 7203 0000 0072 0200 0000  Nr....r....r....
-000037c0: 723e 0000 0072 1200 0000 2907 da02 7879  r>...r....)...xy
-000037d0: 5a02 7830 5a02 7930 725b 0000 0072 7200  Z.x0Z.y0r[...rr.
-000037e0: 0000 7271 0000 00da 027a 7a72 1200 0000  ..rq.....zzr....
-000037f0: 7212 0000 0072 1300 0000 da0f 6369 7263  r....r......circ
-00003800: 6c65 5f66 756e 6374 696f 6e03 0200 0073  le_function....s
-00003810: 0c00 0000 0001 0c01 0c01 1401 0c01 0c01  ................
-00003820: 7278 0000 00e9 3200 0000 6302 0000 0000  rx....2...c.....
-00003830: 0000 0000 0000 000d 0000 0007 0000 0043  ...............C
-00003840: 0000 0073 1801 0000 7c00 a000 7401 6a02  ...s....|...t.j.
-00003850: a101 7d00 7c01 7401 a003 7c00 a101 1400  ..}.|.t...|.....
-00003860: 7c00 7c00 7c01 7401 a003 7c00 a101 1400  |.|.|.t...|.....
-00003870: 6b04 3c00 7401 a003 7c00 a101 7c01 1b00  k.<.t...|...|...
-00003880: 7c00 7c00 7401 a003 7c00 a101 7c01 1b00  |.|.t...|...|...
-00003890: 6b00 3c00 7c00 7401 a004 7c00 a101 1800  k.<.|.t...|.....
-000038a0: 7401 a005 7c00 a101 7401 a004 7c00 a101  t...|...t...|...
-000038b0: 1800 1b00 7d02 7401 a006 7401 a007 7c00  ....}.t...t...|.
-000038c0: a101 a101 a000 7401 6a02 a101 7d03 7c03  ......t.j...}.|.
-000038d0: 6401 1900 6402 1b00 7d04 7c03 6403 1900  d...d...}.|.d...
-000038e0: 6402 1b00 7d05 7401 a008 7c02 a101 7401  d...}.t...|...t.
-000038f0: 6a09 1b00 6404 1300 7d06 7c04 7c05 7c06  j...d...}.|.|.|.
-00003900: 6603 7d07 7401 6a0a 6403 740b 7c03 6403  f.}.t.j.d.t.|.d.
-00003910: 1900 8301 8502 6403 740b 7c03 6401 1900  ......d.t.|.d...
-00003920: 8301 8502 6602 1900 5c02 7d08 7d09 7401  ....f...\.}.}.t.
-00003930: a00c 7c09 a101 7401 a00c 7c08 a101 6602  ..|...t...|...f.
-00003940: 7d0a 740d a00e 740f 7c0a 7401 a00c 7c02  }.t...t.|.t...|.
-00003950: a101 7c07 a104 5c02 7d0b 7d0c 7c0b 5300  ..|...\.}.}.|.S.
-00003960: 2905 4e72 0300 0000 7202 0000 0072 0100  ).Nr....r....r..
-00003970: 0000 723e 0000 0029 1072 0800 0000 7205  ..r>...).r....r.
-00003980: 0000 0072 0a00 0000 7255 0000 0072 1800  ...r....rU...r..
-00003990: 0000 7219 0000 0072 0600 0000 7207 0000  ..r....r....r...
-000039a0: 0072 4900 0000 720d 0000 0072 2400 0000  .rI...r....r$...
-000039b0: 7209 0000 0072 6e00 0000 726f 0000 0072  r....rn...ro...r
-000039c0: 7000 0000 7278 0000 0029 0d5a 0a69 6d61  p...rx...).Z.ima
-000039d0: 6765 5f64 6174 615a 0a6d 6564 5f66 6163  ge_dataZ.med_fac
-000039e0: 746f 725a 0a63 616c 635f 696d 6167 6572  torZ.calc_imager
-000039f0: 1100 0000 5a09 696e 6974 6961 6c5f 785a  ....Z.initial_xZ
-00003a00: 0969 6e69 7469 616c 5f79 5a0e 696e 6974  .initial_yZ.init
-00003a10: 6961 6c5f 7261 6469 7573 7273 0000 0072  ial_radiusrs...r
-00003a20: 5e00 0000 725f 0000 0072 7600 0000 7274  ^...r_...rv...rt
-00003a30: 0000 0072 2900 0000 7212 0000 0072 1200  ...r)...r....r..
-00003a40: 0000 7213 0000 00da 0a66 6974 5f63 6972  ..r......fit_cir
-00003a50: 636c 650c 0200 0073 2600 0000 0001 0c03  cle....s&.......
-00003a60: 0cfe 0201 10ff 0204 0cff 1403 0c01 12ff  ................
-00003a70: 0403 1801 0c01 0c01 1401 0a01 2a01 1401  ............*...
-00003a80: 1a01 727a 0000 0063 0200 0000 0000 0000  ..rz...c........
-00003a90: 0000 0000 0800 0000 0500 0000 4300 0000  ............C...
-00003aa0: 73b2 0000 007c 006a 007d 027c 00a0 0174  s....|.j.}.|...t
-00003ab0: 026a 03a1 017d 0074 026a 0474 057c 0183  .j...}.t.j.t.|..
-00003ac0: 0174 026a 0364 018d 027d 0364 027d 0464  .t.j.d...}.d.}.d
-00003ad0: 027d 0574 0674 057c 0183 0183 0144 005d  .}.t.t.|.....D.]
-00003ae0: 6a7d 067c 047d 077c 057c 0114 007c 067c  j}.|.}.|.|...|.|
-00003af0: 0214 0018 007c 026b 0072 6c7c 077c 007c  .....|.k.rl|.|.|
-00003b00: 0519 0037 007d 077c 0564 0337 007d 0571  ...7.}.|.d.7.}.q
-00003b10: 427c 057c 0664 0317 007c 0214 007c 011b  B|.|.d...|...|..
-00003b20: 0018 007c 007c 0564 0318 0019 0014 007d  ...|.|.d.......}
-00003b30: 047c 077c 0438 007d 077c 077c 0114 007c  .|.|.8.}.|.|...|
-00003b40: 021b 007c 037c 063c 0071 3a7c 03a0 017c  ...|.|.<.q:|...|
-00003b50: 006a 07a1 0153 0029 0461 0301 0000 0a20  .j...S.).a..... 
-00003b60: 2020 2044 6f77 6e73 616d 706c 6520 3144     Downsample 1D
-00003b70: 2061 7272 6179 0a0a 2020 2020 5061 7261   array..    Para
-00003b80: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00003b90: 2d2d 2d2d 2d0a 2020 2020 6461 7461 3a20  -----.    data: 
-00003ba0: 6e64 6172 7261 790a 2020 2020 4e3a 2020  ndarray.    N:  
-00003bb0: 2020 696e 740a 2020 2020 2020 2020 2020    int.          
-00003bc0: 4e65 7720 7369 7a65 206f 6620 6172 7261  New size of arra
-00003bd0: 790a 0a20 2020 2052 6574 7572 6e73 0a20  y..    Returns. 
-00003be0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2072     -------.    r
-00003bf0: 6573 3a20 6e64 6172 7261 7920 6f66 2073  es: ndarray of s
-00003c00: 6861 7065 204e 0a20 2020 2020 2020 2020  hape N.         
-00003c10: 4461 7461 2072 6573 616d 706c 6564 0a0a  Data resampled..
-00003c20: 0a20 2020 203a 4175 7468 6f72 733a 0a20  .    :Authors:. 
-00003c30: 2020 2044 6562 616e 6773 6875 204d 756b     Debangshu Muk
-00003c40: 6865 726a 6565 203c 6d75 6b68 6572 6a65  herjee <mukherje
-00003c50: 6564 406f 726e 6c2e 676f 763e 0a20 2020  ed@ornl.gov>.   
-00003c60: 2072 1500 0000 7201 0000 0072 0300 0000   r....r....r....
-00003c70: 2908 7225 0000 0072 0800 0000 7205 0000  ).r%...r....r...
-00003c80: 0072 0a00 0000 722b 0000 0072 0900 0000  .r....r+...r....
-00003c90: 7226 0000 0072 1600 0000 2908 7242 0000  r&...r....).rB..
-00003ca0: 00da 014e da01 4dda 0372 6573 5a05 6361  ...N..M..resZ.ca
-00003cb0: 7272 79da 016d da01 6e5a 0864 6174 615f  rry..m..nZ.data_
-00003cc0: 7375 6d72 1200 0000 7212 0000 0072 1300  sumr....r....r..
-00003cd0: 0000 da07 7265 7369 7a65 7222 0200 0073  ....resizer"...s
-00003ce0: 1c00 0000 0013 0601 0c01 1401 0401 0401  ................
-00003cf0: 1001 0401 1401 0c01 0a01 2001 0801 1201  .......... .....
-00003d00: 7280 0000 0063 0200 0000 0000 0000 0000  r....c..........
-00003d10: 0000 0800 0000 0700 0000 4300 0000 73dc  ..........C...s.
-00003d20: 0000 0074 00a0 017c 01a1 017d 0174 00a0  ...t...|...}.t..
-00003d30: 0174 00a0 027c 00a1 01a1 017d 0274 00a0  .t...|.....}.t..
-00003d40: 037c 027c 011b 00a1 01a0 0474 05a1 017d  .|.|.......t...}
-00003d50: 0374 00a0 067c 0264 0119 007c 0364 0219  .t...|.d...|.d..
-00003d60: 0066 027c 006a 07a1 027d 0474 006a 067c  .f.|.j...}.t.j.|
-00003d70: 037c 006a 0764 038d 027d 0574 0874 057c  .|.j.d...}.t.t.|
-00003d80: 0264 0119 0083 0183 0144 005d 2e7d 0674  .d.......D.].}.t
-00003d90: 096a 0aa0 0b7c 007c 0664 0464 0485 0266  .j...|.|.d.d...f
-00003da0: 0219 007c 0364 0219 00a1 027c 047c 0664  ...|.d.....|.|.d
-00003db0: 0464 0485 0266 023c 0071 6874 0874 057c  .d...f.<.qht.t.|
-00003dc0: 0364 0219 0083 0183 0144 005d 2e7d 0774  .d.......D.].}.t
-00003dd0: 096a 0aa0 0b7c 0464 0464 0485 027c 0766  .j...|.d.d...|.f
-00003de0: 0219 007c 0364 0119 00a1 027c 0564 0464  ...|.d.....|.d.d
-00003df0: 0485 027c 0766 023c 0071 a87c 0553 0029  ...|.f.<.q.|.S.)
-00003e00: 0561 dc01 0000 0a20 2020 2044 6f77 6e73  .a.....    Downs
-00003e10: 616d 706c 6520 3244 2061 7272 6179 0a0a  ample 2D array..
-00003e20: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00003e30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00003e40: 2020 6461 7461 3a20 2020 2020 6e64 6172    data:     ndar
-00003e50: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00003e60: 2020 2832 2c32 2920 7368 6170 650a 2020    (2,2) shape.  
-00003e70: 2020 7361 6d70 6c69 6e67 3a20 7475 706c    sampling: tupl
-00003e80: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00003e90: 446f 776e 7361 6d70 6c69 6e67 2066 6163  Downsampling fac
-00003ea0: 746f 7220 696e 2065 6163 6820 6178 6973  tor in each axis
-00003eb0: 610a 0a20 2020 2052 6574 7572 6e73 0a20  a..    Returns. 
-00003ec0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2072     -------.    r
-00003ed0: 6573 616d 706c 6564 3a20 6e64 6172 7261  esampled: ndarra
-00003ee0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00003ef0: 446f 776e 7361 6d70 6c65 6420 6279 2074  Downsampled by t
-00003f00: 6865 2073 616d 706c 696e 6720 6661 6374  he sampling fact
-00003f10: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00003f20: 2069 6e20 6561 6368 2061 7869 730a 0a20   in each axis.. 
-00003f30: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
-00003f40: 2d2d 0a20 2020 2054 6865 2064 6174 6120  --.    The data 
-00003f50: 6973 2061 2032 4420 7772 6170 7065 7220  is a 2D wrapper 
-00003f60: 6f76 6572 2074 6865 2072 6573 697a 6572  over the resizer
-00003f70: 2066 756e 6374 696f 6e0a 0a20 2020 2053   function..    S
-00003f80: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
-00003f90: 2d2d 2d2d 0a20 2020 2072 6573 697a 6572  ----.    resizer
-00003fa0: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
-00003fb0: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
-00003fc0: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
-00003fd0: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 2020  eed@ornl.gov>.  
-00003fe0: 2020 7201 0000 0072 0300 0000 7215 0000    r....r....r...
-00003ff0: 004e 290c 7205 0000 0072 0600 0000 7207  .N).r....r....r.
-00004000: 0000 0072 5700 0000 7208 0000 0072 0900  ...rW...r....r..
-00004010: 0000 722b 0000 0072 1600 0000 7226 0000  ..r+...r....r&..
-00004020: 0072 1e00 0000 721f 0000 0072 8000 0000  .r....r....r....
-00004030: 2908 7242 0000 005a 0873 616d 706c 696e  ).rB...Z.samplin
-00004040: 67da 0a64 6174 615f 7368 6170 655a 0d73  g..data_shapeZ.s
-00004050: 616d 706c 6564 5f73 6861 7065 da0b 7265  ampled_shape..re
-00004060: 7361 6d70 6c65 645f 78da 0b72 6573 616d  sampled_x..resam
-00004070: 706c 6564 5f66 7271 0000 0072 7200 0000  pled_frq...rr...
-00004080: 7212 0000 0072 1200 0000 7213 0000 0072  r....r....r....r
-00004090: 6400 0000 4502 0000 7314 0000 0000 1c0a  d...E...s.......
-000040a0: 0110 0114 011a 0110 0114 012c 0114 012c  ...........,...,
-000040b0: 0172 6400 0000 6302 0000 0000 0000 0000  .rd...c.........
-000040c0: 0000 0007 0000 0007 0000 0043 0000 0073  ...........C...s
-000040d0: c000 0000 7400 a001 7400 a002 7c00 a101  ....t...t...|...
-000040e0: a101 7d02 7400 6a03 7c02 6401 1900 7c01  ..}.t.j.|.d...|.
-000040f0: 6402 1900 6602 7c00 6a04 6403 8d02 7d03  d...f.|.j.d...}.
-00004100: 7400 6a03 7c01 7c00 6a04 6403 8d02 7d04  t.j.|.|.j.d...}.
-00004110: 7405 7406 7c02 6401 1900 8301 8301 4400  t.t.|.d.......D.
-00004120: 5d2e 7d05 7407 6a08 a009 7c00 7c05 6404  ].}.t.j...|.|.d.
-00004130: 6404 8502 6602 1900 7c01 6402 1900 a102  d...f...|.d.....
-00004140: 7c03 7c05 6404 6404 8502 6602 3c00 714c  |.|.d.d...f.<.qL
-00004150: 7405 7406 7c01 6402 1900 8301 8301 4400  t.t.|.d.......D.
-00004160: 5d2e 7d06 7407 6a08 a009 7c03 6404 6404  ].}.t.j...|.d.d.
-00004170: 8502 7c06 6602 1900 7c01 6401 1900 a102  ..|.f...|.d.....
-00004180: 7c04 6404 6404 8502 7c06 6602 3c00 718c  |.d.d...|.f.<.q.
-00004190: 7c04 5300 2905 61d4 0100 000a 2020 2020  |.S.).a.....    
-000041a0: 446f 776e 7361 6d70 6c65 2032 4420 6172  Downsample 2D ar
-000041b0: 7261 790a 2020 2020 5061 7261 6d65 7465  ray.    Paramete
-000041c0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-000041d0: 2d0a 2020 2020 6461 7461 5f6f 7269 673a  -.    data_orig:
-000041e0: 2020 2020 206e 6461 7272 6179 0a20 2020       ndarray.   
-000041f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004200: 2832 2c32 2920 7368 6170 650a 2020 2020  (2,2) shape.    
-00004210: 6e65 775f 7368 6170 653a 2020 2020 2074  new_shape:     t
-00004220: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
-00004230: 2020 2020 2020 2020 4e65 7720 7368 6170          New shap
-00004240: 650a 2020 2020 5265 7475 726e 730a 2020  e.    Returns.  
-00004250: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 7265    -------.    re
-00004260: 7361 6d70 6c65 645f 663a 206e 6461 7272  sampled_f: ndarr
-00004270: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
-00004280: 2020 2020 4e65 7720 6172 7261 7920 7768      New array wh
-00004290: 6f73 6520 7369 7a65 2069 7320 6769 7665  ose size is give
-000042a0: 6e20 6279 206e 6577 5f73 6861 7065 0a20  n by new_shape. 
-000042b0: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
-000042c0: 2d2d 0a20 2020 2054 6865 2064 6174 6120  --.    The data 
-000042d0: 6973 2061 2032 4420 7772 6170 7065 7220  is a 2D wrapper 
-000042e0: 6f76 6572 2074 6865 2072 6573 697a 6572  over the resizer
-000042f0: 2066 756e 6374 696f 6e0a 2020 2020 5365   function.    Se
-00004300: 6520 416c 736f 0a20 2020 202d 2d2d 2d2d  e Also.    -----
-00004310: 2d2d 2d0a 2020 2020 7265 7369 7a65 720a  ---.    resizer.
-00004320: 2020 2020 7265 7369 7a65 7232 440a 0a20      resizer2D.. 
-00004330: 2020 203a 4175 7468 6f72 733a 0a20 2020     :Authors:.   
-00004340: 2044 6562 616e 6773 6875 204d 756b 6865   Debangshu Mukhe
-00004350: 726a 6565 203c 6d75 6b68 6572 6a65 6564  rjee <mukherjeed
-00004360: 406f 726e 6c2e 676f 763e 0a20 2020 2072  @ornl.gov>.    r
-00004370: 0100 0000 7203 0000 0072 1500 0000 4e29  ....r....r....N)
-00004380: 0a72 0500 0000 7206 0000 0072 0700 0000  .r....r....r....
-00004390: 722b 0000 0072 1600 0000 7226 0000 0072  r+...r....r&...r
-000043a0: 0900 0000 721e 0000 0072 1f00 0000 7280  ....r....r....r.
-000043b0: 0000 0029 075a 0964 6174 615f 6f72 6967  ...).Z.data_orig
-000043c0: 5a09 6e65 775f 7368 6170 6572 8100 0000  Z.new_shaper....
-000043d0: 7282 0000 0072 8300 0000 7271 0000 0072  r....r....rq...r
-000043e0: 7200 0000 7212 0000 0072 1200 0000 7213  r...r....r....r.
-000043f0: 0000 00da 0772 6573 697a 6564 6d02 0000  .....resizedm...
-00004400: 7310 0000 0000 1810 011c 0110 0114 012c  s..............,
-00004410: 0114 012c 0172 8400 0000 6301 0000 0000  ...,.r....c.....
-00004420: 0000 0000 0000 0001 0000 0002 0000 0043  ...............C
-00004430: 0000 0073 0c00 0000 7c00 6401 1600 6402  ...s....|.d...d.
-00004440: 6b03 5300 2903 4e72 0200 0000 7201 0000  k.S.).Nr....r...
-00004450: 0072 1200 0000 2901 da03 6e75 6d72 1200  .r....)...numr..
-00004460: 0000 7212 0000 0072 1300 0000 da06 6973  ..r....r......is
-00004470: 5f6f 6464 8f02 0000 7302 0000 0000 0172  _odd....s......r
-00004480: 8600 0000 e919 0000 0072 5500 0000 6304  .........rU...c.
-00004490: 0000 0000 0000 0000 0000 0009 0000 0006  ................
-000044a0: 0000 0043 0000 0073 fe00 0000 7400 a001  ...C...s....t...
-000044b0: 7c00 a101 7d04 7400 a002 7c02 7c04 1400  |...}.t...|.|...
-000044c0: a101 7c02 1b00 7d04 7403 7400 a004 7c04  ..|...}.t.t...|.
-000044d0: a101 7400 a005 7c04 a101 1800 6401 7c02  ..t...|.....d.|.
-000044e0: 1b00 1b00 8301 7d05 7400 6a06 7c05 6402  ......}.t.j.|.d.
-000044f0: 6602 7400 6a07 6403 8d02 7d06 7400 a008  f.t.j.d...}.t...
-00004500: 7c05 a101 4400 5d7a 7d07 7400 a005 7c04  |...D.]z}.t...|.
-00004510: a101 7c07 7c02 1b00 1700 7d08 7c08 7c06  ..|.|.....}.|.|.
-00004520: 7c07 6404 6602 3c00 7c03 6405 6b02 72a0  |.d.f.<.|.d.k.r.
-00004530: 7400 a009 7c01 7c04 7c08 6b02 1900 a101  t...|.|.|.k.....
-00004540: 7c06 7c07 6401 6602 3c00 6e1a 7400 a00a  |.|.d.f.<.n.t...
-00004550: 7c01 7c04 7c08 6b02 1900 a101 7c06 7c07  |.|.|.k.....|.|.
-00004560: 6401 6602 3c00 7400 a00b 7c01 7c04 7c08  d.f.<.t...|.|.|.
-00004570: 6b02 1900 a101 7c06 7c07 6406 6602 3c00  k.....|.|.d.f.<.
-00004580: 715a 7c06 7400 a00c 7c06 6407 6407 8502  qZ|.t...|.d.d...
-00004590: 6406 6602 1900 a101 0f00 6407 6407 8502  d.f.......d.d...
-000045a0: 6602 1900 7d06 7c06 5300 2908 617f 0200  f...}.|.S.).a...
-000045b0: 000a 2020 2020 4765 7420 6d65 616e 2061  ..    Get mean a
-000045c0: 6e64 2073 7461 6e64 6172 6420 6465 7669  nd standard devi
-000045d0: 6174 696f 6e20 6f66 2061 206c 6973 7420  ation of a list 
-000045e0: 6f66 2078 2061 6e64 2079 2076 616c 7565  of x and y value
-000045f0: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
-00004600: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00004610: 0a20 2020 2078 6c69 7374 3a20 2020 2020  .    xlist:     
-00004620: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00004630: 2020 2020 2020 2020 2028 6e2c 3129 2073           (n,1) s
-00004640: 6861 7065 206f 6620 7820 7661 6c75 6573  hape of x values
-00004650: 0a20 2020 2079 6c69 7374 3a20 2020 2020  .    ylist:     
-00004660: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
-00004670: 2020 2020 2020 2020 2028 6e2c 3129 2073           (n,1) s
-00004680: 6861 7065 206f 6620 7820 7661 6c75 6573  hape of x values
-00004690: 0a20 2020 2072 6573 6f6c 7574 696f 6e3a  .    resolution:
-000046a0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
-000046b0: 2020 2020 2020 204f 7074 696f 6e61 6c20         Optional 
-000046c0: 7661 6c75 652c 2064 6566 6175 6c74 2069  value, default i
-000046d0: 6620 3530 0a20 2020 2020 2020 2020 2020  f 50.           
-000046e0: 2020 2020 2048 6f77 2066 696e 656c 7920       How finely 
-000046f0: 7361 6d70 6c65 6420 7468 6520 6669 6e61  sampled the fina
-00004700: 6c20 6c69 7374 2069 730a 0a20 2020 2052  l list is..    R
-00004710: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00004720: 2d2d 0a20 2020 2073 7464 7661 6c73 3a20  --.    stdvals: 
-00004730: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00004740: 2020 2020 2046 6972 7374 2063 6f6c 756d       First colum
-00004750: 6e20 6973 2078 2076 616c 7565 7320 7361  n is x values sa
-00004760: 6d70 6c65 6420 6174 2072 6573 6f6c 7574  mpled at resolut
-00004770: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00004780: 2053 6563 6f6e 6420 436f 6c75 6d6e 2069   Second Column i
-00004790: 7320 6d65 616e 206f 7220 6d65 6469 616e  s mean or median
-000047a0: 206f 6620 636f 7272 6573 706f 6e64 696e   of correspondin
-000047b0: 6720 7920 7661 6c75 6573 0a20 2020 2020  g y values.     
-000047c0: 2020 2020 2020 2020 5468 6972 6420 636f          Third co
-000047d0: 6c75 6d6e 2069 7320 7468 6520 7374 616e  lumn is the stan
-000047e0: 6461 7264 2064 6576 6961 7469 6f6e 0a0a  dard deviation..
-000047f0: 2020 2020 3a41 7574 686f 7273 3a0a 2020      :Authors:.  
-00004800: 2020 4465 6261 6e67 7368 7520 4d75 6b68    Debangshu Mukh
-00004810: 6572 6a65 6520 3c6d 756b 6865 726a 6565  erjee <mukherjee
-00004820: 6440 6f72 6e6c 2e67 6f76 3e0a 2020 2020  d@ornl.gov>.    
-00004830: 7203 0000 0072 3300 0000 7215 0000 0072  r....r3...r....r
-00004840: 0100 0000 7255 0000 0072 0200 0000 4e29  ....rU...r....N)
-00004850: 0d72 0500 0000 da04 636f 7079 7257 0000  .r......copyrW..
-00004860: 0072 0900 0000 7219 0000 0072 1800 0000  .r....r....r....
-00004870: 722b 0000 0072 0a00 0000 7263 0000 0072  r+...r....rc...r
-00004880: 5500 0000 726b 0000 005a 0373 7464 da05  U...rk...Z.std..
-00004890: 6973 6e61 6e29 095a 0578 6c69 7374 5a05  isnan).Z.xlistZ.
-000048a0: 796c 6973 74da 0a72 6573 6f6c 7574 696f  ylist..resolutio
-000048b0: 6eda 0573 7479 6c65 5a06 7872 6f75 6e64  n..styleZ.xround
-000048c0: 5a08 785f 706f 696e 7473 5a07 7374 6476  Z.x_pointsZ.stdv
-000048d0: 616c 7372 6700 0000 5a05 6363 7661 6c72  alsrg...Z.ccvalr
-000048e0: 1200 0000 7212 0000 0072 1300 0000 da0c  ....r....r......
-000048f0: 6765 745f 6d65 616e 5f73 7464 9302 0000  get_mean_std....
-00004900: 731a 0000 0000 180a 0112 0120 0114 010e  s.......... ....
-00004910: 0112 010c 0108 011c 021a 011c 0124 0172  .............$.r
-00004920: 8c00 0000 6301 0000 0000 0000 0000 0000  ....c...........
-00004930: 0007 0000 0005 0000 0043 0000 0073 a400  .........C...s..
-00004940: 0000 7400 a001 7c00 6a02 a101 a003 7404  ..t...|.j.....t.
-00004950: a101 7d01 7400 a005 7c01 6401 1900 7c01  ..}.t...|.d...|.
-00004960: 6402 1900 6403 6603 a101 7d02 7400 a006  d...d.f...}.t...
-00004970: 7c00 a101 7d03 6404 7400 6a07 7c00 6405  |...}.d.t.j.|.d.
-00004980: 6406 8d02 1700 6407 1b00 7d04 7c04 7400  d.....d...}.|.t.
-00004990: a008 7c04 a101 1800 7d04 7400 a009 7c03  ..|.....}.t...|.
-000049a0: a101 7d05 7c03 7c05 1b00 7d03 7c04 7c02  ..}.|.|...}.|.|.
-000049b0: 6400 6400 8502 6400 6400 8502 6401 6603  d.d...d.d...d.f.
-000049c0: 3c00 7c03 7c02 6400 6400 8502 6400 6400  <.|.|.d.d...d.d.
-000049d0: 8502 6402 6603 3c00 740a a00b 7c02 a101  ..d.f.<.t...|...
-000049e0: 7d06 7c06 5300 2908 4e72 0100 0000 7203  }.|.S.).Nr....r.
-000049f0: 0000 0072 3300 0000 e9b4 0000 0054 a901  ...r3........T..
-00004a00: da03 6465 67e9 6801 0000 a90c 7205 0000  ..deg.h.....r...
-00004a10: 0072 0600 0000 7207 0000 0072 0800 0000  .r....r....r....
-00004a20: 7209 0000 0072 3400 0000 7241 0000 005a  r....r4...rA...Z
-00004a30: 0561 6e67 6c65 7235 0000 0072 1900 0000  .angler5...r....
-00004a40: da03 736b 635a 0768 7376 3272 6762 a907  ..skcZ.hsv2rgb..
-00004a50: 5a0a 636f 6d70 5f69 6d61 6765 5a08 696d  Z.comp_imageZ.im
-00004a60: 675f 7369 7a65 7244 0000 005a 0a72 6561  g_sizerD...Z.rea
-00004a70: 6c5f 696d 6167 655a 0b61 6e67 6c65 5f69  l_imageZ.angle_i
-00004a80: 6d61 6765 5a07 6d61 785f 7661 6c5a 0d63  mageZ.max_valZ.c
-00004a90: 6f6c 6f72 6564 5f69 6d61 6765 7212 0000  olored_imager...
-00004aa0: 0072 1200 0000 7213 0000 00da 0c63 705f  .r....r......cp_
-00004ab0: 696d 6167 655f 7361 74bb 0200 0073 1600  image_sat....s..
-00004ac0: 0000 0001 1201 1801 0a01 1601 0e01 0a01  ................
-00004ad0: 0801 1601 1601 0a01 7294 0000 0063 0100  ........r....c..
-00004ae0: 0000 0000 0000 0000 0000 0700 0000 0500  ................
-00004af0: 0000 4300 0000 73a4 0000 0074 00a0 017c  ..C...s....t...|
-00004b00: 006a 02a1 01a0 0374 04a1 017d 0174 00a0  .j.....t...}.t..
-00004b10: 057c 0164 0119 007c 0164 0219 0064 0366  .|.d...|.d...d.f
-00004b20: 03a1 017d 0274 00a0 067c 00a1 017d 0364  ...}.t...|...}.d
-00004b30: 0474 006a 077c 0064 0564 068d 0217 0064  .t.j.|.d.d.....d
-00004b40: 071b 007d 047c 0474 00a0 087c 04a1 0118  ...}.|.t...|....
-00004b50: 007d 0474 00a0 097c 03a1 017d 057c 037c  .}.t...|...}.|.|
-00004b60: 051b 007d 037c 047c 0264 0064 0085 0264  ...}.|.|.d.d...d
-00004b70: 0064 0085 0264 0166 033c 007c 037c 0264  .d...d.f.<.|.|.d
-00004b80: 0064 0085 0264 0064 0085 0264 0866 033c  .d...d.d...d.f.<
-00004b90: 0074 0aa0 0b7c 02a1 017d 067c 0653 0029  .t...|...}.|.S.)
-00004ba0: 094e 7201 0000 0072 0300 0000 7233 0000  .Nr....r....r3..
-00004bb0: 0072 8d00 0000 5472 8e00 0000 7290 0000  .r....Tr....r...
-00004bc0: 0072 0200 0000 7291 0000 0072 9300 0000  .r....r....r....
-00004bd0: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
-00004be0: 0c63 705f 696d 6167 655f 7661 6cc9 0200  .cp_image_val...
-00004bf0: 0073 1600 0000 0001 1201 1801 0a01 1601  .s..............
-00004c00: 0e01 0a01 0801 1601 1601 0a01 7295 0000  ............r...
-00004c10: 0063 0100 0000 0000 0000 0000 0000 0a00  .c..............
-00004c20: 0000 0900 0000 4300 0000 73dc 0000 007c  ......C...s....|
-00004c30: 0064 016b 037d 017c 0064 016b 027d 0274  .d.k.}.|.d.k.}.t
-00004c40: 006a 0164 017c 006a 0264 0119 0085 0264  .j.d.|.j.d.....d
-00004c50: 017c 006a 0264 0219 0085 0266 0219 005c  .|.j.d.....f...\
-00004c60: 027d 037d 0474 00a0 037c 037c 0119 007c  .}.}.t...|.|...|
-00004c70: 047c 0119 0066 02a1 01a0 04a1 007d 0574  .|...f.......}.t
-00004c80: 00a0 037c 037c 0219 007c 047c 0219 0066  ...|.|...|.|...f
-00004c90: 02a1 01a0 04a1 007d 0674 00a0 057c 056a  .......}.t...|.j
-00004ca0: 0264 0119 00a1 017d 0774 00a0 067c 056a  .d.....}.t...|.j
-00004cb0: 0264 0119 00a1 0144 005d 307d 0874 00a0  .d.....D.]0}.t..
-00004cc0: 0774 006a 087c 067c 057c 0864 0164 0385  .t.j.|.|.|.d.d..
-00004cd0: 0266 0219 0018 0064 0313 0064 0264 048d  .f.....d...d.d..
-00004ce0: 02a1 017c 077c 083c 0071 8a74 006a 097c  ...|.|.<.q.t.j.|
-00004cf0: 0074 006a 0a64 058d 027d 097c 0764 0613  .t.j.d...}.|.d..
-00004d00: 007c 097c 013c 007c 0953 0029 0761 0101  .|.|.<.|.S.).a..
-00004d10: 0000 0a20 2020 2047 6574 2045 7563 6c69  ...    Get Eucli
-00004d20: 6465 616e 2064 6973 7461 6e63 6520 6f66  dean distance of
-00004d30: 2065 7665 7279 206e 6f6e 2d7a 6572 6f0a   every non-zero.
-00004d40: 2020 2020 7069 7865 6c20 6672 6f6d 207a      pixel from z
-00004d50: 6572 6f20 7661 6c75 6564 2070 6978 656c  ero valued pixel
-00004d60: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
-00004d70: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00004d80: 0a20 2020 2062 696e 6172 795f 696d 6167  .    binary_imag
-00004d90: 653a 206e 6461 7272 6179 0a20 2020 2020  e: ndarray.     
-00004da0: 2020 2020 2020 2020 2020 2020 2054 6865               The
-00004db0: 2069 6d61 6765 0a0a 2020 2020 5265 7475   image..    Retu
-00004dc0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-00004dd0: 2020 2020 6469 7374 5f6d 6170 3a20 6e64      dist_map: nd
-00004de0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
-00004df0: 2020 2020 5468 6520 4575 636c 6964 6561      The Euclidea
-00004e00: 6e20 6469 7374 616e 6365 206d 6170 0a20  n distance map. 
-00004e10: 2020 2072 0100 0000 7203 0000 0072 0200     r....r....r..
-00004e20: 0000 a901 5a04 6178 6973 7215 0000 0072  ....Z.axisr....r
-00004e30: 3e00 0000 290b 7205 0000 0072 2400 0000  >...).r....r$...
-00004e40: 7207 0000 0072 0600 0000 da09 7472 616e  r....r......tran
-00004e50: 7370 6f73 6572 2b00 0000 7263 0000 0072  sposer+...rc...r
-00004e60: 1800 0000 7249 0000 0072 1700 0000 da05  ....rI...r......
-00004e70: 666c 6f61 7429 0a5a 0c62 696e 6172 795f  float).Z.binary_
-00004e80: 696d 6167 655a 0762 695f 6f6e 6573 5a07  imageZ.bi_onesZ.
-00004e90: 6269 5f7a 6572 6f5a 0562 695f 7979 5a05  bi_zeroZ.bi_yyZ.
-00004ea0: 6269 5f78 785a 096f 6e65 735f 7661 6c73  bi_xxZ.ones_vals
-00004eb0: 5a09 7a65 726f 5f76 616c 735a 0964 6973  Z.zero_valsZ.dis
-00004ec0: 745f 7661 6c73 7267 0000 005a 0864 6973  t_valsrg...Z.dis
-00004ed0: 745f 6d61 7072 1200 0000 7212 0000 0072  t_mapr....r....r
-00004ee0: 1300 0000 da0e 6575 636c 6964 6561 6e5f  ......euclidean_
-00004ef0: 6469 7374 d702 0000 7316 0000 0000 0f08  dist....s.......
-00004f00: 0108 0126 011a 011a 0110 0114 012e 0110  ...&............
-00004f10: 010c 0172 9900 0000 6302 0000 0000 0000  ...r....c.......
-00004f20: 0000 0000 000a 0000 0007 0000 0043 0000  .............C..
-00004f30: 0073 2401 0000 7400 a001 7c00 a101 7d02  .s$...t...|...}.
-00004f40: 7c01 6401 1900 7400 a002 7c00 6402 6402  |.d...t...|.d.d.
-00004f50: 8502 6401 6602 1900 7c01 6401 1900 1b00  ..d.f...|.d.....
-00004f60: a101 1400 7c02 6402 6402 8502 6401 6602  ....|.d.d...d.f.
-00004f70: 3c00 7c01 6403 1900 7400 a002 7c00 6402  <.|.d...t...|.d.
-00004f80: 6402 8502 6403 6602 1900 7c01 6403 1900  d...d.f...|.d...
-00004f90: 1b00 a101 1400 7c02 6402 6402 8502 6403  ......|.d.d...d.
-00004fa0: 6602 3c00 7400 a003 7c02 6402 6402 8502  f.<.t...|.d.d...
-00004fb0: 6401 6602 1900 a101 7d03 7c02 6402 6402  d.f.....}.|.d.d.
-00004fc0: 8502 6403 6602 1900 7d04 7400 a004 6404  ..d.f...}.t...d.
-00004fd0: a101 7d05 7400 a005 7406 7c03 8301 a101  ..}.t...t.|.....
-00004fe0: 4400 5d5e 7d06 7400 a003 7c04 7c02 6402  D.]^}.t...|.|.d.
-00004ff0: 6402 8502 6401 6602 1900 7c03 7c06 1900  d...d.f...|.|...
-00005000: 6b02 1900 a101 7d07 7400 a007 7c07 a101  k.....}.t...|...
-00005010: 7c03 7c06 1900 1400 7d08 7400 a008 7400  |.|.....}.t...t.
-00005020: a009 7c08 7c07 6602 a101 a101 7d09 7400  ..|.|.f.....}.t.
-00005030: 6a0a 7c05 7c09 6602 6401 6405 8d02 7d05  j.|.|.f.d.d...}.
-00005040: 71ac 7c05 6403 7406 7c05 8301 8502 6401  q.|.d.t.|.....d.
-00005050: 6406 8502 6602 1900 5300 2907 61a0 0100  d...f...S.).a...
-00005060: 000a 2020 2020 5265 6475 6365 2074 6865  ..    Reduce the
-00005070: 2070 7265 6369 736f 6e20 6f66 2061 6e20   precison of an 
-00005080: 7879 2061 7272 6179 2061 6c6f 6e67 2062  xy array along b
-00005090: 6f74 680a 2020 2020 7468 6520 7820 616e  oth.    the x an
-000050a0: 6420 7920 6178 6573 2e0a 0a20 2020 2050  d y axes...    P
-000050b0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000050c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078 793a  --------.    xy:
-000050d0: 2020 2020 2020 6e64 6172 7261 790a 2020        ndarray.  
-000050e0: 2020 2020 2020 2020 2020 2054 6865 2066             The f
-000050f0: 6972 7374 2063 6f6c 756d 6e20 6973 2074  irst column is t
-00005100: 6865 2078 2064 696d 656e 7369 6f6e 2c20  he x dimension, 
-00005110: 7768 696c 650a 2020 2020 2020 2020 2020  while.          
-00005120: 2020 2074 6865 2073 6563 6f6e 6420 636f     the second co
-00005130: 6c75 6d6e 2069 7320 7468 6520 7920 6469  lumn is the y di
-00005140: 6d65 6e73 696f 6e0a 2020 2020 7265 6475  mension.    redu
-00005150: 6365 723a 2074 7570 6c65 0a20 2020 2020  cer: tuple.     
-00005160: 2020 2020 2020 2020 5468 6520 7072 6563          The prec
-00005170: 6973 6f6e 2072 6564 7563 6572 7320 616c  ison reducers al
-00005180: 6f6e 6720 7468 6520 696e 6469 7669 6475  ong the individu
-00005190: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
-000051a0: 6469 6d65 6e73 696f 6e73 0a0a 2020 2020  dimensions..    
-000051b0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-000051c0: 2d2d 2d0a 2020 2020 7879 7072 6563 3a20  ---.    xyprec: 
-000051d0: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-000051e0: 2020 2020 5265 6475 6365 6420 7072 6563      Reduced prec
-000051f0: 6973 696f 6e20 6172 7261 790a 0a20 2020  ision array..   
-00005200: 2072 0100 0000 4e72 0300 0000 2902 7203   r....Nr....).r.
-00005210: 0000 0072 0200 0000 7296 0000 0072 0200  ...r....r....r..
-00005220: 0000 290b 7205 0000 0072 1700 0000 7257  ..).r....r....rW
-00005230: 0000 00da 0675 6e69 7175 6572 2b00 0000  .....uniquer+...
-00005240: 7263 0000 00da 036c 656e 5a09 6f6e 6573  rc.....lenZ.ones
-00005250: 5f6c 696b 6572 9700 0000 7206 0000 005a  _liker....r....Z
-00005260: 0b63 6f6e 6361 7465 6e61 7465 290a 7276  .concatenate).rv
-00005270: 0000 0072 6500 0000 5a06 7879 5f72 6564  ...re...Z.xy_red
-00005280: 5a08 785f 756e 6971 7565 5a05 795f 616c  Z.x_uniqueZ.y_al
-00005290: 6c5a 0778 795f 7072 6563 7267 0000 005a  lZ.xy_precrg...Z
-000052a0: 0479 5f69 695a 0478 5f69 695a 0661 7272  .y_iiZ.x_iiZ.arr
-000052b0: 5f69 6972 1200 0000 7212 0000 0072 1300  _iir....r....r..
-000052c0: 0000 da13 7265 6475 6365 5f70 7265 6369  ....reduce_preci
-000052d0: 7369 6f6e 5f78 79f3 0200 0073 1800 0000  sion_xy....s....
-000052e0: 0014 0a01 3201 3201 1601 1001 0a01 1201  ....2.2.........
-000052f0: 2201 1201 1401 1401 729c 0000 0029 0172  ".......r....).r
-00005300: 1d00 0000 2902 7203 0000 0072 2300 0000  ....).r....r#...
-00005310: 2902 4e72 3d00 0000 2901 7246 0000 0029  ).Nr=...).rF...)
-00005320: 0154 2902 7201 0000 0054 2902 7262 0000  .T).r....T).rb..
-00005330: 0072 3d00 0000 2901 7279 0000 0029 0272  .r=...).ry...).r
-00005340: 8700 0000 7255 0000 0029 395a 056e 756d  ....rU...)9Z.num
-00005350: 7079 7205 0000 005a 0a6d 6174 706c 6f74  pyr....Z.matplot
-00005360: 6c69 625a 036d 706c 5a17 6d70 6c5f 746f  libZ.mplZ.mpl_to
-00005370: 6f6c 6b69 7473 2e61 7865 735f 6772 6964  olkits.axes_grid
-00005380: 315a 0a61 7865 735f 6772 6964 3172 3100  1Z.axes_grid1r1.
-00005390: 0000 5a11 6d61 7470 6c6f 746c 6962 2e63  ..Z.matplotlib.c
-000053a0: 6f6c 6f72 735a 0663 6f6c 6f72 7372 3600  olorsZ.colorsr6.
-000053b0: 0000 5a0d 6d61 7470 6c6f 746c 6962 2e63  ..Z.matplotlib.c
-000053c0: 6dda 0263 6d72 4000 0000 5a0a 7363 6970  m..cmr@...Z.scip
-000053d0: 792e 6d69 7363 5a04 6d69 7363 5a03 7363  y.miscZ.miscZ.sc
-000053e0: 6d5a 0e73 6369 7079 2e6f 7074 696d 697a  mZ.scipy.optimiz
-000053f0: 65da 086f 7074 696d 697a 6572 6f00 0000  e..optimizero...
-00005400: 5a0d 7363 6970 792e 6e64 696d 6167 655a  Z.scipy.ndimageZ
-00005410: 076e 6469 6d61 6765 726d 0000 005a 0c73  .ndimagerm...Z.s
-00005420: 6369 7079 2e73 6967 6e61 6cda 0673 6967  cipy.signal..sig
-00005430: 6e61 6c5a 0573 6373 6967 5a0d 736b 696d  nalZ.scsigZ.skim
-00005440: 6167 652e 636f 6c6f 7272 4300 0000 7292  age.colorrC...r.
-00005450: 0000 00da 0873 7465 6d74 6f6f 6c72 1e00  .....stemtoolr..
-00005460: 0000 7214 0000 0072 1c00 0000 7222 0000  ..r....r....r"..
-00005470: 0072 2a00 0000 722d 0000 0072 3200 0000  .r*...r-...r2...
-00005480: 723c 0000 0072 4500 0000 7247 0000 0072  r<...rE...rG...r
-00005490: 5400 0000 7258 0000 0072 6100 0000 7269  T...rX...ra...ri
-000054a0: 0000 0072 6a00 0000 726c 0000 0072 7500  ...rj...rl...ru.
-000054b0: 0000 7278 0000 0072 7a00 0000 7280 0000  ..rx...rz...r...
-000054c0: 0072 6400 0000 7284 0000 0072 8600 0000  .rd...r....r....
-000054d0: 728c 0000 0072 9400 0000 7295 0000 0072  r....r....r....r
-000054e0: 9900 0000 729c 0000 0072 1200 0000 7212  ....r....r....r.
-000054f0: 0000 0072 1200 0000 7213 0000 00da 083c  ...r....r......<
-00005500: 6d6f 6475 6c65 3e01 0000 0073 4a00 0000  module>....sJ...
-00005510: 0801 0801 0c01 0c01 0c01 0c01 0c01 0c01  ................
-00005520: 0c01 0c01 0803 0833 0823 0a22 0a2c 0820  .......3.#.".,. 
-00005530: 0808 080f 0a0f 0a30 0a0d 0a52 0820 0a20  .......0...R. . 
-00005540: 0823 0807 0812 0809 0a16 0823 0828 0822  .#.........#.(."
-00005550: 0804 0a28 080e 080e 081c                 ...(......
+00000060: 0100 6400 6401 6c0d 5a0d 6400 6401 6c0e  ..d.d.l.Z.d.d.l.
+00000070: 6d0f 5a10 0100 6400 6401 6c11 6d12 5a13  m.Z...d.d.l.m.Z.
+00000080: 0100 6400 6401 6c14 6d15 5a16 0100 6400  ..d.d.l.m.Z...d.
+00000090: 6401 6c17 5a18 6402 6403 8400 5a19 6404  d.l.Z.d.d...Z.d.
+000000a0: 6405 8400 5a1a 6442 6407 6408 8401 5a1b  d...Z.dBd.d...Z.
+000000b0: 6443 640b 640c 8401 5a1c 640d 640e 8400  dCd.d...Z.d.d...
+000000c0: 5a1d 640f 6410 8400 5a1e 6411 6412 8400  Z.d.d...Z.d.d...
+000000d0: 5a1f 6444 6414 6415 8401 5a20 6445 6417  Z.dDd.d...Z dEd.
+000000e0: 6418 8401 5a21 6446 641a 641b 8401 5a22  d...Z!dFd.d...Z"
+000000f0: 6447 641c 641d 8401 5a23 641e 641f 8400  dGd.d...Z#d.d...
+00000100: 5a24 6448 6421 6422 8401 5a25 6423 6424  Z$dHd!d"..Z%d#d$
+00000110: 8400 5a26 6425 6426 8400 5a27 6427 6428  ..Z&d%d&..Z'd'd(
+00000120: 8400 5a28 6429 642a 8400 5a29 6449 642c  ..Z(d)d*..Z)dId,
+00000130: 642d 8401 5a2a 642e 642f 8400 5a2b 6430  d-..Z*d.d/..Z+d0
+00000140: 6431 8400 5a2c 6432 6433 8400 5a2d 6434  d1..Z,d2d3..Z-d4
+00000150: 6435 8400 5a2e 644a 6438 6439 8401 5a2f  d5..Z.dJd8d9..Z/
+00000160: 643a 643b 8400 5a30 643c 643d 8400 5a31  d:d;..Z0d<d=..Z1
+00000170: 643e 643f 8400 5a32 6440 6441 8400 5a33  d>d?..Z2d@dA..Z3
+00000180: 6401 5300 294b e900 0000 004e 6303 0000  d.S.)K.....Nc...
+00000190: 0000 0000 0000 0000 000d 0000 0006 0000  ................
+000001a0: 0043 0000 0073 fa00 0000 7400 a001 7c00  .C...s....t...|.
+000001b0: 6a02 a101 a003 7404 a101 7d03 7400 a005  j.....t...}.t...
+000001c0: 7c03 6401 1900 0b00 6402 1b00 7c03 6401  |.d.....d...|.d.
+000001d0: 1900 6402 1b00 6403 1800 7c03 6401 1900  ..d...d...|.d...
+000001e0: a103 7d04 7c04 7c03 6401 1900 a003 7400  ..}.|.|.d.....t.
+000001f0: 6a06 a101 1b00 7d04 7400 a005 7c03 6403  j.....}.t...|.d.
+00000200: 1900 0b00 6402 1b00 7c03 6403 1900 6402  ....d...|.d...d.
+00000210: 1b00 6403 1800 7c03 6403 1900 a103 7d05  ..d...|.d.....}.
+00000220: 7c05 7c03 6403 1900 a003 7400 6a06 a101  |.|.d.....t.j...
+00000230: 1b00 7d05 7400 a007 7c05 7c04 a102 5c02  ..}.t...|.|...\.
+00000240: 7d06 7d07 7400 a008 7c06 7c01 a102 7400  }.}.t...|.|...t.
+00000250: a008 7c07 7c02 a102 1700 7d08 7400 a009  ..|.|.....}.t...
+00000260: 6404 7400 6a0a 1400 6405 1400 7c08 1400  d.t.j...d...|...
+00000270: a101 7d09 7400 6a0b a00c 7400 6a0b a00d  ..}.t.j...t.j...
+00000280: 7c00 a101 a101 7d0a 7400 a008 7c09 7c0a  |.....}.t...|.|.
+00000290: a102 7d0b 7400 6a0b a00e 7c0b a101 7d0c  ..}.t.j...|...}.
+000002a0: 7c0c 5300 2906 6142 0300 000a 2020 2020  |.S.).aB....    
+000002b0: 4d6f 7665 2049 6d61 6765 7320 7769 7468  Move Images with
+000002c0: 2073 7562 2d70 6978 656c 2070 7265 6369   sub-pixel preci
+000002d0: 7369 6f6e 0a0a 2020 2020 5061 7261 6d65  sion..    Parame
+000002e0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+000002f0: 2d2d 2d0a 2020 2020 696d 6167 655f 746f  ---.    image_to
+00000300: 5f6d 6f76 653a 206e 6461 7272 6179 0a20  _move: ndarray. 
+00000310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000320: 2020 4f72 6967 696e 616c 2049 6d61 6765    Original Image
+00000330: 2074 6f20 6265 206d 6f76 6564 0a20 2020   to be moved.   
+00000340: 2078 5f70 6978 656c 733a 2066 6c6f 6174   x_pixels: float
+00000350: 0a20 2020 2020 2020 2020 2020 2020 2050  .              P
+00000360: 6978 656c 7320 746f 2073 6869 6674 2069  ixels to shift i
+00000370: 6e20 5820 6469 7265 6374 696f 6e0a 2020  n X direction.  
+00000380: 2020 795f 7069 7865 6c73 3a20 666c 6f61    y_pixels: floa
+00000390: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+000003a0: 5069 7865 6c73 2074 6f20 5368 6966 7420  Pixels to Shift 
+000003b0: 696e 2059 2064 6972 6563 7469 6f6e 0a0a  in Y direction..
+000003c0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+000003d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6d6f 7665  -------.    move
+000003e0: 645f 696d 6167 653a 206e 6461 7272 6179  d_image: ndarray
+000003f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000400: 2020 4d6f 7665 6420 496d 6167 650a 0a20    Moved Image.. 
+00000410: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
+00000420: 2d2d 0a20 2020 2054 6865 2075 6e64 6572  --.    The under
+00000430: 6c79 696e 6720 6964 6561 2069 7320 7468  lying idea is th
+00000440: 6174 2061 2073 6869 6674 2069 6e20 7468  at a shift in th
+00000450: 6520 7265 616c 2073 7061 6365 0a20 2020  e real space.   
+00000460: 2069 7320 7068 6173 6520 7368 6966 7420   is phase shift 
+00000470: 696e 2046 6f75 7269 6572 2073 7061 6365  in Fourier space
+00000480: 2e20 536f 2077 6520 7461 6b65 2074 6865  . So we take the
+00000490: 206f 7269 6769 6e61 6c0a 2020 2020 696d   original.    im
+000004a0: 6167 652c 2061 6e64 2074 616b 6520 6974  age, and take it
+000004b0: 2773 2046 6f75 7269 6572 2074 7261 6e73  's Fourier trans
+000004c0: 666f 726d 2e20 416c 736f 2c20 7765 2063  form. Also, we c
+000004d0: 616c 6375 6c61 7465 0a20 2020 2068 6f77  alculate.    how
+000004e0: 206d 7563 6820 7468 6520 696d 6167 6520   much the image 
+000004f0: 7368 6966 7473 2072 6573 756c 7420 696e  shifts result in
+00000500: 2074 6865 2070 6861 7365 2063 6861 6e67   the phase chang
+00000510: 652c 2062 790a 2020 2020 6361 6c63 756c  e, by.    calcul
+00000520: 6174 696e 6720 7468 6520 466f 7572 6965  ating the Fourie
+00000530: 7220 7069 7865 6c20 6469 6d65 6e73 696f  r pixel dimensio
+00000540: 6e73 2e20 5765 2074 6865 6e20 6d75 6c74  ns. We then mult
+00000550: 6970 6c79 0a20 2020 2074 6865 2046 4654  iply.    the FFT
+00000560: 206f 6620 7468 6520 696d 6167 6520 7769   of the image wi
+00000570: 7468 2074 6865 2070 6861 7365 2073 6869  th the phase shi
+00000580: 6674 2076 616c 7565 2061 6e64 2074 6865  ft value and the
+00000590: 6e0a 2020 2020 7461 6b65 2074 6865 2069  n.    take the i
+000005a0: 6e76 6572 7365 2046 4654 2e0a 0a20 2020  nverse FFT...   
+000005b0: 203a 4175 7468 6f72 733a 0a20 2020 2044   :Authors:.    D
+000005c0: 6562 616e 6773 6875 204d 756b 6865 726a  ebangshu Mukherj
+000005d0: 6565 203c 6d75 6b68 6572 6a65 6564 406f  ee <mukherjeed@o
+000005e0: 726e 6c2e 676f 763e 0a20 2020 2072 0100  rnl.gov>.    r..
+000005f0: 0000 e902 0000 00e9 0100 0000 e9fe ffff  ................
+00000600: ff79 0000 0000 0000 0000 0000 0000 0000  .y..............
+00000610: f03f 290f da02 6e70 da07 6173 6172 7261  .?)...np..asarra
+00000620: 79da 0573 6861 7065 da06 6173 7479 7065  y..shape..astype
+00000630: da03 696e 745a 086c 696e 7370 6163 65da  ..intZ.linspace.
+00000640: 0766 6c6f 6174 3634 5a08 6d65 7368 6772  .float64Z.meshgr
+00000650: 6964 da08 6d75 6c74 6970 6c79 da03 6578  id..multiply..ex
+00000660: 70da 0270 69da 0366 6674 5a08 6666 7473  p..pi..fftZ.ffts
+00000670: 6869 6674 da04 6666 7432 da05 6966 6674  hift..fft2..ifft
+00000680: 3229 0d5a 0d69 6d61 6765 5f74 6f5f 6d6f  2).Z.image_to_mo
+00000690: 7665 5a08 785f 7069 7865 6c73 5a08 795f  veZ.x_pixelsZ.y_
+000006a0: 7069 7865 6c73 da0a 696d 6167 655f 7369  pixels..image_si
+000006b0: 7a65 5a0d 666f 7572 6965 725f 6361 6c5f  zeZ.fourier_cal_
+000006c0: 795a 0d66 6f75 7269 6572 5f63 616c 5f78  yZ.fourier_cal_x
+000006d0: 5a0e 666f 7572 6965 725f 6d65 7368 5f78  Z.fourier_mesh_x
+000006e0: 5a0e 666f 7572 6965 725f 6d65 7368 5f79  Z.fourier_mesh_y
+000006f0: 5a0b 6d6f 7665 5f6d 6174 7269 785a 0a6d  Z.move_matrixZ.m
+00000700: 6f76 655f 7068 6173 655a 126f 7269 6769  ove_phaseZ.origi
+00000710: 6e61 6c5f 696d 6167 655f 6666 745a 106d  nal_image_fftZ.m
+00000720: 6f76 6564 5f69 6e5f 666f 7572 6965 725a  oved_in_fourierZ
+00000730: 0b6d 6f76 6564 5f69 6d61 6765 a900 7212  .moved_image..r.
+00000740: 0000 00fa 3962 7569 6c64 2f62 6469 7374  ....9build/bdist
+00000750: 2e6c 696e 7578 2d78 3836 5f36 342f 6567  .linux-x86_64/eg
+00000760: 672f 7374 656d 746f 6f6c 2f75 7469 6c2f  g/stemtool/util/
+00000770: 696d 6167 655f 7574 696c 732e 7079 da0d  image_utils.py..
+00000780: 6d6f 7665 5f62 795f 7068 6173 650d 0000  move_by_phase...
+00000790: 0073 2400 0000 121f 0401 2001 04ff 1403  .s$....... .....
+000007a0: 0401 2001 04ff 1403 1001 0e01 0401 06ff  .. .............
+000007b0: 1803 1401 0c01 0c01 0401 7214 0000 0063  ..........r....c
+000007c0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+000007d0: 0500 0000 4300 0000 7336 0000 0074 006a  ....C...s6...t.j
+000007e0: 017c 0074 006a 0264 018d 027d 017c 0074  .|.t.j.d...}.|.t
+000007f0: 00a0 037c 00a1 0118 0074 00a0 047c 00a1  ...|.....t...|..
+00000800: 0174 00a0 037c 00a1 0118 001b 007d 017c  .t...|.......}.|
+00000810: 0153 0029 0261 5b02 0000 0a20 2020 204e  .S.).a[....    N
+00000820: 6f72 6d61 6c69 7a69 6e67 2049 6d61 6765  ormalizing Image
+00000830: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00000840: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00000850: 2020 2020 696d 6167 655f 6f72 6967 3a20      image_orig: 
+00000860: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00000870: 2020 2020 2020 2020 2769 6d61 6765 5f6f          'image_o
+00000880: 7269 6727 2069 7320 7468 6520 6f72 6967  rig' is the orig
+00000890: 696e 616c 2069 6e70 7574 2069 6d61 6765  inal input image
+000008a0: 2074 6f20 6265 206e 6f72 6d61 6c69 7a65   to be normalize
+000008b0: 640a 0a20 2020 2052 6574 7572 6e73 0a20  d..    Returns. 
+000008c0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2069     -------.    i
+000008d0: 6d61 6765 5f6e 6f72 6d3a 206e 6461 7272  mage_norm: ndarr
+000008e0: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+000008f0: 2020 204e 6f72 6d61 6c69 7a65 6420 496d     Normalized Im
+00000900: 6167 650a 0a20 2020 204e 6f74 6573 0a20  age..    Notes. 
+00000910: 2020 202d 2d2d 2d2d 0a20 2020 2057 6520     -----.    We 
+00000920: 6e6f 726d 616c 697a 6520 6120 7265 616c  normalize a real
+00000930: 2076 616c 7565 6420 696d 6167 6520 6865   valued image he
+00000940: 7265 0a20 2020 2073 6f20 7468 6174 2069  re.    so that i
+00000950: 7427 7320 7661 6c75 6573 206c 6965 2062  t's values lie b
+00000960: 6574 7765 656e 206f 2061 6e64 2031 2e0a  etween o and 1..
+00000970: 2020 2020 5468 6973 2069 7320 646f 6e65      This is done
+00000980: 2062 7920 6669 7273 7420 7375 6274 7261   by first subtra
+00000990: 6374 696e 6720 7468 650a 2020 2020 6d69  cting the.    mi
+000009a0: 6e69 6d75 6d20 7661 6c75 6520 6f66 2074  nimum value of t
+000009b0: 6865 2069 6d61 6765 2066 726f 6d20 7468  he image from th
+000009c0: 650a 2020 2020 696d 6167 6520 6974 7365  e.    image itse
+000009d0: 6c66 2c20 616e 6420 7468 656e 2073 7562  lf, and then sub
+000009e0: 7365 7175 656e 746c 790a 2020 2020 6469  sequently.    di
+000009f0: 7669 6469 6e67 2074 6865 2069 6d61 6765  viding the image
+00000a00: 2062 7920 7468 6520 6d61 7869 6d75 6d20   by the maximum 
+00000a10: 7661 6c75 650a 2020 2020 6f66 2074 6865  value.    of the
+00000a20: 2073 7562 7472 6163 7465 6420 696d 6167   subtracted imag
+00000a30: 652e 0a0a 2020 2020 3a41 7574 686f 7273  e...    :Authors
+00000a40: 3a0a 2020 2020 4465 6261 6e67 7368 7520  :.    Debangshu 
+00000a50: 4d75 6b68 6572 6a65 6520 3c6d 756b 6865  Mukherjee <mukhe
+00000a60: 726a 6565 6440 6f72 6e6c 2e67 6f76 3e0a  rjeed@ornl.gov>.
+00000a70: 0a20 2020 20a9 01da 0564 7479 7065 2905  .    ....dtype).
+00000a80: 7205 0000 00da 0a7a 6572 6f73 5f6c 696b  r......zeros_lik
+00000a90: 6572 0a00 0000 da04 616d 696e da04 616d  er......amin..am
+00000aa0: 6178 2902 da0a 696d 6167 655f 6f72 6967  ax)...image_orig
+00000ab0: da0a 696d 6167 655f 6e6f 726d 7212 0000  ..image_normr...
+00000ac0: 0072 1200 0000 7213 0000 00da 1069 6d61  .r....r......ima
+00000ad0: 6765 5f6e 6f72 6d61 6c69 7a65 7240 0000  ge_normalizer@..
+00000ae0: 0073 0a00 0000 101c 0c01 1201 04ff 0403  .s..............
+00000af0: 721c 0000 00e9 4000 0000 6302 0000 0000  r.....@...c.....
+00000b00: 0000 0000 0000 0006 0000 0004 0000 0043  ...............C
+00000b10: 0000 0073 5200 0000 6401 7c01 1300 7d02  ...sR...d.|...}.
+00000b20: 7400 6a01 a002 7c00 a101 7d03 7403 6a04  t.j...|...}.t.j.
+00000b30: 7c03 7403 6a05 6402 8d02 7d04 7403 6a04  |.t.j.d...}.t.j.
+00000b40: 7c03 7403 6a05 6402 8d02 7d05 6403 7c02  |.t.j.d...}.d.|.
+00000b50: 6403 1800 7c03 1400 1700 7d04 7403 a006  d...|.....}.t...
+00000b60: 7c04 a101 7d05 7c05 5300 2904 61df 0100  |...}.|.S.).a...
+00000b70: 000a 2020 2020 4e6f 726d 616c 697a 6564  ..    Normalized
+00000b80: 206c 6f67 206f 6620 696d 6167 650a 0a20   log of image.. 
+00000b90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00000ba0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00000bb0: 2069 6d61 6765 5f6f 7269 673a 206e 6461   image_orig: nda
+00000bc0: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00000bd0: 2020 2020 204e 756d 7079 2061 7272 6179       Numpy array
+00000be0: 206f 6620 7265 616c 2076 616c 7565 6420   of real valued 
+00000bf0: 696d 6167 650a 2020 2020 6269 745f 6465  image.    bit_de
+00000c00: 7074 683a 2069 6e74 0a20 2020 2020 2020  pth: int.       
+00000c10: 2020 2020 2020 2020 4269 7420 6465 7074          Bit dept
+00000c20: 6820 6f66 206f 7574 7075 7420 696d 6167  h of output imag
+00000c30: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00000c40: 2044 6566 6175 6c74 2069 7320 3332 0a0a   Default is 32..
+00000c50: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00000c60: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
+00000c70: 655f 6c6f 673a 206e 6461 7272 6179 0a20  e_log: ndarray. 
+00000c80: 2020 2020 2020 2020 2020 2020 2020 4e6f                No
+00000c90: 726d 616c 697a 6564 206c 6f67 0a0a 2020  rmalized log..  
+00000ca0: 2020 4e6f 7465 730a 2020 2020 2d2d 2d2d    Notes.    ----
+00000cb0: 2d0a 2020 2020 4e6f 726d 616c 697a 6520  -.    Normalize 
+00000cc0: 7468 6520 696d 6167 652c 2061 6e64 2073  the image, and s
+00000cd0: 6361 6c65 2069 7420 325e 3020 746f 2032  cale it 2^0 to 2
+00000ce0: 5e62 6974 5f64 6570 7468 2e0a 2020 2020  ^bit_depth..    
+00000cf0: 5461 6b65 206c 6f67 3220 6f66 2074 6865  Take log2 of the
+00000d00: 2073 6361 6c65 6420 696d 6167 652e 0a0a   scaled image...
+00000d10: 2020 2020 3a41 7574 686f 7273 3a0a 2020      :Authors:.  
+00000d20: 2020 4465 6261 6e67 7368 7520 4d75 6b68    Debangshu Mukh
+00000d30: 6572 6a65 6520 3c6d 756b 6865 726a 6565  erjee <mukherjee
+00000d40: 6440 6f72 6e6c 2e67 6f76 3e0a 2020 2020  d@ornl.gov>.    
+00000d50: 7202 0000 0072 1500 0000 7203 0000 0029  r....r....r....)
+00000d60: 07da 0273 74da 0475 7469 6c72 1c00 0000  ...st..utilr....
+00000d70: 7205 0000 0072 1700 0000 720a 0000 00da  r....r....r.....
+00000d80: 046c 6f67 3229 0672 1a00 0000 da09 6269  .log2).r......bi
+00000d90: 745f 6465 7074 685a 0762 6974 5f6d 6178  t_depthZ.bit_max
+00000da0: 721b 0000 005a 0b69 6d61 6765 5f73 6361  r....Z.image_sca
+00000db0: 6c65 5a09 696d 6167 655f 6c6f 6772 1200  leZ.image_logr..
+00000dc0: 0000 7212 0000 0072 1300 0000 da0f 696d  ..r....r......im
+00000dd0: 6167 655f 6c6f 6761 7269 7a65 7263 0000  age_logarizerc..
+00000de0: 0073 0e00 0000 0819 0c01 1001 1001 1001  .s..............
+00000df0: 0a01 0401 7222 0000 0072 0300 0000 e910  ....r"...r......
+00000e00: 2700 0063 0300 0000 0000 0000 0000 0000  '..c............
+00000e10: 0a00 0000 0600 0000 4300 0000 73a4 0000  ........C...s...
+00000e20: 0074 006a 0164 017c 006a 0264 0119 0085  .t.j.d.|.j.d....
+00000e30: 0264 017c 006a 0264 0219 0085 0266 0219  .d.|.j.d.....f..
+00000e40: 005c 027d 037d 0474 00a0 037c 03a1 017d  .\.}.}.t...|...}
+00000e50: 0574 047c 0183 0144 005d 337d 0474 00a0  .t.|...D.]3}.t..
+00000e60: 057c 00a1 017d 067c 007c 0618 007d 0774  .|...}.|.|...}.t
+00000e70: 00a0 037c 037c 0764 016b 0219 00a1 017d  ...|.|.d.k.....}
+00000e80: 087c 087c 057c 021b 006b 0072 3f74 00a0  .|.|.|...k.r?t..
+00000e90: 057c 077c 0764 016b 0419 00a1 017d 097c  .|.|.d.k.....}.|
+00000ea0: 077c 0918 007d 0764 017c 077c 0764 016b  .|...}.d.|.|.d.k
+00000eb0: 003c 007c 077c 0917 007c 0617 007d 0071  .<.|.|...|...}.q
+00000ec0: 1c7c 0053 0029 0361 e602 0000 0a20 2020  .|.S.).a.....   
+00000ed0: 2052 656d 6f76 6520 6465 6164 2070 6978   Remove dead pix
+00000ee0: 656c 730a 0a20 2020 2050 6172 616d 6574  els..    Paramet
+00000ef0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00000f00: 2d2d 0a20 2020 2069 6d61 6765 5f6f 7269  --.    image_ori
+00000f10: 673a 206e 6461 7272 6179 0a20 2020 2020  g: ndarray.     
+00000f20: 2020 2020 2020 2020 2020 204e 756d 7079             Numpy
+00000f30: 2061 7272 6179 206f 6620 7265 616c 2076   array of real v
+00000f40: 616c 7565 6420 696d 6167 650a 2020 2020  alued image.    
+00000f50: 6974 6572 5f63 6f75 6e74 3a20 696e 740a  iter_count: int.
+00000f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000f70: 4e75 6d62 6572 206f 6620 6974 6572 6174  Number of iterat
+00000f80: 696f 6e73 2074 6f20 7275 6e0a 2020 2020  ions to run.    
+00000f90: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00000fa0: 7072 6f63 6573 732e 2044 6566 6175 6c74  process. Default
+00000fb0: 2069 7320 310a 2020 2020 6c65 7665 6c3a   is 1.    level:
+00000fc0: 2020 2020 2020 696e 742c 666c 6f61 740a        int,float.
+00000fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000fe0: 5261 7469 6f20 6f66 206d 696e 696d 6120  Ratio of minima 
+00000ff0: 7069 7865 6c73 2074 6f20 746f 7461 6c0a  pixels to total.
+00001000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001010: 7069 7865 6c73 2e20 4465 6661 756c 7420  pixels. Default 
+00001020: 6973 2031 302c 3030 300a 0a20 2020 2052  is 10,000..    R
+00001030: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00001040: 2d2d 0a20 2020 2069 6d61 6765 5f6f 7269  --.    image_ori
+00001050: 673a 206e 6461 7272 6179 0a20 2020 2020  g: ndarray.     
+00001060: 2020 2020 2020 2020 2020 2049 6d61 6765             Image
+00001070: 2077 6974 6820 6465 6164 2070 6978 656c   with dead pixel
+00001080: 7320 636f 6e76 6572 7465 640a 0a20 2020  s converted..   
+00001090: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
+000010a0: 0a20 2020 2053 7562 7472 6163 7420 7468  .    Subtract th
+000010b0: 6520 6d69 6e69 6d61 2066 726f 6d20 7468  e minima from th
+000010c0: 6520 696d 6167 652c 2061 6e64 2069 6620  e image, and if 
+000010d0: 7468 650a 2020 2020 6e75 6d62 6572 206f  the.    number o
+000010e0: 6620 7069 7865 6c73 2077 6974 6820 6d69  f pixels with mi
+000010f0: 6e69 6d61 2076 616c 7565 7320 6973 206c  nima values is l
+00001100: 6573 7320 7468 616e 0a20 2020 2074 6865  ess than.    the
+00001110: 2031 2f6c 6576 656c 206f 6620 7468 6520   1/level of the 
+00001120: 746f 7461 6c20 7069 7865 6c73 2c20 7468  total pixels, th
+00001130: 656e 2074 686f 7365 2061 7265 0a20 2020  en those are.   
+00001140: 2064 6563 6964 6564 2074 6f20 6265 2064   decided to be d
+00001150: 6561 6420 7069 7865 6c73 2e20 4974 6572  ead pixels. Iter
+00001160: 6174 6520 6966 206e 6563 6573 7361 7279  ate if necessary
+00001170: 0a0a 2020 2020 3a41 7574 686f 7273 3a0a  ..    :Authors:.
+00001180: 2020 2020 4465 6261 6e67 7368 7520 4d75      Debangshu Mu
+00001190: 6b68 6572 6a65 6520 3c6d 756b 6865 726a  kherjee <mukherj
+000011a0: 6565 6440 6f72 6e6c 2e67 6f76 3e0a 2020  eed@ornl.gov>.  
+000011b0: 2020 7201 0000 0072 0300 0000 2906 7205    r....r....).r.
+000011c0: 0000 00da 056d 6772 6964 7207 0000 00da  .....mgridr.....
+000011d0: 0473 697a 65da 0572 616e 6765 7218 0000  .size..ranger...
+000011e0: 0029 0a72 1a00 0000 5a0a 6974 6572 5f63  .).r....Z.iter_c
+000011f0: 6f75 6e74 da05 6c65 7665 6cda 0270 70da  ount..level..pp.
+00001200: 015f 5a09 6e6f 5f70 6f69 6e74 735a 0c6f  ._Z.no_pointsZ.o
+00001210: 7269 6769 6e61 6c5f 6d69 6e5a 0969 6d61  riginal_minZ.ima
+00001220: 6765 5f70 6f73 5a09 6e6f 5f6d 696e 696d  ge_posZ.no_minim
+00001230: 615a 0b6e 6577 5f6d 696e 696d 756d 7212  aZ.new_minimumr.
+00001240: 0000 0072 1200 0000 7213 0000 00da 1272  ...r....r......r
+00001250: 656d 6f76 655f 6465 6164 5f70 6978 656c  emove_dead_pixel
+00001260: 7385 0000 0073 1800 0000 261e 0a01 0c01  s....s....&.....
+00001270: 0a01 0801 1201 0c01 1201 0801 0c01 0e01  ................
+00001280: 0401 722a 0000 0063 0100 0000 0000 0000  ..r*...c........
+00001290: 0000 0000 0600 0000 0500 0000 4300 0000  ............C...
+000012a0: 7388 0000 0074 006a 0174 00a0 027c 00a1  s....t.j.t...|..
+000012b0: 0174 0364 018d 027d 0174 00a0 047c 0164  .t.d...}.t...|.d
+000012c0: 0219 0064 0366 02a1 017d 0274 00a0 057c  ...d.f...}.t...|
+000012d0: 0164 0219 00a1 017c 0264 0464 0485 0264  .d.....|.d.d...d
+000012e0: 0266 023c 0074 00a0 0464 037c 0164 0319  .f.<.t...d.|.d..
+000012f0: 0066 02a1 017d 0374 00a0 057c 0164 0319  .f...}.t...|.d..
+00001300: 00a1 017c 0364 0264 0464 0485 0266 023c  ...|.d.d.d...f.<
+00001310: 0074 00a0 067c 027c 03a1 027d 0474 00a0  .t...|.|...}.t..
+00001320: 067c 007c 04a1 027d 057c 0553 0029 0561  .|.|...}.|.S.).a
+00001330: 6801 0000 0a20 2020 2032 4420 6861 6e6e  h....    2D hann
+00001340: 696e 6720 6669 6c74 6572 2066 6f72 2069  ing filter for i
+00001350: 6d61 6765 730a 0a20 2020 2050 6172 616d  mages..    Param
+00001360: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00001370: 2d2d 2d2d 0a20 2020 2069 6d61 6765 3a20  ----.    image: 
+00001380: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
+00001390: 2020 204f 7269 6769 6e61 6c20 496d 6167     Original Imag
+000013a0: 6520 6f6e 2077 6869 6368 2074 6865 2048  e on which the H
+000013b0: 616e 6e69 6e67 2066 696c 7465 720a 2020  anning filter.  
+000013c0: 2020 2020 2020 2020 2069 7320 746f 2062           is to b
+000013d0: 6520 6170 706c 6965 640a 0a20 2020 2052  e applied..    R
+000013e0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+000013f0: 2d2d 0a20 2020 2068 616e 6e65 645f 696d  --.    hanned_im
+00001400: 6167 653a 206e 6461 7272 6179 0a20 2020  age: ndarray.   
+00001410: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+00001420: 6d61 6765 2077 6974 6820 7468 6520 6861  mage with the ha
+00001430: 6e6e 696e 6720 6669 6c74 6572 2061 7070  nning filter app
+00001440: 6c69 6564 0a0a 2020 2020 4e6f 7465 730a  lied..    Notes.
+00001450: 2020 2020 2d2d 2d2d 2d0a 0a0a 2020 2020      -----...    
+00001460: 3a41 7574 686f 7273 3a0a 2020 2020 4465  :Authors:.    De
+00001470: 6261 6e67 7368 7520 4d75 6b68 6572 6a65  bangshu Mukherje
+00001480: 6520 3c6d 756b 6865 726a 6565 6440 6f72  e <mukherjeed@or
+00001490: 6e6c 2e67 6f76 3e0a 2020 2020 7215 0000  nl.gov>.    r...
+000014a0: 0072 0100 0000 7203 0000 004e 2907 7205  .r....r....N).r.
+000014b0: 0000 0072 0600 0000 7207 0000 0072 0900  ...r....r....r..
+000014c0: 0000 da05 7a65 726f 735a 0768 616e 6e69  ....zerosZ.hanni
+000014d0: 6e67 720b 0000 0029 06da 0569 6d61 6765  ngr....)...image
+000014e0: 5a0a 7369 7a65 5f69 6d61 6765 5a08 726f  Z.size_imageZ.ro
+000014f0: 775f 6861 6e6e 5a08 636f 6c5f 6861 6e6e  w_hannZ.col_hann
+00001500: 5a0b 6861 6e6e 5f77 696e 646f 77da 0c68  Z.hann_window..h
+00001510: 616e 6e65 645f 696d 6167 6572 1200 0000  anned_imager....
+00001520: 7212 0000 0072 1300 0000 722d 0000 00b1  r....r....r-....
+00001530: 0000 0073 1000 0000 1416 1201 1a01 1201  ...s............
+00001540: 1a01 0c01 0c01 0401 722d 0000 0063 0100  ........r-...c..
+00001550: 0000 0000 0000 0000 0000 0500 0000 0500  ................
+00001560: 0000 4300 0000 7334 0000 007c 006a 007d  ..C...s4...|.j.}
+00001570: 017c 016a 017d 0274 02a0 037c 01a1 017d  .|.j.}.t...|...}
+00001580: 037c 036a 0464 0164 0264 0364 048d 037d  .|.j.d.d.d.d...}
+00001590: 047c 026a 057c 007c 0464 058d 0253 0029  .|.j.|.|.d...S.)
+000015a0: 064e da05 7269 6768 747a 0235 2567 9a99  .N..rightz.5%g..
+000015b0: 9999 9999 a93f 2902 7225 0000 00da 0370  .....?).r%.....p
+000015c0: 6164 2901 da03 6361 7829 065a 0461 7865  ad)...cax).Z.axe
+000015d0: 735a 0666 6967 7572 65da 056d 706c 6178  sZ.figure..mplax
+000015e0: 5a13 6d61 6b65 5f61 7865 735f 6c6f 6361  Z.make_axes_loca
+000015f0: 7461 626c 655a 0b61 7070 656e 645f 6178  tableZ.append_ax
+00001600: 6573 5a08 636f 6c6f 7262 6172 2905 5a08  esZ.colorbar).Z.
+00001610: 6d61 7070 6162 6c65 5a02 6178 5a03 6669  mappableZ.axZ.fi
+00001620: 675a 0764 6976 6964 6572 7230 0000 0072  gZ.dividerr0...r
+00001630: 1200 0000 7212 0000 0072 1300 0000 da0d  ....r....r......
+00001640: 7361 6e65 5f63 6f6c 6f72 6261 72d1 0000  sane_colorbar...
+00001650: 0073 0a00 0000 0601 0601 0a01 1001 0e01  .s..............
+00001660: 7232 0000 0063 0100 0000 0000 0000 0000  r2...c..........
+00001670: 0000 0800 0000 0700 0000 4300 0000 7388  ..........C...s.
+00001680: 0100 0074 006a 0174 00a0 027c 00a1 0174  ...t.j.t...|...t
+00001690: 0364 018d 027d 0174 00a0 047c 0164 0219  .d...}.t...|.d..
+000016a0: 007c 0164 0319 0064 0466 03a1 017d 027c  .|.d...d.f...}.|
+000016b0: 0064 0574 006a 0514 0017 0064 0574 006a  .d.t.j.....d.t.j
+000016c0: 0514 001b 007c 0264 0064 0085 0264 0064  .....|.d.d...d.d
+000016d0: 0085 0264 0266 033c 007c 0264 0064 0085  ...d.f.<.|.d.d..
+000016e0: 0264 0064 0085 0264 0266 0319 0074 00a0  .d.d...d.f...t..
+000016f0: 067c 0264 0064 0085 0264 0064 0085 0264  .|.d.d...d.d...d
+00001700: 0266 0319 00a1 0118 007c 0264 0064 0085  .f.......|.d.d..
+00001710: 0264 0064 0085 0264 0266 033c 0074 07a0  .d.d...d.f.<.t..
+00001720: 087c 02a1 017d 037c 0364 0064 0085 0264  .|...}.|.d.d...d
+00001730: 0064 0085 0264 0266 0319 007c 0364 0064  .d...d.f...|.d.d
+00001740: 0085 0264 0064 0085 0264 0366 0319 007c  ...d.d...d.f...|
+00001750: 0364 0064 0085 0264 0064 0085 0264 0566  .d.d...d.d...d.f
+00001760: 0319 0003 0302 037d 047d 057d 0664 067c  .......}.}.}.d.|
+00001770: 0414 0064 077c 0514 0017 0064 087c 0614  ...d.|.....d.|..
+00001780: 0017 007d 077c 077d 0774 00a0 097c 0264  ...}.|.}.t...|.d
+00001790: 0064 0085 0264 0064 0085 0264 0566 0319  .d...d.d...d.f..
+000017a0: 007c 07a1 027c 0264 0064 0085 0264 0064  .|...|.d.d...d.d
+000017b0: 0085 0264 0566 033c 007c 0264 0064 0085  ...d.f.<.|.d.d..
+000017c0: 0264 0064 0085 0264 0566 0319 0074 00a0  .d.d...d.f...t..
+000017d0: 0a7c 0264 0064 0085 0264 0064 0085 0264  .|.d.d...d.d...d
+000017e0: 0566 0319 00a1 011b 007c 0264 0064 0085  .f.......|.d.d..
+000017f0: 0264 0064 0085 0264 0566 033c 0074 07a0  .d.d...d.f.<.t..
+00001800: 087c 02a1 017d 037c 0353 0029 094e 7215  .|...}.|.S.).Nr.
+00001810: 0000 0072 0100 0000 7203 0000 00e9 0300  ...r....r.......
+00001820: 0000 7202 0000 0067 c58f 3177 2d21 d33f  ..r....g..1w-!.?
+00001830: 6762 1058 39b4 c8e2 3f67 c976 be9f 1a2f  gb.X9...?g.v.../
+00001840: bd3f 290b 7205 0000 0072 0600 0000 7207  .?).r....r....r.
+00001850: 0000 0072 0900 0000 da04 6f6e 6573 720d  ...r......onesr.
+00001860: 0000 00da 0566 6c6f 6f72 da04 6d70 6c63  .....floor..mplc
+00001870: da0a 6873 765f 746f 5f72 6762 da06 6469  ..hsv_to_rgb..di
+00001880: 7669 6465 7219 0000 0029 085a 0b70 6861  vider....).Z.pha
+00001890: 7365 5f69 6d61 6765 5a07 7369 7a65 5f69  se_imageZ.size_i
+000018a0: 6d5a 0668 7376 5f69 6d5a 0672 6762 5f69  mZ.hsv_imZ.rgb_i
+000018b0: 6dda 0172 da01 67da 0162 5a07 6772 6179  m..r..g..bZ.gray
+000018c0: 5f69 6d72 1200 0000 7212 0000 0072 1300  _imr....r....r..
+000018d0: 0000 da0b 7068 6173 655f 636f 6c6f 72d9  ....phase_color.
+000018e0: 0000 0073 1800 0000 1401 1801 2a01 4401  ...s........*.D.
+000018f0: 0a01 4601 1801 0401 3001 4401 0a01 0401  ..F.....0.D.....
+00001900: 723c 0000 00e9 0800 0000 6305 0000 0000  r<........c.....
+00001910: 0000 0000 0000 000a 0000 0007 0000 0043  ...............C
+00001920: 0000 0073 b200 0000 6401 7c04 1300 7d05  ...s....d.|...}.
+00001930: 7400 a001 7c02 7c05 a102 7d06 7c03 6400  t...|.|...}.|.d.
+00001940: 6b02 7217 7402 a003 7402 a004 7c00 a101  k.r.t...t...|...
+00001950: a101 7d07 6e02 7c03 7d07 6402 7c00 6401  ..}.n.|.}.d.|.d.
+00001960: 7c07 1400 1b00 1700 7d00 7402 a005 7c06  |.......}.t...|.
+00001970: 7c00 8301 6400 6400 8502 6400 6400 8502  |...d.d...d.d...
+00001980: 6403 6404 8502 6603 1900 a101 7d08 7406  d.d...f.....}.t.
+00001990: a007 7c08 a101 7d09 7c01 7402 a008 7c01  ..|...}.|.t...|.
+000019a0: a101 1800 7402 a003 7c01 a101 7402 a008  ....t...|...t...
+000019b0: 7c01 a101 1800 1b00 7c09 6400 6400 8502  |.......|.d.d...
+000019c0: 6400 6400 8502 6405 6603 3c00 7406 a009  d.d...d.f.<.t...
+000019d0: 7c09 a101 7d08 7c08 5300 2906 4e72 0200  |...}.|.S.).Nr..
+000019e0: 0000 e700 0000 0000 00e0 3f72 0100 0000  ..........?r....
+000019f0: 7233 0000 00e9 ffff ffff 290a da05 6d70  r3........)...mp
+00001a00: 6c63 6d5a 0867 6574 5f63 6d61 7072 0500  lcmZ.get_cmapr..
+00001a10: 0000 7219 0000 00da 0361 6273 7206 0000  ..r......absr...
+00001a20: 0072 3600 0000 5a0a 7267 625f 746f 5f68  .r6...Z.rgb_to_h
+00001a30: 7376 7218 0000 0072 3700 0000 290a da04  svr....r7...)...
+00001a40: 6461 7461 722c 0000 00da 0563 6f6c 6f72  datar,.....color
+00001a50: 5a06 636c 696d 6974 7221 0000 005a 0962  Z.climitr!...Z.b
+00001a60: 6974 5f72 616e 6765 5a06 696d 5f6d 6170  it_rangeZ.im_map
+00001a70: 5a08 6461 7461 5f6c 696d 5a09 7267 625f  Z.data_limZ.rgb_
+00001a80: 696d 6167 65da 0968 7376 5f69 6d61 6765  image..hsv_image
+00001a90: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
+00001aa0: 0b68 7376 5f6f 7665 726c 6179 e800 0000  .hsv_overlay....
+00001ab0: 7316 0000 0008 010c 0108 0112 0104 0210  s...............
+00001ac0: 0124 010a 0134 010a 0104 0172 4500 0000  .$...4.....rE...
+00001ad0: e920 0000 0063 0300 0000 0000 0000 0000  . ...c..........
+00001ae0: 0000 0b00 0000 0400 0000 4300 0000 7370  ..........C...sp
+00001af0: 0000 0064 017c 0213 007d 0374 00a0 017c  ...d.|...}.t...|
+00001b00: 01a1 017d 0474 00a0 017c 00a1 017d 0574  ...}.t...|...}.t
+00001b10: 00a0 027c 04a1 017c 031b 007d 0674 00a0  ...|...|...}.t..
+00001b20: 027c 05a1 017c 031b 007d 077c 047c 066b  .|...|...}.|.|.k
+00001b30: 007d 087c 057c 076b 007d 0964 027c 017c  .}.|.|.k.}.d.|.|
+00001b40: 083c 0064 037c 007c 093c 0074 00a0 037c  .<.d.|.|.<.t...|
+00001b50: 007c 01a1 027d 0a64 037c 0a7c 083c 007c  .|...}.d.|.|.<.|
+00001b60: 0a53 0029 0461 5403 0000 0a20 2020 2044  .S.).aT....    D
+00001b70: 6976 6964 6520 7477 6f20 7370 6172 7365  ivide two sparse
+00001b80: 206d 6174 7269 6365 7320 656c 656d 656e   matrices elemen
+00001b90: 7420 7769 7365 2074 6f20 7072 6576 656e  t wise to preven
+00001ba0: 7420 7a65 726f 730a 0a20 2020 2050 6172  t zeros..    Par
+00001bb0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00001bc0: 2d2d 2d2d 2d2d 0a20 2020 2073 7061 7365  ------.    spase
+00001bd0: 5f6e 756d 6572 3a20 6e64 6172 7261 790a  _numer: ndarray.
+00001be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001bf0: 204e 756d 7079 2061 7272 6179 206f 6620   Numpy array of 
+00001c00: 7265 616c 2076 616c 7565 6420 6e75 6d65  real valued nume
+00001c10: 7261 746f 720a 2020 2020 7370 6172 7365  rator.    sparse
+00001c20: 5f64 656e 6f6d 3a20 6e64 6172 7261 790a  _denom: ndarray.
+00001c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c40: 2020 4e75 6d70 7920 6172 7261 7920 6f66    Numpy array of
+00001c50: 2072 6561 6c20 7661 6c75 6564 2064 656e   real valued den
+00001c60: 6f6d 696e 6174 6f72 0a20 2020 2062 6974  ominator.    bit
+00001c70: 5f64 6570 7468 3a20 696e 740a 2020 2020  _depth: int.    
+00001c80: 2020 2020 2020 2020 2020 2042 6974 2064             Bit d
+00001c90: 6570 7468 206f 6620 6f75 7470 7574 2069  epth of output i
+00001ca0: 6d61 6765 0a20 2020 2020 2020 2020 2020  mage.           
+00001cb0: 2020 2020 4465 6661 756c 7420 6973 2033      Default is 3
+00001cc0: 320a 0a20 2020 2052 6574 7572 6e73 0a20  2..    Returns. 
+00001cd0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00001ce0: 6976 6964 6564 5f6d 6174 7269 783a 206e  ivided_matrix: n
+00001cf0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00001d00: 2020 2020 2020 2020 2020 2051 756f 7469             Quoti
+00001d10: 656e 7420 6d61 7472 6978 0a0a 2020 2020  ent matrix..    
+00001d20: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+00001d30: 2020 2020 4465 6369 6465 206f 6e20 6120      Decide on a 
+00001d40: 6269 7420 6465 7074 6820 6265 6c6f 7720  bit depth below 
+00001d50: 7768 6963 680a 2020 2020 7468 6520 7661  which.    the va
+00001d60: 6c75 6573 2069 6e20 7468 6520 6465 6e6f  lues in the deno
+00001d70: 6d69 6e61 746f 7220 6172 650a 2020 2020  minator are.    
+00001d80: 6a75 7374 206e 6f69 7365 2c20 6173 2074  just noise, as t
+00001d90: 6865 7920 6172 6520 6265 6c6f 7720 7468  hey are below th
+00001da0: 650a 2020 2020 6269 7420 6465 7074 682e  e.    bit depth.
+00001db0: 2044 6f20 7468 6520 7361 6d65 2066 6f72   Do the same for
+00001dc0: 2074 6865 0a20 2020 206e 756d 6572 6174   the.    numerat
+00001dd0: 6f72 2e20 5475 726e 2074 686f 7365 2076  or. Turn those v
+00001de0: 616c 7565 7320 746f 2031 2069 6e0a 2020  alues to 1 in.  
+00001df0: 2020 7468 6520 6465 6e6f 6d69 6e61 746f    the denominato
+00001e00: 7220 616e 6420 3020 696e 2074 6865 206e  r and 0 in the n
+00001e10: 756d 6572 6174 6f72 2e0a 2020 2020 5468  umerator..    Th
+00001e20: 656e 2069 6e20 7468 6520 7175 6f74 6965  en in the quotie
+00001e30: 6e74 206d 6174 7269 782c 2074 7572 6e20  nt matrix, turn 
+00001e40: 7468 650a 2020 2020 6465 6e6f 6d69 6e61  the.    denomina
+00001e50: 746f 7220 7661 6c75 6573 2062 656c 6f77  tor values below
+00001e60: 2074 6865 2074 6872 6573 686f 6c64 0a20   the threshold. 
+00001e70: 2020 2074 6f20 3020 746f 6f2e 0a0a 2020     to 0 too...  
+00001e80: 2020 3a41 7574 686f 7273 3a0a 2020 2020    :Authors:.    
+00001e90: 4465 6261 6e67 7368 7520 4d75 6b68 6572  Debangshu Mukher
+00001ea0: 6a65 6520 3c6d 756b 6865 726a 6565 6440  jee <mukherjeed@
+00001eb0: 6f72 6e6c 2e67 6f76 3e0a 2020 2020 7202  ornl.gov>.    r.
+00001ec0: 0000 0072 0300 0000 7201 0000 0029 0472  ...r....r....).r
+00001ed0: 0500 0000 7241 0000 0072 1900 0000 7238  ....rA...r....r8
+00001ee0: 0000 0029 0b5a 0c73 7061 7273 655f 6e75  ...).Z.sparse_nu
+00001ef0: 6d65 725a 0c73 7061 7273 655f 6465 6e6f  merZ.sparse_deno
+00001f00: 6d72 2100 0000 5a0b 6465 7074 685f 7261  mr!...Z.depth_ra
+00001f10: 7469 6f5a 0964 656e 6f6d 5f61 6273 5a09  tioZ.denom_absZ.
+00001f20: 6e75 6d65 725f 6162 735a 0f74 6872 6573  numer_absZ.thres
+00001f30: 686f 6c64 5f64 656e 6f6d 5a0f 7468 7265  hold_denomZ.thre
+00001f40: 7368 6f6c 645f 6e75 6d65 725a 1374 6872  shold_numerZ.thr
+00001f50: 6573 686f 6c64 5f69 6e64 5f64 656e 6f6d  eshold_ind_denom
+00001f60: 5a13 7468 7265 7368 6f6c 645f 696e 645f  Z.threshold_ind_
+00001f70: 6e75 6d65 725a 0e64 6976 6964 6564 5f6d  numerZ.divided_m
+00001f80: 6174 7269 7872 1200 0000 7212 0000 0072  atrixr....r....r
+00001f90: 1300 0000 da0f 7370 6172 7365 5f64 6976  ......sparse_div
+00001fa0: 6973 696f 6ef7 0000 0073 1800 0000 0822  ision....s....."
+00001fb0: 0a01 0a01 0e01 0e01 0801 0801 0801 0801  ................
+00001fc0: 0c01 0801 0401 7247 0000 0054 6303 0000  ......rG...Tc...
+00001fd0: 0000 0000 0000 0000 0008 0000 0008 0000  ................
+00001fe0: 0043 0000 0073 9000 0000 7c02 7228 7c00  .C...s....|.r(|.
+00001ff0: 7400 a001 7c00 6401 1300 a101 6402 1300  t...|.d.....d...
+00002000: 1b00 7d03 7c01 7400 a001 7c01 6401 1300  ..}.|.t...|.d...
+00002010: a101 6402 1300 1b00 7d04 7400 6a02 a003  ..d.....}.t.j...
+00002020: 7c03 a101 7d05 7400 a004 7400 6a02 a003  |...}.t...t.j...
+00002030: 7c04 a101 a101 7d06 6e0f 7400 6a02 a003  |.....}.n.t.j...
+00002040: 7c00 a101 7d05 7400 a004 7400 6a02 a003  |...}.t...t.j...
+00002050: 7c01 a101 a101 7d06 7400 a005 7400 6a02  |.....}.t...t.j.
+00002060: a006 7400 6a02 a007 7c05 7c06 1400 a101  ..t.j...|.|.....
+00002070: a101 a101 7d07 7c07 5300 a903 4e72 0200  ....}.|.S...Nr..
+00002080: 0000 723e 0000 0029 0872 0500 0000 da03  ..r>...).r......
+00002090: 7375 6d72 0e00 0000 720f 0000 00da 0463  sumr....r......c
+000020a0: 6f6e 6a72 4100 0000 da09 6966 6674 7368  onjrA.....ifftsh
+000020b0: 6966 7472 1000 0000 2908 da07 696d 6167  iftr....)...imag
+000020c0: 655f 31da 0769 6d61 6765 5f32 da06 6e6f  e_1..image_2..no
+000020d0: 726d 616c da08 696d 315f 6e6f 726d da08  rmal..im1_norm..
+000020e0: 696d 325f 6e6f 726d da07 696d 315f 6666  im2_norm..im1_ff
+000020f0: 74da 0769 6d32 5f66 6674 da08 636f 7272  t..im2_fft..corr
+00002100: 5f66 6674 7212 0000 0072 1200 0000 7213  _fftr....r....r.
+00002110: 0000 00da 1363 726f 7373 5f63 6f72 725f  .....cross_corr_
+00002120: 756e 7061 6464 6564 2701 0000 7312 0000  unpadded'...s...
+00002130: 0004 0116 0116 010c 0114 010c 0212 011e  ................
+00002140: 0104 0172 5400 0000 6304 0000 0000 0000  ...rT...c.......
+00002150: 0000 0000 0011 0000 0006 0000 0043 0000  .............C..
+00002160: 0073 4e01 0000 7400 a001 7400 a002 7c00  .sN...t...t...|.
+00002170: a101 a101 7d04 7400 a003 7c04 6401 1b00  ....}.t...|.d...
+00002180: a101 a004 7405 a101 7d05 7c03 724a 7c00  ....t...}.|.rJ|.
+00002190: 7400 a006 7c00 6401 1300 a101 6402 1300  t...|.d.....d...
+000021a0: 1b00 7d06 7400 6a07 7c06 7c05 6403 6404  ..}.t.j.|.|.d.d.
+000021b0: 8d03 7d07 7c01 7400 a006 7c01 6401 1300  ..}.|.t...|.d...
+000021c0: a101 6402 1300 1b00 7d08 7400 6a07 7c08  ..d.....}.t.j.|.
+000021d0: 7c05 6403 6404 8d03 7d09 7400 6a08 a009  |.d.d...}.t.j...
+000021e0: 7c07 a101 7d0a 7400 a00a 7400 6a08 a009  |...}.t...t.j...
+000021f0: 7c09 a101 a101 7d0b 6e1f 7400 6a07 7c00  |.....}.n.t.j.|.
+00002200: 7c05 6403 6404 8d03 7d07 7400 6a07 7c01  |.d.d...}.t.j.|.
+00002210: 7c05 6403 6404 8d03 7d09 7400 6a08 a009  |.d.d...}.t.j...
+00002220: 7c07 a101 7d0a 7400 a00a 7400 6a08 a009  |...}.t...t.j...
+00002230: 7c09 a101 a101 7d0b 7400 a00b 7c0a 7c0b  |.....}.t...|.|.
+00002240: a102 7d0c 7400 a00c 7c0c a101 7c02 1300  ..}.t...|...|...
+00002250: 7d0d 740d 7c0c 7c0d 6405 8303 7d0e 7400  }.t.|.|.d...}.t.
+00002260: 6a08 a00e 7c0e a101 7d0f 7400 a00c 7400  j...|...}.t...t.
+00002270: 6a08 a00f 7c0f a101 a101 7d0f 7c0f 7c05  j...|.....}.|.|.
+00002280: 6406 1900 7c05 6406 1900 7c04 6406 1900  d...|.d...|.d...
+00002290: 1700 8502 7c05 6407 1900 7c05 6407 1900  ....|.d...|.d...
+000022a0: 7c04 6407 1900 1700 8502 6602 1900 7d10  |.d.......f...}.
+000022b0: 7c10 5300 2908 616d 0600 000a 2020 2020  |.S.).am....    
+000022c0: 4e6f 726d 616c 697a 6564 2043 6f72 7265  Normalized Corre
+000022d0: 6c61 7469 6f6e 2c20 616c 6c6f 7769 6e67  lation, allowing
+000022e0: 2066 6f72 2068 7962 7269 6469 7a61 7469   for hybridizati
+000022f0: 6f6e 0a20 2020 2077 6974 6820 6372 6f73  on.    with cros
+00002300: 7320 636f 7272 656c 6174 696f 6e20 6265  s correlation be
+00002310: 696e 6720 7468 6520 6465 6661 756c 7420  ing the default 
+00002320: 6f75 7470 7574 2069 660a 2020 2020 6e6f  output if.    no
+00002330: 2068 7962 7269 6469 7a61 7469 6f6e 2070   hybridization p
+00002340: 6172 616d 6574 6572 2069 7320 6769 7665  arameter is give
+00002350: 6e0a 0a20 2020 2050 6172 616d 6574 6572  n..    Parameter
+00002360: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00002370: 0a20 2020 2069 6d61 6765 5f31 3a20 6e64  .    image_1: nd
+00002380: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00002390: 2020 2046 6972 7374 2069 6d61 6765 0a20     First image. 
+000023a0: 2020 2069 6d61 6765 5f32 3a20 6e64 6172     image_2: ndar
+000023b0: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
+000023c0: 2053 6563 6f6e 6420 696d 6167 650a 2020   Second image.  
+000023d0: 2020 6879 6272 6964 697a 6572 3a20 666c    hybridizer: fl
+000023e0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+000023f0: 2020 2020 4879 6272 6964 697a 6174 696f      Hybridizatio
+00002400: 6e20 7061 7261 6d65 7465 7220 6265 7477  n parameter betw
+00002410: 6565 6e20 3020 616e 6420 310a 2020 2020  een 0 and 1.    
+00002420: 2020 2020 2020 2020 2020 2020 3020 6973              0 is
+00002430: 2070 7572 6520 6372 6f73 7320 636f 7272   pure cross corr
+00002440: 656c 6174 696f 6e0a 2020 2020 2020 2020  elation.        
+00002450: 2020 2020 2020 2020 3120 6973 2070 7572          1 is pur
+00002460: 6520 7068 6173 6520 636f 7272 656c 6174  e phase correlat
+00002470: 696f 6e0a 0a20 2020 2052 6574 7572 6e73  ion..    Returns
+00002480: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00002490: 2063 6f72 725f 6879 6272 6964 3a20 6e64   corr_hybrid: nd
+000024a0: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+000024b0: 2020 2020 2020 2043 6f6d 706c 6578 2076         Complex v
+000024c0: 616c 7565 6420 636f 7272 656c 6174 696f  alued correlatio
+000024d0: 6e20 6f75 7470 7574 0a0a 2020 2020 4e6f  n output..    No
+000024e0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
+000024f0: 2020 5468 6520 6372 6f73 732d 636f 7272    The cross-corr
+00002500: 656c 6174 696f 6e20 7468 656f 7265 6d20  elation theorem 
+00002510: 6361 6e20 6265 2073 7461 7465 6420 6173  can be stated as
+00002520: 3a0a 2020 2020 2e2e 206d 6174 683a 3a0a  :.    .. math::.
+00002530: 2020 2020 2020 2020 2047 5f63 203d 2047           G_c = G
+00002540: 5f31 2009 696d 6573 2047 5f32 5e2a 0a0a  _1 .imes G_2^*..
+00002550: 2020 2020 7768 6572 6520 3a6d 6174 683a      where :math:
+00002560: 6047 5f63 6020 6973 2074 6865 2046 6f75  `G_c` is the Fou
+00002570: 7269 6572 2074 7261 6e73 666f 726d 206f  rier transform o
+00002580: 6620 7468 6520 6372 6f73 730a 2020 2020  f the cross.    
+00002590: 636f 7272 656c 6174 6564 206d 6174 7269  correlated matri
+000025a0: 7820 616e 6420 3a6d 6174 683a 6047 5f31  x and :math:`G_1
+000025b0: 6020 616e 6420 3a6d 6174 683a 6047 5f32  ` and :math:`G_2
+000025c0: 6020 6172 650a 2020 2020 7468 6520 466f  ` are.    the Fo
+000025d0: 7572 6965 7220 7472 616e 7366 6f72 6d73  urier transforms
+000025e0: 206f 6620 3a6d 6174 683a 6067 5f31 6020   of :math:`g_1` 
+000025f0: 616e 6420 3a6d 6174 683a 6067 5f32 600a  and :math:`g_2`.
+00002600: 2020 2020 7265 7370 6563 7469 7665 6c79      respectively
+00002610: 2c20 7768 6963 6820 6172 6520 7468 6520  , which are the 
+00002620: 6f72 6967 696e 616c 206d 6174 7269 6365  original matrice
+00002630: 732e 2054 6869 7320 6973 2070 7572 650a  s. This is pure.
+00002640: 2020 2020 6372 6f73 732d 636f 7272 656c      cross-correl
+00002650: 6174 696f 6e2e 2050 6861 7365 2063 6f72  ation. Phase cor
+00002660: 7265 6c61 7469 6f6e 2063 616e 2062 6520  relation can be 
+00002670: 6578 7072 6573 7365 6420 6173 3a0a 2020  expressed as:.  
+00002680: 2020 2e2e 206d 6174 683a 3a0a 2020 2020    .. math::.    
+00002690: 2020 2020 2047 5f63 203d 200c 7261 637b       G_c = .rac{
+000026a0: 475f 3120 0969 6d65 7320 475f 325e 2a7d  G_1 .imes G_2^*}
+000026b0: 7b5c 6d69 6420 475f 3120 0969 6d65 7320  {\mid G_1 .imes 
+000026c0: 475f 325e 2a20 5c6d 6964 7d0a 0a20 2020  G_2^* \mid}..   
+000026d0: 2054 6875 732c 2077 6520 6361 6e20 6e6f   Thus, we can no
+000026e0: 7720 6465 6669 6e65 2061 2068 7962 7269  w define a hybri
+000026f0: 6420 6372 6f73 732d 636f 7272 656c 6174  d cross-correlat
+00002700: 696f 6e20 7768 6572 650a 2020 2020 2e2e  ion where.    ..
+00002710: 206d 6174 683a 3a0a 2020 2020 2020 2020   math::.        
+00002720: 2047 5f63 203d 200c 7261 637b 475f 3120   G_c = .rac{G_1 
+00002730: 0969 6d65 7320 475f 325e 2a7d 7b5c 6d69  .imes G_2^*}{\mi
+00002740: 6420 475f 3120 0969 6d65 7320 475f 325e  d G_1 .imes G_2^
+00002750: 2a20 5c6d 6964 205e 6e7d 0a0a 2020 2020  * \mid ^n}..    
+00002760: 4966 206e 2069 7320 302c 2077 6520 6861  If n is 0, we ha
+00002770: 7665 2063 726f 7373 2063 6f72 7265 6c61  ve cross correla
+00002780: 7469 6f6e 2c20 616e 6420 6966 206e 2069  tion, and if n i
+00002790: 7320 3120 7765 0a20 2020 2068 6176 6520  s 1 we.    have 
+000027a0: 7068 6173 6520 636f 7272 656c 6174 696f  phase correlatio
+000027b0: 6e2e 0a0a 2020 2020 5265 6665 7265 6e63  n...    Referenc
+000027c0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  es.    ---------
+000027d0: 2d0a 2020 2020 315d 5f2c 2050 656b 696e  -.    1]_, Pekin
+000027e0: 2c20 542e 432e 2c20 4761 6d6d 6572 2c20  , T.C., Gammer, 
+000027f0: 432e 2c20 4369 7374 6f6e 2c20 4a2e 2c20  C., Ciston, J., 
+00002800: 4d69 6e6f 722c 2041 2e4d 2e20 616e 6420  Minor, A.M. and 
+00002810: 4f70 6875 732c 2043 2e2c 0a20 2020 2020  Ophus, C.,.     
+00002820: 2020 2020 3230 3137 2e20 4f70 7469 6d69      2017. Optimi
+00002830: 7a69 6e67 2064 6973 6b20 7265 6769 7374  zing disk regist
+00002840: 7261 7469 6f6e 2061 6c67 6f72 6974 686d  ration algorithm
+00002850: 7320 666f 7220 6e61 6e6f 6265 616d 0a20  s for nanobeam. 
+00002860: 2020 2020 2020 2020 656c 6563 7472 6f6e          electron
+00002870: 2064 6966 6672 6163 7469 6f6e 2073 7472   diffraction str
+00002880: 6169 6e20 6d61 7070 696e 672e 2055 6c74  ain mapping. Ult
+00002890: 7261 6d69 6372 6f73 636f 7079 2c20 3137  ramicroscopy, 17
+000028a0: 362c 0a20 2020 2020 2020 2020 7070 2e31  6,.         pp.1
+000028b0: 3730 2d31 3736 2e0a 0a20 2020 2053 6565  70-176...    See
+000028c0: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
+000028d0: 2d2d 0a20 2020 2073 7061 7273 655f 6469  --.    sparse_di
+000028e0: 7669 7369 6f6e 0a0a 2020 2020 3a41 7574  vision..    :Aut
+000028f0: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
+00002900: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
+00002910: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
+00002920: 6f76 3e0a 2020 2020 7202 0000 0072 3e00  ov>.    r....r>.
+00002930: 0000 da06 6d65 6469 616e 2902 5a09 7061  ....median).Z.pa
+00002940: 645f 7769 6474 68da 046d 6f64 6572 4600  d_width..moderF.
+00002950: 0000 7201 0000 0072 0300 0000 2910 7205  ..r....r....).r.
+00002960: 0000 0072 0600 0000 7207 0000 00da 0572  ...r....r......r
+00002970: 6f75 6e64 7208 0000 0072 0900 0000 7249  oundr....r....rI
+00002980: 0000 0072 2f00 0000 720e 0000 0072 0f00  ...r/...r....r..
+00002990: 0000 724a 0000 0072 0b00 0000 7241 0000  ..rJ...r....rA..
+000029a0: 0072 4700 0000 7210 0000 0072 4b00 0000  .rG...r....rK...
+000029b0: 2911 724c 0000 0072 4d00 0000 5a0a 6879  ).rL...rM...Z.hy
+000029c0: 6272 6964 697a 6572 724e 0000 005a 0769  bridizerrN...Z.i
+000029d0: 6d5f 7369 7a65 5a08 7061 645f 7369 7a65  m_sizeZ.pad_size
+000029e0: 724f 0000 005a 0769 6d31 5f70 6164 7250  rO...Z.im1_padrP
+000029f0: 0000 005a 0769 6d32 5f70 6164 7251 0000  ...Z.im2_padrQ..
+00002a00: 0072 5200 0000 7253 0000 005a 0863 6f72  .rR...rS...Z.cor
+00002a10: 725f 6162 735a 0f63 6f72 725f 6879 6272  r_absZ.corr_hybr
+00002a20: 6964 5f66 6674 5a0b 636f 7272 5f68 7962  id_fftZ.corr_hyb
+00002a30: 7269 645a 0d63 6f72 725f 756e 7061 6464  ridZ.corr_unpadd
+00002a40: 6564 7212 0000 0072 1200 0000 7213 0000  edr....r....r...
+00002a50: 00da 0a63 726f 7373 5f63 6f72 7234 0100  ...cross_corr4..
+00002a60: 0073 2c00 0000 1039 1401 0401 1601 1001  .s,....9........
+00002a70: 1601 1001 0c01 1401 1002 1001 0c01 1201  ................
+00002a80: 0c01 0e01 0c01 0c01 1201 0201 2e01 04ff  ................
+00002a90: 0403 7258 0000 0063 0400 0000 0000 0000  ..rX...c........
+00002aa0: 0000 0000 0a00 0000 0400 0000 4300 0000  ............C...
+00002ab0: 735e 0000 007c 0064 0119 007d 047c 0064  s^...|.d...}.|.d
+00002ac0: 0219 007d 0574 006a 0164 017c 0485 0264  ...}.t.j.d.|...d
+00002ad0: 017c 0585 0266 0219 005c 027d 067d 077c  .|...f...\.}.}.|
+00002ae0: 067c 0218 0064 0313 007c 077c 0118 0064  .|...d...|.|...d
+00002af0: 0313 0017 0064 0413 007c 036b 007d 0874  .....d...|.k.}.t
+00002b00: 006a 027c 0874 006a 0364 058d 027d 097c  .j.|.t.j.d...}.|
+00002b10: 0953 0029 0661 0602 0000 0a20 2020 204d  .S.).a.....    M
+00002b20: 616b 6520 6120 6369 7263 6c65 0a0a 2020  ake a circle..  
+00002b30: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00002b40: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00002b50: 7369 7a65 5f63 6972 633a 206e 6461 7272  size_circ: ndarr
+00002b60: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00002b70: 2020 3220 656c 656d 656e 7420 6172 7261    2 element arra
+00002b80: 7920 6769 7669 6e67 2074 6865 2073 697a  y giving the siz
+00002b90: 6520 6f66 2074 6865 206f 7574 7075 7420  e of the output 
+00002ba0: 6d61 7472 6978 0a20 2020 2063 656e 7465  matrix.    cente
+00002bb0: 725f 783a 2066 6c6f 6174 0a20 2020 2020  r_x: float.     
+00002bc0: 2020 2020 2020 2020 2078 2070 6f73 6974           x posit
+00002bd0: 696f 6e20 6f66 2063 6972 636c 6520 6365  ion of circle ce
+00002be0: 6e74 6572 0a20 2020 2063 656e 7465 725f  nter.    center_
+00002bf0: 793a 2066 6c6f 6174 0a20 2020 2020 2020  y: float.       
+00002c00: 2020 2020 2020 2079 2070 6f73 6974 696f         y positio
+00002c10: 6e20 6f66 2063 6972 636c 6520 6365 6e74  n of circle cent
+00002c20: 6572 0a20 2020 2072 6164 6975 733a 2066  er.    radius: f
+00002c30: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
+00002c40: 2072 6164 6975 7320 6f66 2074 6865 2063   radius of the c
+00002c50: 6972 636c 650a 0a20 2020 2052 6574 7572  ircle..    Retur
+00002c60: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00002c70: 2020 2063 6972 636c 653a 206e 6461 7272     circle: ndarr
+00002c80: 6179 0a20 2020 2020 2020 2020 2020 2070  ay.            p
+00002c90: 2058 2071 2073 697a 6564 2061 7272 6179   X q sized array
+00002ca0: 2077 6865 7265 2074 6865 2069 7420 6973   where the it is
+00002cb0: 2031 0a20 2020 2020 2020 2020 2020 2069   1.            i
+00002cc0: 6e73 6964 6520 7468 6520 6369 7263 6c65  nside the circle
+00002cd0: 2061 6e64 2030 206f 7574 7369 6465 0a0a   and 0 outside..
+00002ce0: 2020 2020 3a41 7574 686f 7273 3a0a 2020      :Authors:.  
+00002cf0: 2020 4465 6261 6e67 7368 7520 4d75 6b68    Debangshu Mukh
+00002d00: 6572 6a65 6520 3c6d 756b 6865 726a 6565  erjee <mukherjee
+00002d10: 6440 6f72 6e6c 2e67 6f76 3e0a 2020 2020  d@ornl.gov>.    
+00002d20: 7201 0000 0072 0300 0000 7202 0000 0072  r....r....r....r
+00002d30: 3e00 0000 7215 0000 0029 0472 0500 0000  >...r....).r....
+00002d40: 7224 0000 0072 0600 0000 720a 0000 0029  r$...r....r....)
+00002d50: 0a5a 0973 697a 655f 6369 7263 da08 6365  .Z.size_circ..ce
+00002d60: 6e74 6572 5f78 da08 6365 6e74 6572 5f79  nter_x..center_y
+00002d70: da06 7261 6469 7573 da01 70da 0171 da02  ..radius..p..q..
+00002d80: 7956 da02 7856 da03 7375 625a 0663 6972  yV..xV..subZ.cir
+00002d90: 636c 6572 1200 0000 7212 0000 0072 1300  cler....r....r..
+00002da0: 0000 da0b 6d61 6b65 5f63 6972 636c 6586  ....make_circle.
+00002db0: 0100 0073 0c00 0000 0818 0801 1a01 2001  ...s.......... .
+00002dc0: 1001 0401 7261 0000 00e9 0400 0000 6303  ....ra........c.
+00002dd0: 0000 0000 0000 0000 0000 0011 0000 0007  ................
+00002de0: 0000 0043 0000 0073 8c01 0000 7400 a001  ...C...s....t...
+00002df0: 7c00 6a02 a101 a003 7404 a101 7d03 7c00  |.j.....t...}.|.
+00002e00: 7400 a005 7c00 a101 1800 7400 a006 7c00  t...|.....t...|.
+00002e10: a101 7400 a005 7c00 a101 1800 1b00 7d04  ..t...|.......}.
+00002e20: 7400 a007 6401 a101 7d05 7400 a008 7c03  t...d...}.t...|.
+00002e30: 6402 6401 8502 1900 6403 7c01 1b00 1400  d.d.....d.|.....
+00002e40: a101 7c05 6402 6401 8502 3c00 7c05 a003  ..|.d.d...<.|...
+00002e50: 7404 a101 7d05 7400 a009 7c05 7c03 6401  t...}.t...|.|.d.
+00002e60: 1900 7c03 6404 1900 6602 a102 7d06 7400  ..|.d...f...}.t.
+00002e70: a007 7c06 a101 7d07 740a 7c03 6404 1900  ..|...}.t.|.d...
+00002e80: 8301 4400 5d60 7d08 740a 7c03 6401 1900  ..D.]`}.t.|.d...
+00002e90: 8301 4400 5d57 7d09 7c04 6405 6405 8502  ..D.]W}.|.d.d...
+00002ea0: 6405 6405 8502 7c09 7c08 6604 1900 7d0a  d.d...|.|.f...}.
+00002eb0: 7c09 7c05 6402 1900 1400 7400 a00b 7c05  |.|.d.....t...|.
+00002ec0: 6402 1900 a101 1700 7d0b 7404 7c0b 6402  d.......}.t.|.d.
+00002ed0: 1900 8301 7d0c 6403 7404 7c0b 6406 1900  ....}.d.t.|.d...
+00002ee0: 8301 1700 7d0d 7c08 7c05 6403 1900 1400  ....}.|.|.d.....
+00002ef0: 7400 a00b 7c05 6403 1900 a101 1700 7d0e  t...|.d.......}.
+00002f00: 7404 7c0e 6402 1900 8301 7d0f 6403 7404  t.|.d.....}.d.t.
+00002f10: 7c0e 6406 1900 8301 1700 7d10 740c 6a0d  |.d.......}.t.j.
+00002f20: a00e 7c0a 6403 1700 7c01 a102 6403 1800  ..|.d...|...d...
+00002f30: 7c07 7c0c 7c0d 8502 7c0f 7c10 8502 6602  |.|.|...|.|...f.
+00002f40: 3c00 7154 714c 7c07 7400 a005 7c07 a101  <.qTqL|.t...|...
+00002f50: 1800 7d07 6401 7c02 1300 7c07 7400 a006  ..}.d.|...|.t...
+00002f60: 7c07 a101 1b00 1400 7d07 7c07 a003 7404  |.......}.|...t.
+00002f70: a101 7d07 7c07 5300 2907 7a3a 0a20 2020  ..}.|.S.).z:.   
+00002f80: 2047 656e 6572 6174 6520 6120 7469 6c65   Generate a tile
+00002f90: 6420 7061 7474 6572 6e20 6f66 2074 6865  d pattern of the
+00002fa0: 2034 442d 5354 454d 2064 6174 6173 6574   4D-STEM dataset
+00002fb0: 0a0a 2020 2020 7202 0000 0072 0100 0000  ..    r....r....
+00002fc0: 7203 0000 0072 3300 0000 4e72 3f00 0000  r....r3...Nr?...
+00002fd0: 290f 7205 0000 0072 0600 0000 7207 0000  ).r....r....r...
+00002fe0: 0072 0800 0000 7209 0000 0072 1800 0000  .r....r....r....
+00002ff0: 7219 0000 0072 2b00 0000 7257 0000 0072  r....r+...rW...r
+00003000: 0b00 0000 7226 0000 00da 0661 7261 6e67  ....r&.....arang
+00003010: 6572 1e00 0000 721f 0000 00da 0972 6573  er....r......res
+00003020: 697a 6572 3244 2911 5a0a 6461 7461 7365  izer2D).Z.datase
+00003030: 745f 3444 da07 7265 6475 6365 7272 2100  t_4D..reducerr!.
+00003040: 0000 5a09 7369 7a65 5f64 6174 615a 0d6e  ..Z.size_dataZ.n
+00003050: 6f72 6d61 6c69 7a65 645f 3444 5a0c 7265  ormalized_4DZ.re
+00003060: 6475 6365 645f 7369 7a65 5a09 7469 6c65  duced_sizeZ.tile
+00003070: 5f73 697a 655a 0a69 6d61 6765 5f74 696c  _sizeZ.image_til
+00003080: 65da 026a 6ada 0269 69da 0672 6f6e 6368  e..jj..ii..ronch
+00003090: 695a 0678 5261 6e67 655a 0678 5374 6172  iZ.xRangeZ.xStar
+000030a0: 745a 0478 456e 645a 0679 5261 6e67 655a  tZ.xEndZ.yRangeZ
+000030b0: 0679 5374 6172 745a 0479 456e 6472 1200  .yStartZ.yEndr..
+000030c0: 0000 7212 0000 0072 1300 0000 da0b 696d  ..r....r......im
+000030d0: 6167 655f 7469 6c65 72a6 0100 0073 3200  age_tiler....s2.
+000030e0: 0000 1205 0c01 1201 04ff 0a03 2201 0a01  ............"...
+000030f0: 1801 0a01 1001 1001 1801 1a01 0c01 1001  ................
+00003100: 1a01 0c01 1001 1402 14ff 02f8 0e0b 1601  ................
+00003110: 0a01 0401 7269 0000 0063 0100 0000 0000  ....ri...c......
+00003120: 0000 0000 0000 0700 0000 0800 0000 4300  ..............C.
+00003130: 0000 73a0 0000 0074 00a0 0164 01a1 0101  ..s....t...d....
+00003140: 0074 02a0 037c 006a 04a1 01a0 0574 06a1  .t...|.j.....t..
+00003150: 017d 0174 02a0 077c 0164 0219 007c 0164  .}.t...|.d...|.d
+00003160: 0319 007c 0164 0419 007c 0164 0519 0066  ...|.d...|.d...f
+00003170: 04a1 017d 0274 087c 0164 0519 0083 0144  ...}.t.|.d.....D
+00003180: 005d 287d 0374 087c 0164 0419 0083 0144  .](}.t.|.d.....D
+00003190: 005d 1f7d 047c 0064 0664 0685 0264 0664  .].}.|.d.d...d.d
+000031a0: 0685 027c 047c 0366 0419 007d 0574 02a0  ...|.|.f...}.t..
+000031b0: 097c 05a1 017d 067c 067c 0264 0664 0685  .|...}.|.|.d.d..
+000031c0: 0264 0664 0685 027c 047c 0366 043c 0071  .d.d...|.|.f.<.q
+000031d0: 2d71 257c 0253 0029 0761 db01 0000 0a20  -q%|.S.).a..... 
+000031e0: 2020 2043 6f72 7265 6374 696e 6720 496d     Correcting Im
+000031f0: 6167 6520 466c 6970 0a0a 2020 2020 5061  age Flip..    Pa
+00003200: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00003210: 2d2d 2d2d 2d2d 2d0a 2020 2020 696d 6167  -------.    imag
+00003220: 655f 6f72 6967 3a20 6e64 6172 7261 790a  e_orig: ndarray.
+00003230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003240: 2764 6174 6134 4427 2069 7320 7468 6520  'data4D' is the 
+00003250: 6f72 6967 696e 616c 2034 4420 6461 7461  original 4D data
+00003260: 7365 7420 696e 2074 6865 0a20 2020 2020  set in the.     
+00003270: 2020 2020 2020 2020 2020 2066 6f72 6d20             form 
+00003280: 4469 6666 582c 4469 6666 592c 5363 616e  DiffX,DiffY,Scan
+00003290: 582c 5363 616e 590a 0a20 2020 2052 6574  X,ScanY..    Ret
+000032a0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+000032b0: 0a20 2020 2069 6d61 6765 5f6e 6f72 6d3a  .    image_norm:
+000032c0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+000032d0: 2020 2020 2020 2020 2046 6c69 7020 636f           Flip co
+000032e0: 7272 6563 7465 6420 3444 2064 6174 6173  rrected 4D datas
+000032f0: 6574 0a0a 2020 2020 4e6f 7465 730a 2020  et..    Notes.  
+00003300: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6520    -----.    The 
+00003310: 6d69 6372 6f73 636f 7065 206c 656e 7365  microscope lense
+00003320: 7320 6d61 7920 6164 6420 6120 666c 6970  s may add a flip
+00003330: 2069 6e0a 2020 2020 7468 6520 5820 6469   in.    the X di
+00003340: 7265 6374 696f 6e20 6f66 2074 6865 2072  rection of the r
+00003350: 6f6e 6368 6967 7261 6d2e 2054 6869 730a  onchigram. This.
+00003360: 2020 2020 636f 7272 6563 7473 2066 6f72      corrects for
+00003370: 2074 6861 742e 0a0a 2020 2020 3a41 7574   that...    :Aut
+00003380: 686f 7273 3a0a 2020 2020 4465 6261 6e67  hors:.    Debang
+00003390: 7368 7520 4d75 6b68 6572 6a65 6520 3c6d  shu Mukherjee <m
+000033a0: 756b 6865 726a 6565 6440 6f72 6e6c 2e67  ukherjeed@ornl.g
+000033b0: 6f76 3e0a 0a20 2020 20da 0669 676e 6f72  ov>..    ..ignor
+000033c0: 6572 0100 0000 7203 0000 0072 0200 0000  er....r....r....
+000033d0: 7233 0000 004e 290a da08 7761 726e 696e  r3...N)...warnin
+000033e0: 6773 da0e 6669 6c74 6572 7761 726e 696e  gs..filterwarnin
+000033f0: 6773 7205 0000 0072 0600 0000 7207 0000  gsr....r....r...
+00003400: 0072 0800 0000 7209 0000 0072 2b00 0000  .r....r....r+...
+00003410: 7226 0000 005a 0666 6c69 706c 7229 075a  r&...Z.fliplr).Z
+00003420: 0664 6174 6134 445a 0864 6174 6173 697a  .data4DZ.datasiz
+00003430: 655a 0966 6c69 7070 6564 3444 7266 0000  eZ.flipped4Drf..
+00003440: 0072 6700 0000 7268 0000 005a 0b72 6f6e  .rg...rh...Z.ron
+00003450: 6368 695f 666c 6970 7212 0000 0072 1200  chi_flipr....r..
+00003460: 0000 7213 0000 00da 0e66 6c69 705f 636f  ..r......flip_co
+00003470: 7272 6563 746f 72c6 0100 0073 1400 0000  rrector....s....
+00003480: 0a19 1201 2201 1001 1001 1801 0a01 1a01  ...."...........
+00003490: 02fd 0404 726d 0000 0063 0100 0000 0000  ....rm...c......
+000034a0: 0000 0000 0000 0400 0000 0300 0000 4300  ..............C.
+000034b0: 0000 731e 0000 007c 0064 0113 007d 0174  ..s....|.d...}.t
+000034c0: 00a0 017c 01a1 017d 027c 0264 0213 007d  ...|...}.|.d...}
+000034d0: 037c 0353 0072 4800 0000 2902 7205 0000  .|.S.rH...).r...
+000034e0: 00da 046d 6561 6e29 045a 0361 7272 5a06  ...mean).Z.arrZ.
+000034f0: 6172 725f 7371 5a08 6172 725f 6d65 616e  arr_sqZ.arr_mean
+00003500: 5a07 6172 725f 726d 7372 1200 0000 7212  Z.arr_rmsr....r.
+00003510: 0000 0072 1300 0000 da09 6172 7261 795f  ...r......array_
+00003520: 726d 73ea 0100 0073 0800 0000 0801 0a01  rms....s........
+00003530: 0801 0401 726f 0000 0063 0100 0000 0000  ....ro...c......
+00003540: 0000 0000 0000 0b00 0000 0600 0000 4300  ..............C.
+00003550: 0000 73bc 0000 0074 006a 01a0 027c 00a1  ..s....t.j...|..
+00003560: 015c 027d 017d 0274 036a 0464 017c 016a  .\.}.}.t.j.d.|.j
+00003570: 0564 0119 0085 0264 017c 016a 0564 0219  .d.....d.|.j.d..
+00003580: 0085 0266 0219 005c 027d 037d 0474 03a0  ...f...\.}.}.t..
+00003590: 0674 076a 08a0 097c 01a1 01a1 015c 027d  .t.j...|.....\.}
+000035a0: 057d 067c 037c 0518 0064 0313 007c 047c  .}.|.|...d...|.|
+000035b0: 0618 0064 0313 0017 0064 0413 007d 0774  ...d.....d...}.t
+000035c0: 006a 01a0 0a74 03a0 0b7c 07a1 0174 03a0  .j...t...|...t..
+000035d0: 0b7c 01a1 0164 05a1 037d 0874 0c6a 0d74  .|...d...}.t.j.t
+000035e0: 006a 016a 0e74 03a0 0b7c 07a1 0174 03a0  .j.j.t...|...t..
+000035f0: 0b7c 01a1 017c 0864 068d 045c 027d 097d  .|...|.d...\.}.}
+00003600: 027c 0964 0119 007d 0a7c 067c 057c 0a66  .|.d...}.|.|.|.f
+00003610: 0353 0029 074e 7201 0000 0072 0300 0000  .S.).Nr....r....
+00003620: 7202 0000 0072 3e00 0000 5a06 6d61 7869  r....r>...Z.maxi
+00003630: 6d61 2903 5a05 7864 6174 615a 0579 6461  ma).Z.xdataZ.yda
+00003640: 7461 5a02 7030 290f 721e 0000 0072 1f00  taZ.p0).r....r..
+00003650: 0000 5a05 736f 6265 6c72 0500 0000 7224  ..Z.sobelr....r$
+00003660: 0000 0072 0700 0000 7206 0000 00da 0473  ...r....r......s
+00003670: 636e 645a 0c6d 6561 7375 7265 6d65 6e74  cndZ.measurement
+00003680: 735a 0e63 656e 7465 725f 6f66 5f6d 6173  sZ.center_of_mas
+00003690: 735a 1269 6e69 7469 616c 697a 655f 6761  sZ.initialize_ga
+000036a0: 7573 7331 44da 0572 6176 656c da03 7370  uss1D..ravel..sp
+000036b0: 6fda 0963 7572 7665 5f66 6974 5a14 6761  o..curve_fitZ.ga
+000036c0: 7573 7369 616e 5f31 445f 6675 6e63 7469  ussian_1D_functi
+000036d0: 6f6e 290b 722c 0000 005a 0b73 6f62 656c  on).r,...Z.sobel
+000036e0: 5f69 6d61 6765 7229 0000 00da 0279 79da  _imager).....yy.
+000036f0: 0278 7872 5a00 0000 7259 0000 005a 0272  .xxrZ...rY...Z.r
+00003700: 72da 0d69 6e69 7469 616c 5f67 7565 7373  r..initial_guess
+00003710: da04 706f 7074 725b 0000 0072 1200 0000  ..poptr[...r....
+00003720: 7212 0000 0072 1300 0000 da0c 736f 6265  r....r......sobe
+00003730: 6c5f 6369 7263 6c65 f101 0000 731e 0000  l_circle....s...
+00003740: 0010 0126 0116 011c 0106 0112 0104 ff04  ...&............
+00003750: 0306 0108 0108 0102 010a fc08 060a 0172  ...............r
+00003760: 7800 0000 6304 0000 0000 0000 0000 0000  x...c...........
+00003770: 0007 0000 0004 0000 0043 0000 0073 4800  .........C...sH.
+00003780: 0000 7c00 6401 1900 7c01 1800 7d04 7c00  ..|.d...|...}.|.
+00003790: 6402 1900 7c02 1800 7d05 7c04 6403 1300  d...|...}.|.d...
+000037a0: 7c05 6403 1300 1700 6404 1300 7d06 6401  |.d.....d...}.d.
+000037b0: 7c06 7c06 7c03 6b04 3c00 6402 7c06 7c06  |.|.|.k.<.d.|.|.
+000037c0: 6401 6b04 3c00 7c06 5300 2905 4e72 0100  d.k.<.|.S.).Nr..
+000037d0: 0000 7203 0000 0072 0200 0000 723e 0000  ..r....r....r>..
+000037e0: 0072 1200 0000 2907 da02 7879 5a02 7830  .r....)...xyZ.x0
+000037f0: 5a02 7930 725b 0000 0072 7500 0000 7274  Z.y0r[...ru...rt
+00003800: 0000 00da 027a 7a72 1200 0000 7212 0000  .....zzr....r...
+00003810: 0072 1300 0000 da0f 6369 7263 6c65 5f66  .r......circle_f
+00003820: 756e 6374 696f 6e03 0200 0073 0c00 0000  unction....s....
+00003830: 0c01 0c01 1401 0c01 0c01 0401 727b 0000  ............r{..
+00003840: 00e9 3200 0000 6302 0000 0000 0000 0000  ..2...c.........
+00003850: 0000 000d 0000 0007 0000 0043 0000 0073  ...........C...s
+00003860: 1801 0000 7c00 a000 7401 6a02 a101 7d00  ....|...t.j...}.
+00003870: 7c01 7401 a003 7c00 a101 1400 7c00 7c00  |.t...|.....|.|.
+00003880: 7c01 7401 a003 7c00 a101 1400 6b04 3c00  |.t...|.....k.<.
+00003890: 7401 a003 7c00 a101 7c01 1b00 7c00 7c00  t...|...|...|.|.
+000038a0: 7401 a003 7c00 a101 7c01 1b00 6b00 3c00  t...|...|...k.<.
+000038b0: 7c00 7401 a004 7c00 a101 1800 7401 a005  |.t...|.....t...
+000038c0: 7c00 a101 7401 a004 7c00 a101 1800 1b00  |...t...|.......
+000038d0: 7d02 7401 a006 7401 a007 7c00 a101 a101  }.t...t...|.....
+000038e0: a000 7401 6a02 a101 7d03 7c03 6401 1900  ..t.j...}.|.d...
+000038f0: 6402 1b00 7d04 7c03 6403 1900 6402 1b00  d...}.|.d...d...
+00003900: 7d05 7401 a008 7c02 a101 7401 6a09 1b00  }.t...|...t.j...
+00003910: 6404 1300 7d06 7c04 7c05 7c06 6603 7d07  d...}.|.|.|.f.}.
+00003920: 7401 6a0a 6403 740b 7c03 6403 1900 8301  t.j.d.t.|.d.....
+00003930: 8502 6403 740b 7c03 6401 1900 8301 8502  ..d.t.|.d.......
+00003940: 6602 1900 5c02 7d08 7d09 7401 a00c 7c09  f...\.}.}.t...|.
+00003950: a101 7401 a00c 7c08 a101 6602 7d0a 740d  ..t...|...f.}.t.
+00003960: a00e 740f 7c0a 7401 a00c 7c02 a101 7c07  ..t.|.t...|...|.
+00003970: a104 5c02 7d0b 7d0c 7c0b 5300 2905 4e72  ..\.}.}.|.S.).Nr
+00003980: 0300 0000 7202 0000 0072 0100 0000 723e  ....r....r....r>
+00003990: 0000 0029 1072 0800 0000 7205 0000 0072  ...).r....r....r
+000039a0: 0a00 0000 7255 0000 0072 1800 0000 7219  ....rU...r....r.
+000039b0: 0000 0072 0600 0000 7207 0000 0072 4900  ...r....r....rI.
+000039c0: 0000 720d 0000 0072 2400 0000 7209 0000  ..r....r$...r...
+000039d0: 0072 7100 0000 7272 0000 0072 7300 0000  .rq...rr...rs...
+000039e0: 727b 0000 0029 0d5a 0a69 6d61 6765 5f64  r{...).Z.image_d
+000039f0: 6174 615a 0a6d 6564 5f66 6163 746f 725a  ataZ.med_factorZ
+00003a00: 0a63 616c 635f 696d 6167 6572 1100 0000  .calc_imager....
+00003a10: 5a09 696e 6974 6961 6c5f 785a 0969 6e69  Z.initial_xZ.ini
+00003a20: 7469 616c 5f79 5a0e 696e 6974 6961 6c5f  tial_yZ.initial_
+00003a30: 7261 6469 7573 7276 0000 0072 5e00 0000  radiusrv...r^...
+00003a40: 725f 0000 0072 7900 0000 7277 0000 0072  r_...ry...rw...r
+00003a50: 2900 0000 7212 0000 0072 1200 0000 7213  )...r....r....r.
+00003a60: 0000 00da 0a66 6974 5f63 6972 636c 650c  .....fit_circle.
+00003a70: 0200 0073 2600 0000 0c01 0c03 02fe 1001  ...s&...........
+00003a80: 02ff 0c04 14ff 0c03 1201 04ff 1803 0c01  ................
+00003a90: 0c01 1401 0a01 2a01 1401 1a01 0401 727d  ......*.......r}
+00003aa0: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
+00003ab0: 0800 0000 0500 0000 4300 0000 73ce 0000  ........C...s...
+00003ac0: 0074 00a0 0164 01a1 0101 007c 006a 027d  .t...d.....|.j.}
+00003ad0: 027c 00a0 0374 046a 05a1 017d 0074 046a  .|...t.j...}.t.j
+00003ae0: 0674 077c 0183 0174 046a 0564 028d 027d  .t.|...t.j.d...}
+00003af0: 0364 037d 0464 037d 0574 0874 077c 0183  .d.}.d.}.t.t.|..
+00003b00: 0183 0144 005d 3e7d 067c 047d 077c 057c  ...D.]>}.|.}.|.|
+00003b10: 0114 007c 067c 0214 0018 007c 026b 0072  ...|.|.....|.k.r
+00003b20: 447c 077c 007c 0519 0037 007d 077c 0564  D|.|.|...7.}.|.d
+00003b30: 0437 007d 057c 057c 0114 007c 067c 0214  .7.}.|.|...|.|..
+00003b40: 0018 007c 026b 0073 307c 057c 0664 0417  ...|.k.s0|.|.d..
+00003b50: 007c 0214 007c 011b 0018 007c 007c 0564  .|...|.....|.|.d
+00003b60: 0418 0019 0014 007d 047c 077c 0438 007d  .......}.|.|.8.}
+00003b70: 077c 077c 0114 007c 021b 007c 037c 063c  .|.|...|...|.|.<
+00003b80: 0071 227c 03a0 037c 006a 09a1 0153 0029  .q"|...|.j...S.)
+00003b90: 0561 3301 0000 0a20 2020 2044 6f77 6e73  .a3....    Downs
+00003ba0: 616d 706c 6520 3144 2061 7272 6179 0a0a  ample 1D array..
+00003bb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00003bc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00003bd0: 2020 6461 7461 3a20 6e64 6172 7261 790a    data: ndarray.
+00003be0: 2020 2020 4e3a 2020 2020 696e 740a 2020      N:    int.  
+00003bf0: 2020 2020 2020 2020 4e65 7720 7369 7a65          New size
+00003c00: 206f 6620 6172 7261 790a 0a20 2020 2052   of array..    R
+00003c10: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00003c20: 2d2d 0a20 2020 2072 6573 3a20 6e64 6172  --.    res: ndar
+00003c30: 7261 7920 6f66 2073 6861 7065 204e 0a20  ray of shape N. 
+00003c40: 2020 2020 2020 2020 4461 7461 2072 6573          Data res
+00003c50: 616d 706c 6564 0a0a 2020 2020 4e6f 7465  ampled..    Note
+00003c60: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+00003c70: 5468 6520 6461 7461 2069 7320 7265 7361  The data is resa
+00003c80: 6d70 6c65 642e 200a 0a20 2020 203a 4175  mpled. ..    :Au
+00003c90: 7468 6f72 733a 0a20 2020 2044 6562 616e  thors:.    Deban
+00003ca0: 6773 6875 204d 756b 6865 726a 6565 203c  gshu Mukherjee <
+00003cb0: 6d75 6b68 6572 6a65 6564 406f 726e 6c2e  mukherjeed@ornl.
+00003cc0: 676f 763e 0a20 2020 2072 6a00 0000 7215  gov>.    rj...r.
+00003cd0: 0000 0072 0100 0000 7203 0000 0029 0a72  ...r....r....).r
+00003ce0: 6b00 0000 726c 0000 0072 2500 0000 7208  k...rl...r%...r.
+00003cf0: 0000 0072 0500 0000 720a 0000 0072 2b00  ...r....r....r+.
+00003d00: 0000 7209 0000 0072 2600 0000 7216 0000  ..r....r&...r...
+00003d10: 0029 0872 4200 0000 da01 4eda 014d da03  .).rB.....N..M..
+00003d20: 7265 735a 0563 6172 7279 da01 6dda 016e  resZ.carry..m..n
+00003d30: 5a08 6461 7461 5f73 756d 7212 0000 0072  Z.data_sumr....r
+00003d40: 1200 0000 7213 0000 00da 0772 6573 697a  ....r......resiz
+00003d50: 6572 2202 0000 7320 0000 000a 1606 010c  er"...s ........
+00003d60: 0114 0104 0104 0110 0104 0114 010c 0108  ................
+00003d70: 0114 fe20 0308 0112 010c 0172 8300 0000  ... .......r....
+00003d80: 6302 0000 0000 0000 0000 0000 0008 0000  c...............
+00003d90: 0007 0000 0043 0000 0073 e600 0000 7400  .....C...s....t.
+00003da0: a001 6401 a101 0100 7402 a003 7c01 a101  ..d.....t...|...
+00003db0: 7d01 7402 a003 7402 a004 7c00 a101 a101  }.t...t...|.....
+00003dc0: 7d02 7402 a005 7c02 7c01 1b00 a101 a006  }.t...|.|.......
+00003dd0: 7407 a101 7d03 7402 a008 7c02 6402 1900  t...}.t...|.d...
+00003de0: 7c03 6403 1900 6602 7c00 6a09 a102 7d04  |.d...f.|.j...}.
+00003df0: 7402 6a08 7c03 7c00 6a09 6404 8d02 7d05  t.j.|.|.j.d...}.
+00003e00: 740a 7407 7c02 6402 1900 8301 8301 4400  t.t.|.d.......D.
+00003e10: 5d17 7d06 740b 6a0c a00d 7c00 7c06 6405  ].}.t.j...|.|.d.
+00003e20: 6405 8502 6602 1900 7c03 6403 1900 a102  d...f...|.d.....
+00003e30: 7c04 7c06 6405 6405 8502 6602 3c00 7139  |.|.d.d...f.<.q9
+00003e40: 740a 7407 7c03 6403 1900 8301 8301 4400  t.t.|.d.......D.
+00003e50: 5d17 7d07 740b 6a0c a00d 7c04 6405 6405  ].}.t.j...|.d.d.
+00003e60: 8502 7c07 6602 1900 7c03 6402 1900 a102  ..|.f...|.d.....
+00003e70: 7c05 6405 6405 8502 7c07 6602 3c00 7159  |.d.d...|.f.<.qY
+00003e80: 7c05 5300 2906 61dc 0100 000a 2020 2020  |.S.).a.....    
+00003e90: 446f 776e 7361 6d70 6c65 2032 4420 6172  Downsample 2D ar
+00003ea0: 7261 790a 0a20 2020 2050 6172 616d 6574  ray..    Paramet
+00003eb0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00003ec0: 2d2d 0a20 2020 2064 6174 613a 2020 2020  --.    data:    
+00003ed0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00003ee0: 2020 2020 2020 2028 322c 3229 2073 6861         (2,2) sha
+00003ef0: 7065 0a20 2020 2073 616d 706c 696e 673a  pe.    sampling:
+00003f00: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
+00003f10: 2020 2020 2044 6f77 6e73 616d 706c 696e       Downsamplin
+00003f20: 6720 6661 6374 6f72 2069 6e20 6561 6368  g factor in each
+00003f30: 2061 7869 7361 0a0a 2020 2020 5265 7475   axisa..    Retu
+00003f40: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+00003f50: 2020 2020 7265 7361 6d70 6c65 643a 206e      resampled: n
+00003f60: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
+00003f70: 2020 2020 2044 6f77 6e73 616d 706c 6564       Downsampled
+00003f80: 2062 7920 7468 6520 7361 6d70 6c69 6e67   by the sampling
+00003f90: 2066 6163 746f 720a 2020 2020 2020 2020   factor.        
+00003fa0: 2020 2020 2020 696e 2065 6163 6820 6178        in each ax
+00003fb0: 6973 0a0a 2020 2020 4e6f 7465 730a 2020  is..    Notes.  
+00003fc0: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6520    -----.    The 
+00003fd0: 6461 7461 2069 7320 6120 3244 2077 7261  data is a 2D wra
+00003fe0: 7070 6572 206f 7665 7220 7468 6520 7265  pper over the re
+00003ff0: 7369 7a65 7220 6675 6e63 7469 6f6e 0a0a  sizer function..
+00004000: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00004010: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 7265   --------.    re
+00004020: 7369 7a65 720a 0a20 2020 203a 4175 7468  sizer..    :Auth
+00004030: 6f72 733a 0a20 2020 2044 6562 616e 6773  ors:.    Debangs
+00004040: 6875 204d 756b 6865 726a 6565 203c 6d75  hu Mukherjee <mu
+00004050: 6b68 6572 6a65 6564 406f 726e 6c2e 676f  kherjeed@ornl.go
+00004060: 763e 0a20 2020 2072 6a00 0000 7201 0000  v>.    rj...r...
+00004070: 0072 0300 0000 7215 0000 004e 290e 726b  .r....r....N).rk
+00004080: 0000 0072 6c00 0000 7205 0000 0072 0600  ...rl...r....r..
+00004090: 0000 7207 0000 0072 5700 0000 7208 0000  ..r....rW...r...
+000040a0: 0072 0900 0000 722b 0000 0072 1600 0000  .r....r+...r....
+000040b0: 7226 0000 0072 1e00 0000 721f 0000 0072  r&...r....r....r
+000040c0: 8300 0000 2908 7242 0000 005a 0873 616d  ....).rB...Z.sam
+000040d0: 706c 696e 67da 0a64 6174 615f 7368 6170  pling..data_shap
+000040e0: 655a 0d73 616d 706c 6564 5f73 6861 7065  eZ.sampled_shape
+000040f0: da0b 7265 7361 6d70 6c65 645f 78da 0b72  ..resampled_x..r
+00004100: 6573 616d 706c 6564 5f66 7274 0000 0072  esampled_frt...r
+00004110: 7500 0000 7212 0000 0072 1200 0000 7213  u...r....r....r.
+00004120: 0000 0072 6400 0000 4902 0000 7316 0000  ...rd...I...s...
+00004130: 000a 1c0a 0110 0114 011a 0110 0114 012c  ...............,
+00004140: 0114 012c 0104 0172 6400 0000 6302 0000  ...,...rd...c...
+00004150: 0000 0000 0000 0000 0007 0000 0007 0000  ................
+00004160: 0043 0000 0073 ca00 0000 7400 a001 6401  .C...s....t...d.
+00004170: a101 0100 7402 a003 7402 a004 7c00 a101  ....t...t...|...
+00004180: a101 7d02 7402 6a05 7c02 6402 1900 7c01  ..}.t.j.|.d...|.
+00004190: 6403 1900 6602 7c00 6a06 6404 8d02 7d03  d...f.|.j.d...}.
+000041a0: 7402 6a05 7c01 7c00 6a06 6404 8d02 7d04  t.j.|.|.j.d...}.
+000041b0: 7407 7408 7c02 6402 1900 8301 8301 4400  t.t.|.d.......D.
+000041c0: 5d17 7d05 7409 6a0a a00b 7c00 7c05 6405  ].}.t.j...|.|.d.
+000041d0: 6405 8502 6602 1900 7c01 6403 1900 a102  d...f...|.d.....
+000041e0: 7c03 7c05 6405 6405 8502 6602 3c00 712b  |.|.d.d...f.<.q+
+000041f0: 7407 7408 7c01 6403 1900 8301 8301 4400  t.t.|.d.......D.
+00004200: 5d17 7d06 7409 6a0a a00b 7c03 6405 6405  ].}.t.j...|.d.d.
+00004210: 8502 7c06 6602 1900 7c01 6402 1900 a102  ..|.f...|.d.....
+00004220: 7c04 6405 6405 8502 7c06 6602 3c00 714b  |.d.d...|.f.<.qK
+00004230: 7c04 5300 2906 61d4 0100 000a 2020 2020  |.S.).a.....    
+00004240: 446f 776e 7361 6d70 6c65 2032 4420 6172  Downsample 2D ar
+00004250: 7261 790a 2020 2020 5061 7261 6d65 7465  ray.    Paramete
+00004260: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00004270: 2d0a 2020 2020 6461 7461 5f6f 7269 673a  -.    data_orig:
+00004280: 2020 2020 206e 6461 7272 6179 0a20 2020       ndarray.   
+00004290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000042a0: 2832 2c32 2920 7368 6170 650a 2020 2020  (2,2) shape.    
+000042b0: 6e65 775f 7368 6170 653a 2020 2020 2074  new_shape:     t
+000042c0: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+000042d0: 2020 2020 2020 2020 4e65 7720 7368 6170          New shap
+000042e0: 650a 2020 2020 5265 7475 726e 730a 2020  e.    Returns.  
+000042f0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 7265    -------.    re
+00004300: 7361 6d70 6c65 645f 663a 206e 6461 7272  sampled_f: ndarr
+00004310: 6179 0a20 2020 2020 2020 2020 2020 2020  ay.             
+00004320: 2020 2020 4e65 7720 6172 7261 7920 7768      New array wh
+00004330: 6f73 6520 7369 7a65 2069 7320 6769 7665  ose size is give
+00004340: 6e20 6279 206e 6577 5f73 6861 7065 0a20  n by new_shape. 
+00004350: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
+00004360: 2d2d 0a20 2020 2054 6865 2064 6174 6120  --.    The data 
+00004370: 6973 2061 2032 4420 7772 6170 7065 7220  is a 2D wrapper 
+00004380: 6f76 6572 2074 6865 2072 6573 697a 6572  over the resizer
+00004390: 2066 756e 6374 696f 6e0a 2020 2020 5365   function.    Se
+000043a0: 6520 416c 736f 0a20 2020 202d 2d2d 2d2d  e Also.    -----
+000043b0: 2d2d 2d0a 2020 2020 7265 7369 7a65 720a  ---.    resizer.
+000043c0: 2020 2020 7265 7369 7a65 7232 440a 0a20      resizer2D.. 
+000043d0: 2020 203a 4175 7468 6f72 733a 0a20 2020     :Authors:.   
+000043e0: 2044 6562 616e 6773 6875 204d 756b 6865   Debangshu Mukhe
+000043f0: 726a 6565 203c 6d75 6b68 6572 6a65 6564  rjee <mukherjeed
+00004400: 406f 726e 6c2e 676f 763e 0a20 2020 2072  @ornl.gov>.    r
+00004410: 6a00 0000 7201 0000 0072 0300 0000 7215  j...r....r....r.
+00004420: 0000 004e 290c 726b 0000 0072 6c00 0000  ...N).rk...rl...
+00004430: 7205 0000 0072 0600 0000 7207 0000 0072  r....r....r....r
+00004440: 2b00 0000 7216 0000 0072 2600 0000 7209  +...r....r&...r.
+00004450: 0000 0072 1e00 0000 721f 0000 0072 8300  ...r....r....r..
+00004460: 0000 2907 5a09 6461 7461 5f6f 7269 675a  ..).Z.data_origZ
+00004470: 096e 6577 5f73 6861 7065 7284 0000 0072  .new_shaper....r
+00004480: 8500 0000 7286 0000 0072 7400 0000 7275  ....r....rt...ru
+00004490: 0000 0072 1200 0000 7212 0000 0072 1300  ...r....r....r..
+000044a0: 0000 da07 7265 7369 7a65 6472 0200 0073  ....resizedr...s
+000044b0: 1200 0000 0a18 1001 1c01 1001 1401 2c01  ..............,.
+000044c0: 1401 2c01 0401 7287 0000 0063 0100 0000  ..,...r....c....
+000044d0: 0000 0000 0000 0000 0100 0000 0200 0000  ................
+000044e0: 4300 0000 730c 0000 007c 0064 0116 0064  C...s....|.d...d
+000044f0: 026b 0353 0029 034e 7202 0000 0072 0100  .k.S.).Nr....r..
+00004500: 0000 7212 0000 0029 01da 036e 756d 7212  ..r....)...numr.
+00004510: 0000 0072 1200 0000 7213 0000 00da 0669  ...r....r......i
+00004520: 735f 6f64 6495 0200 0073 0200 0000 0c01  s_odd....s......
+00004530: 7289 0000 00e9 1900 0000 7255 0000 0063  r.........rU...c
+00004540: 0400 0000 0000 0000 0000 0000 0900 0000  ................
+00004550: 0600 0000 4300 0000 73fe 0000 0074 00a0  ....C...s....t..
+00004560: 017c 00a1 017d 0474 00a0 027c 027c 0414  .|...}.t...|.|..
+00004570: 00a1 017c 021b 007d 0474 0374 00a0 047c  ...|...}.t.t...|
+00004580: 04a1 0174 00a0 057c 04a1 0118 0064 017c  ...t...|.....d.|
+00004590: 021b 001b 0083 017d 0574 006a 067c 0564  .......}.t.j.|.d
+000045a0: 0266 0274 006a 0764 038d 027d 0674 00a0  .f.t.j.d...}.t..
+000045b0: 087c 05a1 0144 005d 3d7d 0774 00a0 057c  .|...D.]=}.t...|
+000045c0: 04a1 017c 077c 021b 0017 007d 087c 087c  ...|.|.....}.|.|
+000045d0: 067c 0764 0466 023c 007c 0364 056b 0272  .|.d.f.<.|.d.k.r
+000045e0: 5074 00a0 097c 017c 047c 086b 0219 00a1  Pt...|.|.|.k....
+000045f0: 017c 067c 0764 0166 023c 006e 0d74 00a0  .|.|.d.f.<.n.t..
+00004600: 0a7c 017c 047c 086b 0219 00a1 017c 067c  .|.|.|.k.....|.|
+00004610: 0764 0166 023c 0074 00a0 0b7c 017c 047c  .d.f.<.t...|.|.|
+00004620: 086b 0219 00a1 017c 067c 0764 0666 023c  .k.....|.|.d.f.<
+00004630: 0071 2d7c 0674 00a0 0c7c 0664 0764 0785  .q-|.t...|.d.d..
+00004640: 0264 0666 0219 00a1 010f 0064 0764 0785  .d.f.......d.d..
+00004650: 0266 0219 007d 067c 0653 0029 0861 7f02  .f...}.|.S.).a..
+00004660: 0000 0a20 2020 2047 6574 206d 6561 6e20  ...    Get mean 
+00004670: 616e 6420 7374 616e 6461 7264 2064 6576  and standard dev
+00004680: 6961 7469 6f6e 206f 6620 6120 6c69 7374  iation of a list
+00004690: 206f 6620 7820 616e 6420 7920 7661 6c75   of x and y valu
+000046a0: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
+000046b0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+000046c0: 2d0a 2020 2020 786c 6973 743a 2020 2020  -.    xlist:    
+000046d0: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
+000046e0: 2020 2020 2020 2020 2020 286e 2c31 2920            (n,1) 
+000046f0: 7368 6170 6520 6f66 2078 2076 616c 7565  shape of x value
+00004700: 730a 2020 2020 796c 6973 743a 2020 2020  s.    ylist:    
+00004710: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
+00004720: 2020 2020 2020 2020 2020 286e 2c31 2920            (n,1) 
+00004730: 7368 6170 6520 6f66 2078 2076 616c 7565  shape of x value
+00004740: 730a 2020 2020 7265 736f 6c75 7469 6f6e  s.    resolution
+00004750: 3a20 666c 6f61 740a 2020 2020 2020 2020  : float.        
+00004760: 2020 2020 2020 2020 4f70 7469 6f6e 616c          Optional
+00004770: 2076 616c 7565 2c20 6465 6661 756c 7420   value, default 
+00004780: 6966 2035 300a 2020 2020 2020 2020 2020  if 50.          
+00004790: 2020 2020 2020 486f 7720 6669 6e65 6c79        How finely
+000047a0: 2073 616d 706c 6564 2074 6865 2066 696e   sampled the fin
+000047b0: 616c 206c 6973 7420 6973 0a0a 2020 2020  al list is..    
+000047c0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+000047d0: 2d2d 2d0a 2020 2020 7374 6476 616c 733a  ---.    stdvals:
+000047e0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+000047f0: 2020 2020 2020 4669 7273 7420 636f 6c75        First colu
+00004800: 6d6e 2069 7320 7820 7661 6c75 6573 2073  mn is x values s
+00004810: 616d 706c 6564 2061 7420 7265 736f 6c75  ampled at resolu
+00004820: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00004830: 2020 5365 636f 6e64 2043 6f6c 756d 6e20    Second Column 
+00004840: 6973 206d 6561 6e20 6f72 206d 6564 6961  is mean or media
+00004850: 6e20 6f66 2063 6f72 7265 7370 6f6e 6469  n of correspondi
+00004860: 6e67 2079 2076 616c 7565 730a 2020 2020  ng y values.    
+00004870: 2020 2020 2020 2020 2054 6869 7264 2063           Third c
+00004880: 6f6c 756d 6e20 6973 2074 6865 2073 7461  olumn is the sta
+00004890: 6e64 6172 6420 6465 7669 6174 696f 6e0a  ndard deviation.
+000048a0: 0a20 2020 203a 4175 7468 6f72 733a 0a20  .    :Authors:. 
+000048b0: 2020 2044 6562 616e 6773 6875 204d 756b     Debangshu Muk
+000048c0: 6865 726a 6565 203c 6d75 6b68 6572 6a65  herjee <mukherje
+000048d0: 6564 406f 726e 6c2e 676f 763e 0a20 2020  ed@ornl.gov>.   
+000048e0: 2072 0300 0000 7233 0000 0072 1500 0000   r....r3...r....
+000048f0: 7201 0000 0072 5500 0000 7202 0000 004e  r....rU...r....N
+00004900: 290d 7205 0000 00da 0463 6f70 7972 5700  ).r......copyrW.
+00004910: 0000 7209 0000 0072 1900 0000 7218 0000  ..r....r....r...
+00004920: 0072 2b00 0000 720a 0000 0072 6300 0000  .r+...r....rc...
+00004930: 7255 0000 0072 6e00 0000 5a03 7374 64da  rU...rn...Z.std.
+00004940: 0569 736e 616e 2909 5a05 786c 6973 745a  .isnan).Z.xlistZ
+00004950: 0579 6c69 7374 da0a 7265 736f 6c75 7469  .ylist..resoluti
+00004960: 6f6e da05 7374 796c 655a 0678 726f 756e  on..styleZ.xroun
+00004970: 645a 0878 5f70 6f69 6e74 735a 0773 7464  dZ.x_pointsZ.std
+00004980: 7661 6c73 7267 0000 005a 0563 6376 616c  valsrg...Z.ccval
+00004990: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
+000049a0: 0c67 6574 5f6d 6561 6e5f 7374 6499 0200  .get_mean_std...
+000049b0: 0073 1a00 0000 0a18 1201 2001 1401 0e01  .s........ .....
+000049c0: 1201 0c01 0801 1c01 1a02 1c01 2401 0401  ............$...
+000049d0: 728f 0000 0063 0100 0000 0000 0000 0000  r....c..........
+000049e0: 0000 0700 0000 0500 0000 4300 0000 73a4  ..........C...s.
+000049f0: 0000 0074 00a0 017c 006a 02a1 01a0 0374  ...t...|.j.....t
+00004a00: 04a1 017d 0174 00a0 057c 0164 0119 007c  ...}.t...|.d...|
+00004a10: 0164 0219 0064 0366 03a1 017d 0274 00a0  .d...d.f...}.t..
+00004a20: 067c 00a1 017d 0364 0474 006a 077c 0064  .|...}.d.t.j.|.d
+00004a30: 0564 068d 0217 0064 071b 007d 047c 0474  .d.....d...}.|.t
+00004a40: 00a0 087c 04a1 0118 007d 0474 00a0 097c  ...|.....}.t...|
+00004a50: 03a1 017d 057c 037c 051b 007d 037c 047c  ...}.|.|...}.|.|
+00004a60: 0264 0064 0085 0264 0064 0085 0264 0166  .d.d...d.d...d.f
+00004a70: 033c 007c 037c 0264 0064 0085 0264 0064  .<.|.|.d.d...d.d
+00004a80: 0085 0264 0266 033c 0074 0aa0 0b7c 02a1  ...d.f.<.t...|..
+00004a90: 017d 067c 0653 0029 084e 7201 0000 0072  .}.|.S.).Nr....r
+00004aa0: 0300 0000 7233 0000 00e9 b400 0000 54a9  ....r3........T.
+00004ab0: 01da 0364 6567 e968 0100 00a9 0c72 0500  ...deg.h.....r..
+00004ac0: 0000 7206 0000 0072 0700 0000 7208 0000  ..r....r....r...
+00004ad0: 0072 0900 0000 7234 0000 0072 4100 0000  .r....r4...rA...
+00004ae0: 5a05 616e 676c 6572 3500 0000 7219 0000  Z.angler5...r...
+00004af0: 00da 0373 6b63 5a07 6873 7632 7267 62a9  ...skcZ.hsv2rgb.
+00004b00: 075a 0a63 6f6d 705f 696d 6167 655a 0869  .Z.comp_imageZ.i
+00004b10: 6d67 5f73 697a 6572 4400 0000 5a0a 7265  mg_sizerD...Z.re
+00004b20: 616c 5f69 6d61 6765 5a0b 616e 676c 655f  al_imageZ.angle_
+00004b30: 696d 6167 655a 076d 6178 5f76 616c 5a0d  imageZ.max_valZ.
+00004b40: 636f 6c6f 7265 645f 696d 6167 6572 1200  colored_imager..
+00004b50: 0000 7212 0000 0072 1300 0000 da0c 6370  ..r....r......cp
+00004b60: 5f69 6d61 6765 5f73 6174 c102 0000 f316  _image_sat......
+00004b70: 0000 0012 0118 010a 0116 010e 010a 0108  ................
+00004b80: 0116 0116 010a 0104 0172 9700 0000 6301  .........r....c.
+00004b90: 0000 0000 0000 0000 0000 0007 0000 0005  ................
+00004ba0: 0000 0043 0000 0073 a400 0000 7400 a001  ...C...s....t...
+00004bb0: 7c00 6a02 a101 a003 7404 a101 7d01 7400  |.j.....t...}.t.
+00004bc0: a005 7c01 6401 1900 7c01 6402 1900 6403  ..|.d...|.d...d.
+00004bd0: 6603 a101 7d02 7400 a006 7c00 a101 7d03  f...}.t...|...}.
+00004be0: 6404 7400 6a07 7c00 6405 6406 8d02 1700  d.t.j.|.d.d.....
+00004bf0: 6407 1b00 7d04 7c04 7400 a008 7c04 a101  d...}.|.t...|...
+00004c00: 1800 7d04 7400 a009 7c03 a101 7d05 7c03  ..}.t...|...}.|.
+00004c10: 7c05 1b00 7d03 7c04 7c02 6400 6400 8502  |...}.|.|.d.d...
+00004c20: 6400 6400 8502 6401 6603 3c00 7c03 7c02  d.d...d.f.<.|.|.
+00004c30: 6400 6400 8502 6400 6400 8502 6408 6603  d.d...d.d...d.f.
+00004c40: 3c00 740a a00b 7c02 a101 7d06 7c06 5300  <.t...|...}.|.S.
+00004c50: 2909 4e72 0100 0000 7203 0000 0072 3300  ).Nr....r....r3.
+00004c60: 0000 7290 0000 0054 7291 0000 0072 9300  ..r....Tr....r..
+00004c70: 0000 7202 0000 0072 9400 0000 7296 0000  ..r....r....r...
+00004c80: 0072 1200 0000 7212 0000 0072 1300 0000  .r....r....r....
+00004c90: da0c 6370 5f69 6d61 6765 5f76 616c cf02  ..cp_image_val..
+00004ca0: 0000 7298 0000 0072 9900 0000 6301 0000  ..r....r....c...
+00004cb0: 0000 0000 0000 0000 000a 0000 0009 0000  ................
+00004cc0: 0043 0000 0073 dc00 0000 7c00 6401 6b03  .C...s....|.d.k.
+00004cd0: 7d01 7c00 6401 6b02 7d02 7400 6a01 6401  }.|.d.k.}.t.j.d.
+00004ce0: 7c00 6a02 6401 1900 8502 6401 7c00 6a02  |.j.d.....d.|.j.
+00004cf0: 6402 1900 8502 6602 1900 5c02 7d03 7d04  d.....f...\.}.}.
+00004d00: 7400 a003 7c03 7c01 1900 7c04 7c01 1900  t...|.|...|.|...
+00004d10: 6602 a101 a004 a100 7d05 7400 a003 7c03  f.......}.t...|.
+00004d20: 7c02 1900 7c04 7c02 1900 6602 a101 a004  |...|.|...f.....
+00004d30: a100 7d06 7400 a005 7c05 6a02 6401 1900  ..}.t...|.j.d...
+00004d40: a101 7d07 7400 a006 7c05 6a02 6401 1900  ..}.t...|.j.d...
+00004d50: a101 4400 5d18 7d08 7400 a007 7400 6a08  ..D.].}.t...t.j.
+00004d60: 7c06 7c05 7c08 6401 6403 8502 6602 1900  |.|.|.d.d...f...
+00004d70: 1800 6403 1300 6402 6404 8d02 a101 7c07  ..d...d.d.....|.
+00004d80: 7c08 3c00 7145 7400 6a09 7c00 7400 6a0a  |.<.qEt.j.|.t.j.
+00004d90: 6405 8d02 7d09 7c07 6406 1300 7c09 7c01  d...}.|.d...|.|.
+00004da0: 3c00 7c09 5300 2907 6101 0100 000a 2020  <.|.S.).a.....  
+00004db0: 2020 4765 7420 4575 636c 6964 6561 6e20    Get Euclidean 
+00004dc0: 6469 7374 616e 6365 206f 6620 6576 6572  distance of ever
+00004dd0: 7920 6e6f 6e2d 7a65 726f 0a20 2020 2070  y non-zero.    p
+00004de0: 6978 656c 2066 726f 6d20 7a65 726f 2076  ixel from zero v
+00004df0: 616c 7565 6420 7069 7865 6c73 0a0a 2020  alued pixels..  
+00004e00: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00004e10: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00004e20: 6269 6e61 7279 5f69 6d61 6765 3a20 6e64  binary_image: nd
+00004e30: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00004e40: 2020 2020 2020 2020 5468 6520 696d 6167          The imag
+00004e50: 650a 0a20 2020 2052 6574 7572 6e73 0a20  e..    Returns. 
+00004e60: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00004e70: 6973 745f 6d61 703a 206e 6461 7272 6179  ist_map: ndarray
+00004e80: 0a20 2020 2020 2020 2020 2020 2020 2054  .              T
+00004e90: 6865 2045 7563 6c69 6465 616e 2064 6973  he Euclidean dis
+00004ea0: 7461 6e63 6520 6d61 700a 2020 2020 7201  tance map.    r.
+00004eb0: 0000 0072 0300 0000 7202 0000 00a9 015a  ...r....r......Z
+00004ec0: 0461 7869 7372 1500 0000 723e 0000 0029  .axisr....r>...)
+00004ed0: 0b72 0500 0000 7224 0000 0072 0700 0000  .r....r$...r....
+00004ee0: 7206 0000 00da 0974 7261 6e73 706f 7365  r......transpose
+00004ef0: 722b 0000 0072 6300 0000 7218 0000 0072  r+...rc...r....r
+00004f00: 4900 0000 7217 0000 00da 0566 6c6f 6174  I...r......float
+00004f10: 290a 5a0c 6269 6e61 7279 5f69 6d61 6765  ).Z.binary_image
+00004f20: 5a07 6269 5f6f 6e65 735a 0762 695f 7a65  Z.bi_onesZ.bi_ze
+00004f30: 726f 5a05 6269 5f79 795a 0562 695f 7878  roZ.bi_yyZ.bi_xx
+00004f40: 5a09 6f6e 6573 5f76 616c 735a 097a 6572  Z.ones_valsZ.zer
+00004f50: 6f5f 7661 6c73 5a09 6469 7374 5f76 616c  o_valsZ.dist_val
+00004f60: 7372 6700 0000 5a08 6469 7374 5f6d 6170  srg...Z.dist_map
+00004f70: 7212 0000 0072 1200 0000 7213 0000 00da  r....r....r.....
+00004f80: 0e65 7563 6c69 6465 616e 5f64 6973 74dd  .euclidean_dist.
+00004f90: 0200 0073 1600 0000 080f 0801 2601 1a01  ...s........&...
+00004fa0: 1a01 1001 1401 2e01 1001 0c01 0401 729d  ..............r.
+00004fb0: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
+00004fc0: 0a00 0000 0700 0000 4300 0000 7324 0100  ........C...s$..
+00004fd0: 0074 00a0 017c 00a1 017d 027c 0164 0119  .t...|...}.|.d..
+00004fe0: 0074 00a0 027c 0064 0264 0285 0264 0166  .t...|.d.d...d.f
+00004ff0: 0219 007c 0164 0119 001b 00a1 0114 007c  ...|.d.........|
+00005000: 0264 0264 0285 0264 0166 023c 007c 0164  .d.d...d.f.<.|.d
+00005010: 0319 0074 00a0 027c 0064 0264 0285 0264  ...t...|.d.d...d
+00005020: 0366 0219 007c 0164 0319 001b 00a1 0114  .f...|.d........
+00005030: 007c 0264 0264 0285 0264 0366 023c 0074  .|.d.d...d.f.<.t
+00005040: 00a0 037c 0264 0264 0285 0264 0166 0219  ...|.d.d...d.f..
+00005050: 00a1 017d 037c 0264 0264 0285 0264 0366  ...}.|.d.d...d.f
+00005060: 0219 007d 0474 00a0 0464 04a1 017d 0574  ...}.t...d...}.t
+00005070: 00a0 0574 067c 0383 01a1 0144 005d 2f7d  ...t.|.....D.]/}
+00005080: 0674 00a0 037c 047c 0264 0264 0285 0264  .t...|.|.d.d...d
+00005090: 0166 0219 007c 037c 0619 006b 0219 00a1  .f...|.|...k....
+000050a0: 017d 0774 00a0 077c 07a1 017c 037c 0619  .}.t...|...|.|..
+000050b0: 0014 007d 0874 00a0 0874 00a0 097c 087c  ...}.t...t...|.|
+000050c0: 0766 02a1 01a1 017d 0974 006a 0a7c 057c  .f.....}.t.j.|.|
+000050d0: 0966 0264 0164 058d 027d 0571 567c 0564  .f.d.d...}.qV|.d
+000050e0: 0374 067c 0583 0185 0264 0164 0685 0266  .t.|.....d.d...f
+000050f0: 0219 0053 0029 0761 a001 0000 0a20 2020  ...S.).a.....   
+00005100: 2052 6564 7563 6520 7468 6520 7072 6563   Reduce the prec
+00005110: 6973 6f6e 206f 6620 616e 2078 7920 6172  ison of an xy ar
+00005120: 7261 7920 616c 6f6e 6720 626f 7468 0a20  ray along both. 
+00005130: 2020 2074 6865 2078 2061 6e64 2079 2061     the x and y a
+00005140: 7865 732e 0a0a 2020 2020 5061 7261 6d65  xes...    Parame
+00005150: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00005160: 2d2d 2d0a 2020 2020 7879 3a20 2020 2020  ---.    xy:     
+00005170: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00005180: 2020 2020 2020 5468 6520 6669 7273 7420        The first 
+00005190: 636f 6c75 6d6e 2069 7320 7468 6520 7820  column is the x 
+000051a0: 6469 6d65 6e73 696f 6e2c 2077 6869 6c65  dimension, while
+000051b0: 0a20 2020 2020 2020 2020 2020 2020 7468  .             th
+000051c0: 6520 7365 636f 6e64 2063 6f6c 756d 6e20  e second column 
+000051d0: 6973 2074 6865 2079 2064 696d 656e 7369  is the y dimensi
+000051e0: 6f6e 0a20 2020 2072 6564 7563 6572 3a20  on.    reducer: 
+000051f0: 7475 706c 650a 2020 2020 2020 2020 2020  tuple.          
+00005200: 2020 2054 6865 2070 7265 6369 736f 6e20     The precison 
+00005210: 7265 6475 6365 7273 2061 6c6f 6e67 2074  reducers along t
+00005220: 6865 2069 6e64 6976 6964 7561 6c0a 2020  he individual.  
+00005230: 2020 2020 2020 2020 2020 2064 696d 656e             dimen
+00005240: 7369 6f6e 730a 0a20 2020 2052 6574 7572  sions..    Retur
+00005250: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00005260: 2020 2078 7970 7265 633a 206e 6461 7272     xyprec: ndarr
+00005270: 6179 0a20 2020 2020 2020 2020 2020 2052  ay.            R
+00005280: 6564 7563 6564 2070 7265 6369 7369 6f6e  educed precision
+00005290: 2061 7272 6179 0a0a 2020 2020 7201 0000   array..    r...
+000052a0: 004e 7203 0000 0029 0272 0300 0000 7202  .Nr....).r....r.
+000052b0: 0000 0072 9a00 0000 7202 0000 0029 0b72  ...r....r....).r
+000052c0: 0500 0000 7217 0000 0072 5700 0000 da06  ....r....rW.....
+000052d0: 756e 6971 7565 722b 0000 0072 6300 0000  uniquer+...rc...
+000052e0: da03 6c65 6e5a 096f 6e65 735f 6c69 6b65  ..lenZ.ones_like
+000052f0: 729b 0000 0072 0600 0000 5a0b 636f 6e63  r....r....Z.conc
+00005300: 6174 656e 6174 6529 0a72 7900 0000 7265  atenate).ry...re
+00005310: 0000 005a 0678 795f 7265 645a 0878 5f75  ...Z.xy_redZ.x_u
+00005320: 6e69 7175 655a 0579 5f61 6c6c 5a07 7879  niqueZ.y_allZ.xy
+00005330: 5f70 7265 6372 6700 0000 5a04 795f 6969  _precrg...Z.y_ii
+00005340: 5a04 785f 6969 5a06 6172 725f 6969 7212  Z.x_iiZ.arr_iir.
+00005350: 0000 0072 1200 0000 7213 0000 00da 1372  ...r....r......r
+00005360: 6564 7563 655f 7072 6563 6973 696f 6e5f  educe_precision_
+00005370: 7879 f902 0000 7318 0000 000a 1432 0132  xy....s......2.2
+00005380: 0116 0110 010a 0112 0122 0112 0114 0114  ........."......
+00005390: 0118 0172 a000 0000 2901 721d 0000 0029  ...r....).r....)
+000053a0: 0272 0300 0000 7223 0000 0029 024e 723d  .r....r#...).Nr=
+000053b0: 0000 0029 0172 4600 0000 2901 5429 0272  ...).rF...).T).r
+000053c0: 0100 0000 5429 0272 6200 0000 723d 0000  ....T).rb...r=..
+000053d0: 0029 0172 7c00 0000 2902 728a 0000 0072  .).r|...).r....r
+000053e0: 5500 0000 2934 5a05 6e75 6d70 7972 0500  U...)4Z.numpyr..
+000053f0: 0000 5a0a 6d61 7470 6c6f 746c 6962 5a03  ..Z.matplotlibZ.
+00005400: 6d70 6c5a 176d 706c 5f74 6f6f 6c6b 6974  mplZ.mpl_toolkit
+00005410: 732e 6178 6573 5f67 7269 6431 5a0a 6178  s.axes_grid1Z.ax
+00005420: 6573 5f67 7269 6431 7231 0000 005a 116d  es_grid1r1...Z.m
+00005430: 6174 706c 6f74 6c69 622e 636f 6c6f 7273  atplotlib.colors
+00005440: 5a06 636f 6c6f 7273 7236 0000 005a 0d6d  Z.colorsr6...Z.m
+00005450: 6174 706c 6f74 6c69 622e 636d da02 636d  atplotlib.cm..cm
+00005460: 7240 0000 0072 6b00 0000 5a0e 7363 6970  r@...rk...Z.scip
+00005470: 792e 6f70 7469 6d69 7a65 da08 6f70 7469  y.optimize..opti
+00005480: 6d69 7a65 7272 0000 005a 0d73 6369 7079  mizerr...Z.scipy
+00005490: 2e6e 6469 6d61 6765 5a07 6e64 696d 6167  .ndimageZ.ndimag
+000054a0: 6572 7000 0000 5a0d 736b 696d 6167 652e  erp...Z.skimage.
+000054b0: 636f 6c6f 7272 4300 0000 7295 0000 00da  colorrC...r.....
+000054c0: 0873 7465 6d74 6f6f 6c72 1e00 0000 7214  .stemtoolr....r.
+000054d0: 0000 0072 1c00 0000 7222 0000 0072 2a00  ...r....r"...r*.
+000054e0: 0000 722d 0000 0072 3200 0000 723c 0000  ..r-...r2...r<..
+000054f0: 0072 4500 0000 7247 0000 0072 5400 0000  .rE...rG...rT...
+00005500: 7258 0000 0072 6100 0000 7269 0000 0072  rX...ra...ri...r
+00005510: 6d00 0000 726f 0000 0072 7800 0000 727b  m...ro...rx...r{
+00005520: 0000 0072 7d00 0000 7283 0000 0072 6400  ...r}...r....rd.
+00005530: 0000 7287 0000 0072 8900 0000 728f 0000  ..r....r....r...
+00005540: 0072 9700 0000 7299 0000 0072 9d00 0000  .r....r....r....
+00005550: 72a0 0000 0072 1200 0000 7212 0000 0072  r....r....r....r
+00005560: 1200 0000 7213 0000 00da 083c 6d6f 6475  ....r......<modu
+00005570: 6c65 3e01 0000 0073 4a00 0000 0800 0801  le>....sJ.......
+00005580: 0c01 0c01 0c01 0801 0c01 0c01 0c01 0801  ................
+00005590: 0803 0833 0a23 0a22 082c 0820 0808 0a0f  ...3.#.".,. ....
+000055a0: 0a0f 0a30 0a0d 0852 0a20 0820 0824 0807  ...0...R. . .$..
+000055b0: 0812 0a09 0816 0827 0829 0823 0a04 0828  .......'.).#...(
+000055c0: 080e 080e 0c1c                           ......
```

## Comparing `stemtool/util/__pycache__/pnccd.cpython-39.pyc` & `stemtool/util/__pycache__/pnccd.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:07:48 2023 UTC, .py size: 23294 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 9% similar despite different names*

```diff
@@ -1,23 +1,23 @@
-00000000: 610d 0d0a 0000 0000 e433 e163 fe5a 0000  a........3.c.Z..
+00000000: 6f0d 0d0a 0000 0000 13a7 3c63 fe5a 0000  o.........<c.Z..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0004 0000 0040 0000 0073 c400 0000 6400  .....@...s....d.
 00000030: 6401 6c00 6d01 5a01 6d02 5a02 6d03 5a03  d.l.m.Z.m.Z.m.Z.
 00000040: 0100 6400 6402 6c04 5a04 6400 6402 6c05  ..d.d.l.Z.d.d.l.
 00000050: 6d06 5a07 0100 6400 6402 6c08 5a08 6400  m.Z...d.d.l.Z.d.
 00000060: 6402 6c09 5a09 6400 6402 6c0a 6d0b 5a0c  d.l.Z.d.d.l.m.Z.
 00000070: 0100 6400 6402 6c0d 5a0d 6400 6402 6c0e  ..d.d.l.Z.d.d.l.
 00000080: 5a0f 6400 6402 6c10 5a10 6400 6402 6c11  Z.d.d.l.Z.d.d.l.
 00000090: 5a12 6400 6402 6c13 5a13 6400 6403 6c14  Z.d.d.l.Z.d.d.l.
 000000a0: 6d15 5a15 0100 4700 6404 6405 8400 6405  m.Z...G.d.d...d.
 000000b0: 6516 8303 5a17 6415 6407 6408 8401 5a18  e...Z.d.d.d...Z.
-000000c0: 6416 6409 640a 8401 5a19 640b 640c 8400  d.d.d...Z.d.d...
-000000d0: 5a1a 6417 640e 640f 8401 5a1b 6410 6411  Z.d.d.d...Z.d.d.
-000000e0: 8400 5a1c 6418 6413 6414 8401 5a1d 6402  ..Z.d.d.d...Z.d.
-000000f0: 5300 2919 e900 0000 0029 03da 0e70 7269  S.)......)...pri
+000000c0: 6415 6409 640a 8401 5a19 640b 640c 8400  d.d.d...Z.d.d...
+000000d0: 5a1a 6416 640e 640f 8401 5a1b 6410 6411  Z.d.d.d...Z.d.d.
+000000e0: 8400 5a1c 6417 6413 6414 8401 5a1d 6402  ..Z.d.d.d...Z.d.
+000000f0: 5300 2918 e900 0000 0029 03da 0e70 7269  S.)......)...pri
 00000100: 6e74 5f66 756e 6374 696f 6eda 0864 6976  nt_function..div
 00000110: 6973 696f 6eda 0f61 6273 6f6c 7574 655f  ision..absolute_
 00000120: 696d 706f 7274 4e29 01da 0b4f 7264 6572  importN)...Order
 00000130: 6564 4469 6374 6300 0000 0000 0000 0000  edDictc.........
 00000140: 0000 0000 0000 0004 0000 0040 0000 0073  ...........@...s
 00000150: 8600 0000 6500 5a01 6400 5a02 6401 5a03  ....e.Z.d.Z.d.Z.
 00000160: 6402 5a04 6505 a006 6504 a101 5a07 6505  d.Z.e...e...Z.e.
@@ -31,639 +31,639 @@
 000001e0: 6d73 3652 6561 6465 727a 2654 6869 7320  ms6Readerz&This 
 000001f0: 636c 6173 7320 616c 6c6f 7773 2074 6f20  class allows to 
 00000200: 6163 6365 7373 2066 726d 3620 6669 6c65  access frm6 file
 00000210: 737a 103d 4848 4242 4242 3830 7348 4839  sz.=HHBBBB80sHH9
 00000220: 3332 787a 103d 4242 4242 4949 4964 4848  32xz.=BBBBIIIdHH
 00000230: 4951 3234 7863 0100 0000 0000 0000 0000  IQ24xc..........
 00000240: 0000 0100 0000 0100 0000 4300 0000 7304  ..........C...s.
-00000250: 0000 0064 0053 0029 014e a900 2901 da04  ...d.S.).N..)...
-00000260: 7365 6c66 7207 0000 0072 0700 0000 fa39  selfr....r.....9
-00000270: 6275 696c 642f 6264 6973 742e 6d61 636f  build/bdist.maco
-00000280: 7378 2d31 302e 392d 7838 365f 3634 2f65  sx-10.9-x86_64/e
-00000290: 6767 2f73 7465 6d74 6f6f 6c2f 7574 696c  gg/stemtool/util
-000002a0: 2f70 6e63 6364 2e70 79da 085f 5f69 6e69  /pnccd.py..__ini
-000002b0: 745f 5f52 0000 0073 0200 0000 0001 7a14  t__R...s......z.
-000002c0: 4672 6d73 3652 6561 6465 722e 5f5f 696e  Frms6Reader.__in
-000002d0: 6974 5f5f 6302 0000 0000 0000 0000 0000  it__c...........
-000002e0: 0002 0000 0005 0000 0043 0000 0073 1600  .........C...s..
-000002f0: 0000 7400 a001 7402 7c00 7c01 1400 8301  ..t...t.|.|.....
-00000300: 6401 1700 a101 5300 2902 6102 0100 0043  d.....S.).a....C
-00000310: 6f6e 7665 6e69 656e 6365 206d 6574 686f  onvenience metho
-00000320: 6420 746f 2064 6574 6572 6d69 6e65 2074  d to determine t
-00000330: 6865 2066 7261 6d65 2073 697a 6520 2877  he frame size (w
-00000340: 6974 686f 7574 2066 7261 6d65 0a20 2020  ithout frame.   
-00000350: 2020 2020 2068 6561 6465 7221 290a 0a20       header!).. 
-00000360: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00000370: 2020 2020 2020 2020 2066 7261 6d65 5769           frameWi
-00000380: 6474 6820 2869 6e74 293a 2077 6964 7468  dth (int): width
-00000390: 206f 6620 7468 6520 6672 616d 650a 2020   of the frame.  
-000003a0: 2020 2020 2020 2020 2020 6672 616d 6548            frameH
-000003b0: 6569 6768 7420 2869 6e74 293a 2068 6569  eight (int): hei
-000003c0: 6768 7420 6f66 2074 6865 2066 7261 6d65  ght of the frame
-000003d0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-000003e0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-000003f0: 6e74 3a20 4672 616d 6520 7369 7a65 2069  nt: Frame size i
-00000400: 6e20 6279 7465 730a 0a20 2020 2020 2020  n bytes..       
-00000410: 20da 0168 2903 da06 7374 7275 6374 da08   ..h)...struct..
-00000420: 6361 6c63 7369 7a65 da03 7374 7229 02da  calcsize..str)..
-00000430: 0a66 7261 6d65 5769 6474 68da 0b66 7261  .frameWidth..fra
-00000440: 6d65 4865 6967 6874 7207 0000 0072 0700  meHeightr....r..
-00000450: 0000 7209 0000 00da 1367 6574 4672 616d  ..r......getFram
-00000460: 6553 697a 6549 6e42 7974 6573 5500 0000  eSizeInBytesU...
-00000470: 7302 0000 0000 0d7a 1f46 726d 7336 5265  s......z.Frms6Re
-00000480: 6164 6572 2e67 6574 4672 616d 6553 697a  ader.getFrameSiz
-00000490: 6549 6e42 7974 6573 6302 0000 0000 0000  eInBytesc.......
-000004a0: 0000 0000 0012 0000 000a 0000 0043 0000  .............C..
-000004b0: 0073 4001 0000 7400 a001 7c01 a101 5c03  .s@...t...|...\.
-000004c0: 7d02 7d03 7d04 7c00 a002 7c03 7c02 a102  }.}.}.|...|.|...
-000004d0: 7d05 6700 7d06 6700 7d07 6700 7d08 6700  }.g.}.g.}.g.}.g.
-000004e0: 7d02 6700 7d09 6700 7d0a 6700 7d0b 6700  }.g.}.g.}.g.}.g.
-000004f0: 7d0c 6700 7d0d 7403 7c01 6401 8302 8fcc  }.g.}.t.|.d.....
-00000500: 7d0e 7c0e a004 7c00 6a05 a101 0100 7406  }.|...|.j.....t.
-00000510: 7c04 8301 4400 5da6 7d0f 7c0e a007 7400  |...D.].}.|...t.
-00000520: 6a08 a101 7d10 7c00 6a09 a00a 7c10 a101  j...}.|.j...|...
-00000530: 7d11 7c06 a00b 7c11 6402 1900 a101 0100  }.|...|.d.......
-00000540: 7c07 a00b 7c11 6403 1900 a101 0100 7c08  |...|.d.......|.
-00000550: a00b 7c11 6404 1900 a101 0100 7c02 a00b  ..|.d.......|...
-00000560: 7c11 6405 1900 a101 0100 7c09 a00b 7c11  |.d.......|...|.
-00000570: 6406 1900 a101 0100 7c0a a00b 7c11 6407  d.......|...|.d.
-00000580: 1900 a101 0100 7c0b a00b 7c11 6408 1900  ......|...|.d...
-00000590: a101 0100 7c0c a00b 7c11 6409 1900 a101  ....|...|.d.....
-000005a0: 0100 7c0d a00b 7c11 640a 1900 a101 0100  ..|...|.d.......
-000005b0: 7c0e a004 7c05 6403 a102 0100 7160 5700  |...|.d.....q`W.
-000005c0: 640b 0400 0400 8303 0100 6e12 3100 9001  d.........n.1...
-000005d0: 731e 3000 0100 0100 0100 5900 0100 7c06  s.0.......Y...|.
-000005e0: 7c07 7c08 7c02 7c09 7c0a 7c0b 7c0c 7c0d  |.|.|.|.|.|.|.|.
-000005f0: 640c 9c09 5300 290d 61e3 0100 0052 6561  d...S.).a....Rea
-00000600: 6473 2074 6865 2066 7261 6d65 2068 6561  ds the frame hea
-00000610: 6465 7273 206f 6620 616e 2065 6e74 6972  ders of an entir
-00000620: 6520 6672 6d73 3620 6669 6c65 2e20 5468  e frms6 file. Th
-00000630: 6520 6672 616d 6520 6865 6164 6572 0a20  e frame header. 
-00000640: 2020 2020 2020 206b 6579 7320 6172 653a         keys are:
-00000650: 0a0a 2020 2020 2020 2020 2020 2020 2a20  ..            * 
-00000660: 7374 6172 740a 2020 2020 2020 2020 2020  start.          
-00000670: 2020 2a20 696e 666f 0a20 2020 2020 2020    * info.       
-00000680: 2020 2020 202a 2069 640a 2020 2020 2020       * id.      
-00000690: 2020 2020 2020 2a20 6865 6967 6874 0a20        * height. 
-000006a0: 2020 2020 2020 2020 2020 202a 2074 765f             * tv_
-000006b0: 7365 630a 2020 2020 2020 2020 2020 2020  sec.            
-000006c0: 2a20 7476 5f75 7365 630a 2020 2020 2020  * tv_usec.      
-000006d0: 2020 2020 2020 2a20 696e 6465 780a 2020        * index.  
-000006e0: 2020 2020 2020 2020 2020 2a20 7465 6d70            * temp
-000006f0: 0a20 2020 2020 2020 2020 2020 202a 206d  .            * m
-00000700: 6178 4865 6967 6874 0a0a 2020 2020 2020  axHeight..      
-00000710: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00000720: 2020 2020 666e 2028 7374 7229 3a20 6675      fn (str): fu
-00000730: 6c6c 7920 7175 616c 6966 6965 6420 6669  lly qualified fi
-00000740: 6c65 206e 616d 650a 0a20 2020 2020 2020  le name..       
-00000750: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00000760: 2020 2020 2020 6469 6374 3a20 436f 6e74        dict: Cont
-00000770: 656e 7473 206f 6620 7468 6520 616c 6c20  ents of the all 
-00000780: 6672 616d 6520 6865 6164 6572 7320 7375  frame headers su
-00000790: 6264 6976 6964 6564 2069 6e74 6f20 6c69  bdivided into li
-000007a0: 7374 732c 2077 6974 680a 2020 2020 2020  sts, with.      
-000007b0: 2020 2020 2020 2020 2020 6f6e 6520 6c69            one li
-000007c0: 7374 2070 6572 2066 7261 6d65 2068 6561  st per frame hea
-000007d0: 6465 7220 6b65 790a 2020 2020 2020 2020  der key.        
-000007e0: da02 7262 7201 0000 00e9 0100 0000 e902  ..rbr...........
-000007f0: 0000 00e9 0300 0000 e904 0000 00e9 0500  ................
-00000800: 0000 e906 0000 00e9 0700 0000 e908 0000  ................
-00000810: 004e 2909 da05 7374 6172 74da 0469 6e66  .N)...start..inf
-00000820: 6fda 0269 64da 0668 6569 6768 745a 0674  o..id..heightZ.t
-00000830: 765f 7365 635a 0774 765f 7573 6563 da05  v_secZ.tv_usec..
-00000840: 696e 6465 78da 0474 656d 70da 096d 6178  index..temp..max
-00000850: 4865 6967 6874 290c 7206 0000 00da 0c67  Height).r......g
-00000860: 6574 4461 7461 5368 6170 6572 1100 0000  etDataShaper....
-00000870: da04 6f70 656e da04 7365 656b da15 6669  ..open..seek..fi
-00000880: 6c65 4865 6164 6572 5369 7a65 496e 4279  leHeaderSizeInBy
-00000890: 7465 73da 0572 616e 6765 da04 7265 6164  tes..range..read
-000008a0: da16 6672 616d 6548 6561 6465 7253 697a  ..frameHeaderSiz
-000008b0: 6549 6e42 7974 6573 da11 6672 616d 6548  eInBytes..frameH
-000008c0: 6561 6465 7253 7472 7563 74da 0675 6e70  eaderStruct..unp
-000008d0: 6163 6bda 0661 7070 656e 6429 12da 0363  ack..append)...c
-000008e0: 6c73 da02 666e 7210 0000 0072 0f00 0000  ls..fnr....r....
-000008f0: da0e 6e75 6d62 6572 4f66 4672 616d 6573  ..numberOfFrames
-00000900: da10 6672 616d 6553 697a 6549 6e42 7974  ..frameSizeInByt
-00000910: 6573 5a0a 6672 616d 6553 7461 7274 5a09  esZ.frameStartZ.
-00000920: 6672 616d 6549 6e66 6f5a 0766 7261 6d65  frameInfoZ.frame
-00000930: 4964 5a0a 6672 616d 6554 7653 6563 5a0b  IdZ.frameTvSecZ.
-00000940: 6672 616d 6554 7655 7365 635a 0a66 7261  frameTvUsecZ.fra
-00000950: 6d65 496e 6465 785a 0966 7261 6d65 5465  meIndexZ.frameTe
-00000960: 6d70 5a0e 6672 616d 654d 6178 4865 6967  mpZ.frameMaxHeig
-00000970: 6874 da02 6668 da08 6672 616d 6549 6478  ht..fh..frameIdx
-00000980: 5a0e 6672 616d 6548 6561 6465 7252 6177  Z.frameHeaderRaw
-00000990: 5a10 6672 616d 6548 6561 6465 7249 7465  Z.frameHeaderIte
-000009a0: 6d73 7207 0000 0072 0700 0000 7209 0000  msr....r....r...
-000009b0: 00da 0f67 6574 4672 616d 6548 6561 6465  ...getFrameHeade
-000009c0: 7273 6400 0000 734c 0000 0000 1710 050c  rsd...sL........
-000009d0: 0f04 0104 0104 0104 0104 0104 0104 0104  ................
-000009e0: 0104 020c 020c 010c 010c 010c 040e 010e  ................
-000009f0: 010e 010e 010e 010e 010e 010e 010e 0304  ................
-00000a00: 0104 ff26 0502 0102 0102 0102 0102 0102  ...&............
-00000a10: 0102 0102 0102 f77a 1b46 726d 7336 5265  .......z.Frms6Re
-00000a20: 6164 6572 2e67 6574 4672 616d 6548 6561  ader.getFrameHea
-00000a30: 6465 7273 6302 0000 0000 0000 0001 0000  dersc...........
-00000a40: 0010 0000 0008 0000 004f 0000 0073 f200  .........O...s..
-00000a50: 0000 7c02 5c02 7d05 7d06 7c06 7c05 1800  ..|.\.}.}.|.|...
-00000a60: 7d07 7c04 a000 6401 6402 a102 7d08 7c04  }.|...d.d...}.|.
-00000a70: a000 6403 6402 a102 7d09 7c00 a001 7c08  ..d.d...}.|...|.
-00000a80: 7c09 a102 7d0a 7c00 6a02 7d0b 7c0b 7c05  |...}.|.j.}.|.|.
-00000a90: 7c00 6a03 7c0a 1700 1400 3700 7d0b 7404  |.j.|.....7.}.t.
-00000aa0: a005 7c08 7c09 7c07 6603 7404 6a06 a102  ..|.|.|.f.t.j...
-00000ab0: 7d0c 7407 7c01 6404 8302 8f74 7d0d 7c0d  }.t.|.d....t}.|.
-00000ac0: a008 7c0b a101 0100 7409 7c07 8301 4400  ..|.....t.|...D.
-00000ad0: 5d50 7d0e 7c0d a008 7c00 6a03 6405 a102  ]P}.|...|.j.d...
-00000ae0: 0100 7404 a00a 7c0d a00b 7c0a a101 7404  ..t...|...|...t.
-00000af0: 6a06 a102 7d0f 7c0f a00c 7c09 7c08 6602  j...}.|...|.|.f.
-00000b00: a101 7d0f 7404 a00d 7c0f a101 7c0c 6402  ..}.t...|...|.d.
-00000b10: 6402 8502 6402 6402 8502 7c0e 6603 3c00  d...d.d...|.f.<.
-00000b20: 717e 5700 6402 0400 0400 8303 0100 6e10  q~W.d.........n.
-00000b30: 3100 73e4 3000 0100 0100 0100 5900 0100  1.s.0.......Y...
-00000b40: 7c0c 5300 2906 612c 0200 0052 6561 6473  |.S.).a,...Reads
-00000b50: 2063 6875 6e6b 7320 6f66 2064 6174 6120   chunks of data 
-00000b60: 6672 6f6d 2061 2066 726d 3620 6669 6c65  from a frm6 file
-00000b70: 2e20 436f 6d70 6174 6962 6c65 2077 6974  . Compatible wit
-00000b80: 6820 4368 756e 6b65 6452 6561 6465 720a  h ChunkedReader.
-00000b90: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00000ba0: 2020 2020 2020 2020 2020 2066 6e20 2873             fn (s
-00000bb0: 7472 293a 2066 756c 6c79 2071 7561 6c69  tr): fully quali
-00000bc0: 6669 6564 2066 696c 6520 6e61 6d65 0a20  fied file name. 
-00000bd0: 2020 2020 2020 2020 2020 2069 6d61 6765             image
-00000be0: 5f72 616e 6765 3a20 322d 7475 706c 6520  _range: 2-tuple 
-00000bf0: 5b73 7461 7274 5f69 6478 2c20 656e 645f  [start_idx, end_
-00000c00: 6964 785b 2064 6566 696e 696e 6720 7468  idx[ defining th
-00000c10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00000c20: 2020 7261 6e67 6520 6f66 2066 7261 6d65    range of frame
-00000c30: 7320 7468 6174 206f 7567 6874 2074 6f20  s that ought to 
-00000c40: 6265 2072 6561 640a 2020 2020 2020 2020  be read.        
-00000c50: 2020 2020 6b77 6172 6773 3a20 7468 6520      kwargs: the 
-00000c60: 666f 6c6c 6f77 696e 6720 6164 6469 7469  following additi
-00000c70: 6f6e 616c 2070 6172 616d 6574 6572 7320  onal parameters 
-00000c80: 2a2a 6d75 7374 2a2a 2062 6520 6769 7665  **must** be give
-00000c90: 6e3a 0a0a 2020 2020 2020 2020 2020 2020  n:..            
-00000ca0: 2020 2020 2a20 7069 7865 6c73 5f78 2028      * pixels_x (
-00000cb0: 696e 7429 3a20 6e75 6d62 6572 206f 6620  int): number of 
-00000cc0: 7069 7865 6c73 2061 6c6f 6e67 2078 2d61  pixels along x-a
-00000cd0: 7869 730a 2020 2020 2020 2020 2020 2020  xis.            
-00000ce0: 2020 2020 2a20 7069 7865 6c73 5f79 2028      * pixels_y (
-00000cf0: 696e 7429 3a20 6e75 6d62 6572 206f 6620  int): number of 
-00000d00: 7069 7865 6c73 2061 6c6f 6e67 2079 2d61  pixels along y-a
-00000d10: 7869 730a 0a20 2020 2020 2020 2052 6574  xis..        Ret
-00000d20: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00000d30: 2020 6e75 6d70 792e 6e64 6172 7261 793a    numpy.ndarray:
-00000d40: 2044 6174 6120 7265 6164 2066 726f 6d20   Data read from 
-00000d50: 7468 6520 6672 6d36 2066 696c 6520 2864  the frm6 file (d
-00000d60: 7479 7065 3a20 7569 6e74 3136 290a 0a20  type: uint16).. 
-00000d70: 2020 2020 2020 20da 0870 6978 656c 735f         ..pixels_
-00000d80: 784e da08 7069 7865 6c73 5f79 7212 0000  xN..pixels_yr...
-00000d90: 0072 1300 0000 290e da03 6765 7472 1100  .r....)...getr..
-00000da0: 0000 7225 0000 0072 2800 0000 da02 6e70  ..r%...r(.....np
-00000db0: da05 7a65 726f 735a 0675 696e 7431 3672  ..zerosZ.uint16r
-00000dc0: 2300 0000 7224 0000 0072 2600 0000 5a0a  #...r$...r&...Z.
-00000dd0: 6672 6f6d 6275 6666 6572 7227 0000 00da  frombufferr'....
-00000de0: 0772 6573 6861 7065 da09 7472 616e 7370  .reshape..transp
-00000df0: 6f73 6529 1072 2c00 0000 722d 0000 00da  ose).r,...r-....
-00000e00: 0b69 6d61 6765 5f72 616e 6765 da04 6172  .image_range..ar
-00000e10: 6773 da06 6b77 6172 6773 5a08 7374 6172  gs..kwargsZ.star
-00000e20: 7449 6478 5a06 656e 6449 6478 722e 0000  tIdxZ.endIdxr...
-00000e30: 00da 0770 6978 656c 7358 da07 7069 7865  ...pixelsX..pixe
-00000e40: 6c73 5972 2f00 0000 da06 6f66 6673 6574  lsYr/.....offset
-00000e50: da05 6368 756e 6b72 3000 0000 7231 0000  ..chunkr0...r1..
-00000e60: 005a 0c63 7572 7265 6e74 4672 616d 6572  .Z.currentFramer
-00000e70: 0700 0000 7207 0000 0072 0900 0000 da08  ....r....r......
-00000e80: 7265 6164 4461 7461 bd00 0000 7326 0000  readData....s&..
-00000e90: 0000 1308 0108 030c 010c 050c 0306 0112  ................
-00000ea0: 0814 060c 030a 010c 0204 0104 0102 fe04  ................
-00000eb0: 0614 060e 063c 087a 1446 726d 7336 5265  .....<.z.Frms6Re
-00000ec0: 6164 6572 2e72 6561 6444 6174 6163 0200  ader.readDatac..
-00000ed0: 0000 0000 0000 0000 0000 0600 0000 0d00  ................
-00000ee0: 0000 4300 0000 73ae 0000 0074 007c 0164  ..C...s....t.|.d
-00000ef0: 0183 028f 907d 027c 02a0 017c 006a 02a1  .....}.|...|.j..
-00000f00: 017d 037c 006a 03a0 047c 03a1 017d 0474  .}.|.j...|...}.t
-00000f10: 0564 027c 0464 0319 0066 0264 047c 0464  .d.|.d...f.d.|.d
-00000f20: 0519 0066 0264 067c 0464 0719 0066 0264  ...f.d.|.d...f.d
-00000f30: 087c 0464 0919 0066 0264 0a7c 0464 0b19  .|.d...f.d.|.d..
-00000f40: 0066 0264 0c7c 0464 0d19 0066 0264 0e7c  .f.d.|.d...f.d.|
-00000f50: 0464 0f19 00a0 0664 10a1 0166 0264 117c  .d.....d...f.d.|
-00000f60: 0464 1219 0066 0264 137c 0464 1419 0066  .d...f.d.|.d...f
-00000f70: 0267 0983 017d 0557 0064 1504 0004 0083  .g...}.W.d......
-00000f80: 0301 006e 1031 0073 a030 0001 0001 0001  ...n.1.s.0......
-00000f90: 0059 0001 007c 0553 0029 167a c452 6574  .Y...|.S.).z.Ret
-00000fa0: 7572 6e73 2074 6865 2066 696c 6520 6865  urns the file he
-00000fb0: 6164 6572 2061 7373 6f63 6961 7465 6420  ader associated 
-00000fc0: 7769 7468 2061 2066 726d 3620 6669 6c65  with a frm6 file
-00000fd0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00000fe0: 0a20 2020 2020 2020 2020 2020 2066 6e20  .            fn 
-00000ff0: 2873 7472 293a 2066 756c 6c79 2071 7561  (str): fully qua
-00001000: 6c69 6669 6564 2066 696c 6520 6e61 6d65  lified file name
-00001010: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00001020: 733a 0a20 2020 2020 2020 2020 2020 204f  s:.            O
-00001030: 7264 6572 6564 4469 6374 3a20 436f 6e74  rderedDict: Cont
-00001040: 656e 7473 206f 6620 7468 6520 6669 6c65  ents of the file
-00001050: 2068 6561 6465 720a 0a20 2020 2020 2020   header..       
-00001060: 2072 1200 0000 5a0e 6669 6c65 4865 6164   r....Z.fileHead
-00001070: 6572 5369 7a65 7201 0000 005a 0f66 7261  erSizer....Z.fra
-00001080: 6d65 4865 6164 6572 5369 7a65 7213 0000  meHeaderSizer...
-00001090: 005a 056e 4343 4473 7214 0000 005a 086d  .Z.nCCDsr....Z.m
-000010a0: 6178 5769 6474 6872 1500 0000 7221 0000  axWidthr....r!..
-000010b0: 0072 1600 0000 da07 7665 7273 696f 6e72  .r......versionr
-000010c0: 1700 0000 5a09 6461 7461 5365 7449 6472  ....Z.dataSetIdr
-000010d0: 1800 0000 f301 0000 0000 da05 7769 6474  ............widt
-000010e0: 6872 1900 0000 721e 0000 0072 1a00 0000  hr....r....r....
-000010f0: 4e29 0772 2300 0000 7227 0000 0072 2500  N).r#...r'...r%.
-00001100: 0000 da10 6669 6c65 4865 6164 6572 5374  ....fileHeaderSt
-00001110: 7275 6374 722a 0000 0072 0500 0000 da06  ructr*...r......
-00001120: 7273 7472 6970 2906 722c 0000 0072 2d00  rstrip).r,...r-.
-00001130: 0000 7230 0000 005a 0d66 696c 6548 6561  ..r0...Z.fileHea
-00001140: 6465 7252 6177 5a0f 6669 6c65 4865 6164  derRawZ.fileHead
-00001150: 6572 4974 656d 735a 0e66 696c 6548 6561  erItemsZ.fileHea
-00001160: 6465 7244 6963 7472 0700 0000 7207 0000  derDictr....r...
-00001170: 0072 0900 0000 da0d 6765 7446 696c 6548  .r......getFileH
-00001180: 6561 6465 720e 0100 0073 2000 0000 000b  eader....s .....
-00001190: 0c02 0c02 0c02 0202 0a01 0a01 0a01 0a01  ................
-000011a0: 0a01 0a01 1001 0a01 0af7 02ff 220d 7a19  ............".z.
-000011b0: 4672 6d73 3652 6561 6465 722e 6765 7446  Frms6Reader.getF
-000011c0: 696c 6548 6561 6465 724e 6303 0000 0000  ileHeaderNc.....
-000011d0: 0000 0000 0000 0009 0000 0005 0000 0043  ...............C
-000011e0: 0000 0073 7a00 0000 7c00 a000 7c01 a101  ...sz...|...|...
-000011f0: 7d03 7401 7c03 6401 1900 8301 7d04 7401  }.t.|.d.....}.t.
-00001200: 7c03 6402 1900 8301 7d05 7c00 6a02 7d06  |.d.....}.|.j.}.
-00001210: 7c06 7c00 a003 7c04 7c05 a102 3700 7d06  |.|...|.|...7.}.
-00001220: 7404 6a05 a006 7c01 a101 7d07 7c07 7c00  t.j...|...}.|.|.
-00001230: 6a07 1800 7c06 1b00 7d08 7408 7c08 8301  j...|...}.t.|...
-00001240: a009 a100 7368 740a 6403 8301 8201 6e08  ....sht.d.....n.
-00001250: 7401 7c08 8301 7d08 7c04 7c05 7c08 6603  t.|...}.|.|.|.f.
-00001260: 5300 2904 614d 0100 0052 6574 7572 6e73  S.).aM...Returns
-00001270: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
-00001280: 2073 6574 206f 6620 696d 6167 6520 696e   set of image in
-00001290: 2074 6865 2067 6976 656e 2066 696c 652c   the given file,
-000012a0: 0a20 2020 2020 2020 206e 756d 7079 2e73  .        numpy.s
-000012b0: 6861 7065 2073 7479 6c65 2e0a 0a20 2020  hape style...   
-000012c0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-000012d0: 2020 2020 2020 2066 6e20 2873 7472 293a         fn (str):
-000012e0: 2066 756c 6c79 2071 7561 6c69 6669 6564   fully qualified
-000012f0: 2066 696c 6520 6e61 6d65 0a20 2020 2020   file name.     
-00001300: 2020 2020 2020 2070 6174 6820 2873 7472         path (str
-00001310: 203d 2027 2f73 7472 6561 6d27 2c20 6f70   = '/stream', op
-00001320: 7469 6f6e 616c 293a 2055 6e75 7365 642c  tional): Unused,
-00001330: 2061 6464 6564 2066 6f72 2063 6f6d 7061   added for compa
-00001340: 7469 6269 6c69 7479 0a0a 2020 2020 2020  tibility..      
-00001350: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00001360: 2020 2020 2020 2033 2d74 7570 6c65 3a20         3-tuple: 
-00001370: 4865 6967 6874 2026 2077 6964 7468 206f  Height & width o
-00001380: 6620 7468 6520 6672 616d 6520 616e 6420  f the frame and 
-00001390: 6e75 6d62 6572 206f 6620 6672 616d 6573  number of frames
-000013a0: 2069 6e20 7468 6520 6669 6c65 0a0a 2020   in the file..  
-000013b0: 2020 2020 2020 7244 0000 0072 1e00 0000        rD...r....
-000013c0: 7a2f 7265 6164 5f66 7261 6d65 7320 2d2d  z/read_frames --
-000013d0: 204e 756d 6265 7220 6f66 2066 7261 6d65   Number of frame
-000013e0: 7320 6973 206e 6f74 2069 6e74 6567 6572  s is not integer
-000013f0: 2129 0b72 4700 0000 da03 696e 7472 2800  !).rG.....intr(.
-00001400: 0000 7211 0000 00da 026f 73da 0470 6174  ..r......os..pat
-00001410: 68da 0767 6574 7369 7a65 7225 0000 00da  h..getsizer%....
-00001420: 0566 6c6f 6174 da0a 6973 5f69 6e74 6567  .float..is_integ
-00001430: 6572 da07 5761 726e 696e 6729 0972 2c00  er..Warning).r,.
-00001440: 0000 722d 0000 0072 4a00 0000 5a0a 6669  ..r-...rJ...Z.fi
-00001450: 6c65 4865 6164 6572 720f 0000 0072 1000  leHeaderr....r..
-00001460: 0000 5a19 6672 616d 6541 6e64 4865 6164  ..Z.frameAndHead
-00001470: 6572 5369 7a65 496e 4279 7465 735a 0866  erSizeInBytesZ.f
-00001480: 696c 6553 697a 6572 2e00 0000 7207 0000  ileSizer....r...
-00001490: 0072 0700 0000 7209 0000 0072 2200 0000  .r....r....r"...
-000014a0: 2e01 0000 731a 0000 0000 0e0a 020c 010c  ....s...........
-000014b0: 0206 0110 020c 0308 0102 fe04 040c 010a  ................
-000014c0: 0208 027a 1846 726d 7336 5265 6164 6572  ...z.Frms6Reader
-000014d0: 2e67 6574 4461 7461 5368 6170 6529 014e  .getDataShape).N
-000014e0: 2915 da08 5f5f 6e61 6d65 5f5f da0a 5f5f  )...__name__..__
-000014f0: 6d6f 6475 6c65 5f5f da0c 5f5f 7175 616c  module__..__qual
-00001500: 6e61 6d65 5f5f da07 5f5f 646f 635f 5f5a  name__..__doc__Z
-00001510: 1066 696c 6548 6561 6465 7246 6f72 6d61  .fileHeaderForma
-00001520: 7472 0c00 0000 720d 0000 0072 2500 0000  tr....r....r%...
-00001530: da06 5374 7275 6374 7245 0000 005a 1166  ..StructrE...Z.f
-00001540: 7261 6d65 4865 6164 6572 466f 726d 6174  rameHeaderFormat
-00001550: 7228 0000 0072 2900 0000 720a 0000 00da  r(...r)...r.....
-00001560: 0c73 7461 7469 636d 6574 686f 6472 1100  .staticmethodr..
-00001570: 0000 da0b 636c 6173 736d 6574 686f 6472  ....classmethodr
-00001580: 3200 0000 7241 0000 0072 4700 0000 7222  2...rA...rG...r"
-00001590: 0000 0072 0700 0000 7207 0000 0072 0700  ...r....r....r..
-000015a0: 0000 7209 0000 0072 0600 0000 0f00 0000  ..r....r........
-000015b0: 7328 0000 0008 0104 0602 ff02 0f0a 010a  s(..............
-000015c0: 0502 ff02 260a 010a 0208 0302 010a 0e02  ....&...........
-000015d0: 010a 5802 010a 5002 010a 1f02 0172 0600  ..X...P......r..
-000015e0: 0000 fa07 2f73 7472 6561 6d63 0200 0000  ..../streamc....
-000015f0: 0000 0000 0000 0000 0d00 0000 0700 0000  ................
-00001600: 4b00 0000 73ac 0100 007c 02a0 0064 0164  K...s....|...d.d
-00001610: 02a1 027d 037c 02a0 0064 0364 02a1 027d  ...}.|...d.d...}
-00001620: 047c 02a0 0064 0464 02a1 027d 057c 02a0  .|...d.d...}.|..
-00001630: 0064 0564 02a1 027d 067c 02a0 0064 0664  .d.d...}.|...d.d
-00001640: 02a1 027d 077c 02a0 0064 0764 08a1 027d  ...}.|...d.d...}
-00001650: 0864 027d 097c 00a0 0164 09a1 0164 0a6b  .d.}.|...d...d.k
-00001660: 0372 7a7c 00a0 0264 0964 0ba1 027d 0a74  .rz|...d.d...}.t
-00001670: 036a 047c 0a64 0c64 0d64 0e64 0f8d 047d  .j.|.d.d.d.d...}
-00001680: 096e 0c74 03a0 047c 0064 0ca1 027d 0964  .n.t...|.d...}.d
-00001690: 027d 0b7c 0364 026b 0272 9c7c 097c 0119  .}.|.d.k.r.|.|..
-000016a0: 007d 0b6e 527c 0873 c87c 097c 0119 0064  .}.nR|.s.|.|...d
-000016b0: 0264 0285 0264 0264 0285 027c 0364 1019  .d...d.d...|.d..
-000016c0: 007c 0364 1119 0085 0266 0319 007d 0b6e  .|.d.....f...}.n
-000016d0: 267c 097c 0119 007c 0364 1019 007c 0364  &|.|...|.d...|.d
-000016e0: 1119 0085 0264 0264 0285 0264 0264 0285  .....d.d...d.d..
-000016f0: 0266 0319 007d 0b7c 0890 0172 2c74 05a0  .f...}.|...r,t..
-00001700: 067c 0ba1 017d 0b74 05a0 077c 0b64 12a1  .|...}.t...|.d..
-00001710: 027d 0b74 05a0 077c 0b64 12a1 027d 0b74  .}.t...|.d...}.t
-00001720: 05a0 077c 0b64 11a1 027d 0b74 05a0 087c  ...|.d...}.t...|
-00001730: 0ba1 017d 0b64 027d 0c7c 0464 026b 0290  ...}.d.}.|.d.k..
-00001740: 0172 667c 0564 026b 0290 0172 6674 05a0  .rf|.d.k...rft..
-00001750: 097c 0b64 0264 0285 0264 0264 0285 0264  .|.d.d...d.d...d
-00001760: 0264 0285 0266 0319 00a1 017d 0c6e 3074  .d...f.....}.n0t
-00001770: 05a0 097c 0b7c 0464 1019 007c 0464 1119  ...|.|.d...|.d..
-00001780: 0085 027c 0564 1019 007c 0564 1119 0085  ...|.d...|.d....
-00001790: 0264 0264 0285 0266 0319 00a1 017d 0c7c  .d.d...f.....}.|
-000017a0: 09a0 0aa1 0001 0074 05a0 0b7c 0c74 056a  .......t...|.t.j
-000017b0: 0ca1 0253 0029 1361 e003 0000 5265 6164  ...S.).a....Read
-000017c0: 7320 6461 7461 2066 726f 6d20 6120 6769  s data from a gi
-000017d0: 7665 6e20 6669 6c65 2028 6661 6d69 6c79  ven file (family
-000017e0: 2920 616e 6420 6f75 7470 7574 2072 656f  ) and output reo
-000017f0: 7264 6572 6564 2069 6d61 6765 730a 2020  rdered images.  
-00001800: 2020 696e 2073 7461 636b 730a 0a20 2020    in stacks..   
-00001810: 2041 7267 733a 0a20 2020 2020 2020 2066   Args:.        f
-00001820: 696c 656e 616d 6520 2873 7472 293a 2074  ilename (str): t
-00001830: 6865 2066 696c 6520 7061 7468 2061 6e64  he file path and
-00001840: 206e 616d 652e 2049 6620 7468 6520 6669   name. If the fi
-00001850: 6c65 2069 7320 6163 7475 616c 6c79 2061  le is actually a
-00001860: 0a20 2020 2020 2020 2020 2020 2066 616d  .            fam
-00001870: 696c 7920 6f66 2066 696c 6573 206f 6e6c  ily of files onl
-00001880: 7920 7468 6520 6669 7273 7420 6669 6c65  y the first file
-00001890: 2c20 692e 652e 2074 6865 206f 6e65 2077  , i.e. the one w
-000018a0: 6974 6820 696e 6465 780a 2020 2020 2020  ith index.      
-000018b0: 2020 2020 2020 3030 3030 302e 6835 2073        00000.h5 s
-000018c0: 686f 756c 6420 6265 2067 6976 656e 2e0a  hould be given..
-000018d0: 2020 2020 2020 2020 7061 7468 2028 7374          path (st
-000018e0: 7220 3d20 272f 7374 7265 616d 272c 206f  r = '/stream', o
-000018f0: 7074 696f 6e61 6c29 3a20 7468 6520 7061  ptional): the pa
-00001900: 7468 2069 6e20 7468 6520 6864 6635 2066  th in the hdf5 f
-00001910: 696c 6520 6174 2077 6869 6368 2074 6865  ile at which the
-00001920: 2064 6174 6120 6973 0a20 2020 2020 2020   data is.       
-00001930: 2020 2020 206c 6f63 6174 6564 2e0a 2020       located..  
-00001940: 2020 2020 2020 6b77 6172 6773 3a20 7468        kwargs: th
-00001950: 6520 666f 6c6c 6f77 696e 6720 6164 6469  e following addi
-00001960: 7469 6f6e 616c 2070 6172 616d 6574 6572  tional parameter
-00001970: 7320 6d61 7920 6265 2067 6976 656e 3a0a  s may be given:.
-00001980: 0a20 2020 2020 2020 2020 2020 202a 2069  .            * i
-00001990: 6d61 6765 5f72 616e 6765 2028 5b6c 6f77  mage_range ([low
-000019a0: 2c20 6869 6768 5d29 3a20 6120 7261 6e67  , high]): a rang
-000019b0: 6520 6f66 2069 6d61 6765 7320 746f 2062  e of images to b
-000019c0: 6520 7265 6164 0a20 2020 2020 2020 2020  e read.         
-000019d0: 2020 202a 2078 5f72 616e 6765 2028 5b6c     * x_range ([l
-000019e0: 6f77 2c20 6869 6768 5d29 3a20 6120 7261  ow, high]): a ra
-000019f0: 6e67 6520 6f66 2070 6978 656c 7320 746f  nge of pixels to
-00001a00: 2062 6520 7265 6164 0a20 2020 2020 2020   be read.       
-00001a10: 2020 2020 202a 2079 5f72 616e 6765 2028       * y_range (
-00001a20: 5b6c 6f77 2c20 6869 6768 5d29 3a20 6120  [low, high]): a 
-00001a30: 7261 6e67 6520 6f66 2070 6978 656c 7320  range of pixels 
-00001a40: 746f 2062 6520 7265 6164 0a20 2020 2020  to be read.     
-00001a50: 2020 2020 2020 202a 2070 6978 656c 735f         * pixels_
-00001a60: 7820 2869 6e74 293a 206e 756d 6265 7220  x (int): number 
-00001a70: 6f66 2070 6978 656c 7320 616c 6f6e 6720  of pixels along 
-00001a80: 782d 6178 6973 2c20 2a2a 636f 6d70 6174  x-axis, **compat
-00001a90: 6962 696c 6974 7920 6f6e 6c79 2a2a 2e0a  ibility only**..
-00001aa0: 2020 2020 2020 2020 2020 2020 2a20 7069              * pi
-00001ab0: 7865 6c73 5f79 2028 696e 7429 3a20 6e75  xels_y (int): nu
-00001ac0: 6d62 6572 206f 6620 7069 7865 6c73 2061  mber of pixels a
-00001ad0: 6c6f 6e67 2079 2d61 7869 732c 202a 2a63  long y-axis, **c
-00001ae0: 6f6d 7061 7469 6269 6c69 7479 206f 6e6c  ompatibility onl
-00001af0: 792a 2a2e 0a0a 0a20 2020 2052 6574 7572  y**....    Retur
-00001b00: 6e73 3a0a 2020 2020 2020 2020 6e75 6d70  ns:.        nump
-00001b10: 792e 6172 7261 793a 2061 2072 656f 7264  y.array: a reord
-00001b20: 6572 6564 2061 6e64 2069 6e76 6572 7465  ered and inverte
-00001b30: 6420 696d 6167 6520 7769 7468 2072 616e  d image with ran
-00001b40: 6b20 320a 0a20 2020 204e 6f74 653a 0a20  k 2..    Note:. 
-00001b50: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
-00001b60: 7469 6f6e 2069 7320 636f 6d70 6174 6962  tion is compatib
-00001b70: 6c65 2077 6974 6820 2078 6665 6c70 7963  le with  xfelpyc
-00001b80: 616c 746f 6f6c 732e 4368 756e 6b65 6452  altools.ChunkedR
-00001b90: 6561 6465 720a 0a0a 2020 2020 723a 0000  eader...    r:..
-00001ba0: 004e 5a07 785f 7261 6e67 655a 0779 5f72  .NZ.x_rangeZ.y_r
-00001bb0: 616e 6765 7233 0000 0072 3400 0000 da09  anger3...r4.....
-00001bc0: 7369 6d75 6c61 7465 6446 da05 3030 3030  simulatedF..0000
-00001bd0: 30e9 ffff ffff fa04 2530 3564 da01 72da  0.......%05d..r.
-00001be0: 0666 616d 696c 79ec 0300 0000 0000 0000  .family.........
-00001bf0: 1400 a902 da06 6472 6976 6572 5a09 6d65  ......driverZ.me
-00001c00: 6d62 5f73 697a 6572 0100 0000 7213 0000  mb_sizer....r...
-00001c10: 0072 1400 0000 290d 7235 0000 00da 0466  .r....).r5.....f
-00001c20: 696e 64da 0772 6570 6c61 6365 da04 6835  ind..replace..h5
-00001c30: 7079 da04 4669 6c65 7236 0000 005a 0773  py..Filer6...Z.s
-00001c40: 7175 6565 7a65 5a08 726f 6c6c 6178 6973  queezeZ.rollaxis
-00001c50: 5a11 6173 636f 6e74 6967 756f 7573 6172  Z.ascontiguousar
-00001c60: 7261 79da 0561 7272 6179 da05 636c 6f73  ray..array..clos
-00001c70: 65da 0761 7361 7272 6179 5a07 666c 6f61  e..asarrayZ.floa
-00001c80: 7436 3429 0dda 0866 696c 656e 616d 6572  t64)...filenamer
-00001c90: 4a00 0000 723c 0000 005a 0a69 6d61 6765  J...r<...Z.image
-00001ca0: 5261 6e67 655a 0b70 6978 656c 5852 616e  RangeZ.pixelXRan
-00001cb0: 6765 5a0b 7069 7865 6c59 5261 6e67 6572  geZ.pixelYRanger
-00001cc0: 3d00 0000 723e 0000 0072 5700 0000 da01  =...r>...rW.....
-00001cd0: 66da 0b66 696c 656e 616d 6546 616d 5a03  f..filenameFamZ.
-00001ce0: 6469 6eda 0164 7207 0000 0072 0700 0000  din..dr....r....
-00001cf0: 7209 0000 0072 4100 0000 5201 0000 7342  r....rA...R...sB
-00001d00: 0000 0000 1c0c 010c 010c 010c 010c 010c  ................
-00001d10: 0204 010e 010c 0204 0108 ff08 040c 0204  ................
-00001d20: 0108 010a 0204 0128 0226 0206 010a 010c  .......(.&......
-00001d30: 010c 010c 020a 0204 0114 0122 0204 0128  ..........."...(
-00001d40: ff04 0308 0172 4100 0000 6302 0000 0000  .....rA...c.....
-00001d50: 0000 0000 0000 0004 0000 0006 0000 0043  ...............C
-00001d60: 0000 0073 4800 0000 6401 7d02 7c00 a000  ...sH...d.}.|...
-00001d70: 6402 a101 6403 6b03 7232 7c00 a001 6402  d...d.k.r2|...d.
-00001d80: 6404 a102 7d03 7402 6a03 7c03 6405 6406  d...}.t.j.|.d.d.
-00001d90: 6407 6408 8d04 7d02 6e0c 7402 a003 7c00  d.d...}.n.t...|.
-00001da0: 6405 a102 7d02 7c02 7c01 1900 6a04 5300  d...}.|.|...j.S.
-00001db0: 2909 616c 0100 0052 6574 7572 6e73 2074  ).al...Returns t
-00001dc0: 6865 206e 756d 6265 7220 6f66 2069 6d61  he number of ima
-00001dd0: 6765 2069 6e20 6120 6769 7665 6e20 6669  ge in a given fi
-00001de0: 6c65 2028 6661 6d69 6c79 290a 0a20 2020  le (family)..   
-00001df0: 2041 7267 733a 0a20 2020 2020 2020 2066   Args:.        f
-00001e00: 696c 656e 616d 6520 2873 7472 293a 2074  ilename (str): t
-00001e10: 6865 2066 696c 6520 7061 7468 2061 6e64  he file path and
-00001e20: 206e 616d 652e 2049 6620 7468 6520 6669   name. If the fi
-00001e30: 6c65 2069 7320 6163 7475 616c 6c79 2061  le is actually a
-00001e40: 2066 616d 696c 790a 2020 2020 2020 2020   family.        
-00001e50: 2020 2020 6f66 2066 696c 6573 206f 6e6c      of files onl
-00001e60: 7920 7468 6520 6669 7273 7420 6669 6c65  y the first file
-00001e70: 2c20 692e 652e 2074 6865 206f 6e65 2077  , i.e. the one w
-00001e80: 6974 6820 696e 6465 7820 3030 3030 302e  ith index 00000.
-00001e90: 6835 0a20 2020 2020 2020 2020 2020 2073  h5.            s
-00001ea0: 686f 756c 6420 6265 2067 6976 656e 2e0a  hould be given..
-00001eb0: 2020 2020 2020 2020 7061 7468 2028 7374          path (st
-00001ec0: 7220 3d20 272f 7374 7265 616d 272c 206f  r = '/stream', o
-00001ed0: 7074 696f 6e61 6c29 3a20 7468 6520 7061  ptional): the pa
-00001ee0: 7468 2069 6e20 7468 6520 6864 6635 2066  th in the hdf5 f
-00001ef0: 696c 6520 6174 2077 6869 6368 0a20 2020  ile at which.   
-00001f00: 2020 2020 2020 2020 2074 6865 2064 6174           the dat
-00001f10: 6120 6973 206c 6f63 6174 6564 2e0a 0a20  a is located... 
-00001f20: 2020 204e 7258 0000 0072 5900 0000 725a     NrX...rY...rZ
-00001f30: 0000 0072 5b00 0000 725c 0000 0072 5d00  ...r[...r\...r].
-00001f40: 0000 725e 0000 0029 0572 6000 0000 7261  ..r^...).r`...ra
-00001f50: 0000 0072 6200 0000 7263 0000 00da 0573  ...rb...rc.....s
-00001f60: 6861 7065 2904 7267 0000 0072 4a00 0000  hape).rg...rJ...
-00001f70: 7268 0000 0072 6900 0000 7207 0000 0072  rh...ri...r....r
-00001f80: 0700 0000 7209 0000 00da 0b67 6574 4461  ....r......getDa
-00001f90: 7461 5369 7a65 9b01 0000 7310 0000 0000  taSize....s.....
-00001fa0: 0c04 010e 010c 0204 0108 ff08 040c 0272  ...............r
-00001fb0: 6c00 0000 6301 0000 0000 0000 0000 0000  l...c...........
-00001fc0: 0012 0000 0007 0000 0043 0000 0073 3002  .........C...s0.
-00001fd0: 0000 7400 a001 a100 7d01 7400 a002 7c00  ..t.....}.t...|.
-00001fe0: a101 0100 7403 6a04 a005 a100 7d02 6401  ....t.j.....}.d.
-00001ff0: 7d03 7406 a006 6402 a101 4400 5d0c 7d04  }.t...d...D.].}.
-00002000: 7c03 6403 3700 7d03 712a 7407 6a08 7c03  |.d.7.}.q*t.j.|.
-00002010: 6404 6602 7409 6405 8d02 7d05 7407 6a08  d.f.t.d...}.t.j.
-00002020: 7c03 740a 6405 8d02 7d06 6401 7d07 7406  |.t.d...}.d.}.t.
-00002030: a006 6402 a101 4400 5d50 7d04 7c00 7c04  ..d...D.]P}.|.|.
-00002040: 1700 7d08 7407 6a0b 7c02 a00c 7c08 a101  ..}.t.j.|...|...
-00002050: 7409 6405 8d02 7d09 7c09 7c05 7c07 6401  t.d...}.|.|.|.d.
-00002060: 6406 8502 6602 3c00 7c08 6407 1900 7c05  d...f.<.|.d...|.
-00002070: 7c07 6408 6602 3c00 7c08 7c06 7c07 3c00  |.d.f.<.|.|.|.<.
-00002080: 7c07 6403 3700 7d07 7166 7c05 7c05 6400  |.d.7.}.qf|.|.d.
-00002090: 6400 8502 6408 6602 1900 6401 6b02 6401  d...d.f...d.k.d.
-000020a0: 6406 8502 6602 1900 6401 1900 7d0a 7407  d...f...d...}.t.
-000020b0: a00d 7c0a a101 7d0b 7407 a00e 7c05 6400  ..|...}.t...|.d.
-000020c0: 6400 8502 6409 6602 1900 a101 7407 a00f  d...d.f.....t...
-000020d0: 7c05 6400 6400 8502 6409 6602 1900 a101  |.d.d...d.f.....
-000020e0: 1800 a010 7409 a101 7c0b 6408 3c00 7407  ....t...|.d.<.t.
-000020f0: a008 7c0b a101 7d0c 7407 6a11 7c05 7c05  ..|...}.t.j.|.|.
-00002100: 6400 6400 8502 6408 6602 1900 6401 6b03  d.d...d.f...d.k.
-00002110: 6401 6406 8502 6602 1900 6401 640a 8d02  d.d...f...d.d...
-00002120: a010 7409 a101 7d0d 7407 a012 7c03 a101  ..t...}.t...|...
-00002130: 4400 5dac 7d07 7c05 7c07 6408 6602 1900  D.].}.|.|.d.f...
-00002140: 6401 6b02 9001 729e 7c02 6a13 7c06 7c07  d.k...r.|.j.|.|.
-00002150: 1900 6401 7c0a 6408 1900 6602 7c0a 6401  ..d.|.d...f.|.d.
-00002160: 1900 7c0a 6403 1900 640b 8d04 7d0e 6e6c  ..|.d...d...}.nl
-00002170: 7c05 7c07 6408 6602 1900 7d0f 7409 7c0f  |.|.d.f...}.t.|.
-00002180: 6403 1800 7c0d 6408 1900 1400 8301 7d10  d...|.d.......}.
-00002190: 7409 7c0f 7c0d 6408 1900 1400 8301 7d11  t.|.|.d.......}.
-000021a0: 7c02 6a13 7c06 7c07 1900 6401 7c0d 6408  |.j.|.|...d.|.d.
-000021b0: 1900 6602 7c0d 6401 1900 7c0d 6403 1900  ..f.|.d...|.d...
-000021c0: 640b 8d04 7c0c 6400 6400 8502 6400 6400  d...|.d.d...d.d.
-000021d0: 8502 7c10 7c11 8502 6603 3c00 9001 7160  ..|.|...f.<...q`
-000021e0: 7400 a002 7c01 a101 0100 7c0c a010 7407  t...|.....|...t.
-000021f0: 6a14 a101 7c0e a010 7407 6a14 a101 6602  j...|...t.j...f.
-00002200: 5300 290c 4e72 0100 0000 fa07 2a2e 6672  S.).Nr......*.fr
-00002210: 6d73 3672 1300 0000 7216 0000 00a9 015a  ms6r....r......Z
-00002220: 0564 7479 7065 7215 0000 00e9 f9ff ffff  .dtyper.........
-00002230: 7259 0000 00e9 feff ffff a901 5a04 6178  rY..........Z.ax
-00002240: 6973 a903 723a 0000 0072 3300 0000 7234  is..r:...r3...r4
-00002250: 0000 0029 1572 4900 0000 da06 6765 7463  ...).rI.....getc
-00002260: 7764 da05 6368 6469 72da 0273 74da 0475  wd..chdir..st..u
-00002270: 7469 6c72 0600 0000 da04 676c 6f62 7236  tilr......globr6
-00002280: 0000 0072 3700 0000 7248 0000 00da 066f  ...r7...rH.....o
-00002290: 626a 6563 7472 6600 0000 7222 0000 00da  bjectrf...r"....
-000022a0: 0463 6f70 79da 0373 756d da04 616d 696e  .copy..sum..amin
-000022b0: da06 6173 7479 7065 da04 6d65 616e da06  ..astype..mean..
-000022c0: 6172 616e 6765 7241 0000 00da 0766 6c6f  arangerA.....flo
-000022d0: 6174 3332 2912 da08 6461 7461 5f64 6972  at32)...data_dir
-000022e0: da0b 6375 7272 656e 745f 6469 72da 0a64  ..current_dir..d
-000022f0: 6174 615f 636c 6173 73da 0974 6f74 5f66  ata_class..tot_f
-00002300: 696c 6573 da04 6669 6c65 da09 6669 6c65  iles..file..file
-00002310: 7369 7a65 73da 0966 696c 656e 616d 6573  sizes..filenames
-00002320: da02 6969 da05 666e 616d 65da 0664 7368  ..ii..fname..dsh
-00002330: 6170 65da 0a64 7265 665f 7368 6170 65da  ape..dref_shape.
-00002340: 0a64 6174 615f 7368 6170 65da 0764 6174  .data_shape..dat
-00002350: 615f 3344 da0a 6472 6177 5f73 6861 7065  a_3D..draw_shape
-00002360: da08 6461 726b 5f72 6566 5a09 6672 6d73  ..dark_refZ.frms
-00002370: 365f 6e75 6d5a 0a73 7461 7274 5f66 696c  6_numZ.start_fil
-00002380: 6c5a 0973 746f 705f 6669 6c6c 7207 0000  lZ.stop_fillr...
-00002390: 0072 0700 0000 7209 0000 00da 0c67 6574  .r....r......get
-000023a0: 5f64 6174 615f 7265 66b4 0100 0073 5000  _data_ref....sP.
-000023b0: 0000 0001 0801 0a01 0a01 0401 0e01 0a01  ................
-000023c0: 1201 0e02 0401 0e01 0801 1401 1001 1001  ................
-000023d0: 0801 0a02 2401 0a01 3601 0a01 3002 0e01  ....$...6...0...
-000023e0: 1201 0401 0601 0a01 0601 06fc 0807 0c01  ................
-000023f0: 1401 1001 0401 0601 0a01 0601 06fc 2006  .............. .
-00002400: 0a01 728f 0000 0046 6303 0000 0000 0000  ..r....Fc.......
-00002410: 0000 0000 0013 0000 0006 0000 0043 0000  .............C..
-00002420: 0073 3c01 0000 7400 a001 a100 7d03 7c00  .s<...t.....}.|.
-00002430: 6a02 7d04 7403 7404 a005 7c04 6401 6402  j.}.t.t...|.d.d.
-00002440: 8502 1900 a101 7404 a005 6403 a101 1400  ......t...d.....
-00002450: a006 7407 a101 8301 7d05 7407 7c04 6404  ..t.....}.t.|.d.
-00002460: 1900 6405 1300 8301 7d06 7408 6a09 7c00  ..d.....}.t.j.|.
-00002470: 6406 6407 8d02 7d07 7c07 6a02 7d04 7404  d.d...}.|.j.}.t.
-00002480: 6a0a 7c01 a006 7404 6a0b a101 6404 6408  j.|...t.j...d.d.
-00002490: 8d02 7d08 7408 a00c 7c07 6409 a102 7d09  ..}.t...|.d...}.
-000024a0: 7c09 7c08 1800 7d0a 7408 a00c 7c0a 640a  |.|...}.t...|.d.
-000024b0: a102 7d0b 7c0b 6401 7c05 6401 1900 8502  ..}.|.d.|.d.....
-000024c0: 6400 6400 8502 6400 6400 8502 6603 1900  d.d...d.d...f...
-000024d0: 7d0c 7c0b 7c05 6401 1900 7c04 6401 1900  }.|.|.d...|.d...
-000024e0: 8502 6400 6400 8502 6400 6400 8502 6603  ..d.d...d.d...f.
-000024f0: 1900 7d0d 7c0c 6400 6400 6404 8503 6400  ..}.|.d.d.d...d.
-00002500: 6400 6404 8503 6400 6400 8502 6603 1900  d.d...d.d...f...
-00002510: 7d0e 7408 6a0d 7c0d 7c0e 6702 640b 6408  }.t.j.|.|.g.d.d.
-00002520: 8d02 7d0f 7c05 6401 1900 7c05 640b 1900  ..}.|.d...|.d...
-00002530: 7c06 7c06 6604 7d10 7408 a00e 7c0f 7c10  |.|.f.}.t...|.|.
-00002540: a102 7d11 7c02 9001 7228 7c11 5300 7c11  ..}.|...r(|.S.|.
-00002550: 6a0f 7c03 640c 8d01 7d12 7c12 5300 6400  j.|.d...}.|.S.d.
-00002560: 5300 290d 4e72 0100 0000 7214 0000 00a9  S.).Nr....r.....
-00002570: 02e7 0000 0000 0000 e03f 7214 0000 0072  .........?r....r
-00002580: 5900 0000 7291 0000 0029 0372 5900 0000  Y...r....).rY...
-00002590: 7259 0000 00da 0461 7574 6f29 01da 0663  rY.....auto)...c
-000025a0: 6875 6e6b 7372 7100 0000 a903 7214 0000  hunksrq.....r...
-000025b0: 0072 0100 0000 7213 0000 00a9 0372 1300  .r....r......r..
-000025c0: 0000 7214 0000 0072 0100 0000 7213 0000  ..r....r....r...
+00000250: 0000 0064 0053 00a9 014e a900 2901 da04  ...d.S...N..)...
+00000260: 7365 6c66 7208 0000 0072 0800 0000 fa33  selfr....r.....3
+00000270: 6275 696c 642f 6264 6973 742e 6c69 6e75  build/bdist.linu
+00000280: 782d 7838 365f 3634 2f65 6767 2f73 7465  x-x86_64/egg/ste
+00000290: 6d74 6f6f 6c2f 7574 696c 2f70 6e63 6364  mtool/util/pnccd
+000002a0: 2e70 79da 085f 5f69 6e69 745f 5f52 0000  .py..__init__R..
+000002b0: 0073 0200 0000 0401 7a14 4672 6d73 3652  .s......z.Frms6R
+000002c0: 6561 6465 722e 5f5f 696e 6974 5f5f 6302  eader.__init__c.
+000002d0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+000002e0: 0000 0043 0000 0073 1600 0000 7400 a001  ...C...s....t...
+000002f0: 7402 7c00 7c01 1400 8301 6401 1700 a101  t.|.|.....d.....
+00000300: 5300 2902 6102 0100 0043 6f6e 7665 6e69  S.).a....Conveni
+00000310: 656e 6365 206d 6574 686f 6420 746f 2064  ence method to d
+00000320: 6574 6572 6d69 6e65 2074 6865 2066 7261  etermine the fra
+00000330: 6d65 2073 697a 6520 2877 6974 686f 7574  me size (without
+00000340: 2066 7261 6d65 0a20 2020 2020 2020 2068   frame.        h
+00000350: 6561 6465 7221 290a 0a20 2020 2020 2020  eader!)..       
+00000360: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00000370: 2020 2066 7261 6d65 5769 6474 6820 2869     frameWidth (i
+00000380: 6e74 293a 2077 6964 7468 206f 6620 7468  nt): width of th
+00000390: 6520 6672 616d 650a 2020 2020 2020 2020  e frame.        
+000003a0: 2020 2020 6672 616d 6548 6569 6768 7420      frameHeight 
+000003b0: 2869 6e74 293a 2068 6569 6768 7420 6f66  (int): height of
+000003c0: 2074 6865 2066 7261 6d65 0a0a 2020 2020   the frame..    
+000003d0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+000003e0: 2020 2020 2020 2020 2069 6e74 3a20 4672           int: Fr
+000003f0: 616d 6520 7369 7a65 2069 6e20 6279 7465  ame size in byte
+00000400: 730a 0a20 2020 2020 2020 20da 0168 2903  s..        ..h).
+00000410: da06 7374 7275 6374 da08 6361 6c63 7369  ..struct..calcsi
+00000420: 7a65 da03 7374 7229 02da 0a66 7261 6d65  ze..str)...frame
+00000430: 5769 6474 68da 0b66 7261 6d65 4865 6967  Width..frameHeig
+00000440: 6874 7208 0000 0072 0800 0000 720a 0000  htr....r....r...
+00000450: 00da 1367 6574 4672 616d 6553 697a 6549  ...getFrameSizeI
+00000460: 6e42 7974 6573 5500 0000 7302 0000 0016  nBytesU...s.....
+00000470: 0d7a 1f46 726d 7336 5265 6164 6572 2e67  .z.Frms6Reader.g
+00000480: 6574 4672 616d 6553 697a 6549 6e42 7974  etFrameSizeInByt
+00000490: 6573 6302 0000 0000 0000 0000 0000 0012  esc.............
+000004a0: 0000 000a 0000 0043 0000 0073 3e01 0000  .......C...s>...
+000004b0: 7400 a001 7c01 a101 5c03 7d02 7d03 7d04  t...|...\.}.}.}.
+000004c0: 7c00 a002 7c03 7c02 a102 7d05 6700 7d06  |...|.|...}.g.}.
+000004d0: 6700 7d07 6700 7d08 6700 7d02 6700 7d09  g.}.g.}.g.}.g.}.
+000004e0: 6700 7d0a 6700 7d0b 6700 7d0c 6700 7d0d  g.}.g.}.g.}.g.}.
+000004f0: 7403 7c01 6401 8302 8f66 7d0e 7c0e a004  t.|.d....f}.|...
+00000500: 7c00 6a05 a101 0100 7406 7c04 8301 4400  |.j.....t.|...D.
+00000510: 5d53 7d0f 7c0e a007 7400 6a08 a101 7d10  ]S}.|...t.j...}.
+00000520: 7c00 6a09 a00a 7c10 a101 7d11 7c06 a00b  |.j...|...}.|...
+00000530: 7c11 6402 1900 a101 0100 7c07 a00b 7c11  |.d.......|...|.
+00000540: 6403 1900 a101 0100 7c08 a00b 7c11 6404  d.......|...|.d.
+00000550: 1900 a101 0100 7c02 a00b 7c11 6405 1900  ......|...|.d...
+00000560: a101 0100 7c09 a00b 7c11 6406 1900 a101  ....|...|.d.....
+00000570: 0100 7c0a a00b 7c11 6407 1900 a101 0100  ..|...|.d.......
+00000580: 7c0b a00b 7c11 6408 1900 a101 0100 7c0c  |...|.d.......|.
+00000590: a00b 7c11 6409 1900 a101 0100 7c0d a00b  ..|.d.......|...
+000005a0: 7c11 640a 1900 a101 0100 7c0e a004 7c05  |.d.......|...|.
+000005b0: 6403 a102 0100 7130 5700 640b 0400 0400  d.....q0W.d.....
+000005c0: 8303 0100 6e08 3100 738e 7701 0100 0100  ....n.1.s.w.....
+000005d0: 0100 5900 0100 7c06 7c07 7c08 7c02 7c09  ..Y...|.|.|.|.|.
+000005e0: 7c0a 7c0b 7c0c 7c0d 640c 9c09 5300 290d  |.|.|.|.d...S.).
+000005f0: 61e3 0100 0052 6561 6473 2074 6865 2066  a....Reads the f
+00000600: 7261 6d65 2068 6561 6465 7273 206f 6620  rame headers of 
+00000610: 616e 2065 6e74 6972 6520 6672 6d73 3620  an entire frms6 
+00000620: 6669 6c65 2e20 5468 6520 6672 616d 6520  file. The frame 
+00000630: 6865 6164 6572 0a20 2020 2020 2020 206b  header.        k
+00000640: 6579 7320 6172 653a 0a0a 2020 2020 2020  eys are:..      
+00000650: 2020 2020 2020 2a20 7374 6172 740a 2020        * start.  
+00000660: 2020 2020 2020 2020 2020 2a20 696e 666f            * info
+00000670: 0a20 2020 2020 2020 2020 2020 202a 2069  .            * i
+00000680: 640a 2020 2020 2020 2020 2020 2020 2a20  d.            * 
+00000690: 6865 6967 6874 0a20 2020 2020 2020 2020  height.         
+000006a0: 2020 202a 2074 765f 7365 630a 2020 2020     * tv_sec.    
+000006b0: 2020 2020 2020 2020 2a20 7476 5f75 7365          * tv_use
+000006c0: 630a 2020 2020 2020 2020 2020 2020 2a20  c.            * 
+000006d0: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
+000006e0: 2020 2a20 7465 6d70 0a20 2020 2020 2020    * temp.       
+000006f0: 2020 2020 202a 206d 6178 4865 6967 6874       * maxHeight
+00000700: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00000710: 2020 2020 2020 2020 2020 2020 666e 2028              fn (
+00000720: 7374 7229 3a20 6675 6c6c 7920 7175 616c  str): fully qual
+00000730: 6966 6965 6420 6669 6c65 206e 616d 650a  ified file name.
+00000740: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00000750: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00000760: 6374 3a20 436f 6e74 656e 7473 206f 6620  ct: Contents of 
+00000770: 7468 6520 616c 6c20 6672 616d 6520 6865  the all frame he
+00000780: 6164 6572 7320 7375 6264 6976 6964 6564  aders subdivided
+00000790: 2069 6e74 6f20 6c69 7374 732c 2077 6974   into lists, wit
+000007a0: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+000007b0: 2020 6f6e 6520 6c69 7374 2070 6572 2066    one list per f
+000007c0: 7261 6d65 2068 6561 6465 7220 6b65 790a  rame header key.
+000007d0: 2020 2020 2020 2020 da02 7262 7201 0000          ..rbr...
+000007e0: 00e9 0100 0000 e902 0000 00e9 0300 0000  ................
+000007f0: e904 0000 00e9 0500 0000 e906 0000 00e9  ................
+00000800: 0700 0000 e908 0000 004e 2909 da05 7374  .........N)...st
+00000810: 6172 74da 0469 6e66 6fda 0269 64da 0668  art..info..id..h
+00000820: 6569 6768 745a 0674 765f 7365 635a 0774  eightZ.tv_secZ.t
+00000830: 765f 7573 6563 da05 696e 6465 78da 0474  v_usec..index..t
+00000840: 656d 70da 096d 6178 4865 6967 6874 290c  emp..maxHeight).
+00000850: 7206 0000 00da 0c67 6574 4461 7461 5368  r......getDataSh
+00000860: 6170 6572 1200 0000 da04 6f70 656e da04  aper......open..
+00000870: 7365 656b da15 6669 6c65 4865 6164 6572  seek..fileHeader
+00000880: 5369 7a65 496e 4279 7465 73da 0572 616e  SizeInBytes..ran
+00000890: 6765 da04 7265 6164 da16 6672 616d 6548  ge..read..frameH
+000008a0: 6561 6465 7253 697a 6549 6e42 7974 6573  eaderSizeInBytes
+000008b0: da11 6672 616d 6548 6561 6465 7253 7472  ..frameHeaderStr
+000008c0: 7563 74da 0675 6e70 6163 6bda 0661 7070  uct..unpack..app
+000008d0: 656e 6429 12da 0363 6c73 da02 666e 7211  end)...cls..fnr.
+000008e0: 0000 0072 1000 0000 da0e 6e75 6d62 6572  ...r......number
+000008f0: 4f66 4672 616d 6573 da10 6672 616d 6553  OfFrames..frameS
+00000900: 697a 6549 6e42 7974 6573 5a0a 6672 616d  izeInBytesZ.fram
+00000910: 6553 7461 7274 5a09 6672 616d 6549 6e66  eStartZ.frameInf
+00000920: 6f5a 0766 7261 6d65 4964 5a0a 6672 616d  oZ.frameIdZ.fram
+00000930: 6554 7653 6563 5a0b 6672 616d 6554 7655  eTvSecZ.frameTvU
+00000940: 7365 635a 0a66 7261 6d65 496e 6465 785a  secZ.frameIndexZ
+00000950: 0966 7261 6d65 5465 6d70 5a0e 6672 616d  .frameTempZ.fram
+00000960: 654d 6178 4865 6967 6874 da02 6668 da08  eMaxHeight..fh..
+00000970: 6672 616d 6549 6478 5a0e 6672 616d 6548  frameIdxZ.frameH
+00000980: 6561 6465 7252 6177 5a10 6672 616d 6548  eaderRawZ.frameH
+00000990: 6561 6465 7249 7465 6d73 7208 0000 0072  eaderItemsr....r
+000009a0: 0800 0000 720a 0000 00da 0f67 6574 4672  ....r......getFr
+000009b0: 616d 6548 6561 6465 7273 6400 0000 7350  ameHeadersd...sP
+000009c0: 0000 0010 170c 0504 0f04 0104 0104 0104  ................
+000009d0: 0104 0104 0104 0104 010c 020c 020c 010c  ................
+000009e0: 010c 010e 040e 010e 010e 010e 010e 010e  ................
+000009f0: 010e 010e 0104 0304 0106 ff02 ef1c fd02  ................
+00000a00: 1902 0102 0102 0102 0102 0102 0102 0102  ................
+00000a10: 0106 f77a 1b46 726d 7336 5265 6164 6572  ...z.Frms6Reader
+00000a20: 2e67 6574 4672 616d 6548 6561 6465 7273  .getFrameHeaders
+00000a30: 6302 0000 0000 0000 0001 0000 0010 0000  c...............
+00000a40: 0008 0000 004f 0000 0073 f400 0000 7c02  .....O...s....|.
+00000a50: 5c02 7d05 7d06 7c06 7c05 1800 7d07 7c04  \.}.}.|.|...}.|.
+00000a60: a000 6401 6402 a102 7d08 7c04 a000 6403  ..d.d...}.|...d.
+00000a70: 6402 a102 7d09 7c00 a001 7c08 7c09 a102  d...}.|...|.|...
+00000a80: 7d0a 7c00 6a02 7d0b 7c0b 7c05 7c00 6a03  }.|.j.}.|.|.|.j.
+00000a90: 7c0a 1700 1400 3700 7d0b 7404 a005 7c08  |.....7.}.t...|.
+00000aa0: 7c09 7c07 6603 7404 6a06 a102 7d0c 7407  |.|.f.t.j...}.t.
+00000ab0: 7c01 6404 8302 8f3b 7d0d 7c0d a008 7c0b  |.d....;}.|...|.
+00000ac0: a101 0100 7409 7c07 8301 4400 5d28 7d0e  ....t.|...D.](}.
+00000ad0: 7c0d a008 7c00 6a03 6405 a102 0100 7404  |...|.j.d.....t.
+00000ae0: a00a 7c0d a00b 7c0a a101 7404 6a06 a102  ..|...|...t.j...
+00000af0: 7d0f 7c0f a00c 7c09 7c08 6602 a101 7d0f  }.|...|.|.f...}.
+00000b00: 7404 a00d 7c0f a101 7c0c 6402 6402 8502  t...|...|.d.d...
+00000b10: 6402 6402 8502 7c0e 6603 3c00 713f 5700  d.d...|.f.<.q?W.
+00000b20: 6402 0400 0400 8303 0100 7c0c 5300 3100  d.........|.S.1.
+00000b30: 7373 7701 0100 0100 0100 5900 0100 7c0c  ssw.......Y...|.
+00000b40: 5300 2906 612c 0200 0052 6561 6473 2063  S.).a,...Reads c
+00000b50: 6875 6e6b 7320 6f66 2064 6174 6120 6672  hunks of data fr
+00000b60: 6f6d 2061 2066 726d 3620 6669 6c65 2e20  om a frm6 file. 
+00000b70: 436f 6d70 6174 6962 6c65 2077 6974 6820  Compatible with 
+00000b80: 4368 756e 6b65 6452 6561 6465 720a 0a20  ChunkedReader.. 
+00000b90: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00000ba0: 2020 2020 2020 2020 2066 6e20 2873 7472           fn (str
+00000bb0: 293a 2066 756c 6c79 2071 7561 6c69 6669  ): fully qualifi
+00000bc0: 6564 2066 696c 6520 6e61 6d65 0a20 2020  ed file name.   
+00000bd0: 2020 2020 2020 2020 2069 6d61 6765 5f72           image_r
+00000be0: 616e 6765 3a20 322d 7475 706c 6520 5b73  ange: 2-tuple [s
+00000bf0: 7461 7274 5f69 6478 2c20 656e 645f 6964  tart_idx, end_id
+00000c00: 785b 2064 6566 696e 696e 6720 7468 650a  x[ defining the.
+00000c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c20: 7261 6e67 6520 6f66 2066 7261 6d65 7320  range of frames 
+00000c30: 7468 6174 206f 7567 6874 2074 6f20 6265  that ought to be
+00000c40: 2072 6561 640a 2020 2020 2020 2020 2020   read.          
+00000c50: 2020 6b77 6172 6773 3a20 7468 6520 666f    kwargs: the fo
+00000c60: 6c6c 6f77 696e 6720 6164 6469 7469 6f6e  llowing addition
+00000c70: 616c 2070 6172 616d 6574 6572 7320 2a2a  al parameters **
+00000c80: 6d75 7374 2a2a 2062 6520 6769 7665 6e3a  must** be given:
+00000c90: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00000ca0: 2020 2a20 7069 7865 6c73 5f78 2028 696e    * pixels_x (in
+00000cb0: 7429 3a20 6e75 6d62 6572 206f 6620 7069  t): number of pi
+00000cc0: 7865 6c73 2061 6c6f 6e67 2078 2d61 7869  xels along x-axi
+00000cd0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00000ce0: 2020 2a20 7069 7865 6c73 5f79 2028 696e    * pixels_y (in
+00000cf0: 7429 3a20 6e75 6d62 6572 206f 6620 7069  t): number of pi
+00000d00: 7865 6c73 2061 6c6f 6e67 2079 2d61 7869  xels along y-axi
+00000d10: 730a 0a20 2020 2020 2020 2052 6574 7572  s..        Retur
+00000d20: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00000d30: 6e75 6d70 792e 6e64 6172 7261 793a 2044  numpy.ndarray: D
+00000d40: 6174 6120 7265 6164 2066 726f 6d20 7468  ata read from th
+00000d50: 6520 6672 6d36 2066 696c 6520 2864 7479  e frm6 file (dty
+00000d60: 7065 3a20 7569 6e74 3136 290a 0a20 2020  pe: uint16)..   
+00000d70: 2020 2020 20da 0870 6978 656c 735f 784e       ..pixels_xN
+00000d80: da08 7069 7865 6c73 5f79 7213 0000 0072  ..pixels_yr....r
+00000d90: 1400 0000 290e da03 6765 7472 1200 0000  ....)...getr....
+00000da0: 7226 0000 0072 2900 0000 da02 6e70 da05  r&...r).....np..
+00000db0: 7a65 726f 735a 0675 696e 7431 3672 2400  zerosZ.uint16r$.
+00000dc0: 0000 7225 0000 0072 2700 0000 5a0a 6672  ..r%...r'...Z.fr
+00000dd0: 6f6d 6275 6666 6572 7228 0000 00da 0772  ombufferr(.....r
+00000de0: 6573 6861 7065 da09 7472 616e 7370 6f73  eshape..transpos
+00000df0: 6529 1072 2d00 0000 722e 0000 00da 0b69  e).r-...r......i
+00000e00: 6d61 6765 5f72 616e 6765 da04 6172 6773  mage_range..args
+00000e10: da06 6b77 6172 6773 5a08 7374 6172 7449  ..kwargsZ.startI
+00000e20: 6478 5a06 656e 6449 6478 722f 0000 00da  dxZ.endIdxr/....
+00000e30: 0770 6978 656c 7358 da07 7069 7865 6c73  .pixelsX..pixels
+00000e40: 5972 3000 0000 da06 6f66 6673 6574 da05  Yr0.....offset..
+00000e50: 6368 756e 6b72 3100 0000 7232 0000 005a  chunkr1...r2...Z
+00000e60: 0c63 7572 7265 6e74 4672 616d 6572 0800  .currentFramer..
+00000e70: 0000 7208 0000 0072 0a00 0000 da08 7265  ..r....r......re
+00000e80: 6164 4461 7461 bd00 0000 732e 0000 0008  adData....s.....
+00000e90: 1308 010c 030c 010c 0506 0312 0114 080c  ................
+00000ea0: 060a 030c 0104 0204 0102 0104 fe14 060e  ................
+00000eb0: 061e 0602 ec0a fc04 2010 e004 207a 1446  ........ ... z.F
+00000ec0: 726d 7336 5265 6164 6572 2e72 6561 6444  rms6Reader.readD
+00000ed0: 6174 6163 0200 0000 0000 0000 0000 0000  atac............
+00000ee0: 0600 0000 0d00 0000 4300 0000 73b0 0000  ........C...s...
+00000ef0: 0074 007c 0164 0183 028f 497d 027c 02a0  .t.|.d....I}.|..
+00000f00: 017c 006a 02a1 017d 037c 006a 03a0 047c  .|.j...}.|.j...|
+00000f10: 03a1 017d 0474 0564 027c 0464 0319 0066  ...}.t.d.|.d...f
+00000f20: 0264 047c 0464 0519 0066 0264 067c 0464  .d.|.d...f.d.|.d
+00000f30: 0719 0066 0264 087c 0464 0919 0066 0264  ...f.d.|.d...f.d
+00000f40: 0a7c 0464 0b19 0066 0264 0c7c 0464 0d19  .|.d...f.d.|.d..
+00000f50: 0066 0264 0e7c 0464 0f19 00a0 0664 10a1  .f.d.|.d.....d..
+00000f60: 0166 0264 117c 0464 1219 0066 0264 137c  .f.d.|.d...f.d.|
+00000f70: 0464 1419 0066 0267 0983 017d 0557 0064  .d...f.g...}.W.d
+00000f80: 1504 0004 0083 0301 007c 0553 0031 0073  .........|.S.1.s
+00000f90: 5177 0101 0001 0001 0059 0001 007c 0553  Qw.......Y...|.S
+00000fa0: 0029 167a c452 6574 7572 6e73 2074 6865  .).z.Returns the
+00000fb0: 2066 696c 6520 6865 6164 6572 2061 7373   file header ass
+00000fc0: 6f63 6961 7465 6420 7769 7468 2061 2066  ociated with a f
+00000fd0: 726d 3620 6669 6c65 2e0a 0a20 2020 2020  rm6 file...     
+00000fe0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00000ff0: 2020 2020 2066 6e20 2873 7472 293a 2066       fn (str): f
+00001000: 756c 6c79 2071 7561 6c69 6669 6564 2066  ully qualified f
+00001010: 696c 6520 6e61 6d65 0a0a 2020 2020 2020  ile name..      
+00001020: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00001030: 2020 2020 2020 204f 7264 6572 6564 4469         OrderedDi
+00001040: 6374 3a20 436f 6e74 656e 7473 206f 6620  ct: Contents of 
+00001050: 7468 6520 6669 6c65 2068 6561 6465 720a  the file header.
+00001060: 0a20 2020 2020 2020 2072 1300 0000 5a0e  .        r....Z.
+00001070: 6669 6c65 4865 6164 6572 5369 7a65 7201  fileHeaderSizer.
+00001080: 0000 005a 0f66 7261 6d65 4865 6164 6572  ...Z.frameHeader
+00001090: 5369 7a65 7214 0000 005a 056e 4343 4473  Sizer....Z.nCCDs
+000010a0: 7215 0000 005a 086d 6178 5769 6474 6872  r....Z.maxWidthr
+000010b0: 1600 0000 7222 0000 0072 1700 0000 da07  ....r"...r......
+000010c0: 7665 7273 696f 6e72 1800 0000 5a09 6461  versionr....Z.da
+000010d0: 7461 5365 7449 6472 1900 0000 f301 0000  taSetIdr........
+000010e0: 0000 da05 7769 6474 6872 1a00 0000 721f  ....widthr....r.
+000010f0: 0000 0072 1b00 0000 4e29 0772 2400 0000  ...r....N).r$...
+00001100: 7228 0000 0072 2600 0000 da10 6669 6c65  r(...r&.....file
+00001110: 4865 6164 6572 5374 7275 6374 722b 0000  HeaderStructr+..
+00001120: 0072 0500 0000 da06 7273 7472 6970 2906  .r......rstrip).
+00001130: 722d 0000 0072 2e00 0000 7231 0000 005a  r-...r....r1...Z
+00001140: 0d66 696c 6548 6561 6465 7252 6177 5a0f  .fileHeaderRawZ.
+00001150: 6669 6c65 4865 6164 6572 4974 656d 735a  fileHeaderItemsZ
+00001160: 0e66 696c 6548 6561 6465 7244 6963 7472  .fileHeaderDictr
+00001170: 0800 0000 7208 0000 0072 0a00 0000 da0d  ....r....r......
+00001180: 6765 7446 696c 6548 6561 6465 720e 0100  getFileHeader...
+00001190: 0073 2600 0000 0c0b 0c02 0c02 0202 0a02  .s&.............
+000011a0: 0a01 0a01 0a01 0a01 0a01 1001 0a01 0a01  ................
+000011b0: 02f7 06ff 0afa 0413 10ed 0413 7a19 4672  ............z.Fr
+000011c0: 6d73 3652 6561 6465 722e 6765 7446 696c  ms6Reader.getFil
+000011d0: 6548 6561 6465 724e 6303 0000 0000 0000  eHeaderNc.......
+000011e0: 0000 0000 0009 0000 0005 0000 0043 0000  .............C..
+000011f0: 0073 7800 0000 7c00 a000 7c01 a101 7d03  .sx...|...|...}.
+00001200: 7401 7c03 6401 1900 8301 7d04 7401 7c03  t.|.d.....}.t.|.
+00001210: 6402 1900 8301 7d05 7c00 6a02 7d06 7c06  d.....}.|.j.}.|.
+00001220: 7c00 a003 7c04 7c05 a102 3700 7d06 7404  |...|.|...7.}.t.
+00001230: 6a05 a006 7c01 a101 7d07 7c07 7c00 6a07  j...|...}.|.|.j.
+00001240: 1800 7c06 1b00 7d08 7408 7c08 8301 a009  ..|...}.t.|.....
+00001250: a100 7333 740a 6403 8301 8201 7401 7c08  ..s3t.d.....t.|.
+00001260: 8301 7d08 7c04 7c05 7c08 6603 5300 2904  ..}.|.|.|.f.S.).
+00001270: 614d 0100 0052 6574 7572 6e73 2074 6865  aM...Returns the
+00001280: 2073 697a 6520 6f66 2074 6865 2073 6574   size of the set
+00001290: 206f 6620 696d 6167 6520 696e 2074 6865   of image in the
+000012a0: 2067 6976 656e 2066 696c 652c 0a20 2020   given file,.   
+000012b0: 2020 2020 206e 756d 7079 2e73 6861 7065       numpy.shape
+000012c0: 2073 7479 6c65 2e0a 0a20 2020 2020 2020   style...       
+000012d0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+000012e0: 2020 2066 6e20 2873 7472 293a 2066 756c     fn (str): ful
+000012f0: 6c79 2071 7561 6c69 6669 6564 2066 696c  ly qualified fil
+00001300: 6520 6e61 6d65 0a20 2020 2020 2020 2020  e name.         
+00001310: 2020 2070 6174 6820 2873 7472 203d 2027     path (str = '
+00001320: 2f73 7472 6561 6d27 2c20 6f70 7469 6f6e  /stream', option
+00001330: 616c 293a 2055 6e75 7365 642c 2061 6464  al): Unused, add
+00001340: 6564 2066 6f72 2063 6f6d 7061 7469 6269  ed for compatibi
+00001350: 6c69 7479 0a0a 2020 2020 2020 2020 5265  lity..        Re
+00001360: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00001370: 2020 2033 2d74 7570 6c65 3a20 4865 6967     3-tuple: Heig
+00001380: 6874 2026 2077 6964 7468 206f 6620 7468  ht & width of th
+00001390: 6520 6672 616d 6520 616e 6420 6e75 6d62  e frame and numb
+000013a0: 6572 206f 6620 6672 616d 6573 2069 6e20  er of frames in 
+000013b0: 7468 6520 6669 6c65 0a0a 2020 2020 2020  the file..      
+000013c0: 2020 7245 0000 0072 1f00 0000 7a2f 7265    rE...r....z/re
+000013d0: 6164 5f66 7261 6d65 7320 2d2d 204e 756d  ad_frames -- Num
+000013e0: 6265 7220 6f66 2066 7261 6d65 7320 6973  ber of frames is
+000013f0: 206e 6f74 2069 6e74 6567 6572 2129 0b72   not integer!).r
+00001400: 4800 0000 da03 696e 7472 2900 0000 7212  H.....intr)...r.
+00001410: 0000 00da 026f 73da 0470 6174 68da 0767  .....os..path..g
+00001420: 6574 7369 7a65 7226 0000 00da 0566 6c6f  etsizer&.....flo
+00001430: 6174 da0a 6973 5f69 6e74 6567 6572 da07  at..is_integer..
+00001440: 5761 726e 696e 6729 0972 2d00 0000 722e  Warning).r-...r.
+00001450: 0000 0072 4b00 0000 5a0a 6669 6c65 4865  ...rK...Z.fileHe
+00001460: 6164 6572 7210 0000 0072 1100 0000 5a19  aderr....r....Z.
+00001470: 6672 616d 6541 6e64 4865 6164 6572 5369  frameAndHeaderSi
+00001480: 7a65 496e 4279 7465 735a 0866 696c 6553  zeInBytesZ.fileS
+00001490: 697a 6572 2f00 0000 7208 0000 0072 0800  izer/...r....r..
+000014a0: 0000 720a 0000 0072 2300 0000 2e01 0000  ..r....r#.......
+000014b0: 731a 0000 000a 0e0c 020c 0106 0210 010c  s...............
+000014c0: 0208 0302 0104 fe0c 0408 0108 020a 027a  ...............z
+000014d0: 1846 726d 7336 5265 6164 6572 2e67 6574  .Frms6Reader.get
+000014e0: 4461 7461 5368 6170 6572 0700 0000 2915  DataShaper....).
+000014f0: da08 5f5f 6e61 6d65 5f5f da0a 5f5f 6d6f  ..__name__..__mo
+00001500: 6475 6c65 5f5f da0c 5f5f 7175 616c 6e61  dule__..__qualna
+00001510: 6d65 5f5f da07 5f5f 646f 635f 5f5a 1066  me__..__doc__Z.f
+00001520: 696c 6548 6561 6465 7246 6f72 6d61 7472  ileHeaderFormatr
+00001530: 0d00 0000 720e 0000 0072 2600 0000 da06  ....r....r&.....
+00001540: 5374 7275 6374 7246 0000 005a 1166 7261  StructrF...Z.fra
+00001550: 6d65 4865 6164 6572 466f 726d 6174 7229  meHeaderFormatr)
+00001560: 0000 0072 2a00 0000 720b 0000 00da 0c73  ...r*...r......s
+00001570: 7461 7469 636d 6574 686f 6472 1200 0000  taticmethodr....
+00001580: da0b 636c 6173 736d 6574 686f 6472 3300  ..classmethodr3.
+00001590: 0000 7242 0000 0072 4800 0000 7223 0000  ..rB...rH...r#..
+000015a0: 0072 0800 0000 7208 0000 0072 0800 0000  .r....r....r....
+000015b0: 720a 0000 0072 0600 0000 0f00 0000 732a  r....r........s*
+000015c0: 0000 0008 0004 0102 0602 ff0a 0f0a 0102  ................
+000015d0: 0502 ff0a 260a 0108 0202 030a 0102 0e0a  ....&...........
+000015e0: 0102 580a 0102 500a 0102 1f10 0172 0600  ..X...P......r..
+000015f0: 0000 fa07 2f73 7472 6561 6d63 0200 0000  ..../streamc....
+00001600: 0000 0000 0000 0000 0d00 0000 0700 0000  ................
+00001610: 4b00 0000 73a6 0100 007c 02a0 0064 0164  K...s....|...d.d
+00001620: 02a1 027d 037c 02a0 0064 0364 02a1 027d  ...}.|...d.d...}
+00001630: 047c 02a0 0064 0464 02a1 027d 057c 02a0  .|...d.d...}.|..
+00001640: 0064 0564 02a1 027d 067c 02a0 0064 0664  .d.d...}.|...d.d
+00001650: 02a1 027d 077c 02a0 0064 0764 08a1 027d  ...}.|...d.d...}
+00001660: 0864 027d 097c 00a0 0164 09a1 0164 0a6b  .d.}.|...d...d.k
+00001670: 0372 3d7c 00a0 0264 0964 0ba1 027d 0a74  .r=|...d.d...}.t
+00001680: 036a 047c 0a64 0c64 0d64 0e64 0f8d 047d  .j.|.d.d.d.d...}
+00001690: 096e 0674 03a0 047c 0064 0ca1 027d 0964  .n.t...|.d...}.d
+000016a0: 027d 0b7c 0364 026b 0272 4e7c 097c 0119  .}.|.d.k.rN|.|..
+000016b0: 007d 0b6e 297c 0873 647c 097c 0119 0064  .}.n)|.sd|.|...d
+000016c0: 0264 0285 0264 0264 0285 027c 0364 1019  .d...d.d...|.d..
+000016d0: 007c 0364 1119 0085 0266 0319 007d 0b6e  .|.d.....f...}.n
+000016e0: 137c 097c 0119 007c 0364 1019 007c 0364  .|.|...|.d...|.d
+000016f0: 1119 0085 0264 0264 0285 0264 0264 0285  .....d.d...d.d..
+00001700: 0266 0319 007d 0b7c 0872 9574 05a0 067c  .f...}.|.r.t...|
+00001710: 0ba1 017d 0b74 05a0 077c 0b64 12a1 027d  ...}.t...|.d...}
+00001720: 0b74 05a0 077c 0b64 12a1 027d 0b74 05a0  .t...|.d...}.t..
+00001730: 077c 0b64 11a1 027d 0b74 05a0 087c 0ba1  .|.d...}.t...|..
+00001740: 017d 0b64 027d 0c7c 0464 026b 0272 b07c  .}.d.}.|.d.k.r.|
+00001750: 0564 026b 0272 b074 05a0 097c 0b64 0264  .d.k.r.t...|.d.d
+00001760: 0285 0264 0264 0285 0264 0264 0285 0266  ...d.d...d.d...f
+00001770: 0319 00a1 017d 0c6e 1874 05a0 097c 0b7c  .....}.n.t...|.|
+00001780: 0464 1019 007c 0464 1119 0085 027c 0564  .d...|.d.....|.d
+00001790: 1019 007c 0564 1119 0085 0264 0264 0285  ...|.d.....d.d..
+000017a0: 0266 0319 00a1 017d 0c7c 09a0 0aa1 0001  .f.....}.|......
+000017b0: 0074 05a0 0b7c 0c74 056a 0ca1 0253 0029  .t...|.t.j...S.)
+000017c0: 1361 e003 0000 5265 6164 7320 6461 7461  .a....Reads data
+000017d0: 2066 726f 6d20 6120 6769 7665 6e20 6669   from a given fi
+000017e0: 6c65 2028 6661 6d69 6c79 2920 616e 6420  le (family) and 
+000017f0: 6f75 7470 7574 2072 656f 7264 6572 6564  output reordered
+00001800: 2069 6d61 6765 730a 2020 2020 696e 2073   images.    in s
+00001810: 7461 636b 730a 0a20 2020 2041 7267 733a  tacks..    Args:
+00001820: 0a20 2020 2020 2020 2066 696c 656e 616d  .        filenam
+00001830: 6520 2873 7472 293a 2074 6865 2066 696c  e (str): the fil
+00001840: 6520 7061 7468 2061 6e64 206e 616d 652e  e path and name.
+00001850: 2049 6620 7468 6520 6669 6c65 2069 7320   If the file is 
+00001860: 6163 7475 616c 6c79 2061 0a20 2020 2020  actually a.     
+00001870: 2020 2020 2020 2066 616d 696c 7920 6f66         family of
+00001880: 2066 696c 6573 206f 6e6c 7920 7468 6520   files only the 
+00001890: 6669 7273 7420 6669 6c65 2c20 692e 652e  first file, i.e.
+000018a0: 2074 6865 206f 6e65 2077 6974 6820 696e   the one with in
+000018b0: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+000018c0: 3030 3030 302e 6835 2073 686f 756c 6420  00000.h5 should 
+000018d0: 6265 2067 6976 656e 2e0a 2020 2020 2020  be given..      
+000018e0: 2020 7061 7468 2028 7374 7220 3d20 272f    path (str = '/
+000018f0: 7374 7265 616d 272c 206f 7074 696f 6e61  stream', optiona
+00001900: 6c29 3a20 7468 6520 7061 7468 2069 6e20  l): the path in 
+00001910: 7468 6520 6864 6635 2066 696c 6520 6174  the hdf5 file at
+00001920: 2077 6869 6368 2074 6865 2064 6174 6120   which the data 
+00001930: 6973 0a20 2020 2020 2020 2020 2020 206c  is.            l
+00001940: 6f63 6174 6564 2e0a 2020 2020 2020 2020  ocated..        
+00001950: 6b77 6172 6773 3a20 7468 6520 666f 6c6c  kwargs: the foll
+00001960: 6f77 696e 6720 6164 6469 7469 6f6e 616c  owing additional
+00001970: 2070 6172 616d 6574 6572 7320 6d61 7920   parameters may 
+00001980: 6265 2067 6976 656e 3a0a 0a20 2020 2020  be given:..     
+00001990: 2020 2020 2020 202a 2069 6d61 6765 5f72         * image_r
+000019a0: 616e 6765 2028 5b6c 6f77 2c20 6869 6768  ange ([low, high
+000019b0: 5d29 3a20 6120 7261 6e67 6520 6f66 2069  ]): a range of i
+000019c0: 6d61 6765 7320 746f 2062 6520 7265 6164  mages to be read
+000019d0: 0a20 2020 2020 2020 2020 2020 202a 2078  .            * x
+000019e0: 5f72 616e 6765 2028 5b6c 6f77 2c20 6869  _range ([low, hi
+000019f0: 6768 5d29 3a20 6120 7261 6e67 6520 6f66  gh]): a range of
+00001a00: 2070 6978 656c 7320 746f 2062 6520 7265   pixels to be re
+00001a10: 6164 0a20 2020 2020 2020 2020 2020 202a  ad.            *
+00001a20: 2079 5f72 616e 6765 2028 5b6c 6f77 2c20   y_range ([low, 
+00001a30: 6869 6768 5d29 3a20 6120 7261 6e67 6520  high]): a range 
+00001a40: 6f66 2070 6978 656c 7320 746f 2062 6520  of pixels to be 
+00001a50: 7265 6164 0a20 2020 2020 2020 2020 2020  read.           
+00001a60: 202a 2070 6978 656c 735f 7820 2869 6e74   * pixels_x (int
+00001a70: 293a 206e 756d 6265 7220 6f66 2070 6978  ): number of pix
+00001a80: 656c 7320 616c 6f6e 6720 782d 6178 6973  els along x-axis
+00001a90: 2c20 2a2a 636f 6d70 6174 6962 696c 6974  , **compatibilit
+00001aa0: 7920 6f6e 6c79 2a2a 2e0a 2020 2020 2020  y only**..      
+00001ab0: 2020 2020 2020 2a20 7069 7865 6c73 5f79        * pixels_y
+00001ac0: 2028 696e 7429 3a20 6e75 6d62 6572 206f   (int): number o
+00001ad0: 6620 7069 7865 6c73 2061 6c6f 6e67 2079  f pixels along y
+00001ae0: 2d61 7869 732c 202a 2a63 6f6d 7061 7469  -axis, **compati
+00001af0: 6269 6c69 7479 206f 6e6c 792a 2a2e 0a0a  bility only**...
+00001b00: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+00001b10: 2020 2020 2020 6e75 6d70 792e 6172 7261        numpy.arra
+00001b20: 793a 2061 2072 656f 7264 6572 6564 2061  y: a reordered a
+00001b30: 6e64 2069 6e76 6572 7465 6420 696d 6167  nd inverted imag
+00001b40: 6520 7769 7468 2072 616e 6b20 320a 0a20  e with rank 2.. 
+00001b50: 2020 204e 6f74 653a 0a20 2020 2020 2020     Note:.       
+00001b60: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
+00001b70: 7320 636f 6d70 6174 6962 6c65 2077 6974  s compatible wit
+00001b80: 6820 2078 6665 6c70 7963 616c 746f 6f6c  h  xfelpycaltool
+00001b90: 732e 4368 756e 6b65 6452 6561 6465 720a  s.ChunkedReader.
+00001ba0: 0a0a 2020 2020 723b 0000 004e 5a07 785f  ..    r;...NZ.x_
+00001bb0: 7261 6e67 655a 0779 5f72 616e 6765 7234  rangeZ.y_ranger4
+00001bc0: 0000 0072 3500 0000 da09 7369 6d75 6c61  ...r5.....simula
+00001bd0: 7465 6446 da05 3030 3030 30e9 ffff ffff  tedF..00000.....
+00001be0: fa04 2530 3564 da01 72da 0666 616d 696c  ..%05d..r..famil
+00001bf0: 79ec 0300 0000 0000 0000 1400 a902 da06  y...............
+00001c00: 6472 6976 6572 5a09 6d65 6d62 5f73 697a  driverZ.memb_siz
+00001c10: 6572 0100 0000 7214 0000 0072 1500 0000  er....r....r....
+00001c20: 290d 7236 0000 00da 0466 696e 64da 0772  ).r6.....find..r
+00001c30: 6570 6c61 6365 da04 6835 7079 da04 4669  eplace..h5py..Fi
+00001c40: 6c65 7237 0000 005a 0773 7175 6565 7a65  ler7...Z.squeeze
+00001c50: 5a08 726f 6c6c 6178 6973 5a11 6173 636f  Z.rollaxisZ.asco
+00001c60: 6e74 6967 756f 7573 6172 7261 79da 0561  ntiguousarray..a
+00001c70: 7272 6179 da05 636c 6f73 65da 0761 7361  rray..close..asa
+00001c80: 7272 6179 5a07 666c 6f61 7436 3429 0dda  rrayZ.float64)..
+00001c90: 0866 696c 656e 616d 6572 4b00 0000 723d  .filenamerK...r=
+00001ca0: 0000 005a 0a69 6d61 6765 5261 6e67 655a  ...Z.imageRangeZ
+00001cb0: 0b70 6978 656c 5852 616e 6765 5a0b 7069  .pixelXRangeZ.pi
+00001cc0: 7865 6c59 5261 6e67 6572 3e00 0000 723f  xelYRanger>...r?
+00001cd0: 0000 0072 5800 0000 da01 66da 0b66 696c  ...rX.....f..fil
+00001ce0: 656e 616d 6546 616d 5a03 6469 6eda 0164  enameFamZ.din..d
+00001cf0: 7208 0000 0072 0800 0000 720a 0000 0072  r....r....r....r
+00001d00: 4200 0000 5201 0000 7342 0000 000c 1c0c  B...R...sB......
+00001d10: 010c 010c 010c 010c 0104 020e 010c 0104  ................
+00001d20: 0208 0108 ff0c 0404 0208 010a 0104 0228  ...............(
+00001d30: 0126 0204 020a 010c 010c 010c 010a 0204  .&..............
+00001d40: 0210 0122 0104 0228 0104 ff08 030e 0172  ..."...(.......r
+00001d50: 4200 0000 6302 0000 0000 0000 0000 0000  B...c...........
+00001d60: 0004 0000 0006 0000 0043 0000 0073 4800  .........C...sH.
+00001d70: 0000 6401 7d02 7c00 a000 6402 a101 6403  ..d.}.|...d...d.
+00001d80: 6b03 7219 7c00 a001 6402 6404 a102 7d03  k.r.|...d.d...}.
+00001d90: 7402 6a03 7c03 6405 6406 6407 6408 8d04  t.j.|.d.d.d.d...
+00001da0: 7d02 6e06 7402 a003 7c00 6405 a102 7d02  }.n.t...|.d...}.
+00001db0: 7c02 7c01 1900 6a04 5300 2909 616c 0100  |.|...j.S.).al..
+00001dc0: 0052 6574 7572 6e73 2074 6865 206e 756d  .Returns the num
+00001dd0: 6265 7220 6f66 2069 6d61 6765 2069 6e20  ber of image in 
+00001de0: 6120 6769 7665 6e20 6669 6c65 2028 6661  a given file (fa
+00001df0: 6d69 6c79 290a 0a20 2020 2041 7267 733a  mily)..    Args:
+00001e00: 0a20 2020 2020 2020 2066 696c 656e 616d  .        filenam
+00001e10: 6520 2873 7472 293a 2074 6865 2066 696c  e (str): the fil
+00001e20: 6520 7061 7468 2061 6e64 206e 616d 652e  e path and name.
+00001e30: 2049 6620 7468 6520 6669 6c65 2069 7320   If the file is 
+00001e40: 6163 7475 616c 6c79 2061 2066 616d 696c  actually a famil
+00001e50: 790a 2020 2020 2020 2020 2020 2020 6f66  y.            of
+00001e60: 2066 696c 6573 206f 6e6c 7920 7468 6520   files only the 
+00001e70: 6669 7273 7420 6669 6c65 2c20 692e 652e  first file, i.e.
+00001e80: 2074 6865 206f 6e65 2077 6974 6820 696e   the one with in
+00001e90: 6465 7820 3030 3030 302e 6835 0a20 2020  dex 00000.h5.   
+00001ea0: 2020 2020 2020 2020 2073 686f 756c 6420           should 
+00001eb0: 6265 2067 6976 656e 2e0a 2020 2020 2020  be given..      
+00001ec0: 2020 7061 7468 2028 7374 7220 3d20 272f    path (str = '/
+00001ed0: 7374 7265 616d 272c 206f 7074 696f 6e61  stream', optiona
+00001ee0: 6c29 3a20 7468 6520 7061 7468 2069 6e20  l): the path in 
+00001ef0: 7468 6520 6864 6635 2066 696c 6520 6174  the hdf5 file at
+00001f00: 2077 6869 6368 0a20 2020 2020 2020 2020   which.         
+00001f10: 2020 2074 6865 2064 6174 6120 6973 206c     the data is l
+00001f20: 6f63 6174 6564 2e0a 0a20 2020 204e 7259  ocated...    NrY
+00001f30: 0000 0072 5a00 0000 725b 0000 0072 5c00  ...rZ...r[...r\.
+00001f40: 0000 725d 0000 0072 5e00 0000 725f 0000  ..r]...r^...r_..
+00001f50: 0029 0572 6100 0000 7262 0000 0072 6300  .).ra...rb...rc.
+00001f60: 0000 7264 0000 00da 0573 6861 7065 2904  ..rd.....shape).
+00001f70: 7268 0000 0072 4b00 0000 7269 0000 0072  rh...rK...ri...r
+00001f80: 6a00 0000 7208 0000 0072 0800 0000 720a  j...r....r....r.
+00001f90: 0000 00da 0b67 6574 4461 7461 5369 7a65  .....getDataSize
+00001fa0: 9b01 0000 7310 0000 0004 0c0e 010c 0104  ....s...........
+00001fb0: 0208 0108 ff0c 040a 0272 6d00 0000 6301  .........rm...c.
+00001fc0: 0000 0000 0000 0000 0000 0012 0000 0007  ................
+00001fd0: 0000 0043 0000 0073 2c02 0000 7400 a001  ...C...s,...t...
+00001fe0: a100 7d01 7400 a002 7c00 a101 0100 7403  ..}.t...|.....t.
+00001ff0: 6a04 a005 a100 7d02 6401 7d03 7406 a006  j.....}.d.}.t...
+00002000: 6402 a101 4400 5d06 7d04 7c03 6403 3700  d...D.].}.|.d.7.
+00002010: 7d03 7115 7407 6a08 7c03 6404 6602 7409  }.q.t.j.|.d.f.t.
+00002020: 6405 8d02 7d05 7407 6a08 7c03 740a 6405  d...}.t.j.|.t.d.
+00002030: 8d02 7d06 6401 7d07 7406 a006 6402 a101  ..}.d.}.t...d...
+00002040: 4400 5d28 7d04 7c00 7c04 1700 7d08 7407  D.](}.|.|...}.t.
+00002050: 6a0b 7c02 a00c 7c08 a101 7409 6405 8d02  j.|...|...t.d...
+00002060: 7d09 7c09 7c05 7c07 6401 6406 8502 6602  }.|.|.|.d.d...f.
+00002070: 3c00 7c08 6407 1900 7c05 7c07 6408 6602  <.|.d...|.|.d.f.
+00002080: 3c00 7c08 7c06 7c07 3c00 7c07 6403 3700  <.|.|.|.<.|.d.7.
+00002090: 7d07 7133 7c05 7c05 6400 6400 8502 6408  }.q3|.|.d.d...d.
+000020a0: 6602 1900 6401 6b02 6401 6406 8502 6602  f...d.k.d.d...f.
+000020b0: 1900 6401 1900 7d0a 7407 a00d 7c0a a101  ..d...}.t...|...
+000020c0: 7d0b 7407 a00e 7c05 6400 6400 8502 6409  }.t...|.d.d...d.
+000020d0: 6602 1900 a101 7407 a00f 7c05 6400 6400  f.....t...|.d.d.
+000020e0: 8502 6409 6602 1900 a101 1800 a010 7409  ..d.f.........t.
+000020f0: a101 7c0b 6408 3c00 7407 a008 7c0b a101  ..|.d.<.t...|...
+00002100: 7d0c 7407 6a11 7c05 7c05 6400 6400 8502  }.t.j.|.|.d.d...
+00002110: 6408 6602 1900 6401 6b03 6401 6406 8502  d.f...d.k.d.d...
+00002120: 6602 1900 6401 640a 8d02 a010 7409 a101  f...d.d.....t...
+00002130: 7d0d 7407 a012 7c03 a101 4400 5d54 7d07  }.t...|...D.]T}.
+00002140: 7c05 7c07 6408 6602 1900 6401 6b02 72ce  |.|.d.f...d.k.r.
+00002150: 7c02 6a13 7c06 7c07 1900 6401 7c0a 6408  |.j.|.|...d.|.d.
+00002160: 1900 6602 7c0a 6401 1900 7c0a 6403 1900  ..f.|.d...|.d...
+00002170: 640b 8d04 7d0e 71b0 7c05 7c07 6408 6602  d...}.q.|.|.d.f.
+00002180: 1900 7d0f 7409 7c0f 6403 1800 7c0d 6408  ..}.t.|.d...|.d.
+00002190: 1900 1400 8301 7d10 7409 7c0f 7c0d 6408  ......}.t.|.|.d.
+000021a0: 1900 1400 8301 7d11 7c02 6a13 7c06 7c07  ......}.|.j.|.|.
+000021b0: 1900 6401 7c0d 6408 1900 6602 7c0d 6401  ..d.|.d...f.|.d.
+000021c0: 1900 7c0d 6403 1900 640b 8d04 7c0c 6400  ..|.d...d...|.d.
+000021d0: 6400 8502 6400 6400 8502 7c10 7c11 8502  d...d.d...|.|...
+000021e0: 6603 3c00 71b0 7400 a002 7c01 a101 0100  f.<.q.t...|.....
+000021f0: 7c0c a010 7407 6a14 a101 7c0e a010 7407  |...t.j...|...t.
+00002200: 6a14 a101 6602 5300 290c 4e72 0100 0000  j...f.S.).Nr....
+00002210: fa07 2a2e 6672 6d73 3672 1400 0000 7217  ..*.frms6r....r.
+00002220: 0000 00a9 015a 0564 7479 7065 7216 0000  .....Z.dtyper...
+00002230: 00e9 f9ff ffff 725a 0000 00e9 feff ffff  ......rZ........
+00002240: a901 5a04 6178 6973 a903 723b 0000 0072  ..Z.axis..r;...r
+00002250: 3400 0000 7235 0000 0029 1572 4a00 0000  4...r5...).rJ...
+00002260: da06 6765 7463 7764 da05 6368 6469 72da  ..getcwd..chdir.
+00002270: 0273 74da 0475 7469 6c72 0600 0000 da04  .st..utilr......
+00002280: 676c 6f62 7237 0000 0072 3800 0000 7249  globr7...r8...rI
+00002290: 0000 00da 066f 626a 6563 7472 6700 0000  .....objectrg...
+000022a0: 7223 0000 00da 0463 6f70 79da 0373 756d  r#.....copy..sum
+000022b0: da04 616d 696e da06 6173 7479 7065 da04  ..amin..astype..
+000022c0: 6d65 616e da06 6172 616e 6765 7242 0000  mean..arangerB..
+000022d0: 00da 0766 6c6f 6174 3332 2912 da08 6461  ...float32)...da
+000022e0: 7461 5f64 6972 da0b 6375 7272 656e 745f  ta_dir..current_
+000022f0: 6469 72da 0a64 6174 615f 636c 6173 73da  dir..data_class.
+00002300: 0974 6f74 5f66 696c 6573 da04 6669 6c65  .tot_files..file
+00002310: da09 6669 6c65 7369 7a65 73da 0966 696c  ..filesizes..fil
+00002320: 656e 616d 6573 da02 6969 da05 666e 616d  enames..ii..fnam
+00002330: 65da 0664 7368 6170 65da 0a64 7265 665f  e..dshape..dref_
+00002340: 7368 6170 65da 0a64 6174 615f 7368 6170  shape..data_shap
+00002350: 65da 0764 6174 615f 3344 da0a 6472 6177  e..data_3D..draw
+00002360: 5f73 6861 7065 da08 6461 726b 5f72 6566  _shape..dark_ref
+00002370: 5a09 6672 6d73 365f 6e75 6d5a 0a73 7461  Z.frms6_numZ.sta
+00002380: 7274 5f66 696c 6c5a 0973 746f 705f 6669  rt_fillZ.stop_fi
+00002390: 6c6c 7208 0000 0072 0800 0000 720a 0000  llr....r....r...
+000023a0: 00da 0c67 6574 5f64 6174 615f 7265 66b4  ...get_data_ref.
+000023b0: 0100 0073 5000 0000 0801 0a01 0a01 0401  ...sP...........
+000023c0: 0e01 0a01 1201 0e01 0402 0e01 0801 1401  ................
+000023d0: 1001 1001 0801 0a01 2402 0a01 3601 0a01  ........$...6...
+000023e0: 3001 0e02 1001 0401 0601 0a01 0601 0601  0...............
+000023f0: 08fc 0c07 1401 1001 0401 0601 0a01 0601  ................
+00002400: 0601 1efc 0a06 1801 7290 0000 0046 6303  ........r....Fc.
+00002410: 0000 0000 0000 0000 0000 0013 0000 0006  ................
+00002420: 0000 0043 0000 0073 3601 0000 7400 a001  ...C...s6...t...
+00002430: a100 7d03 7c00 6a02 7d04 7403 7404 a005  ..}.|.j.}.t.t...
+00002440: 7c04 6401 6402 8502 1900 a101 7404 a005  |.d.d.......t...
+00002450: 6403 a101 1400 a006 7407 a101 8301 7d05  d.......t.....}.
+00002460: 7407 7c04 6404 1900 6405 1300 8301 7d06  t.|.d...d.....}.
+00002470: 7408 6a09 7c00 6406 6407 8d02 7d07 7c07  t.j.|.d.d...}.|.
+00002480: 6a02 7d04 7404 6a0a 7c01 a006 7404 6a0b  j.}.t.j.|...t.j.
+00002490: a101 6404 6408 8d02 7d08 7408 a00c 7c07  ..d.d...}.t...|.
+000024a0: 6409 a102 7d09 7c09 7c08 1800 7d0a 7408  d...}.|.|...}.t.
+000024b0: a00c 7c0a 640a a102 7d0b 7c0b 6401 7c05  ..|.d...}.|.d.|.
+000024c0: 6401 1900 8502 6400 6400 8502 6400 6400  d.....d.d...d.d.
+000024d0: 8502 6603 1900 7d0c 7c0b 7c05 6401 1900  ..f...}.|.|.d...
+000024e0: 7c04 6401 1900 8502 6400 6400 8502 6400  |.d.....d.d...d.
+000024f0: 6400 8502 6603 1900 7d0d 7c0c 6400 6400  d...f...}.|.d.d.
+00002500: 6404 8503 6400 6400 6404 8503 6400 6400  d...d.d.d...d.d.
+00002510: 8502 6603 1900 7d0e 7408 6a0d 7c0d 7c0e  ..f...}.t.j.|.|.
+00002520: 6702 640b 6408 8d02 7d0f 7c05 6401 1900  g.d.d...}.|.d...
+00002530: 7c05 640b 1900 7c06 7c06 6604 7d10 7408  |.d...|.|.f.}.t.
+00002540: a00e 7c0f 7c10 a102 7d11 7c02 7293 7c11  ..|.|...}.|.r.|.
+00002550: 5300 7c11 6a0f 7c03 640c 8d01 7d12 7c12  S.|.j.|.d...}.|.
+00002560: 5300 290d 4e72 0100 0000 7215 0000 00a9  S.).Nr....r.....
+00002570: 02e7 0000 0000 0000 e03f 7215 0000 0072  .........?r....r
+00002580: 5a00 0000 7292 0000 0029 0372 5a00 0000  Z...r....).rZ...
+00002590: 725a 0000 00da 0461 7574 6f29 01da 0663  rZ.....auto)...c
+000025a0: 6875 6e6b 7372 7200 0000 a903 7215 0000  hunksrr.....r...
+000025b0: 0072 0100 0000 7214 0000 00a9 0372 1400  .r....r......r..
+000025c0: 0000 7215 0000 0072 0100 0000 7214 0000  ..r....r....r...
 000025d0: 0029 015a 0b6e 756d 5f77 6f72 6b65 7273  .).Z.num_workers
 000025e0: 2910 da0f 6d75 6c74 6970 726f 6365 7373  )...multiprocess
-000025f0: 696e 67da 0963 7075 5f63 6f75 6e74 726b  ing..cpu_countrk
-00002600: 0000 00da 0574 7570 6c65 7236 0000 0072  .....tupler6...r
-00002610: 6600 0000 727c 0000 0072 4800 0000 da02  f...r|...rH.....
-00002620: 6461 5a0a 6672 6f6d 5f61 7272 6179 727d  daZ.from_arrayr}
-00002630: 0000 0072 4c00 0000 7239 0000 00da 0b63  ...rL...r9.....c
-00002640: 6f6e 6361 7465 6e61 7465 7238 0000 00da  oncatenater8....
-00002650: 0763 6f6d 7075 7465 2913 728c 0000 0072  .compute).r....r
-00002660: 8e00 0000 5a0b 7265 7475 726e 5f64 6173  ....Z.return_das
-00002670: 6b5a 0a63 6f72 655f 636f 756e 7472 8b00  kZ.core_countr..
+000025f0: 696e 67da 0963 7075 5f63 6f75 6e74 726c  ing..cpu_countrl
+00002600: 0000 00da 0574 7570 6c65 7237 0000 0072  .....tupler7...r
+00002610: 6700 0000 727d 0000 0072 4900 0000 da02  g...r}...rI.....
+00002620: 6461 5a0a 6672 6f6d 5f61 7272 6179 727e  daZ.from_arrayr~
+00002630: 0000 0072 4d00 0000 723a 0000 00da 0b63  ...rM...r:.....c
+00002640: 6f6e 6361 7465 6e61 7465 7239 0000 00da  oncatenater9....
+00002650: 0763 6f6d 7075 7465 2913 728d 0000 0072  .compute).r....r
+00002660: 8f00 0000 5a0b 7265 7475 726e 5f64 6173  ....Z.return_das
+00002670: 6b5a 0a63 6f72 655f 636f 756e 7472 8c00  kZ.core_countr..
 00002680: 0000 da09 636f 6e5f 7368 6170 65da 0578  ....con_shape..x
 00002690: 7661 6c73 da0b 6461 7461 3364 5f64 6173  vals..data3d_das
 000026a0: 6bda 0d6d 6561 6e5f 6461 726b 5f72 6566  k..mean_dark_ref
 000026b0: da03 6433 72da 0364 3373 da08 6433 445f  ..d3r..d3s..d3D_
 000026c0: 6472 6566 da08 746f 705f 7061 7274 da08  dref..top_part..
 000026d0: 626f 745f 7061 7274 da0b 746f 705f 7061  bot_part..top_pa
 000026e0: 7274 5f72 73da 0f64 6174 6133 645f 6172  rt_rs..data3d_ar
 000026f0: 7261 6e67 6564 da07 7368 6170 6534 64da  ranged..shape4d.
 00002700: 0b64 6174 6134 645f 6461 736b da06 6461  .data4d_dask..da
-00002710: 7461 3444 7207 0000 0072 0700 0000 7209  ta4Dr....r....r.
+00002710: 7461 3444 7208 0000 0072 0800 0000 720a  ta4Dr....r....r.
 00002720: 0000 00da 0e72 6563 6f6e 7374 7275 6374  .....reconstruct
-00002730: 5f69 6de3 0100 0073 2800 0000 0001 0801  _im....s(.......
-00002740: 0601 2601 1001 0e01 0601 1601 0c01 0801  ..&.............
-00002750: 0c01 1e01 2201 1e01 1201 1401 0c01 0601  ...."...........
-00002760: 0402 0c01 72aa 0000 0063 0200 0000 0000  ....r....c......
+00002730: 5f69 6de3 0100 0073 2800 0000 0801 0601  _im....s(.......
+00002740: 2601 1001 0e01 0601 1601 0c01 0801 0c01  &...............
+00002750: 1e01 2201 1e01 1201 1401 0c01 0401 0401  ..".............
+00002760: 0c02 0401 72ab 0000 0063 0200 0000 0000  ....r....c......
 00002770: 0000 0000 0000 0600 0000 0700 0000 4300  ..............C.
 00002780: 0000 734e 0000 0074 00a0 017c 0074 00a0  ..sN...t...|.t..
 00002790: 027c 006a 0364 01a1 02a1 027d 0274 006a  .|.j.d.....}.t.j
 000027a0: 047c 01a0 0574 006a 06a1 0164 0264 038d  .|...t.j...d.d..
 000027b0: 027d 037c 027c 0318 007d 0474 00a0 017c  .}.|.|...}.t...|
 000027c0: 0474 00a0 027c 046a 0364 02a1 02a1 027d  .t...|.j.d.....}
-000027d0: 057c 0553 0029 044e 7213 0000 0072 5900  .|.S.).Nr....rY.
-000027e0: 0000 7271 0000 0029 0772 3600 0000 7238  ..rq...).r6...r8
-000027f0: 0000 005a 0472 6f6c 6c72 6b00 0000 727d  ...Z.rollrk...r}
-00002800: 0000 0072 7c00 0000 724c 0000 0029 065a  ...r|...rL...).Z
-00002810: 0664 6174 6133 4472 8e00 0000 72a0 0000  .data3Dr....r...
-00002820: 005a 056d 6472 6566 72a1 0000 005a 0864  .Z.mdrefr....Z.d
-00002830: 6174 615f 6669 6e72 0700 0000 7207 0000  ata_finr....r...
-00002840: 0072 0900 0000 da0f 7265 6d6f 7665 5f64  .r......remove_d
+000027d0: 057c 0553 0029 044e 7214 0000 0072 5a00  .|.S.).Nr....rZ.
+000027e0: 0000 7272 0000 0029 0772 3700 0000 7239  ..rr...).r7...r9
+000027f0: 0000 005a 0472 6f6c 6c72 6c00 0000 727e  ...Z.rollrl...r~
+00002800: 0000 0072 7d00 0000 724d 0000 0029 065a  ...r}...rM...).Z
+00002810: 0664 6174 6133 4472 8f00 0000 72a1 0000  .data3Dr....r...
+00002820: 005a 056d 6472 6566 72a2 0000 005a 0864  .Z.mdrefr....Z.d
+00002830: 6174 615f 6669 6e72 0800 0000 7208 0000  ata_finr....r...
+00002840: 0072 0a00 0000 da0f 7265 6d6f 7665 5f64  .r......remove_d
 00002850: 6172 6b5f 7265 66fb 0100 0073 0a00 0000  ark_ref....s....
-00002860: 0001 1601 1601 0801 1601 72ab 0000 0072  ..........r....r
-00002870: 1400 0000 6303 0000 0000 0000 0000 0000  ....c...........
+00002860: 1601 1601 0801 1601 0401 72ac 0000 0072  ..........r....r
+00002870: 1500 0000 6303 0000 0000 0000 0000 0000  ....c...........
 00002880: 0030 0000 000a 0000 0043 0000 0073 8805  .0.......C...s..
 00002890: 0000 7400 a001 a100 7d03 7400 a002 7c00  ..t.....}.t...|.
 000028a0: a101 0100 7403 6a04 a005 a100 7d04 6401  ....t.j.....}.d.
-000028b0: 7d05 7406 a006 6402 a101 4400 5d0c 7d06  }.t...d...D.].}.
-000028c0: 7c05 6403 3700 7d05 712a 7407 6a08 7c05  |.d.7.}.q*t.j.|.
+000028b0: 7d05 7406 a006 6402 a101 4400 5d06 7d06  }.t...d...D.].}.
+000028c0: 7c05 6403 3700 7d05 7115 7407 6a08 7c05  |.d.7.}.q.t.j.|.
 000028d0: 6404 6602 7409 6405 8d02 7d07 7407 6a08  d.f.t.d...}.t.j.
 000028e0: 7c05 740a 6405 8d02 7d08 6401 7d09 7406  |.t.d...}.d.}.t.
-000028f0: a006 6402 a101 4400 5d50 7d06 7c00 7c06  ..d...D.]P}.|.|.
+000028f0: a006 6402 a101 4400 5d28 7d06 7c00 7c06  ..d...D.](}.|.|.
 00002900: 1700 7d0a 7407 6a0b 7c04 a00c 7c0a a101  ..}.t.j.|...|...
 00002910: 7409 6405 8d02 7d0b 7c0b 7c07 7c09 6401  t.d...}.|.|.|.d.
 00002920: 6406 8502 6602 3c00 7c0a 6407 1900 7c07  d...f.<.|.d...|.
 00002930: 7c09 6408 6602 3c00 7c0a 7c08 7c09 3c00  |.d.f.<.|.|.|.<.
-00002940: 7c09 6403 3700 7d09 7166 7400 a002 7c03  |.d.7.}.qft...|.
-00002950: a101 0100 7c02 6401 6b02 72d6 7409 6403  ....|.d.k.r.t.d.
+00002940: 7c09 6403 3700 7d09 7133 7400 a002 7c03  |.d.7.}.q3t...|.
+00002950: a101 0100 7c02 6401 6b02 726b 7409 6403  ....|.d.k.rkt.d.
 00002960: 7c05 1700 8301 7d02 740d 6a0e 7c02 6409  |.....}.t.j.|.d.
 00002970: 8d01 7d0c 740d a00f 7c0c a101 7d0d 7407  ..}.t...|...}.t.
 00002980: 6a10 7c07 7c07 6400 6400 8502 6408 6602  j.|.|.d.d...d.f.
 00002990: 1900 6401 6b03 6401 6406 8502 6602 1900  ..d.k.d.d...f...
 000029a0: 6401 640a 8d02 a011 7409 a101 7d0e 7c07  d.d.....t...}.|.
 000029b0: 7c07 6400 6400 8502 6408 6602 1900 6401  |.d.d...d.f...d.
 000029c0: 6b02 6401 6406 8502 6602 1900 6401 1900  k.d.d...f...d...
@@ -678,23 +678,23 @@
 00002a50: 6408 6602 1900 6401 6b02 1900 6401 1900  d.f...d.k...d...
 00002a60: 7d09 7416 a017 7c04 6a18 a101 7c08 7c09  }.t...|.j...|.|.
 00002a70: 1900 6401 7c0f 6408 1900 6602 7c0f 6401  ..d.|.d...f.|.d.
 00002a80: 1900 7c0f 6403 1900 640c 8d04 7d13 7419  ..|.d...d...}.t.
 00002a90: a01a 7c13 7c07 7c09 6401 6406 8502 6602  ..|.|.|.d.d...f.
 00002aa0: 1900 7407 6a1b a103 7d14 7e09 7419 6a10  ..t.j...}.~.t.j.
 00002ab0: 7c14 6408 640a 8d02 7d15 7407 a015 6403  |.d.d...}.t...d.
-00002ac0: 7c05 a102 4400 5d88 7d16 7407 a015 7c05  |...D.].}.t...|.
+00002ac0: 7c05 a102 4400 5d44 7d16 7407 a015 7c05  |...D.]D}.t...|.
 00002ad0: a101 7c07 6400 6400 8502 6408 6602 1900  ..|.d.d...d.f...
 00002ae0: 7c16 6b02 1900 6401 1900 7d09 7416 a017  |.k...d...}.t...
 00002af0: 7c04 6a18 a101 7c08 7c09 1900 6401 7c0e  |.j...|.|...d.|.
 00002b00: 6408 1900 6602 7c0e 6401 1900 7c0e 6403  d...f.|.d...|.d.
 00002b10: 1900 640c 8d04 7d17 7419 a01a 7c17 7c07  ..d...}.t...|.|.
 00002b20: 7c09 6401 6406 8502 6602 1900 7407 6a1b  |.d.d...f...t.j.
 00002b30: a103 7d18 7c18 a01c 6408 6408 640d a103  ..}.|...d.d.d...
-00002b40: 7d18 7c12 a01d 7c18 a101 0100 9002 7134  }.|...|.......q4
+00002b40: 7d18 7c12 a01d 7c18 a101 0100 9001 711a  }.|...|.......q.
 00002b50: 7419 6a1e 7c12 6408 640a 8d02 7d19 7c19  t.j.|.d.d...}.|.
 00002b60: 6a1f 7d10 7420 7407 a00b 7c10 6401 640e  j.}.t t...|.d.d.
 00002b70: 8502 1900 a101 7407 a00b 640f a101 1400  ......t...d.....
 00002b80: a011 7409 a101 8301 7d1a 7409 7c10 6408  ..t.....}.t.|.d.
 00002b90: 1900 6410 1300 8301 7d1b 7419 a021 7c19  ..d.....}.t..!|.
 00002ba0: 6411 a102 7d1c 7c1c 7c15 1800 7d1d 7419  d...}.|.|...}.t.
 00002bb0: a021 7c1d 6412 a102 7d1e 7c1e 6401 7c1a  .!|.d...}.|.d.|.
@@ -705,111 +705,111 @@
 00002c00: 6408 8503 6400 6400 6408 8503 6400 6400  d...d.d.d...d.d.
 00002c10: 8502 6603 1900 7d21 7419 6a1e 7c20 7c21  ..f...}!t.j.| |!
 00002c20: 6702 6403 640a 8d02 7d22 7c1a 6401 1900  g.d.d...}"|.d...
 00002c30: 7c1a 6403 1900 7c1b 7c1b 6604 7d23 7419  |.d...|.|.f.}#t.
 00002c40: a022 7c22 7c23 a102 7d24 7409 7c1b 7c01  ."|"|#..}$t.|.|.
 00002c50: 1b00 640e 1300 8301 7d25 7409 7c1b 7c01  ..d.....}%t.|.|.
 00002c60: 1b00 8301 7d26 7407 a023 7407 a024 7c1b  ....}&t..#t..$|.
-00002c70: 7c01 a102 a011 7425 a101 a101 9005 7274  |.....t%......rt
+00002c70: 7c01 a102 a011 7425 a101 a101 9002 72ba  |.....t%......r.
 00002c80: 7407 a015 7c24 6a1f 640e 1900 a101 6400  t...|$j.d.....d.
 00002c90: 6400 7c01 8503 1900 7d27 7407 a015 7c24  d.|.....}'t...|$
 00002ca0: 6a1f 6406 1900 a101 6400 6400 7c01 8503  j.d.....d.d.|...
 00002cb0: 1900 7d28 7419 a022 7c24 6400 6400 8502  ..}(t.."|$d.d...
 00002cc0: 6400 6400 8502 7c27 6400 6400 8502 6604  d.d...|'d.d...f.
 00002cd0: 1900 7c1a 6401 1900 7c1a 6403 1900 7409  ..|.d...|.d...t.
 00002ce0: 7c1b 7c26 1400 8301 6603 a102 7d29 7407  |.|&....f...})t.
-00002cf0: a015 6403 7c01 a102 4400 5d48 7d2a 7c29  ..d.|...D.]H}*|)
+00002cf0: a015 6403 7c01 a102 4400 5d24 7d2a 7c29  ..d.|...D.]$}*|)
 00002d00: 7419 a022 7c24 6400 6400 8502 6400 6400  t.."|$d.d...d.d.
 00002d10: 8502 7c27 7c2a 1700 6400 6400 8502 6604  ..|'|*..d.d...f.
 00002d20: 1900 7c1a 6401 1900 7c1a 6403 1900 7409  ..|.d...|.d...t.
 00002d30: 7c1b 7c26 1400 8301 6603 a102 1700 7d29  |.|&....f.....})
-00002d40: 9004 7168 7419 a022 7c29 7c1a 6401 1900  ..qht.."|)|.d...
+00002d40: 9002 7134 7419 a022 7c29 7c1a 6401 1900  ..q4t.."|)|.d...
 00002d50: 7c1a 6403 1900 7c26 7c1b 6604 a102 7d2b  |.d...|&|.f...}+
 00002d60: 7419 a022 7c2b 6400 6400 8502 6400 6400  t.."|+d.d...d.d.
 00002d70: 8502 6400 6400 8502 7c28 6604 1900 7c1a  ..d.d...|(f...|.
 00002d80: 6401 1900 7c1a 6403 1900 7c25 6603 a102  d...|.d...|%f...
-00002d90: 7d2c 7407 a015 6403 7c01 a102 4400 5d40  },t...d.|...D.]@
+00002d90: 7d2c 7407 a015 6403 7c01 a102 4400 5d20  },t...d.|...D.] 
 00002da0: 7d2d 7c2c 7419 a022 7c2b 6400 6400 8502  }-|,t.."|+d.d...
 00002db0: 6400 6400 8502 6400 6400 8502 7c28 7c2d  d.d...d.d...|(|-
 00002dc0: 1700 6604 1900 7c1a 6401 1900 7c1a 6403  ..f...|.d...|.d.
-00002dd0: 1900 7c25 6603 a102 1700 7d2c 9005 710c  ..|%f.....},..q.
+00002dd0: 1900 7c25 6603 a102 1700 7d2c 9002 7186  ..|%f.....},..q.
 00002de0: 7419 a022 7c2c 7c1a 6401 1900 7c1a 6403  t.."|,|.d...|.d.
 00002df0: 1900 7c26 7c26 6604 a102 7d2e 7c2e a026  ..|&|&f...}.|..&
-00002e00: a100 7d2f 6e08 7c24 a026 a100 7d2f 7c0c  ..}/n.|$.&..}/|.
+00002e00: a100 7d2f 6e04 7c24 a026 a100 7d2f 7c0c  ..}/n.|$.&..}/|.
 00002e10: a027 a100 0100 7c2f 5300 2913 4e72 0100  .'....|/S.).Nr..
-00002e20: 0000 726d 0000 0072 1300 0000 7216 0000  ..rm...r....r...
-00002e30: 0072 6e00 0000 7215 0000 0072 6f00 0000  .rn...r....ro...
-00002e40: 7259 0000 0029 015a 096e 5f77 6f72 6b65  rY...).Z.n_worke
-00002e50: 7273 7271 0000 0072 7000 0000 7272 0000  rsrq...rp...rr..
-00002e60: 00e9 0001 0000 7214 0000 0072 9000 0000  ......r....r....
-00002e70: 7291 0000 0072 9400 0000 7295 0000 0029  r....r....r....)
-00002e80: 2872 4900 0000 7273 0000 0072 7400 0000  (rI...rs...rt...
-00002e90: 7275 0000 0072 7600 0000 7206 0000 0072  ru...rv...r....r
-00002ea0: 7700 0000 7236 0000 0072 3700 0000 7248  w...r6...r7...rH
-00002eb0: 0000 0072 7800 0000 7266 0000 0072 2200  ...rx...rf...r".
+00002e20: 0000 726e 0000 0072 1400 0000 7217 0000  ..rn...r....r...
+00002e30: 0072 6f00 0000 7216 0000 0072 7000 0000  .ro...r....rp...
+00002e40: 725a 0000 0029 015a 096e 5f77 6f72 6b65  rZ...).Z.n_worke
+00002e50: 7273 7272 0000 0072 7100 0000 7273 0000  rsrr...rq...rs..
+00002e60: 00e9 0001 0000 7215 0000 0072 9100 0000  ......r....r....
+00002e70: 7292 0000 0072 9500 0000 7296 0000 0029  r....r....r....)
+00002e80: 2872 4a00 0000 7274 0000 0072 7500 0000  (rJ...rt...ru...
+00002e90: 7276 0000 0072 7700 0000 7206 0000 0072  rv...rw...r....r
+00002ea0: 7800 0000 7237 0000 0072 3800 0000 7249  x...r7...r8...rI
+00002eb0: 0000 0072 7900 0000 7267 0000 0072 2300  ...ry...rg...r#.
 00002ec0: 0000 da02 6464 5a0c 4c6f 6361 6c43 6c75  ....ddZ.LocalClu
-00002ed0: 7374 6572 5a06 436c 6965 6e74 727d 0000  sterZ.Clientr}..
-00002ee0: 0072 7c00 0000 7279 0000 0072 7a00 0000  .r|...ry...rz...
-00002ef0: 727b 0000 0072 7e00 0000 da04 6461 736b  r{...r~.....dask
-00002f00: 5a07 6465 6c61 7965 6472 4100 0000 7299  Z.delayedrA...r.
+00002ed0: 7374 6572 5a06 436c 6965 6e74 727e 0000  sterZ.Clientr~..
+00002ee0: 0072 7d00 0000 727a 0000 0072 7b00 0000  .r}...rz...r{...
+00002ef0: 727c 0000 0072 7f00 0000 da04 6461 736b  r|...r......dask
+00002f00: 5a07 6465 6c61 7965 6472 4200 0000 729a  Z.delayedrB...r.
 00002f10: 0000 005a 0c66 726f 6d5f 6465 6c61 7965  ...Z.from_delaye
-00002f20: 6472 7f00 0000 5a07 7265 6368 756e 6b72  dr....Z.rechunkr
-00002f30: 2b00 0000 729a 0000 0072 6b00 0000 7298  +...r....rk...r.
-00002f40: 0000 0072 3900 0000 7238 0000 005a 0b6c  ...r9...r8...Z.l
+00002f20: 6472 8000 0000 5a07 7265 6368 756e 6b72  dr....Z.rechunkr
+00002f30: 2c00 0000 729b 0000 0072 6c00 0000 7299  ,...r....rl...r.
+00002f40: 0000 0072 3a00 0000 7239 0000 005a 0b6c  ...r:...r9...Z.l
 00002f50: 6f67 6963 616c 5f6e 6f74 da03 6d6f 64da  ogical_not..mod.
-00002f60: 0462 6f6f 6c72 9b00 0000 7265 0000 0029  .boolr....re...)
-00002f70: 3072 8000 0000 5a0a 6269 6e5f 6661 6374  0r....Z.bin_fact
-00002f80: 6f72 5a07 776f 726b 6572 7372 8100 0000  orZ.workersr....
-00002f90: 7282 0000 0072 8300 0000 7284 0000 0072  r....r....r....r
-00002fa0: 8500 0000 7286 0000 0072 8700 0000 7288  ....r....r....r.
-00002fb0: 0000 0072 8900 0000 5a07 636c 7573 7465  ...r....Z.cluste
-00002fc0: 72da 0663 6c69 656e 7472 8d00 0000 728a  r..clientr....r.
-00002fd0: 0000 0072 8b00 0000 5a10 696e 6469 7669  ...r....Z.indivi
+00002f60: 0462 6f6f 6c72 9c00 0000 7266 0000 0029  .boolr....rf...)
+00002f70: 3072 8100 0000 5a0a 6269 6e5f 6661 6374  0r....Z.bin_fact
+00002f80: 6f72 5a07 776f 726b 6572 7372 8200 0000  orZ.workersr....
+00002f90: 7283 0000 0072 8400 0000 7285 0000 0072  r....r....r....r
+00002fa0: 8600 0000 7287 0000 0072 8800 0000 7289  ....r....r....r.
+00002fb0: 0000 0072 8a00 0000 5a07 636c 7573 7465  ...r....Z.cluste
+00002fc0: 72da 0663 6c69 656e 7472 8e00 0000 728b  r..clientr....r.
+00002fd0: 0000 0072 8c00 0000 5a10 696e 6469 7669  ...r....Z.indivi
 00002fe0: 6475 616c 5f73 6861 7065 5a0d 6461 7461  dual_shapeZ.data
 00002ff0: 3364 5f62 6566 6f72 655a 0964 6172 6b5f  3d_beforeZ.dark_
 00003000: 7265 6164 5a09 6461 726b 5f64 6174 6172  readZ.dark_datar
-00003010: 9f00 0000 5a02 6a6a 5a09 7465 7374 5f72  ....Z.jjZ.test_r
-00003020: 6561 645a 0974 6573 745f 6461 7461 729e  eadZ.test_datar.
-00003030: 0000 0072 9c00 0000 729d 0000 0072 a000  ...r....r....r..
-00003040: 0000 72a1 0000 0072 a200 0000 72a3 0000  ..r....r....r...
-00003050: 0072 a400 0000 72a5 0000 0072 a600 0000  .r....r....r....
-00003060: 72a7 0000 0072 a800 0000 5a08 6269 6e5f  r....r....Z.bin_
+00003010: a000 0000 5a02 6a6a 5a09 7465 7374 5f72  ....Z.jjZ.test_r
+00003020: 6561 645a 0974 6573 745f 6461 7461 729f  eadZ.test_datar.
+00003030: 0000 0072 9d00 0000 729e 0000 0072 a100  ...r....r....r..
+00003040: 0000 72a2 0000 0072 a300 0000 72a4 0000  ..r....r....r...
+00003050: 0072 a500 0000 72a6 0000 0072 a700 0000  .r....r....r....
+00003060: 72a8 0000 0072 a900 0000 5a08 6269 6e5f  r....r....Z.bin_
 00003070: 6e75 6d73 5a09 7876 616c 735f 6269 6e5a  numsZ.xvals_binZ
 00003080: 0379 7962 5a03 7878 625a 0b64 6174 6133  .yybZ.xxbZ.data3
 00003090: 645f 6269 6e59 5a03 7962 665a 0b64 6174  d_binYZ.ybfZ.dat
 000030a0: 6134 645f 6269 6e59 5a0c 6461 7461 3364  a4d_binYZ.data3d
 000030b0: 5f62 696e 5958 5a03 7862 665a 0a64 6174  _binYXZ.xbfZ.dat
-000030c0: 6134 645f 6269 6e72 a900 0000 7207 0000  a4d_binr....r...
-000030d0: 0072 0700 0000 7209 0000 00da 1067 656e  .r....r......gen
+000030c0: 6134 645f 6269 6e72 aa00 0000 7208 0000  a4d_binr....r...
+000030d0: 0072 0800 0000 720a 0000 00da 1067 656e  .r....r......gen
 000030e0: 6572 6174 6534 445f 6672 6d73 3603 0200  erate4D_frms6...
-000030f0: 0073 bc00 0000 0001 0801 0a01 0a01 0402  .s..............
-00003100: 0e01 0a01 1201 0e02 0401 0e01 0801 1401  ................
-00003110: 1001 1001 0801 0a01 0a02 0801 0c02 0c01  ................
-00003120: 0a02 3001 2401 0a01 3601 0e01 0c01 1001  ..0.$...6.......
-00003130: 0402 2201 0a01 0601 0a01 0601 06fc 0606  ..".............
-00003140: 1c01 0201 0e02 1001 2201 0a01 0601 0a01  ........".......
-00003150: 0601 06fc 0606 1c01 0e01 0e02 0e02 0601  ................
-00003160: 2601 1002 0c01 0801 0c01 1e01 2201 1e01  &..........."...
-00003170: 1201 1401 0c02 1001 0c01 1a01 1a01 1a01  ................
-00003180: 0401 1a01 18fe 0404 1001 0601 1e01 18fe  ................
-00003190: 0a04 0401 14ff 0404 0401 2aff 0403 1001  ..........*.....
-000031a0: 0601 2eff 0a03 0401 14ff 0403 0a02 0801  ................
-000031b0: 0801 72b2 0000 0029 0172 5600 0000 2901  ..r....).rV...).
-000031c0: 7256 0000 0029 0146 2902 7214 0000 0072  rV...).F).r....r
-000031d0: 0100 0000 291e da0a 5f5f 6675 7475 7265  ....)...__future
-000031e0: 5f5f 7202 0000 0072 0300 0000 7204 0000  __r....r....r...
-000031f0: 0072 9600 0000 5a0a 6461 736b 2e61 7272  .r....Z.dask.arr
-00003200: 6179 7264 0000 0072 9900 0000 7249 0000  ayrd...r....rI..
-00003210: 0072 ae00 0000 5a10 6461 736b 2e64 6973  .r....Z.dask.dis
-00003220: 7472 6962 7574 6564 5a0b 6469 7374 7269  tributedZ.distri
-00003230: 6275 7465 6472 ad00 0000 720c 0000 005a  butedr....r....Z
-00003240: 056e 756d 7079 7236 0000 0072 6200 0000  .numpyr6...rb...
-00003250: da08 7374 656d 746f 6f6c 7275 0000 0072  ..stemtoolru...r
-00003260: 7700 0000 da0b 636f 6c6c 6563 7469 6f6e  w.....collection
-00003270: 7372 0500 0000 7278 0000 0072 0600 0000  sr....rx...r....
-00003280: 7241 0000 0072 6c00 0000 728f 0000 0072  rA...rl...r....r
-00003290: aa00 0000 72ab 0000 0072 b200 0000 7207  ....r....r....r.
-000032a0: 0000 0072 0700 0000 7207 0000 0072 0900  ...r....r....r..
-000032b0: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
-000032c0: 7328 0000 0014 0108 010c 0108 0108 010c  s(..............
-000032d0: 0108 0108 0108 0108 0108 010c 0310 7f00  ................
-000032e0: 7f00 450a 490a 1908 2f0a 1808 08         ..E.I.../....
+000030f0: 0073 bc00 0000 0801 0a01 0a01 0401 0e02  .s..............
+00003100: 0a01 1201 0e01 0402 0e01 0801 1401 1001  ................
+00003110: 1001 0801 0a01 0a01 0802 0c01 0c02 0a01  ................
+00003120: 3002 2401 0a01 3601 0e01 0c01 1001 0401  0.$...6.........
+00003130: 2202 0a01 0601 0a01 0601 0601 06fc 1c06  "...............
+00003140: 0201 0e01 1002 2201 0a01 0601 0a01 0601  ......".........
+00003150: 0601 06fc 1c06 0e01 0e01 0e02 0602 2601  ..............&.
+00003160: 1001 0c02 0801 0c01 1e01 2201 1e01 1201  ..........".....
+00003170: 1401 0c01 1002 0c01 1a01 1a01 1a01 0401  ................
+00003180: 1a01 1801 04fe 1004 0601 1e01 1801 0afe  ................
+00003190: 0404 1401 04ff 0404 2a01 04ff 1003 0601  ........*.......
+000031a0: 2e01 0aff 0403 1401 04ff 0a03 0802 0801  ................
+000031b0: 0401 72b3 0000 0029 0172 5700 0000 2901  ..r....).rW...).
+000031c0: 4629 0272 1500 0000 7201 0000 0029 1eda  F).r....r....)..
+000031d0: 0a5f 5f66 7574 7572 655f 5f72 0200 0000  .__future__r....
+000031e0: 7203 0000 0072 0400 0000 7297 0000 005a  r....r....r....Z
+000031f0: 0a64 6173 6b2e 6172 7261 7972 6500 0000  .dask.arrayre...
+00003200: 729a 0000 0072 4a00 0000 72af 0000 005a  r....rJ...r....Z
+00003210: 1064 6173 6b2e 6469 7374 7269 6275 7465  .dask.distribute
+00003220: 645a 0b64 6973 7472 6962 7574 6564 72ae  dZ.distributedr.
+00003230: 0000 0072 0d00 0000 5a05 6e75 6d70 7972  ...r....Z.numpyr
+00003240: 3700 0000 7263 0000 00da 0873 7465 6d74  7...rc.....stemt
+00003250: 6f6f 6c72 7600 0000 7278 0000 00da 0b63  oolrv...rx.....c
+00003260: 6f6c 6c65 6374 696f 6e73 7205 0000 0072  ollectionsr....r
+00003270: 7900 0000 7206 0000 0072 4200 0000 726d  y...r....rB...rm
+00003280: 0000 0072 9000 0000 72ab 0000 0072 ac00  ...r....r....r..
+00003290: 0000 72b3 0000 0072 0800 0000 7208 0000  ..r....r....r...
+000032a0: 0072 0800 0000 720a 0000 00da 083c 6d6f  .r....r......<mo
+000032b0: 6475 6c65 3e01 0000 0073 2a00 0000 1400  dule>....s*.....
+000032c0: 0801 0c01 0801 0801 0c01 0801 0801 0801  ................
+000032d0: 0801 0801 0c01 1003 007f 007f 0a45 0a49  .............E.I
+000032e0: 0819 0a2f 0818 0e08                      .../....
```

## Comparing `stemtool/util/__pycache__/sobel_canny.cpython-39.pyc` & `stemtool/util/__pycache__/sobel_canny.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.9, timestamp-based, .py timestamp: Mon Feb  6 17:48:48 2023 UTC, .py size: 12916 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 5% similar despite different names*

```diff
@@ -1,723 +1,714 @@
-00000000: 610d 0d0a 0000 0000 803d e163 7432 0000  a........=.ct2..
+00000000: 6f0d 0d0a 0000 0000 c876 6f64 6431 0000  o........vodd1..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 7a00 0000 6400  .....@...sz...d.
-00000030: 6401 6c00 5a01 6400 6401 6c02 5a02 6400  d.l.Z.d.d.l.Z.d.
-00000040: 6401 6c03 6d04 5a05 0100 6400 6401 6c06  d.l.m.Z...d.d.l.
-00000050: 6d07 5a08 0100 6400 6401 6c09 5a0a 6400  m.Z...d.d.l.Z.d.
-00000060: 6401 6c0b 6d0c 5a0d 0100 6400 6401 6c0e  d.l.m.Z...d.d.l.
-00000070: 5a0e 640d 6403 6404 8401 5a0f 6405 6406  Z.d.d.d...Z.d.d.
-00000080: 8400 5a10 6407 6408 8400 5a11 6409 640a  ..Z.d.d...Z.d.d.
-00000090: 8400 5a12 4700 640b 640c 8400 640c 6513  ..Z.G.d.d...d.e.
-000000a0: 8303 5a14 6401 5300 290e e900 0000 004e  ..Z.d.S.)......N
-000000b0: e903 0000 0063 0200 0000 0000 0000 0000  .....c..........
-000000c0: 0000 0800 0000 0700 0000 4300 0000 73a6  ..........C...s.
-000000d0: 0000 007c 00a0 0074 016a 02a1 017d 007c  ...|...t.j...}.|
-000000e0: 0164 016b 0272 3674 016a 0364 0274 016a  .d.k.r6t.j.d.t.j
-000000f0: 0264 038d 027d 0274 016a 0364 0474 016a  .d...}.t.j.d.t.j
-00000100: 0264 038d 027d 036e 2074 016a 0364 0574  .d...}.n t.j.d.t
-00000110: 016a 0264 038d 027d 0274 016a 0364 0674  .j.d...}.t.j.d.t
-00000120: 016a 0264 038d 027d 0374 046a 057c 007c  .j.d...}.t.j.|.|
-00000130: 0264 0764 0864 0964 0a8d 057d 0474 046a  .d.d.d.d...}.t.j
-00000140: 057c 007c 0364 0764 0864 0964 0a8d 057d  .|.|.d.d.d.d...}
-00000150: 057c 0464 0b13 007c 0564 0b13 0017 0064  .|.d...|.d.....d
-00000160: 0c13 007d 0674 01a0 067c 057c 04a1 027d  ...}.t...|.|...}
-00000170: 077c 067c 0766 0253 0029 0d61 9103 0000  .|.|.f.S.).a....
-00000180: 0a20 2020 2053 6f62 656c 2046 696c 7465  .    Sobel Filte
-00000190: 7220 616e 2049 6e70 7574 2049 6d61 6765  r an Input Image
-000001a0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-000001b0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-000001c0: 2020 2020 696d 3a20 2020 206e 6461 7272      im:    ndarr
-000001d0: 6179 0a20 2020 2020 2020 2020 2020 7468  ay.           th
-000001e0: 6520 6f72 6967 696e 616c 2069 6e70 7574  e original input
-000001f0: 2069 6d61 6765 2074 6f20 6265 2066 696c   image to be fil
-00000200: 7465 7265 640a 2020 2020 6f72 6465 723a  tered.    order:
-00000210: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
-00000220: 3320 6973 2074 6865 2064 6566 6175 6c74  3 is the default
-00000230: 2062 7574 2069 6620 3520 6973 2073 7065   but if 5 is spe
-00000240: 6369 6669 6564 0a20 2020 2020 2020 2020  cified.         
-00000250: 2020 7468 656e 2061 2035 7835 2053 6f62    then a 5x5 Sob
-00000260: 656c 2066 696c 7465 7220 6973 2072 756e  el filter is run
-00000270: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00000280: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61    -------.    ma
-00000290: 673a 206e 6461 7272 6179 0a20 2020 2020  g: ndarray.     
-000002a0: 2020 2020 536f 6265 6c20 4669 6c74 6572      Sobel Filter
-000002b0: 204d 6167 6e69 7475 6465 0a20 2020 2061   Magnitude.    a
-000002c0: 6e64 3a20 6e64 6172 7261 790a 2020 2020  nd: ndarray.    
-000002d0: 2020 2020 2053 6f62 656c 2046 696c 7465       Sobel Filte
-000002e0: 7220 416e 676c 650a 0a20 2020 204e 6f74  r Angle..    Not
-000002f0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-00000300: 2057 6520 6465 6669 6e65 2074 6865 2074   We define the t
-00000310: 776f 2064 6966 6665 7265 6e74 6961 7469  wo differentiati
-00000320: 6f6e 206d 6174 7269 6365 7320 2d20 675f  on matrices - g_
-00000330: 7820 616e 6420 675f 790a 2020 2020 616e  x and g_y.    an
-00000340: 6420 7468 656e 206d 6f76 6520 616c 6f6e  d then move alon
-00000350: 6720 6f75 7220 6461 7461 7365 7420 2d20  g our dataset - 
-00000360: 746f 2070 6572 666f 726d 2074 6865 206d  to perform the m
-00000370: 6174 7269 780a 2020 2020 6f70 6572 6174  atrix.    operat
-00000380: 696f 6e73 206f 6e20 3578 3520 6f72 2033  ions on 5x5 or 3
-00000390: 7833 2073 6563 7469 6f6e 7320 6f66 2074  x3 sections of t
-000003a0: 6865 2069 6e70 7574 2069 6d61 6765 2e20  he input image. 
-000003b0: 5468 650a 2020 2020 6d61 676e 6974 7564  The.    magnitud
-000003c0: 6520 6f66 2074 6865 2053 6f62 656c 2066  e of the Sobel f
-000003d0: 696c 7465 7265 6420 696d 6167 6520 6973  iltered image is
-000003e0: 2074 6865 2061 6273 6f6c 7574 650a 2020   the absolute.  
-000003f0: 2020 6f66 2074 6865 206d 756c 7469 706c    of the multipl
-00000400: 6965 6420 6d61 7472 6963 6573 202d 2073  ied matrices - s
-00000410: 7175 6172 6564 2061 6e64 2073 756d 6d65  quared and summe
-00000420: 6420 616e 6420 7371 7561 7265 0a20 2020  d and square.   
-00000430: 2072 6f6f 7465 642e 0a0a 2020 2020 5265   rooted...    Re
-00000440: 6665 7265 6e63 6573 0a20 2020 202d 2d2d  ferences.    ---
-00000450: 2d2d 2d2d 2d2d 2d0a 2020 2020 2e2e 205b  -------.    .. [
-00000460: 335d 2053 6f62 656c 2c20 492e 2061 6e64  3] Sobel, I. and
-00000470: 2046 656c 646d 616e 2c20 472e 2c20 3139   Feldman, G., 19
-00000480: 3638 2e20 4120 3378 3320 6973 6f74 726f  68. A 3x3 isotro
-00000490: 7069 6320 6772 6164 6965 6e74 0a20 2020  pic gradient.   
-000004a0: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
-000004b0: 2066 6f72 2069 6d61 6765 2070 726f 6365   for image proce
-000004c0: 7373 696e 672e 2061 2074 616c 6b20 6174  ssing. a talk at
-000004d0: 2074 6865 2053 7461 6e66 6f72 640a 2020   the Stanford.  
-000004e0: 2020 2020 2020 2020 2041 7274 6966 6963           Artific
-000004f0: 6961 6c20 5072 6f6a 6563 7420 696e 2c20  ial Project in, 
-00000500: 7070 2e32 3731 2d32 3732 2e0a 0a20 2020  pp.271-272...   
-00000510: 2072 0200 0000 2903 a903 e9ff ffff ff72   r....)........r
-00000520: 0100 0000 e901 0000 0029 03e9 feff ffff  .........)......
-00000530: 7201 0000 00e9 0200 0000 7203 0000 00a9  r.........r.....
-00000540: 015a 0564 7479 7065 2903 2903 7204 0000  .Z.dtype).).r...
-00000550: 0072 0600 0000 7204 0000 0029 0372 0100  .r....r....).r..
-00000560: 0000 7201 0000 0072 0100 0000 2903 7205  ..r....r....).r.
-00000570: 0000 0072 0700 0000 7205 0000 0029 05a9  ...r....r....)..
-00000580: 0572 0400 0000 7206 0000 0072 0100 0000  .r....r....r....
-00000590: 7207 0000 0072 0500 0000 a905 e9fc ffff  r....r..........
-000005a0: ffe9 f8ff ffff 7201 0000 00e9 0800 0000  ......r.........
-000005b0: e904 0000 0029 05e9 faff ffff e9f4 ffff  .....)..........
-000005c0: ff72 0100 0000 e90c 0000 00e9 0600 0000  .r..............
-000005d0: 720a 0000 0072 0900 0000 2905 2905 7205  r....r....).).r.
-000005e0: 0000 0072 0e00 0000 7212 0000 0072 0e00  ...r....r....r..
-000005f0: 0000 7205 0000 0029 0572 0700 0000 720d  ..r....).r....r.
-00000600: 0000 0072 1100 0000 720d 0000 0072 0700  ...r....r....r..
-00000610: 0000 2905 7201 0000 0072 0100 0000 7201  ..).r....r....r.
-00000620: 0000 0072 0100 0000 7201 0000 0029 0572  ...r....r....).r
-00000630: 0600 0000 720c 0000 0072 1000 0000 720c  ....r....r....r.
-00000640: 0000 0072 0600 0000 2905 7204 0000 0072  ...r....).r....r
-00000650: 0b00 0000 720f 0000 0072 0b00 0000 7204  ....r....r....r.
-00000660: 0000 005a 0473 616d 655a 0473 796d 6d72  ...Z.sameZ.symmr
-00000670: 0100 0000 2903 da04 6d6f 6465 da08 626f  ....)...mode..bo
-00000680: 756e 6461 7279 da09 6669 6c6c 7661 6c75  undary..fillvalu
-00000690: 6572 0700 0000 6700 0000 0000 00e0 3f29  er....g.......?)
-000006a0: 07da 0661 7374 7970 65da 026e 70da 0766  ...astype..np..f
-000006b0: 6c6f 6174 3634 da07 6173 6172 7261 79da  loat64..asarray.
-000006c0: 0673 6369 7369 675a 0a63 6f6e 766f 6c76  .scisigZ.convolv
-000006d0: 6532 645a 0761 7263 7461 6e32 2908 5a02  e2dZ.arctan2).Z.
-000006e0: 696d da05 6f72 6465 725a 036b 5f78 5a03  im..orderZ.k_xZ.
-000006f0: 6b5f 795a 0367 5f78 5a03 675f 79da 036d  k_yZ.g_xZ.g_y..m
-00000700: 6167 da03 616e 67a9 0072 1e00 0000 fa3f  ag..ang..r.....?
-00000710: 6275 696c 642f 6264 6973 742e 6d61 636f  build/bdist.maco
-00000720: 7378 2d31 302e 392d 7838 365f 3634 2f65  sx-10.9-x86_64/e
-00000730: 6767 2f73 7465 6d74 6f6f 6c2f 7574 696c  gg/stemtool/util
-00000740: 2f73 6f62 656c 5f63 616e 6e79 2e70 79da  /sobel_canny.py.
-00000750: 0573 6f62 656c 0a00 0000 7322 0000 0000  .sobel....s"....
-00000760: 230c 0108 0110 0112 0204 0102 0704 f806  #...............
-00000770: 0a04 0102 0704 f806 0a14 0114 0114 010c  ................
-00000780: 0172 2000 0000 6301 0000 0000 0000 0000  .r ...c.........
-00000790: 0000 0019 0000 0005 0000 0043 0000 0073  ...........C...s
-000007a0: 7201 0000 7400 a001 7400 a002 7c00 a101  r...t...t...|...
-000007b0: a101 a003 7404 a101 7d01 7400 6a05 6401  ....t...}.t.j.d.
-000007c0: 7c01 6401 1900 8502 6401 7c01 6402 1900  |.d.....d.|.d...
-000007d0: 8502 6602 1900 5c02 7d02 7d03 7400 6a01  ..f...\.}.}.t.j.
-000007e0: 7c03 7c00 1900 7400 6a06 6403 8d02 7d04  |.|...t.j.d...}.
-000007f0: 7400 6a01 7c02 7c00 1900 7400 6a06 6403  t.j.|.|...t.j.d.
-00000800: 8d02 7d05 7400 a007 7c04 a101 7d06 7400  ..}.t...|...}.t.
-00000810: a007 7c05 a101 7d07 7c04 7c06 1800 7d08  ..|...}.|.|...}.
-00000820: 7c05 7c07 1800 7d09 7400 a008 7c08 7c09  |.|...}.t...|.|.
-00000830: 1400 a101 7d0a 7400 a008 7c08 6404 1300  ....}.t...|.d...
-00000840: a101 7d0b 7400 a008 7c09 6404 1300 a101  ..}.t...|.d.....
-00000850: 7d0c 7400 a008 7c08 6404 1300 7c09 1400  }.t...|.d...|...
-00000860: a101 7d0d 7400 a008 7c08 7c09 6404 1300  ..}.t...|.|.d...
-00000870: 1400 a101 7d0e 7400 a008 7c08 6405 1300  ....}.t...|.d...
-00000880: a101 7d0f 7400 a008 7c09 6405 1300 a101  ..}.t...|.d.....
-00000890: 7d10 7400 a009 7c0b 7c0a 6702 7c0a 7c0c  }.t...|.|.g.|.|.
-000008a0: 6702 6702 a101 7d11 7400 a009 7c0f 7c0e  g.g...}.t...|.|.
-000008b0: 1700 7c10 7c0d 1700 6702 a101 6404 1b00  ..|.|...g...d...
-000008c0: 7d12 7400 6a0a a00b 7c11 7c12 a102 5c02  }.t.j...|.|...\.
-000008d0: 7d13 7d14 7c06 7c13 1700 7d15 7c07 7c14  }.}.|.|...}.|.|.
-000008e0: 1700 7d16 7400 a00c 7c04 7c15 1800 6404  ..}.t...|.|...d.
-000008f0: 1300 7c05 7c16 1800 6404 1300 1700 a101  ..|.|...d.......
-00000900: 7d17 7400 a007 7c17 a101 7d18 7c15 7c16  }.t...|...}.|.|.
-00000910: 7c18 6603 5300 2906 6179 0200 000a 2020  |.f.S.).ay....  
-00000920: 2020 4669 7420 6369 7263 6c65 2074 6f20    Fit circle to 
-00000930: 6461 7461 2070 6f69 6e74 7320 616c 6765  data points alge
-00000940: 6272 6169 6361 6c6c 790a 0a20 2020 2050  braically..    P
-00000950: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000960: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2065 6467  --------.    edg
-00000970: 655f 696d 6167 653a 2062 6f6f 6c65 616e  e_image: boolean
-00000980: 2061 7272 6179 0a20 2020 2020 2020 2020   array.         
-00000990: 2020 2020 2020 2042 6f6f 6c65 616e 2064         Boolean d
-000009a0: 6174 6120 7768 6572 6520 7468 6520 6564  ata where the ed
-000009b0: 6765 2069 7320 310a 0a20 2020 2052 6574  ge is 1..    Ret
-000009c0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-000009d0: 0a20 2020 2078 5f63 656e 7465 723a 2020  .    x_center:  
-000009e0: 2020 2020 666c 6f61 740a 2020 2020 2020      float.      
-000009f0: 2020 2020 2020 2020 2020 2020 2058 2070               X p
-00000a00: 6978 656c 206f 6620 6369 7263 6c65 2063  ixel of circle c
-00000a10: 656e 7465 720a 2020 2020 795f 6365 6e74  enter.    y_cent
-00000a20: 6572 3a20 2020 2020 2066 6c6f 6174 0a20  er:      float. 
-00000a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000a40: 2020 5920 7069 7865 6c20 6f66 2063 6972    Y pixel of cir
-00000a50: 636c 6520 6365 6e74 6572 0a20 2020 2072  cle center.    r
-00000a60: 6164 6975 735f 6369 7263 6c65 3a20 666c  adius_circle: fl
-00000a70: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
-00000a80: 2020 2020 2020 2052 6164 6975 7320 6f66         Radius of
-00000a90: 2074 6865 2063 6972 636c 650a 0a20 2020   the circle..   
-00000aa0: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00000ab0: 0a20 2020 2057 6520 6361 6c63 756c 6174  .    We calculat
-00000ac0: 6520 7468 6520 6d65 616e 206f 6620 616c  e the mean of al
-00000ad0: 6c20 7468 6520 706f 696e 7473 0a20 2020  l the points.   
-00000ae0: 2061 7320 7468 6520 696e 6974 6961 6c20   as the initial 
-00000af0: 6573 7469 6d61 7465 206f 6620 7468 6520  estimate of the 
-00000b00: 6369 7263 6c65 2063 656e 7465 720a 2020  circle center.  
-00000b10: 2020 616e 6420 7468 656e 2073 6f6c 7665    and then solve
-00000b20: 2061 2073 6574 206f 6620 6c69 6e65 6172   a set of linear
-00000b30: 2065 7175 6174 696f 6e73 0a20 2020 2074   equations.    t
-00000b40: 6f20 6361 6c63 756c 6174 6520 7261 6469  o calculate radi
-00000b50: 7573 2061 6e64 2074 6865 2064 6973 6b20  us and the disk 
-00000b60: 6365 6e74 6572 2e0a 0a20 2020 2053 6565  center...    See
-00000b70: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
-00000b80: 2d2d 0a20 2020 2075 7469 6c2e 4361 6e6e  --.    util.Cann
-00000b90: 790a 2020 2020 7201 0000 0072 0500 0000  y.    r....r....
-00000ba0: 7208 0000 0072 0700 0000 7202 0000 0029  r....r....r....)
-00000bb0: 0d72 1700 0000 7219 0000 00da 0573 6861  .r....r......sha
-00000bc0: 7065 7216 0000 00da 0369 6e74 da05 6d67  per......int..mg
-00000bd0: 7269 6472 1800 0000 da04 6d65 616e da03  ridr......mean..
-00000be0: 7375 6dda 0561 7272 6179 5a06 6c69 6e61  sum..arrayZ.lina
-00000bf0: 6c67 5a05 736f 6c76 65da 0473 7172 7429  lgZ.solve..sqrt)
-00000c00: 195a 0a65 6467 655f 696d 6167 655a 0a73  .Z.edge_imageZ.s
-00000c10: 697a 655f 696d 6167 655a 0279 565a 0278  ize_imageZ.yVZ.x
-00000c20: 565a 0778 5661 6c75 6573 5a07 7956 616c  VZ.xValuesZ.yVal
-00000c30: 7565 735a 0978 4365 6e74 726f 6964 5a09  uesZ.xCentroidZ.
-00000c40: 7943 656e 7472 6f69 645a 0775 5661 6c75  yCentroidZ.uValu
-00000c50: 6573 5a07 7656 616c 7565 735a 0353 7576  esZ.vValuesZ.Suv
-00000c60: 5a03 5375 755a 0353 7676 5a04 5375 7576  Z.SuuZ.SvvZ.Suuv
-00000c70: 5a04 5375 7676 5a04 5375 7575 5a04 5376  Z.SuvvZ.SuuuZ.Sv
-00000c80: 7676 da01 41da 0142 5a02 7563 da02 7663  vv..A..BZ.uc..vc
-00000c90: 5a07 7843 656e 7465 725a 0779 4365 6e74  Z.xCenterZ.yCent
-00000ca0: 6572 5a07 5276 616c 7565 735a 0672 6164  erZ.RvaluesZ.rad
-00000cb0: 6975 7372 1e00 0000 721e 0000 0072 1f00  iusr....r....r..
-00000cc0: 0000 da0a 6369 7263 6c65 5f66 6974 4d00  ....circle_fitM.
-00000cd0: 0000 732e 0000 0000 1d16 0122 0114 0114  ..s........"....
-00000ce0: 020a 010a 0208 0108 020e 010e 010e 0112  ................
-00000cf0: 0112 010e 010e 0216 011a 0112 0208 0108  ................
-00000d00: 021e 010a 0272 2b00 0000 6303 0000 0000  .....r+...c.....
-00000d10: 0000 0000 0000 0009 0000 0005 0000 0043  ...............C
-00000d20: 0000 0073 c601 0000 7400 a001 7c01 a101  ...s....t...|...
-00000d30: 7d03 7400 a002 7403 7c00 8301 a101 4400  }.t...t.|.....D.
-00000d40: 9001 5da6 7d04 7c00 7c04 6401 6602 1900  ..].}.|.|.d.f...
-00000d50: 7d05 7c00 7c04 6402 6602 1900 7d06 6402  }.|.|.d.f...}.d.
-00000d60: 7d07 6402 7d08 6401 7c02 7c05 7c06 6602  }.d.}.d.|.|.|.f.
-00000d70: 1900 0400 0300 6b01 725a 6403 6b00 737c  ......k.rZd.k.s|
-00000d80: 6e02 0100 6404 7c02 7c05 7c06 6602 1900  n...d.|.|.|.f...
-00000d90: 0400 0300 6b01 7278 6405 6b01 729e 6e04  ....k.rxd.k.r.n.
-00000da0: 0100 6e22 7c01 7c05 7c06 6402 1700 6602  ..n"|.|.|.d...f.
-00000db0: 1900 7d07 7c01 7c05 7c06 6402 1800 6602  ..}.|.|.|.d...f.
-00000dc0: 1900 7d08 6edc 6403 7c02 7c05 7c06 6602  ..}.n.d.|.|.|.f.
-00000dd0: 1900 0400 0300 6b01 72ba 6406 6b00 72e8  ......k.r.d.k.r.
-00000de0: 6e04 0100 6e2a 7c01 7c05 6402 1700 7c06  n...n*|.|.d...|.
-00000df0: 6402 1800 6602 1900 7d07 7c01 7c05 6402  d...f...}.|.|.d.
-00000e00: 1800 7c06 6402 1700 6602 1900 7d08 6e92  ..|.d...f...}.n.
-00000e10: 6406 7c02 7c05 7c06 6602 1900 0400 0300  d.|.|.|.f.......
-00000e20: 6b01 9001 7208 6407 6b00 9001 722e 6e04  k...r.d.k...r.n.
-00000e30: 0100 6e22 7c01 7c05 6402 1700 7c06 6602  ..n"|.|.d...|.f.
-00000e40: 1900 7d07 7c01 7c05 6402 1800 7c06 6602  ..}.|.|.d...|.f.
-00000e50: 1900 7d08 6e4c 6407 7c02 7c05 7c06 6602  ..}.nLd.|.|.|.f.
-00000e60: 1900 0400 0300 6b01 9001 724e 6404 6b00  ......k...rNd.k.
-00000e70: 9001 727a 6e04 0100 6e28 7c01 7c05 6402  ..rzn...n(|.|.d.
-00000e80: 1800 7c06 6402 1800 6602 1900 7d07 7c01  ..|.d...f...}.|.
-00000e90: 7c05 6402 1700 7c06 6402 1700 6602 1900  |.d...|.d...f...
-00000ea0: 7d08 7c01 7c05 7c06 6602 1900 7c07 6b05  }.|.|.|.f...|.k.
-00000eb0: 9001 72b4 7c01 7c05 7c06 6602 1900 7c08  ..r.|.|.|.f...|.
-00000ec0: 6b05 9001 72b4 7c01 7c05 7c06 6602 1900  k...r.|.|.|.f...
-00000ed0: 7c03 7c05 7c06 6602 3c00 7118 6401 7c03  |.|.|.f.<.q.d.|.
-00000ee0: 7c05 7c06 6602 3c00 7118 7c03 5300 2908  |.|.f.<.q.|.S.).
-00000ef0: 6112 0200 000a 2020 2020 4675 6e63 7469  a.....    Functi
-00000f00: 6f6e 2066 6f72 2074 6869 6e6e 696e 6720  on for thinning 
-00000f10: 536f 6265 6c0a 2020 2020 4669 6c74 6572  Sobel.    Filter
-00000f20: 6564 2045 6467 6573 0a0a 2020 2020 5061  ed Edges..    Pa
-00000f30: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00000f40: 2d2d 2d2d 2d2d 2d0a 2020 2020 706f 733a  -------.    pos:
-00000f50: 2020 6e64 6172 7261 790a 2020 2020 2020    ndarray.      
-00000f60: 2020 2020 4c69 7374 206f 6620 7069 7865      List of pixe
-00000f70: 6c20 706f 7369 7469 6f6e 730a 2020 2020  l positions.    
-00000f80: 6564 6765 3a20 6e64 6172 7261 790a 2020  edge: ndarray.  
-00000f90: 2020 2020 2020 2020 5468 696e 6e65 6420          Thinned 
-00000fa0: 4564 6765 0a20 2020 206d 6167 3a20 206e  Edge.    mag:  n
-00000fb0: 6461 7272 6179 0a20 2020 2020 2020 2020  darray.         
-00000fc0: 204d 6167 6e69 7475 6465 2061 6674 6572   Magnitude after
-00000fd0: 2053 6f62 656c 2046 696c 7465 7269 6e67   Sobel Filtering
-00000fe0: 0a20 2020 2061 6e67 3a20 206e 6461 7272  .    ang:  ndarr
-00000ff0: 6179 0a20 2020 2020 2020 2020 2041 4e67  ay.          ANg
-00001000: 6c65 206f 6620 536f 6265 6c20 4669 6c74  le of Sobel Filt
-00001010: 6572 2c20 696e 2064 6567 7265 6573 0a0a  er, in degrees..
-00001020: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
-00001030: 2d2d 2d0a 2020 2020 5765 2075 7365 2074  ---.    We use t
-00001040: 6865 2064 6972 6563 7469 6f6e 206f 6620  he direction of 
-00001050: 7468 6520 536f 6265 6c20 6772 6164 6965  the Sobel gradie
-00001060: 6e74 2074 6f0a 2020 2020 6465 7465 726d  nt to.    determ
-00001070: 696e 6520 7768 6574 6865 7220 6120 7069  ine whether a pi
-00001080: 7865 6c20 6265 6c6f 6e67 7320 746f 2074  xel belongs to t
-00001090: 6865 2065 6467 650a 2020 2020 6f72 206e  he edge.    or n
-000010a0: 6f74 2e20 4966 2074 6865 2067 7261 6469  ot. If the gradi
-000010b0: 656e 7420 6973 2070 6572 7065 6e64 6963  ent is perpendic
-000010c0: 756c 6172 2074 6f20 7468 650a 2020 2020  ular to the.    
-000010d0: 7069 7865 6c73 2074 6865 6e20 6974 2069  pixels then it i
-000010e0: 7320 616e 2065 6467 6520 7069 7865 6c20  s an edge pixel 
-000010f0: 6f72 2065 6c73 6520 6974 2069 7320 6e6f  or else it is no
-00001100: 742e 0a20 2020 2072 0100 0000 7205 0000  t..    r....r...
-00001110: 0067 0000 0000 0080 3640 6700 0000 0000  .g......6@g.....
-00001120: b063 40e9 b400 0000 6700 0000 0000 e050  .c@.....g......P
-00001130: 4067 0000 0000 0020 5c40 2904 7217 0000  @g..... \@).r...
-00001140: 005a 0a7a 6572 6f73 5f6c 696b 65da 0661  .Z.zeros_like..a
-00001150: 7261 6e67 65da 036c 656e 2909 da03 706f  range..len)...po
-00001160: 7372 1c00 0000 721d 0000 00da 0c74 6869  sr....r......thi
-00001170: 6e6e 6564 5f65 6467 65da 0270 70da 0269  nned_edge..pp..i
-00001180: 69da 026a 6ada 0171 da01 7272 1e00 0000  i..jj..q..rr....
-00001190: 721e 0000 0072 1f00 0000 da0c 6564 6765  r....r......edge
-000011a0: 5f74 6869 6e6e 6572 8a00 0000 732c 0000  _thinner....s,..
-000011b0: 0000 170a 0114 010c 010c 0104 0104 013e  ...............>
-000011c0: 0110 0112 0120 0114 0116 0124 0110 0112  ..... .....$....
-000011d0: 0124 0114 0114 0224 0116 020e 0172 3600  .$.....$.....r6.
-000011e0: 0000 6304 0000 0000 0000 0000 0000 0008  ..c.............
-000011f0: 0000 0005 0000 0043 0000 0073 1601 0000  .......C...s....
-00001200: 7400 a001 7c01 a101 7d04 7400 a002 7403  t...|...}.t...t.
-00001210: 7c00 8301 a101 4400 5df8 7d05 7c00 7c05  |.....D.].}.|.|.
-00001220: 6401 6602 1900 7d06 7c00 7c05 6402 6602  d.f...}.|.|.d.f.
-00001230: 1900 7d07 7c04 7c06 7c07 6602 1900 7c03  ..}.|.|.|.f...|.
-00001240: 6b02 7218 7c04 7c06 6402 1800 7c07 6402  k.r.|.|.d...|.d.
-00001250: 1800 6602 1900 7c02 6b02 73f6 7c04 7c06  ..f...|.k.s.|.|.
-00001260: 6402 1800 7c07 6602 1900 7c02 6b02 73f6  d...|.f...|.k.s.
-00001270: 7c04 7c06 6402 1800 7c07 6402 1700 6602  |.|.d...|.d...f.
-00001280: 1900 7c02 6b02 73f6 7c04 7c06 7c07 6402  ..|.k.s.|.|.|.d.
-00001290: 1800 6602 1900 7c02 6b02 73f6 7c04 7c06  ..f...|.k.s.|.|.
-000012a0: 7c07 6402 1700 6602 1900 7c02 6b02 73f6  |.d...f...|.k.s.
-000012b0: 7c04 7c06 6402 1700 7c07 6402 1800 6602  |.|.d...|.d...f.
-000012c0: 1900 7c02 6b02 73f6 7c04 7c06 6402 1700  ..|.k.s.|.|.d...
-000012d0: 7c07 6602 1900 7c02 6b02 73f6 7c04 7c06  |.f...|.k.s.|.|.
-000012e0: 6402 1700 7c07 6402 1700 6602 1900 7c02  d...|.d...f...|.
-000012f0: 6b02 9001 7204 7c02 7c04 7c06 7c07 6602  k...r.|.|.|.|.f.
-00001300: 3c00 7118 6401 7c04 7c06 7c07 6602 3c00  <.q.d.|.|.|.f.<.
-00001310: 7118 7c04 5300 2903 613f 0200 000a 2020  q.|.S.).a?....  
-00001320: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00001330: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00001340: 706f 733a 2020 206e 6461 7272 6179 0a20  pos:   ndarray. 
-00001350: 2020 2020 2020 2020 2020 4c69 7374 206f            List o
-00001360: 6620 7069 7865 6c20 706f 7369 7469 6f6e  f pixel position
-00001370: 730a 2020 2020 6564 6765 3a20 206e 6461  s.    edge:  nda
-00001380: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
-00001390: 5468 696e 6e65 6420 4564 6765 2c20 7468  Thinned Edge, th
-000013a0: 6174 2077 696c 6c20 6265 206a 6f69 6e65  at will be joine
-000013b0: 640a 2020 2020 7570 7065 723a 2066 6c6f  d.    upper: flo
-000013c0: 6174 0a20 2020 2020 2020 2020 2020 5570  at.           Up
-000013d0: 7065 7220 7468 7265 7368 6f6c 640a 2020  per threshold.  
-000013e0: 2020 6c6f 7765 723a 2066 6c6f 6174 0a20    lower: float. 
-000013f0: 2020 2020 2020 2020 2020 4c6f 7765 7220            Lower 
-00001400: 7468 7265 7368 6f6c 640a 0a20 2020 204e  threshold..    N
-00001410: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-00001420: 2020 2054 6865 2069 6e70 7574 2069 6d61     The input ima
-00001430: 6765 206e 6f77 2063 6f6e 7369 7374 7320  ge now consists 
-00001440: 6f66 2073 7472 6f6e 6720 616e 6420 7765  of strong and we
-00001450: 616b 0a20 2020 2074 6872 6573 686f 6c64  ak.    threshold
-00001460: 732e 2054 6865 2066 696e 616c 2073 7465  s. The final ste
-00001470: 7020 6f66 2074 6865 2061 6c67 6f72 6974  p of the algorit
-00001480: 686d 2069 7320 746f 0a20 2020 206c 6f6f  hm is to.    loo
-00001490: 6b20 6174 2073 6f6d 6520 6f66 2074 6865  k at some of the
-000014a0: 206d 6561 7375 7265 6420 6564 6765 7320   measured edges 
-000014b0: 616e 6420 6a6f 696e 2f6c 696e 6b20 7468  and join/link th
-000014c0: 656d 2e0a 2020 2020 5468 6520 6964 6561  em..    The idea
-000014d0: 2069 7320 7468 6174 2069 6620 6120 6564   is that if a ed
-000014e0: 6765 2070 6978 656c 2069 7320 636c 6173  ge pixel is clas
-000014f0: 7369 6669 6564 2061 7320 610a 2020 2020  sified as a.    
-00001500: 7765 616b 2065 6467 6520 6275 7420 6f6e  weak edge but on
-00001510: 6520 6f66 2069 7473 206e 6569 6768 626f  e of its neighbo
-00001520: 7273 2069 7320 6120 7374 726f 6e67 2065  rs is a strong e
-00001530: 6467 6520 7468 656e 0a20 2020 2069 7420  dge then.    it 
-00001540: 6973 2061 2073 7472 6f6e 6720 6564 6765  is a strong edge
-00001550: 2070 6978 656c 2e0a 2020 2020 7201 0000   pixel..    r...
-00001560: 0072 0500 0000 2904 7217 0000 00da 0463  .r....).r......c
-00001570: 6f70 7972 2d00 0000 722e 0000 0029 0872  opyr-...r....).r
-00001580: 2f00 0000 7230 0000 00da 0575 7070 6572  /...r0.....upper
-00001590: da05 6c6f 7765 725a 0b6a 6f69 6e65 645f  ..lowerZ.joined_
-000015a0: 6564 6765 7231 0000 0072 3200 0000 7233  edger1...r2...r3
-000015b0: 0000 0072 1e00 0000 721e 0000 0072 1f00  ...r....r....r..
-000015c0: 0000 da0b 6564 6765 5f6a 6f69 6e65 72bb  ....edge_joiner.
-000015d0: 0000 0073 3000 0000 0016 0a01 1201 0c01  ...s0...........
-000015e0: 0c01 1002 16ff 0202 12fe 0203 16fd 0204  ................
-000015f0: 12fc 0205 12fb 0206 16fa 0207 12f9 0208  ................
-00001600: 16f8 040a 0e02 0e01 723a 0000 0063 0000  ........r:...c..
-00001610: 0000 0000 0000 0000 0000 0000 0000 0300  ................
-00001620: 0000 4000 0000 7332 0000 0065 005a 0164  ..@...s2...e.Z.d
-00001630: 005a 0264 015a 0364 0d64 0464 0584 015a  .Z.d.Z.d.d.d...Z
-00001640: 0464 0664 0784 005a 0564 0864 0984 005a  .d.d...Z.d.d...Z
-00001650: 0664 0a64 0b84 005a 0764 0c53 0029 0eda  .d.d...Z.d.S.)..
-00001660: 0543 616e 6e79 6193 0700 000a 2020 2020  .Cannya.....    
-00001670: 4361 6e6e 7920 4564 6765 2044 6574 6563  Canny Edge Detec
-00001680: 7469 6f6e 0a0a 2020 2020 5061 7261 6d65  tion..    Parame
-00001690: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-000016a0: 2d2d 2d0a 2020 2020 696d 6167 653a 2020  ---.    image:  
-000016b0: 2020 2020 2020 206e 6461 7272 6179 0a20         ndarray. 
-000016c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016d0: 2020 496d 6167 6520 6f6e 2077 6869 6368    Image on which
-000016e0: 2043 616e 6e79 2065 6467 6520 6465 7465   Canny edge dete
-000016f0: 6374 696f 6e20 6973 2074 6f20 6265 2070  ction is to be p
-00001700: 6572 666f 726d 6564 0a20 2020 206c 6f77  erformed.    low
-00001710: 5468 7265 7368 6f6c 643a 2020 666c 6f61  Threshold:  floa
-00001720: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00001730: 2020 2020 204c 6f77 6572 2074 6872 6573       Lower thres
-00001740: 686f 6c64 2076 616c 7565 2c20 636f 756c  hold value, coul
-00001750: 6420 6265 2075 7365 7220 6465 6669 6e65  d be user define
-00001760: 6420 6f72 2061 7574 6f0a 2020 2020 2020  d or auto.      
-00001770: 2020 2020 2020 2020 2020 2020 2067 656e               gen
-00001780: 6572 6174 6564 2066 726f 6d20 4f74 7375  erated from Otsu
-00001790: 2074 6872 6573 686f 6c64 696e 670a 2020   thresholding.  
-000017a0: 2020 6869 6768 5468 7265 7368 6f6c 643a    highThreshold:
-000017b0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
-000017c0: 2020 2020 2020 2020 2020 5570 7065 7220            Upper 
-000017d0: 7468 7265 7368 6f6c 6420 7661 6c75 652c  threshold value,
-000017e0: 2063 6f75 6c64 2062 6520 7573 6572 2064   could be user d
-000017f0: 6566 696e 6564 206f 7220 6175 746f 0a20  efined or auto. 
-00001800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001810: 2020 6765 6e65 7261 7465 6420 6672 6f6d    generated from
-00001820: 204f 7473 7520 7468 7265 7368 6f6c 6469   Otsu thresholdi
-00001830: 6e67 0a0a 2020 2020 4e6f 7465 730a 2020  ng..    Notes.  
-00001840: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6520    -----.    The 
-00001850: 696e 7075 7420 696d 6167 6520 6973 2066  input image is f
-00001860: 6972 7374 2062 6c75 7272 6564 2077 6974  irst blurred wit
-00001870: 6820 6120 5b35 2078 2035 5d20 4761 7573  h a [5 x 5] Gaus
-00001880: 7369 616e 206b 6572 6e65 6c20 746f 0a20  sian kernel to. 
-00001890: 2020 2070 7265 7665 6e74 2070 6978 656c     prevent pixel
-000018a0: 206a 756d 7073 2062 6569 6e67 2069 6e63   jumps being inc
-000018b0: 6f72 7265 6374 6c79 2072 6567 6973 7465  orrectly registe
-000018c0: 7265 6420 6173 2065 6467 6573 2e20 5468  red as edges. Th
-000018d0: 656e 2061 2053 6f62 656c 0a20 2020 2066  en a Sobel.    f
-000018e0: 696c 7465 7220 6973 2072 756e 206f 6e20  ilter is run on 
-000018f0: 7468 6520 696d 6167 652e 2054 6865 2065  the image. The e
-00001900: 6467 6573 2066 726f 6d20 7468 6520 536f  dges from the So
-00001910: 6265 6c20 6669 6c74 6572 2061 7265 0a20  bel filter are. 
-00001920: 2020 2073 7562 7365 7175 656e 746c 7920     subsequently 
-00001930: 7468 696e 6e65 6420 6279 2064 6574 6572  thinned by deter
-00001940: 6d69 6e69 6e67 2077 6865 7468 6572 2074  mining whether t
-00001950: 6865 2067 7261 6469 656e 7420 6f66 2074  he gradient of t
-00001960: 6865 2053 6f62 656c 0a20 2020 2066 696c  he Sobel.    fil
-00001970: 7465 7220 6973 2070 6572 7065 6e64 6963  ter is perpendic
-00001980: 756c 6172 2074 6f20 7468 6520 6564 6765  ular to the edge
-00001990: 2e20 5375 6273 6571 7565 6e74 6c79 2074  . Subsequently t
-000019a0: 6865 2065 6467 6573 2061 7265 2073 6f72  he edges are sor
-000019b0: 7465 640a 2020 2020 696e 746f 2074 776f  ted.    into two
-000019c0: 2062 696e 7320 2d20 7765 616b 2065 6467   bins - weak edg
-000019d0: 6573 2061 6e64 2073 7472 6f6e 6720 6564  es and strong ed
-000019e0: 6765 732e 2054 6865 2077 6561 6b20 6564  ges. The weak ed
-000019f0: 6765 7320 6172 650a 2020 2020 7265 636c  ges are.    recl
-00001a00: 6173 7369 6669 6564 2061 7320 7374 726f  assified as stro
-00001a10: 6e67 2065 6467 6573 2069 6620 7468 6579  ng edges if they
-00001a20: 2061 7265 2063 6f6e 6e65 6374 6564 2074   are connected t
-00001a30: 6f20 7374 726f 6e67 2065 6467 6573 2e0a  o strong edges..
-00001a40: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-00001a50: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2052    --------.    R
-00001a60: 756e 2061 733a 0a0a 2020 2020 3e3e 3e20  un as:..    >>> 
-00001a70: 696d 5f63 616e 6e79 203d 2043 616e 6e79  im_canny = Canny
-00001a80: 2869 6d61 6765 2c30 2e32 2c30 2e37 290a  (image,0.2,0.7).
-00001a90: 0a20 2020 2057 6865 7265 2030 2e32 2061  .    Where 0.2 a
-00001aa0: 6e64 2030 2e37 2061 7265 2074 6865 2070  nd 0.7 are the p
-00001ab0: 6172 616d 6574 6572 7320 6f62 7461 696e  arameters obtain
-00001ac0: 6564 2074 6872 6f75 6768 204f 7473 7520  ed through Otsu 
-00001ad0: 7468 7265 7368 6f6c 6469 6e67 2069 6d61  thresholding ima
-00001ae0: 6765 2e0a 2020 2020 4166 7465 7220 7365  ge..    After se
-00001af0: 7474 696e 6720 7468 6520 636c 6173 732c  tting the class,
-00001b00: 2074 6865 6e20 6765 6e65 7261 7465 2074   then generate t
-00001b10: 6865 2065 6467 6573 2066 6972 7374 2061  he edges first a
-00001b20: 733a 0a0a 2020 2020 3e3e 3e20 696d 5f63  s:..    >>> im_c
-00001b30: 616e 6e79 2e65 6467 655f 7468 696e 6e69  anny.edge_thinni
-00001b40: 6e67 2829 0a0a 2020 2020 5468 6973 2053  ng()..    This S
-00001b50: 6f62 656c 2066 696c 7465 7273 2074 6865  obel filters the
-00001b60: 2069 6d61 6765 2c20 616e 6420 6765 6e65   image, and gene
-00001b70: 7261 7465 7320 7468 6520 696d 6167 6520  rates the image 
-00001b80: 6564 6765 2e20 5468 6520 6d61 676e 6974  edge. The magnit
-00001b90: 7564 6520 6f66 0a20 2020 2074 6865 2053  ude of.    the S
-00001ba0: 6f62 656c 2066 696c 7465 7220 6361 6e20  obel filter can 
-00001bb0: 6265 2061 6363 6573 7365 6420 6173 2060  be accessed as `
-00001bc0: 696d 5f63 616e 6e79 2e73 6f62 656c 5f6d  im_canny.sobel_m
-00001bd0: 6167 602c 2077 6869 6c65 2074 6865 2053  ag`, while the S
-00001be0: 6f62 656c 2061 6e67 6c65 0a20 2020 2069  obel angle.    i
-00001bf0: 6e20 6465 6772 6565 7320 6973 2073 746f  n degrees is sto
-00001c00: 7265 6420 6173 2060 696d 5f63 616e 6e79  red as `im_canny
-00001c10: 2e73 6f62 656c 5f61 6e67 602e 2054 6865  .sobel_ang`. The
-00001c20: 2067 656e 6572 6174 6564 2065 6467 6520   generated edge 
-00001c30: 6973 2073 746f 7265 6420 6173 0a20 2020  is stored as.   
-00001c40: 2060 696d 5f63 616e 6e79 2e74 6869 6e5f   `im_canny.thin_
-00001c50: 6564 6765 602e 2054 6869 7320 6973 2074  edge`. This is t
-00001c60: 6865 2074 6872 6573 686f 6c64 6564 2065  he thresholded e
-00001c70: 6467 652c 2068 6f77 6576 6572 2074 6869  dge, however thi
-00001c80: 7320 6973 2062 726f 6b65 6e20 616e 640a  s is broken and.
-00001c90: 2020 2020 6469 7363 6f6e 7469 6e75 6f75      discontinuou
-00001ca0: 7320 616e 6420 6e6f 6e2d 756e 6966 6f72  s and non-unifor
-00001cb0: 6d20 696e 2076 616c 7565 2e20 546f 2066  m in value. To f
-00001cc0: 6978 2074 6861 7420 7275 6e3a 0a0a 2020  ix that run:..  
-00001cd0: 2020 3e3e 3e20 696d 5f63 616e 6e79 2e65    >>> im_canny.e
-00001ce0: 6467 655f 7468 7265 7368 6f6c 6469 6e67  dge_thresholding
-00001cf0: 0a0a 2020 2020 4166 7465 7220 7468 6174  ..    After that
-00001d00: 2c20 6765 6e65 7261 7465 2074 6865 2066  , generate the f
-00001d10: 696e 616c 2063 616e 6e79 2065 6467 6520  inal canny edge 
-00001d20: 6173 3a0a 0a20 2020 203e 3e3e 2063 616e  as:..    >>> can
-00001d30: 6e79 5f69 6d61 6765 203d 2069 6d5f 6361  ny_image = im_ca
-00001d40: 6e6e 792e 6564 6765 5f6a 6f69 6e69 6e67  nny.edge_joining
-00001d50: 2829 0a0a 2020 2020 5265 6665 7265 6e63  ()..    Referenc
-00001d60: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  es.    ---------
-00001d70: 2d0a 2020 2020 2e2e 205b 345d 204a 6f68  -.    .. [4] Joh
-00001d80: 6e20 4361 6e6e 792c 2022 4120 636f 6d70  n Canny, "A comp
-00001d90: 7574 6174 696f 6e61 6c20 6170 7072 6f61  utational approa
-00001da0: 6368 2074 6f20 6564 6765 2064 6574 6563  ch to edge detec
-00001db0: 7469 6f6e 2e22 0a20 2020 2020 2020 5265  tion.".       Re
-00001dc0: 6164 696e 6773 2069 6e20 636f 6d70 7574  adings in comput
-00001dd0: 6572 2076 6973 696f 6e2e 204d 6f72 6761  er vision. Morga
-00001de0: 6e20 4b61 7566 6d61 6e6e 2c20 3139 3837  n Kaufmann, 1987
-00001df0: 2e20 3138 342d 3230 330a 2020 2020 54e9  . 184-203.    T.
-00001e00: 0500 0000 6306 0000 0000 0000 0000 0000  ....c...........
-00001e10: 0006 0000 0006 0000 0043 0000 0073 8200  .........C...s..
-00001e20: 0000 7c01 7c00 5f00 7401 a002 7c01 6a03  ..|.|._.t...|.j.
-00001e30: a101 a004 7405 a101 7c00 5f06 7c02 7c00  ....t...|._.|.|.
-00001e40: 5f07 7c03 7c00 5f08 7409 6a0a a00b 740c  _.|.|._.t.j...t.
-00001e50: a00d 7c01 7c05 a102 a101 7c00 5f0e 7401  ..|.|.....|._.t.
-00001e60: a00f 7c01 a101 7c00 5f10 7401 a00f 7c01  ..|...|._.t...|.
-00001e70: a101 7c00 5f11 7401 a00f 7c01 a101 7c00  ..|._.t...|...|.
-00001e80: 5f12 7401 a00f 7c01 a101 7c00 5f13 6401  _.t...|...|._.d.
-00001e90: 7c00 5f14 6401 7c00 5f15 7c04 7c00 5f16  |._.d.|._.|.|._.
-00001ea0: 6400 5300 2902 4e46 2917 da05 696d 6167  d.S.).NF)...imag
-00001eb0: 6572 1700 0000 7219 0000 0072 2100 0000  er....r....r!...
-00001ec0: 7216 0000 0072 2200 0000 da07 696d 5f73  r....r".....im_s
-00001ed0: 697a 65da 0c74 6872 6573 685f 6c6f 7765  ize..thresh_lowe
-00001ee0: 72da 0c74 6872 6573 685f 7570 7065 72da  r..thresh_upper.
-00001ef0: 0273 74da 0475 7469 6c5a 1069 6d61 6765  .st..utilZ.image
-00001f00: 5f6e 6f72 6d61 6c69 7a65 72da 0473 636e  _normalizer..scn
-00001f10: 645a 0f67 6175 7373 6961 6e5f 6669 6c74  dZ.gaussian_filt
-00001f20: 6572 da06 696d 626c 7572 5a0a 656d 7074  er..imblurZ.empt
-00001f30: 795f 6c69 6b65 da09 736f 6265 6c5f 6d61  y_like..sobel_ma
-00001f40: 67da 0973 6f62 656c 5f61 6e67 da08 7265  g..sobel_ang..re
-00001f50: 7369 6475 616c da09 6361 6e6e 7945 6467  sidual..cannyEdg
-00001f60: 65da 0a65 6467 655f 6368 6563 6bda 0c74  e..edge_check..t
-00001f70: 6872 6573 685f 6368 6563 6bda 0a70 6c6f  hresh_check..plo
-00001f80: 745f 7374 6570 7329 06da 0473 656c 6672  t_steps)...selfr
-00001f90: 3d00 0000 5a0c 6c6f 7754 6872 6573 686f  =...Z.lowThresho
-00001fa0: 6c64 5a0d 6869 6768 5468 7265 7368 6f6c  ldZ.highThreshol
-00001fb0: 6472 4b00 0000 5a07 626c 7572 5661 6c72  drK...Z.blurValr
-00001fc0: 1e00 0000 721e 0000 0072 1f00 0000 da08  ....r....r......
-00001fd0: 5f5f 696e 6974 5f5f 1c01 0000 7318 0000  __init__....s...
-00001fe0: 0000 0106 0114 0106 0106 0116 010c 010c  ................
-00001ff0: 010c 010c 0106 0106 017a 0e43 616e 6e79  .........z.Canny
-00002000: 2e5f 5f69 6e69 745f 5f63 0100 0000 0000  .__init__c......
-00002010: 0000 0000 0000 0400 0000 0600 0000 4300  ..............C.
-00002020: 0000 7306 0100 0074 006a 016a 027c 006a  ..s....t.j.j.|.j
-00002030: 0364 0164 028d 025c 027c 005f 047c 005f  .d.d...\.|._.|._
-00002040: 057c 006a 0564 0374 066a 071b 0014 007c  .|.j.d.t.j.....|
-00002050: 005f 057c 006a 057c 006a 0564 046b 0005  ._.|.j.|.j.d.k..
-00002060: 0019 0064 0337 0003 003c 0074 066a 0864  ...d.7...<.t.j.d
-00002070: 057c 006a 0964 0419 0064 0518 0085 0264  .|.j.d...d.....d
-00002080: 057c 006a 0964 0519 0064 0518 0085 0266  .|.j.d...d.....f
-00002090: 0219 005c 027d 017d 0274 06a0 0a74 06a0  ...\.}.}.t...t..
-000020a0: 0b7c 01a1 0174 06a0 0b7c 02a1 0166 02a1  .|...t...|...f..
-000020b0: 01a0 0ca1 007d 0374 0d7c 037c 006a 047c  .....}.t.|.|.j.|
-000020c0: 006a 0583 037c 005f 0e7c 006a 0f72 fc74  .j...|._.|.j.r.t
-000020d0: 106a 1164 0664 078d 0101 0074 10a0 1264  .j.d.d.....t...d
-000020e0: 0564 0864 05a1 0301 0074 10a0 137c 006a  .d.d.....t...|.j
-000020f0: 04a1 0101 0074 10a0 1464 09a1 0101 0074  .....t...d.....t
-00002100: 10a0 1264 0564 0864 08a1 0301 0074 10a0  ...d.d.d.....t..
-00002110: 137c 006a 0ea1 0101 0074 10a0 1464 09a1  .|.j.....t...d..
-00002120: 0101 0064 0a7c 005f 1564 0b53 0029 0c61  ...d.|._.d.S.).a
-00002130: 2c01 0000 0a20 2020 2020 2020 2054 6869  ,....        Thi
-00002140: 6e6e 696e 6720 536f 6265 6c20 4669 6c74  nning Sobel Filt
-00002150: 6572 6564 2045 6467 6573 0a0a 2020 2020  ered Edges..    
-00002160: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
-00002170: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
-00002180: 5765 2075 7365 2074 6865 2064 6972 6563  We use the direc
-00002190: 7469 6f6e 206f 6620 7468 6520 536f 6265  tion of the Sobe
-000021a0: 6c20 6772 6164 6965 6e74 2074 6f0a 2020  l gradient to.  
-000021b0: 2020 2020 2020 6465 7465 726d 696e 6520        determine 
-000021c0: 7768 6574 6865 7220 6120 7069 7865 6c20  whether a pixel 
-000021d0: 6265 6c6f 6e67 7320 746f 2074 6865 2065  belongs to the e
-000021e0: 6467 650a 2020 2020 2020 2020 6f72 206e  dge.        or n
-000021f0: 6f74 2e20 4966 2074 6865 2067 7261 6469  ot. If the gradi
-00002200: 656e 7420 6973 2070 6572 7065 6e64 6963  ent is perpendic
-00002210: 756c 6172 2074 6f20 7468 650a 2020 2020  ular to the.    
-00002220: 2020 2020 7069 7865 6c73 2074 6865 6e20      pixels then 
-00002230: 6974 2069 7320 616e 2065 6467 6520 7069  it is an edge pi
-00002240: 7865 6c20 6f72 2065 6c73 6520 6974 2069  xel or else it i
-00002250: 7320 6e6f 742e 0a0a 2020 2020 2020 2020  s not...        
-00002260: 723c 0000 0029 0172 1b00 0000 722c 0000  r<...).r....r,..
-00002270: 0072 0100 0000 7205 0000 0029 02e9 1400  .r....r....)....
-00002280: 0000 e90a 0000 00a9 015a 0766 6967 7369  .........Z.figsi
-00002290: 7a65 7207 0000 00da 036f 6666 544e 2916  zer......offTN).
-000022a0: 7241 0000 0072 4200 0000 7220 0000 0072  rA...rB...r ...r
-000022b0: 4400 0000 7245 0000 0072 4600 0000 7217  D...rE...rF...r.
-000022c0: 0000 00da 0270 6972 2300 0000 723e 0000  .....pir#...r>..
-000022d0: 0072 1900 0000 da05 7261 7665 6cda 0974  .r......ravel..t
-000022e0: 7261 6e73 706f 7365 7236 0000 00da 0974  ransposer6.....t
-000022f0: 6869 6e5f 6564 6765 724b 0000 00da 0370  hin_edgerK.....p
-00002300: 6c74 da06 6669 6775 7265 5a07 7375 6270  lt..figureZ.subp
-00002310: 6c6f 74da 0669 6d73 686f 77da 0461 7869  lot..imshow..axi
-00002320: 7372 4900 0000 2904 724c 0000 00da 0679  srI...).rL.....y
-00002330: 5261 6e67 65da 0678 5261 6e67 655a 0874  Range..xRangeZ.t
-00002340: 6869 6e5f 706f 7372 1e00 0000 721e 0000  hin_posr....r...
-00002350: 0072 1f00 0000 da0d 6564 6765 5f74 6869  .r......edge_thi
-00002360: 6e6e 696e 672a 0100 0073 1e00 0000 000c  nning*...s......
-00002370: 1a01 1201 1801 2e01 1e02 1201 0601 0c01  ................
-00002380: 0e01 0c01 0a01 0e01 0c01 0a01 7a13 4361  ............z.Ca
-00002390: 6e6e 792e 6564 6765 5f74 6869 6e6e 696e  nny.edge_thinnin
-000023a0: 6763 0100 0000 0000 0000 0000 0000 0300  gc..............
-000023b0: 0000 0700 0000 4300 0000 73a6 0000 007c  ......C...s....|
-000023c0: 006a 0073 0e74 0164 0183 0182 0174 02a0  .j.s.t.d.....t..
-000023d0: 037c 006a 04a1 017c 006a 0514 007d 017c  .|.j...|.j...}.|
-000023e0: 017c 006a 0614 007d 027c 017c 006a 0774  .|.j...}.|.|.j.t
-000023f0: 02a0 087c 006a 047c 016b 04a1 013c 007c  ...|.j.|.k...<.|
-00002400: 027c 006a 0774 02a0 087c 006a 047c 016b  .|.j.t...|.j.|.k
-00002410: 017c 006a 047c 026b 0440 00a1 013c 007c  .|.j.|.k.@...<.|
-00002420: 006a 057c 006a 077c 006a 077c 006a 056b  .j.|.j.|.j.|.j.k
-00002430: 043c 007c 006a 0972 9c74 0a6a 0b64 0264  .<.|.j.r.t.j.d.d
-00002440: 038d 0101 0074 0aa0 0c7c 006a 07a1 0101  .....t...|.j....
-00002450: 0074 0aa0 0d64 04a1 0101 0064 057c 005f  .t...d.....d.|._
-00002460: 0e64 0653 0029 0761 8801 0000 0a20 2020  .d.S.).a.....   
-00002470: 2020 2020 2054 6872 6573 686f 6c64 696e       Thresholdin
-00002480: 6720 6f66 2045 6467 6573 0a0a 2020 2020  g of Edges..    
-00002490: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
-000024a0: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
-000024b0: 536f 7274 2065 6467 6573 206d 6561 7375  Sort edges measu
-000024c0: 7265 6420 6173 2065 6974 6865 7220 7374  red as either st
-000024d0: 726f 6e67 2065 6467 6573 206f 7220 7765  rong edges or we
-000024e0: 616b 2065 6467 6573 2c0a 2020 2020 2020  ak edges,.      
-000024f0: 2020 6465 7065 6e64 696e 6720 6f6e 2074    depending on t
-00002500: 6865 2069 6e74 656e 7369 7479 206f 6620  he intensity of 
-00002510: 7468 6520 6564 6765 2e20 5468 6520 7468  the edge. The th
-00002520: 7265 7368 6f6c 6473 2061 7265 0a20 2020  resholds are.   
-00002530: 2020 2020 2075 7365 7220 6465 6669 6e65       user define
-00002540: 6420 7061 7261 6d65 7465 7273 2061 6e64  d parameters and
-00002550: 2077 6869 6c65 2074 6865 7920 6361 6e20   while they can 
-00002560: 6265 2070 6c61 7965 6420 6172 6f75 6e64  be played around
-00002570: 0a20 2020 2020 2020 2077 6974 6820 6974  .        with it
-00002580: 2069 7320 7265 636f 6d6d 656e 6465 6420   is recommended 
-00002590: 746f 2075 7365 2061 2074 6872 6573 686f  to use a thresho
-000025a0: 6c64 696e 6720 616c 676f 7269 7468 6d20  lding algorithm 
-000025b0: 6c69 6b65 0a20 2020 2020 2020 204f 7473  like.        Ots
-000025c0: 7520 7468 7265 7368 6f6c 6469 6e67 2074  u thresholding t
-000025d0: 6f20 726f 6275 7374 6c79 2064 6574 6572  o robustly deter
-000025e0: 6d69 6e65 2065 6467 6573 2e0a 2020 2020  mine edges..    
-000025f0: 2020 2020 7a36 506c 6561 7365 2074 6869      z6Please thi
-00002600: 6e20 7468 6520 6564 6765 7320 6669 7273  n the edges firs
-00002610: 7420 6279 2063 616c 6c69 6e67 2065 6467  t by calling edg
-00002620: 655f 7468 696e 6e69 6e67 2829 a902 724f  e_thinning()..rO
-00002630: 0000 0072 4f00 0000 7250 0000 0072 5100  ...rO...rP...rQ.
-00002640: 0000 544e 290f 7249 0000 00da 0c52 756e  ..TN).rI.....Run
-00002650: 7469 6d65 4572 726f 7272 1700 0000 da04  timeErrorr......
-00002660: 616d 6178 7255 0000 0072 4000 0000 723f  amaxrU...r@...r?
-00002670: 0000 0072 4700 0000 da05 7768 6572 6572  ...rG.....wherer
-00002680: 4b00 0000 7256 0000 0072 5700 0000 7258  K...rV...rW...rX
-00002690: 0000 0072 5900 0000 724a 0000 0029 0372  ...rY...rJ...).r
-000026a0: 4c00 0000 5a05 6869 6768 545a 046c 6f77  L...Z.highTZ.low
-000026b0: 5472 1e00 0000 721e 0000 0072 1f00 0000  Tr....r....r....
-000026c0: da11 6564 6765 5f74 6872 6573 686f 6c64  ..edge_threshold
-000026d0: 696e 6747 0100 0073 1e00 0000 000c 0601  ingG...s........
-000026e0: 0801 1201 0a01 1603 02fe 0401 18ff 0203  ................
-000026f0: 1401 0601 0c01 0c01 0a01 7a17 4361 6e6e  ..........z.Cann
-00002700: 792e 6564 6765 5f74 6872 6573 686f 6c64  y.edge_threshold
-00002710: 696e 6763 0100 0000 0000 0000 0000 0000  ingc............
-00002720: 0400 0000 0600 0000 4300 0000 73e4 0000  ........C...s...
-00002730: 007c 006a 0073 0e74 0164 0183 0182 0174  .|.j.s.t.d.....t
-00002740: 026a 0364 027c 006a 0464 0319 0064 0218  .j.d.|.j.d...d..
-00002750: 0085 0264 027c 006a 0464 0219 0064 0218  ...d.|.j.d...d..
-00002760: 0085 0266 0219 005c 027d 017d 0274 02a0  ...f...\.}.}.t..
-00002770: 0574 02a0 067c 01a1 0174 02a0 067c 02a1  .t...|...t...|..
-00002780: 0166 02a1 01a0 07a1 007d 0374 02a0 087c  .f.......}.t...|
-00002790: 006a 09a1 017c 005f 0a74 0b6a 0ca0 0d7c  .j...|._.t.j...|
-000027a0: 037c 006a 0a7c 006a 0e7c 006a 0fa1 047c  .|.j.|.j.|.j...|
-000027b0: 005f 0a74 0b6a 0ca0 0d7c 037c 006a 0a7c  ._.t.j...|.|.j.|
-000027c0: 006a 0e7c 006a 0fa1 047c 005f 0a7c 006a  .j.|.j...|._.|.j
-000027d0: 1072 c474 116a 1264 0464 058d 0101 0074  .r.t.j.d.d.....t
-000027e0: 11a0 137c 006a 0aa1 0101 0074 11a0 1464  ...|.j.....t...d
-000027f0: 06a1 0101 007c 006a 0a74 02a0 157c 006a  .....|.j.t...|.j
-00002800: 0aa1 011b 00a0 1674 17a1 017c 005f 0a7c  .......t...|._.|
-00002810: 006a 0a53 0029 0761 5c02 0000 0a20 2020  .j.S.).a\....   
-00002820: 2020 2020 204a 6f69 6e69 6e67 206f 6620       Joining of 
-00002830: 4564 6765 730a 0a20 2020 2020 2020 2052  Edges..        R
-00002840: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00002850: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
-00002860: 616e 6e79 4564 6765 3a20 626f 6f6c 6561  annyEdge: boolea
-00002870: 6e20 6172 7261 790a 2020 2020 2020 2020  n array.        
-00002880: 2020 2020 2020 2020 2020 2042 6f6f 6c65             Boole
-00002890: 616e 206d 6174 7269 7820 7769 7468 2074  an matrix with t
-000028a0: 6865 2073 616d 6520 7369 7a65 2061 7320  he same size as 
-000028b0: 7468 6520 6f72 6967 696e 616c 0a20 2020  the original.   
-000028c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028d0: 696d 6167 652c 2077 6865 7265 2074 6865  image, where the
-000028e0: 2065 6467 6573 2061 7265 2031 2c20 7768   edges are 1, wh
-000028f0: 696c 6520 7468 6520 7265 7374 2069 7320  ile the rest is 
-00002900: 300a 0a20 2020 2020 2020 204e 6f74 6573  0..        Notes
-00002910: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
-00002920: 2020 2020 2020 2054 6865 2069 6e70 7574         The input
-00002930: 2069 6d61 6765 206e 6f77 2063 6f6e 7369   image now consi
-00002940: 7374 7320 6f66 2073 7472 6f6e 6720 616e  sts of strong an
-00002950: 6420 7765 616b 0a20 2020 2020 2020 2074  d weak.        t
-00002960: 6872 6573 686f 6c64 732e 2054 6865 2066  hresholds. The f
-00002970: 696e 616c 2073 7465 7020 6f66 2074 6865  inal step of the
-00002980: 2061 6c67 6f72 6974 686d 2069 7320 746f   algorithm is to
-00002990: 0a20 2020 2020 2020 206c 6f6f 6b20 6174  .        look at
-000029a0: 2073 6f6d 6520 6f66 2074 6865 206d 6561   some of the mea
-000029b0: 7375 7265 6420 6564 6765 7320 616e 6420  sured edges and 
-000029c0: 6a6f 696e 2f6c 696e 6b20 7468 656d 2e0a  join/link them..
-000029d0: 2020 2020 2020 2020 5468 6520 6964 6561          The idea
-000029e0: 2069 7320 7468 6174 2069 6620 6120 6564   is that if a ed
-000029f0: 6765 2070 6978 656c 2069 7320 636c 6173  ge pixel is clas
-00002a00: 7369 6669 6564 2061 7320 610a 2020 2020  sified as a.    
-00002a10: 2020 2020 7765 616b 2065 6467 6520 6275      weak edge bu
-00002a20: 7420 6f6e 6520 6f66 2069 7473 206e 6569  t one of its nei
-00002a30: 6768 626f 7273 2069 7320 6120 7374 726f  ghbors is a stro
-00002a40: 6e67 2065 6467 6520 7468 656e 0a20 2020  ng edge then.   
-00002a50: 2020 2020 2069 7420 6973 2061 2073 7472       it is a str
-00002a60: 6f6e 6720 6564 6765 2070 6978 656c 2e0a  ong edge pixel..
-00002a70: 2020 2020 2020 2020 7a3d 506c 6561 7365          z=Please
-00002a80: 2074 6872 6573 686f 6c64 2074 6865 2065   threshold the e
-00002a90: 6467 6573 2066 6972 7374 2062 7920 6361  dges first by ca
-00002aa0: 6c6c 696e 6720 6361 6e6e 795f 7468 7265  lling canny_thre
-00002ab0: 7368 6f6c 6428 2972 0500 0000 7201 0000  shold()r....r...
-00002ac0: 0072 5d00 0000 7250 0000 0072 5100 0000  .r]...rP...rQ...
-00002ad0: 2918 724a 0000 0072 5e00 0000 7217 0000  ).rJ...r^...r...
-00002ae0: 0072 2300 0000 723e 0000 0072 1900 0000  .r#...r>...r....
-00002af0: 7253 0000 0072 5400 0000 7237 0000 0072  rS...rT...r7...r
-00002b00: 4700 0000 7248 0000 0072 4100 0000 7242  G...rH...rA...rB
-00002b10: 0000 0072 3a00 0000 7240 0000 0072 3f00  ...r:...r@...r?.
-00002b20: 0000 724b 0000 0072 5600 0000 7257 0000  ..rK...rV...rW..
-00002b30: 0072 5800 0000 7259 0000 0072 5f00 0000  .rX...rY...r_...
-00002b40: 7216 0000 00da 0462 6f6f 6c29 0472 4c00  r......bool).rL.
-00002b50: 0000 725a 0000 0072 5b00 0000 5a08 6564  ..rZ...r[...Z.ed
-00002b60: 6765 5f70 6f73 721e 0000 0072 1e00 0000  ge_posr....r....
-00002b70: 721f 0000 00da 0c65 6467 655f 6a6f 696e  r......edge_join
-00002b80: 696e 6762 0100 0073 1e00 0000 0013 0601  ingb...s........
-00002b90: 0201 02ff 0403 2e01 1e01 0e03 1a01 1a01  ................
-00002ba0: 0601 0c01 0c01 0a01 1a01 7a12 4361 6e6e  ..........z.Cann
-00002bb0: 792e 6564 6765 5f6a 6f69 6e69 6e67 4e29  y.edge_joiningN)
-00002bc0: 0254 723c 0000 0029 08da 085f 5f6e 616d  .Tr<...)...__nam
-00002bd0: 655f 5fda 0a5f 5f6d 6f64 756c 655f 5fda  e__..__module__.
-00002be0: 0c5f 5f71 7561 6c6e 616d 655f 5fda 075f  .__qualname__.._
-00002bf0: 5f64 6f63 5f5f 724d 0000 0072 5c00 0000  _doc__rM...r\...
-00002c00: 7261 0000 0072 6300 0000 721e 0000 0072  ra...rc...r....r
-00002c10: 1e00 0000 721e 0000 0072 1f00 0000 723b  ....r....r....r;
-00002c20: 0000 00e6 0000 0073 0a00 0000 0801 0435  .......s.......5
-00002c30: 0a0e 081d 081b 723b 0000 0029 0172 0200  ......r;...).r..
-00002c40: 0000 2915 5a05 6e75 6d70 7972 1700 0000  ..).Z.numpyr....
-00002c50: da08 7761 726e 696e 6773 5a0c 7363 6970  ..warningsZ.scip
-00002c60: 792e 7369 676e 616c da06 7369 676e 616c  y.signal..signal
-00002c70: 721a 0000 005a 0d73 6369 7079 2e6e 6469  r....Z.scipy.ndi
-00002c80: 6d61 6765 5a07 6e64 696d 6167 6572 4300  mageZ.ndimagerC.
-00002c90: 0000 da08 7374 656d 746f 6f6c 7241 0000  ....stemtoolrA..
-00002ca0: 005a 116d 6174 706c 6f74 6c69 622e 7079  .Z.matplotlib.py
-00002cb0: 706c 6f74 5a06 7079 706c 6f74 7256 0000  plotZ.pyplotrV..
-00002cc0: 00da 046d 6174 6872 2000 0000 722b 0000  ...mathr ...r+..
-00002cd0: 0072 3600 0000 723a 0000 00da 066f 626a  .r6...r:.....obj
-00002ce0: 6563 7472 3b00 0000 721e 0000 0072 1e00  ectr;...r....r..
-00002cf0: 0000 721e 0000 0072 1f00 0000 da08 3c6d  ..r....r......<m
-00002d00: 6f64 756c 653e 0100 0000 7316 0000 0008  odule>....s.....
-00002d10: 0108 010c 010c 0108 010c 0108 030a 4308  ..............C.
-00002d20: 3d08 3108 2b                             =.1.+
+00000020: 0004 0000 0040 0000 0073 6a00 0000 6400  .....@...sj...d.
+00000030: 6401 6c00 5a01 6400 6401 6c02 6d03 5a04  d.l.Z.d.d.l.m.Z.
+00000040: 0100 6400 6401 6c05 6d06 5a07 0100 6400  ..d.d.l.m.Z...d.
+00000050: 6401 6c08 5a09 6400 6401 6c0a 6d0b 5a0c  d.l.Z.d.d.l.m.Z.
+00000060: 0100 640d 6403 6404 8401 5a0d 6405 6406  ..d.d.d...Z.d.d.
+00000070: 8400 5a0e 6407 6408 8400 5a0f 6409 640a  ..Z.d.d...Z.d.d.
+00000080: 8400 5a10 4700 640b 640c 8400 640c 6511  ..Z.G.d.d...d.e.
+00000090: 8303 5a12 6401 5300 290e e900 0000 004e  ..Z.d.S.)......N
+000000a0: e903 0000 0063 0200 0000 0000 0000 0000  .....c..........
+000000b0: 0000 0800 0000 0700 0000 4300 0000 73a6  ..........C...s.
+000000c0: 0000 007c 00a0 0074 016a 02a1 017d 007c  ...|...t.j...}.|
+000000d0: 0164 016b 0272 1b74 016a 0364 0274 016a  .d.k.r.t.j.d.t.j
+000000e0: 0264 038d 027d 0274 016a 0364 0474 016a  .d...}.t.j.d.t.j
+000000f0: 0264 038d 027d 036e 1074 016a 0364 0574  .d...}.n.t.j.d.t
+00000100: 016a 0264 038d 027d 0274 016a 0364 0674  .j.d...}.t.j.d.t
+00000110: 016a 0264 038d 027d 0374 046a 057c 007c  .j.d...}.t.j.|.|
+00000120: 0264 0764 0864 0964 0a8d 057d 0474 046a  .d.d.d.d...}.t.j
+00000130: 057c 007c 0364 0764 0864 0964 0a8d 057d  .|.|.d.d.d.d...}
+00000140: 057c 0464 0b13 007c 0564 0b13 0017 0064  .|.d...|.d.....d
+00000150: 0c13 007d 0674 01a0 067c 057c 04a1 027d  ...}.t...|.|...}
+00000160: 077c 067c 0766 0253 0029 0d61 9103 0000  .|.|.f.S.).a....
+00000170: 0a20 2020 2053 6f62 656c 2046 696c 7465  .    Sobel Filte
+00000180: 7220 616e 2049 6e70 7574 2049 6d61 6765  r an Input Image
+00000190: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000001a0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000001b0: 2020 2020 696d 3a20 2020 206e 6461 7272      im:    ndarr
+000001c0: 6179 0a20 2020 2020 2020 2020 2020 7468  ay.           th
+000001d0: 6520 6f72 6967 696e 616c 2069 6e70 7574  e original input
+000001e0: 2069 6d61 6765 2074 6f20 6265 2066 696c   image to be fil
+000001f0: 7465 7265 640a 2020 2020 6f72 6465 723a  tered.    order:
+00000200: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00000210: 3320 6973 2074 6865 2064 6566 6175 6c74  3 is the default
+00000220: 2062 7574 2069 6620 3520 6973 2073 7065   but if 5 is spe
+00000230: 6369 6669 6564 0a20 2020 2020 2020 2020  cified.         
+00000240: 2020 7468 656e 2061 2035 7835 2053 6f62    then a 5x5 Sob
+00000250: 656c 2066 696c 7465 7220 6973 2072 756e  el filter is run
+00000260: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00000270: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6d61    -------.    ma
+00000280: 673a 206e 6461 7272 6179 0a20 2020 2020  g: ndarray.     
+00000290: 2020 2020 536f 6265 6c20 4669 6c74 6572      Sobel Filter
+000002a0: 204d 6167 6e69 7475 6465 0a20 2020 2061   Magnitude.    a
+000002b0: 6e64 3a20 6e64 6172 7261 790a 2020 2020  nd: ndarray.    
+000002c0: 2020 2020 2053 6f62 656c 2046 696c 7465       Sobel Filte
+000002d0: 7220 416e 676c 650a 0a20 2020 204e 6f74  r Angle..    Not
+000002e0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+000002f0: 2057 6520 6465 6669 6e65 2074 6865 2074   We define the t
+00000300: 776f 2064 6966 6665 7265 6e74 6961 7469  wo differentiati
+00000310: 6f6e 206d 6174 7269 6365 7320 2d20 675f  on matrices - g_
+00000320: 7820 616e 6420 675f 790a 2020 2020 616e  x and g_y.    an
+00000330: 6420 7468 656e 206d 6f76 6520 616c 6f6e  d then move alon
+00000340: 6720 6f75 7220 6461 7461 7365 7420 2d20  g our dataset - 
+00000350: 746f 2070 6572 666f 726d 2074 6865 206d  to perform the m
+00000360: 6174 7269 780a 2020 2020 6f70 6572 6174  atrix.    operat
+00000370: 696f 6e73 206f 6e20 3578 3520 6f72 2033  ions on 5x5 or 3
+00000380: 7833 2073 6563 7469 6f6e 7320 6f66 2074  x3 sections of t
+00000390: 6865 2069 6e70 7574 2069 6d61 6765 2e20  he input image. 
+000003a0: 5468 650a 2020 2020 6d61 676e 6974 7564  The.    magnitud
+000003b0: 6520 6f66 2074 6865 2053 6f62 656c 2066  e of the Sobel f
+000003c0: 696c 7465 7265 6420 696d 6167 6520 6973  iltered image is
+000003d0: 2074 6865 2061 6273 6f6c 7574 650a 2020   the absolute.  
+000003e0: 2020 6f66 2074 6865 206d 756c 7469 706c    of the multipl
+000003f0: 6965 6420 6d61 7472 6963 6573 202d 2073  ied matrices - s
+00000400: 7175 6172 6564 2061 6e64 2073 756d 6d65  quared and summe
+00000410: 6420 616e 6420 7371 7561 7265 0a20 2020  d and square.   
+00000420: 2072 6f6f 7465 642e 0a0a 2020 2020 5265   rooted...    Re
+00000430: 6665 7265 6e63 6573 0a20 2020 202d 2d2d  ferences.    ---
+00000440: 2d2d 2d2d 2d2d 2d0a 2020 2020 2e2e 205b  -------.    .. [
+00000450: 335d 2053 6f62 656c 2c20 492e 2061 6e64  3] Sobel, I. and
+00000460: 2046 656c 646d 616e 2c20 472e 2c20 3139   Feldman, G., 19
+00000470: 3638 2e20 4120 3378 3320 6973 6f74 726f  68. A 3x3 isotro
+00000480: 7069 6320 6772 6164 6965 6e74 0a20 2020  pic gradient.   
+00000490: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
+000004a0: 2066 6f72 2069 6d61 6765 2070 726f 6365   for image proce
+000004b0: 7373 696e 672e 2061 2074 616c 6b20 6174  ssing. a talk at
+000004c0: 2074 6865 2053 7461 6e66 6f72 640a 2020   the Stanford.  
+000004d0: 2020 2020 2020 2020 2041 7274 6966 6963           Artific
+000004e0: 6961 6c20 5072 6f6a 6563 7420 696e 2c20  ial Project in, 
+000004f0: 7070 2e32 3731 2d32 3732 2e0a 0a20 2020  pp.271-272...   
+00000500: 2072 0200 0000 2903 a903 e9ff ffff ff72   r....)........r
+00000510: 0100 0000 e901 0000 0029 03e9 feff ffff  .........)......
+00000520: 7201 0000 00e9 0200 0000 7203 0000 00a9  r.........r.....
+00000530: 015a 0564 7479 7065 2903 2903 7204 0000  .Z.dtype).).r...
+00000540: 0072 0600 0000 7204 0000 0029 0372 0100  .r....r....).r..
+00000550: 0000 7201 0000 0072 0100 0000 2903 7205  ..r....r....).r.
+00000560: 0000 0072 0700 0000 7205 0000 0029 05a9  ...r....r....)..
+00000570: 0572 0400 0000 7206 0000 0072 0100 0000  .r....r....r....
+00000580: 7207 0000 0072 0500 0000 a905 e9fc ffff  r....r..........
+00000590: ffe9 f8ff ffff 7201 0000 00e9 0800 0000  ......r.........
+000005a0: e904 0000 0029 05e9 faff ffff e9f4 ffff  .....)..........
+000005b0: ff72 0100 0000 e90c 0000 00e9 0600 0000  .r..............
+000005c0: 720a 0000 0072 0900 0000 2905 2905 7205  r....r....).).r.
+000005d0: 0000 0072 0e00 0000 7212 0000 0072 0e00  ...r....r....r..
+000005e0: 0000 7205 0000 0029 0572 0700 0000 720d  ..r....).r....r.
+000005f0: 0000 0072 1100 0000 720d 0000 0072 0700  ...r....r....r..
+00000600: 0000 2905 7201 0000 0072 0100 0000 7201  ..).r....r....r.
+00000610: 0000 0072 0100 0000 7201 0000 0029 0572  ...r....r....).r
+00000620: 0600 0000 720c 0000 0072 1000 0000 720c  ....r....r....r.
+00000630: 0000 0072 0600 0000 2905 7204 0000 0072  ...r....).r....r
+00000640: 0b00 0000 720f 0000 0072 0b00 0000 7204  ....r....r....r.
+00000650: 0000 005a 0473 616d 655a 0473 796d 6d72  ...Z.sameZ.symmr
+00000660: 0100 0000 2903 da04 6d6f 6465 da08 626f  ....)...mode..bo
+00000670: 756e 6461 7279 da09 6669 6c6c 7661 6c75  undary..fillvalu
+00000680: 6572 0700 0000 6700 0000 0000 00e0 3f29  er....g.......?)
+00000690: 07da 0661 7374 7970 65da 026e 70da 0766  ...astype..np..f
+000006a0: 6c6f 6174 3634 da07 6173 6172 7261 79da  loat64..asarray.
+000006b0: 0673 6369 7369 675a 0a63 6f6e 766f 6c76  .scisigZ.convolv
+000006c0: 6532 645a 0761 7263 7461 6e32 2908 5a02  e2dZ.arctan2).Z.
+000006d0: 696d da05 6f72 6465 725a 036b 5f78 5a03  im..orderZ.k_xZ.
+000006e0: 6b5f 795a 0367 5f78 5a03 675f 79da 036d  k_yZ.g_xZ.g_y..m
+000006f0: 6167 da03 616e 67a9 0072 1e00 0000 fa39  ag..ang..r.....9
+00000700: 6275 696c 642f 6264 6973 742e 6c69 6e75  build/bdist.linu
+00000710: 782d 7838 365f 3634 2f65 6767 2f73 7465  x-x86_64/egg/ste
+00000720: 6d74 6f6f 6c2f 7574 696c 2f73 6f62 656c  mtool/util/sobel
+00000730: 5f63 616e 6e79 2e70 79da 0573 6f62 656c  _canny.py..sobel
+00000740: 0800 0000 7322 0000 000c 2308 0110 0112  ....s"....#.....
+00000750: 0104 0202 0104 0706 f804 0a02 0104 0706  ................
+00000760: f814 0a14 0114 010c 0108 0172 2000 0000  ...........r ...
+00000770: 6301 0000 0000 0000 0000 0000 0019 0000  c...............
+00000780: 0005 0000 0043 0000 0073 7201 0000 7400  .....C...sr...t.
+00000790: a001 7400 a002 7c00 a101 a101 a003 7404  ..t...|.......t.
+000007a0: a101 7d01 7400 6a05 6401 7c01 6401 1900  ..}.t.j.d.|.d...
+000007b0: 8502 6401 7c01 6402 1900 8502 6602 1900  ..d.|.d.....f...
+000007c0: 5c02 7d02 7d03 7400 6a01 7c03 7c00 1900  \.}.}.t.j.|.|...
+000007d0: 7400 6a06 6403 8d02 7d04 7400 6a01 7c02  t.j.d...}.t.j.|.
+000007e0: 7c00 1900 7400 6a06 6403 8d02 7d05 7400  |...t.j.d...}.t.
+000007f0: a007 7c04 a101 7d06 7400 a007 7c05 a101  ..|...}.t...|...
+00000800: 7d07 7c04 7c06 1800 7d08 7c05 7c07 1800  }.|.|...}.|.|...
+00000810: 7d09 7400 a008 7c08 7c09 1400 a101 7d0a  }.t...|.|.....}.
+00000820: 7400 a008 7c08 6404 1300 a101 7d0b 7400  t...|.d.....}.t.
+00000830: a008 7c09 6404 1300 a101 7d0c 7400 a008  ..|.d.....}.t...
+00000840: 7c08 6404 1300 7c09 1400 a101 7d0d 7400  |.d...|.....}.t.
+00000850: a008 7c08 7c09 6404 1300 1400 a101 7d0e  ..|.|.d.......}.
+00000860: 7400 a008 7c08 6405 1300 a101 7d0f 7400  t...|.d.....}.t.
+00000870: a008 7c09 6405 1300 a101 7d10 7400 a009  ..|.d.....}.t...
+00000880: 7c0b 7c0a 6702 7c0a 7c0c 6702 6702 a101  |.|.g.|.|.g.g...
+00000890: 7d11 7400 a009 7c0f 7c0e 1700 7c10 7c0d  }.t...|.|...|.|.
+000008a0: 1700 6702 a101 6404 1b00 7d12 7400 6a0a  ..g...d...}.t.j.
+000008b0: a00b 7c11 7c12 a102 5c02 7d13 7d14 7c06  ..|.|...\.}.}.|.
+000008c0: 7c13 1700 7d15 7c07 7c14 1700 7d16 7400  |...}.|.|...}.t.
+000008d0: a00c 7c04 7c15 1800 6404 1300 7c05 7c16  ..|.|...d...|.|.
+000008e0: 1800 6404 1300 1700 a101 7d17 7400 a007  ..d.......}.t...
+000008f0: 7c17 a101 7d18 7c15 7c16 7c18 6603 5300  |...}.|.|.|.f.S.
+00000900: 2906 6179 0200 000a 2020 2020 4669 7420  ).ay....    Fit 
+00000910: 6369 7263 6c65 2074 6f20 6461 7461 2070  circle to data p
+00000920: 6f69 6e74 7320 616c 6765 6272 6169 6361  oints algebraica
+00000930: 6c6c 790a 0a20 2020 2050 6172 616d 6574  lly..    Paramet
+00000940: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00000950: 2d2d 0a20 2020 2065 6467 655f 696d 6167  --.    edge_imag
+00000960: 653a 2062 6f6f 6c65 616e 2061 7272 6179  e: boolean array
+00000970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000980: 2042 6f6f 6c65 616e 2064 6174 6120 7768   Boolean data wh
+00000990: 6572 6520 7468 6520 6564 6765 2069 7320  ere the edge is 
+000009a0: 310a 0a20 2020 2052 6574 7572 6e73 0a20  1..    Returns. 
+000009b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2078     -------.    x
+000009c0: 5f63 656e 7465 723a 2020 2020 2020 666c  _center:      fl
+000009d0: 6f61 740a 2020 2020 2020 2020 2020 2020  oat.            
+000009e0: 2020 2020 2020 2058 2070 6978 656c 206f         X pixel o
+000009f0: 6620 6369 7263 6c65 2063 656e 7465 720a  f circle center.
+00000a00: 2020 2020 795f 6365 6e74 6572 3a20 2020      y_center:   
+00000a10: 2020 2066 6c6f 6174 0a20 2020 2020 2020     float.       
+00000a20: 2020 2020 2020 2020 2020 2020 5920 7069              Y pi
+00000a30: 7865 6c20 6f66 2063 6972 636c 6520 6365  xel of circle ce
+00000a40: 6e74 6572 0a20 2020 2072 6164 6975 735f  nter.    radius_
+00000a50: 6369 7263 6c65 3a20 666c 6f61 740a 2020  circle: float.  
+00000a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000a70: 2052 6164 6975 7320 6f66 2074 6865 2063   Radius of the c
+00000a80: 6972 636c 650a 0a20 2020 204e 6f74 6573  ircle..    Notes
+00000a90: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2057  .    -----.    W
+00000aa0: 6520 6361 6c63 756c 6174 6520 7468 6520  e calculate the 
+00000ab0: 6d65 616e 206f 6620 616c 6c20 7468 6520  mean of all the 
+00000ac0: 706f 696e 7473 0a20 2020 2061 7320 7468  points.    as th
+00000ad0: 6520 696e 6974 6961 6c20 6573 7469 6d61  e initial estima
+00000ae0: 7465 206f 6620 7468 6520 6369 7263 6c65  te of the circle
+00000af0: 2063 656e 7465 720a 2020 2020 616e 6420   center.    and 
+00000b00: 7468 656e 2073 6f6c 7665 2061 2073 6574  then solve a set
+00000b10: 206f 6620 6c69 6e65 6172 2065 7175 6174   of linear equat
+00000b20: 696f 6e73 0a20 2020 2074 6f20 6361 6c63  ions.    to calc
+00000b30: 756c 6174 6520 7261 6469 7573 2061 6e64  ulate radius and
+00000b40: 2074 6865 2064 6973 6b20 6365 6e74 6572   the disk center
+00000b50: 2e0a 0a20 2020 2053 6565 2041 6c73 6f0a  ...    See Also.
+00000b60: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00000b70: 2075 7469 6c2e 4361 6e6e 790a 2020 2020   util.Canny.    
+00000b80: 7201 0000 0072 0500 0000 7208 0000 0072  r....r....r....r
+00000b90: 0700 0000 7202 0000 0029 0d72 1700 0000  ....r....).r....
+00000ba0: 7219 0000 00da 0573 6861 7065 7216 0000  r......shaper...
+00000bb0: 00da 0369 6e74 da05 6d67 7269 6472 1800  ...int..mgridr..
+00000bc0: 0000 da04 6d65 616e da03 7375 6dda 0561  ....mean..sum..a
+00000bd0: 7272 6179 5a06 6c69 6e61 6c67 5a05 736f  rrayZ.linalgZ.so
+00000be0: 6c76 65da 0473 7172 7429 195a 0a65 6467  lve..sqrt).Z.edg
+00000bf0: 655f 696d 6167 655a 0a73 697a 655f 696d  e_imageZ.size_im
+00000c00: 6167 655a 0279 565a 0278 565a 0778 5661  ageZ.yVZ.xVZ.xVa
+00000c10: 6c75 6573 5a07 7956 616c 7565 735a 0978  luesZ.yValuesZ.x
+00000c20: 4365 6e74 726f 6964 5a09 7943 656e 7472  CentroidZ.yCentr
+00000c30: 6f69 645a 0775 5661 6c75 6573 5a07 7656  oidZ.uValuesZ.vV
+00000c40: 616c 7565 735a 0353 7576 5a03 5375 755a  aluesZ.SuvZ.SuuZ
+00000c50: 0353 7676 5a04 5375 7576 5a04 5375 7676  .SvvZ.SuuvZ.Suvv
+00000c60: 5a04 5375 7575 5a04 5376 7676 da01 41da  Z.SuuuZ.Svvv..A.
+00000c70: 0142 5a02 7563 da02 7663 5a07 7843 656e  .BZ.uc..vcZ.xCen
+00000c80: 7465 725a 0779 4365 6e74 6572 5a07 5276  terZ.yCenterZ.Rv
+00000c90: 616c 7565 735a 0672 6164 6975 7372 1e00  aluesZ.radiusr..
+00000ca0: 0000 721e 0000 0072 1f00 0000 da0a 6369  ..r....r......ci
+00000cb0: 7263 6c65 5f66 6974 4b00 0000 732e 0000  rcle_fitK...s...
+00000cc0: 0016 1d22 0114 0114 010a 020a 0108 0208  ..."............
+00000cd0: 010e 020e 010e 0112 0112 010e 010e 0116  ................
+00000ce0: 021a 0112 0108 0208 011e 020a 010a 0272  ...............r
+00000cf0: 2b00 0000 6304 0000 0000 0000 0000 0000  +...c...........
+00000d00: 0009 0000 0005 0000 0043 0000 0073 ae01  .........C...s..
+00000d10: 0000 7400 a001 7402 7c00 8301 a101 4400  ..t...t.|.....D.
+00000d20: 5dcd 7d04 7c00 7c04 6401 6602 1900 7d05  ].}.|.|.d.f...}.
+00000d30: 7c00 7c04 6402 6602 1900 7d06 6402 7d07  |.|.d.f...}.d.}.
+00000d40: 6402 7d08 6401 7c03 7c05 7c06 6602 1900  d.}.d.|.|.|.f...
+00000d50: 0400 0300 6b01 7227 6403 6b00 7338 6e01  ....k.r'd.k.s8n.
+00000d60: 0100 6404 7c03 7c05 7c06 6602 1900 0400  ..d.|.|.|.f.....
+00000d70: 0300 6b01 7236 6405 6b01 7249 6e02 0100  ..k.r6d.k.rIn...
+00000d80: 6e11 7c02 7c05 7c06 6402 1700 6602 1900  n.|.|.|.d...f...
+00000d90: 7d07 7c02 7c05 7c06 6402 1800 6602 1900  }.|.|.|.d...f...
+00000da0: 7d08 6e6a 6403 7c03 7c05 7c06 6602 1900  }.njd.|.|.|.f...
+00000db0: 0400 0300 6b01 7257 6406 6b00 726e 6e02  ....k.rWd.k.rnn.
+00000dc0: 0100 6e15 7c02 7c05 6402 1700 7c06 6402  ..n.|.|.d...|.d.
+00000dd0: 1800 6602 1900 7d07 7c02 7c05 6402 1800  ..f...}.|.|.d...
+00000de0: 7c06 6402 1700 6602 1900 7d08 6e45 6406  |.d...f...}.nEd.
+00000df0: 7c03 7c05 7c06 6602 1900 0400 0300 6b01  |.|.|.f.......k.
+00000e00: 727c 6407 6b00 728f 6e02 0100 6e11 7c02  r|d.k.r.n...n.|.
+00000e10: 7c05 6402 1700 7c06 6602 1900 7d07 7c02  |.d...|.f...}.|.
+00000e20: 7c05 6402 1800 7c06 6602 1900 7d08 6e24  |.d...|.f...}.n$
+00000e30: 6407 7c03 7c05 7c06 6602 1900 0400 0300  d.|.|.|.f.......
+00000e40: 6b01 729d 6404 6b00 72b3 6e02 0100 6e14  k.r.d.k.r.n...n.
+00000e50: 7c02 7c05 6402 1800 7c06 6402 1800 6602  |.|.d...|.d...f.
+00000e60: 1900 7d07 7c02 7c05 6402 1700 7c06 6402  ..}.|.|.d...|.d.
+00000e70: 1700 6602 1900 7d08 7c02 7c05 7c06 6602  ..f...}.|.|.|.f.
+00000e80: 1900 7c07 6b05 72ce 7c02 7c05 7c06 6602  ..|.k.r.|.|.|.f.
+00000e90: 1900 7c08 6b05 72ce 7c02 7c05 7c06 6602  ..|.k.r.|.|.|.f.
+00000ea0: 1900 7c01 7c05 7c06 6602 3c00 7107 6401  ..|.|.|.f.<.q.d.
+00000eb0: 7c01 7c05 7c06 6602 3c00 7107 6408 5300  |.|.|.f.<.q.d.S.
+00000ec0: 2909 61df 0100 000a 0a20 2020 2050 6172  ).a......    Par
+00000ed0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000ee0: 2d2d 2d2d 2d2d 0a20 2020 2070 6f73 3a20  ------.    pos: 
+00000ef0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00000f00: 2020 204c 6973 7420 6f66 2070 6978 656c     List of pixel
+00000f10: 2070 6f73 6974 696f 6e73 0a20 2020 2065   positions.    e
+00000f20: 6467 653a 206e 6461 7272 6179 0a20 2020  dge: ndarray.   
+00000f30: 2020 2020 2020 2054 6869 6e6e 6564 2045         Thinned E
+00000f40: 6467 650a 2020 2020 6d61 673a 2020 6e64  dge.    mag:  nd
+00000f50: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00000f60: 4d61 676e 6974 7564 6520 6166 7465 7220  Magnitude after 
+00000f70: 536f 6265 6c20 4669 6c74 6572 696e 670a  Sobel Filtering.
+00000f80: 2020 2020 616e 673a 2020 6e64 6172 7261      ang:  ndarra
+00000f90: 790a 2020 2020 2020 2020 2020 414e 676c  y.          ANgl
+00000fa0: 6520 6f66 2053 6f62 656c 2046 696c 7465  e of Sobel Filte
+00000fb0: 722c 2069 6e20 6465 6772 6565 730a 0a20  r, in degrees.. 
+00000fc0: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
+00000fd0: 2d2d 0a20 2020 2057 6520 7573 6520 7468  --.    We use th
+00000fe0: 6520 6469 7265 6374 696f 6e20 6f66 2074  e direction of t
+00000ff0: 6865 2053 6f62 656c 2067 7261 6469 656e  he Sobel gradien
+00001000: 7420 746f 0a20 2020 2064 6574 6572 6d69  t to.    determi
+00001010: 6e65 2077 6865 7468 6572 2061 2070 6978  ne whether a pix
+00001020: 656c 2062 656c 6f6e 6773 2074 6f20 7468  el belongs to th
+00001030: 6520 6564 6765 0a20 2020 206f 7220 6e6f  e edge.    or no
+00001040: 742e 2049 6620 7468 6520 6772 6164 6965  t. If the gradie
+00001050: 6e74 2069 7320 7065 7270 656e 6469 6375  nt is perpendicu
+00001060: 6c61 7220 746f 2074 6865 0a20 2020 2070  lar to the.    p
+00001070: 6978 656c 7320 7468 656e 2069 7420 6973  ixels then it is
+00001080: 2061 6e20 6564 6765 2070 6978 656c 206f   an edge pixel o
+00001090: 7220 656c 7365 2069 7420 6973 206e 6f74  r else it is not
+000010a0: 2e0a 2020 2020 7201 0000 0072 0500 0000  ..    r....r....
+000010b0: 6700 0000 0000 8036 4067 0000 0000 00b0  g......6@g......
+000010c0: 6340 e9b4 0000 0067 0000 0000 00e0 5040  c@.....g......P@
+000010d0: 6700 0000 0000 205c 404e a903 7217 0000  g..... \@N..r...
+000010e0: 005a 0661 7261 6e67 65da 036c 656e 2909  .Z.arange..len).
+000010f0: da03 706f 73da 0465 6467 6572 1c00 0000  ..pos..edger....
+00001100: 721d 0000 00da 0270 70da 0269 69da 026a  r......pp..ii..j
+00001110: 6ada 0171 da01 7272 1e00 0000 721e 0000  j..q..rr....r...
+00001120: 0072 1f00 0000 da07 7468 696e 6e65 7288  .r......thinner.
+00001130: 0000 0073 2a00 0000 1215 0c01 0c01 0401  ...s*...........
+00001140: 0401 3e01 1001 1201 2001 1401 1601 2001  ..>..... ..... .
+00001150: 1001 1201 2001 1401 1401 2002 1601 0e02  .... ..... .....
+00001160: 04eb 7236 0000 0063 0400 0000 0000 0000  ..r6...c........
+00001170: 0000 0000 0700 0000 0500 0000 4300 0000  ............C...
+00001180: 730a 0100 0074 00a0 0174 027c 0083 01a1  s....t...t.|....
+00001190: 0144 005d 7b7d 047c 007c 0464 0166 0219  .D.]{}.|.|.d.f..
+000011a0: 007d 057c 007c 0464 0266 0219 007d 067c  .}.|.|.d.f...}.|
+000011b0: 017c 057c 0666 0219 007c 036b 0272 827c  .|.|.f...|.k.r.|
+000011c0: 017c 0564 0218 007c 0664 0218 0066 0219  .|.d...|.d...f..
+000011d0: 007c 026b 0273 757c 017c 0564 0218 007c  .|.k.su|.|.d...|
+000011e0: 0666 0219 007c 026b 0273 757c 017c 0564  .f...|.k.su|.|.d
+000011f0: 0218 007c 0664 0217 0066 0219 007c 026b  ...|.d...f...|.k
+00001200: 0273 757c 017c 057c 0664 0218 0066 0219  .su|.|.|.d...f..
+00001210: 007c 026b 0273 757c 017c 057c 0664 0217  .|.k.su|.|.|.d..
+00001220: 0066 0219 007c 026b 0273 757c 017c 0564  .f...|.k.su|.|.d
+00001230: 0217 007c 0664 0218 0066 0219 007c 026b  ...|.d...f...|.k
+00001240: 0273 757c 017c 0564 0217 007c 0666 0219  .su|.|.d...|.f..
+00001250: 007c 026b 0273 757c 017c 0564 0217 007c  .|.k.su|.|.d...|
+00001260: 0664 0217 0066 0219 007c 026b 0272 7c7c  .d...f...|.k.r||
+00001270: 027c 017c 057c 0666 023c 0071 0764 017c  .|.|.|.f.<.q.d.|
+00001280: 017c 057c 0666 023c 0071 0764 0353 0029  .|.|.f.<.q.d.S.)
+00001290: 0461 5502 0000 0a20 2020 204a 6f69 6e69  .aU....    Joini
+000012a0: 6e67 206f 6620 4564 6765 730a 0a20 2020  ng of Edges..   
+000012b0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000012c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2070  ----------.    p
+000012d0: 6f73 3a20 2020 6e64 6172 7261 790a 2020  os:   ndarray.  
+000012e0: 2020 2020 2020 2020 204c 6973 7420 6f66           List of
+000012f0: 2070 6978 656c 2070 6f73 6974 696f 6e73   pixel positions
+00001300: 0a20 2020 2065 6467 653a 2020 6e64 6172  .    edge:  ndar
+00001310: 7261 790a 2020 2020 2020 2020 2020 2054  ray.           T
+00001320: 6869 6e6e 6564 2045 6467 652c 2074 6861  hinned Edge, tha
+00001330: 7420 7769 6c6c 2062 6520 6a6f 696e 6564  t will be joined
+00001340: 0a20 2020 2075 7070 6572 3a20 666c 6f61  .    upper: floa
+00001350: 740a 2020 2020 2020 2020 2020 2055 7070  t.           Upp
+00001360: 6572 2074 6872 6573 686f 6c64 0a20 2020  er threshold.   
+00001370: 206c 6f77 6572 3a20 666c 6f61 740a 2020   lower: float.  
+00001380: 2020 2020 2020 2020 204c 6f77 6572 2074           Lower t
+00001390: 6872 6573 686f 6c64 0a0a 2020 2020 4e6f  hreshold..    No
+000013a0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
+000013b0: 2020 5468 6520 696e 7075 7420 696d 6167    The input imag
+000013c0: 6520 6e6f 7720 636f 6e73 6973 7473 206f  e now consists o
+000013d0: 6620 7374 726f 6e67 2061 6e64 2077 6561  f strong and wea
+000013e0: 6b0a 2020 2020 7468 7265 7368 6f6c 6473  k.    thresholds
+000013f0: 2e20 5468 6520 6669 6e61 6c20 7374 6570  . The final step
+00001400: 206f 6620 7468 6520 616c 676f 7269 7468   of the algorith
+00001410: 6d20 6973 2074 6f0a 2020 2020 6c6f 6f6b  m is to.    look
+00001420: 2061 7420 736f 6d65 206f 6620 7468 6520   at some of the 
+00001430: 6d65 6173 7572 6564 2065 6467 6573 2061  measured edges a
+00001440: 6e64 206a 6f69 6e2f 6c69 6e6b 2074 6865  nd join/link the
+00001450: 6d2e 0a20 2020 2054 6865 2069 6465 6120  m..    The idea 
+00001460: 6973 2074 6861 7420 6966 2061 2065 6467  is that if a edg
+00001470: 6520 7069 7865 6c20 6973 2063 6c61 7373  e pixel is class
+00001480: 6966 6965 6420 6173 2061 0a20 2020 2077  ified as a.    w
+00001490: 6561 6b20 6564 6765 2062 7574 206f 6e65  eak edge but one
+000014a0: 206f 6620 6974 7320 6e65 6967 6862 6f72   of its neighbor
+000014b0: 7320 6973 2061 2073 7472 6f6e 6720 6564  s is a strong ed
+000014c0: 6765 2074 6865 6e0a 2020 2020 6974 2069  ge then.    it i
+000014d0: 7320 6120 7374 726f 6e67 2065 6467 6520  s a strong edge 
+000014e0: 7069 7865 6c2e 0a20 2020 2072 0100 0000  pixel..    r....
+000014f0: 7205 0000 004e 722d 0000 0029 0772 2f00  r....Nr-...).r/.
+00001500: 0000 7230 0000 00da 0575 7070 6572 da05  ..r0.....upper..
+00001510: 6c6f 7765 7272 3100 0000 7232 0000 0072  lowerr1...r2...r
+00001520: 3300 0000 721e 0000 0072 1e00 0000 721f  3...r....r....r.
+00001530: 0000 00da 066a 6f69 6e65 72b5 0000 0073  .....joiner....s
+00001540: 2000 0000 1218 0c01 0c01 1001 1802 1401   ...............
+00001550: 1801 1401 1401 1801 1401 1801 0e02 0c02  ................
+00001560: 0280 04f0 7239 0000 0063 0000 0000 0000  ....r9...c......
+00001570: 0000 0000 0000 0000 0000 0300 0000 4000  ..............@.
+00001580: 0000 7332 0000 0065 005a 0164 005a 0264  ..s2...e.Z.d.Z.d
+00001590: 015a 0364 0d64 0464 0584 015a 0464 0664  .Z.d.d.d...Z.d.d
+000015a0: 0784 005a 0564 0864 0984 005a 0664 0a64  ...Z.d.d...Z.d.d
+000015b0: 0b84 005a 0764 0c53 0029 0eda 0543 616e  ...Z.d.S.)...Can
+000015c0: 6e79 6193 0700 000a 2020 2020 4361 6e6e  nya.....    Cann
+000015d0: 7920 4564 6765 2044 6574 6563 7469 6f6e  y Edge Detection
+000015e0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+000015f0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00001600: 2020 2020 696d 6167 653a 2020 2020 2020      image:      
+00001610: 2020 206e 6461 7272 6179 0a20 2020 2020     ndarray.     
+00001620: 2020 2020 2020 2020 2020 2020 2020 496d                Im
+00001630: 6167 6520 6f6e 2077 6869 6368 2043 616e  age on which Can
+00001640: 6e79 2065 6467 6520 6465 7465 6374 696f  ny edge detectio
+00001650: 6e20 6973 2074 6f20 6265 2070 6572 666f  n is to be perfo
+00001660: 726d 6564 0a20 2020 206c 6f77 5468 7265  rmed.    lowThre
+00001670: 7368 6f6c 643a 2020 666c 6f61 740a 2020  shold:  float.  
+00001680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001690: 204c 6f77 6572 2074 6872 6573 686f 6c64   Lower threshold
+000016a0: 2076 616c 7565 2c20 636f 756c 6420 6265   value, could be
+000016b0: 2075 7365 7220 6465 6669 6e65 6420 6f72   user defined or
+000016c0: 2061 7574 6f0a 2020 2020 2020 2020 2020   auto.          
+000016d0: 2020 2020 2020 2020 2067 656e 6572 6174           generat
+000016e0: 6564 2066 726f 6d20 4f74 7375 2074 6872  ed from Otsu thr
+000016f0: 6573 686f 6c64 696e 670a 2020 2020 6869  esholding.    hi
+00001700: 6768 5468 7265 7368 6f6c 643a 2066 6c6f  ghThreshold: flo
+00001710: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+00001720: 2020 2020 2020 5570 7065 7220 7468 7265        Upper thre
+00001730: 7368 6f6c 6420 7661 6c75 652c 2063 6f75  shold value, cou
+00001740: 6c64 2062 6520 7573 6572 2064 6566 696e  ld be user defin
+00001750: 6564 206f 7220 6175 746f 0a20 2020 2020  ed or auto.     
+00001760: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+00001770: 6e65 7261 7465 6420 6672 6f6d 204f 7473  nerated from Ots
+00001780: 7520 7468 7265 7368 6f6c 6469 6e67 0a0a  u thresholding..
+00001790: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+000017a0: 2d2d 2d0a 2020 2020 5468 6520 696e 7075  ---.    The inpu
+000017b0: 7420 696d 6167 6520 6973 2066 6972 7374  t image is first
+000017c0: 2062 6c75 7272 6564 2077 6974 6820 6120   blurred with a 
+000017d0: 5b35 2078 2035 5d20 4761 7573 7369 616e  [5 x 5] Gaussian
+000017e0: 206b 6572 6e65 6c20 746f 0a20 2020 2070   kernel to.    p
+000017f0: 7265 7665 6e74 2070 6978 656c 206a 756d  revent pixel jum
+00001800: 7073 2062 6569 6e67 2069 6e63 6f72 7265  ps being incorre
+00001810: 6374 6c79 2072 6567 6973 7465 7265 6420  ctly registered 
+00001820: 6173 2065 6467 6573 2e20 5468 656e 2061  as edges. Then a
+00001830: 2053 6f62 656c 0a20 2020 2066 696c 7465   Sobel.    filte
+00001840: 7220 6973 2072 756e 206f 6e20 7468 6520  r is run on the 
+00001850: 696d 6167 652e 2054 6865 2065 6467 6573  image. The edges
+00001860: 2066 726f 6d20 7468 6520 536f 6265 6c20   from the Sobel 
+00001870: 6669 6c74 6572 2061 7265 0a20 2020 2073  filter are.    s
+00001880: 7562 7365 7175 656e 746c 7920 7468 696e  ubsequently thin
+00001890: 6e65 6420 6279 2064 6574 6572 6d69 6e69  ned by determini
+000018a0: 6e67 2077 6865 7468 6572 2074 6865 2067  ng whether the g
+000018b0: 7261 6469 656e 7420 6f66 2074 6865 2053  radient of the S
+000018c0: 6f62 656c 0a20 2020 2066 696c 7465 7220  obel.    filter 
+000018d0: 6973 2070 6572 7065 6e64 6963 756c 6172  is perpendicular
+000018e0: 2074 6f20 7468 6520 6564 6765 2e20 5375   to the edge. Su
+000018f0: 6273 6571 7565 6e74 6c79 2074 6865 2065  bsequently the e
+00001900: 6467 6573 2061 7265 2073 6f72 7465 640a  dges are sorted.
+00001910: 2020 2020 696e 746f 2074 776f 2062 696e      into two bin
+00001920: 7320 2d20 7765 616b 2065 6467 6573 2061  s - weak edges a
+00001930: 6e64 2073 7472 6f6e 6720 6564 6765 732e  nd strong edges.
+00001940: 2054 6865 2077 6561 6b20 6564 6765 7320   The weak edges 
+00001950: 6172 650a 2020 2020 7265 636c 6173 7369  are.    reclassi
+00001960: 6669 6564 2061 7320 7374 726f 6e67 2065  fied as strong e
+00001970: 6467 6573 2069 6620 7468 6579 2061 7265  dges if they are
+00001980: 2063 6f6e 6e65 6374 6564 2074 6f20 7374   connected to st
+00001990: 726f 6e67 2065 6467 6573 2e0a 0a20 2020  rong edges...   
+000019a0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+000019b0: 2d2d 2d2d 2d2d 0a20 2020 2052 756e 2061  ------.    Run a
+000019c0: 733a 0a0a 2020 2020 3e3e 3e20 696d 5f63  s:..    >>> im_c
+000019d0: 616e 6e79 203d 2043 616e 6e79 2869 6d61  anny = Canny(ima
+000019e0: 6765 2c30 2e32 2c30 2e37 290a 0a20 2020  ge,0.2,0.7)..   
+000019f0: 2057 6865 7265 2030 2e32 2061 6e64 2030   Where 0.2 and 0
+00001a00: 2e37 2061 7265 2074 6865 2070 6172 616d  .7 are the param
+00001a10: 6574 6572 7320 6f62 7461 696e 6564 2074  eters obtained t
+00001a20: 6872 6f75 6768 204f 7473 7520 7468 7265  hrough Otsu thre
+00001a30: 7368 6f6c 6469 6e67 2069 6d61 6765 2e0a  sholding image..
+00001a40: 2020 2020 4166 7465 7220 7365 7474 696e      After settin
+00001a50: 6720 7468 6520 636c 6173 732c 2074 6865  g the class, the
+00001a60: 6e20 6765 6e65 7261 7465 2074 6865 2065  n generate the e
+00001a70: 6467 6573 2066 6972 7374 2061 733a 0a0a  dges first as:..
+00001a80: 2020 2020 3e3e 3e20 696d 5f63 616e 6e79      >>> im_canny
+00001a90: 2e65 6467 655f 7468 696e 6e69 6e67 2829  .edge_thinning()
+00001aa0: 0a0a 2020 2020 5468 6973 2053 6f62 656c  ..    This Sobel
+00001ab0: 2066 696c 7465 7273 2074 6865 2069 6d61   filters the ima
+00001ac0: 6765 2c20 616e 6420 6765 6e65 7261 7465  ge, and generate
+00001ad0: 7320 7468 6520 696d 6167 6520 6564 6765  s the image edge
+00001ae0: 2e20 5468 6520 6d61 676e 6974 7564 6520  . The magnitude 
+00001af0: 6f66 0a20 2020 2074 6865 2053 6f62 656c  of.    the Sobel
+00001b00: 2066 696c 7465 7220 6361 6e20 6265 2061   filter can be a
+00001b10: 6363 6573 7365 6420 6173 2060 696d 5f63  ccessed as `im_c
+00001b20: 616e 6e79 2e73 6f62 656c 5f6d 6167 602c  anny.sobel_mag`,
+00001b30: 2077 6869 6c65 2074 6865 2053 6f62 656c   while the Sobel
+00001b40: 2061 6e67 6c65 0a20 2020 2069 6e20 6465   angle.    in de
+00001b50: 6772 6565 7320 6973 2073 746f 7265 6420  grees is stored 
+00001b60: 6173 2060 696d 5f63 616e 6e79 2e73 6f62  as `im_canny.sob
+00001b70: 656c 5f61 6e67 602e 2054 6865 2067 656e  el_ang`. The gen
+00001b80: 6572 6174 6564 2065 6467 6520 6973 2073  erated edge is s
+00001b90: 746f 7265 6420 6173 0a20 2020 2060 696d  tored as.    `im
+00001ba0: 5f63 616e 6e79 2e74 6869 6e5f 6564 6765  _canny.thin_edge
+00001bb0: 602e 2054 6869 7320 6973 2074 6865 2074  `. This is the t
+00001bc0: 6872 6573 686f 6c64 6564 2065 6467 652c  hresholded edge,
+00001bd0: 2068 6f77 6576 6572 2074 6869 7320 6973   however this is
+00001be0: 2062 726f 6b65 6e20 616e 640a 2020 2020   broken and.    
+00001bf0: 6469 7363 6f6e 7469 6e75 6f75 7320 616e  discontinuous an
+00001c00: 6420 6e6f 6e2d 756e 6966 6f72 6d20 696e  d non-uniform in
+00001c10: 2076 616c 7565 2e20 546f 2066 6978 2074   value. To fix t
+00001c20: 6861 7420 7275 6e3a 0a0a 2020 2020 3e3e  hat run:..    >>
+00001c30: 3e20 696d 5f63 616e 6e79 2e65 6467 655f  > im_canny.edge_
+00001c40: 7468 7265 7368 6f6c 6469 6e67 0a0a 2020  thresholding..  
+00001c50: 2020 4166 7465 7220 7468 6174 2c20 6765    After that, ge
+00001c60: 6e65 7261 7465 2074 6865 2066 696e 616c  nerate the final
+00001c70: 2063 616e 6e79 2065 6467 6520 6173 3a0a   canny edge as:.
+00001c80: 0a20 2020 203e 3e3e 2063 616e 6e79 5f69  .    >>> canny_i
+00001c90: 6d61 6765 203d 2069 6d5f 6361 6e6e 792e  mage = im_canny.
+00001ca0: 6564 6765 5f6a 6f69 6e69 6e67 2829 0a0a  edge_joining()..
+00001cb0: 2020 2020 5265 6665 7265 6e63 6573 0a20      References. 
+00001cc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00001cd0: 2020 2e2e 205b 345d 204a 6f68 6e20 4361    .. [4] John Ca
+00001ce0: 6e6e 792c 2022 4120 636f 6d70 7574 6174  nny, "A computat
+00001cf0: 696f 6e61 6c20 6170 7072 6f61 6368 2074  ional approach t
+00001d00: 6f20 6564 6765 2064 6574 6563 7469 6f6e  o edge detection
+00001d10: 2e22 0a20 2020 2020 2020 5265 6164 696e  .".       Readin
+00001d20: 6773 2069 6e20 636f 6d70 7574 6572 2076  gs in computer v
+00001d30: 6973 696f 6e2e 204d 6f72 6761 6e20 4b61  ision. Morgan Ka
+00001d40: 7566 6d61 6e6e 2c20 3139 3837 2e20 3138  ufmann, 1987. 18
+00001d50: 342d 3230 330a 2020 2020 54e9 0500 0000  4-203.    T.....
+00001d60: 6306 0000 0000 0000 0000 0000 0006 0000  c...............
+00001d70: 0006 0000 0043 0000 0073 8e00 0000 7c01  .....C...s....|.
+00001d80: 7c00 5f00 7401 a002 7c01 6a03 a101 a004  |._.t...|.j.....
+00001d90: 7405 a101 7c00 5f06 7c02 7c00 5f07 7c03  t...|._.|.|._.|.
+00001da0: 7c00 5f08 7409 6a0a a00b 740c a00d 7c01  |._.t.j...t...|.
+00001db0: 7c05 a102 a101 7c00 5f0e 7401 a00f 7c01  |.....|._.t...|.
+00001dc0: a101 7c00 5f10 7401 a00f 7c01 a101 7c00  ..|._.t...|...|.
+00001dd0: 5f11 7401 a00f 7c01 a101 7c00 5f12 7401  _.t...|...|._.t.
+00001de0: a00f 7c01 a101 7c00 5f13 7401 a00f 7c01  ..|...|._.t...|.
+00001df0: a101 7c00 5f14 6401 7c00 5f15 6401 7c00  ..|._.d.|._.d.|.
+00001e00: 5f16 7c04 7c00 5f17 6400 5300 2902 4e46  _.|.|._.d.S.).NF
+00001e10: 2918 da05 696d 6167 6572 1700 0000 7219  )...imager....r.
+00001e20: 0000 0072 2100 0000 7216 0000 0072 2200  ...r!...r....r".
+00001e30: 0000 da07 696d 5f73 697a 65da 0c74 6872  ....im_size..thr
+00001e40: 6573 685f 6c6f 7765 72da 0c74 6872 6573  esh_lower..thres
+00001e50: 685f 7570 7065 72da 0273 74da 0475 7469  h_upper..st..uti
+00001e60: 6c5a 1069 6d61 6765 5f6e 6f72 6d61 6c69  lZ.image_normali
+00001e70: 7a65 72da 0473 636e 645a 0f67 6175 7373  zer..scndZ.gauss
+00001e80: 6961 6e5f 6669 6c74 6572 da06 696d 626c  ian_filter..imbl
+00001e90: 7572 5a0a 656d 7074 795f 6c69 6b65 da09  urZ.empty_like..
+00001ea0: 736f 6265 6c5f 6d61 67da 0973 6f62 656c  sobel_mag..sobel
+00001eb0: 5f61 6e67 da09 7468 696e 5f65 6467 65da  _ang..thin_edge.
+00001ec0: 0872 6573 6964 7561 6cda 0963 616e 6e79  .residual..canny
+00001ed0: 4564 6765 da0a 6564 6765 5f63 6865 636b  Edge..edge_check
+00001ee0: da0c 7468 7265 7368 5f63 6865 636b da0a  ..thresh_check..
+00001ef0: 706c 6f74 5f73 7465 7073 2906 da04 7365  plot_steps)...se
+00001f00: 6c66 723c 0000 005a 0c6c 6f77 5468 7265  lfr<...Z.lowThre
+00001f10: 7368 6f6c 645a 0d68 6967 6854 6872 6573  sholdZ.highThres
+00001f20: 686f 6c64 724b 0000 005a 0762 6c75 7256  holdrK...Z.blurV
+00001f30: 616c 721e 0000 0072 1e00 0000 721f 0000  alr....r....r...
+00001f40: 00da 085f 5f69 6e69 745f 5f16 0100 0073  ...__init__....s
+00001f50: 1a00 0000 0601 1401 0601 0601 1601 0c01  ................
+00001f60: 0c01 0c01 0c01 0c01 0601 0601 0a01 7a0e  ..............z.
+00001f70: 4361 6e6e 792e 5f5f 696e 6974 5f5f 6301  Canny.__init__c.
+00001f80: 0000 0000 0000 0000 0000 0005 0000 0006  ................
+00001f90: 0000 0043 0000 0073 1401 0000 7400 6a01  ...C...s....t.j.
+00001fa0: 6a02 7c00 6a03 6401 6402 8d02 5c02 7c00  j.|.j.d.d...\.|.
+00001fb0: 5f04 7c00 5f05 7c00 6a05 6403 7406 6a07  _.|._.|.j.d.t.j.
+00001fc0: 1b00 1400 7c00 5f05 7c00 6a05 7c00 6a05  ....|._.|.j.|.j.
+00001fd0: 6404 6b00 0500 1900 6403 3700 0300 3c00  d.k.....d.7...<.
+00001fe0: 7406 6a08 6405 7c00 6a09 6404 1900 6405  t.j.d.|.j.d...d.
+00001ff0: 1800 8502 6405 7c00 6a09 6405 1900 6405  ....d.|.j.d...d.
+00002000: 1800 8502 6602 1900 5c02 7d01 7d02 7406  ....f...\.}.}.t.
+00002010: a00a 7406 a00b 7c01 a101 7406 a00b 7c02  ..t...|...t...|.
+00002020: a101 6602 a101 a00c a100 7d03 7406 a00d  ..f.......}.t...
+00002030: 7c00 6a0e a101 7d04 740f 7c03 7c00 6a0e  |.j...}.t.|.|.j.
+00002040: 7c00 6a04 7c00 6a05 8304 0100 7c00 6a10  |.j.|.j.....|.j.
+00002050: 7285 7411 6a12 6406 6407 8d01 0100 7411  r.t.j.d.d.....t.
+00002060: a013 6405 6408 6405 a103 0100 7411 a014  ..d.d.d.....t...
+00002070: 7c00 6a04 a101 0100 7411 a015 6409 a101  |.j.....t...d...
+00002080: 0100 7411 a013 6405 6408 6408 a103 0100  ..t...d.d.d.....
+00002090: 7411 a014 7c00 6a0e a101 0100 7411 a015  t...|.j.....t...
+000020a0: 6409 a101 0100 640a 7c00 5f16 640b 5300  d.....d.|._.d.S.
+000020b0: 290c 612b 0100 000a 2020 2020 2020 2020  ).a+....        
+000020c0: 5468 696e 6e69 6e67 2053 6f62 656c 2046  Thinning Sobel F
+000020d0: 696c 7465 7265 6420 4564 6765 730a 0a20  iltered Edges.. 
+000020e0: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
+000020f0: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
+00002100: 2020 2057 6520 7573 6520 7468 6520 6469     We use the di
+00002110: 7265 6374 696f 6e20 6f66 2074 6865 2053  rection of the S
+00002120: 6f62 656c 2067 7261 6469 656e 7420 746f  obel gradient to
+00002130: 0a20 2020 2020 2020 2064 6574 6572 6d69  .        determi
+00002140: 6e65 2077 6865 7468 6572 2061 2070 6978  ne whether a pix
+00002150: 656c 2062 656c 6f6e 6773 2074 6f20 7468  el belongs to th
+00002160: 6520 6564 6765 0a20 2020 2020 2020 206f  e edge.        o
+00002170: 7220 6e6f 742e 2049 6620 7468 6520 6772  r not. If the gr
+00002180: 6164 6965 6e74 2069 7320 7065 7270 656e  adient is perpen
+00002190: 6469 6375 6c61 7220 746f 2074 6865 0a20  dicular to the. 
+000021a0: 2020 2020 2020 2070 6978 656c 7320 7468         pixels th
+000021b0: 656e 2069 7420 6973 2061 6e20 6564 6765  en it is an edge
+000021c0: 2070 6978 656c 206f 7220 656c 7365 2069   pixel or else i
+000021d0: 7420 6973 206e 6f74 2e0a 2020 2020 2020  t is not..      
+000021e0: 2020 723b 0000 0029 0172 1b00 0000 722c    r;...).r....r,
+000021f0: 0000 0072 0100 0000 7205 0000 0029 02e9  ...r....r....)..
+00002200: 1400 0000 e90a 0000 00a9 015a 0766 6967  ...........Z.fig
+00002210: 7369 7a65 7207 0000 00da 036f 6666 544e  sizer......offTN
+00002220: 2917 7240 0000 0072 4100 0000 7220 0000  ).r@...rA...r ..
+00002230: 0072 4300 0000 7244 0000 0072 4500 0000  .rC...rD...rE...
+00002240: 7217 0000 00da 0270 6972 2300 0000 723d  r......pir#...r=
+00002250: 0000 0072 1900 0000 da05 7261 7665 6cda  ...r......ravel.
+00002260: 0974 7261 6e73 706f 7365 da04 636f 7079  .transpose..copy
+00002270: 7246 0000 0072 3600 0000 724b 0000 00da  rF...r6...rK....
+00002280: 0370 6c74 da06 6669 6775 7265 5a07 7375  .plt..figureZ.su
+00002290: 6270 6c6f 74da 0669 6d73 686f 77da 0461  bplot..imshow..a
+000022a0: 7869 7372 4900 0000 2905 724c 0000 00da  xisrI...).rL....
+000022b0: 0679 5261 6e67 65da 0678 5261 6e67 655a  .yRange..xRangeZ
+000022c0: 0874 6869 6e5f 706f 7372 4600 0000 721e  .thin_posrF...r.
+000022d0: 0000 0072 1e00 0000 721f 0000 00da 0d65  ...r....r......e
+000022e0: 6467 655f 7468 696e 6e69 6e67 2501 0000  dge_thinning%...
+000022f0: 7320 0000 001a 0b12 0118 012e 011e 010c  s ..............
+00002300: 0114 0106 010c 010e 010c 010a 010e 010c  ................
+00002310: 010a 010a 017a 1343 616e 6e79 2e65 6467  .....z.Canny.edg
+00002320: 655f 7468 696e 6e69 6e67 6301 0000 0000  e_thinningc.....
+00002330: 0000 0000 0000 0003 0000 0007 0000 0043  ...............C
+00002340: 0000 0073 a600 0000 7c00 6a00 7307 7401  ...s....|.j.s.t.
+00002350: 6401 8301 8201 7402 a003 7c00 6a04 a101  d.....t...|.j...
+00002360: 7c00 6a05 1400 7d01 7c01 7c00 6a06 1400  |.j...}.|.|.j...
+00002370: 7d02 7c01 7c00 6a07 7402 a008 7c00 6a04  }.|.|.j.t...|.j.
+00002380: 7c01 6b04 a101 3c00 7c02 7c00 6a07 7402  |.k...<.|.|.j.t.
+00002390: a008 7c00 6a04 7c01 6b01 7c00 6a04 7c02  ..|.j.|.k.|.j.|.
+000023a0: 6b04 4000 a101 3c00 7c00 6a05 7c00 6a07  k.@...<.|.j.|.j.
+000023b0: 7c00 6a07 7c00 6a05 6b04 3c00 7c00 6a09  |.j.|.j.k.<.|.j.
+000023c0: 724e 740a 6a0b 6402 6403 8d01 0100 740a  rNt.j.d.d.....t.
+000023d0: a00c 7c00 6a07 a101 0100 740a a00d 6404  ..|.j.....t...d.
+000023e0: a101 0100 6405 7c00 5f0e 6406 5300 2907  ....d.|._.d.S.).
+000023f0: 6188 0100 000a 2020 2020 2020 2020 5468  a.....        Th
+00002400: 7265 7368 6f6c 6469 6e67 206f 6620 4564  resholding of Ed
+00002410: 6765 730a 0a20 2020 2020 2020 204e 6f74  ges..        Not
+00002420: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00002430: 0a20 2020 2020 2020 2053 6f72 7420 6564  .        Sort ed
+00002440: 6765 7320 6d65 6173 7572 6564 2061 7320  ges measured as 
+00002450: 6569 7468 6572 2073 7472 6f6e 6720 6564  either strong ed
+00002460: 6765 7320 6f72 2077 6561 6b20 6564 6765  ges or weak edge
+00002470: 732c 0a20 2020 2020 2020 2064 6570 656e  s,.        depen
+00002480: 6469 6e67 206f 6e20 7468 6520 696e 7465  ding on the inte
+00002490: 6e73 6974 7920 6f66 2074 6865 2065 6467  nsity of the edg
+000024a0: 652e 2054 6865 2074 6872 6573 686f 6c64  e. The threshold
+000024b0: 7320 6172 650a 2020 2020 2020 2020 7573  s are.        us
+000024c0: 6572 2064 6566 696e 6564 2070 6172 616d  er defined param
+000024d0: 6574 6572 7320 616e 6420 7768 696c 6520  eters and while 
+000024e0: 7468 6579 2063 616e 2062 6520 706c 6179  they can be play
+000024f0: 6564 2061 726f 756e 640a 2020 2020 2020  ed around.      
+00002500: 2020 7769 7468 2069 7420 6973 2072 6563    with it is rec
+00002510: 6f6d 6d65 6e64 6564 2074 6f20 7573 6520  ommended to use 
+00002520: 6120 7468 7265 7368 6f6c 6469 6e67 2061  a thresholding a
+00002530: 6c67 6f72 6974 686d 206c 696b 650a 2020  lgorithm like.  
+00002540: 2020 2020 2020 4f74 7375 2074 6872 6573        Otsu thres
+00002550: 686f 6c64 696e 6720 746f 2072 6f62 7573  holding to robus
+00002560: 746c 7920 6465 7465 726d 696e 6520 6564  tly determine ed
+00002570: 6765 732e 0a20 2020 2020 2020 207a 3550  ges..        z5P
+00002580: 6c65 6173 6520 7468 696e 2074 6865 2065  lease thin the e
+00002590: 6467 6573 2066 6972 7374 2062 7920 6361  dges first by ca
+000025a0: 6c6c 696e 6720 6564 6765 5f74 6869 6e6e  lling edge_thinn
+000025b0: 6572 2829 a902 724f 0000 0072 4f00 0000  er()..rO...rO...
+000025c0: 7250 0000 0072 5100 0000 544e 290f 7249  rP...rQ...TN).rI
+000025d0: 0000 00da 0c52 756e 7469 6d65 4572 726f  .....RuntimeErro
+000025e0: 7272 1700 0000 da04 616d 6178 7246 0000  rr......amaxrF..
+000025f0: 0072 3f00 0000 723e 0000 0072 4700 0000  .r?...r>...rG...
+00002600: da05 7768 6572 6572 4b00 0000 7256 0000  ..whererK...rV..
+00002610: 0072 5700 0000 7258 0000 0072 5900 0000  .rW...rX...rY...
+00002620: 724a 0000 0029 0372 4c00 0000 5a05 6869  rJ...).rL...Z.hi
+00002630: 6768 545a 046c 6f77 5472 1e00 0000 721e  ghTZ.lowTr....r.
+00002640: 0000 0072 1f00 0000 da11 6564 6765 5f74  ...r......edge_t
+00002650: 6872 6573 686f 6c64 696e 6741 0100 0073  hresholdingA...s
+00002660: 1e00 0000 060c 0801 1201 0a01 1601 0203  ................
+00002670: 04fe 1801 02ff 1403 0601 0c01 0c01 0a01  ................
+00002680: 0a01 7a17 4361 6e6e 792e 6564 6765 5f74  ..z.Canny.edge_t
+00002690: 6872 6573 686f 6c64 696e 6763 0100 0000  hresholdingc....
+000026a0: 0000 0000 0000 0000 0500 0000 0600 0000  ................
+000026b0: 4300 0000 73e4 0000 007c 006a 0073 0774  C...s....|.j.s.t
+000026c0: 0164 0183 0182 0174 026a 0364 027c 006a  .d.....t.j.d.|.j
+000026d0: 0464 0319 0064 0218 0085 0264 027c 006a  .d...d.....d.|.j
+000026e0: 0464 0219 0064 0218 0085 0266 0219 005c  .d...d.....f...\
+000026f0: 027d 017d 0274 02a0 0574 02a0 067c 01a1  .}.}.t...t...|..
+00002700: 0174 02a0 067c 02a1 0166 02a1 01a0 07a1  .t...|...f......
+00002710: 007d 0374 02a0 087c 006a 09a1 017d 0474  .}.t...|.j...}.t
+00002720: 02a0 087c 006a 09a1 017c 005f 0a74 0b7c  ...|.j...|._.t.|
+00002730: 037c 006a 0a7c 006a 0c7c 006a 0d83 0401  .|.j.|.j.|.j....
+00002740: 0074 0b7c 037c 006a 0a7c 006a 0c7c 006a  .t.|.|.j.|.j.|.j
+00002750: 0d83 0401 007c 006a 0e72 6274 0f6a 1064  .....|.j.rbt.j.d
+00002760: 0464 058d 0101 0074 0fa0 117c 006a 0aa1  .d.....t...|.j..
+00002770: 0101 0074 0fa0 1264 06a1 0101 007c 006a  ...t...d.....|.j
+00002780: 0a74 02a0 137c 006a 0aa1 011b 00a0 1474  .t...|.j.......t
+00002790: 15a1 017c 005f 0a7c 006a 0a53 0029 0761  ...|._.|.j.S.).a
+000027a0: 5c02 0000 0a20 2020 2020 2020 204a 6f69  \....        Joi
+000027b0: 6e69 6e67 206f 6620 4564 6765 730a 0a20  ning of Edges.. 
+000027c0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+000027d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+000027e0: 2020 2020 2020 2063 616e 6e79 4564 6765         cannyEdge
+000027f0: 3a20 626f 6f6c 6561 6e20 6172 7261 790a  : boolean array.
+00002800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002810: 2020 2042 6f6f 6c65 616e 206d 6174 7269     Boolean matri
+00002820: 7820 7769 7468 2074 6865 2073 616d 6520  x with the same 
+00002830: 7369 7a65 2061 7320 7468 6520 6f72 6967  size as the orig
+00002840: 696e 616c 0a20 2020 2020 2020 2020 2020  inal.           
+00002850: 2020 2020 2020 2020 696d 6167 652c 2077          image, w
+00002860: 6865 7265 2074 6865 2065 6467 6573 2061  here the edges a
+00002870: 7265 2031 2c20 7768 696c 6520 7468 6520  re 1, while the 
+00002880: 7265 7374 2069 7320 300a 0a20 2020 2020  rest is 0..     
+00002890: 2020 204e 6f74 6573 0a20 2020 2020 2020     Notes.       
+000028a0: 202d 2d2d 2d2d 0a20 2020 2020 2020 2054   -----.        T
+000028b0: 6865 2069 6e70 7574 2069 6d61 6765 206e  he input image n
+000028c0: 6f77 2063 6f6e 7369 7374 7320 6f66 2073  ow consists of s
+000028d0: 7472 6f6e 6720 616e 6420 7765 616b 0a20  trong and weak. 
+000028e0: 2020 2020 2020 2074 6872 6573 686f 6c64         threshold
+000028f0: 732e 2054 6865 2066 696e 616c 2073 7465  s. The final ste
+00002900: 7020 6f66 2074 6865 2061 6c67 6f72 6974  p of the algorit
+00002910: 686d 2069 7320 746f 0a20 2020 2020 2020  hm is to.       
+00002920: 206c 6f6f 6b20 6174 2073 6f6d 6520 6f66   look at some of
+00002930: 2074 6865 206d 6561 7375 7265 6420 6564   the measured ed
+00002940: 6765 7320 616e 6420 6a6f 696e 2f6c 696e  ges and join/lin
+00002950: 6b20 7468 656d 2e0a 2020 2020 2020 2020  k them..        
+00002960: 5468 6520 6964 6561 2069 7320 7468 6174  The idea is that
+00002970: 2069 6620 6120 6564 6765 2070 6978 656c   if a edge pixel
+00002980: 2069 7320 636c 6173 7369 6669 6564 2061   is classified a
+00002990: 7320 610a 2020 2020 2020 2020 7765 616b  s a.        weak
+000029a0: 2065 6467 6520 6275 7420 6f6e 6520 6f66   edge but one of
+000029b0: 2069 7473 206e 6569 6768 626f 7273 2069   its neighbors i
+000029c0: 7320 6120 7374 726f 6e67 2065 6467 6520  s a strong edge 
+000029d0: 7468 656e 0a20 2020 2020 2020 2069 7420  then.        it 
+000029e0: 6973 2061 2073 7472 6f6e 6720 6564 6765  is a strong edge
+000029f0: 2070 6978 656c 2e0a 2020 2020 2020 2020   pixel..        
+00002a00: 7a3d 506c 6561 7365 2074 6872 6573 686f  z=Please thresho
+00002a10: 6c64 2074 6865 2065 6467 6573 2066 6972  ld the edges fir
+00002a20: 7374 2062 7920 6361 6c6c 696e 6720 6361  st by calling ca
+00002a30: 6e6e 795f 7468 7265 7368 6f6c 6428 2972  nny_threshold()r
+00002a40: 0500 0000 7201 0000 0072 5d00 0000 7250  ....r....r]...rP
+00002a50: 0000 0072 5100 0000 2916 724a 0000 0072  ...rQ...).rJ...r
+00002a60: 5e00 0000 7217 0000 0072 2300 0000 723d  ^...r....r#...r=
+00002a70: 0000 0072 1900 0000 7253 0000 0072 5400  ...r....rS...rT.
+00002a80: 0000 7255 0000 0072 4700 0000 7248 0000  ..rU...rG...rH..
+00002a90: 0072 3900 0000 723f 0000 0072 3e00 0000  .r9...r?...r>...
+00002aa0: 724b 0000 0072 5600 0000 7257 0000 0072  rK...rV...rW...r
+00002ab0: 5800 0000 7259 0000 0072 5f00 0000 7216  X...rY...r_...r.
+00002ac0: 0000 00da 0462 6f6f 6c29 0572 4c00 0000  .....bool).rL...
+00002ad0: 725a 0000 0072 5b00 0000 5a08 6564 6765  rZ...r[...Z.edge
+00002ae0: 5f70 6f73 7248 0000 0072 1e00 0000 721e  _posrH...r....r.
+00002af0: 0000 0072 1f00 0000 da0c 6564 6765 5f6a  ...r......edge_j
+00002b00: 6f69 6e69 6e67 5c01 0000 7320 0000 0006  oining\...s ....
+00002b10: 1302 0102 0104 ff2e 031e 010c 010e 0114  ................
+00002b20: 0214 0106 010c 010c 010a 011a 0106 017a  ...............z
+00002b30: 1243 616e 6e79 2e65 6467 655f 6a6f 696e  .Canny.edge_join
+00002b40: 696e 674e 2902 5472 3b00 0000 2908 da08  ingN).Tr;...)...
+00002b50: 5f5f 6e61 6d65 5f5f da0a 5f5f 6d6f 6475  __name__..__modu
+00002b60: 6c65 5f5f da0c 5f5f 7175 616c 6e61 6d65  le__..__qualname
+00002b70: 5f5f da07 5f5f 646f 635f 5f72 4d00 0000  __..__doc__rM...
+00002b80: 725c 0000 0072 6100 0000 7263 0000 0072  r\...ra...rc...r
+00002b90: 1e00 0000 721e 0000 0072 1e00 0000 721f  ....r....r....r.
+00002ba0: 0000 0072 3a00 0000 e000 0000 730c 0000  ...r:.......s...
+00002bb0: 0008 0004 010a 3508 0f08 1c0c 1b72 3a00  ......5......r:.
+00002bc0: 0000 2901 7202 0000 0029 135a 056e 756d  ..).r....).Z.num
+00002bd0: 7079 7217 0000 005a 0c73 6369 7079 2e73  pyr....Z.scipy.s
+00002be0: 6967 6e61 6cda 0673 6967 6e61 6c72 1a00  ignal..signalr..
+00002bf0: 0000 5a0d 7363 6970 792e 6e64 696d 6167  ..Z.scipy.ndimag
+00002c00: 655a 076e 6469 6d61 6765 7242 0000 00da  eZ.ndimagerB....
+00002c10: 0873 7465 6d74 6f6f 6c72 4000 0000 5a11  .stemtoolr@...Z.
+00002c20: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+00002c30: 745a 0670 7970 6c6f 7472 5600 0000 7220  tZ.pyplotrV...r 
+00002c40: 0000 0072 2b00 0000 7236 0000 0072 3900  ...r+...r6...r9.
+00002c50: 0000 da06 6f62 6a65 6374 723a 0000 0072  ....objectr:...r
+00002c60: 1e00 0000 721e 0000 0072 1e00 0000 721f  ....r....r....r.
+00002c70: 0000 00da 083c 6d6f 6475 6c65 3e01 0000  .....<module>...
+00002c80: 0073 1400 0000 0800 0c01 0c01 0801 0c01  .s..............
+00002c90: 0a03 0843 083d 082d 142b                 ...C.=.-.+
```

