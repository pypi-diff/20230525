# Comparing `tmp/dadapy-0.1.1.tar.gz` & `tmp/dadapy-0.2.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dadapy-0.1.1.tar", last modified: Wed Jul 20 13:30:19 2022, max compression
+gzip compressed data, was "dadapy-0.2.0.tar", last modified: Thu May 25 16:40:30 2023, max compression
```

## Comparing `dadapy-0.1.1.tar` & `dadapy-0.2.0.tar`

### file list

```diff
@@ -1,31 +1,41 @@
-drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:30:19.608796 dadapy-0.1.1/
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    11356 2022-01-18 13:07:17.000000 dadapy-0.1.1/LICENSE
--rw-r--r--   0 aldoglielmo   (501) staff       (20)      272 2022-07-20 13:30:19.609127 dadapy-0.1.1/PKG-INFO
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     3754 2022-07-20 13:21:28.000000 dadapy-0.1.1/README.md
-drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:30:19.589310 dadapy-0.1.1/dadapy/
--rw-r--r--   0 aldoglielmo   (501) staff       (20)      137 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/__init__.py
-drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:30:19.603664 dadapy-0.1.1/dadapy/_cython/
--rw-r--r--   0 aldoglielmo   (501) staff       (20)   551699 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/_cython/cython_clustering.c
--rw-r--r--   0 aldoglielmo   (501) staff       (20)   294864 2022-04-30 19:47:34.000000 dadapy-0.1.1/dadapy/_cython/cython_density.c
--rw-r--r--   0 aldoglielmo   (501) staff       (20)   338506 2022-04-30 19:47:34.000000 dadapy-0.1.1/dadapy/_cython/cython_maximum_likelihood_opt.c
--rw-r--r--   0 aldoglielmo   (501) staff       (20)   311925 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/_cython/cython_maximum_likelihood_opt_full.c
-drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:30:19.608139 dadapy-0.1.1/dadapy/_utils/
--rw-r--r--   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/_utils/__init__.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     6418 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/_utils/density_estimation.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     2557 2022-04-30 19:47:34.000000 dadapy-0.1.1/dadapy/_utils/metric_comparisons.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    13780 2022-07-18 14:19:57.000000 dadapy-0.1.1/dadapy/_utils/utils.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     8053 2022-07-08 13:14:24.000000 dadapy-0.1.1/dadapy/base.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    25835 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/clustering.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     1772 2022-04-30 19:47:34.000000 dadapy-0.1.1/dadapy/data.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    14384 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/density_estimation.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    32263 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/id_estimation.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    22460 2022-04-30 19:47:34.000000 dadapy-0.1.1/dadapy/metric_comparisons.py
--rw-r--r--   0 aldoglielmo   (501) staff       (20)    14302 2022-07-20 13:21:28.000000 dadapy-0.1.1/dadapy/plot.py
-drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2022-07-20 13:30:19.595378 dadapy-0.1.1/dadapy.egg-info/
--rw-r--r--   0 aldoglielmo   (501) staff       (20)      272 2022-07-20 13:30:19.000000 dadapy-0.1.1/dadapy.egg-info/PKG-INFO
--rw-r--r--   0 aldoglielmo   (501) staff       (20)      639 2022-07-20 13:30:19.000000 dadapy-0.1.1/dadapy.egg-info/SOURCES.txt
--rw-r--r--   0 aldoglielmo   (501) staff       (20)        1 2022-07-20 13:30:19.000000 dadapy-0.1.1/dadapy.egg-info/dependency_links.txt
--rw-r--r--   0 aldoglielmo   (501) staff       (20)       66 2022-07-20 13:30:19.000000 dadapy-0.1.1/dadapy.egg-info/requires.txt
--rw-r--r--   0 aldoglielmo   (501) staff       (20)        7 2022-07-20 13:30:19.000000 dadapy-0.1.1/dadapy.egg-info/top_level.txt
--rw-r--r--   0 aldoglielmo   (501) staff       (20)      668 2022-07-20 13:30:19.610613 dadapy-0.1.1/setup.cfg
--rw-r--r--   0 aldoglielmo   (501) staff       (20)     1651 2022-07-20 13:28:32.000000 dadapy-0.1.1/setup.py
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.623121 dadapy-0.2.0/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    11356 2022-01-18 13:07:17.000000 dadapy-0.2.0/LICENSE
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    17410 2023-05-25 16:40:30.623246 dadapy-0.2.0/PKG-INFO
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     4030 2023-05-25 14:02:32.000000 dadapy-0.2.0/README.md
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.611276 dadapy-0.2.0/dadapy/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)      276 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/__init__.py
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.619647 dadapy-0.2.0/dadapy/_cython/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   577831 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_cython/cython_clustering.c
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   650542 2022-12-27 08:59:02.000000 dadapy-0.2.0/dadapy/_cython/cython_clustering_v2.c
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   309699 2022-12-27 08:59:02.000000 dadapy-0.2.0/dadapy/_cython/cython_density.c
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   960293 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_cython/cython_distances.c
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   343895 2022-12-27 08:59:02.000000 dadapy-0.2.0/dadapy/_cython/cython_maximum_likelihood_opt.c
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)   347987 2022-12-27 08:59:02.000000 dadapy-0.2.0/dadapy/_cython/cython_maximum_likelihood_opt_full.c
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.622288 dadapy-0.2.0/dadapy/_utils/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)      141 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_utils/__init__.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    12037 2023-05-08 12:12:41.000000 dadapy-0.2.0/dadapy/_utils/density_estimation.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    24097 2023-05-25 16:09:37.000000 dadapy-0.2.0/dadapy/_utils/discrete_functions.py
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.622975 dadapy-0.2.0/dadapy/_utils/discrete_volumes/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    14931 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_utils/discrete_volumes/L_coefficients_exact.dat
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    33242 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_utils/discrete_volumes/L_coefficients_float.dat
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     6589 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_utils/discrete_volumes/V_exact.dat
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     6678 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/_utils/id_estimation.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     2837 2023-05-25 14:02:32.000000 dadapy-0.2.0/dadapy/_utils/metric_comparisons.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    15759 2023-05-25 16:08:36.000000 dadapy-0.2.0/dadapy/_utils/utils.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     9194 2023-05-25 16:09:19.000000 dadapy-0.2.0/dadapy/base.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    44036 2023-05-08 12:12:41.000000 dadapy-0.2.0/dadapy/clustering.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     6887 2023-05-25 14:02:32.000000 dadapy-0.2.0/dadapy/data.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    14595 2023-05-08 12:12:41.000000 dadapy-0.2.0/dadapy/density_estimation.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    56199 2023-05-25 16:09:45.000000 dadapy-0.2.0/dadapy/id_discrete.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    34392 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/id_estimation.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    27045 2023-05-25 14:02:32.000000 dadapy-0.2.0/dadapy/metric_comparisons.py
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    18126 2023-05-25 15:44:37.000000 dadapy-0.2.0/dadapy/plot.py
+drwxr-xr-x   0 aldoglielmo   (501) staff       (20)        0 2023-05-25 16:40:30.612110 dadapy-0.2.0/dadapy.egg-info/
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)    17410 2023-05-25 16:40:30.000000 dadapy-0.2.0/dadapy.egg-info/PKG-INFO
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)      970 2023-05-25 16:40:30.000000 dadapy-0.2.0/dadapy.egg-info/SOURCES.txt
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)        1 2023-05-25 16:40:30.000000 dadapy-0.2.0/dadapy.egg-info/dependency_links.txt
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)       66 2023-05-25 16:40:30.000000 dadapy-0.2.0/dadapy.egg-info/requires.txt
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)        7 2023-05-25 16:40:30.000000 dadapy-0.2.0/dadapy.egg-info/top_level.txt
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)      644 2023-05-25 16:39:51.000000 dadapy-0.2.0/pyproject.toml
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)      671 2023-05-25 16:40:30.623829 dadapy-0.2.0/setup.cfg
+-rw-r--r--   0 aldoglielmo   (501) staff       (20)     2340 2023-05-25 15:44:37.000000 dadapy-0.2.0/setup.py
```

### Comparing `dadapy-0.1.1/LICENSE` & `dadapy-0.2.0/LICENSE`

 * *Files identical despite different names*

### Comparing `dadapy-0.1.1/README.md` & `dadapy-0.2.0/README.md`

 * *Files 12% similar despite different names*

```diff
@@ -1,14 +1,15 @@
 <img src="https://raw.githubusercontent.com/sissa-data-science/DADApy/master/logo/logo_1_horizontal_transparent_v2.png" width="500">
 
 [![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
 [![Imports: isort](https://img.shields.io/badge/%20imports-isort-%231674b1?style=flat&labelColor=ef8336)](https://pycqa.github.io/isort/)
 [![codecov](https://codecov.io/gh/sissa-data-science/DADApy/branch/main/graph/badge.svg?token=X4M0KWAPO5)](https://codecov.io/gh/sissa-data-science/DADApy)
-![GitHub Workflow Status](https://img.shields.io/github/workflow/status/sissa-data-science/dadapy/test?label=test)
-![GitHub Workflow Status](https://img.shields.io/github/workflow/status/sissa-data-science/dadapy/lint?label=lint)
+![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/sissa-data-science/dadapy/test.yml?label=test)
+![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/sissa-data-science/dadapy/lint.yml?label=lint)
+![GitHub Workflow Status](https://img.shields.io/github/actions/workflow/status/sissa-data-science/dadapy/lint.yml?label=docs)
 
 DADApy is a Python package for the characterisation of manifolds in high dimensional spaces.
 
 
 # Homepage
 For more details and tutorials, visit the homepage at:
 [https://dadapy.readthedocs.io/](https://dadapy.readthedocs.io/)
@@ -41,23 +42,23 @@
 # Currently implemented algorithms
 
 - Intrinsic dimension estimators
      - 
 - Two-NN estimator 
   > Facco et al., *Scientific Reports* (2017)
 - Gride estimator
-  > Denti et al., *arXiv* (2021)
+  > Denti et al., *Scientific Reports* (2022)
 - Density estimators
     - 
 - kNN estimator
 - k*NN estimator (kNN with adaptive choice of k)
 - PAk estimator
   > Rodriguez et al., *JCTC* (2018)
 
-- Density peaks estimators
+- Density peaks clustering methods
     - 
 - Density peaks clustering 
   > Rodriguez and Laio, *Science* (2014)
 - Advanced density peaks clustering
   > d’Errico et al., *Information Sciences* (2021)
 - k-peak clustering
   > Sormani, Rodriguez and Laio, *JCTC* (2020)
@@ -91,21 +92,23 @@
 git clone https://github.com/sissa-data-science/DADApy.git
 cd DADApy
 pip install .
 ```
 
 # Citing DADApy
 
-A description of the package is available [here](https://arxiv.org/abs/2205.03373).
+A description of the package is available [here](https://www.sciencedirect.com/science/article/pii/S2666389922002070).
 
 Please consider citing it if you found this package useful for your research
 
 ```bib
 @article{dadapy,
-    author = {Glielmo, Aldo and Macocco, Iuri and Doimo, Diego and Carli, Matteo and Zeni, Claudio and Wild, Romina and d'Errico, Maria and Rodriguez, Alex and Laio Alessandro},
-    title = {{DADApy: Distance-based Analysis of DAta-manifolds in Python}},
-    journal = {arXiv preprint arXiv:2205.03373},
+    title = {DADApy: Distance-based analysis of data-manifolds in Python},
+    journal = {Patterns},
+    pages = {100589},
     year = {2022},
-    doi = {10.48550/arXiv.2205.03373},
-    url = {https://arxiv.org/abs/2205.03373},
+    issn = {2666-3899},
+    doi = {https://doi.org/10.1016/j.patter.2022.100589},
+    url = {https://www.sciencedirect.com/science/article/pii/S2666389922002070},
+    author = {Aldo Glielmo and Iuri Macocco and Diego Doimo and Matteo Carli and Claudio Zeni and Romina Wild and Maria d’Errico and Alex Rodriguez and Alessandro Laio},
     }
 ```
```

### Comparing `dadapy-0.1.1/dadapy/_cython/cython_clustering.c` & `dadapy-0.2.0/dadapy/_cython/cython_clustering.c`

 * *Files 4% similar despite different names*

```diff
@@ -972,213 +972,213 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":690
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":690
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":691
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":691
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":692
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":693
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":693
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":697
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":697
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":698
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":698
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":699
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":700
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":700
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":704
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":704
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":705
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":705
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":714
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":714
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":715
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":715
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":716
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":716
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":718
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":718
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":719
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":719
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":720
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":720
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":722
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":722
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":723
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":723
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":725
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":725
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":726
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":726
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":727
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":727
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "dadapy/_cython/cython_clustering.pyx":13
- * boolTYPE = np.bool
+/* "dadapy/_cython/cython_clustering.pyx":14
+ * 
  * 
  * ctypedef np.int_t DTYPE_t             # <<<<<<<<<<<<<<
  * ctypedef np.float64_t floatTYPE_t
  * 
  */
 typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t;
 
-/* "dadapy/_cython/cython_clustering.pyx":14
+/* "dadapy/_cython/cython_clustering.pyx":15
  * 
  * ctypedef np.int_t DTYPE_t
  * ctypedef np.float64_t floatTYPE_t             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False)
  */
 typedef __pyx_t_5numpy_float64_t __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t;
@@ -1205,42 +1205,42 @@
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":729
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":730
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":730
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":731
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":731
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":733
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":733
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -1432,48 +1432,62 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyCFunctionFastCall.proto */
+#if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
+#else
+#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
+#endif
+
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
 #endif
 
+/* ExtTypeTest.proto */
+static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
+
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallNoArg.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
 #else
 #define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
 #endif
 
-/* PyCFunctionFastCall.proto */
-#if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
-#else
-#define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
-#endif
-
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
-/* ExtTypeTest.proto */
-static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);
-
 #define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
 #define __Pyx_BufPtrStrided2d(type, buf, i0, s0, i1, s1) (type)((char*)buf + i0 * s0 + i1 * s1)
+/* PyObjectFormat.proto */
+#if CYTHON_USE_UNICODE_WRITER
+static PyObject* __Pyx_PyObject_Format(PyObject* s, PyObject* f);
+#else
+#define __Pyx_PyObject_Format(s, f) PyObject_Format(s, f)
+#endif
+
+/* IncludeStringH.proto */
+#include <string.h>
+
+/* JoinPyUnicode.proto */
+static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
+                                      Py_UCS4 max_char);
+
 /* PyObjectCall2Args.proto */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
 
 /* GetItemInt.proto */
 #define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
     (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
     __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
@@ -1554,14 +1568,36 @@
     __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) :\
     (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) :\
                __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
 static int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
 static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                                int is_list, int wraparound, int boundscheck);
 
+/* PyObjectFormatSimple.proto */
+#if CYTHON_COMPILING_IN_PYPY
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        PyObject_Format(s, f))
+#elif PY_MAJOR_VERSION < 3
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        likely(PyString_CheckExact(s)) ? PyUnicode_FromEncodedObject(s, NULL, "strict") :\
+        PyObject_Format(s, f))
+#elif CYTHON_USE_TYPE_SLOTS
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        likely(PyLong_CheckExact(s)) ? PyLong_Type.tp_str(s) :\
+        likely(PyFloat_CheckExact(s)) ? PyFloat_Type.tp_str(s) :\
+        PyObject_Format(s, f))
+#else
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        PyObject_Format(s, f))
+#endif
+
 /* PyThreadStateGet.proto */
 #if CYTHON_FAST_THREAD_STATE
 #define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
 #define __Pyx_PyThreadState_assign  __pyx_tstate = __Pyx_PyThreadState_Current;
 #define __Pyx_PyErr_Occurred()  __pyx_tstate->curexc_type
 #else
 #define __Pyx_PyThreadState_declare
@@ -1896,14 +1932,15 @@
 static const char __pyx_k_Z[] = "Z";
 static const char __pyx_k_c[] = "c";
 static const char __pyx_k_g[] = "g";
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k_j[] = "j";
 static const char __pyx_k_k[] = "k";
 static const char __pyx_k_t[] = "t";
+static const char __pyx_k_3f[] = " .3f";
 static const char __pyx_k__6[] = "_";
 static const char __pyx_k_a1[] = "a1";
 static const char __pyx_k_a2[] = "a2";
 static const char __pyx_k_c1[] = "c1";
 static const char __pyx_k_c2[] = "c2";
 static const char __pyx_k_cp[] = "cp";
 static const char __pyx_k_e1[] = "e1";
@@ -1916,76 +1953,76 @@
 static const char __pyx_k_p1[] = "p1";
 static const char __pyx_k_p2[] = "p2";
 static const char __pyx_k_po[] = "po";
 static const char __pyx_k_pp[] = "pp";
 static const char __pyx_k_x1[] = "x1";
 static const char __pyx_k_ele[] = "ele";
 static const char __pyx_k_end[] = "end";
-static const char __pyx_k_int[] = "int";
+static const char __pyx_k_lag[] = "lag";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_pos[] = "pos";
-static const char __pyx_k_sec[] = "sec";
+static const char __pyx_k_sec[] = " sec";
 static const char __pyx_k_tmp[] = "tmp";
 static const char __pyx_k_Nele[] = "Nele";
-static const char __pyx_k_bool[] = "bool";
 static const char __pyx_k_copy[] = "copy";
 static const char __pyx_k_file[] = "file";
 static const char __pyx_k_flag[] = "flag";
 static const char __pyx_k_halo[] = "halo";
 static const char __pyx_k_imod[] = "imod";
 static const char __pyx_k_ipos[] = "ipos";
 static const char __pyx_k_jmod[] = "jmod";
 static const char __pyx_k_jpos[] = "jpos";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_maxk[] = "maxk";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_nnum[] = "nnum";
 static const char __pyx_k_ones[] = "ones";
-static const char __pyx_k_sec2[] = "sec2";
 static const char __pyx_k_secp[] = "secp";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_time[] = "time";
 static const char __pyx_k_verb[] = "verb";
+static const char __pyx_k_warn[] = "warn";
 static const char __pyx_k_DTYPE[] = "DTYPE";
 static const char __pyx_k_Nclus[] = "Nclus";
 static const char __pyx_k_Rho_c[] = "Rho_c";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_check[] = "check";
 static const char __pyx_k_cindx[] = "cindx";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_empty[] = "empty";
-static const char __pyx_k_float[] = "float";
 static const char __pyx_k_index[] = "index";
+static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_kstar[] = "kstar";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
+static const char __pyx_k_sec_2[] = " sec ";
+static const char __pyx_k_sec_3[] = "sec";
 static const char __pyx_k_sortg[] = "sortg";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_argmax[] = "argmax";
 static const char __pyx_k_clsurv[] = "clsurv";
 static const char __pyx_k_extend[] = "extend";
-static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_labels[] = "labels";
 static const char __pyx_k_maxpos[] = "maxpos";
 static const char __pyx_k_repeat[] = "repeat";
 static const char __pyx_k_Nclus_m[] = "Nclus_m";
 static const char __pyx_k_Rho_err[] = "Rho_err";
-static const char __pyx_k_Rho_min[] = "Rho_min";
 static const char __pyx_k_argsort[] = "argsort";
 static const char __pyx_k_centers[] = "_centers_";
+static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_max_rho[] = "max_rho";
 static const char __pyx_k_Last_cls[] = "Last_cls";
 static const char __pyx_k_Rho_bord[] = "Rho_bord";
 static const char __pyx_k_Rho_halo[] = "Rho_halo";
 static const char __pyx_k_barriers[] = "barriers";
-static const char __pyx_k_boolTYPE[] = "boolTYPE";
 static const char __pyx_k_clstruct[] = "clstruct";
 static const char __pyx_k_out_bord[] = "out_bord";
+static const char __pyx_k_warnings[] = "warnings";
 static const char __pyx_k_centers_2[] = "centers";
 static const char __pyx_k_centers_3[] = "centers_";
 static const char __pyx_k_centers_m[] = "centers_m";
 static const char __pyx_k_floatTYPE[] = "floatTYPE";
 static const char __pyx_k_maxposidx[] = "maxposidx";
 static const char __pyx_k_to_remove[] = "to_remove";
 static const char __pyx_k_Point_bord[] = "Point_bord";
@@ -2002,65 +2039,68 @@
 static const char __pyx_k_Last_cls_halo[] = "Last_cls_halo";
 static const char __pyx_k_ele_neighbors[] = "ele_neighbors";
 static const char __pyx_k_init_succeded[] = "init succeded";
 static const char __pyx_k_len_to_remove[] = "len_to_remove";
 static const char __pyx_k_Rho_bord_err_m[] = "Rho_bord_err_m";
 static const char __pyx_k_cluster_init_2[] = "cluster_init";
 static const char __pyx_k_return_indices[] = "return_indices";
+static const char __pyx_k_Final_operations[] = "Final operations: ";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_compute_clustering[] = "_compute_clustering";
 static const char __pyx_k_all_removed_centers[] = "all_removed_centers";
 static const char __pyx_k_cython_clustering_pyx[] = "cython_clustering.pyx";
 static const char __pyx_k_higher_density_centers[] = "higher_density_centers";
 static const char __pyx_k_ind_removed_centers_ele[] = "ind_removed_centers_ele";
 static const char __pyx_k_higher_density_centers_ele[] = "higher_density_centers_ele";
-static const char __pyx_k_0_0_2f_seconds_identifying_the[] = "{0:0.2f} seconds identifying the borders";
-static const char __pyx_k_0_0_2f_seconds_clustering_befor[] = "{0:0.2f} seconds clustering before multimodality test";
-static const char __pyx_k_0_0_2f_seconds_for_final_operat[] = "{0:0.2f} seconds for final operations";
-static const char __pyx_k_0_0_2f_seconds_with_multimodali[] = "{0:0.2f} seconds with multimodality test";
+static const char __pyx_k_Further_checking_on_centers[] = "Further checking on centers: ";
+static const char __pyx_k_Multimodality_test_finished[] = "Multimodality test finished: ";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
+static const char __pyx_k_Identification_of_the_saddle_poi[] = "Identification of the saddle points: ";
 static const char __pyx_k_Number_of_clusters_before_multim[] = "Number of clusters before multimodality test=";
+static const char __pyx_k_Preliminary_assignation_finished[] = "Preliminary assignation finished: ";
+static const char __pyx_k_Pruning_of_the_centers_wrongly_i[] = "Pruning of the centers wrongly identified in part one: ";
+static const char __pyx_k_Raw_identification_of_the_putati[] = "Raw identification of the putative centers: ";
+static const char __pyx_k_There_are_10k_initial_putative_c[] = "There are > 10k initial putative clusters:\n        the matrices of the saddle points may cause out of memory error (6x Nclus x Nclus --> > 4.8 GB required).\n        If this is the case, call compute_clustering_ADP_pure_python(v2 = True). Ignore the warning otherwise.";
 static const char __pyx_k_dadapy__cython_cython_clustering[] = "dadapy._cython.cython_clustering";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
-static const char __pyx_k_part_one_finished_Raw_identifica[] = "part one finished: Raw identification of the putative centers";
-static const char __pyx_k_part_tree_finished_Pruning_of_th[] = "part tree finished: Pruning of the centers wrongly identified in part one.";
-static const char __pyx_k_part_two_finished_Further_checki[] = "part two finished: Further checking on centers";
-static PyObject *__pyx_kp_s_0_0_2f_seconds_clustering_befor;
-static PyObject *__pyx_kp_s_0_0_2f_seconds_for_final_operat;
-static PyObject *__pyx_kp_s_0_0_2f_seconds_identifying_the;
-static PyObject *__pyx_kp_s_0_0_2f_seconds_with_multimodali;
+static PyObject *__pyx_kp_u_3f;
 static PyObject *__pyx_n_s_DTYPE;
+static PyObject *__pyx_kp_u_Final_operations;
+static PyObject *__pyx_kp_u_Further_checking_on_centers;
+static PyObject *__pyx_kp_u_Identification_of_the_saddle_poi;
 static PyObject *__pyx_n_s_ImportError;
 static PyObject *__pyx_n_s_Last_cls;
 static PyObject *__pyx_n_s_Last_cls_halo;
+static PyObject *__pyx_kp_u_Multimodality_test_finished;
 static PyObject *__pyx_n_s_Nclus;
 static PyObject *__pyx_n_s_Nclus_m;
 static PyObject *__pyx_n_s_Nele;
 static PyObject *__pyx_kp_s_Number_of_clusters_before_multim;
 static PyObject *__pyx_n_s_Point_bord;
 static PyObject *__pyx_n_s_Point_bord_m;
+static PyObject *__pyx_kp_u_Preliminary_assignation_finished;
+static PyObject *__pyx_kp_u_Pruning_of_the_centers_wrongly_i;
+static PyObject *__pyx_kp_u_Raw_identification_of_the_putati;
 static PyObject *__pyx_n_s_Rho_bord;
 static PyObject *__pyx_n_s_Rho_bord_err;
 static PyObject *__pyx_n_s_Rho_bord_err_m;
 static PyObject *__pyx_n_s_Rho_bord_m;
 static PyObject *__pyx_n_s_Rho_c;
 static PyObject *__pyx_n_s_Rho_err;
 static PyObject *__pyx_n_s_Rho_halo;
-static PyObject *__pyx_n_s_Rho_min;
+static PyObject *__pyx_kp_s_There_are_10k_initial_putative_c;
 static PyObject *__pyx_n_s_Z;
 static PyObject *__pyx_n_s__6;
 static PyObject *__pyx_n_s_a1;
 static PyObject *__pyx_n_s_a2;
 static PyObject *__pyx_n_s_all_removed_centers;
 static PyObject *__pyx_n_s_argmax;
 static PyObject *__pyx_n_s_argsort;
 static PyObject *__pyx_n_s_array;
 static PyObject *__pyx_n_s_barriers;
-static PyObject *__pyx_n_s_bool;
-static PyObject *__pyx_n_s_boolTYPE;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_s_c1;
 static PyObject *__pyx_n_s_c2;
 static PyObject *__pyx_n_s_centers;
 static PyObject *__pyx_n_s_centers_2;
 static PyObject *__pyx_n_s_centers_3;
 static PyObject *__pyx_n_s_centers_m;
@@ -2084,38 +2124,38 @@
 static PyObject *__pyx_n_s_ele;
 static PyObject *__pyx_n_s_ele_neighbors;
 static PyObject *__pyx_n_s_empty;
 static PyObject *__pyx_n_s_end;
 static PyObject *__pyx_n_s_extend;
 static PyObject *__pyx_n_s_file;
 static PyObject *__pyx_n_s_flag;
-static PyObject *__pyx_n_s_float;
+static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_floatTYPE;
-static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_g;
 static PyObject *__pyx_n_s_halo;
 static PyObject *__pyx_n_s_higher_density_centers;
 static PyObject *__pyx_n_s_higher_density_centers_ele;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_imod;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_ind_removed_centers_ele;
 static PyObject *__pyx_n_s_index;
 static PyObject *__pyx_kp_s_init_succeded;
-static PyObject *__pyx_n_s_int;
+static PyObject *__pyx_n_s_int64;
 static PyObject *__pyx_n_s_intersect1d;
 static PyObject *__pyx_n_s_ipos;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_jj;
 static PyObject *__pyx_n_s_jmod;
 static PyObject *__pyx_n_s_jpos;
 static PyObject *__pyx_n_s_k;
 static PyObject *__pyx_n_s_kk;
 static PyObject *__pyx_n_s_kstar;
 static PyObject *__pyx_n_s_labels;
+static PyObject *__pyx_n_s_lag;
 static PyObject *__pyx_n_s_len_centers;
 static PyObject *__pyx_n_s_len_to_remove;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_max;
 static PyObject *__pyx_n_s_max_center;
 static PyObject *__pyx_n_s_max_rho;
 static PyObject *__pyx_n_s_maxk;
@@ -2129,50 +2169,50 @@
 static PyObject *__pyx_n_s_numpy;
 static PyObject *__pyx_kp_s_numpy_core_multiarray_failed_to;
 static PyObject *__pyx_kp_s_numpy_core_umath_failed_to_impor;
 static PyObject *__pyx_n_s_ones;
 static PyObject *__pyx_n_s_out_bord;
 static PyObject *__pyx_n_s_p1;
 static PyObject *__pyx_n_s_p2;
-static PyObject *__pyx_kp_s_part_one_finished_Raw_identifica;
-static PyObject *__pyx_kp_s_part_tree_finished_Pruning_of_th;
-static PyObject *__pyx_kp_s_part_two_finished_Further_checki;
 static PyObject *__pyx_n_s_po;
 static PyObject *__pyx_n_s_pos;
 static PyObject *__pyx_n_s_pp;
 static PyObject *__pyx_n_s_print;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_repeat;
 static PyObject *__pyx_n_s_return_indices;
-static PyObject *__pyx_n_s_sec;
-static PyObject *__pyx_n_s_sec2;
+static PyObject *__pyx_kp_u_sec;
+static PyObject *__pyx_kp_u_sec_2;
+static PyObject *__pyx_n_s_sec_3;
 static PyObject *__pyx_n_s_secp;
 static PyObject *__pyx_n_s_sortg;
 static PyObject *__pyx_n_s_t;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_time;
 static PyObject *__pyx_n_s_tmp;
 static PyObject *__pyx_n_s_to_remove;
 static PyObject *__pyx_n_s_verb;
+static PyObject *__pyx_n_s_warn;
+static PyObject *__pyx_n_s_warnings;
 static PyObject *__pyx_n_s_x1;
 static PyObject *__pyx_n_s_zeros;
-static PyObject *__pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Z, int __pyx_v_halo, PyArrayObject *__pyx_v_kstar, PyArrayObject *__pyx_v_dist_indices, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxk, int __pyx_v_verb, PyArrayObject *__pyx_v_Rho_err, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Rho_min, PyArrayObject *__pyx_v_Rho_c, PyArrayObject *__pyx_v_g, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nele); /* proto */
+static PyObject *__pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Z, int __pyx_v_halo, PyArrayObject *__pyx_v_kstar, PyArrayObject *__pyx_v_dist_indices, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxk, int __pyx_v_verb, PyArrayObject *__pyx_v_Rho_err, PyArrayObject *__pyx_v_Rho_c, PyArrayObject *__pyx_v_g, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nele); /* proto */
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_slice_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__7;
 static PyObject *__pyx_codeobj__8;
 /* Late includes */
 
-/* "dadapy/_cython/cython_clustering.pyx":19
+/* "dadapy/_cython/cython_clustering.pyx":20
  * @cython.cdivision(True)
  * 
  * def _compute_clustering(floatTYPE_t Z,             # <<<<<<<<<<<<<<
  *                         bint halo,
  *                         np.ndarray[DTYPE_t, ndim = 1] kstar,
  */
 
@@ -2183,33 +2223,30 @@
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Z;
   int __pyx_v_halo;
   PyArrayObject *__pyx_v_kstar = 0;
   PyArrayObject *__pyx_v_dist_indices = 0;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxk;
   int __pyx_v_verb;
   PyArrayObject *__pyx_v_Rho_err = 0;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Rho_min;
   PyArrayObject *__pyx_v_Rho_c = 0;
   PyArrayObject *__pyx_v_g = 0;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nele;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_compute_clustering (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_Z,&__pyx_n_s_halo,&__pyx_n_s_kstar,&__pyx_n_s_dist_indices,&__pyx_n_s_maxk,&__pyx_n_s_verb,&__pyx_n_s_Rho_err,&__pyx_n_s_Rho_min,&__pyx_n_s_Rho_c,&__pyx_n_s_g,&__pyx_n_s_Nele,0};
-    PyObject* values[11] = {0,0,0,0,0,0,0,0,0,0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_Z,&__pyx_n_s_halo,&__pyx_n_s_kstar,&__pyx_n_s_dist_indices,&__pyx_n_s_maxk,&__pyx_n_s_verb,&__pyx_n_s_Rho_err,&__pyx_n_s_Rho_c,&__pyx_n_s_g,&__pyx_n_s_Nele,0};
+    PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
-        case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
-        CYTHON_FALLTHROUGH;
         case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
         CYTHON_FALLTHROUGH;
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
         case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
@@ -2234,149 +2271,142 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Z)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_halo)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 1); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 1); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kstar)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 2); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 2); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dist_indices)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 3); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 3); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_maxk)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 4); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 4); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_verb)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 5); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 5); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Rho_err)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 6); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 6); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
-        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Rho_min)) != 0)) kw_args--;
+        if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Rho_c)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 7); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 7); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
-        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Rho_c)) != 0)) kw_args--;
+        if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 8); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 8); __PYX_ERR(0, 20, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
-        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 9); __PYX_ERR(0, 19, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case 10:
-        if (likely((values[10] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Nele)) != 0)) kw_args--;
+        if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_Nele)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, 10); __PYX_ERR(0, 19, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, 9); __PYX_ERR(0, 20, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_clustering") < 0)) __PYX_ERR(0, 19, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_clustering") < 0)) __PYX_ERR(0, 20, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 11) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
       values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
       values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
       values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
       values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
-      values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
     }
-    __pyx_v_Z = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_Z == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 19, __pyx_L3_error)
-    __pyx_v_halo = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_halo == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 20, __pyx_L3_error)
+    __pyx_v_Z = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_Z == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 20, __pyx_L3_error)
+    __pyx_v_halo = __Pyx_PyObject_IsTrue(values[1]); if (unlikely((__pyx_v_halo == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 21, __pyx_L3_error)
     __pyx_v_kstar = ((PyArrayObject *)values[2]);
     __pyx_v_dist_indices = ((PyArrayObject *)values[3]);
-    __pyx_v_maxk = __Pyx_PyInt_As_npy_long(values[4]); if (unlikely((__pyx_v_maxk == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 23, __pyx_L3_error)
-    __pyx_v_verb = __Pyx_PyObject_IsTrue(values[5]); if (unlikely((__pyx_v_verb == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 24, __pyx_L3_error)
+    __pyx_v_maxk = __Pyx_PyInt_As_npy_long(values[4]); if (unlikely((__pyx_v_maxk == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 24, __pyx_L3_error)
+    __pyx_v_verb = __Pyx_PyObject_IsTrue(values[5]); if (unlikely((__pyx_v_verb == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 25, __pyx_L3_error)
     __pyx_v_Rho_err = ((PyArrayObject *)values[6]);
-    __pyx_v_Rho_min = __pyx_PyFloat_AsDouble(values[7]); if (unlikely((__pyx_v_Rho_min == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 26, __pyx_L3_error)
-    __pyx_v_Rho_c = ((PyArrayObject *)values[8]);
-    __pyx_v_g = ((PyArrayObject *)values[9]);
-    __pyx_v_Nele = __Pyx_PyInt_As_npy_long(values[10]); if (unlikely((__pyx_v_Nele == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L3_error)
+    __pyx_v_Rho_c = ((PyArrayObject *)values[7]);
+    __pyx_v_g = ((PyArrayObject *)values[8]);
+    __pyx_v_Nele = __Pyx_PyInt_As_npy_long(values[9]); if (unlikely((__pyx_v_Nele == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 11, 11, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 19, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_compute_clustering", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 20, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("dadapy._cython.cython_clustering._compute_clustering", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_kstar), __pyx_ptype_5numpy_ndarray, 1, "kstar", 0))) __PYX_ERR(0, 21, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dist_indices), __pyx_ptype_5numpy_ndarray, 1, "dist_indices", 0))) __PYX_ERR(0, 22, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_Rho_err), __pyx_ptype_5numpy_ndarray, 1, "Rho_err", 0))) __PYX_ERR(0, 25, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_kstar), __pyx_ptype_5numpy_ndarray, 1, "kstar", 0))) __PYX_ERR(0, 22, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dist_indices), __pyx_ptype_5numpy_ndarray, 1, "dist_indices", 0))) __PYX_ERR(0, 23, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_Rho_err), __pyx_ptype_5numpy_ndarray, 1, "Rho_err", 0))) __PYX_ERR(0, 26, __pyx_L1_error)
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_Rho_c), __pyx_ptype_5numpy_ndarray, 1, "Rho_c", 0))) __PYX_ERR(0, 27, __pyx_L1_error)
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g), __pyx_ptype_5numpy_ndarray, 1, "g", 0))) __PYX_ERR(0, 28, __pyx_L1_error)
-  __pyx_r = __pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(__pyx_self, __pyx_v_Z, __pyx_v_halo, __pyx_v_kstar, __pyx_v_dist_indices, __pyx_v_maxk, __pyx_v_verb, __pyx_v_Rho_err, __pyx_v_Rho_min, __pyx_v_Rho_c, __pyx_v_g, __pyx_v_Nele);
+  __pyx_r = __pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(__pyx_self, __pyx_v_Z, __pyx_v_halo, __pyx_v_kstar, __pyx_v_dist_indices, __pyx_v_maxk, __pyx_v_verb, __pyx_v_Rho_err, __pyx_v_Rho_c, __pyx_v_g, __pyx_v_Nele);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Z, int __pyx_v_halo, PyArrayObject *__pyx_v_kstar, PyArrayObject *__pyx_v_dist_indices, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxk, int __pyx_v_verb, PyArrayObject *__pyx_v_Rho_err, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Rho_min, PyArrayObject *__pyx_v_Rho_c, PyArrayObject *__pyx_v_g, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nele) {
+static PyObject *__pyx_pf_6dadapy_7_cython_17cython_clustering__compute_clustering(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_Z, int __pyx_v_halo, PyArrayObject *__pyx_v_kstar, PyArrayObject *__pyx_v_dist_indices, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxk, int __pyx_v_verb, PyArrayObject *__pyx_v_Rho_err, PyArrayObject *__pyx_v_Rho_c, PyArrayObject *__pyx_v_g, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nele) {
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_i;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_j;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_t;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_Nclus;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_check;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_index;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_maxposidx;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_a1;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_a2;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_e1;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_e2;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_maxpos;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_lag;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_sec;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_tmp;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_jmod;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_imod;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_c;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_cp;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_k;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_po;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_p2;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_pp;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_p1;
-  PyObject *__pyx_v_sec = NULL;
   PyArrayObject *__pyx_v__centers_ = 0;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_len_centers;
   PyArrayObject *__pyx_v_to_remove = 0;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_len_to_remove;
   __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_v_max_rho;
   PyArrayObject *__pyx_v_centers = 0;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_v_cindx;
@@ -2390,15 +2420,14 @@
   CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
   PyObject *__pyx_v_ind_removed_centers_ele = NULL;
   PyObject *__pyx_v_higher_density_centers = NULL;
   PyObject *__pyx_v_higher_density_centers_ele = NULL;
   PyObject *__pyx_v_max_center = NULL;
   PyObject *__pyx_v_clstruct = NULL;
   PyObject *__pyx_v_x1 = NULL;
-  PyObject *__pyx_v_sec2 = NULL;
   PyArrayObject *__pyx_v_Rho_bord = 0;
   PyArrayObject *__pyx_v_Rho_bord_err = 0;
   PyArrayObject *__pyx_v_Point_bord = 0;
   PyArrayObject *__pyx_v_pos = 0;
   PyArrayObject *__pyx_v_ipos = 0;
   PyArrayObject *__pyx_v_jpos = 0;
   PyArrayObject *__pyx_v_cluster_init = 0;
@@ -2465,47 +2494,49 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
   PyArrayObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_9;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t __pyx_t_9;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_10;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_11;
-  Py_ssize_t __pyx_t_12;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_13;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_12;
+  Py_ssize_t __pyx_t_13;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_14;
   __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_15;
-  Py_ssize_t __pyx_t_16;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
-  PyArrayObject *__pyx_t_19 = NULL;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_20;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_21;
-  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_22;
-  PyArrayObject *__pyx_t_23 = NULL;
-  PyArrayObject *__pyx_t_24 = NULL;
-  int __pyx_t_25;
-  PyObject *(*__pyx_t_26)(PyObject *);
-  int __pyx_t_27;
-  PyArrayObject *__pyx_t_28 = NULL;
-  PyArrayObject *__pyx_t_29 = NULL;
-  PyArrayObject *__pyx_t_30 = NULL;
+  Py_ssize_t __pyx_t_19;
+  PyArrayObject *__pyx_t_20 = NULL;
+  Py_ssize_t __pyx_t_21;
+  Py_UCS4 __pyx_t_22;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_23;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_24;
+  __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t __pyx_t_25;
+  PyArrayObject *__pyx_t_26 = NULL;
+  PyArrayObject *__pyx_t_27 = NULL;
+  int __pyx_t_28;
+  PyObject *(*__pyx_t_29)(PyObject *);
+  int __pyx_t_30;
   PyArrayObject *__pyx_t_31 = NULL;
   PyArrayObject *__pyx_t_32 = NULL;
   PyArrayObject *__pyx_t_33 = NULL;
   PyArrayObject *__pyx_t_34 = NULL;
-  Py_ssize_t __pyx_t_35;
-  PyObject *(*__pyx_t_36)(PyObject *);
-  Py_ssize_t __pyx_t_37;
-  PyArrayObject *__pyx_t_38 = NULL;
-  PyArrayObject *__pyx_t_39 = NULL;
-  long __pyx_t_40;
-  long __pyx_t_41;
+  PyArrayObject *__pyx_t_35 = NULL;
+  PyArrayObject *__pyx_t_36 = NULL;
+  PyArrayObject *__pyx_t_37 = NULL;
+  PyObject *(*__pyx_t_38)(PyObject *);
+  Py_ssize_t __pyx_t_39;
+  PyArrayObject *__pyx_t_40 = NULL;
+  PyArrayObject *__pyx_t_41 = NULL;
+  long __pyx_t_42;
+  long __pyx_t_43;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_compute_clustering", 0);
   __pyx_pybuffer__centers_.pybuffer.buf = NULL;
   __pyx_pybuffer__centers_.refcount = 0;
   __pyx_pybuffernd__centers_.data = NULL;
@@ -2576,129 +2607,99 @@
   __pyx_pybuffernd_Rho_c.rcbuffer = &__pyx_pybuffer_Rho_c;
   __pyx_pybuffer_g.pybuffer.buf = NULL;
   __pyx_pybuffer_g.refcount = 0;
   __pyx_pybuffernd_g.data = NULL;
   __pyx_pybuffernd_g.rcbuffer = &__pyx_pybuffer_g;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_v_kstar, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 19, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_v_kstar, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_pybuffernd_kstar.diminfo[0].strides = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_kstar.diminfo[0].shape = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 19, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_pybuffernd_dist_indices.diminfo[0].strides = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dist_indices.diminfo[0].shape = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dist_indices.diminfo[1].strides = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dist_indices.diminfo[1].shape = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_err.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rho_err, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 19, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_err.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rho_err, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_pybuffernd_Rho_err.diminfo[0].strides = __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rho_err.diminfo[0].shape = __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_c.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rho_c, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 19, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_c.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rho_c, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_pybuffernd_Rho_c.diminfo[0].strides = __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rho_c.diminfo[0].shape = __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 19, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g.rcbuffer->pybuffer, (PyObject*)__pyx_v_g, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_pybuffernd_g.diminfo[0].strides = __pyx_pybuffernd_g.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g.diminfo[0].shape = __pyx_pybuffernd_g.rcbuffer->pybuffer.shape[0];
 
-  /* "dadapy/_cython/cython_clustering.pyx":43
- *     cdef DTYPE_t po, p2, pp, p1
- * 
- *     sec = time.time()             # <<<<<<<<<<<<<<
- * 
- *     cdef np.ndarray[DTYPE_t, ndim = 1]  _centers_ = np.repeat(-1, Nele)
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_2);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
-    }
-  }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_sec = __pyx_t_1;
-  __pyx_t_1 = 0;
-
   /* "dadapy/_cython/cython_clustering.pyx":45
- *     sec = time.time()
+ * 
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  _centers_ = np.repeat(-1, Nele)             # <<<<<<<<<<<<<<
  *     cdef DTYPE_t len_centers = 0
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 45, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_repeat); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 45, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_repeat); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 45, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
-  if (PyFunction_Check(__pyx_t_2)) {
-    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_neg_1, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+  if (PyFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_neg_1, __pyx_t_2};
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
-  if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
-    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_neg_1, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+  if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
+    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_int_neg_1, __pyx_t_2};
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
     __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 45, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_int_neg_1);
     __Pyx_GIVEREF(__pyx_int_neg_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_int_neg_1);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_t_3);
-    __pyx_t_3 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_t_2);
+    __pyx_t_2 = 0;
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 45, __pyx_L1_error)
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd__centers_.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v__centers_ = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf = NULL;
       __PYX_ERR(0, 45, __pyx_L1_error)
@@ -2718,4317 +2719,4821 @@
  */
   __pyx_v_len_centers = 0;
 
   /* "dadapy/_cython/cython_clustering.pyx":48
  *     cdef DTYPE_t len_centers = 0
  * 
  *     if verb: print("init succeded")             # <<<<<<<<<<<<<<
+ *     sec = time.time()
  * 
- * # This for looks for the centers. A point is a center if its g is bigger than the one of all its neighbors
  */
   __pyx_t_8 = (__pyx_v_verb != 0);
   if (__pyx_t_8) {
     if (__Pyx_PrintOne(0, __pyx_kp_s_init_succeded) < 0) __PYX_ERR(0, 48, __pyx_L1_error)
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":51
+  /* "dadapy/_cython/cython_clustering.pyx":49
+ * 
+ *     if verb: print("init succeded")
+ *     sec = time.time()             # <<<<<<<<<<<<<<
+ * 
+ * # This for looks for the centers. A point is a center if its g is bigger than the one of all its neighbors
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_3);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
+    }
+  }
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 49, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_sec = __pyx_t_9;
+
+  /* "dadapy/_cython/cython_clustering.pyx":52
  * 
  * # This for looks for the centers. A point is a center if its g is bigger than the one of all its neighbors
  *     for i in range(Nele):             # <<<<<<<<<<<<<<
  *         t = 0
  *         for j in range(1, kstar[i] + 1):
  */
-  __pyx_t_9 = __pyx_v_Nele;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nele;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":52
+    /* "dadapy/_cython/cython_clustering.pyx":53
  * # This for looks for the centers. A point is a center if its g is bigger than the one of all its neighbors
  *     for i in range(Nele):
  *         t = 0             # <<<<<<<<<<<<<<
  *         for j in range(1, kstar[i] + 1):
  *             if (g[i] < g[dist_indices[i, j]]):
  */
     __pyx_v_t = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":53
+    /* "dadapy/_cython/cython_clustering.pyx":54
  *     for i in range(Nele):
  *         t = 0
  *         for j in range(1, kstar[i] + 1):             # <<<<<<<<<<<<<<
  *             if (g[i] < g[dist_indices[i, j]]):
  *                 t = 1
  */
-    __pyx_t_12 = __pyx_v_i;
-    if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-    __pyx_t_13 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_j = __pyx_t_15;
+    __pyx_t_13 = __pyx_v_i;
+    if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+    __pyx_t_14 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = 1; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_j = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":54
+      /* "dadapy/_cython/cython_clustering.pyx":55
  *         t = 0
  *         for j in range(1, kstar[i] + 1):
  *             if (g[i] < g[dist_indices[i, j]]):             # <<<<<<<<<<<<<<
  *                 t = 1
  *                 break
  */
-      __pyx_t_12 = __pyx_v_i;
-      if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_g.diminfo[0].shape;
-      __pyx_t_16 = __pyx_v_i;
-      __pyx_t_17 = __pyx_v_j;
-      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
-      __pyx_t_18 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_g.diminfo[0].shape;
-      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_g.diminfo[0].strides)) < (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_g.diminfo[0].strides))) != 0);
+      __pyx_t_13 = __pyx_v_i;
+      if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_g.diminfo[0].shape;
+      __pyx_t_17 = __pyx_v_i;
+      __pyx_t_18 = __pyx_v_j;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
+      __pyx_t_19 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_g.diminfo[0].shape;
+      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_g.diminfo[0].strides)) < (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_g.diminfo[0].strides))) != 0);
       if (__pyx_t_8) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":55
+        /* "dadapy/_cython/cython_clustering.pyx":56
  *         for j in range(1, kstar[i] + 1):
  *             if (g[i] < g[dist_indices[i, j]]):
  *                 t = 1             # <<<<<<<<<<<<<<
  *                 break
  *         if (t == 0):
  */
         __pyx_v_t = 1;
 
-        /* "dadapy/_cython/cython_clustering.pyx":56
+        /* "dadapy/_cython/cython_clustering.pyx":57
  *             if (g[i] < g[dist_indices[i, j]]):
  *                 t = 1
  *                 break             # <<<<<<<<<<<<<<
  *         if (t == 0):
  *             _centers_[len_centers] = i
  */
         goto __pyx_L7_break;
 
-        /* "dadapy/_cython/cython_clustering.pyx":54
+        /* "dadapy/_cython/cython_clustering.pyx":55
  *         t = 0
  *         for j in range(1, kstar[i] + 1):
  *             if (g[i] < g[dist_indices[i, j]]):             # <<<<<<<<<<<<<<
  *                 t = 1
  *                 break
  */
       }
     }
     __pyx_L7_break:;
 
-    /* "dadapy/_cython/cython_clustering.pyx":57
+    /* "dadapy/_cython/cython_clustering.pyx":58
  *                 t = 1
  *                 break
  *         if (t == 0):             # <<<<<<<<<<<<<<
  *             _centers_[len_centers] = i
  *             len_centers += 1
  */
     __pyx_t_8 = ((__pyx_v_t == 0) != 0);
     if (__pyx_t_8) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":58
+      /* "dadapy/_cython/cython_clustering.pyx":59
  *                 break
  *         if (t == 0):
  *             _centers_[len_centers] = i             # <<<<<<<<<<<<<<
  *             len_centers += 1
  * 
  */
-      __pyx_t_17 = __pyx_v_len_centers;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd__centers_.diminfo[0].strides) = __pyx_v_i;
+      __pyx_t_18 = __pyx_v_len_centers;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd__centers_.diminfo[0].strides) = __pyx_v_i;
 
-      /* "dadapy/_cython/cython_clustering.pyx":59
+      /* "dadapy/_cython/cython_clustering.pyx":60
  *         if (t == 0):
  *             _centers_[len_centers] = i
  *             len_centers += 1             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  to_remove = -np.ones((len_centers, len_centers), dtype=int)
  */
       __pyx_v_len_centers = (__pyx_v_len_centers + 1);
 
-      /* "dadapy/_cython/cython_clustering.pyx":57
+      /* "dadapy/_cython/cython_clustering.pyx":58
  *                 t = 1
  *                 break
  *         if (t == 0):             # <<<<<<<<<<<<<<
  *             _centers_[len_centers] = i
  *             len_centers += 1
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":61
+  /* "dadapy/_cython/cython_clustering.pyx":62
  *             len_centers += 1
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  to_remove = -np.ones((len_centers, len_centers), dtype=int)             # <<<<<<<<<<<<<<
  *     cdef DTYPE_t len_to_remove = 0
  *     cdef floatTYPE_t max_rho = -999.
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_len_centers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_len_centers); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_len_centers); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_len_centers); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_6);
-  __pyx_t_1 = 0;
-  __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
+  __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 61, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 61, __pyx_L1_error)
-  __pyx_t_19 = ((PyArrayObject *)__pyx_t_3);
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_t_20 = ((PyArrayObject *)__pyx_t_2);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_to_remove.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_to_remove.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_to_remove = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 61, __pyx_L1_error)
+      __PYX_ERR(0, 62, __pyx_L1_error)
     } else {__pyx_pybuffernd_to_remove.diminfo[0].strides = __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_to_remove.diminfo[0].shape = __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_to_remove.diminfo[1].strides = __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_to_remove.diminfo[1].shape = __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.shape[1];
     }
   }
-  __pyx_t_19 = 0;
-  __pyx_v_to_remove = ((PyArrayObject *)__pyx_t_3);
-  __pyx_t_3 = 0;
+  __pyx_t_20 = 0;
+  __pyx_v_to_remove = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":62
+  /* "dadapy/_cython/cython_clustering.pyx":63
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  to_remove = -np.ones((len_centers, len_centers), dtype=int)
  *     cdef DTYPE_t len_to_remove = 0             # <<<<<<<<<<<<<<
  *     cdef floatTYPE_t max_rho = -999.
  * 
  */
   __pyx_v_len_to_remove = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":63
+  /* "dadapy/_cython/cython_clustering.pyx":64
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  to_remove = -np.ones((len_centers, len_centers), dtype=int)
  *     cdef DTYPE_t len_to_remove = 0
  *     cdef floatTYPE_t max_rho = -999.             # <<<<<<<<<<<<<<
  * 
  *     if verb:
  */
   __pyx_v_max_rho = -999.;
 
-  /* "dadapy/_cython/cython_clustering.pyx":65
+  /* "dadapy/_cython/cython_clustering.pyx":66
  *     cdef floatTYPE_t max_rho = -999.
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part one finished: Raw identification of the putative centers")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Raw identification of the putative centers: {lag: .3f} sec")
  */
   __pyx_t_8 = (__pyx_v_verb != 0);
   if (__pyx_t_8) {
 
-    /* "dadapy/_cython/cython_clustering.pyx":66
+    /* "dadapy/_cython/cython_clustering.pyx":67
  * 
  *     if verb:
- *         print("part one finished: Raw identification of the putative centers")             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Raw identification of the putative centers: {lag: .3f} sec")
+ *       sec = time.time()
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_1)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_1);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
+    }
+    __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 67, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_v_lag = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":68
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Raw identification of the putative centers: {lag: .3f} sec")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
+ * 
+ */
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Raw_identification_of_the_putati);
+    __pyx_t_21 += 44;
+    __Pyx_GIVEREF(__pyx_kp_u_Raw_identification_of_the_putati);
+    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_Raw_identification_of_the_putati);
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = __Pyx_PyObject_Format(__pyx_t_3, __pyx_kp_u_3f); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
+    __pyx_t_2 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_sec);
+    __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_1, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_2) < 0) __PYX_ERR(0, 68, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+    /* "dadapy/_cython/cython_clustering.pyx":69
+ *       lag = time.time() - sec
+ *       print(f"Raw identification of the putative centers: {lag: .3f} sec")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
  * 
  * # This  part  checks that there are no centers within the neighborhood of points with higher density.
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_part_one_finished_Raw_identifica) < 0) __PYX_ERR(0, 66, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_1)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_1);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
+    }
+    __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 69, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_sec = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":65
+    /* "dadapy/_cython/cython_clustering.pyx":66
  *     cdef floatTYPE_t max_rho = -999.
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part one finished: Raw identification of the putative centers")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Raw identification of the putative centers: {lag: .3f} sec")
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":69
+  /* "dadapy/_cython/cython_clustering.pyx":72
  * 
  * # This  part  checks that there are no centers within the neighborhood of points with higher density.
  *     for k in range(len_centers):             # <<<<<<<<<<<<<<
  *         t=0
  *         max_rho = -999.
  */
-  __pyx_t_9 = __pyx_v_len_centers;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_k = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_len_centers;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_k = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":70
+    /* "dadapy/_cython/cython_clustering.pyx":73
  * # This  part  checks that there are no centers within the neighborhood of points with higher density.
  *     for k in range(len_centers):
  *         t=0             # <<<<<<<<<<<<<<
  *         max_rho = -999.
  *         for i in range(Nele):
  */
     __pyx_v_t = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":71
+    /* "dadapy/_cython/cython_clustering.pyx":74
  *     for k in range(len_centers):
  *         t=0
  *         max_rho = -999.             # <<<<<<<<<<<<<<
  *         for i in range(Nele):
  *             for j in range(1, kstar[i]+1):
  */
     __pyx_v_max_rho = -999.;
 
-    /* "dadapy/_cython/cython_clustering.pyx":72
+    /* "dadapy/_cython/cython_clustering.pyx":75
  *         t=0
  *         max_rho = -999.
  *         for i in range(Nele):             # <<<<<<<<<<<<<<
  *             for j in range(1, kstar[i]+1):
  *                 if (dist_indices[i, j] == _centers_[k]):
  */
-    __pyx_t_13 = __pyx_v_Nele;
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_i = __pyx_t_15;
+    __pyx_t_14 = __pyx_v_Nele;
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_i = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":73
+      /* "dadapy/_cython/cython_clustering.pyx":76
  *         max_rho = -999.
  *         for i in range(Nele):
  *             for j in range(1, kstar[i]+1):             # <<<<<<<<<<<<<<
  *                 if (dist_indices[i, j] == _centers_[k]):
  *                     if (g[i] > g[_centers_[k]]):
  */
-      __pyx_t_17 = __pyx_v_i;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-      __pyx_t_20 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
-      __pyx_t_21 = __pyx_t_20;
-      for (__pyx_t_22 = 1; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
-        __pyx_v_j = __pyx_t_22;
+      __pyx_t_18 = __pyx_v_i;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+      __pyx_t_23 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
+      __pyx_t_24 = __pyx_t_23;
+      for (__pyx_t_25 = 1; __pyx_t_25 < __pyx_t_24; __pyx_t_25+=1) {
+        __pyx_v_j = __pyx_t_25;
 
-        /* "dadapy/_cython/cython_clustering.pyx":74
+        /* "dadapy/_cython/cython_clustering.pyx":77
  *         for i in range(Nele):
  *             for j in range(1, kstar[i]+1):
  *                 if (dist_indices[i, j] == _centers_[k]):             # <<<<<<<<<<<<<<
  *                     if (g[i] > g[_centers_[k]]):
  *                         to_remove[len_to_remove, 0] = _centers_[k]
  */
-        __pyx_t_17 = __pyx_v_i;
-        __pyx_t_16 = __pyx_v_j;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
-        __pyx_t_18 = __pyx_v_k;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-        __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dist_indices.diminfo[1].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd__centers_.diminfo[0].strides))) != 0);
+        __pyx_t_18 = __pyx_v_i;
+        __pyx_t_17 = __pyx_v_j;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
+        __pyx_t_19 = __pyx_v_k;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+        __pyx_t_8 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[1].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd__centers_.diminfo[0].strides))) != 0);
         if (__pyx_t_8) {
 
-          /* "dadapy/_cython/cython_clustering.pyx":75
+          /* "dadapy/_cython/cython_clustering.pyx":78
  *             for j in range(1, kstar[i]+1):
  *                 if (dist_indices[i, j] == _centers_[k]):
  *                     if (g[i] > g[_centers_[k]]):             # <<<<<<<<<<<<<<
  *                         to_remove[len_to_remove, 0] = _centers_[k]
  *                         t=1
  */
-          __pyx_t_18 = __pyx_v_i;
+          __pyx_t_19 = __pyx_v_i;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_g.diminfo[0].shape;
+          __pyx_t_17 = __pyx_v_k;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+          __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd__centers_.diminfo[0].strides));
           if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_g.diminfo[0].shape;
-          __pyx_t_16 = __pyx_v_k;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-          __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd__centers_.diminfo[0].strides));
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_g.diminfo[0].shape;
-          __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_g.diminfo[0].strides)) > (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_g.diminfo[0].strides))) != 0);
+          __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_g.diminfo[0].strides)) > (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_g.diminfo[0].strides))) != 0);
           if (__pyx_t_8) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":76
+            /* "dadapy/_cython/cython_clustering.pyx":79
  *                 if (dist_indices[i, j] == _centers_[k]):
  *                     if (g[i] > g[_centers_[k]]):
  *                         to_remove[len_to_remove, 0] = _centers_[k]             # <<<<<<<<<<<<<<
  *                         t=1
  * 
  */
-            __pyx_t_16 = __pyx_v_k;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-            __pyx_t_17 = __pyx_v_len_to_remove;
-            __pyx_t_18 = 0;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
-            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_to_remove.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd__centers_.diminfo[0].strides));
+            __pyx_t_17 = __pyx_v_k;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+            __pyx_t_18 = __pyx_v_len_to_remove;
+            __pyx_t_19 = 0;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_to_remove.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd__centers_.diminfo[0].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":77
+            /* "dadapy/_cython/cython_clustering.pyx":80
  *                     if (g[i] > g[_centers_[k]]):
  *                         to_remove[len_to_remove, 0] = _centers_[k]
  *                         t=1             # <<<<<<<<<<<<<<
  * 
  *                         if max_rho <0:
  */
             __pyx_v_t = 1;
 
-            /* "dadapy/_cython/cython_clustering.pyx":79
+            /* "dadapy/_cython/cython_clustering.pyx":82
  *                         t=1
  * 
  *                         if max_rho <0:             # <<<<<<<<<<<<<<
  *                             len_to_remove += 1
  * 
  */
             __pyx_t_8 = ((__pyx_v_max_rho < 0.0) != 0);
             if (__pyx_t_8) {
 
-              /* "dadapy/_cython/cython_clustering.pyx":80
+              /* "dadapy/_cython/cython_clustering.pyx":83
  * 
  *                         if max_rho <0:
  *                             len_to_remove += 1             # <<<<<<<<<<<<<<
  * 
  *                         if g[i]>max_rho:
  */
               __pyx_v_len_to_remove = (__pyx_v_len_to_remove + 1);
 
-              /* "dadapy/_cython/cython_clustering.pyx":79
+              /* "dadapy/_cython/cython_clustering.pyx":82
  *                         t=1
  * 
  *                         if max_rho <0:             # <<<<<<<<<<<<<<
  *                             len_to_remove += 1
  * 
  */
             }
 
-            /* "dadapy/_cython/cython_clustering.pyx":82
+            /* "dadapy/_cython/cython_clustering.pyx":85
  *                             len_to_remove += 1
  * 
  *                         if g[i]>max_rho:             # <<<<<<<<<<<<<<
  *                             max_rho=g[i]
  *                             to_remove[len_to_remove, 1] = i
  */
-            __pyx_t_16 = __pyx_v_i;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_g.diminfo[0].shape;
-            __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_g.diminfo[0].strides)) > __pyx_v_max_rho) != 0);
+            __pyx_t_17 = __pyx_v_i;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_g.diminfo[0].shape;
+            __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_g.diminfo[0].strides)) > __pyx_v_max_rho) != 0);
             if (__pyx_t_8) {
 
-              /* "dadapy/_cython/cython_clustering.pyx":83
+              /* "dadapy/_cython/cython_clustering.pyx":86
  * 
  *                         if g[i]>max_rho:
  *                             max_rho=g[i]             # <<<<<<<<<<<<<<
  *                             to_remove[len_to_remove, 1] = i
  * 
  */
-              __pyx_t_16 = __pyx_v_i;
-              if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_g.diminfo[0].shape;
-              __pyx_v_max_rho = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_g.diminfo[0].strides));
+              __pyx_t_17 = __pyx_v_i;
+              if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_g.diminfo[0].shape;
+              __pyx_v_max_rho = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_g.diminfo[0].strides));
 
-              /* "dadapy/_cython/cython_clustering.pyx":84
+              /* "dadapy/_cython/cython_clustering.pyx":87
  *                         if g[i]>max_rho:
  *                             max_rho=g[i]
  *                             to_remove[len_to_remove, 1] = i             # <<<<<<<<<<<<<<
  * 
  *     if verb:
  */
-              __pyx_t_16 = __pyx_v_len_to_remove;
-              __pyx_t_18 = 1;
-              if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
-              if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
-              *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_to_remove.diminfo[1].strides) = __pyx_v_i;
+              __pyx_t_17 = __pyx_v_len_to_remove;
+              __pyx_t_19 = 1;
+              if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
+              if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
+              *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_to_remove.diminfo[1].strides) = __pyx_v_i;
 
-              /* "dadapy/_cython/cython_clustering.pyx":82
+              /* "dadapy/_cython/cython_clustering.pyx":85
  *                             len_to_remove += 1
  * 
  *                         if g[i]>max_rho:             # <<<<<<<<<<<<<<
  *                             max_rho=g[i]
  *                             to_remove[len_to_remove, 1] = i
  */
             }
 
-            /* "dadapy/_cython/cython_clustering.pyx":75
+            /* "dadapy/_cython/cython_clustering.pyx":78
  *             for j in range(1, kstar[i]+1):
  *                 if (dist_indices[i, j] == _centers_[k]):
  *                     if (g[i] > g[_centers_[k]]):             # <<<<<<<<<<<<<<
  *                         to_remove[len_to_remove, 0] = _centers_[k]
  *                         t=1
  */
           }
 
-          /* "dadapy/_cython/cython_clustering.pyx":74
+          /* "dadapy/_cython/cython_clustering.pyx":77
  *         for i in range(Nele):
  *             for j in range(1, kstar[i]+1):
  *                 if (dist_indices[i, j] == _centers_[k]):             # <<<<<<<<<<<<<<
  *                     if (g[i] > g[_centers_[k]]):
  *                         to_remove[len_to_remove, 0] = _centers_[k]
  */
         }
       }
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":86
+  /* "dadapy/_cython/cython_clustering.pyx":89
  *                             to_remove[len_to_remove, 1] = i
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part two finished: Further checking on centers")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Further checking on centers: {lag: .3f} sec ")
  */
   __pyx_t_8 = (__pyx_v_verb != 0);
   if (__pyx_t_8) {
 
-    /* "dadapy/_cython/cython_clustering.pyx":87
+    /* "dadapy/_cython/cython_clustering.pyx":90
  * 
  *     if verb:
- *         print("part two finished: Further checking on centers")             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Further checking on centers: {lag: .3f} sec ")
+ *       sec = time.time()
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+      }
+    }
+    __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 90, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_v_lag = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":91
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Further checking on centers: {lag: .3f} sec ")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
+ * 
+ */
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Further_checking_on_centers);
+    __pyx_t_21 += 29;
+    __Pyx_GIVEREF(__pyx_kp_u_Further_checking_on_centers);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_Further_checking_on_centers);
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = __Pyx_PyObject_Format(__pyx_t_1, __pyx_kp_u_3f); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
+    __pyx_t_2 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec_2);
+    __pyx_t_21 += 5;
+    __Pyx_GIVEREF(__pyx_kp_u_sec_2);
+    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_sec_2);
+    __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_2) < 0) __PYX_ERR(0, 91, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+    /* "dadapy/_cython/cython_clustering.pyx":92
+ *       lag = time.time() - sec
+ *       print(f"Further checking on centers: {lag: .3f} sec ")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers = np.empty(len_centers - len_to_remove, dtype=int)
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_part_two_finished_Further_checki) < 0) __PYX_ERR(0, 87, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+      }
+    }
+    __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 92, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_sec = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":86
+    /* "dadapy/_cython/cython_clustering.pyx":89
  *                             to_remove[len_to_remove, 1] = i
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part two finished: Further checking on centers")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Further checking on centers: {lag: .3f} sec ")
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":89
- *         print("part two finished: Further checking on centers")
+  /* "dadapy/_cython/cython_clustering.pyx":94
+ *       sec = time.time()
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers = np.empty(len_centers - len_to_remove, dtype=int)             # <<<<<<<<<<<<<<
  *     cdef DTYPE_t cindx = 0
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_npy_long((__pyx_v_len_centers - __pyx_v_len_to_remove)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 89, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_npy_long((__pyx_v_len_centers - __pyx_v_len_to_remove)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 89, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 89, __pyx_L1_error)
-  __pyx_t_23 = ((PyArrayObject *)__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_26 = ((PyArrayObject *)__pyx_t_6);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centers.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centers.rcbuffer->pybuffer, (PyObject*)__pyx_t_26, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_centers = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 89, __pyx_L1_error)
+      __PYX_ERR(0, 94, __pyx_L1_error)
     } else {__pyx_pybuffernd_centers.diminfo[0].strides = __pyx_pybuffernd_centers.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_centers.diminfo[0].shape = __pyx_pybuffernd_centers.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_23 = 0;
-  __pyx_v_centers = ((PyArrayObject *)__pyx_t_2);
-  __pyx_t_2 = 0;
+  __pyx_t_26 = 0;
+  __pyx_v_centers = ((PyArrayObject *)__pyx_t_6);
+  __pyx_t_6 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":90
+  /* "dadapy/_cython/cython_clustering.pyx":95
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers = np.empty(len_centers - len_to_remove, dtype=int)
  *     cdef DTYPE_t cindx = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(len_centers):
  */
   __pyx_v_cindx = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":92
+  /* "dadapy/_cython/cython_clustering.pyx":97
  *     cdef DTYPE_t cindx = 0
  * 
  *     for i in range(len_centers):             # <<<<<<<<<<<<<<
  *         flag = 0
  *         for j in range(len_to_remove):
  */
-  __pyx_t_9 = __pyx_v_len_centers;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_len_centers;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":93
+    /* "dadapy/_cython/cython_clustering.pyx":98
  * 
  *     for i in range(len_centers):
  *         flag = 0             # <<<<<<<<<<<<<<
  *         for j in range(len_to_remove):
  *             if _centers_[i] == to_remove[j, 0]:
  */
     __pyx_v_flag = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":94
+    /* "dadapy/_cython/cython_clustering.pyx":99
  *     for i in range(len_centers):
  *         flag = 0
  *         for j in range(len_to_remove):             # <<<<<<<<<<<<<<
  *             if _centers_[i] == to_remove[j, 0]:
  *                 flag = 1
  */
-    __pyx_t_13 = __pyx_v_len_to_remove;
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_j = __pyx_t_15;
+    __pyx_t_14 = __pyx_v_len_to_remove;
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_j = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":95
+      /* "dadapy/_cython/cython_clustering.pyx":100
  *         flag = 0
  *         for j in range(len_to_remove):
  *             if _centers_[i] == to_remove[j, 0]:             # <<<<<<<<<<<<<<
  *                 flag = 1
  *                 break
  */
-      __pyx_t_18 = __pyx_v_i;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-      __pyx_t_16 = __pyx_v_j;
-      __pyx_t_17 = 0;
-      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
-      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd__centers_.diminfo[0].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_to_remove.diminfo[1].strides))) != 0);
+      __pyx_t_19 = __pyx_v_i;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+      __pyx_t_17 = __pyx_v_j;
+      __pyx_t_18 = 0;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_to_remove.diminfo[0].shape;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_to_remove.diminfo[1].shape;
+      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd__centers_.diminfo[0].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_to_remove.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_to_remove.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_to_remove.diminfo[1].strides))) != 0);
       if (__pyx_t_8) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":96
+        /* "dadapy/_cython/cython_clustering.pyx":101
  *         for j in range(len_to_remove):
  *             if _centers_[i] == to_remove[j, 0]:
  *                 flag = 1             # <<<<<<<<<<<<<<
  *                 break
  *         if (flag == 0):
  */
         __pyx_v_flag = 1;
 
-        /* "dadapy/_cython/cython_clustering.pyx":97
+        /* "dadapy/_cython/cython_clustering.pyx":102
  *             if _centers_[i] == to_remove[j, 0]:
  *                 flag = 1
  *                 break             # <<<<<<<<<<<<<<
  *         if (flag == 0):
  *             centers[cindx] = _centers_[i]
  */
         goto __pyx_L25_break;
 
-        /* "dadapy/_cython/cython_clustering.pyx":95
+        /* "dadapy/_cython/cython_clustering.pyx":100
  *         flag = 0
  *         for j in range(len_to_remove):
  *             if _centers_[i] == to_remove[j, 0]:             # <<<<<<<<<<<<<<
  *                 flag = 1
  *                 break
  */
       }
     }
     __pyx_L25_break:;
 
-    /* "dadapy/_cython/cython_clustering.pyx":98
+    /* "dadapy/_cython/cython_clustering.pyx":103
  *                 flag = 1
  *                 break
  *         if (flag == 0):             # <<<<<<<<<<<<<<
  *             centers[cindx] = _centers_[i]
  *             cindx += 1
  */
     __pyx_t_8 = ((__pyx_v_flag == 0) != 0);
     if (__pyx_t_8) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":99
+      /* "dadapy/_cython/cython_clustering.pyx":104
  *                 break
  *         if (flag == 0):
  *             centers[cindx] = _centers_[i]             # <<<<<<<<<<<<<<
  *             cindx += 1
  * 
  */
-      __pyx_t_17 = __pyx_v_i;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd__centers_.diminfo[0].shape;
-      __pyx_t_16 = __pyx_v_cindx;
-      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_centers.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd__centers_.diminfo[0].strides));
+      __pyx_t_18 = __pyx_v_i;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd__centers_.diminfo[0].shape;
+      __pyx_t_17 = __pyx_v_cindx;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_centers.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd__centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd__centers_.diminfo[0].strides));
 
-      /* "dadapy/_cython/cython_clustering.pyx":100
+      /* "dadapy/_cython/cython_clustering.pyx":105
  *         if (flag == 0):
  *             centers[cindx] = _centers_[i]
  *             cindx += 1             # <<<<<<<<<<<<<<
  * 
  *     if verb:
  */
       __pyx_v_cindx = (__pyx_v_cindx + 1);
 
-      /* "dadapy/_cython/cython_clustering.pyx":98
+      /* "dadapy/_cython/cython_clustering.pyx":103
  *                 flag = 1
  *                 break
  *         if (flag == 0):             # <<<<<<<<<<<<<<
  *             centers[cindx] = _centers_[i]
  *             cindx += 1
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":102
+  /* "dadapy/_cython/cython_clustering.pyx":107
  *             cindx += 1
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part tree finished: Pruning of the centers wrongly identified in part one.")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Pruning of the centers wrongly identified in part one: {lag: .3f} sec")
  */
   __pyx_t_8 = (__pyx_v_verb != 0);
   if (__pyx_t_8) {
 
-    /* "dadapy/_cython/cython_clustering.pyx":103
+    /* "dadapy/_cython/cython_clustering.pyx":108
  * 
  *     if verb:
- *         print("part tree finished: Pruning of the centers wrongly identified in part one.")             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Pruning of the centers wrongly identified in part one: {lag: .3f} sec")
+ *       sec = time.time()
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
+    }
+    __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 108, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_lag = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":109
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Pruning of the centers wrongly identified in part one: {lag: .3f} sec")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
  * 
+ */
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Pruning_of_the_centers_wrongly_i);
+    __pyx_t_21 += 55;
+    __Pyx_GIVEREF(__pyx_kp_u_Pruning_of_the_centers_wrongly_i);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_Pruning_of_the_centers_wrongly_i);
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = __Pyx_PyObject_Format(__pyx_t_3, __pyx_kp_u_3f); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
+    __Pyx_GIVEREF(__pyx_t_6);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
+    __pyx_t_6 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_sec);
+    __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 109, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_6) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+
+    /* "dadapy/_cython/cython_clustering.pyx":110
+ *       lag = time.time() - sec
+ *       print(f"Pruning of the centers wrongly identified in part one: {lag: .3f} sec")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
  * 
+ *     #the selected centers can't belong to the neighborhood of points with higher density
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_part_tree_finished_Pruning_of_th) < 0) __PYX_ERR(0, 103, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
+    }
+    __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 110, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 110, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_v_sec = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":102
+    /* "dadapy/_cython/cython_clustering.pyx":107
  *             cindx += 1
  * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("part tree finished: Pruning of the centers wrongly identified in part one.")
- * 
+ *       lag = time.time() - sec
+ *       print(f"Pruning of the centers wrongly identified in part one: {lag: .3f} sec")
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":107
+  /* "dadapy/_cython/cython_clustering.pyx":113
  * 
  *     #the selected centers can't belong to the neighborhood of points with higher density
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  cluster_init_ = -np.ones(Nele, dtype = int)             # <<<<<<<<<<<<<<
  *     Nclus = len_centers - len_to_remove
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 107, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
+  __pyx_t_6 = 0;
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 107, __pyx_L1_error)
-  __pyx_t_24 = ((PyArrayObject *)__pyx_t_2);
+  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_27 = ((PyArrayObject *)__pyx_t_6);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer, (PyObject*)__pyx_t_24, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_cluster_init_ = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 107, __pyx_L1_error)
+      __PYX_ERR(0, 113, __pyx_L1_error)
     } else {__pyx_pybuffernd_cluster_init_.diminfo[0].strides = __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cluster_init_.diminfo[0].shape = __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_24 = 0;
-  __pyx_v_cluster_init_ = ((PyArrayObject *)__pyx_t_2);
-  __pyx_t_2 = 0;
+  __pyx_t_27 = 0;
+  __pyx_v_cluster_init_ = ((PyArrayObject *)__pyx_t_6);
+  __pyx_t_6 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":108
+  /* "dadapy/_cython/cython_clustering.pyx":114
  *     #the selected centers can't belong to the neighborhood of points with higher density
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  cluster_init_ = -np.ones(Nele, dtype = int)
  *     Nclus = len_centers - len_to_remove             # <<<<<<<<<<<<<<
  * 
  *     for i in range(len_centers - len_to_remove):
  */
   __pyx_v_Nclus = (__pyx_v_len_centers - __pyx_v_len_to_remove);
 
-  /* "dadapy/_cython/cython_clustering.pyx":110
+  /* "dadapy/_cython/cython_clustering.pyx":116
  *     Nclus = len_centers - len_to_remove
  * 
  *     for i in range(len_centers - len_to_remove):             # <<<<<<<<<<<<<<
  *         cluster_init_[centers[i]] = i
  * 
  */
-  __pyx_t_9 = (__pyx_v_len_centers - __pyx_v_len_to_remove);
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = (__pyx_v_len_centers - __pyx_v_len_to_remove);
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":111
+    /* "dadapy/_cython/cython_clustering.pyx":117
  * 
  *     for i in range(len_centers - len_to_remove):
  *         cluster_init_[centers[i]] = i             # <<<<<<<<<<<<<<
  * 
- *     if verb:
- */
-    __pyx_t_17 = __pyx_v_i;
-    if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_centers.diminfo[0].shape;
-    __pyx_t_16 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_centers.diminfo[0].strides));
-    if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_cluster_init_.diminfo[0].shape;
-    *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_cluster_init_.diminfo[0].strides) = __pyx_v_i;
-  }
-
-  /* "dadapy/_cython/cython_clustering.pyx":113
- *         cluster_init_[centers[i]] = i
- * 
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("Number of clusters before multimodality test=", Nclus)
- * 
- */
-  __pyx_t_8 = (__pyx_v_verb != 0);
-  if (__pyx_t_8) {
-
-    /* "dadapy/_cython/cython_clustering.pyx":114
- * 
- *     if verb:
- *         print("Number of clusters before multimodality test=", Nclus)             # <<<<<<<<<<<<<<
- * 
- *     sortg = np.argsort(-g)  # Rank of the elements in the g vector sorted in descendent order
- */
-    __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_kp_s_Number_of_clusters_before_multim);
-    __Pyx_GIVEREF(__pyx_kp_s_Number_of_clusters_before_multim);
-    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_s_Number_of_clusters_before_multim);
-    __Pyx_GIVEREF(__pyx_t_2);
-    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
-    __pyx_t_2 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 114, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-    /* "dadapy/_cython/cython_clustering.pyx":113
- *         cluster_init_[centers[i]] = i
- * 
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("Number of clusters before multimodality test=", Nclus)
  * 
  */
+    __pyx_t_18 = __pyx_v_i;
+    if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers.diminfo[0].shape;
+    __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers.diminfo[0].strides));
+    if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_cluster_init_.diminfo[0].shape;
+    *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_cluster_init_.diminfo[0].strides) = __pyx_v_i;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":116
- *         print("Number of clusters before multimodality test=", Nclus)
+  /* "dadapy/_cython/cython_clustering.pyx":120
+ * 
  * 
  *     sortg = np.argsort(-g)  # Rank of the elements in the g vector sorted in descendent order             # <<<<<<<<<<<<<<
  * 
  *     # Perform preliminar assignation to clusters
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_argsort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 116, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Negative(((PyObject *)__pyx_v_g)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_argsort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Negative(((PyObject *)__pyx_v_g)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_6, function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
+  __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 120, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_v_sortg = __pyx_t_1;
-  __pyx_t_1 = 0;
+  __pyx_v_sortg = __pyx_t_6;
+  __pyx_t_6 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":119
+  /* "dadapy/_cython/cython_clustering.pyx":123
  * 
  *     # Perform preliminar assignation to clusters
  *     maxk = dist_indices.shape[1]             # <<<<<<<<<<<<<<
- *     print(maxk)
+ * 
  *     for j in range(Nele):
  */
   __pyx_v_maxk = (__pyx_v_dist_indices->dimensions[1]);
 
-  /* "dadapy/_cython/cython_clustering.pyx":120
- *     # Perform preliminar assignation to clusters
+  /* "dadapy/_cython/cython_clustering.pyx":125
  *     maxk = dist_indices.shape[1]
- *     print(maxk)             # <<<<<<<<<<<<<<
- *     for j in range(Nele):
- *         ele = sortg[j]
- */
-  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_maxk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 120, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-  /* "dadapy/_cython/cython_clustering.pyx":121
- *     maxk = dist_indices.shape[1]
- *     print(maxk)
+ * 
  *     for j in range(Nele):             # <<<<<<<<<<<<<<
  *         ele = sortg[j]
  *         nn = 0
  */
-  __pyx_t_9 = __pyx_v_Nele;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_j = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nele;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_j = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":122
- *     print(maxk)
+    /* "dadapy/_cython/cython_clustering.pyx":126
+ * 
  *     for j in range(Nele):
  *         ele = sortg[j]             # <<<<<<<<<<<<<<
  *         nn = 0
  *         while (cluster_init_[ele] == -1) and nn < maxk-1:
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_sortg, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_XDECREF_SET(__pyx_v_ele, __pyx_t_1);
-    __pyx_t_1 = 0;
+    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_sortg, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_XDECREF_SET(__pyx_v_ele, __pyx_t_6);
+    __pyx_t_6 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":123
+    /* "dadapy/_cython/cython_clustering.pyx":127
  *     for j in range(Nele):
  *         ele = sortg[j]
  *         nn = 0             # <<<<<<<<<<<<<<
  *         while (cluster_init_[ele] == -1) and nn < maxk-1:
  *             nn = nn + 1
  */
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_XDECREF_SET(__pyx_v_nn, __pyx_int_0);
 
-    /* "dadapy/_cython/cython_clustering.pyx":124
+    /* "dadapy/_cython/cython_clustering.pyx":128
  *         ele = sortg[j]
  *         nn = 0
  *         while (cluster_init_[ele] == -1) and nn < maxk-1:             # <<<<<<<<<<<<<<
  *             nn = nn + 1
  *             cluster_init_[ele] = cluster_init_[dist_indices[ele, nn]]
  */
     while (1) {
-      __pyx_t_1 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 124, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 128, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 124, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__pyx_t_25) {
+      __pyx_t_28 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_28 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (__pyx_t_28) {
       } else {
-        __pyx_t_8 = __pyx_t_25;
-        goto __pyx_L36_bool_binop_done;
+        __pyx_t_8 = __pyx_t_28;
+        goto __pyx_L35_bool_binop_done;
       }
-      __pyx_t_6 = __Pyx_PyInt_From_npy_long((__pyx_v_maxk - 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 124, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = PyObject_RichCompare(__pyx_v_nn, __pyx_t_6, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyInt_From_npy_long((__pyx_v_maxk - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_6 = PyObject_RichCompare(__pyx_v_nn, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 128, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_28 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_28 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 124, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_8 = __pyx_t_25;
-      __pyx_L36_bool_binop_done:;
+      __pyx_t_8 = __pyx_t_28;
+      __pyx_L35_bool_binop_done:;
       if (!__pyx_t_8) break;
 
-      /* "dadapy/_cython/cython_clustering.pyx":125
+      /* "dadapy/_cython/cython_clustering.pyx":129
  *         nn = 0
  *         while (cluster_init_[ele] == -1) and nn < maxk-1:
  *             nn = nn + 1             # <<<<<<<<<<<<<<
  *             cluster_init_[ele] = cluster_init_[dist_indices[ele, nn]]
  * 
  */
-      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_v_nn, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 125, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF_SET(__pyx_v_nn, __pyx_t_1);
-      __pyx_t_1 = 0;
+      __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_nn, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 129, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __Pyx_DECREF_SET(__pyx_v_nn, __pyx_t_6);
+      __pyx_t_6 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":126
+      /* "dadapy/_cython/cython_clustering.pyx":130
  *         while (cluster_init_[ele] == -1) and nn < maxk-1:
  *             nn = nn + 1
  *             cluster_init_[ele] = cluster_init_[dist_indices[ele, nn]]             # <<<<<<<<<<<<<<
  * 
  *         if cluster_init_[ele]==-1:
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 130, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
       __Pyx_INCREF(__pyx_v_ele);
       __Pyx_GIVEREF(__pyx_v_ele);
-      PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_ele);
+      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_ele);
       __Pyx_INCREF(__pyx_v_nn);
       __Pyx_GIVEREF(__pyx_v_nn);
-      PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_nn);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_dist_indices), __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 126, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_nn);
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_dist_indices), __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 130, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele, __pyx_t_6) < 0)) __PYX_ERR(0, 130, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele, __pyx_t_1) < 0)) __PYX_ERR(0, 126, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
 
-    /* "dadapy/_cython/cython_clustering.pyx":128
+    /* "dadapy/_cython/cython_clustering.pyx":132
  *             cluster_init_[ele] = cluster_init_[dist_indices[ele, nn]]
  * 
  *         if cluster_init_[ele]==-1:             # <<<<<<<<<<<<<<
  *             ele_neighbors = dist_indices[ele]
  *             all_removed_centers = to_remove[:, 0]
  */
-    __pyx_t_1 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 128, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 128, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_neg_1, -1L, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 132, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_8) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":129
+      /* "dadapy/_cython/cython_clustering.pyx":133
  * 
  *         if cluster_init_[ele]==-1:
  *             ele_neighbors = dist_indices[ele]             # <<<<<<<<<<<<<<
  *             all_removed_centers = to_remove[:, 0]
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_dist_indices), __pyx_v_ele); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 129, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_XDECREF_SET(__pyx_v_ele_neighbors, __pyx_t_6);
-      __pyx_t_6 = 0;
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_dist_indices), __pyx_v_ele); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_v_ele_neighbors, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":130
+      /* "dadapy/_cython/cython_clustering.pyx":134
  *         if cluster_init_[ele]==-1:
  *             ele_neighbors = dist_indices[ele]
  *             all_removed_centers = to_remove[:, 0]             # <<<<<<<<<<<<<<
  * 
  *             _, _, ind_removed_centers_ele = np.intersect1d(
  */
-      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_to_remove), __pyx_tuple__2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 130, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_XDECREF_SET(__pyx_v_all_removed_centers, __pyx_t_6);
-      __pyx_t_6 = 0;
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_to_remove), __pyx_tuple__2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_v_all_removed_centers, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":132
+      /* "dadapy/_cython/cython_clustering.pyx":136
  *             all_removed_centers = to_remove[:, 0]
  * 
  *             _, _, ind_removed_centers_ele = np.intersect1d(             # <<<<<<<<<<<<<<
  *                 ele_neighbors, all_removed_centers, return_indices=True
  *             )
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_intersect1d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 136, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_intersect1d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":133
+      /* "dadapy/_cython/cython_clustering.pyx":137
  * 
  *             _, _, ind_removed_centers_ele = np.intersect1d(
  *                 ele_neighbors, all_removed_centers, return_indices=True             # <<<<<<<<<<<<<<
  *             )
  * 
  */
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_INCREF(__pyx_v_ele_neighbors);
       __Pyx_GIVEREF(__pyx_v_ele_neighbors);
-      PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_ele_neighbors);
+      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_ele_neighbors);
       __Pyx_INCREF(__pyx_v_all_removed_centers);
       __Pyx_GIVEREF(__pyx_v_all_removed_centers);
-      PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_all_removed_centers);
-      __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_return_indices, Py_True) < 0) __PYX_ERR(0, 133, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_all_removed_centers);
+      __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_return_indices, Py_True) < 0) __PYX_ERR(0, 137, __pyx_L1_error)
 
-      /* "dadapy/_cython/cython_clustering.pyx":132
+      /* "dadapy/_cython/cython_clustering.pyx":136
  *             all_removed_centers = to_remove[:, 0]
  * 
  *             _, _, ind_removed_centers_ele = np.intersect1d(             # <<<<<<<<<<<<<<
  *                 ele_neighbors, all_removed_centers, return_indices=True
  *             )
  */
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 132, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 136, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
         PyObject* sequence = __pyx_t_3;
         Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
         if (unlikely(size != 3)) {
           if (size > 3) __Pyx_RaiseTooManyValuesError(3);
           else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-          __PYX_ERR(0, 132, __pyx_L1_error)
+          __PYX_ERR(0, 136, __pyx_L1_error)
         }
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
         if (likely(PyTuple_CheckExact(sequence))) {
-          __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
-          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
-          __pyx_t_1 = PyTuple_GET_ITEM(sequence, 2); 
+          __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
+          __pyx_t_2 = PyTuple_GET_ITEM(sequence, 1); 
+          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 2); 
         } else {
-          __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
-          __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
-          __pyx_t_1 = PyList_GET_ITEM(sequence, 2); 
+          __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
+          __pyx_t_2 = PyList_GET_ITEM(sequence, 1); 
+          __pyx_t_6 = PyList_GET_ITEM(sequence, 2); 
         }
+        __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_6);
-        __Pyx_INCREF(__pyx_t_1);
         #else
-        __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_2 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_6 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 136, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_1 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_1);
         #endif
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else {
         Py_ssize_t index = -1;
-        __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)
+        __pyx_t_4 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 136, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-        __pyx_t_26 = Py_TYPE(__pyx_t_4)->tp_iternext;
-        index = 0; __pyx_t_2 = __pyx_t_26(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L39_unpacking_failed;
+        __pyx_t_29 = Py_TYPE(__pyx_t_4)->tp_iternext;
+        index = 0; __pyx_t_1 = __pyx_t_29(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L38_unpacking_failed;
+        __Pyx_GOTREF(__pyx_t_1);
+        index = 1; __pyx_t_2 = __pyx_t_29(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L38_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_2);
-        index = 1; __pyx_t_6 = __pyx_t_26(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L39_unpacking_failed;
+        index = 2; __pyx_t_6 = __pyx_t_29(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L38_unpacking_failed;
         __Pyx_GOTREF(__pyx_t_6);
-        index = 2; __pyx_t_1 = __pyx_t_26(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L39_unpacking_failed;
-        __Pyx_GOTREF(__pyx_t_1);
-        if (__Pyx_IternextUnpackEndCheck(__pyx_t_26(__pyx_t_4), 3) < 0) __PYX_ERR(0, 132, __pyx_L1_error)
-        __pyx_t_26 = NULL;
+        if (__Pyx_IternextUnpackEndCheck(__pyx_t_29(__pyx_t_4), 3) < 0) __PYX_ERR(0, 136, __pyx_L1_error)
+        __pyx_t_29 = NULL;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        goto __pyx_L40_unpacking_done;
-        __pyx_L39_unpacking_failed:;
+        goto __pyx_L39_unpacking_done;
+        __pyx_L38_unpacking_failed:;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_26 = NULL;
+        __pyx_t_29 = NULL;
         if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-        __PYX_ERR(0, 132, __pyx_L1_error)
-        __pyx_L40_unpacking_done:;
+        __PYX_ERR(0, 136, __pyx_L1_error)
+        __pyx_L39_unpacking_done:;
       }
-      __Pyx_XDECREF_SET(__pyx_v__, __pyx_t_2);
+      __Pyx_XDECREF_SET(__pyx_v__, __pyx_t_1);
+      __pyx_t_1 = 0;
+      __Pyx_DECREF_SET(__pyx_v__, __pyx_t_2);
       __pyx_t_2 = 0;
-      __Pyx_DECREF_SET(__pyx_v__, __pyx_t_6);
+      __Pyx_XDECREF_SET(__pyx_v_ind_removed_centers_ele, __pyx_t_6);
       __pyx_t_6 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_ind_removed_centers_ele, __pyx_t_1);
-      __pyx_t_1 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":144
+      /* "dadapy/_cython/cython_clustering.pyx":148
  *             # (higher_density_centers --> centers of higher density that have a
  *             # 'removed center' in their neighborhood)
  *             higher_density_centers = to_remove[:, 1]             # <<<<<<<<<<<<<<
  *             higher_density_centers_ele = higher_density_centers[
  *                 ind_removed_centers_ele
  */
-      __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_to_remove), __pyx_tuple__3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_to_remove), __pyx_tuple__3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF_SET(__pyx_v_higher_density_centers, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":145
+      /* "dadapy/_cython/cython_clustering.pyx":149
  *             # 'removed center' in their neighborhood)
  *             higher_density_centers = to_remove[:, 1]
  *             higher_density_centers_ele = higher_density_centers[             # <<<<<<<<<<<<<<
  *                 ind_removed_centers_ele
  *             ]
  */
-      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_higher_density_centers, __pyx_v_ind_removed_centers_ele); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_higher_density_centers, __pyx_v_ind_removed_centers_ele); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_XDECREF_SET(__pyx_v_higher_density_centers_ele, __pyx_t_3);
       __pyx_t_3 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":151
+      /* "dadapy/_cython/cython_clustering.pyx":155
  *             # index (in 'cluster_init') of the 'maximum density center' of such neighboring centers
  *             max_center = higher_density_centers_ele[
  *                 np.argmax(g[higher_density_centers_ele])             # <<<<<<<<<<<<<<
  *             ]
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_argmax); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_g), __pyx_v_higher_density_centers_ele); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = NULL;
-      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
-        if (likely(__pyx_t_2)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-          __Pyx_INCREF(__pyx_t_2);
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_argmax); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 155, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_g), __pyx_v_higher_density_centers_ele); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 155, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_1 = NULL;
+      if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
+        if (likely(__pyx_t_1)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+          __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_6, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1);
-      __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6);
+      __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 155, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":150
+      /* "dadapy/_cython/cython_clustering.pyx":154
  * 
  *             # index (in 'cluster_init') of the 'maximum density center' of such neighboring centers
  *             max_center = higher_density_centers_ele[             # <<<<<<<<<<<<<<
  *                 np.argmax(g[higher_density_centers_ele])
  *             ]
  */
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_v_higher_density_centers_ele, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 150, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
+      __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_higher_density_centers_ele, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 154, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_max_center, __pyx_t_6);
-      __pyx_t_6 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_max_center, __pyx_t_2);
+      __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":155
+      /* "dadapy/_cython/cython_clustering.pyx":159
  * 
  *             # new_highest_neighbor = index_highest_nb_density[index_highest_nb_density]
  *             cluster_init_[ele] = cluster_init_[max_center]             # <<<<<<<<<<<<<<
  * 
  *     clstruct = []  # useful list of points in the clusters
  */
-      __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_max_center); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 155, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele, __pyx_t_6) < 0)) __PYX_ERR(0, 155, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_max_center); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 159, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_cluster_init_), __pyx_v_ele, __pyx_t_2) < 0)) __PYX_ERR(0, 159, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":128
+      /* "dadapy/_cython/cython_clustering.pyx":132
  *             cluster_init_[ele] = cluster_init_[dist_indices[ele, nn]]
  * 
  *         if cluster_init_[ele]==-1:             # <<<<<<<<<<<<<<
  *             ele_neighbors = dist_indices[ele]
  *             all_removed_centers = to_remove[:, 0]
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":157
+  /* "dadapy/_cython/cython_clustering.pyx":161
  *             cluster_init_[ele] = cluster_init_[max_center]
  * 
  *     clstruct = []  # useful list of points in the clusters             # <<<<<<<<<<<<<<
  *     for i in range(Nclus):
  *         x1 = []
  */
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 157, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_v_clstruct = ((PyObject*)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_v_clstruct = ((PyObject*)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":158
+  /* "dadapy/_cython/cython_clustering.pyx":162
  * 
  *     clstruct = []  # useful list of points in the clusters
  *     for i in range(Nclus):             # <<<<<<<<<<<<<<
  *         x1 = []
  *         for j in range(Nele):
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":159
+    /* "dadapy/_cython/cython_clustering.pyx":163
  *     clstruct = []  # useful list of points in the clusters
  *     for i in range(Nclus):
  *         x1 = []             # <<<<<<<<<<<<<<
  *         for j in range(Nele):
  *             if (cluster_init_[j] == i):
  */
-    __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 159, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_XDECREF_SET(__pyx_v_x1, ((PyObject*)__pyx_t_6));
-    __pyx_t_6 = 0;
+    __pyx_t_2 = PyList_New(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 163, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_XDECREF_SET(__pyx_v_x1, ((PyObject*)__pyx_t_2));
+    __pyx_t_2 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":160
+    /* "dadapy/_cython/cython_clustering.pyx":164
  *     for i in range(Nclus):
  *         x1 = []
  *         for j in range(Nele):             # <<<<<<<<<<<<<<
  *             if (cluster_init_[j] == i):
  *                 x1.append(j)
  */
-    __pyx_t_13 = __pyx_v_Nele;
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_j = __pyx_t_15;
+    __pyx_t_14 = __pyx_v_Nele;
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_j = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":161
+      /* "dadapy/_cython/cython_clustering.pyx":165
  *         x1 = []
  *         for j in range(Nele):
  *             if (cluster_init_[j] == i):             # <<<<<<<<<<<<<<
  *                 x1.append(j)
  *         clstruct.append(x1)
  */
-      __pyx_t_17 = __pyx_v_j;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_cluster_init_.diminfo[0].shape;
-      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_cluster_init_.diminfo[0].strides)) == __pyx_v_i) != 0);
+      __pyx_t_18 = __pyx_v_j;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_cluster_init_.diminfo[0].shape;
+      __pyx_t_8 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_cluster_init_.diminfo[0].strides)) == __pyx_v_i) != 0);
       if (__pyx_t_8) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":162
+        /* "dadapy/_cython/cython_clustering.pyx":166
  *         for j in range(Nele):
  *             if (cluster_init_[j] == i):
  *                 x1.append(j)             # <<<<<<<<<<<<<<
  *         clstruct.append(x1)
  * 
  */
-        __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 162, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_27 = __Pyx_PyList_Append(__pyx_v_x1, __pyx_t_6); if (unlikely(__pyx_t_27 == ((int)-1))) __PYX_ERR(0, 162, __pyx_L1_error)
-        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+        __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_j); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 166, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_2);
+        __pyx_t_30 = __Pyx_PyList_Append(__pyx_v_x1, __pyx_t_2); if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 166, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-        /* "dadapy/_cython/cython_clustering.pyx":161
+        /* "dadapy/_cython/cython_clustering.pyx":165
  *         x1 = []
  *         for j in range(Nele):
  *             if (cluster_init_[j] == i):             # <<<<<<<<<<<<<<
  *                 x1.append(j)
  *         clstruct.append(x1)
  */
       }
     }
 
-    /* "dadapy/_cython/cython_clustering.pyx":163
+    /* "dadapy/_cython/cython_clustering.pyx":167
  *             if (cluster_init_[j] == i):
  *                 x1.append(j)
  *         clstruct.append(x1)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_27 = __Pyx_PyList_Append(__pyx_v_clstruct, __pyx_v_x1); if (unlikely(__pyx_t_27 == ((int)-1))) __PYX_ERR(0, 163, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyList_Append(__pyx_v_clstruct, __pyx_v_x1); if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 167, __pyx_L1_error)
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":166
+  /* "dadapy/_cython/cython_clustering.pyx":170
  * 
  * 
- *     sec2 = time.time()             # <<<<<<<<<<<<<<
- *     if verb: print(
- *          "{0:0.2f} seconds clustering before multimodality test".format(sec2 - sec))
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 166, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
-    if (likely(__pyx_t_3)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-      __Pyx_INCREF(__pyx_t_3);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_1, function);
-    }
-  }
-  __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 166, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_sec2 = __pyx_t_6;
-  __pyx_t_6 = 0;
+  __pyx_t_8 = (__pyx_v_verb != 0);
+  if (__pyx_t_8) {
 
-  /* "dadapy/_cython/cython_clustering.pyx":167
- * 
- *     sec2 = time.time()
- *     if verb: print(             # <<<<<<<<<<<<<<
- *          "{0:0.2f} seconds clustering before multimodality test".format(sec2 - sec))
+    /* "dadapy/_cython/cython_clustering.pyx":171
  * 
+ *     if verb:
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")
+ *       print("Number of clusters before multimodality test=", Nclus)
  */
-  __pyx_t_8 = (__pyx_v_verb != 0);
-  if (__pyx_t_8) {
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_6, function);
+      }
+    }
+    __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 171, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_v_lag = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":172
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")             # <<<<<<<<<<<<<<
+ *       print("Number of clusters before multimodality test=", Nclus)
+ *       sec = time.time()
+ */
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Preliminary_assignation_finished);
+    __pyx_t_21 += 34;
+    __Pyx_GIVEREF(__pyx_kp_u_Preliminary_assignation_finished);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_Preliminary_assignation_finished);
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __pyx_t_2 = __Pyx_PyObject_Format(__pyx_t_6, __pyx_kp_u_3f); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
+    __pyx_t_2 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_sec);
+    __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_2) < 0) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":168
- *     sec2 = time.time()
- *     if verb: print(
- *          "{0:0.2f} seconds clustering before multimodality test".format(sec2 - sec))             # <<<<<<<<<<<<<<
+    /* "dadapy/_cython/cython_clustering.pyx":173
+ *       lag = time.time() - sec
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")
+ *       print("Number of clusters before multimodality test=", Nclus)             # <<<<<<<<<<<<<<
+ *       sec = time.time()
  * 
- *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord = np.zeros((Nclus, Nclus))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_0_0_2f_seconds_clustering_befor, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyNumber_Subtract(__pyx_v_sec2, __pyx_v_sec); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 173, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 173, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_INCREF(__pyx_kp_s_Number_of_clusters_before_multim);
+    __Pyx_GIVEREF(__pyx_kp_s_Number_of_clusters_before_multim);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_s_Number_of_clusters_before_multim);
+    __Pyx_GIVEREF(__pyx_t_2);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
+    __pyx_t_2 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 173, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+
+    /* "dadapy/_cython/cython_clustering.pyx":174
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")
+ *       print("Number of clusters before multimodality test=", Nclus)
+ *       sec = time.time()             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 174, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 174, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_1, function);
+        __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
-    __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
+    __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 174, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 174, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 168, __pyx_L1_error)
+    __pyx_v_sec = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":170
+ * 
+ * 
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Preliminary assignation finished: {lag: .3f} sec")
+ */
+  }
+
+  /* "dadapy/_cython/cython_clustering.pyx":178
+ * 
+ *     #this implementation can be vry costly if Nclus is > 10^4
+ *     if Nclus > 10000:             # <<<<<<<<<<<<<<
+ *         warnings.warn(
+ *         """There are > 10k initial putative clusters:
+ */
+  __pyx_t_8 = ((__pyx_v_Nclus > 0x2710) != 0);
+  if (__pyx_t_8) {
+
+    /* "dadapy/_cython/cython_clustering.pyx":179
+ *     #this implementation can be vry costly if Nclus is > 10^4
+ *     if Nclus > 10000:
+ *         warnings.warn(             # <<<<<<<<<<<<<<
+ *         """There are > 10k initial putative clusters:
+ *         the matrices of the saddle points may cause out of memory error (6x Nclus x Nclus --> > 4.8 GB required).
+ */
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_6) < 0) __PYX_ERR(0, 167, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 179, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __pyx_t_6 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
+      if (likely(__pyx_t_6)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+        __Pyx_INCREF(__pyx_t_6);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_2, function);
+      }
+    }
+    __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_kp_s_There_are_10k_initial_putative_c) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_kp_s_There_are_10k_initial_putative_c);
+    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":167
- * 
- *     sec2 = time.time()
- *     if verb: print(             # <<<<<<<<<<<<<<
- *          "{0:0.2f} seconds clustering before multimodality test".format(sec2 - sec))
+    /* "dadapy/_cython/cython_clustering.pyx":178
  * 
+ *     #this implementation can be vry costly if Nclus is > 10^4
+ *     if Nclus > 10000:             # <<<<<<<<<<<<<<
+ *         warnings.warn(
+ *         """There are > 10k initial putative clusters:
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":170
- *          "{0:0.2f} seconds clustering before multimodality test".format(sec2 - sec))
+  /* "dadapy/_cython/cython_clustering.pyx":185
+ *         )
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord = np.zeros((Nclus, Nclus))             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord_err = np.zeros((Nclus, Nclus))
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  Point_bord = np.zeros((Nclus, Nclus), dtype=int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
-  __pyx_t_1 = 0;
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
+    if (likely(__pyx_t_1)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
-  __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 170, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 170, __pyx_L1_error)
-  __pyx_t_28 = ((PyArrayObject *)__pyx_t_6);
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_31 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer, (PyObject*)__pyx_t_28, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer, (PyObject*)__pyx_t_31, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Rho_bord = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 170, __pyx_L1_error)
+      __PYX_ERR(0, 185, __pyx_L1_error)
     } else {__pyx_pybuffernd_Rho_bord.diminfo[0].strides = __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rho_bord.diminfo[0].shape = __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rho_bord.diminfo[1].strides = __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rho_bord.diminfo[1].shape = __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.shape[1];
     }
   }
-  __pyx_t_28 = 0;
-  __pyx_v_Rho_bord = ((PyArrayObject *)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_31 = 0;
+  __pyx_v_Rho_bord = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":171
+  /* "dadapy/_cython/cython_clustering.pyx":186
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord = np.zeros((Nclus, Nclus))
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord_err = np.zeros((Nclus, Nclus))             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  Point_bord = np.zeros((Nclus, Nclus), dtype=int)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 186, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
-  __pyx_t_3 = 0;
-  __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_6);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
+  __pyx_t_6 = 0;
+  __pyx_t_1 = 0;
+  __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_2)) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 171, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 171, __pyx_L1_error)
-  __pyx_t_29 = ((PyArrayObject *)__pyx_t_6);
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 186, __pyx_L1_error)
+  __pyx_t_32 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer, (PyObject*)__pyx_t_29, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer, (PyObject*)__pyx_t_32, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Rho_bord_err = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 171, __pyx_L1_error)
+      __PYX_ERR(0, 186, __pyx_L1_error)
     } else {__pyx_pybuffernd_Rho_bord_err.diminfo[0].strides = __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape = __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides = __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape = __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.shape[1];
     }
   }
-  __pyx_t_29 = 0;
-  __pyx_v_Rho_bord_err = ((PyArrayObject *)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_32 = 0;
+  __pyx_v_Rho_bord_err = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":172
+  /* "dadapy/_cython/cython_clustering.pyx":187
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord = np.zeros((Nclus, Nclus))
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]  Rho_bord_err = np.zeros((Nclus, Nclus))
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  Point_bord = np.zeros((Nclus, Nclus), dtype=int)             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 1]  pos = np.zeros(Nclus * Nclus)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
-  __pyx_t_6 = 0;
-  __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
+  __pyx_t_3 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 172, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 172, __pyx_L1_error)
-  __pyx_t_30 = ((PyArrayObject *)__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_33 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Point_bord.rcbuffer->pybuffer, (PyObject*)__pyx_t_30, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Point_bord.rcbuffer->pybuffer, (PyObject*)__pyx_t_33, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Point_bord = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 172, __pyx_L1_error)
+      __PYX_ERR(0, 187, __pyx_L1_error)
     } else {__pyx_pybuffernd_Point_bord.diminfo[0].strides = __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Point_bord.diminfo[0].shape = __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Point_bord.diminfo[1].strides = __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Point_bord.diminfo[1].shape = __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.shape[1];
     }
   }
-  __pyx_t_30 = 0;
-  __pyx_v_Point_bord = ((PyArrayObject *)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_33 = 0;
+  __pyx_v_Point_bord = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":174
+  /* "dadapy/_cython/cython_clustering.pyx":189
  *     cdef np.ndarray[DTYPE_t, ndim = 2]  Point_bord = np.zeros((Nclus, Nclus), dtype=int)
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 1]  pos = np.zeros(Nclus * Nclus)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  ipos = np.zeros(Nclus * Nclus, dtype=int)
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  jpos = np.zeros(Nclus * Nclus, dtype=int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 174, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_1, function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_6 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
+  __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 174, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 174, __pyx_L1_error)
-  __pyx_t_31 = ((PyArrayObject *)__pyx_t_6);
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 189, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 189, __pyx_L1_error)
+  __pyx_t_34 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pos.rcbuffer->pybuffer, (PyObject*)__pyx_t_31, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pos.rcbuffer->pybuffer, (PyObject*)__pyx_t_34, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_pos = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 174, __pyx_L1_error)
+      __PYX_ERR(0, 189, __pyx_L1_error)
     } else {__pyx_pybuffernd_pos.diminfo[0].strides = __pyx_pybuffernd_pos.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pos.diminfo[0].shape = __pyx_pybuffernd_pos.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_31 = 0;
-  __pyx_v_pos = ((PyArrayObject *)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_34 = 0;
+  __pyx_v_pos = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":175
+  /* "dadapy/_cython/cython_clustering.pyx":190
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 1]  pos = np.zeros(Nclus * Nclus)
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  ipos = np.zeros(Nclus * Nclus, dtype=int)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  jpos = np.zeros(Nclus * Nclus, dtype=int)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 175, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 175, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 175, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 175, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 175, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 175, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 175, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 175, __pyx_L1_error)
-  __pyx_t_32 = ((PyArrayObject *)__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_35 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ipos.rcbuffer->pybuffer, (PyObject*)__pyx_t_32, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ipos.rcbuffer->pybuffer, (PyObject*)__pyx_t_35, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_ipos = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 175, __pyx_L1_error)
+      __PYX_ERR(0, 190, __pyx_L1_error)
     } else {__pyx_pybuffernd_ipos.diminfo[0].strides = __pyx_pybuffernd_ipos.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ipos.diminfo[0].shape = __pyx_pybuffernd_ipos.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_32 = 0;
+  __pyx_t_35 = 0;
   __pyx_v_ipos = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":176
+  /* "dadapy/_cython/cython_clustering.pyx":191
  *     cdef np.ndarray[floatTYPE_t, ndim = 1]  pos = np.zeros(Nclus * Nclus)
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  ipos = np.zeros(Nclus * Nclus, dtype=int)
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  jpos = np.zeros(Nclus * Nclus, dtype=int)             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  cluster_init = np.array(cluster_init_)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_npy_long((__pyx_v_Nclus * __pyx_v_Nclus)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 191, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 176, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 191, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 191, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 176, __pyx_L1_error)
-  __pyx_t_33 = ((PyArrayObject *)__pyx_t_1);
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 191, __pyx_L1_error)
+  __pyx_t_36 = ((PyArrayObject *)__pyx_t_2);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_jpos.rcbuffer->pybuffer, (PyObject*)__pyx_t_33, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_jpos.rcbuffer->pybuffer, (PyObject*)__pyx_t_36, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_jpos = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 176, __pyx_L1_error)
+      __PYX_ERR(0, 191, __pyx_L1_error)
     } else {__pyx_pybuffernd_jpos.diminfo[0].strides = __pyx_pybuffernd_jpos.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_jpos.diminfo[0].shape = __pyx_pybuffernd_jpos.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_33 = 0;
-  __pyx_v_jpos = ((PyArrayObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_36 = 0;
+  __pyx_v_jpos = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":178
+  /* "dadapy/_cython/cython_clustering.pyx":193
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  jpos = np.zeros(Nclus * Nclus, dtype=int)
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  cluster_init = np.array(cluster_init_)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 178, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 178, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_4)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, ((PyObject *)__pyx_v_cluster_init_)) : __Pyx_PyObject_CallOneArg(__pyx_t_2, ((PyObject *)__pyx_v_cluster_init_));
+  __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, ((PyObject *)__pyx_v_cluster_init_)) : __Pyx_PyObject_CallOneArg(__pyx_t_1, ((PyObject *)__pyx_v_cluster_init_));
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 178, __pyx_L1_error)
-  __pyx_t_34 = ((PyArrayObject *)__pyx_t_1);
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_t_37 = ((PyArrayObject *)__pyx_t_2);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cluster_init.rcbuffer->pybuffer, (PyObject*)__pyx_t_34, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cluster_init.rcbuffer->pybuffer, (PyObject*)__pyx_t_37, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_cluster_init = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 178, __pyx_L1_error)
+      __PYX_ERR(0, 193, __pyx_L1_error)
     } else {__pyx_pybuffernd_cluster_init.diminfo[0].strides = __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cluster_init.diminfo[0].shape = __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_34 = 0;
-  __pyx_v_cluster_init = ((PyArrayObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_37 = 0;
+  __pyx_v_cluster_init = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":183
+  /* "dadapy/_cython/cython_clustering.pyx":199
  *     # Find border points between putative clusters
  * 
  *     sec = time.time()             # <<<<<<<<<<<<<<
  * 
  *     for i in range(Nclus):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 183, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
-    if (likely(__pyx_t_2)) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
-      __Pyx_INCREF(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec, __pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_v_sec = __pyx_t_9;
 
-  /* "dadapy/_cython/cython_clustering.pyx":185
+  /* "dadapy/_cython/cython_clustering.pyx":201
  *     sec = time.time()
  * 
  *     for i in range(Nclus):             # <<<<<<<<<<<<<<
  *         for j in range(Nclus):
  *             Point_bord[i, j] = -1
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":186
+    /* "dadapy/_cython/cython_clustering.pyx":202
  * 
  *     for i in range(Nclus):
  *         for j in range(Nclus):             # <<<<<<<<<<<<<<
  *             Point_bord[i, j] = -1
  * 
  */
-    __pyx_t_13 = __pyx_v_Nclus;
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_j = __pyx_t_15;
+    __pyx_t_14 = __pyx_v_Nclus;
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_j = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":187
+      /* "dadapy/_cython/cython_clustering.pyx":203
  *     for i in range(Nclus):
  *         for j in range(Nclus):
  *             Point_bord[i, j] = -1             # <<<<<<<<<<<<<<
  * 
  *     #
  */
-      __pyx_t_17 = __pyx_v_i;
-      __pyx_t_16 = __pyx_v_j;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = -1L;
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_17 = __pyx_v_j;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = -1L;
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":198
+  /* "dadapy/_cython/cython_clustering.pyx":214
  *     #
  * 
  *     for c in range(Nclus):             # <<<<<<<<<<<<<<
  *         for p1 in clstruct[c]:
  *             if p1 in centers:
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_c = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_c = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":199
+    /* "dadapy/_cython/cython_clustering.pyx":215
  * 
  *     for c in range(Nclus):
  *         for p1 in clstruct[c]:             # <<<<<<<<<<<<<<
  *             if p1 in centers:
  *                 pp=-1
  */
-    __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_c, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
-      __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_35 = 0;
-      __pyx_t_36 = NULL;
+    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_c, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
+      __pyx_t_4 = __pyx_t_2; __Pyx_INCREF(__pyx_t_4); __pyx_t_21 = 0;
+      __pyx_t_38 = NULL;
     } else {
-      __pyx_t_35 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)
+      __pyx_t_21 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 215, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_36 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 199, __pyx_L1_error)
+      __pyx_t_38 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_38)) __PYX_ERR(0, 215, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
-      if (likely(!__pyx_t_36)) {
+      if (likely(!__pyx_t_38)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
-          if (__pyx_t_35 >= PyList_GET_SIZE(__pyx_t_4)) break;
+          if (__pyx_t_21 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_35); __Pyx_INCREF(__pyx_t_1); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 199, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_21); __Pyx_INCREF(__pyx_t_2); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 215, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
-          if (__pyx_t_35 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
+          if (__pyx_t_21 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_35); __Pyx_INCREF(__pyx_t_1); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 199, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_21); __Pyx_INCREF(__pyx_t_2); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 215, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_1);
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_4, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
-        __pyx_t_1 = __pyx_t_36(__pyx_t_4);
-        if (unlikely(!__pyx_t_1)) {
+        __pyx_t_2 = __pyx_t_38(__pyx_t_4);
+        if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 199, __pyx_L1_error)
+            else __PYX_ERR(0, 215, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_1);
+        __Pyx_GOTREF(__pyx_t_2);
       }
-      __pyx_t_13 = __Pyx_PyInt_As_npy_long(__pyx_t_1); if (unlikely((__pyx_t_13 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 199, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_v_p1 = __pyx_t_13;
+      __pyx_t_14 = __Pyx_PyInt_As_npy_long(__pyx_t_2); if (unlikely((__pyx_t_14 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 215, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_v_p1 = __pyx_t_14;
 
-      /* "dadapy/_cython/cython_clustering.pyx":200
+      /* "dadapy/_cython/cython_clustering.pyx":216
  *     for c in range(Nclus):
  *         for p1 in clstruct[c]:
  *             if p1 in centers:             # <<<<<<<<<<<<<<
  *                 pp=-1
  *             else:
  */
-      __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_p1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, ((PyObject *)__pyx_v_centers), Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 200, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_25 = (__pyx_t_8 != 0);
-      if (__pyx_t_25) {
+      __pyx_t_2 = __Pyx_PyInt_From_npy_long(__pyx_v_p1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_t_2, ((PyObject *)__pyx_v_centers), Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __pyx_t_28 = (__pyx_t_8 != 0);
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":201
+        /* "dadapy/_cython/cython_clustering.pyx":217
  *         for p1 in clstruct[c]:
  *             if p1 in centers:
  *                 pp=-1             # <<<<<<<<<<<<<<
  *             else:
  *                 for k in range(1, kstar[p1] + 1):
  */
         __pyx_v_pp = -1L;
 
-        /* "dadapy/_cython/cython_clustering.pyx":200
+        /* "dadapy/_cython/cython_clustering.pyx":216
  *     for c in range(Nclus):
  *         for p1 in clstruct[c]:
  *             if p1 in centers:             # <<<<<<<<<<<<<<
  *                 pp=-1
  *             else:
  */
         goto __pyx_L55;
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":203
+      /* "dadapy/_cython/cython_clustering.pyx":219
  *                 pp=-1
  *             else:
  *                 for k in range(1, kstar[p1] + 1):             # <<<<<<<<<<<<<<
  *                     p2 = dist_indices[p1, k]
  *                     pp = -1
  */
       /*else*/ {
-        __pyx_t_16 = __pyx_v_p1;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-        __pyx_t_13 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
-        __pyx_t_14 = __pyx_t_13;
-        for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-          __pyx_v_k = __pyx_t_15;
+        __pyx_t_17 = __pyx_v_p1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+        __pyx_t_14 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1);
+        __pyx_t_15 = __pyx_t_14;
+        for (__pyx_t_16 = 1; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+          __pyx_v_k = __pyx_t_16;
 
-          /* "dadapy/_cython/cython_clustering.pyx":204
+          /* "dadapy/_cython/cython_clustering.pyx":220
  *             else:
  *                 for k in range(1, kstar[p1] + 1):
  *                     p2 = dist_indices[p1, k]             # <<<<<<<<<<<<<<
  *                     pp = -1
  *                     if (cluster_init[p2] != c):
  */
-          __pyx_t_16 = __pyx_v_p1;
-          __pyx_t_17 = __pyx_v_k;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
-          __pyx_v_p2 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
+          __pyx_t_17 = __pyx_v_p1;
+          __pyx_t_18 = __pyx_v_k;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
+          __pyx_v_p2 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":205
+          /* "dadapy/_cython/cython_clustering.pyx":221
  *                 for k in range(1, kstar[p1] + 1):
  *                     p2 = dist_indices[p1, k]
  *                     pp = -1             # <<<<<<<<<<<<<<
  *                     if (cluster_init[p2] != c):
  *                         pp = p2
  */
           __pyx_v_pp = -1L;
 
-          /* "dadapy/_cython/cython_clustering.pyx":206
+          /* "dadapy/_cython/cython_clustering.pyx":222
  *                     p2 = dist_indices[p1, k]
  *                     pp = -1
  *                     if (cluster_init[p2] != c):             # <<<<<<<<<<<<<<
  *                         pp = p2
  *                         cp = cluster_init[pp]
  */
-          __pyx_t_17 = __pyx_v_p2;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
-          __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_cluster_init.diminfo[0].strides)) != __pyx_v_c) != 0);
-          if (__pyx_t_25) {
+          __pyx_t_18 = __pyx_v_p2;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
+          __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_cluster_init.diminfo[0].strides)) != __pyx_v_c) != 0);
+          if (__pyx_t_28) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":207
+            /* "dadapy/_cython/cython_clustering.pyx":223
  *                     pp = -1
  *                     if (cluster_init[p2] != c):
  *                         pp = p2             # <<<<<<<<<<<<<<
  *                         cp = cluster_init[pp]
  *                         break
  */
             __pyx_v_pp = __pyx_v_p2;
 
-            /* "dadapy/_cython/cython_clustering.pyx":208
+            /* "dadapy/_cython/cython_clustering.pyx":224
  *                     if (cluster_init[p2] != c):
  *                         pp = p2
  *                         cp = cluster_init[pp]             # <<<<<<<<<<<<<<
  *                         break
  *             if (pp != -1):
  */
-            __pyx_t_17 = __pyx_v_pp;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
-            __pyx_v_cp = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_cluster_init.diminfo[0].strides));
+            __pyx_t_18 = __pyx_v_pp;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
+            __pyx_v_cp = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_cluster_init.diminfo[0].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":209
+            /* "dadapy/_cython/cython_clustering.pyx":225
  *                         pp = p2
  *                         cp = cluster_init[pp]
  *                         break             # <<<<<<<<<<<<<<
  *             if (pp != -1):
  *                 for k in range(1, maxk):
  */
             goto __pyx_L57_break;
 
-            /* "dadapy/_cython/cython_clustering.pyx":206
+            /* "dadapy/_cython/cython_clustering.pyx":222
  *                     p2 = dist_indices[p1, k]
  *                     pp = -1
  *                     if (cluster_init[p2] != c):             # <<<<<<<<<<<<<<
  *                         pp = p2
  *                         cp = cluster_init[pp]
  */
           }
         }
         __pyx_L57_break:;
       }
       __pyx_L55:;
 
-      /* "dadapy/_cython/cython_clustering.pyx":210
+      /* "dadapy/_cython/cython_clustering.pyx":226
  *                         cp = cluster_init[pp]
  *                         break
  *             if (pp != -1):             # <<<<<<<<<<<<<<
  *                 for k in range(1, maxk):
  *                     po = dist_indices[pp, k]
  */
-      __pyx_t_25 = ((__pyx_v_pp != -1L) != 0);
-      if (__pyx_t_25) {
+      __pyx_t_28 = ((__pyx_v_pp != -1L) != 0);
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":211
+        /* "dadapy/_cython/cython_clustering.pyx":227
  *                         break
  *             if (pp != -1):
  *                 for k in range(1, maxk):             # <<<<<<<<<<<<<<
  *                     po = dist_indices[pp, k]
  *                     if (po == p1):
  */
-        __pyx_t_13 = __pyx_v_maxk;
-        __pyx_t_14 = __pyx_t_13;
-        for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-          __pyx_v_k = __pyx_t_15;
+        __pyx_t_14 = __pyx_v_maxk;
+        __pyx_t_15 = __pyx_t_14;
+        for (__pyx_t_16 = 1; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+          __pyx_v_k = __pyx_t_16;
 
-          /* "dadapy/_cython/cython_clustering.pyx":212
+          /* "dadapy/_cython/cython_clustering.pyx":228
  *             if (pp != -1):
  *                 for k in range(1, maxk):
  *                     po = dist_indices[pp, k]             # <<<<<<<<<<<<<<
  *                     if (po == p1):
  *                         break
  */
-          __pyx_t_17 = __pyx_v_pp;
-          __pyx_t_16 = __pyx_v_k;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
-          __pyx_v_po = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
+          __pyx_t_18 = __pyx_v_pp;
+          __pyx_t_17 = __pyx_v_k;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
+          __pyx_v_po = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":213
+          /* "dadapy/_cython/cython_clustering.pyx":229
  *                 for k in range(1, maxk):
  *                     po = dist_indices[pp, k]
  *                     if (po == p1):             # <<<<<<<<<<<<<<
  *                         break
  *                     if (cluster_init[po] == c):
  */
-          __pyx_t_25 = ((__pyx_v_po == __pyx_v_p1) != 0);
-          if (__pyx_t_25) {
+          __pyx_t_28 = ((__pyx_v_po == __pyx_v_p1) != 0);
+          if (__pyx_t_28) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":214
+            /* "dadapy/_cython/cython_clustering.pyx":230
  *                     po = dist_indices[pp, k]
  *                     if (po == p1):
  *                         break             # <<<<<<<<<<<<<<
  *                     if (cluster_init[po] == c):
  *                         pp = -1
  */
             goto __pyx_L61_break;
 
-            /* "dadapy/_cython/cython_clustering.pyx":213
+            /* "dadapy/_cython/cython_clustering.pyx":229
  *                 for k in range(1, maxk):
  *                     po = dist_indices[pp, k]
  *                     if (po == p1):             # <<<<<<<<<<<<<<
  *                         break
  *                     if (cluster_init[po] == c):
  */
           }
 
-          /* "dadapy/_cython/cython_clustering.pyx":215
+          /* "dadapy/_cython/cython_clustering.pyx":231
  *                     if (po == p1):
  *                         break
  *                     if (cluster_init[po] == c):             # <<<<<<<<<<<<<<
  *                         pp = -1
  *                         break
  */
-          __pyx_t_16 = __pyx_v_po;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
-          __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_cluster_init.diminfo[0].strides)) == __pyx_v_c) != 0);
-          if (__pyx_t_25) {
+          __pyx_t_17 = __pyx_v_po;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_cluster_init.diminfo[0].shape;
+          __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_cluster_init.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_cluster_init.diminfo[0].strides)) == __pyx_v_c) != 0);
+          if (__pyx_t_28) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":216
+            /* "dadapy/_cython/cython_clustering.pyx":232
  *                         break
  *                     if (cluster_init[po] == c):
  *                         pp = -1             # <<<<<<<<<<<<<<
  *                         break
  *             if (pp != -1):
  */
             __pyx_v_pp = -1L;
 
-            /* "dadapy/_cython/cython_clustering.pyx":217
+            /* "dadapy/_cython/cython_clustering.pyx":233
  *                     if (cluster_init[po] == c):
  *                         pp = -1
  *                         break             # <<<<<<<<<<<<<<
  *             if (pp != -1):
  *                 if (g[p1] > Rho_bord[c, cp]):
  */
             goto __pyx_L61_break;
 
-            /* "dadapy/_cython/cython_clustering.pyx":215
+            /* "dadapy/_cython/cython_clustering.pyx":231
  *                     if (po == p1):
  *                         break
  *                     if (cluster_init[po] == c):             # <<<<<<<<<<<<<<
  *                         pp = -1
  *                         break
  */
           }
         }
         __pyx_L61_break:;
 
-        /* "dadapy/_cython/cython_clustering.pyx":210
+        /* "dadapy/_cython/cython_clustering.pyx":226
  *                         cp = cluster_init[pp]
  *                         break
  *             if (pp != -1):             # <<<<<<<<<<<<<<
  *                 for k in range(1, maxk):
  *                     po = dist_indices[pp, k]
  */
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":218
+      /* "dadapy/_cython/cython_clustering.pyx":234
  *                         pp = -1
  *                         break
  *             if (pp != -1):             # <<<<<<<<<<<<<<
  *                 if (g[p1] > Rho_bord[c, cp]):
  *                     Rho_bord[c, cp] = g[p1]
  */
-      __pyx_t_25 = ((__pyx_v_pp != -1L) != 0);
-      if (__pyx_t_25) {
+      __pyx_t_28 = ((__pyx_v_pp != -1L) != 0);
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":219
+        /* "dadapy/_cython/cython_clustering.pyx":235
  *                         break
  *             if (pp != -1):
  *                 if (g[p1] > Rho_bord[c, cp]):             # <<<<<<<<<<<<<<
  *                     Rho_bord[c, cp] = g[p1]
  *                     Rho_bord[cp, c] = g[p1]
  */
-        __pyx_t_16 = __pyx_v_p1;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_g.diminfo[0].shape;
-        __pyx_t_17 = __pyx_v_c;
-        __pyx_t_18 = __pyx_v_cp;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-        __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_g.diminfo[0].strides)) > (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides))) != 0);
-        if (__pyx_t_25) {
+        __pyx_t_17 = __pyx_v_p1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_g.diminfo[0].shape;
+        __pyx_t_18 = __pyx_v_c;
+        __pyx_t_19 = __pyx_v_cp;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+        __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_g.diminfo[0].strides)) > (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides))) != 0);
+        if (__pyx_t_28) {
 
-          /* "dadapy/_cython/cython_clustering.pyx":220
+          /* "dadapy/_cython/cython_clustering.pyx":236
  *             if (pp != -1):
  *                 if (g[p1] > Rho_bord[c, cp]):
  *                     Rho_bord[c, cp] = g[p1]             # <<<<<<<<<<<<<<
  *                     Rho_bord[cp, c] = g[p1]
  *                     Point_bord[cp, c] = p1
  */
-          __pyx_t_18 = __pyx_v_p1;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_g.diminfo[0].shape;
-          __pyx_t_17 = __pyx_v_c;
-          __pyx_t_16 = __pyx_v_cp;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_g.diminfo[0].strides));
+          __pyx_t_19 = __pyx_v_p1;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_g.diminfo[0].shape;
+          __pyx_t_18 = __pyx_v_c;
+          __pyx_t_17 = __pyx_v_cp;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_g.diminfo[0].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":221
+          /* "dadapy/_cython/cython_clustering.pyx":237
  *                 if (g[p1] > Rho_bord[c, cp]):
  *                     Rho_bord[c, cp] = g[p1]
  *                     Rho_bord[cp, c] = g[p1]             # <<<<<<<<<<<<<<
  *                     Point_bord[cp, c] = p1
  *                     Point_bord[c, cp] = p1
  */
-          __pyx_t_18 = __pyx_v_p1;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_g.diminfo[0].shape;
-          __pyx_t_16 = __pyx_v_cp;
-          __pyx_t_17 = __pyx_v_c;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_g.diminfo[0].strides));
+          __pyx_t_19 = __pyx_v_p1;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_g.diminfo[0].shape;
+          __pyx_t_17 = __pyx_v_cp;
+          __pyx_t_18 = __pyx_v_c;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_g.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_g.diminfo[0].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":222
+          /* "dadapy/_cython/cython_clustering.pyx":238
  *                     Rho_bord[c, cp] = g[p1]
  *                     Rho_bord[cp, c] = g[p1]
  *                     Point_bord[cp, c] = p1             # <<<<<<<<<<<<<<
  *                     Point_bord[c, cp] = p1
  * 
  */
-          __pyx_t_18 = __pyx_v_cp;
-          __pyx_t_17 = __pyx_v_c;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = __pyx_v_p1;
+          __pyx_t_19 = __pyx_v_cp;
+          __pyx_t_18 = __pyx_v_c;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = __pyx_v_p1;
 
-          /* "dadapy/_cython/cython_clustering.pyx":223
+          /* "dadapy/_cython/cython_clustering.pyx":239
  *                     Rho_bord[cp, c] = g[p1]
  *                     Point_bord[cp, c] = p1
  *                     Point_bord[c, cp] = p1             # <<<<<<<<<<<<<<
  * 
  *     # Symmetrize matrix
  */
-          __pyx_t_17 = __pyx_v_c;
-          __pyx_t_18 = __pyx_v_cp;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = __pyx_v_p1;
+          __pyx_t_18 = __pyx_v_c;
+          __pyx_t_19 = __pyx_v_cp;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = __pyx_v_p1;
 
-          /* "dadapy/_cython/cython_clustering.pyx":219
+          /* "dadapy/_cython/cython_clustering.pyx":235
  *                         break
  *             if (pp != -1):
  *                 if (g[p1] > Rho_bord[c, cp]):             # <<<<<<<<<<<<<<
  *                     Rho_bord[c, cp] = g[p1]
  *                     Rho_bord[cp, c] = g[p1]
  */
         }
 
-        /* "dadapy/_cython/cython_clustering.pyx":218
+        /* "dadapy/_cython/cython_clustering.pyx":234
  *                         pp = -1
  *                         break
  *             if (pp != -1):             # <<<<<<<<<<<<<<
  *                 if (g[p1] > Rho_bord[c, cp]):
  *                     Rho_bord[c, cp] = g[p1]
  */
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":199
+      /* "dadapy/_cython/cython_clustering.pyx":215
  * 
  *     for c in range(Nclus):
  *         for p1 in clstruct[c]:             # <<<<<<<<<<<<<<
  *             if p1 in centers:
  *                 pp=-1
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":227
- *     # Symmetrize matrix
+  /* "dadapy/_cython/cython_clustering.pyx":242
  * 
+ *     # Symmetrize matrix
  *     for i in range(Nclus - 1):             # <<<<<<<<<<<<<<
  *         for j in range(i + 1, Nclus):
  *             if (Point_bord[i, j] != -1):
  */
-  __pyx_t_9 = (__pyx_v_Nclus - 1);
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = (__pyx_v_Nclus - 1);
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":228
- * 
+    /* "dadapy/_cython/cython_clustering.pyx":243
+ *     # Symmetrize matrix
  *     for i in range(Nclus - 1):
  *         for j in range(i + 1, Nclus):             # <<<<<<<<<<<<<<
  *             if (Point_bord[i, j] != -1):
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]
  */
-    __pyx_t_13 = __pyx_v_Nclus;
-    __pyx_t_14 = __pyx_t_13;
-    for (__pyx_t_15 = (__pyx_v_i + 1); __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-      __pyx_v_j = __pyx_t_15;
+    __pyx_t_14 = __pyx_v_Nclus;
+    __pyx_t_15 = __pyx_t_14;
+    for (__pyx_t_16 = (__pyx_v_i + 1); __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+      __pyx_v_j = __pyx_t_16;
 
-      /* "dadapy/_cython/cython_clustering.pyx":229
+      /* "dadapy/_cython/cython_clustering.pyx":244
  *     for i in range(Nclus - 1):
  *         for j in range(i + 1, Nclus):
  *             if (Point_bord[i, j] != -1):             # <<<<<<<<<<<<<<
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]
  */
-      __pyx_t_18 = __pyx_v_i;
-      __pyx_t_17 = __pyx_v_j;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-      __pyx_t_25 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides)) != -1L) != 0);
-      if (__pyx_t_25) {
+      __pyx_t_19 = __pyx_v_i;
+      __pyx_t_18 = __pyx_v_j;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+      __pyx_t_28 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides)) != -1L) != 0);
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":230
+        /* "dadapy/_cython/cython_clustering.pyx":245
  *         for j in range(i + 1, Nclus):
  *             if (Point_bord[i, j] != -1):
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]             # <<<<<<<<<<<<<<
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]
  *                 Rho_bord_err[i, j] = Rho_err[Point_bord[i, j]]
  */
-        __pyx_t_17 = __pyx_v_i;
-        __pyx_t_18 = __pyx_v_j;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-        __pyx_t_16 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-        __pyx_t_12 = __pyx_v_i;
-        __pyx_t_37 = __pyx_v_j;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-        if (__pyx_t_37 < 0) __pyx_t_37 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_37, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_c.diminfo[0].strides));
+        __pyx_t_18 = __pyx_v_i;
+        __pyx_t_19 = __pyx_v_j;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+        __pyx_t_17 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+        __pyx_t_13 = __pyx_v_i;
+        __pyx_t_39 = __pyx_v_j;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+        if (__pyx_t_39 < 0) __pyx_t_39 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_c.diminfo[0].strides));
 
-        /* "dadapy/_cython/cython_clustering.pyx":231
+        /* "dadapy/_cython/cython_clustering.pyx":246
  *             if (Point_bord[i, j] != -1):
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]             # <<<<<<<<<<<<<<
  *                 Rho_bord_err[i, j] = Rho_err[Point_bord[i, j]]
  *                 Rho_bord_err[j, i] = Rho_err[Point_bord[j, i]]
  */
-        __pyx_t_18 = __pyx_v_j;
-        __pyx_t_17 = __pyx_v_i;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-        __pyx_t_16 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-        __pyx_t_37 = __pyx_v_j;
-        __pyx_t_12 = __pyx_v_i;
-        if (__pyx_t_37 < 0) __pyx_t_37 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_c.diminfo[0].strides));
+        __pyx_t_19 = __pyx_v_j;
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+        __pyx_t_17 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+        __pyx_t_39 = __pyx_v_j;
+        __pyx_t_13 = __pyx_v_i;
+        if (__pyx_t_39 < 0) __pyx_t_39 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_c.diminfo[0].strides));
 
-        /* "dadapy/_cython/cython_clustering.pyx":232
+        /* "dadapy/_cython/cython_clustering.pyx":247
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]
  *                 Rho_bord_err[i, j] = Rho_err[Point_bord[i, j]]             # <<<<<<<<<<<<<<
  *                 Rho_bord_err[j, i] = Rho_err[Point_bord[j, i]]
  * 
  */
-        __pyx_t_17 = __pyx_v_i;
-        __pyx_t_18 = __pyx_v_j;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-        __pyx_t_16 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-        __pyx_t_12 = __pyx_v_i;
-        __pyx_t_37 = __pyx_v_j;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-        if (__pyx_t_37 < 0) __pyx_t_37 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_37, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_err.diminfo[0].strides));
+        __pyx_t_18 = __pyx_v_i;
+        __pyx_t_19 = __pyx_v_j;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+        __pyx_t_17 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+        __pyx_t_13 = __pyx_v_i;
+        __pyx_t_39 = __pyx_v_j;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+        if (__pyx_t_39 < 0) __pyx_t_39 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_39, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_err.diminfo[0].strides));
 
-        /* "dadapy/_cython/cython_clustering.pyx":233
+        /* "dadapy/_cython/cython_clustering.pyx":248
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]
  *                 Rho_bord_err[i, j] = Rho_err[Point_bord[i, j]]
  *                 Rho_bord_err[j, i] = Rho_err[Point_bord[j, i]]             # <<<<<<<<<<<<<<
  * 
  *     for i in range(Nclus):
  */
-        __pyx_t_18 = __pyx_v_j;
-        __pyx_t_17 = __pyx_v_i;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
-        __pyx_t_16 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-        __pyx_t_37 = __pyx_v_j;
-        __pyx_t_12 = __pyx_v_i;
-        if (__pyx_t_37 < 0) __pyx_t_37 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_err.diminfo[0].strides));
+        __pyx_t_19 = __pyx_v_j;
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+        __pyx_t_17 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+        __pyx_t_39 = __pyx_v_j;
+        __pyx_t_13 = __pyx_v_i;
+        if (__pyx_t_39 < 0) __pyx_t_39 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_err.diminfo[0].strides));
 
-        /* "dadapy/_cython/cython_clustering.pyx":229
+        /* "dadapy/_cython/cython_clustering.pyx":244
  *     for i in range(Nclus - 1):
  *         for j in range(i + 1, Nclus):
  *             if (Point_bord[i, j] != -1):             # <<<<<<<<<<<<<<
  *                 Rho_bord[i, j] = Rho_c[Point_bord[i, j]]
  *                 Rho_bord[j, i] = Rho_c[Point_bord[j, i]]
  */
       }
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":235
+  /* "dadapy/_cython/cython_clustering.pyx":250
  *                 Rho_bord_err[j, i] = Rho_err[Point_bord[j, i]]
  * 
  *     for i in range(Nclus):             # <<<<<<<<<<<<<<
  *         Rho_bord[i, i] = -1.
  *         Rho_bord_err[i, i] = 0.
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_i = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_i = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":236
+    /* "dadapy/_cython/cython_clustering.pyx":251
  * 
  *     for i in range(Nclus):
  *         Rho_bord[i, i] = -1.             # <<<<<<<<<<<<<<
  *         Rho_bord_err[i, i] = 0.
  * 
  */
-    __pyx_t_17 = __pyx_v_i;
     __pyx_t_18 = __pyx_v_i;
-    if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-    if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
+    __pyx_t_19 = __pyx_v_i;
+    if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+    if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
 
-    /* "dadapy/_cython/cython_clustering.pyx":237
+    /* "dadapy/_cython/cython_clustering.pyx":252
  *     for i in range(Nclus):
  *         Rho_bord[i, i] = -1.
  *         Rho_bord_err[i, i] = 0.             # <<<<<<<<<<<<<<
  * 
- *     sec2 = time.time()
+ * 
  */
+    __pyx_t_19 = __pyx_v_i;
     __pyx_t_18 = __pyx_v_i;
-    __pyx_t_17 = __pyx_v_i;
-    if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-    if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
+    if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+    if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":239
- *         Rho_bord_err[i, i] = 0.
+  /* "dadapy/_cython/cython_clustering.pyx":255
+ * 
+ * 
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Identification of the saddle points: {lag: .3f} sec")
+ */
+  __pyx_t_28 = (__pyx_v_verb != 0);
+  if (__pyx_t_28) {
+
+    /* "dadapy/_cython/cython_clustering.pyx":256
  * 
- *     sec2 = time.time()             # <<<<<<<<<<<<<<
  *     if verb:
- *         print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Identification of the saddle points: {lag: .3f} sec")
+ *       sec = time.time()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 239, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_1)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_1);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+      }
     }
-  }
-  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec2, __pyx_t_4);
-  __pyx_t_4 = 0;
+    __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 256, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_lag = __pyx_t_9;
 
-  /* "dadapy/_cython/cython_clustering.pyx":240
- * 
- *     sec2 = time.time()
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))
+    /* "dadapy/_cython/cython_clustering.pyx":257
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Identification of the saddle points: {lag: .3f} sec")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
  * 
  */
-  __pyx_t_25 = (__pyx_v_verb != 0);
-  if (__pyx_t_25) {
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Identification_of_the_saddle_poi);
+    __pyx_t_21 += 37;
+    __Pyx_GIVEREF(__pyx_kp_u_Identification_of_the_saddle_poi);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_Identification_of_the_saddle_poi);
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_PyObject_Format(__pyx_t_1, __pyx_kp_u_3f); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
+    __pyx_t_4 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_sec);
+    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":241
- *     sec2 = time.time()
- *     if verb:
- *         print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))             # <<<<<<<<<<<<<<
+    /* "dadapy/_cython/cython_clustering.pyx":258
+ *       lag = time.time() - sec
+ *       print(f"Identification of the saddle points: {lag: .3f} sec")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
  * 
  *     check = 1
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_0_0_2f_seconds_identifying_the, __pyx_n_s_format); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 258, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_sec2, __pyx_v_sec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_6)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
-    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 241, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 258, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_v_sec = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":240
+    /* "dadapy/_cython/cython_clustering.pyx":255
  * 
- *     sec2 = time.time()
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))
  * 
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Identification of the saddle points: {lag: .3f} sec")
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":243
- *         print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))
+  /* "dadapy/_cython/cython_clustering.pyx":260
+ *       sec = time.time()
  * 
  *     check = 1             # <<<<<<<<<<<<<<
  *     sec = time.time()
  * 
  */
   __pyx_v_check = 1;
 
-  /* "dadapy/_cython/cython_clustering.pyx":244
+  /* "dadapy/_cython/cython_clustering.pyx":261
  * 
  *     check = 1
  *     sec = time.time()             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers_ = np.array(centers, dtype=int)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-      __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
+    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_1)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+      __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_1, function);
+      __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 244, __pyx_L1_error)
+  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
+  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec, __pyx_t_4);
-  __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 261, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_v_sec = __pyx_t_9;
 
-  /* "dadapy/_cython/cython_clustering.pyx":246
+  /* "dadapy/_cython/cython_clustering.pyx":263
  *     sec = time.time()
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers_ = np.array(centers, dtype=int)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  clsurv = np.ones(Nclus, dtype=int)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(((PyObject *)__pyx_v_centers));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_centers));
   PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_centers));
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 246, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 246, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 246, __pyx_L1_error)
-  __pyx_t_38 = ((PyArrayObject *)__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_40 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centers_.rcbuffer->pybuffer, (PyObject*)__pyx_t_38, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_centers_.rcbuffer->pybuffer, (PyObject*)__pyx_t_40, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_centers_ = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 246, __pyx_L1_error)
+      __PYX_ERR(0, 263, __pyx_L1_error)
     } else {__pyx_pybuffernd_centers_.diminfo[0].strides = __pyx_pybuffernd_centers_.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_centers_.diminfo[0].shape = __pyx_pybuffernd_centers_.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_38 = 0;
-  __pyx_v_centers_ = ((PyArrayObject *)__pyx_t_6);
-  __pyx_t_6 = 0;
+  __pyx_t_40 = 0;
+  __pyx_v_centers_ = ((PyArrayObject *)__pyx_t_3);
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":247
+  /* "dadapy/_cython/cython_clustering.pyx":264
  * 
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  centers_ = np.array(centers, dtype=int)
  *     cdef np.ndarray[DTYPE_t, ndim = 1]  clsurv = np.ones(Nclus, dtype=int)             # <<<<<<<<<<<<<<
  * 
  *     # sec = time.time()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 247, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 247, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 264, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_Nclus); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 247, __pyx_L1_error)
-  __pyx_t_39 = ((PyArrayObject *)__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_41 = ((PyArrayObject *)__pyx_t_2);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_clsurv.rcbuffer->pybuffer, (PyObject*)__pyx_t_39, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_clsurv.rcbuffer->pybuffer, (PyObject*)__pyx_t_41, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_clsurv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 247, __pyx_L1_error)
+      __PYX_ERR(0, 264, __pyx_L1_error)
     } else {__pyx_pybuffernd_clsurv.diminfo[0].strides = __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_clsurv.diminfo[0].shape = __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.shape[0];
     }
   }
-  __pyx_t_39 = 0;
-  __pyx_v_clsurv = ((PyArrayObject *)__pyx_t_1);
-  __pyx_t_1 = 0;
+  __pyx_t_41 = 0;
+  __pyx_v_clsurv = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":251
+  /* "dadapy/_cython/cython_clustering.pyx":268
  *     # sec = time.time()
  *     # Here we start the merging process through multimodality test.
  *     secp = 0             # <<<<<<<<<<<<<<
  * 
  *     while (check == 1):
  */
   __pyx_v_secp = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":253
+  /* "dadapy/_cython/cython_clustering.pyx":270
  *     secp = 0
  * 
  *     while (check == 1):             # <<<<<<<<<<<<<<
  * 
  *         check = 0
  */
   while (1) {
-    __pyx_t_25 = ((__pyx_v_check == 1) != 0);
-    if (!__pyx_t_25) break;
+    __pyx_t_28 = ((__pyx_v_check == 1) != 0);
+    if (!__pyx_t_28) break;
 
-    /* "dadapy/_cython/cython_clustering.pyx":255
+    /* "dadapy/_cython/cython_clustering.pyx":272
  *     while (check == 1):
  * 
  *         check = 0             # <<<<<<<<<<<<<<
  * 
  *         for i in range(Nclus * Nclus):
  */
     __pyx_v_check = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":257
+    /* "dadapy/_cython/cython_clustering.pyx":274
  *         check = 0
  * 
  *         for i in range(Nclus * Nclus):             # <<<<<<<<<<<<<<
  *             pos[i] = 0.0
  *             ipos[i] = 0
  */
-    __pyx_t_9 = (__pyx_v_Nclus * __pyx_v_Nclus);
-    __pyx_t_10 = __pyx_t_9;
-    for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-      __pyx_v_i = __pyx_t_11;
+    __pyx_t_10 = (__pyx_v_Nclus * __pyx_v_Nclus);
+    __pyx_t_11 = __pyx_t_10;
+    for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+      __pyx_v_i = __pyx_t_12;
 
-      /* "dadapy/_cython/cython_clustering.pyx":258
+      /* "dadapy/_cython/cython_clustering.pyx":275
  * 
  *         for i in range(Nclus * Nclus):
  *             pos[i] = 0.0             # <<<<<<<<<<<<<<
  *             ipos[i] = 0
  *             jpos[i] = 0
  */
-      __pyx_t_17 = __pyx_v_i;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_pos.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_pos.diminfo[0].strides) = 0.0;
+      __pyx_t_18 = __pyx_v_i;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_pos.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pos.diminfo[0].strides) = 0.0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":259
+      /* "dadapy/_cython/cython_clustering.pyx":276
  *         for i in range(Nclus * Nclus):
  *             pos[i] = 0.0
  *             ipos[i] = 0             # <<<<<<<<<<<<<<
  *             jpos[i] = 0
  * 
  */
-      __pyx_t_17 = __pyx_v_i;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_ipos.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_ipos.diminfo[0].strides) = 0;
+      __pyx_t_18 = __pyx_v_i;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_ipos.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_ipos.diminfo[0].strides) = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":260
+      /* "dadapy/_cython/cython_clustering.pyx":277
  *             pos[i] = 0.0
  *             ipos[i] = 0
  *             jpos[i] = 0             # <<<<<<<<<<<<<<
  * 
  *         index = 0
  */
-      __pyx_t_17 = __pyx_v_i;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_jpos.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_jpos.diminfo[0].strides) = 0;
+      __pyx_t_18 = __pyx_v_i;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_jpos.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_jpos.diminfo[0].strides) = 0;
     }
 
-    /* "dadapy/_cython/cython_clustering.pyx":262
+    /* "dadapy/_cython/cython_clustering.pyx":279
  *             jpos[i] = 0
  * 
  *         index = 0             # <<<<<<<<<<<<<<
  *         maxposidx = 0
  *         maxpos = - 9999999999
  */
     __pyx_v_index = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":263
+    /* "dadapy/_cython/cython_clustering.pyx":280
  * 
  *         index = 0
  *         maxposidx = 0             # <<<<<<<<<<<<<<
  *         maxpos = - 9999999999
  * 
  */
     __pyx_v_maxposidx = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":264
+    /* "dadapy/_cython/cython_clustering.pyx":281
  *         index = 0
  *         maxposidx = 0
  *         maxpos = - 9999999999             # <<<<<<<<<<<<<<
  * 
  *         for i in range(Nclus - 1):
  */
     __pyx_v_maxpos = -9999999999.0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":266
+    /* "dadapy/_cython/cython_clustering.pyx":283
  *         maxpos = - 9999999999
  * 
  *         for i in range(Nclus - 1):             # <<<<<<<<<<<<<<
  *             for j in range(i + 1, Nclus):
  *                 a1 = (Rho_c[centers_[i]] - Rho_bord[i, j])
  */
-    __pyx_t_9 = (__pyx_v_Nclus - 1);
-    __pyx_t_10 = __pyx_t_9;
-    for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-      __pyx_v_i = __pyx_t_11;
+    __pyx_t_10 = (__pyx_v_Nclus - 1);
+    __pyx_t_11 = __pyx_t_10;
+    for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+      __pyx_v_i = __pyx_t_12;
 
-      /* "dadapy/_cython/cython_clustering.pyx":267
+      /* "dadapy/_cython/cython_clustering.pyx":284
  * 
  *         for i in range(Nclus - 1):
  *             for j in range(i + 1, Nclus):             # <<<<<<<<<<<<<<
  *                 a1 = (Rho_c[centers_[i]] - Rho_bord[i, j])
  *                 a2 = (Rho_c[centers_[j]] - Rho_bord[i, j])
  */
-      __pyx_t_13 = __pyx_v_Nclus;
-      __pyx_t_14 = __pyx_t_13;
-      for (__pyx_t_15 = (__pyx_v_i + 1); __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-        __pyx_v_j = __pyx_t_15;
+      __pyx_t_14 = __pyx_v_Nclus;
+      __pyx_t_15 = __pyx_t_14;
+      for (__pyx_t_16 = (__pyx_v_i + 1); __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+        __pyx_v_j = __pyx_t_16;
 
-        /* "dadapy/_cython/cython_clustering.pyx":268
+        /* "dadapy/_cython/cython_clustering.pyx":285
  *         for i in range(Nclus - 1):
  *             for j in range(i + 1, Nclus):
  *                 a1 = (Rho_c[centers_[i]] - Rho_bord[i, j])             # <<<<<<<<<<<<<<
  *                 a2 = (Rho_c[centers_[j]] - Rho_bord[i, j])
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])
  */
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers_.diminfo[0].shape;
+        __pyx_t_19 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers_.diminfo[0].strides));
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
         __pyx_t_17 = __pyx_v_i;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_centers_.diminfo[0].shape;
-        __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_centers_.diminfo[0].strides));
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-        __pyx_t_16 = __pyx_v_i;
-        __pyx_t_12 = __pyx_v_j;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-        __pyx_v_a1 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_c.diminfo[0].strides)) - (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)));
+        __pyx_t_13 = __pyx_v_j;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+        __pyx_v_a1 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_c.diminfo[0].strides)) - (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)));
 
-        /* "dadapy/_cython/cython_clustering.pyx":269
+        /* "dadapy/_cython/cython_clustering.pyx":286
  *             for j in range(i + 1, Nclus):
  *                 a1 = (Rho_c[centers_[i]] - Rho_bord[i, j])
  *                 a2 = (Rho_c[centers_[j]] - Rho_bord[i, j])             # <<<<<<<<<<<<<<
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])
  */
-        __pyx_t_12 = __pyx_v_j;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_centers_.diminfo[0].shape;
-        __pyx_t_16 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_centers_.diminfo[0].strides));
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-        __pyx_t_17 = __pyx_v_i;
-        __pyx_t_18 = __pyx_v_j;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-        __pyx_v_a2 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_c.diminfo[0].strides)) - (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)));
+        __pyx_t_13 = __pyx_v_j;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_centers_.diminfo[0].shape;
+        __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_centers_.diminfo[0].strides));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+        __pyx_t_18 = __pyx_v_i;
+        __pyx_t_19 = __pyx_v_j;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+        __pyx_v_a2 = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_c.diminfo[0].strides)) - (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)));
 
-        /* "dadapy/_cython/cython_clustering.pyx":270
+        /* "dadapy/_cython/cython_clustering.pyx":287
  *                 a1 = (Rho_c[centers_[i]] - Rho_bord[i, j])
  *                 a2 = (Rho_c[centers_[j]] - Rho_bord[i, j])
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])             # <<<<<<<<<<<<<<
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])
  *                 if (a1 < e1 or a2 < e2):
  */
-        __pyx_t_18 = __pyx_v_i;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers_.diminfo[0].shape;
-        __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers_.diminfo[0].strides));
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-        __pyx_t_12 = __pyx_v_i;
-        __pyx_t_16 = __pyx_v_j;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-        __pyx_v_e1 = (__pyx_v_Z * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_err.diminfo[0].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides))));
+        __pyx_t_19 = __pyx_v_i;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_centers_.diminfo[0].shape;
+        __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_centers_.diminfo[0].strides));
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+        __pyx_t_13 = __pyx_v_i;
+        __pyx_t_17 = __pyx_v_j;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+        __pyx_v_e1 = (__pyx_v_Z * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_err.diminfo[0].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides))));
 
-        /* "dadapy/_cython/cython_clustering.pyx":271
+        /* "dadapy/_cython/cython_clustering.pyx":288
  *                 a2 = (Rho_c[centers_[j]] - Rho_bord[i, j])
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])             # <<<<<<<<<<<<<<
  *                 if (a1 < e1 or a2 < e2):
  *                     check = 1
  */
-        __pyx_t_16 = __pyx_v_j;
-        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_centers_.diminfo[0].shape;
-        __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_centers_.diminfo[0].strides));
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-        __pyx_t_18 = __pyx_v_i;
         __pyx_t_17 = __pyx_v_j;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-        __pyx_v_e2 = (__pyx_v_Z * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_err.diminfo[0].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides))));
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_centers_.diminfo[0].shape;
+        __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers_.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_centers_.diminfo[0].strides));
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+        __pyx_t_19 = __pyx_v_i;
+        __pyx_t_18 = __pyx_v_j;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+        __pyx_v_e2 = (__pyx_v_Z * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_err.diminfo[0].strides)) + (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides))));
 
-        /* "dadapy/_cython/cython_clustering.pyx":272
+        /* "dadapy/_cython/cython_clustering.pyx":289
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])
  *                 if (a1 < e1 or a2 < e2):             # <<<<<<<<<<<<<<
  *                     check = 1
  *                     pos[index] = Rho_bord[i, j]
  */
         __pyx_t_8 = ((__pyx_v_a1 < __pyx_v_e1) != 0);
         if (!__pyx_t_8) {
         } else {
-          __pyx_t_25 = __pyx_t_8;
+          __pyx_t_28 = __pyx_t_8;
           goto __pyx_L83_bool_binop_done;
         }
         __pyx_t_8 = ((__pyx_v_a2 < __pyx_v_e2) != 0);
-        __pyx_t_25 = __pyx_t_8;
+        __pyx_t_28 = __pyx_t_8;
         __pyx_L83_bool_binop_done:;
-        if (__pyx_t_25) {
+        if (__pyx_t_28) {
 
-          /* "dadapy/_cython/cython_clustering.pyx":273
+          /* "dadapy/_cython/cython_clustering.pyx":290
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])
  *                 if (a1 < e1 or a2 < e2):
  *                     check = 1             # <<<<<<<<<<<<<<
  *                     pos[index] = Rho_bord[i, j]
  *                     ipos[index] = i
  */
           __pyx_v_check = 1;
 
-          /* "dadapy/_cython/cython_clustering.pyx":274
+          /* "dadapy/_cython/cython_clustering.pyx":291
  *                 if (a1 < e1 or a2 < e2):
  *                     check = 1
  *                     pos[index] = Rho_bord[i, j]             # <<<<<<<<<<<<<<
  *                     ipos[index] = i
  *                     jpos[index] = j
  */
-          __pyx_t_17 = __pyx_v_i;
-          __pyx_t_18 = __pyx_v_j;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          __pyx_t_16 = __pyx_v_index;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_pos.diminfo[0].shape;
-          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_pos.diminfo[0].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
+          __pyx_t_18 = __pyx_v_i;
+          __pyx_t_19 = __pyx_v_j;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          __pyx_t_17 = __pyx_v_index;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_pos.diminfo[0].shape;
+          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_pos.diminfo[0].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":275
+          /* "dadapy/_cython/cython_clustering.pyx":292
  *                     check = 1
  *                     pos[index] = Rho_bord[i, j]
  *                     ipos[index] = i             # <<<<<<<<<<<<<<
  *                     jpos[index] = j
  *                     if pos[index] > maxpos:
  */
-          __pyx_t_18 = __pyx_v_index;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_ipos.diminfo[0].shape;
-          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_ipos.diminfo[0].strides) = __pyx_v_i;
+          __pyx_t_19 = __pyx_v_index;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_ipos.diminfo[0].shape;
+          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_ipos.diminfo[0].strides) = __pyx_v_i;
 
-          /* "dadapy/_cython/cython_clustering.pyx":276
+          /* "dadapy/_cython/cython_clustering.pyx":293
  *                     pos[index] = Rho_bord[i, j]
  *                     ipos[index] = i
  *                     jpos[index] = j             # <<<<<<<<<<<<<<
  *                     if pos[index] > maxpos:
  *                         maxpos = pos[index]
  */
-          __pyx_t_18 = __pyx_v_index;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_jpos.diminfo[0].shape;
-          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_jpos.diminfo[0].strides) = __pyx_v_j;
+          __pyx_t_19 = __pyx_v_index;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_jpos.diminfo[0].shape;
+          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_jpos.diminfo[0].strides) = __pyx_v_j;
 
-          /* "dadapy/_cython/cython_clustering.pyx":277
+          /* "dadapy/_cython/cython_clustering.pyx":294
  *                     ipos[index] = i
  *                     jpos[index] = j
  *                     if pos[index] > maxpos:             # <<<<<<<<<<<<<<
  *                         maxpos = pos[index]
  *                         maxposidx = index
  */
-          __pyx_t_18 = __pyx_v_index;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_pos.diminfo[0].shape;
-          __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pos.diminfo[0].strides)) > __pyx_v_maxpos) != 0);
-          if (__pyx_t_25) {
+          __pyx_t_19 = __pyx_v_index;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_pos.diminfo[0].shape;
+          __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_pos.diminfo[0].strides)) > __pyx_v_maxpos) != 0);
+          if (__pyx_t_28) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":278
+            /* "dadapy/_cython/cython_clustering.pyx":295
  *                     jpos[index] = j
  *                     if pos[index] > maxpos:
  *                         maxpos = pos[index]             # <<<<<<<<<<<<<<
  *                         maxposidx = index
  * 
  */
-            __pyx_t_18 = __pyx_v_index;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_pos.diminfo[0].shape;
-            __pyx_v_maxpos = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pos.diminfo[0].strides));
+            __pyx_t_19 = __pyx_v_index;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_pos.diminfo[0].shape;
+            __pyx_v_maxpos = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_pos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_pos.diminfo[0].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":279
+            /* "dadapy/_cython/cython_clustering.pyx":296
  *                     if pos[index] > maxpos:
  *                         maxpos = pos[index]
  *                         maxposidx = index             # <<<<<<<<<<<<<<
  * 
  *                     index = index + 1
  */
             __pyx_v_maxposidx = __pyx_v_index;
 
-            /* "dadapy/_cython/cython_clustering.pyx":277
+            /* "dadapy/_cython/cython_clustering.pyx":294
  *                     ipos[index] = i
  *                     jpos[index] = j
  *                     if pos[index] > maxpos:             # <<<<<<<<<<<<<<
  *                         maxpos = pos[index]
  *                         maxposidx = index
  */
           }
 
-          /* "dadapy/_cython/cython_clustering.pyx":281
+          /* "dadapy/_cython/cython_clustering.pyx":298
  *                         maxposidx = index
  * 
  *                     index = index + 1             # <<<<<<<<<<<<<<
  * 
  *         if (check == 1):
  */
           __pyx_v_index = (__pyx_v_index + 1);
 
-          /* "dadapy/_cython/cython_clustering.pyx":272
+          /* "dadapy/_cython/cython_clustering.pyx":289
  *                 e1 = Z * (Rho_err[centers_[i]] + Rho_bord_err[i, j])
  *                 e2 = Z * (Rho_err[centers_[j]] + Rho_bord_err[i, j])
  *                 if (a1 < e1 or a2 < e2):             # <<<<<<<<<<<<<<
  *                     check = 1
  *                     pos[index] = Rho_bord[i, j]
  */
         }
       }
     }
 
-    /* "dadapy/_cython/cython_clustering.pyx":283
+    /* "dadapy/_cython/cython_clustering.pyx":300
  *                     index = index + 1
  * 
  *         if (check == 1):             # <<<<<<<<<<<<<<
  *             barriers = maxposidx
  * 
  */
-    __pyx_t_25 = ((__pyx_v_check == 1) != 0);
-    if (__pyx_t_25) {
+    __pyx_t_28 = ((__pyx_v_check == 1) != 0);
+    if (__pyx_t_28) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":284
+      /* "dadapy/_cython/cython_clustering.pyx":301
  * 
  *         if (check == 1):
  *             barriers = maxposidx             # <<<<<<<<<<<<<<
  * 
  *             imod = ipos[barriers]
  */
       __pyx_v_barriers = __pyx_v_maxposidx;
 
-      /* "dadapy/_cython/cython_clustering.pyx":286
+      /* "dadapy/_cython/cython_clustering.pyx":303
  *             barriers = maxposidx
  * 
  *             imod = ipos[barriers]             # <<<<<<<<<<<<<<
  *             jmod = jpos[barriers]
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])
  */
-      __pyx_t_18 = __pyx_v_barriers;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_ipos.diminfo[0].shape;
-      __pyx_v_imod = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_ipos.diminfo[0].strides));
+      __pyx_t_19 = __pyx_v_barriers;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_ipos.diminfo[0].shape;
+      __pyx_v_imod = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_ipos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_ipos.diminfo[0].strides));
 
-      /* "dadapy/_cython/cython_clustering.pyx":287
+      /* "dadapy/_cython/cython_clustering.pyx":304
  * 
  *             imod = ipos[barriers]
  *             jmod = jpos[barriers]             # <<<<<<<<<<<<<<
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])
  *             c2=(Rho_c[centers[jmod]] - Rho_bord[imod][jmod])/(Rho_err[centers[jmod]] + Rho_bord_err[imod][jmod])
  */
-      __pyx_t_18 = __pyx_v_barriers;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_jpos.diminfo[0].shape;
-      __pyx_v_jmod = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_jpos.diminfo[0].strides));
+      __pyx_t_19 = __pyx_v_barriers;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_jpos.diminfo[0].shape;
+      __pyx_v_jmod = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_jpos.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_jpos.diminfo[0].strides));
 
-      /* "dadapy/_cython/cython_clustering.pyx":288
+      /* "dadapy/_cython/cython_clustering.pyx":305
  *             imod = ipos[barriers]
  *             jmod = jpos[barriers]
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])             # <<<<<<<<<<<<<<
  *             c2=(Rho_c[centers[jmod]] - Rho_bord[imod][jmod])/(Rho_err[centers[jmod]] + Rho_bord_err[imod][jmod])
  *             if c1<c2:
  */
-      __pyx_t_18 = __pyx_v_imod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers.diminfo[0].strides));
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-      __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 288, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_19 = __pyx_v_imod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_centers.diminfo[0].strides));
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Subtract(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 288, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_18 = __pyx_v_imod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers.diminfo[0].strides));
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-      __pyx_t_4 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_err.diminfo[0].strides))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_19 = __pyx_v_imod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_centers.diminfo[0].strides));
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+      __pyx_t_4 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_err.diminfo[0].strides))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 305, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 305, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_XDECREF_SET(__pyx_v_c1, __pyx_t_2);
-      __pyx_t_2 = 0;
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_XDECREF_SET(__pyx_v_c1, __pyx_t_1);
+      __pyx_t_1 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":289
+      /* "dadapy/_cython/cython_clustering.pyx":306
  *             jmod = jpos[barriers]
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])
  *             c2=(Rho_c[centers[jmod]] - Rho_bord[imod][jmod])/(Rho_err[centers[jmod]] + Rho_bord_err[imod][jmod])             # <<<<<<<<<<<<<<
  *             if c1<c2:
  * 
  */
-      __pyx_t_18 = __pyx_v_jmod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers.diminfo[0].strides));
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+      __pyx_t_19 = __pyx_v_jmod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_centers.diminfo[0].strides));
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+      __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_18 = __pyx_v_jmod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_centers.diminfo[0].strides));
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
-      __pyx_t_6 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_err.diminfo[0].strides))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_19 = __pyx_v_jmod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_centers.diminfo[0].strides));
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_err.diminfo[0].shape;
+      __pyx_t_3 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_err.diminfo[0].strides))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_XDECREF_SET(__pyx_v_c2, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":290
+      /* "dadapy/_cython/cython_clustering.pyx":307
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])
  *             c2=(Rho_c[centers[jmod]] - Rho_bord[imod][jmod])/(Rho_err[centers[jmod]] + Rho_bord_err[imod][jmod])
  *             if c1<c2:             # <<<<<<<<<<<<<<
  * 
  *                 tmp = jmod
  */
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_c1, __pyx_v_c2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 290, __pyx_L1_error)
-      __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 290, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_c1, __pyx_v_c2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)
+      __pyx_t_28 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_28 < 0)) __PYX_ERR(0, 307, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (__pyx_t_25) {
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":292
+        /* "dadapy/_cython/cython_clustering.pyx":309
  *             if c1<c2:
  * 
  *                 tmp = jmod             # <<<<<<<<<<<<<<
  *                 jmod = imod
  *                 imod = tmp
  */
         __pyx_v_tmp = __pyx_v_jmod;
 
-        /* "dadapy/_cython/cython_clustering.pyx":293
+        /* "dadapy/_cython/cython_clustering.pyx":310
  * 
  *                 tmp = jmod
  *                 jmod = imod             # <<<<<<<<<<<<<<
  *                 imod = tmp
  * 
  */
         __pyx_v_jmod = __pyx_v_imod;
 
-        /* "dadapy/_cython/cython_clustering.pyx":294
+        /* "dadapy/_cython/cython_clustering.pyx":311
  *                 tmp = jmod
  *                 jmod = imod
  *                 imod = tmp             # <<<<<<<<<<<<<<
  * 
  *             clsurv[jmod] = 0
  */
         __pyx_v_imod = __pyx_v_tmp;
 
-        /* "dadapy/_cython/cython_clustering.pyx":290
+        /* "dadapy/_cython/cython_clustering.pyx":307
  *             c1=(Rho_c[centers[imod]] - Rho_bord[imod][jmod])/(Rho_err[centers[imod]] + Rho_bord_err[imod][jmod])
  *             c2=(Rho_c[centers[jmod]] - Rho_bord[imod][jmod])/(Rho_err[centers[jmod]] + Rho_bord_err[imod][jmod])
  *             if c1<c2:             # <<<<<<<<<<<<<<
  * 
  *                 tmp = jmod
  */
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":296
+      /* "dadapy/_cython/cython_clustering.pyx":313
  *                 imod = tmp
  * 
  *             clsurv[jmod] = 0             # <<<<<<<<<<<<<<
  * 
  *             Rho_bord[imod, jmod] = -1.
  */
-      __pyx_t_18 = __pyx_v_jmod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_clsurv.diminfo[0].strides) = 0;
+      __pyx_t_19 = __pyx_v_jmod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_clsurv.diminfo[0].strides) = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":298
+      /* "dadapy/_cython/cython_clustering.pyx":315
  *             clsurv[jmod] = 0
  * 
  *             Rho_bord[imod, jmod] = -1.             # <<<<<<<<<<<<<<
  *             Rho_bord[jmod, imod] = -1.
  *             Rho_bord_err[imod, jmod] = 0.
  */
-      __pyx_t_18 = __pyx_v_imod;
-      __pyx_t_17 = __pyx_v_jmod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
+      __pyx_t_19 = __pyx_v_imod;
+      __pyx_t_18 = __pyx_v_jmod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
 
-      /* "dadapy/_cython/cython_clustering.pyx":299
+      /* "dadapy/_cython/cython_clustering.pyx":316
  * 
  *             Rho_bord[imod, jmod] = -1.
  *             Rho_bord[jmod, imod] = -1.             # <<<<<<<<<<<<<<
  *             Rho_bord_err[imod, jmod] = 0.
  *             Rho_bord_err[jmod, imod] = 0.
  */
-      __pyx_t_17 = __pyx_v_jmod;
-      __pyx_t_18 = __pyx_v_imod;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
+      __pyx_t_18 = __pyx_v_jmod;
+      __pyx_t_19 = __pyx_v_imod;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.;
 
-      /* "dadapy/_cython/cython_clustering.pyx":300
+      /* "dadapy/_cython/cython_clustering.pyx":317
  *             Rho_bord[imod, jmod] = -1.
  *             Rho_bord[jmod, imod] = -1.
  *             Rho_bord_err[imod, jmod] = 0.             # <<<<<<<<<<<<<<
  *             Rho_bord_err[jmod, imod] = 0.
  * 
  */
-      __pyx_t_18 = __pyx_v_imod;
-      __pyx_t_17 = __pyx_v_jmod;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
+      __pyx_t_19 = __pyx_v_imod;
+      __pyx_t_18 = __pyx_v_jmod;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
 
-      /* "dadapy/_cython/cython_clustering.pyx":301
+      /* "dadapy/_cython/cython_clustering.pyx":318
  *             Rho_bord[jmod, imod] = -1.
  *             Rho_bord_err[imod, jmod] = 0.
  *             Rho_bord_err[jmod, imod] = 0.             # <<<<<<<<<<<<<<
  * 
  *             clstruct[imod].extend(clstruct[jmod])
  */
-      __pyx_t_17 = __pyx_v_jmod;
-      __pyx_t_18 = __pyx_v_imod;
-      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
+      __pyx_t_18 = __pyx_v_jmod;
+      __pyx_t_19 = __pyx_v_imod;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.;
 
-      /* "dadapy/_cython/cython_clustering.pyx":303
+      /* "dadapy/_cython/cython_clustering.pyx":320
  *             Rho_bord_err[jmod, imod] = 0.
  * 
  *             clstruct[imod].extend(clstruct[jmod])             # <<<<<<<<<<<<<<
  * 
  *             clstruct[jmod] = []
  */
-      __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_extend); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_imod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_extend); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_6 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_6)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_6);
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_jmod, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_1);
+      __pyx_t_3 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+        if (likely(__pyx_t_3)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_1, function);
+          __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
-      __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
-      __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
+      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":305
+      /* "dadapy/_cython/cython_clustering.pyx":322
  *             clstruct[imod].extend(clstruct[jmod])
  * 
  *             clstruct[jmod] = []             # <<<<<<<<<<<<<<
  * 
  *             for i in range(Nclus):
  */
-      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)
+      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(__Pyx_SetItemInt(__pyx_v_clstruct, __pyx_v_jmod, __pyx_t_4, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0) < 0)) __PYX_ERR(0, 305, __pyx_L1_error)
+      if (unlikely(__Pyx_SetItemInt(__pyx_v_clstruct, __pyx_v_jmod, __pyx_t_4, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0) < 0)) __PYX_ERR(0, 322, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":307
+      /* "dadapy/_cython/cython_clustering.pyx":324
  *             clstruct[jmod] = []
  * 
  *             for i in range(Nclus):             # <<<<<<<<<<<<<<
  *                 if (i != imod and i != jmod):
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):
  */
-      __pyx_t_9 = __pyx_v_Nclus;
-      __pyx_t_10 = __pyx_t_9;
-      for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-        __pyx_v_i = __pyx_t_11;
+      __pyx_t_10 = __pyx_v_Nclus;
+      __pyx_t_11 = __pyx_t_10;
+      for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+        __pyx_v_i = __pyx_t_12;
 
-        /* "dadapy/_cython/cython_clustering.pyx":308
+        /* "dadapy/_cython/cython_clustering.pyx":325
  * 
  *             for i in range(Nclus):
  *                 if (i != imod and i != jmod):             # <<<<<<<<<<<<<<
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):
- *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
+ * 
  */
         __pyx_t_8 = ((__pyx_v_i != __pyx_v_imod) != 0);
         if (__pyx_t_8) {
         } else {
-          __pyx_t_25 = __pyx_t_8;
+          __pyx_t_28 = __pyx_t_8;
           goto __pyx_L91_bool_binop_done;
         }
         __pyx_t_8 = ((__pyx_v_i != __pyx_v_jmod) != 0);
-        __pyx_t_25 = __pyx_t_8;
+        __pyx_t_28 = __pyx_t_8;
         __pyx_L91_bool_binop_done:;
-        if (__pyx_t_25) {
+        if (__pyx_t_28) {
 
-          /* "dadapy/_cython/cython_clustering.pyx":309
+          /* "dadapy/_cython/cython_clustering.pyx":326
  *             for i in range(Nclus):
  *                 if (i != imod and i != jmod):
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):             # <<<<<<<<<<<<<<
- *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
- *                         Rho_bord[i, imod] = Rho_bord[imod, i]
+ * 
+ *                         Point_bord[imod, i] = Point_bord[jmod, i]
  */
-          __pyx_t_18 = __pyx_v_imod;
-          __pyx_t_17 = __pyx_v_i;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          __pyx_t_16 = __pyx_v_jmod;
-          __pyx_t_12 = __pyx_v_i;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          __pyx_t_25 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)) < (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[1].strides))) != 0);
-          if (__pyx_t_25) {
+          __pyx_t_19 = __pyx_v_imod;
+          __pyx_t_18 = __pyx_v_i;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          __pyx_t_17 = __pyx_v_jmod;
+          __pyx_t_13 = __pyx_v_i;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          __pyx_t_28 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides)) < (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[1].strides))) != 0);
+          if (__pyx_t_28) {
 
-            /* "dadapy/_cython/cython_clustering.pyx":310
- *                 if (i != imod and i != jmod):
+            /* "dadapy/_cython/cython_clustering.pyx":328
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):
+ * 
+ *                         Point_bord[imod, i] = Point_bord[jmod, i]             # <<<<<<<<<<<<<<
+ *                         Point_bord[i, imod] = Point_bord[imod, i]
+ * 
+ */
+            __pyx_t_13 = __pyx_v_jmod;
+            __pyx_t_17 = __pyx_v_i;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+            __pyx_t_18 = __pyx_v_imod;
+            __pyx_t_19 = __pyx_v_i;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+
+            /* "dadapy/_cython/cython_clustering.pyx":329
+ * 
+ *                         Point_bord[imod, i] = Point_bord[jmod, i]
+ *                         Point_bord[i, imod] = Point_bord[imod, i]             # <<<<<<<<<<<<<<
+ * 
+ *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
+ */
+            __pyx_t_17 = __pyx_v_imod;
+            __pyx_t_13 = __pyx_v_i;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+            __pyx_t_19 = __pyx_v_i;
+            __pyx_t_18 = __pyx_v_imod;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Point_bord.diminfo[0].shape;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Point_bord.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Point_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_Point_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Point_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Point_bord.diminfo[1].strides));
+
+            /* "dadapy/_cython/cython_clustering.pyx":331
+ *                         Point_bord[i, imod] = Point_bord[imod, i]
+ * 
  *                         Rho_bord[imod, i] = Rho_bord[jmod, i]             # <<<<<<<<<<<<<<
  *                         Rho_bord[i, imod] = Rho_bord[imod, i]
- *                         Rho_bord_err[imod, i] = Rho_bord_err[jmod, i]
+ * 
  */
-            __pyx_t_12 = __pyx_v_jmod;
-            __pyx_t_16 = __pyx_v_i;
-            if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-            __pyx_t_17 = __pyx_v_imod;
-            __pyx_t_18 = __pyx_v_i;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
+            __pyx_t_13 = __pyx_v_jmod;
+            __pyx_t_17 = __pyx_v_i;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+            __pyx_t_18 = __pyx_v_imod;
+            __pyx_t_19 = __pyx_v_i;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":311
- *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):
+            /* "dadapy/_cython/cython_clustering.pyx":332
+ * 
  *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
  *                         Rho_bord[i, imod] = Rho_bord[imod, i]             # <<<<<<<<<<<<<<
+ * 
  *                         Rho_bord_err[imod, i] = Rho_bord_err[jmod, i]
- *                         Rho_bord_err[i, imod] = Rho_bord_err[imod, i]
  */
-            __pyx_t_16 = __pyx_v_imod;
-            __pyx_t_12 = __pyx_v_i;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-            if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-            __pyx_t_18 = __pyx_v_i;
             __pyx_t_17 = __pyx_v_imod;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
+            __pyx_t_13 = __pyx_v_i;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+            __pyx_t_19 = __pyx_v_i;
+            __pyx_t_18 = __pyx_v_imod;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":312
- *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
+            /* "dadapy/_cython/cython_clustering.pyx":334
  *                         Rho_bord[i, imod] = Rho_bord[imod, i]
+ * 
  *                         Rho_bord_err[imod, i] = Rho_bord_err[jmod, i]             # <<<<<<<<<<<<<<
  *                         Rho_bord_err[i, imod] = Rho_bord_err[imod, i]
  * 
  */
-            __pyx_t_12 = __pyx_v_jmod;
-            __pyx_t_16 = __pyx_v_i;
-            if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-            __pyx_t_17 = __pyx_v_imod;
-            __pyx_t_18 = __pyx_v_i;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
+            __pyx_t_13 = __pyx_v_jmod;
+            __pyx_t_17 = __pyx_v_i;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+            __pyx_t_18 = __pyx_v_imod;
+            __pyx_t_19 = __pyx_v_i;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":313
- *                         Rho_bord[i, imod] = Rho_bord[imod, i]
+            /* "dadapy/_cython/cython_clustering.pyx":335
+ * 
  *                         Rho_bord_err[imod, i] = Rho_bord_err[jmod, i]
  *                         Rho_bord_err[i, imod] = Rho_bord_err[imod, i]             # <<<<<<<<<<<<<<
  * 
  *                     Rho_bord[jmod, i] = -1
  */
-            __pyx_t_16 = __pyx_v_imod;
-            __pyx_t_12 = __pyx_v_i;
-            if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-            if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-            __pyx_t_18 = __pyx_v_i;
             __pyx_t_17 = __pyx_v_imod;
-            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
+            __pyx_t_13 = __pyx_v_i;
+            if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+            if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+            __pyx_t_19 = __pyx_v_i;
+            __pyx_t_18 = __pyx_v_imod;
+            if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+            if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+            *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
 
-            /* "dadapy/_cython/cython_clustering.pyx":309
+            /* "dadapy/_cython/cython_clustering.pyx":326
  *             for i in range(Nclus):
  *                 if (i != imod and i != jmod):
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):             # <<<<<<<<<<<<<<
- *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
- *                         Rho_bord[i, imod] = Rho_bord[imod, i]
+ * 
+ *                         Point_bord[imod, i] = Point_bord[jmod, i]
  */
           }
 
-          /* "dadapy/_cython/cython_clustering.pyx":315
+          /* "dadapy/_cython/cython_clustering.pyx":337
  *                         Rho_bord_err[i, imod] = Rho_bord_err[imod, i]
  * 
  *                     Rho_bord[jmod, i] = -1             # <<<<<<<<<<<<<<
  *                     Rho_bord[i, jmod] = Rho_bord[jmod, i]
  *                     Rho_bord_err[jmod, i] = 0
  */
-          __pyx_t_12 = __pyx_v_jmod;
-          __pyx_t_16 = __pyx_v_i;
-          if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.0;
+          __pyx_t_13 = __pyx_v_jmod;
+          __pyx_t_17 = __pyx_v_i;
+          if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = -1.0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":316
+          /* "dadapy/_cython/cython_clustering.pyx":338
  * 
  *                     Rho_bord[jmod, i] = -1
  *                     Rho_bord[i, jmod] = Rho_bord[jmod, i]             # <<<<<<<<<<<<<<
  *                     Rho_bord_err[jmod, i] = 0
  *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]
  */
-          __pyx_t_16 = __pyx_v_jmod;
-          __pyx_t_12 = __pyx_v_i;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          __pyx_t_17 = __pyx_v_i;
-          __pyx_t_18 = __pyx_v_jmod;
+          __pyx_t_17 = __pyx_v_jmod;
+          __pyx_t_13 = __pyx_v_i;
           if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
+          if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          __pyx_t_18 = __pyx_v_i;
+          __pyx_t_19 = __pyx_v_jmod;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord.diminfo[0].shape;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Rho_bord.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord.diminfo[1].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":317
+          /* "dadapy/_cython/cython_clustering.pyx":339
  *                     Rho_bord[jmod, i] = -1
  *                     Rho_bord[i, jmod] = Rho_bord[jmod, i]
  *                     Rho_bord_err[jmod, i] = 0             # <<<<<<<<<<<<<<
  *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]
- *     sec2 = time.time()
+ * 
  */
-          __pyx_t_12 = __pyx_v_jmod;
-          __pyx_t_16 = __pyx_v_i;
-          if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.0;
+          __pyx_t_13 = __pyx_v_jmod;
+          __pyx_t_17 = __pyx_v_i;
+          if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = 0.0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":318
+          /* "dadapy/_cython/cython_clustering.pyx":340
  *                     Rho_bord[i, jmod] = Rho_bord[jmod, i]
  *                     Rho_bord_err[jmod, i] = 0
  *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]             # <<<<<<<<<<<<<<
- *     sec2 = time.time()
- *     if verb:
+ * 
+ * 
  */
-          __pyx_t_16 = __pyx_v_jmod;
-          __pyx_t_12 = __pyx_v_i;
-          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-          if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-          __pyx_t_18 = __pyx_v_i;
           __pyx_t_17 = __pyx_v_jmod;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
+          __pyx_t_13 = __pyx_v_i;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+          if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+          __pyx_t_19 = __pyx_v_i;
+          __pyx_t_18 = __pyx_v_jmod;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Rho_bord_err.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Rho_bord_err.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_bord_err.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Rho_bord_err.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Rho_bord_err.diminfo[1].strides));
 
-          /* "dadapy/_cython/cython_clustering.pyx":308
+          /* "dadapy/_cython/cython_clustering.pyx":325
  * 
  *             for i in range(Nclus):
  *                 if (i != imod and i != jmod):             # <<<<<<<<<<<<<<
  *                     if (Rho_bord[imod, i] < Rho_bord[jmod, i]):
- *                         Rho_bord[imod, i] = Rho_bord[jmod, i]
+ * 
  */
         }
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":283
+      /* "dadapy/_cython/cython_clustering.pyx":300
  *                     index = index + 1
  * 
  *         if (check == 1):             # <<<<<<<<<<<<<<
  *             barriers = maxposidx
  * 
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":319
- *                     Rho_bord_err[jmod, i] = 0
- *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]
- *     sec2 = time.time()             # <<<<<<<<<<<<<<
- *     if verb:
- *         print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_1)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_1);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
-    }
-  }
-  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec2, __pyx_t_4);
-  __pyx_t_4 = 0;
-
-  /* "dadapy/_cython/cython_clustering.pyx":320
- *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]
- *     sec2 = time.time()
+  /* "dadapy/_cython/cython_clustering.pyx":343
+ * 
+ * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))
- *     sec = time.time()
+ *       lag = time.time() - sec
+ *       print(f"Multimodality test finished: {lag: .3f} sec")
  */
-  __pyx_t_25 = (__pyx_v_verb != 0);
-  if (__pyx_t_25) {
+  __pyx_t_28 = (__pyx_v_verb != 0);
+  if (__pyx_t_28) {
 
-    /* "dadapy/_cython/cython_clustering.pyx":321
- *     sec2 = time.time()
- *     if verb:
- *         print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))             # <<<<<<<<<<<<<<
- *     sec = time.time()
+    /* "dadapy/_cython/cython_clustering.pyx":344
  * 
+ *     if verb:
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Multimodality test finished: {lag: .3f} sec")
+ *       sec = time.time()
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_0_0_2f_seconds_with_multimodali, __pyx_n_s_format); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_sec2, __pyx_v_sec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_6)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
-    __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 321, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 344, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 344, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_lag = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":320
- *                     Rho_bord_err[i, jmod] = Rho_bord_err[jmod, i]
- *     sec2 = time.time()
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))
- *     sec = time.time()
+    /* "dadapy/_cython/cython_clustering.pyx":345
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Multimodality test finished: {lag: .3f} sec")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
+ * 
  */
-  }
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Multimodality_test_finished);
+    __pyx_t_21 += 29;
+    __Pyx_GIVEREF(__pyx_kp_u_Multimodality_test_finished);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_Multimodality_test_finished);
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __pyx_t_4 = __Pyx_PyObject_Format(__pyx_t_1, __pyx_kp_u_3f); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
+    __pyx_t_4 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_sec);
+    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 345, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":322
- *     if verb:
- *         print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))
- *     sec = time.time()             # <<<<<<<<<<<<<<
+    /* "dadapy/_cython/cython_clustering.pyx":346
+ *       lag = time.time() - sec
+ *       print(f"Multimodality test finished: {lag: .3f} sec")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
  * 
  *     Nclus_m = 0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-      __Pyx_INCREF(__pyx_t_2);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_1, function);
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_1, function);
+      }
     }
+    __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 346, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __pyx_v_sec = __pyx_t_9;
+
+    /* "dadapy/_cython/cython_clustering.pyx":343
+ * 
+ * 
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Multimodality test finished: {lag: .3f} sec")
+ */
   }
-  __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec, __pyx_t_4);
-  __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":324
- *     sec = time.time()
+  /* "dadapy/_cython/cython_clustering.pyx":348
+ *       sec = time.time()
  * 
  *     Nclus_m = 0             # <<<<<<<<<<<<<<
  *     clstruct_m = []
  *     centers_m = []
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_Nclus_m = __pyx_int_0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":325
+  /* "dadapy/_cython/cython_clustering.pyx":349
  * 
  *     Nclus_m = 0
  *     clstruct_m = []             # <<<<<<<<<<<<<<
  *     centers_m = []
  *     nnum = []
  */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_clstruct_m = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":326
+  /* "dadapy/_cython/cython_clustering.pyx":350
  *     Nclus_m = 0
  *     clstruct_m = []
  *     centers_m = []             # <<<<<<<<<<<<<<
  *     nnum = []
  *     for j in range(Nclus):
  */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 326, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_centers_m = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":327
+  /* "dadapy/_cython/cython_clustering.pyx":351
  *     clstruct_m = []
  *     centers_m = []
  *     nnum = []             # <<<<<<<<<<<<<<
  *     for j in range(Nclus):
  *         nnum.append(-1)
  */
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_nnum = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":328
+  /* "dadapy/_cython/cython_clustering.pyx":352
  *     centers_m = []
  *     nnum = []
  *     for j in range(Nclus):             # <<<<<<<<<<<<<<
  *         nnum.append(-1)
  *         if (clsurv[j] == 1):
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_j = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_j = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":329
+    /* "dadapy/_cython/cython_clustering.pyx":353
  *     nnum = []
  *     for j in range(Nclus):
  *         nnum.append(-1)             # <<<<<<<<<<<<<<
  *         if (clsurv[j] == 1):
  *             nnum[j] = Nclus_m
  */
-    __pyx_t_27 = __Pyx_PyList_Append(__pyx_v_nnum, __pyx_int_neg_1); if (unlikely(__pyx_t_27 == ((int)-1))) __PYX_ERR(0, 329, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyList_Append(__pyx_v_nnum, __pyx_int_neg_1); if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 353, __pyx_L1_error)
 
-    /* "dadapy/_cython/cython_clustering.pyx":330
+    /* "dadapy/_cython/cython_clustering.pyx":354
  *     for j in range(Nclus):
  *         nnum.append(-1)
  *         if (clsurv[j] == 1):             # <<<<<<<<<<<<<<
  *             nnum[j] = Nclus_m
  *             Nclus_m = Nclus_m + 1
  */
-    __pyx_t_12 = __pyx_v_j;
-    if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
-    __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
-    if (__pyx_t_25) {
+    __pyx_t_13 = __pyx_v_j;
+    if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
+    __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
+    if (__pyx_t_28) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":331
+      /* "dadapy/_cython/cython_clustering.pyx":355
  *         nnum.append(-1)
  *         if (clsurv[j] == 1):
  *             nnum[j] = Nclus_m             # <<<<<<<<<<<<<<
  *             Nclus_m = Nclus_m + 1
  *             clstruct_m.append(clstruct[j])
  */
-      if (unlikely(__Pyx_SetItemInt(__pyx_v_nnum, __pyx_v_j, __pyx_v_Nclus_m, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0) < 0)) __PYX_ERR(0, 331, __pyx_L1_error)
+      if (unlikely(__Pyx_SetItemInt(__pyx_v_nnum, __pyx_v_j, __pyx_v_Nclus_m, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0) < 0)) __PYX_ERR(0, 355, __pyx_L1_error)
 
-      /* "dadapy/_cython/cython_clustering.pyx":332
+      /* "dadapy/_cython/cython_clustering.pyx":356
  *         if (clsurv[j] == 1):
  *             nnum[j] = Nclus_m
  *             Nclus_m = Nclus_m + 1             # <<<<<<<<<<<<<<
  *             clstruct_m.append(clstruct[j])
  *             centers_m.append(centers[j])
  */
-      __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_Nclus_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_Nclus_m, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 356, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF_SET(__pyx_v_Nclus_m, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":333
+      /* "dadapy/_cython/cython_clustering.pyx":357
  *             nnum[j] = Nclus_m
  *             Nclus_m = Nclus_m + 1
  *             clstruct_m.append(clstruct[j])             # <<<<<<<<<<<<<<
  *             centers_m.append(centers[j])
  * 
  */
-      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_clstruct, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 357, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_27 = __Pyx_PyList_Append(__pyx_v_clstruct_m, __pyx_t_4); if (unlikely(__pyx_t_27 == ((int)-1))) __PYX_ERR(0, 333, __pyx_L1_error)
+      __pyx_t_30 = __Pyx_PyList_Append(__pyx_v_clstruct_m, __pyx_t_4); if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 357, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":334
+      /* "dadapy/_cython/cython_clustering.pyx":358
  *             Nclus_m = Nclus_m + 1
  *             clstruct_m.append(clstruct[j])
  *             centers_m.append(centers[j])             # <<<<<<<<<<<<<<
  * 
  *     Point_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=int)
  */
-      __pyx_t_12 = __pyx_v_j;
-      if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_centers.diminfo[0].shape;
-      __pyx_t_4 = __Pyx_PyInt_From_npy_long((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_centers.diminfo[0].strides))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
+      __pyx_t_13 = __pyx_v_j;
+      if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_centers.diminfo[0].shape;
+      __pyx_t_4 = __Pyx_PyInt_From_npy_long((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_centers.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_centers.diminfo[0].strides))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 358, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_27 = __Pyx_PyList_Append(__pyx_v_centers_m, __pyx_t_4); if (unlikely(__pyx_t_27 == ((int)-1))) __PYX_ERR(0, 334, __pyx_L1_error)
+      __pyx_t_30 = __Pyx_PyList_Append(__pyx_v_centers_m, __pyx_t_4); if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 358, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":330
+      /* "dadapy/_cython/cython_clustering.pyx":354
  *     for j in range(Nclus):
  *         nnum.append(-1)
  *         if (clsurv[j] == 1):             # <<<<<<<<<<<<<<
  *             nnum[j] = Nclus_m
  *             Nclus_m = Nclus_m + 1
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":336
+  /* "dadapy/_cython/cython_clustering.pyx":360
  *             centers_m.append(centers[j])
  * 
  *     Point_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=int)             # <<<<<<<<<<<<<<
  *     Rho_bord_err_m = np.zeros((Nclus_m, Nclus_m), dtype=float)
  *     Rho_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=float)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_Nclus_m);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_Nclus_m);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 336, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 336, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_Point_bord_m = __pyx_t_6;
-  __pyx_t_6 = 0;
+  __pyx_v_Point_bord_m = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":337
+  /* "dadapy/_cython/cython_clustering.pyx":361
  * 
  *     Point_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=int)
  *     Rho_bord_err_m = np.zeros((Nclus_m, Nclus_m), dtype=float)             # <<<<<<<<<<<<<<
  *     Rho_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=float)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_Nclus_m);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_Nclus_m);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_Nclus_m);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_Nclus_m);
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_6);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
-  __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 337, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&PyFloat_Type))) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyFloat_Type))) < 0) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_Rho_bord_err_m = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":338
+  /* "dadapy/_cython/cython_clustering.pyx":362
  *     Point_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=int)
  *     Rho_bord_err_m = np.zeros((Nclus_m, Nclus_m), dtype=float)
  *     Rho_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=float)             # <<<<<<<<<<<<<<
  * 
  *     for j in range(Nclus):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_Nclus_m);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_Nclus_m);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyFloat_Type))) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyFloat_Type))) < 0) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Rho_bord_m = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":340
+  /* "dadapy/_cython/cython_clustering.pyx":364
  *     Rho_bord_m = np.zeros((Nclus_m, Nclus_m), dtype=float)
  * 
  *     for j in range(Nclus):             # <<<<<<<<<<<<<<
  *         if (clsurv[j] == 1):
  *             jj = nnum[j]
  */
-  __pyx_t_9 = __pyx_v_Nclus;
-  __pyx_t_10 = __pyx_t_9;
-  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
-    __pyx_v_j = __pyx_t_11;
+  __pyx_t_10 = __pyx_v_Nclus;
+  __pyx_t_11 = __pyx_t_10;
+  for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
+    __pyx_v_j = __pyx_t_12;
 
-    /* "dadapy/_cython/cython_clustering.pyx":341
+    /* "dadapy/_cython/cython_clustering.pyx":365
  * 
  *     for j in range(Nclus):
  *         if (clsurv[j] == 1):             # <<<<<<<<<<<<<<
  *             jj = nnum[j]
  *             for k in range(Nclus):
  */
-    __pyx_t_12 = __pyx_v_j;
-    if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
-    __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
-    if (__pyx_t_25) {
+    __pyx_t_13 = __pyx_v_j;
+    if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
+    __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
+    if (__pyx_t_28) {
 
-      /* "dadapy/_cython/cython_clustering.pyx":342
+      /* "dadapy/_cython/cython_clustering.pyx":366
  *     for j in range(Nclus):
  *         if (clsurv[j] == 1):
  *             jj = nnum[j]             # <<<<<<<<<<<<<<
  *             for k in range(Nclus):
  *                 if (clsurv[k] == 1):
  */
-      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_nnum, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 342, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_nnum, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_XDECREF_SET(__pyx_v_jj, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":343
+      /* "dadapy/_cython/cython_clustering.pyx":367
  *         if (clsurv[j] == 1):
  *             jj = nnum[j]
  *             for k in range(Nclus):             # <<<<<<<<<<<<<<
  *                 if (clsurv[k] == 1):
  *                     kk = nnum[k]
  */
-      __pyx_t_13 = __pyx_v_Nclus;
-      __pyx_t_14 = __pyx_t_13;
-      for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
-        __pyx_v_k = __pyx_t_15;
+      __pyx_t_14 = __pyx_v_Nclus;
+      __pyx_t_15 = __pyx_t_14;
+      for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
+        __pyx_v_k = __pyx_t_16;
 
-        /* "dadapy/_cython/cython_clustering.pyx":344
+        /* "dadapy/_cython/cython_clustering.pyx":368
  *             jj = nnum[j]
  *             for k in range(Nclus):
  *                 if (clsurv[k] == 1):             # <<<<<<<<<<<<<<
  *                     kk = nnum[k]
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]
  */
-        __pyx_t_12 = __pyx_v_k;
-        if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
-        __pyx_t_25 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
-        if (__pyx_t_25) {
+        __pyx_t_13 = __pyx_v_k;
+        if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_clsurv.diminfo[0].shape;
+        __pyx_t_28 = (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t *, __pyx_pybuffernd_clsurv.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_clsurv.diminfo[0].strides)) == 1) != 0);
+        if (__pyx_t_28) {
 
-          /* "dadapy/_cython/cython_clustering.pyx":345
+          /* "dadapy/_cython/cython_clustering.pyx":369
  *             for k in range(Nclus):
  *                 if (clsurv[k] == 1):
  *                     kk = nnum[k]             # <<<<<<<<<<<<<<
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]
  *                     Rho_bord_err_m[jj][kk] = Rho_bord_err[j][k]
  */
-          __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_nnum, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 345, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_GetItemInt_List(__pyx_v_nnum, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_XDECREF_SET(__pyx_v_kk, __pyx_t_4);
           __pyx_t_4 = 0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":346
+          /* "dadapy/_cython/cython_clustering.pyx":370
  *                 if (clsurv[k] == 1):
  *                     kk = nnum[k]
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]             # <<<<<<<<<<<<<<
  *                     Rho_bord_err_m[jj][kk] = Rho_bord_err[j][k]
  *                     Point_bord_m[jj][kk]=Point_bord[j][k]
  */
-          __pyx_t_4 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 346, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 370, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_Rho_bord_m, __pyx_v_jj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 346, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_Rho_bord_m, __pyx_v_jj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 370, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_v_kk, __pyx_t_1) < 0)) __PYX_ERR(0, 346, __pyx_L1_error)
+          if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_v_kk, __pyx_t_1) < 0)) __PYX_ERR(0, 370, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":347
+          /* "dadapy/_cython/cython_clustering.pyx":371
  *                     kk = nnum[k]
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]
  *                     Rho_bord_err_m[jj][kk] = Rho_bord_err[j][k]             # <<<<<<<<<<<<<<
  *                     Point_bord_m[jj][kk]=Point_bord[j][k]
  * 
  */
-          __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Rho_bord_err), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 347, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 371, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_Rho_bord_err_m, __pyx_v_jj); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_Rho_bord_err_m, __pyx_v_jj); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_kk, __pyx_t_4) < 0)) __PYX_ERR(0, 347, __pyx_L1_error)
+          if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_v_kk, __pyx_t_4) < 0)) __PYX_ERR(0, 371, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":348
+          /* "dadapy/_cython/cython_clustering.pyx":372
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]
  *                     Rho_bord_err_m[jj][kk] = Rho_bord_err[j][k]
  *                     Point_bord_m[jj][kk]=Point_bord[j][k]             # <<<<<<<<<<<<<<
  * 
  *     Last_cls = np.empty(Nele, dtype=int)
  */
-          __pyx_t_4 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Point_bord), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_GetItemInt(((PyObject *)__pyx_v_Point_bord), __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 372, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_4, __pyx_v_k, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_Point_bord_m, __pyx_v_jj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_Point_bord_m, __pyx_v_jj); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 372, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_v_kk, __pyx_t_1) < 0)) __PYX_ERR(0, 348, __pyx_L1_error)
+          if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_v_kk, __pyx_t_1) < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "dadapy/_cython/cython_clustering.pyx":344
+          /* "dadapy/_cython/cython_clustering.pyx":368
  *             jj = nnum[j]
  *             for k in range(Nclus):
  *                 if (clsurv[k] == 1):             # <<<<<<<<<<<<<<
  *                     kk = nnum[k]
  *                     Rho_bord_m[jj][kk] = Rho_bord[j][k]
  */
         }
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":341
+      /* "dadapy/_cython/cython_clustering.pyx":365
  * 
  *     for j in range(Nclus):
  *         if (clsurv[j] == 1):             # <<<<<<<<<<<<<<
  *             jj = nnum[j]
  *             for k in range(Nclus):
  */
     }
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":350
+  /* "dadapy/_cython/cython_clustering.pyx":374
  *                     Point_bord_m[jj][kk]=Point_bord[j][k]
  * 
  *     Last_cls = np.empty(Nele, dtype=int)             # <<<<<<<<<<<<<<
  *     for j in range(Nclus_m):
  *         for k in clstruct_m[j]:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_Nele); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 350, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 350, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_Last_cls = __pyx_t_6;
-  __pyx_t_6 = 0;
+  __pyx_v_Last_cls = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":351
+  /* "dadapy/_cython/cython_clustering.pyx":375
  * 
  *     Last_cls = np.empty(Nele, dtype=int)
  *     for j in range(Nclus_m):             # <<<<<<<<<<<<<<
  *         for k in clstruct_m[j]:
  *             Last_cls[k] = j
  */
-  __pyx_t_40 = __Pyx_PyInt_As_long(__pyx_v_Nclus_m); if (unlikely((__pyx_t_40 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 351, __pyx_L1_error)
-  __pyx_t_41 = __pyx_t_40;
-  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_41; __pyx_t_9+=1) {
-    __pyx_v_j = __pyx_t_9;
+  __pyx_t_42 = __Pyx_PyInt_As_long(__pyx_v_Nclus_m); if (unlikely((__pyx_t_42 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 375, __pyx_L1_error)
+  __pyx_t_43 = __pyx_t_42;
+  for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_43; __pyx_t_10+=1) {
+    __pyx_v_j = __pyx_t_10;
 
-    /* "dadapy/_cython/cython_clustering.pyx":352
+    /* "dadapy/_cython/cython_clustering.pyx":376
  *     Last_cls = np.empty(Nele, dtype=int)
  *     for j in range(Nclus_m):
  *         for k in clstruct_m[j]:             # <<<<<<<<<<<<<<
  *             Last_cls[k] = j
  *     Last_cls_halo = np.copy(Last_cls)
  */
-    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_clstruct_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 352, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
-      __pyx_t_1 = __pyx_t_6; __Pyx_INCREF(__pyx_t_1); __pyx_t_35 = 0;
-      __pyx_t_36 = NULL;
+    __pyx_t_3 = __Pyx_GetItemInt_List(__pyx_v_clstruct_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
+      __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_21 = 0;
+      __pyx_t_38 = NULL;
     } else {
-      __pyx_t_35 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
+      __pyx_t_21 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_36 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 352, __pyx_L1_error)
+      __pyx_t_38 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_38)) __PYX_ERR(0, 376, __pyx_L1_error)
     }
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     for (;;) {
-      if (likely(!__pyx_t_36)) {
+      if (likely(!__pyx_t_38)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
-          if (__pyx_t_35 >= PyList_GET_SIZE(__pyx_t_1)) break;
+          if (__pyx_t_21 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_35); __Pyx_INCREF(__pyx_t_6); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 352, __pyx_L1_error)
+          __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_21); __Pyx_INCREF(__pyx_t_3); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 352, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           #endif
         } else {
-          if (__pyx_t_35 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+          if (__pyx_t_21 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_35); __Pyx_INCREF(__pyx_t_6); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 352, __pyx_L1_error)
+          __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_21); __Pyx_INCREF(__pyx_t_3); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
           #else
-          __pyx_t_6 = PySequence_ITEM(__pyx_t_1, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 352, __pyx_L1_error)
-          __Pyx_GOTREF(__pyx_t_6);
+          __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 376, __pyx_L1_error)
+          __Pyx_GOTREF(__pyx_t_3);
           #endif
         }
       } else {
-        __pyx_t_6 = __pyx_t_36(__pyx_t_1);
-        if (unlikely(!__pyx_t_6)) {
+        __pyx_t_3 = __pyx_t_38(__pyx_t_1);
+        if (unlikely(!__pyx_t_3)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 352, __pyx_L1_error)
+            else __PYX_ERR(0, 376, __pyx_L1_error)
           }
           break;
         }
-        __Pyx_GOTREF(__pyx_t_6);
+        __Pyx_GOTREF(__pyx_t_3);
       }
-      __pyx_t_10 = __Pyx_PyInt_As_npy_long(__pyx_t_6); if (unlikely((__pyx_t_10 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 352, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_v_k = __pyx_t_10;
+      __pyx_t_11 = __Pyx_PyInt_As_npy_long(__pyx_t_3); if (unlikely((__pyx_t_11 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 376, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_v_k = __pyx_t_11;
 
-      /* "dadapy/_cython/cython_clustering.pyx":353
+      /* "dadapy/_cython/cython_clustering.pyx":377
  *     for j in range(Nclus_m):
  *         for k in clstruct_m[j]:
  *             Last_cls[k] = j             # <<<<<<<<<<<<<<
  *     Last_cls_halo = np.copy(Last_cls)
  *     nh = 0
  */
-      __pyx_t_6 = __Pyx_PyInt_From_npy_long(__pyx_v_j); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 353, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_6);
-      if (unlikely(__Pyx_SetItemInt(__pyx_v_Last_cls, __pyx_v_k, __pyx_t_6, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0) < 0)) __PYX_ERR(0, 353, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
+      __pyx_t_3 = __Pyx_PyInt_From_npy_long(__pyx_v_j); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 377, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(__Pyx_SetItemInt(__pyx_v_Last_cls, __pyx_v_k, __pyx_t_3, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0) < 0)) __PYX_ERR(0, 377, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "dadapy/_cython/cython_clustering.pyx":352
+      /* "dadapy/_cython/cython_clustering.pyx":376
  *     Last_cls = np.empty(Nele, dtype=int)
  *     for j in range(Nclus_m):
  *         for k in clstruct_m[j]:             # <<<<<<<<<<<<<<
  *             Last_cls[k] = j
  *     Last_cls_halo = np.copy(Last_cls)
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":354
+  /* "dadapy/_cython/cython_clustering.pyx":378
  *         for k in clstruct_m[j]:
  *             Last_cls[k] = j
  *     Last_cls_halo = np.copy(Last_cls)             # <<<<<<<<<<<<<<
  *     nh = 0
  *     for j in range(Nclus_m):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 354, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = NULL;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_6)) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_v_Last_cls) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_Last_cls);
-  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_Last_cls) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_Last_cls);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 378, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_Last_cls_halo = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":355
+  /* "dadapy/_cython/cython_clustering.pyx":379
  *             Last_cls[k] = j
  *     Last_cls_halo = np.copy(Last_cls)
  *     nh = 0             # <<<<<<<<<<<<<<
  *     for j in range(Nclus_m):
  *         Rho_halo = max(Rho_bord_m[j])
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_nh = __pyx_int_0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":356
+  /* "dadapy/_cython/cython_clustering.pyx":380
  *     Last_cls_halo = np.copy(Last_cls)
  *     nh = 0
  *     for j in range(Nclus_m):             # <<<<<<<<<<<<<<
  *         Rho_halo = max(Rho_bord_m[j])
  *         for k in clstruct_m[j]:
  */
-  __pyx_t_40 = __Pyx_PyInt_As_long(__pyx_v_Nclus_m); if (unlikely((__pyx_t_40 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 356, __pyx_L1_error)
-  __pyx_t_41 = __pyx_t_40;
-  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_41; __pyx_t_9+=1) {
-    __pyx_v_j = __pyx_t_9;
+  __pyx_t_42 = __Pyx_PyInt_As_long(__pyx_v_Nclus_m); if (unlikely((__pyx_t_42 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_43 = __pyx_t_42;
+  for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_43; __pyx_t_10+=1) {
+    __pyx_v_j = __pyx_t_10;
 
-    /* "dadapy/_cython/cython_clustering.pyx":357
+    /* "dadapy/_cython/cython_clustering.pyx":381
  *     nh = 0
  *     for j in range(Nclus_m):
  *         Rho_halo = max(Rho_bord_m[j])             # <<<<<<<<<<<<<<
  *         for k in clstruct_m[j]:
  *             if (Rho_c[k] < Rho_halo):
  */
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_Rho_bord_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 357, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_Rho_bord_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_max, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_max, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_Rho_halo, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":358
+    /* "dadapy/_cython/cython_clustering.pyx":382
  *     for j in range(Nclus_m):
  *         Rho_halo = max(Rho_bord_m[j])
  *         for k in clstruct_m[j]:             # <<<<<<<<<<<<<<
  *             if (Rho_c[k] < Rho_halo):
  *                 nh = nh + 1
  */
-    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_clstruct_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt_List(__pyx_v_clstruct_m, __pyx_v_j, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
-      __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_35 = 0;
-      __pyx_t_36 = NULL;
+      __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_21 = 0;
+      __pyx_t_38 = NULL;
     } else {
-      __pyx_t_35 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
+      __pyx_t_21 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 382, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_36 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 358, __pyx_L1_error)
+      __pyx_t_38 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_38)) __PYX_ERR(0, 382, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     for (;;) {
-      if (likely(!__pyx_t_36)) {
+      if (likely(!__pyx_t_38)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
-          if (__pyx_t_35 >= PyList_GET_SIZE(__pyx_t_1)) break;
+          if (__pyx_t_21 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_35); __Pyx_INCREF(__pyx_t_2); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 358, __pyx_L1_error)
+          __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_21); __Pyx_INCREF(__pyx_t_2); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 382, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         } else {
-          if (__pyx_t_35 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
+          if (__pyx_t_21 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_35); __Pyx_INCREF(__pyx_t_2); __pyx_t_35++; if (unlikely(0 < 0)) __PYX_ERR(0, 358, __pyx_L1_error)
+          __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_21); __Pyx_INCREF(__pyx_t_2); __pyx_t_21++; if (unlikely(0 < 0)) __PYX_ERR(0, 382, __pyx_L1_error)
           #else
-          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_35); __pyx_t_35++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)
+          __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_21); __pyx_t_21++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_2);
           #endif
         }
       } else {
-        __pyx_t_2 = __pyx_t_36(__pyx_t_1);
+        __pyx_t_2 = __pyx_t_38(__pyx_t_1);
         if (unlikely(!__pyx_t_2)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 358, __pyx_L1_error)
+            else __PYX_ERR(0, 382, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_2);
       }
-      __pyx_t_10 = __Pyx_PyInt_As_npy_long(__pyx_t_2); if (unlikely((__pyx_t_10 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 358, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_As_npy_long(__pyx_t_2); if (unlikely((__pyx_t_11 == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 382, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_v_k = __pyx_t_10;
+      __pyx_v_k = __pyx_t_11;
 
-      /* "dadapy/_cython/cython_clustering.pyx":359
+      /* "dadapy/_cython/cython_clustering.pyx":383
  *         Rho_halo = max(Rho_bord_m[j])
  *         for k in clstruct_m[j]:
  *             if (Rho_c[k] < Rho_halo):             # <<<<<<<<<<<<<<
  *                 nh = nh + 1
  *                 Last_cls_halo[k] = -1
  */
-      __pyx_t_12 = __pyx_v_k;
-      if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
-      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)
+      __pyx_t_13 = __pyx_v_k;
+      if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Rho_c.diminfo[0].shape;
+      __pyx_t_2 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_17cython_clustering_floatTYPE_t *, __pyx_pybuffernd_Rho_c.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Rho_c.diminfo[0].strides))); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 383, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_6 = PyObject_RichCompare(__pyx_t_2, __pyx_v_Rho_halo, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 359, __pyx_L1_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_2, __pyx_v_Rho_halo, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 383, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_25 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_25 < 0)) __PYX_ERR(0, 359, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__pyx_t_25) {
+      __pyx_t_28 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_28 < 0)) __PYX_ERR(0, 383, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__pyx_t_28) {
 
-        /* "dadapy/_cython/cython_clustering.pyx":360
+        /* "dadapy/_cython/cython_clustering.pyx":384
  *         for k in clstruct_m[j]:
  *             if (Rho_c[k] < Rho_halo):
  *                 nh = nh + 1             # <<<<<<<<<<<<<<
  *                 Last_cls_halo[k] = -1
  *     if (halo):
  */
-        __pyx_t_6 = __Pyx_PyInt_AddObjC(__pyx_v_nh, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 360, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_6);
-        __Pyx_DECREF_SET(__pyx_v_nh, __pyx_t_6);
-        __pyx_t_6 = 0;
+        __pyx_t_3 = __Pyx_PyInt_AddObjC(__pyx_v_nh, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF_SET(__pyx_v_nh, __pyx_t_3);
+        __pyx_t_3 = 0;
 
-        /* "dadapy/_cython/cython_clustering.pyx":361
+        /* "dadapy/_cython/cython_clustering.pyx":385
  *             if (Rho_c[k] < Rho_halo):
  *                 nh = nh + 1
  *                 Last_cls_halo[k] = -1             # <<<<<<<<<<<<<<
  *     if (halo):
  *         labels = Last_cls_halo
  */
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_Last_cls_halo, __pyx_v_k, __pyx_int_neg_1, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0) < 0)) __PYX_ERR(0, 361, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_Last_cls_halo, __pyx_v_k, __pyx_int_neg_1, __pyx_t_6dadapy_7_cython_17cython_clustering_DTYPE_t, 1, __Pyx_PyInt_From_npy_long, 0, 1, 0) < 0)) __PYX_ERR(0, 385, __pyx_L1_error)
 
-        /* "dadapy/_cython/cython_clustering.pyx":359
+        /* "dadapy/_cython/cython_clustering.pyx":383
  *         Rho_halo = max(Rho_bord_m[j])
  *         for k in clstruct_m[j]:
  *             if (Rho_c[k] < Rho_halo):             # <<<<<<<<<<<<<<
  *                 nh = nh + 1
  *                 Last_cls_halo[k] = -1
  */
       }
 
-      /* "dadapy/_cython/cython_clustering.pyx":358
+      /* "dadapy/_cython/cython_clustering.pyx":382
  *     for j in range(Nclus_m):
  *         Rho_halo = max(Rho_bord_m[j])
  *         for k in clstruct_m[j]:             # <<<<<<<<<<<<<<
  *             if (Rho_c[k] < Rho_halo):
  *                 nh = nh + 1
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":362
+  /* "dadapy/_cython/cython_clustering.pyx":386
  *                 nh = nh + 1
  *                 Last_cls_halo[k] = -1
  *     if (halo):             # <<<<<<<<<<<<<<
  *         labels = Last_cls_halo
  *     else:
  */
-  __pyx_t_25 = (__pyx_v_halo != 0);
-  if (__pyx_t_25) {
+  __pyx_t_28 = (__pyx_v_halo != 0);
+  if (__pyx_t_28) {
 
-    /* "dadapy/_cython/cython_clustering.pyx":363
+    /* "dadapy/_cython/cython_clustering.pyx":387
  *                 Last_cls_halo[k] = -1
  *     if (halo):
  *         labels = Last_cls_halo             # <<<<<<<<<<<<<<
  *     else:
  *         labels = Last_cls
  */
     __Pyx_INCREF(__pyx_v_Last_cls_halo);
     __pyx_v_labels = __pyx_v_Last_cls_halo;
 
-    /* "dadapy/_cython/cython_clustering.pyx":362
+    /* "dadapy/_cython/cython_clustering.pyx":386
  *                 nh = nh + 1
  *                 Last_cls_halo[k] = -1
  *     if (halo):             # <<<<<<<<<<<<<<
  *         labels = Last_cls_halo
  *     else:
  */
     goto __pyx_L113;
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":365
+  /* "dadapy/_cython/cython_clustering.pyx":389
  *         labels = Last_cls_halo
  *     else:
  *         labels = Last_cls             # <<<<<<<<<<<<<<
  * 
  *     out_bord = np.copy(Rho_bord_m)
  */
   /*else*/ {
     __Pyx_INCREF(__pyx_v_Last_cls);
     __pyx_v_labels = __pyx_v_Last_cls;
   }
   __pyx_L113:;
 
-  /* "dadapy/_cython/cython_clustering.pyx":367
+  /* "dadapy/_cython/cython_clustering.pyx":391
  *         labels = Last_cls
  * 
  *     out_bord = np.copy(Rho_bord_m)             # <<<<<<<<<<<<<<
- *     sec2 = time.time()
+ * 
  *     if verb:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 367, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 391, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_copy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = NULL;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_6)) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
+    if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_6);
+      __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_v_Rho_bord_m) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_Rho_bord_m);
-  __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_Rho_bord_m) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_Rho_bord_m);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_out_bord = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":368
- * 
+  /* "dadapy/_cython/cython_clustering.pyx":393
  *     out_bord = np.copy(Rho_bord_m)
- *     sec2 = time.time()             # <<<<<<<<<<<<<<
+ * 
+ *     if verb:             # <<<<<<<<<<<<<<
+ *       lag = time.time() - sec
+ *       print(f"Final operations: {lag} sec")
+ */
+  __pyx_t_28 = (__pyx_v_verb != 0);
+  if (__pyx_t_28) {
+
+    /* "dadapy/_cython/cython_clustering.pyx":394
+ * 
  *     if verb:
- *         print("{0:0.2f} seconds for final operations".format(sec2 - sec))
+ *       lag = time.time() - sec             # <<<<<<<<<<<<<<
+ *       print(f"Final operations: {lag} sec")
+ *       sec = time.time()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 368, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-      __Pyx_INCREF(__pyx_t_2);
-      __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_6, function);
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
+        __Pyx_INCREF(function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
+      }
     }
-  }
-  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __Pyx_DECREF_SET(__pyx_v_sec2, __pyx_t_1);
-  __pyx_t_1 = 0;
+    __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_sec); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_v_lag = __pyx_t_9;
 
-  /* "dadapy/_cython/cython_clustering.pyx":369
- *     out_bord = np.copy(Rho_bord_m)
- *     sec2 = time.time()
- *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds for final operations".format(sec2 - sec))
- *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_min, Rho_bord_err_m, Point_bord_m
+    /* "dadapy/_cython/cython_clustering.pyx":395
+ *     if verb:
+ *       lag = time.time() - sec
+ *       print(f"Final operations: {lag} sec")             # <<<<<<<<<<<<<<
+ *       sec = time.time()
+ * 
  */
-  __pyx_t_25 = (__pyx_v_verb != 0);
-  if (__pyx_t_25) {
+    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_21 = 0;
+    __pyx_t_22 = 127;
+    __Pyx_INCREF(__pyx_kp_u_Final_operations);
+    __pyx_t_21 += 18;
+    __Pyx_GIVEREF(__pyx_kp_u_Final_operations);
+    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_Final_operations);
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_lag); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_22 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) > __pyx_t_22) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) : __pyx_t_22;
+    __pyx_t_21 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1);
+    __Pyx_GIVEREF(__pyx_t_1);
+    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
+    __pyx_t_1 = 0;
+    __Pyx_INCREF(__pyx_kp_u_sec);
+    __pyx_t_21 += 4;
+    __Pyx_GIVEREF(__pyx_kp_u_sec);
+    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_sec);
+    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_2, 3, __pyx_t_21, __pyx_t_22); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_1);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 395, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "dadapy/_cython/cython_clustering.pyx":370
- *     sec2 = time.time()
- *     if verb:
- *         print("{0:0.2f} seconds for final operations".format(sec2 - sec))             # <<<<<<<<<<<<<<
- *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_min, Rho_bord_err_m, Point_bord_m
+    /* "dadapy/_cython/cython_clustering.pyx":396
+ *       lag = time.time() - sec
+ *       print(f"Final operations: {lag} sec")
+ *       sec = time.time()             # <<<<<<<<<<<<<<
+ * 
+ *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_bord_err_m, Point_bord_m
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_0_0_2f_seconds_for_final_operat, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 370, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = PyNumber_Subtract(__pyx_v_sec2, __pyx_v_sec); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 370, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
-        __Pyx_INCREF(__pyx_t_4);
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+    __pyx_t_2 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_2)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_6, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
-    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)
+    __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 370, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_9 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __pyx_v_sec = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_clustering.pyx":369
+    /* "dadapy/_cython/cython_clustering.pyx":393
  *     out_bord = np.copy(Rho_bord_m)
- *     sec2 = time.time()
+ * 
  *     if verb:             # <<<<<<<<<<<<<<
- *         print("{0:0.2f} seconds for final operations".format(sec2 - sec))
- *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_min, Rho_bord_err_m, Point_bord_m
+ *       lag = time.time() - sec
+ *       print(f"Final operations: {lag} sec")
  */
   }
 
-  /* "dadapy/_cython/cython_clustering.pyx":371
- *     if verb:
- *         print("{0:0.2f} seconds for final operations".format(sec2 - sec))
- *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_min, Rho_bord_err_m, Point_bord_m             # <<<<<<<<<<<<<<
+  /* "dadapy/_cython/cython_clustering.pyx":398
+ *       sec = time.time()
+ * 
+ *     return clstruct_m, Nclus_m, labels, centers_m, out_bord, Rho_bord_err_m, Point_bord_m             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_Rho_min); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = PyTuple_New(8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 371, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_6);
   __Pyx_INCREF(__pyx_v_clstruct_m);
   __Pyx_GIVEREF(__pyx_v_clstruct_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_clstruct_m);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_clstruct_m);
   __Pyx_INCREF(__pyx_v_Nclus_m);
   __Pyx_GIVEREF(__pyx_v_Nclus_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_Nclus_m);
+  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_Nclus_m);
   __Pyx_INCREF(__pyx_v_labels);
   __Pyx_GIVEREF(__pyx_v_labels);
-  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_v_labels);
+  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_labels);
   __Pyx_INCREF(__pyx_v_centers_m);
   __Pyx_GIVEREF(__pyx_v_centers_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_v_centers_m);
+  PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_v_centers_m);
   __Pyx_INCREF(__pyx_v_out_bord);
   __Pyx_GIVEREF(__pyx_v_out_bord);
-  PyTuple_SET_ITEM(__pyx_t_6, 4, __pyx_v_out_bord);
-  __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_6, 5, __pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_v_out_bord);
   __Pyx_INCREF(__pyx_v_Rho_bord_err_m);
   __Pyx_GIVEREF(__pyx_v_Rho_bord_err_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 6, __pyx_v_Rho_bord_err_m);
+  PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_v_Rho_bord_err_m);
   __Pyx_INCREF(__pyx_v_Point_bord_m);
   __Pyx_GIVEREF(__pyx_v_Point_bord_m);
-  PyTuple_SET_ITEM(__pyx_t_6, 7, __pyx_v_Point_bord_m);
+  PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_v_Point_bord_m);
+  __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
-  __pyx_r = __pyx_t_6;
-  __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":19
+  /* "dadapy/_cython/cython_clustering.pyx":20
  * @cython.cdivision(True)
  * 
  * def _compute_clustering(floatTYPE_t Z,             # <<<<<<<<<<<<<<
  *                         bint halo,
  *                         np.ndarray[DTYPE_t, ndim = 1] kstar,
  */
 
@@ -7081,15 +7586,14 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_g.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ipos.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_jpos.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_pos.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_to_remove.rcbuffer->pybuffer);
   __pyx_L2:;
-  __Pyx_XDECREF(__pyx_v_sec);
   __Pyx_XDECREF((PyObject *)__pyx_v__centers_);
   __Pyx_XDECREF((PyObject *)__pyx_v_to_remove);
   __Pyx_XDECREF((PyObject *)__pyx_v_centers);
   __Pyx_XDECREF((PyObject *)__pyx_v_cluster_init_);
   __Pyx_XDECREF(__pyx_v_sortg);
   __Pyx_XDECREF(__pyx_v_ele);
   __Pyx_XDECREF(__pyx_v_nn);
@@ -7098,15 +7602,14 @@
   __Pyx_XDECREF(__pyx_v__);
   __Pyx_XDECREF(__pyx_v_ind_removed_centers_ele);
   __Pyx_XDECREF(__pyx_v_higher_density_centers);
   __Pyx_XDECREF(__pyx_v_higher_density_centers_ele);
   __Pyx_XDECREF(__pyx_v_max_center);
   __Pyx_XDECREF(__pyx_v_clstruct);
   __Pyx_XDECREF(__pyx_v_x1);
-  __Pyx_XDECREF(__pyx_v_sec2);
   __Pyx_XDECREF((PyObject *)__pyx_v_Rho_bord);
   __Pyx_XDECREF((PyObject *)__pyx_v_Rho_bord_err);
   __Pyx_XDECREF((PyObject *)__pyx_v_Point_bord);
   __Pyx_XDECREF((PyObject *)__pyx_v_pos);
   __Pyx_XDECREF((PyObject *)__pyx_v_ipos);
   __Pyx_XDECREF((PyObject *)__pyx_v_jpos);
   __Pyx_XDECREF((PyObject *)__pyx_v_cluster_init);
@@ -7130,15 +7633,15 @@
   __Pyx_XDECREF(__pyx_v_labels);
   __Pyx_XDECREF(__pyx_v_out_bord);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -7147,29 +7650,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":736
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":736
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -7180,15 +7683,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -7197,29 +7700,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":739
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":739
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -7230,15 +7733,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -7247,29 +7750,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":742
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":742
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -7280,15 +7783,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -7297,29 +7800,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":745
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":745
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -7330,15 +7833,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -7347,29 +7850,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":748
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":748
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -7380,212 +7883,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":752
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":752
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":754
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":754
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":930
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":930
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":931
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":931
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":934
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":934
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":936
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":936
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":937
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":937
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -7601,15 +8104,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -7617,53 +8120,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":943
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":943
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 943, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":944
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
@@ -7671,30 +8174,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -7709,15 +8212,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -7733,15 +8236,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -7749,53 +8252,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":949
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":949
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 949, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":950
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":950
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
@@ -7803,30 +8306,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -7841,15 +8344,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -7865,15 +8368,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -7881,53 +8384,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":955
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":955
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 955, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":956
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":956
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":957
+      /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
@@ -7935,30 +8438,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
+    /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -7973,176 +8476,176 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":979
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":979
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":994
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":994
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1004
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1004
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1011
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1011
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
+/* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1018
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1018
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -8193,47 +8696,49 @@
     #define CYTHON_SMALL_CODE __attribute__((cold))
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
-  {&__pyx_kp_s_0_0_2f_seconds_clustering_befor, __pyx_k_0_0_2f_seconds_clustering_befor, sizeof(__pyx_k_0_0_2f_seconds_clustering_befor), 0, 0, 1, 0},
-  {&__pyx_kp_s_0_0_2f_seconds_for_final_operat, __pyx_k_0_0_2f_seconds_for_final_operat, sizeof(__pyx_k_0_0_2f_seconds_for_final_operat), 0, 0, 1, 0},
-  {&__pyx_kp_s_0_0_2f_seconds_identifying_the, __pyx_k_0_0_2f_seconds_identifying_the, sizeof(__pyx_k_0_0_2f_seconds_identifying_the), 0, 0, 1, 0},
-  {&__pyx_kp_s_0_0_2f_seconds_with_multimodali, __pyx_k_0_0_2f_seconds_with_multimodali, sizeof(__pyx_k_0_0_2f_seconds_with_multimodali), 0, 0, 1, 0},
+  {&__pyx_kp_u_3f, __pyx_k_3f, sizeof(__pyx_k_3f), 0, 1, 0, 0},
   {&__pyx_n_s_DTYPE, __pyx_k_DTYPE, sizeof(__pyx_k_DTYPE), 0, 0, 1, 1},
+  {&__pyx_kp_u_Final_operations, __pyx_k_Final_operations, sizeof(__pyx_k_Final_operations), 0, 1, 0, 0},
+  {&__pyx_kp_u_Further_checking_on_centers, __pyx_k_Further_checking_on_centers, sizeof(__pyx_k_Further_checking_on_centers), 0, 1, 0, 0},
+  {&__pyx_kp_u_Identification_of_the_saddle_poi, __pyx_k_Identification_of_the_saddle_poi, sizeof(__pyx_k_Identification_of_the_saddle_poi), 0, 1, 0, 0},
   {&__pyx_n_s_ImportError, __pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 0, 1, 1},
   {&__pyx_n_s_Last_cls, __pyx_k_Last_cls, sizeof(__pyx_k_Last_cls), 0, 0, 1, 1},
   {&__pyx_n_s_Last_cls_halo, __pyx_k_Last_cls_halo, sizeof(__pyx_k_Last_cls_halo), 0, 0, 1, 1},
+  {&__pyx_kp_u_Multimodality_test_finished, __pyx_k_Multimodality_test_finished, sizeof(__pyx_k_Multimodality_test_finished), 0, 1, 0, 0},
   {&__pyx_n_s_Nclus, __pyx_k_Nclus, sizeof(__pyx_k_Nclus), 0, 0, 1, 1},
   {&__pyx_n_s_Nclus_m, __pyx_k_Nclus_m, sizeof(__pyx_k_Nclus_m), 0, 0, 1, 1},
   {&__pyx_n_s_Nele, __pyx_k_Nele, sizeof(__pyx_k_Nele), 0, 0, 1, 1},
   {&__pyx_kp_s_Number_of_clusters_before_multim, __pyx_k_Number_of_clusters_before_multim, sizeof(__pyx_k_Number_of_clusters_before_multim), 0, 0, 1, 0},
   {&__pyx_n_s_Point_bord, __pyx_k_Point_bord, sizeof(__pyx_k_Point_bord), 0, 0, 1, 1},
   {&__pyx_n_s_Point_bord_m, __pyx_k_Point_bord_m, sizeof(__pyx_k_Point_bord_m), 0, 0, 1, 1},
+  {&__pyx_kp_u_Preliminary_assignation_finished, __pyx_k_Preliminary_assignation_finished, sizeof(__pyx_k_Preliminary_assignation_finished), 0, 1, 0, 0},
+  {&__pyx_kp_u_Pruning_of_the_centers_wrongly_i, __pyx_k_Pruning_of_the_centers_wrongly_i, sizeof(__pyx_k_Pruning_of_the_centers_wrongly_i), 0, 1, 0, 0},
+  {&__pyx_kp_u_Raw_identification_of_the_putati, __pyx_k_Raw_identification_of_the_putati, sizeof(__pyx_k_Raw_identification_of_the_putati), 0, 1, 0, 0},
   {&__pyx_n_s_Rho_bord, __pyx_k_Rho_bord, sizeof(__pyx_k_Rho_bord), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_bord_err, __pyx_k_Rho_bord_err, sizeof(__pyx_k_Rho_bord_err), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_bord_err_m, __pyx_k_Rho_bord_err_m, sizeof(__pyx_k_Rho_bord_err_m), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_bord_m, __pyx_k_Rho_bord_m, sizeof(__pyx_k_Rho_bord_m), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_c, __pyx_k_Rho_c, sizeof(__pyx_k_Rho_c), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_err, __pyx_k_Rho_err, sizeof(__pyx_k_Rho_err), 0, 0, 1, 1},
   {&__pyx_n_s_Rho_halo, __pyx_k_Rho_halo, sizeof(__pyx_k_Rho_halo), 0, 0, 1, 1},
-  {&__pyx_n_s_Rho_min, __pyx_k_Rho_min, sizeof(__pyx_k_Rho_min), 0, 0, 1, 1},
+  {&__pyx_kp_s_There_are_10k_initial_putative_c, __pyx_k_There_are_10k_initial_putative_c, sizeof(__pyx_k_There_are_10k_initial_putative_c), 0, 0, 1, 0},
   {&__pyx_n_s_Z, __pyx_k_Z, sizeof(__pyx_k_Z), 0, 0, 1, 1},
   {&__pyx_n_s__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 0, 1, 1},
   {&__pyx_n_s_a1, __pyx_k_a1, sizeof(__pyx_k_a1), 0, 0, 1, 1},
   {&__pyx_n_s_a2, __pyx_k_a2, sizeof(__pyx_k_a2), 0, 0, 1, 1},
   {&__pyx_n_s_all_removed_centers, __pyx_k_all_removed_centers, sizeof(__pyx_k_all_removed_centers), 0, 0, 1, 1},
   {&__pyx_n_s_argmax, __pyx_k_argmax, sizeof(__pyx_k_argmax), 0, 0, 1, 1},
   {&__pyx_n_s_argsort, __pyx_k_argsort, sizeof(__pyx_k_argsort), 0, 0, 1, 1},
   {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
   {&__pyx_n_s_barriers, __pyx_k_barriers, sizeof(__pyx_k_barriers), 0, 0, 1, 1},
-  {&__pyx_n_s_bool, __pyx_k_bool, sizeof(__pyx_k_bool), 0, 0, 1, 1},
-  {&__pyx_n_s_boolTYPE, __pyx_k_boolTYPE, sizeof(__pyx_k_boolTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_s_c1, __pyx_k_c1, sizeof(__pyx_k_c1), 0, 0, 1, 1},
   {&__pyx_n_s_c2, __pyx_k_c2, sizeof(__pyx_k_c2), 0, 0, 1, 1},
   {&__pyx_n_s_centers, __pyx_k_centers, sizeof(__pyx_k_centers), 0, 0, 1, 1},
   {&__pyx_n_s_centers_2, __pyx_k_centers_2, sizeof(__pyx_k_centers_2), 0, 0, 1, 1},
   {&__pyx_n_s_centers_3, __pyx_k_centers_3, sizeof(__pyx_k_centers_3), 0, 0, 1, 1},
   {&__pyx_n_s_centers_m, __pyx_k_centers_m, sizeof(__pyx_k_centers_m), 0, 0, 1, 1},
@@ -8257,38 +8762,38 @@
   {&__pyx_n_s_ele, __pyx_k_ele, sizeof(__pyx_k_ele), 0, 0, 1, 1},
   {&__pyx_n_s_ele_neighbors, __pyx_k_ele_neighbors, sizeof(__pyx_k_ele_neighbors), 0, 0, 1, 1},
   {&__pyx_n_s_empty, __pyx_k_empty, sizeof(__pyx_k_empty), 0, 0, 1, 1},
   {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
   {&__pyx_n_s_extend, __pyx_k_extend, sizeof(__pyx_k_extend), 0, 0, 1, 1},
   {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
   {&__pyx_n_s_flag, __pyx_k_flag, sizeof(__pyx_k_flag), 0, 0, 1, 1},
-  {&__pyx_n_s_float, __pyx_k_float, sizeof(__pyx_k_float), 0, 0, 1, 1},
+  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_floatTYPE, __pyx_k_floatTYPE, sizeof(__pyx_k_floatTYPE), 0, 0, 1, 1},
-  {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_g, __pyx_k_g, sizeof(__pyx_k_g), 0, 0, 1, 1},
   {&__pyx_n_s_halo, __pyx_k_halo, sizeof(__pyx_k_halo), 0, 0, 1, 1},
   {&__pyx_n_s_higher_density_centers, __pyx_k_higher_density_centers, sizeof(__pyx_k_higher_density_centers), 0, 0, 1, 1},
   {&__pyx_n_s_higher_density_centers_ele, __pyx_k_higher_density_centers_ele, sizeof(__pyx_k_higher_density_centers_ele), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_imod, __pyx_k_imod, sizeof(__pyx_k_imod), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_ind_removed_centers_ele, __pyx_k_ind_removed_centers_ele, sizeof(__pyx_k_ind_removed_centers_ele), 0, 0, 1, 1},
   {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
   {&__pyx_kp_s_init_succeded, __pyx_k_init_succeded, sizeof(__pyx_k_init_succeded), 0, 0, 1, 0},
-  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
+  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
   {&__pyx_n_s_intersect1d, __pyx_k_intersect1d, sizeof(__pyx_k_intersect1d), 0, 0, 1, 1},
   {&__pyx_n_s_ipos, __pyx_k_ipos, sizeof(__pyx_k_ipos), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_jj, __pyx_k_jj, sizeof(__pyx_k_jj), 0, 0, 1, 1},
   {&__pyx_n_s_jmod, __pyx_k_jmod, sizeof(__pyx_k_jmod), 0, 0, 1, 1},
   {&__pyx_n_s_jpos, __pyx_k_jpos, sizeof(__pyx_k_jpos), 0, 0, 1, 1},
   {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
   {&__pyx_n_s_kk, __pyx_k_kk, sizeof(__pyx_k_kk), 0, 0, 1, 1},
   {&__pyx_n_s_kstar, __pyx_k_kstar, sizeof(__pyx_k_kstar), 0, 0, 1, 1},
   {&__pyx_n_s_labels, __pyx_k_labels, sizeof(__pyx_k_labels), 0, 0, 1, 1},
+  {&__pyx_n_s_lag, __pyx_k_lag, sizeof(__pyx_k_lag), 0, 0, 1, 1},
   {&__pyx_n_s_len_centers, __pyx_k_len_centers, sizeof(__pyx_k_len_centers), 0, 0, 1, 1},
   {&__pyx_n_s_len_to_remove, __pyx_k_len_to_remove, sizeof(__pyx_k_len_to_remove), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_max, __pyx_k_max, sizeof(__pyx_k_max), 0, 0, 1, 1},
   {&__pyx_n_s_max_center, __pyx_k_max_center, sizeof(__pyx_k_max_center), 0, 0, 1, 1},
   {&__pyx_n_s_max_rho, __pyx_k_max_rho, sizeof(__pyx_k_max_rho), 0, 0, 1, 1},
   {&__pyx_n_s_maxk, __pyx_k_maxk, sizeof(__pyx_k_maxk), 0, 0, 1, 1},
@@ -8302,109 +8807,84 @@
   {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
   {&__pyx_kp_s_numpy_core_multiarray_failed_to, __pyx_k_numpy_core_multiarray_failed_to, sizeof(__pyx_k_numpy_core_multiarray_failed_to), 0, 0, 1, 0},
   {&__pyx_kp_s_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 0, 1, 0},
   {&__pyx_n_s_ones, __pyx_k_ones, sizeof(__pyx_k_ones), 0, 0, 1, 1},
   {&__pyx_n_s_out_bord, __pyx_k_out_bord, sizeof(__pyx_k_out_bord), 0, 0, 1, 1},
   {&__pyx_n_s_p1, __pyx_k_p1, sizeof(__pyx_k_p1), 0, 0, 1, 1},
   {&__pyx_n_s_p2, __pyx_k_p2, sizeof(__pyx_k_p2), 0, 0, 1, 1},
-  {&__pyx_kp_s_part_one_finished_Raw_identifica, __pyx_k_part_one_finished_Raw_identifica, sizeof(__pyx_k_part_one_finished_Raw_identifica), 0, 0, 1, 0},
-  {&__pyx_kp_s_part_tree_finished_Pruning_of_th, __pyx_k_part_tree_finished_Pruning_of_th, sizeof(__pyx_k_part_tree_finished_Pruning_of_th), 0, 0, 1, 0},
-  {&__pyx_kp_s_part_two_finished_Further_checki, __pyx_k_part_two_finished_Further_checki, sizeof(__pyx_k_part_two_finished_Further_checki), 0, 0, 1, 0},
   {&__pyx_n_s_po, __pyx_k_po, sizeof(__pyx_k_po), 0, 0, 1, 1},
   {&__pyx_n_s_pos, __pyx_k_pos, sizeof(__pyx_k_pos), 0, 0, 1, 1},
   {&__pyx_n_s_pp, __pyx_k_pp, sizeof(__pyx_k_pp), 0, 0, 1, 1},
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_repeat, __pyx_k_repeat, sizeof(__pyx_k_repeat), 0, 0, 1, 1},
   {&__pyx_n_s_return_indices, __pyx_k_return_indices, sizeof(__pyx_k_return_indices), 0, 0, 1, 1},
-  {&__pyx_n_s_sec, __pyx_k_sec, sizeof(__pyx_k_sec), 0, 0, 1, 1},
-  {&__pyx_n_s_sec2, __pyx_k_sec2, sizeof(__pyx_k_sec2), 0, 0, 1, 1},
+  {&__pyx_kp_u_sec, __pyx_k_sec, sizeof(__pyx_k_sec), 0, 1, 0, 0},
+  {&__pyx_kp_u_sec_2, __pyx_k_sec_2, sizeof(__pyx_k_sec_2), 0, 1, 0, 0},
+  {&__pyx_n_s_sec_3, __pyx_k_sec_3, sizeof(__pyx_k_sec_3), 0, 0, 1, 1},
   {&__pyx_n_s_secp, __pyx_k_secp, sizeof(__pyx_k_secp), 0, 0, 1, 1},
   {&__pyx_n_s_sortg, __pyx_k_sortg, sizeof(__pyx_k_sortg), 0, 0, 1, 1},
   {&__pyx_n_s_t, __pyx_k_t, sizeof(__pyx_k_t), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_time, __pyx_k_time, sizeof(__pyx_k_time), 0, 0, 1, 1},
   {&__pyx_n_s_tmp, __pyx_k_tmp, sizeof(__pyx_k_tmp), 0, 0, 1, 1},
   {&__pyx_n_s_to_remove, __pyx_k_to_remove, sizeof(__pyx_k_to_remove), 0, 0, 1, 1},
   {&__pyx_n_s_verb, __pyx_k_verb, sizeof(__pyx_k_verb), 0, 0, 1, 1},
+  {&__pyx_n_s_warn, __pyx_k_warn, sizeof(__pyx_k_warn), 0, 0, 1, 1},
+  {&__pyx_n_s_warnings, __pyx_k_warnings, sizeof(__pyx_k_warnings), 0, 0, 1, 1},
   {&__pyx_n_s_x1, __pyx_k_x1, sizeof(__pyx_k_x1), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 51, __pyx_L1_error)
-  __pyx_builtin_max = __Pyx_GetBuiltinName(__pyx_n_s_max); if (!__pyx_builtin_max) __PYX_ERR(0, 357, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_builtin_max = __Pyx_GetBuiltinName(__pyx_n_s_max); if (!__pyx_builtin_max) __PYX_ERR(0, 381, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "dadapy/_cython/cython_clustering.pyx":130
- *         if cluster_init_[ele]==-1:
- *             ele_neighbors = dist_indices[ele]
- *             all_removed_centers = to_remove[:, 0]             # <<<<<<<<<<<<<<
- * 
- *             _, _, ind_removed_centers_ele = np.intersect1d(
- */
-  __pyx_slice_ = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 130, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice_);
-  __Pyx_GIVEREF(__pyx_slice_);
-  __pyx_tuple__2 = PyTuple_Pack(2, __pyx_slice_, __pyx_int_0); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 130, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__2);
-  __Pyx_GIVEREF(__pyx_tuple__2);
-
-  /* "dadapy/_cython/cython_clustering.pyx":144
- *             # (higher_density_centers --> centers of higher density that have a
- *             # 'removed center' in their neighborhood)
- *             higher_density_centers = to_remove[:, 1]             # <<<<<<<<<<<<<<
- *             higher_density_centers_ele = higher_density_centers[
- *                 ind_removed_centers_ele
- */
-  __pyx_tuple__3 = PyTuple_Pack(2, __pyx_slice_, __pyx_int_1); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 144, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
-
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(1, 945, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__4);
   __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(1, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__5);
   __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "dadapy/_cython/cython_clustering.pyx":19
+  /* "dadapy/_cython/cython_clustering.pyx":20
  * @cython.cdivision(True)
  * 
  * def _compute_clustering(floatTYPE_t Z,             # <<<<<<<<<<<<<<
  *                         bint halo,
  *                         np.ndarray[DTYPE_t, ndim = 1] kstar,
  */
-  __pyx_tuple__7 = PyTuple_Pack(84, __pyx_n_s_Z, __pyx_n_s_halo, __pyx_n_s_kstar, __pyx_n_s_dist_indices, __pyx_n_s_maxk, __pyx_n_s_verb, __pyx_n_s_Rho_err, __pyx_n_s_Rho_min, __pyx_n_s_Rho_c, __pyx_n_s_g, __pyx_n_s_Nele, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_t, __pyx_n_s_Nclus, __pyx_n_s_check, __pyx_n_s_index, __pyx_n_s_maxposidx, __pyx_n_s_a1, __pyx_n_s_a2, __pyx_n_s_e1, __pyx_n_s_e2, __pyx_n_s_maxpos, __pyx_n_s_tmp, __pyx_n_s_jmod, __pyx_n_s_imod, __pyx_n_s_c, __pyx_n_s_cp, __pyx_n_s_k, __pyx_n_s_po, __pyx_n_s_p2, __pyx_n_s_pp, __pyx_n_s_p1, __pyx_n_s_sec, __pyx_n_s_centers, __pyx_n_s_len_centers, __pyx_n_s_to_remove, __pyx_n_s_len_to_remove, __pyx_n_s_max_rho, __pyx_n_s_centers_2, __pyx_n_s_cindx, __pyx_n_s_flag, __pyx_n_s_cluster_init, __pyx_n_s_sortg, __pyx_n_s_ele, __pyx_n_s_nn, __pyx_n_s_ele_neighbors, __pyx_n_s_all_removed_centers, __pyx_n_s__6, __pyx_n_s_ind_removed_centers_ele, __pyx_n_s_higher_density_centers, __pyx_n_s_higher_density_centers_ele, __pyx_n_s_max_center, __pyx_n_s_clstruct, __pyx_n_s_x1, __pyx_n_s_sec2, __pyx_n_s_Rho_bord, __pyx_n_s_Rho_bord_err, __pyx_n_s_Point_bord, __pyx_n_s_pos, __pyx_n_s_ipos, __pyx_n_s_jpos, __pyx_n_s_cluster_init_2, __pyx_n_s_centers_3, __pyx_n_s_clsurv, __pyx_n_s_secp, __pyx_n_s_barriers, __pyx_n_s_c1, __pyx_n_s_c2, __pyx_n_s_Nclus_m, __pyx_n_s_clstruct_m, __pyx_n_s_centers_m, __pyx_n_s_nnum, __pyx_n_s_Point_bord_m, __pyx_n_s_Rho_bord_err_m, __pyx_n_s_Rho_bord_m, __pyx_n_s_jj, __pyx_n_s_kk, __pyx_n_s_Last_cls, __pyx_n_s_Last_cls_halo, __pyx_n_s_nh, __pyx_n_s_Rho_halo, __pyx_n_s_labels, __pyx_n_s_out_bord); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 19, __pyx_L1_error)
+  __pyx_tuple__7 = PyTuple_Pack(83, __pyx_n_s_Z, __pyx_n_s_halo, __pyx_n_s_kstar, __pyx_n_s_dist_indices, __pyx_n_s_maxk, __pyx_n_s_verb, __pyx_n_s_Rho_err, __pyx_n_s_Rho_c, __pyx_n_s_g, __pyx_n_s_Nele, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_t, __pyx_n_s_Nclus, __pyx_n_s_check, __pyx_n_s_index, __pyx_n_s_maxposidx, __pyx_n_s_a1, __pyx_n_s_a2, __pyx_n_s_e1, __pyx_n_s_e2, __pyx_n_s_maxpos, __pyx_n_s_lag, __pyx_n_s_sec_3, __pyx_n_s_tmp, __pyx_n_s_jmod, __pyx_n_s_imod, __pyx_n_s_c, __pyx_n_s_cp, __pyx_n_s_k, __pyx_n_s_po, __pyx_n_s_p2, __pyx_n_s_pp, __pyx_n_s_p1, __pyx_n_s_centers, __pyx_n_s_len_centers, __pyx_n_s_to_remove, __pyx_n_s_len_to_remove, __pyx_n_s_max_rho, __pyx_n_s_centers_2, __pyx_n_s_cindx, __pyx_n_s_flag, __pyx_n_s_cluster_init, __pyx_n_s_sortg, __pyx_n_s_ele, __pyx_n_s_nn, __pyx_n_s_ele_neighbors, __pyx_n_s_all_removed_centers, __pyx_n_s__6, __pyx_n_s_ind_removed_centers_ele, __pyx_n_s_higher_density_centers, __pyx_n_s_higher_density_centers_ele, __pyx_n_s_max_center, __pyx_n_s_clstruct, __pyx_n_s_x1, __pyx_n_s_Rho_bord, __pyx_n_s_Rho_bord_err, __pyx_n_s_Point_bord, __pyx_n_s_pos, __pyx_n_s_ipos, __pyx_n_s_jpos, __pyx_n_s_cluster_init_2, __pyx_n_s_centers_3, __pyx_n_s_clsurv, __pyx_n_s_secp, __pyx_n_s_barriers, __pyx_n_s_c1, __pyx_n_s_c2, __pyx_n_s_Nclus_m, __pyx_n_s_clstruct_m, __pyx_n_s_centers_m, __pyx_n_s_nnum, __pyx_n_s_Point_bord_m, __pyx_n_s_Rho_bord_err_m, __pyx_n_s_Rho_bord_m, __pyx_n_s_jj, __pyx_n_s_kk, __pyx_n_s_Last_cls, __pyx_n_s_Last_cls_halo, __pyx_n_s_nh, __pyx_n_s_Rho_halo, __pyx_n_s_labels, __pyx_n_s_out_bord); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__7);
   __Pyx_GIVEREF(__pyx_tuple__7);
-  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(11, 0, 84, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_clustering_pyx, __pyx_n_s_compute_clustering, 19, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 19, __pyx_L1_error)
+  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(10, 0, 83, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_clustering_pyx, __pyx_n_s_compute_clustering, 20, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -8733,102 +9213,98 @@
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
   /* "dadapy/_cython/cython_clustering.pyx":1
  * import time             # <<<<<<<<<<<<<<
+ * import warnings
  * 
- * import cython
  */
   __pyx_t_1 = __Pyx_Import(__pyx_n_s_time, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_time, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":4
+  /* "dadapy/_cython/cython_clustering.pyx":2
+ * import time
+ * import warnings             # <<<<<<<<<<<<<<
+ * 
+ * import cython
+ */
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_warnings, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_warnings, __pyx_t_1) < 0) __PYX_ERR(0, 2, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+
+  /* "dadapy/_cython/cython_clustering.pyx":5
  * 
  * import cython
  * import numpy as np             # <<<<<<<<<<<<<<
  * 
  * cimport numpy as np
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":9
+  /* "dadapy/_cython/cython_clustering.pyx":10
  * from libc.math cimport exp
  * 
- * DTYPE = np.int             # <<<<<<<<<<<<<<
- * floatTYPE = np.float
- * boolTYPE = np.bool
+ * DTYPE = np.int64             # <<<<<<<<<<<<<<
+ * floatTYPE = np.float64
+ * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":10
+  /* "dadapy/_cython/cython_clustering.pyx":11
+ * 
+ * DTYPE = np.int64
+ * floatTYPE = np.float64             # <<<<<<<<<<<<<<
  * 
- * DTYPE = np.int
- * floatTYPE = np.float             # <<<<<<<<<<<<<<
- * boolTYPE = np.bool
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-  /* "dadapy/_cython/cython_clustering.pyx":11
- * DTYPE = np.int
- * floatTYPE = np.float
- * boolTYPE = np.bool             # <<<<<<<<<<<<<<
- * 
- * ctypedef np.int_t DTYPE_t
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bool); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_boolTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/_cython/cython_clustering.pyx":19
+  /* "dadapy/_cython/cython_clustering.pyx":20
  * @cython.cdivision(True)
  * 
  * def _compute_clustering(floatTYPE_t Z,             # <<<<<<<<<<<<<<
  *                         bint halo,
  *                         np.ndarray[DTYPE_t, ndim = 1] kstar,
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_17cython_clustering_1_compute_clustering, NULL, __pyx_n_s_dadapy__cython_cython_clustering); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_clustering, __pyx_t_2) < 0) __PYX_ERR(0, 19, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_17cython_clustering_1_compute_clustering, NULL, __pyx_n_s_dadapy__cython_cython_clustering); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_clustering, __pyx_t_1) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "dadapy/_cython/cython_clustering.pyx":1
  * import time             # <<<<<<<<<<<<<<
+ * import warnings
  * 
- * import cython
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../miniconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -9802,14 +10278,37 @@
 done:
     Py_LeaveRecursiveCall();
     return result;
 }
 #endif
 #endif
 
+/* PyCFunctionFastCall */
+  #if CYTHON_FAST_PYCCALL
+static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
+    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
+    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
+    PyObject *self = PyCFunction_GET_SELF(func);
+    int flags = PyCFunction_GET_FLAGS(func);
+    assert(PyCFunction_Check(func));
+    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
+    assert(nargs >= 0);
+    assert(nargs == 0 || args != NULL);
+    /* _PyCFunction_FastCallDict() must not be called with an exception set,
+       because it may clear it (directly or indirectly) and so the
+       caller loses its exception */
+    assert(!PyErr_Occurred());
+    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
+        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
+    } else {
+        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
+    }
+}
+#endif
+
 /* PyObjectCall */
   #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
     PyObject *result;
     ternaryfunc call = Py_TYPE(func)->tp_call;
     if (unlikely(!call))
         return PyObject_Call(func, arg, kw);
@@ -9822,14 +10321,27 @@
             PyExc_SystemError,
             "NULL result without error in PyObject_Call");
     }
     return result;
 }
 #endif
 
+/* ExtTypeTest */
+  static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
+    if (unlikely(!type)) {
+        PyErr_SetString(PyExc_SystemError, "Missing type object");
+        return 0;
+    }
+    if (likely(__Pyx_TypeCheck(obj, type)))
+        return 1;
+    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
+                 Py_TYPE(obj)->tp_name, type->tp_name);
+    return 0;
+}
+
 /* PyObjectCallMethO */
   #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
     PyObject *self, *result;
     PyCFunction cfunc;
     cfunc = PyCFunction_GET_FUNCTION(func);
     self = PyCFunction_GET_SELF(func);
@@ -9864,37 +10376,14 @@
             return __Pyx_PyObject_CallMethO(func, NULL);
         }
     }
     return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
 }
 #endif
 
-/* PyCFunctionFastCall */
-  #if CYTHON_FAST_PYCCALL
-static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
-    PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
-    PyCFunction meth = PyCFunction_GET_FUNCTION(func);
-    PyObject *self = PyCFunction_GET_SELF(func);
-    int flags = PyCFunction_GET_FLAGS(func);
-    assert(PyCFunction_Check(func));
-    assert(METH_FASTCALL == (flags & ~(METH_CLASS | METH_STATIC | METH_COEXIST | METH_KEYWORDS | METH_STACKLESS)));
-    assert(nargs >= 0);
-    assert(nargs == 0 || args != NULL);
-    /* _PyCFunction_FastCallDict() must not be called with an exception set,
-       because it may clear it (directly or indirectly) and so the
-       caller loses its exception */
-    assert(!PyErr_Occurred());
-    if ((PY_VERSION_HEX < 0x030700A0) || unlikely(flags & METH_KEYWORDS)) {
-        return (*((__Pyx_PyCFunctionFastWithKeywords)(void*)meth)) (self, args, nargs, NULL);
-    } else {
-        return (*((__Pyx_PyCFunctionFast)(void*)meth)) (self, args, nargs);
-    }
-}
-#endif
-
 /* PyObjectCallOneArg */
   #if CYTHON_COMPILING_IN_CPYTHON
 static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
     PyObject *result;
     PyObject *args = PyTuple_New(1);
     if (unlikely(!args)) return NULL;
     Py_INCREF(arg);
@@ -9927,25 +10416,110 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
-/* ExtTypeTest */
-  static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
-    if (unlikely(!type)) {
-        PyErr_SetString(PyExc_SystemError, "Missing type object");
-        return 0;
+/* PyObjectFormat */
+  #if CYTHON_USE_UNICODE_WRITER
+static PyObject* __Pyx_PyObject_Format(PyObject* obj, PyObject* format_spec) {
+    int ret;
+    _PyUnicodeWriter writer;
+    if (likely(PyFloat_CheckExact(obj))) {
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x03040000
+        _PyUnicodeWriter_Init(&writer, 0);
+#else
+        _PyUnicodeWriter_Init(&writer);
+#endif
+        ret = _PyFloat_FormatAdvancedWriter(
+            &writer,
+            obj,
+            format_spec, 0, PyUnicode_GET_LENGTH(format_spec));
+    } else if (likely(PyLong_CheckExact(obj))) {
+#if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX < 0x03040000
+        _PyUnicodeWriter_Init(&writer, 0);
+#else
+        _PyUnicodeWriter_Init(&writer);
+#endif
+        ret = _PyLong_FormatAdvancedWriter(
+            &writer,
+            obj,
+            format_spec, 0, PyUnicode_GET_LENGTH(format_spec));
+    } else {
+        return PyObject_Format(obj, format_spec);
     }
-    if (likely(__Pyx_TypeCheck(obj, type)))
-        return 1;
-    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
-                 Py_TYPE(obj)->tp_name, type->tp_name);
-    return 0;
+    if (unlikely(ret == -1)) {
+        _PyUnicodeWriter_Dealloc(&writer);
+        return NULL;
+    }
+    return _PyUnicodeWriter_Finish(&writer);
+}
+#endif
+
+/* JoinPyUnicode */
+  static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
+                                      CYTHON_UNUSED Py_UCS4 max_char) {
+#if CYTHON_USE_UNICODE_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    PyObject *result_uval;
+    int result_ukind;
+    Py_ssize_t i, char_pos;
+    void *result_udata;
+#if CYTHON_PEP393_ENABLED
+    result_uval = PyUnicode_New(result_ulength, max_char);
+    if (unlikely(!result_uval)) return NULL;
+    result_ukind = (max_char <= 255) ? PyUnicode_1BYTE_KIND : (max_char <= 65535) ? PyUnicode_2BYTE_KIND : PyUnicode_4BYTE_KIND;
+    result_udata = PyUnicode_DATA(result_uval);
+#else
+    result_uval = PyUnicode_FromUnicode(NULL, result_ulength);
+    if (unlikely(!result_uval)) return NULL;
+    result_ukind = sizeof(Py_UNICODE);
+    result_udata = PyUnicode_AS_UNICODE(result_uval);
+#endif
+    char_pos = 0;
+    for (i=0; i < value_count; i++) {
+        int ukind;
+        Py_ssize_t ulength;
+        void *udata;
+        PyObject *uval = PyTuple_GET_ITEM(value_tuple, i);
+        if (unlikely(__Pyx_PyUnicode_READY(uval)))
+            goto bad;
+        ulength = __Pyx_PyUnicode_GET_LENGTH(uval);
+        if (unlikely(!ulength))
+            continue;
+        if (unlikely(char_pos + ulength < 0))
+            goto overflow;
+        ukind = __Pyx_PyUnicode_KIND(uval);
+        udata = __Pyx_PyUnicode_DATA(uval);
+        if (!CYTHON_PEP393_ENABLED || ukind == result_ukind) {
+            memcpy((char *)result_udata + char_pos * result_ukind, udata, (size_t) (ulength * result_ukind));
+        } else {
+            #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030300F0 || defined(_PyUnicode_FastCopyCharacters)
+            _PyUnicode_FastCopyCharacters(result_uval, char_pos, uval, 0, ulength);
+            #else
+            Py_ssize_t j;
+            for (j=0; j < ulength; j++) {
+                Py_UCS4 uchar = __Pyx_PyUnicode_READ(ukind, udata, j);
+                __Pyx_PyUnicode_WRITE(result_ukind, result_udata, char_pos+j, uchar);
+            }
+            #endif
+        }
+        char_pos += ulength;
+    }
+    return result_uval;
+overflow:
+    PyErr_SetString(PyExc_OverflowError, "join() result is too long for a Python string");
+bad:
+    Py_DECREF(result_uval);
+    return NULL;
+#else
+    result_ulength++;
+    value_count++;
+    return PyUnicode_Join(__pyx_empty_unicode, value_tuple);
+#endif
 }
 
 /* PyObjectCall2Args */
   static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
     PyObject *args, *result = NULL;
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(function)) {
```

### Comparing `dadapy-0.1.1/dadapy/_cython/cython_density.c` & `dadapy-0.2.0/dadapy/_cython/cython_density.c`

 * *Files 4% similar despite different names*

```diff
@@ -1,18 +1,20 @@
-/* Generated by Cython 0.29.21 */
+/* Generated by Cython 0.29.30 */
 
+#ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
+#endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_21"
-#define CYTHON_HEX_VERSION 0x001D15F0
+#define CYTHON_ABI "0_29_30"
+#define CYTHON_HEX_VERSION 0x001D1EF0
 #define CYTHON_FUTURE_DIVISION 0
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -79,14 +81,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC (PYPY_VERSION_HEX >= 0x07030900)
+  #endif
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -120,14 +125,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -151,53 +159,64 @@
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
-  #if PY_VERSION_HEX < 0x030300F0
+  #if PY_VERSION_HEX < 0x030300F0 || PY_VERSION_HEX >= 0x030B00A2
     #undef CYTHON_USE_UNICODE_WRITER
     #define CYTHON_USE_UNICODE_WRITER 0
   #elif !defined(CYTHON_USE_UNICODE_WRITER)
     #define CYTHON_USE_UNICODE_WRITER 1
   #endif
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
-  #ifndef CYTHON_FAST_THREAD_STATE
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_FAST_THREAD_STATE
+    #define CYTHON_FAST_THREAD_STATE 0
+  #elif !defined(CYTHON_FAST_THREAD_STATE)
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
-    #define CYTHON_FAST_PYCALL 1
+    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
     #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
   #endif
-  #ifndef CYTHON_USE_EXC_INFO_STACK
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_USE_EXC_INFO_STACK
+    #define CYTHON_USE_EXC_INFO_STACK 0
+  #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
-  #include "longintrepr.h"
+  #if PY_MAJOR_VERSION < 3
+    #include "longintrepr.h"
+  #endif
   #undef SHIFT
   #undef BASE
   #undef MASK
   #ifdef SIZEOF_VOID_P
     enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void*)) };
   #endif
 #endif
@@ -306,17 +325,76 @@
 #if PY_MAJOR_VERSION < 3
   #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
   #define __Pyx_DefaultClassType PyClass_Type
 #else
   #define __Pyx_BUILTIN_MODULE_NAME "builtins"
-#if PY_VERSION_HEX >= 0x030800A4 && PY_VERSION_HEX < 0x030800B2
-  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
-          PyCode_New(a, 0, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
+  #define __Pyx_DefaultClassType PyType_Type
+#if PY_VERSION_HEX >= 0x030B00A1
+    static CYTHON_INLINE PyCodeObject* __Pyx_PyCode_New(int a, int k, int l, int s, int f,
+                                                    PyObject *code, PyObject *c, PyObject* n, PyObject *v,
+                                                    PyObject *fv, PyObject *cell, PyObject* fn,
+                                                    PyObject *name, int fline, PyObject *lnos) {
+        PyObject *kwds=NULL, *argcount=NULL, *posonlyargcount=NULL, *kwonlyargcount=NULL;
+        PyObject *nlocals=NULL, *stacksize=NULL, *flags=NULL, *replace=NULL, *call_result=NULL, *empty=NULL;
+        const char *fn_cstr=NULL;
+        const char *name_cstr=NULL;
+        PyCodeObject* co=NULL;
+        PyObject *type, *value, *traceback;
+        PyErr_Fetch(&type, &value, &traceback);
+        if (!(kwds=PyDict_New())) goto end;
+        if (!(argcount=PyLong_FromLong(a))) goto end;
+        if (PyDict_SetItemString(kwds, "co_argcount", argcount) != 0) goto end;
+        if (!(posonlyargcount=PyLong_FromLong(0))) goto end;
+        if (PyDict_SetItemString(kwds, "co_posonlyargcount", posonlyargcount) != 0) goto end;
+        if (!(kwonlyargcount=PyLong_FromLong(k))) goto end;
+        if (PyDict_SetItemString(kwds, "co_kwonlyargcount", kwonlyargcount) != 0) goto end;
+        if (!(nlocals=PyLong_FromLong(l))) goto end;
+        if (PyDict_SetItemString(kwds, "co_nlocals", nlocals) != 0) goto end;
+        if (!(stacksize=PyLong_FromLong(s))) goto end;
+        if (PyDict_SetItemString(kwds, "co_stacksize", stacksize) != 0) goto end;
+        if (!(flags=PyLong_FromLong(f))) goto end;
+        if (PyDict_SetItemString(kwds, "co_flags", flags) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_code", code) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_consts", c) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_names", n) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_varnames", v) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_freevars", fv) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_cellvars", cell) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_linetable", lnos) != 0) goto end;
+        if (!(fn_cstr=PyUnicode_AsUTF8AndSize(fn, NULL))) goto end;
+        if (!(name_cstr=PyUnicode_AsUTF8AndSize(name, NULL))) goto end;
+        if (!(co = PyCode_NewEmpty(fn_cstr, name_cstr, fline))) goto end;
+        if (!(replace = PyObject_GetAttrString((PyObject*)co, "replace"))) goto cleanup_code_too;
+        if (!(empty = PyTuple_New(0))) goto cleanup_code_too; // unfortunately __pyx_empty_tuple isn't available here
+        if (!(call_result = PyObject_Call(replace, empty, kwds))) goto cleanup_code_too;
+        Py_XDECREF((PyObject*)co);
+        co = (PyCodeObject*)call_result;
+        call_result = NULL;
+        if (0) {
+            cleanup_code_too:
+            Py_XDECREF((PyObject*)co);
+            co = NULL;
+        }
+        end:
+        Py_XDECREF(kwds);
+        Py_XDECREF(argcount);
+        Py_XDECREF(posonlyargcount);
+        Py_XDECREF(kwonlyargcount);
+        Py_XDECREF(nlocals);
+        Py_XDECREF(stacksize);
+        Py_XDECREF(replace);
+        Py_XDECREF(call_result);
+        Py_XDECREF(empty);
+        if (type) {
+            PyErr_Restore(type, value, traceback);
+        }
+        return co;
+    }
 #else
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
 #endif
   #define __Pyx_DefaultClassType PyType_Type
 #endif
 #ifndef Py_TPFLAGS_CHECKTYPES
@@ -422,25 +500,33 @@
 #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030500A1 && CYTHON_USE_UNICODE_INTERNALS
 #define __Pyx_PyDict_GetItemStr(dict, name)  _PyDict_GetItem_KnownHash(dict, name, ((PyASCIIObject *) name)->hash)
 #else
 #define __Pyx_PyDict_GetItemStr(dict, name)  PyDict_GetItem(dict, name)
 #endif
 #if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
   #define CYTHON_PEP393_ENABLED 1
+  #if defined(PyUnicode_IS_READY)
   #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                               0 : _PyUnicode_Ready((PyObject *)(op)))
+  #else
+  #define __Pyx_PyUnicode_READY(op)       (0)
+  #endif
   #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
   #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
   #define __Pyx_PyUnicode_MAX_CHAR_VALUE(u)   PyUnicode_MAX_CHAR_VALUE(u)
   #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
   #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
   #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
   #define __Pyx_PyUnicode_WRITE(k, d, i, ch)  PyUnicode_WRITE(k, d, i, ch)
   #if defined(PyUnicode_IS_READY) && defined(PyUnicode_GET_SIZE)
+  #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x03090000
+  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : ((PyCompactUnicodeObject *)(u))->wstr_length))
+  #else
   #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
+  #endif
   #else
   #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_LENGTH(u))
   #endif
 #else
   #define CYTHON_PEP393_ENABLED 0
   #define PyUnicode_1BYTE_KIND  1
   #define PyUnicode_2BYTE_KIND  2
@@ -538,18 +624,18 @@
   #ifndef PyUnicode_InternFromString
     #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
   #endif
 #endif
 #if PY_VERSION_HEX < 0x030200A4
   typedef long Py_hash_t;
   #define __Pyx_PyInt_FromHash_t PyInt_FromLong
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsHash_t
 #else
   #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsSsize_t
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyMethod_New(func, self, klass) ((self) ? ((void)(klass), PyMethod_New(func, self)) : __Pyx_NewRef(func))
 #else
   #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
 #endif
 #if CYTHON_USE_ASYNC_SLOTS
@@ -566,16 +652,18 @@
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
 
-#if defined(WIN32) || defined(MS_WINDOWS)
-  #define _USE_MATH_DEFINES
+#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
+  #if !defined(_USE_MATH_DEFINES)
+    #define _USE_MATH_DEFINES
+  #endif
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
 #else
 static CYTHON_INLINE float __PYX_NAN() {
   float value;
@@ -598,20 +686,23 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__dadapy__cython___cython_density
-#define __PYX_HAVE_API__dadapy__cython___cython_density
+#define __PYX_HAVE__dadapy___cython__cython_density
+#define __PYX_HAVE_API__dadapy___cython__cython_density
 /* Early includes */
 #include <string.h>
 #include <stdio.h>
 #include "numpy/arrayobject.h"
+#include "numpy/ndarrayobject.h"
+#include "numpy/ndarraytypes.h"
+#include "numpy/arrayscalars.h"
 #include "numpy/ufuncobject.h"
 
     /* NumPy API declarations from "numpy/__init__.pxd" */
     
 #include <math.h>
 #ifdef _OPENMP
 #include <omp.h>
@@ -705,14 +796,15 @@
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
 #define __Pyx_PySequence_Tuple(obj)\
     (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
 static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject*);
 #if CYTHON_ASSUME_SAFE_MACROS
 #define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
 #else
 #define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
 #endif
 #define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
 #if PY_MAJOR_VERSION >= 3
@@ -880,220 +972,220 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":689
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":690
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":690
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":691
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":691
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":692
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":693
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":696
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":697
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":697
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":698
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":698
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":699
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":700
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":703
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":704
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":704
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":705
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":713
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":714
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":714
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":715
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":715
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":716
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":717
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":718
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":718
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":719
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":719
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":720
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":721
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":722
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":722
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":723
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":724
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":725
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":725
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":726
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":726
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":727
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "dadapy/cython_/cython_density.pyx":14
- * boolTYPE = np.bool
+/* "dadapy/_cython/cython_density.pyx":14
+ * 
  * 
  * ctypedef np.int_t DTYPE_t             # <<<<<<<<<<<<<<
  * ctypedef np.float64_t floatTYPE_t
  * 
  */
-typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t;
+typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t;
 
-/* "dadapy/cython_/cython_density.pyx":15
+/* "dadapy/_cython/cython_density.pyx":15
  * 
  * ctypedef np.int_t DTYPE_t
  * ctypedef np.float64_t floatTYPE_t             # <<<<<<<<<<<<<<
  * 
  * # ----------------------------------------------------------------------------------------------
  */
-typedef __pyx_t_5numpy_float64_t __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t;
+typedef __pyx_t_5numpy_float64_t __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -1113,42 +1205,42 @@
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":728
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":729
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":730
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":730
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":731
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":732
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":733
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -1340,21 +1432,29 @@
 #define __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs) _PyFunction_FastCallDict(func, args, nargs, kwargs)
 #endif
 #define __Pyx_BUILD_ASSERT_EXPR(cond)\
     (sizeof(char [1 - 2*!(cond)]) - 1)
 #ifndef Py_MEMBER_SIZE
 #define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
 #endif
+#if CYTHON_FAST_PYCALL
   static size_t __pyx_pyframe_localsplus_offset = 0;
   #include "frameobject.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
   #define __Pxy_PyFrame_Initialize_Offsets()\
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
+#endif // CYTHON_FAST_PYCALL
 #endif
 
 /* PyObjectCall2Args.proto */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
@@ -1499,16 +1599,18 @@
     static void __Pyx_ReleaseBuffer(Py_buffer *view);
 #else
     #define __Pyx_GetBuffer PyObject_GetBuffer
     #define __Pyx_ReleaseBuffer PyBuffer_Release
 #endif
 
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_long(npy_long value);
+/* GCCDiagnostics.proto */
+#if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
+#define __Pyx_HAS_GCC_DIAGNOSTIC
+#endif
 
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
     #define __Pyx_CIMAG(z) ((z).imag())
   #else
@@ -1604,14 +1706,17 @@
     #endif
 #endif
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE npy_long __Pyx_PyInt_As_npy_long(PyObject *);
 
 /* CIntToPy.proto */
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_long(npy_long value);
+
+/* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
@@ -1660,96 +1765,102 @@
 /* Module declarations from 'numpy' */
 
 /* Module declarations from 'numpy' */
 static PyTypeObject *__pyx_ptype_5numpy_dtype = 0;
 static PyTypeObject *__pyx_ptype_5numpy_flatiter = 0;
 static PyTypeObject *__pyx_ptype_5numpy_broadcast = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ndarray = 0;
+static PyTypeObject *__pyx_ptype_5numpy_generic = 0;
+static PyTypeObject *__pyx_ptype_5numpy_number = 0;
+static PyTypeObject *__pyx_ptype_5numpy_integer = 0;
+static PyTypeObject *__pyx_ptype_5numpy_signedinteger = 0;
+static PyTypeObject *__pyx_ptype_5numpy_unsignedinteger = 0;
+static PyTypeObject *__pyx_ptype_5numpy_inexact = 0;
+static PyTypeObject *__pyx_ptype_5numpy_floating = 0;
+static PyTypeObject *__pyx_ptype_5numpy_complexfloating = 0;
+static PyTypeObject *__pyx_ptype_5numpy_flexible = 0;
+static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'libc.math' */
 
-/* Module declarations from 'dadapy.cython_.cython_density' */
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_DTYPE_t = { "DTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t = { "floatTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t), { 0 }, 0, 'R', 0, 0 };
-#define __Pyx_MODULE_NAME "dadapy.cython_.cython_density"
-extern int __pyx_module_is_main_dadapy__cython___cython_density;
-int __pyx_module_is_main_dadapy__cython___cython_density = 0;
+/* Module declarations from 'dadapy._cython.cython_density' */
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t = { "DTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t = { "floatTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t), { 0 }, 0, 'R', 0, 0 };
+#define __Pyx_MODULE_NAME "dadapy._cython.cython_density"
+extern int __pyx_module_is_main_dadapy___cython__cython_density;
+int __pyx_module_is_main_dadapy___cython__cython_density = 0;
 
-/* Implementation of 'dadapy.cython_.cython_density' */
+/* Implementation of 'dadapy._cython.cython_density' */
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_ImportError;
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k_j[] = "j";
 static const char __pyx_k_dL[] = "dL";
 static const char __pyx_k_np[] = "np";
-static const char __pyx_k_int[] = "int";
 static const char __pyx_k_vvi[] = "vvi";
 static const char __pyx_k_vvj[] = "vvj";
 static const char __pyx_k_Dthr[] = "Dthr";
 static const char __pyx_k_Nele[] = "Nele";
-static const char __pyx_k_bool[] = "bool";
 static const char __pyx_k_ksel[] = "ksel";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_maxk[] = "maxk";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_DTYPE[] = "DTYPE";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_empty[] = "empty";
-static const char __pyx_k_float[] = "float";
+static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_kstar[] = "kstar";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_id_sel[] = "id_sel";
 static const char __pyx_k_import[] = "__import__";
+static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_gammaln[] = "gammaln";
-static const char __pyx_k_boolTYPE[] = "boolTYPE";
 static const char __pyx_k_distances[] = "distances";
 static const char __pyx_k_floatTYPE[] = "floatTYPE";
 static const char __pyx_k_prefactor[] = "prefactor";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_dist_indices[] = "dist_indices";
 static const char __pyx_k_compute_kstar[] = "_compute_kstar";
 static const char __pyx_k_scipy_special[] = "scipy.special";
 static const char __pyx_k_data_distances[] = "data_distances";
 static const char __pyx_k_cross_distances[] = "cross_distances";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_cross_dist_indices[] = "cross_dist_indices";
 static const char __pyx_k_cython_density_pyx[] = "cython_density.pyx";
 static const char __pyx_k_compute_kstar_interp[] = "_compute_kstar_interp";
-static const char __pyx_k_dadapy_cython__cython_density[] = "dadapy.cython_.cython_density";
+static const char __pyx_k_dadapy__cython_cython_density[] = "dadapy._cython.cython_density";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static PyObject *__pyx_n_s_DTYPE;
 static PyObject *__pyx_n_s_Dthr;
 static PyObject *__pyx_n_s_ImportError;
 static PyObject *__pyx_n_s_Nele;
-static PyObject *__pyx_n_s_bool;
-static PyObject *__pyx_n_s_boolTYPE;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_compute_kstar;
 static PyObject *__pyx_n_s_compute_kstar_interp;
 static PyObject *__pyx_n_s_cross_dist_indices;
 static PyObject *__pyx_n_s_cross_distances;
 static PyObject *__pyx_kp_s_cython_density_pyx;
 static PyObject *__pyx_n_s_dL;
-static PyObject *__pyx_n_s_dadapy_cython__cython_density;
+static PyObject *__pyx_n_s_dadapy__cython_cython_density;
 static PyObject *__pyx_n_s_data_distances;
 static PyObject *__pyx_n_s_dist_indices;
 static PyObject *__pyx_n_s_distances;
 static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_empty;
-static PyObject *__pyx_n_s_float;
+static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_floatTYPE;
 static PyObject *__pyx_n_s_gammaln;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_id_sel;
 static PyObject *__pyx_n_s_import;
-static PyObject *__pyx_n_s_int;
+static PyObject *__pyx_n_s_int64;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_ksel;
 static PyObject *__pyx_n_s_kstar;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_maxk;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_np;
@@ -1758,40 +1869,40 @@
 static PyObject *__pyx_kp_s_numpy_core_umath_failed_to_impor;
 static PyObject *__pyx_n_s_prefactor;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_scipy_special;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_vvi;
 static PyObject *__pyx_n_s_vvj;
-static PyObject *__pyx_pf_6dadapy_7cython__14cython_density__compute_kstar(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_dist_indices, PyArrayObject *__pyx_v_distances); /* proto */
-static PyObject *__pyx_pf_6dadapy_7cython__14cython_density_2_compute_kstar_interp(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_cross_dist_indices, PyArrayObject *__pyx_v_cross_distances, PyArrayObject *__pyx_v_data_distances); /* proto */
+static PyObject *__pyx_pf_6dadapy_7_cython_14cython_density__compute_kstar(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_dist_indices, PyArrayObject *__pyx_v_distances); /* proto */
+static PyObject *__pyx_pf_6dadapy_7_cython_14cython_density_2_compute_kstar_interp(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_cross_dist_indices, PyArrayObject *__pyx_v_cross_distances, PyArrayObject *__pyx_v_data_distances); /* proto */
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_codeobj__4;
 static PyObject *__pyx_codeobj__6;
 /* Late includes */
 
-/* "dadapy/cython_/cython_density.pyx":21
+/* "dadapy/_cython/cython_density.pyx":21
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                     DTYPE_t Nele,
  *                     DTYPE_t maxk,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_6dadapy_7cython__14cython_density_1_compute_kstar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_6dadapy_7cython__14cython_density_1_compute_kstar = {"_compute_kstar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7cython__14cython_density_1_compute_kstar, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_6dadapy_7cython__14cython_density_1_compute_kstar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr;
+static PyObject *__pyx_pw_6dadapy_7_cython_14cython_density_1_compute_kstar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_6dadapy_7_cython_14cython_density_1_compute_kstar = {"_compute_kstar", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7_cython_14cython_density_1_compute_kstar, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_6dadapy_7_cython_14cython_density_1_compute_kstar(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr;
   PyArrayObject *__pyx_v_dist_indices = 0;
   PyArrayObject *__pyx_v_distances = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -1874,40 +1985,40 @@
     __pyx_v_dist_indices = ((PyArrayObject *)values[4]);
     __pyx_v_distances = ((PyArrayObject *)values[5]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
   __Pyx_RaiseArgtupleInvalid("_compute_kstar", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 21, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("dadapy.cython_.cython_density._compute_kstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_density._compute_kstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dist_indices), __pyx_ptype_5numpy_ndarray, 1, "dist_indices", 0))) __PYX_ERR(0, 25, __pyx_L1_error)
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_distances), __pyx_ptype_5numpy_ndarray, 1, "distances", 0))) __PYX_ERR(0, 26, __pyx_L1_error)
-  __pyx_r = __pyx_pf_6dadapy_7cython__14cython_density__compute_kstar(__pyx_self, __pyx_v_id_sel, __pyx_v_Nele, __pyx_v_maxk, __pyx_v_Dthr, __pyx_v_dist_indices, __pyx_v_distances);
+  __pyx_r = __pyx_pf_6dadapy_7_cython_14cython_density__compute_kstar(__pyx_self, __pyx_v_id_sel, __pyx_v_Nele, __pyx_v_maxk, __pyx_v_Dthr, __pyx_v_dist_indices, __pyx_v_distances);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_6dadapy_7cython__14cython_density__compute_kstar(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_dist_indices, PyArrayObject *__pyx_v_distances) {
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_dL;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_vvi;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_vvj;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_i;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_j;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_ksel;
+static PyObject *__pyx_pf_6dadapy_7_cython_14cython_density__compute_kstar(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_dist_indices, PyArrayObject *__pyx_v_distances) {
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_dL;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_vvi;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_vvj;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_i;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_j;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_ksel;
   PyArrayObject *__pyx_v_kstar = 0;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_prefactor;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_prefactor;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_dist_indices;
   __Pyx_Buffer __pyx_pybuffer_dist_indices;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_distances;
   __Pyx_Buffer __pyx_pybuffer_distances;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_kstar;
   __Pyx_Buffer __pyx_pybuffer_kstar;
   PyObject *__pyx_r = NULL;
@@ -1915,17 +2026,17 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyArrayObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   double __pyx_t_7;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_8;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_9;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_10;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_8;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_9;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   int __pyx_lineno = 0;
@@ -1942,24 +2053,24 @@
   __pyx_pybuffernd_dist_indices.rcbuffer = &__pyx_pybuffer_dist_indices;
   __pyx_pybuffer_distances.pybuffer.buf = NULL;
   __pyx_pybuffer_distances.refcount = 0;
   __pyx_pybuffernd_distances.data = NULL;
   __pyx_pybuffernd_distances.rcbuffer = &__pyx_pybuffer_distances;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 21, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 21, __pyx_L1_error)
   }
   __pyx_pybuffernd_dist_indices.diminfo[0].strides = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dist_indices.diminfo[0].shape = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dist_indices.diminfo[1].strides = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dist_indices.diminfo[1].shape = __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 21, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 21, __pyx_L1_error)
   }
   __pyx_pybuffernd_distances.diminfo[0].strides = __pyx_pybuffernd_distances.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_distances.diminfo[0].shape = __pyx_pybuffernd_distances.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_distances.diminfo[1].strides = __pyx_pybuffernd_distances.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_distances.diminfo[1].shape = __pyx_pybuffernd_distances.rcbuffer->pybuffer.shape[1];
 
-  /* "dadapy/cython_/cython_density.pyx":32
+  /* "dadapy/_cython/cython_density.pyx":32
  *     cdef floatTYPE_t dL, vvi, vvj
  *     cdef DTYPE_t i, j, ksel
  *     cdef np.ndarray[DTYPE_t, ndim = 1] kstar = np.empty(Nele, dtype=int)             # <<<<<<<<<<<<<<
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)
@@ -1982,25 +2093,25 @@
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 32, __pyx_L1_error)
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_kstar = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf = NULL;
       __PYX_ERR(0, 32, __pyx_L1_error)
     } else {__pyx_pybuffernd_kstar.diminfo[0].strides = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_kstar.diminfo[0].shape = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_5 = 0;
   __pyx_v_kstar = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":33
+  /* "dadapy/_cython/cython_density.pyx":33
  *     cdef DTYPE_t i, j, ksel
  *     cdef np.ndarray[DTYPE_t, ndim = 1] kstar = np.empty(Nele, dtype=int)
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )             # <<<<<<<<<<<<<<
  * 
  *     for i in range(Nele):
  */
   __pyx_t_4 = PyFloat_FromDouble(((__pyx_v_id_sel / 2.0) * log(M_PI))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 33, __pyx_L1_error)
@@ -2029,45 +2140,45 @@
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_prefactor = exp(__pyx_t_7);
 
-  /* "dadapy/cython_/cython_density.pyx":35
+  /* "dadapy/_cython/cython_density.pyx":35
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )
  * 
  *     for i in range(Nele):             # <<<<<<<<<<<<<<
  *         j = 4
  *         dL = 0.0
  */
   __pyx_t_8 = __pyx_v_Nele;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "dadapy/cython_/cython_density.pyx":36
+    /* "dadapy/_cython/cython_density.pyx":36
  * 
  *     for i in range(Nele):
  *         j = 4             # <<<<<<<<<<<<<<
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:
  */
     __pyx_v_j = 4;
 
-    /* "dadapy/cython_/cython_density.pyx":37
+    /* "dadapy/_cython/cython_density.pyx":37
  *     for i in range(Nele):
  *         j = 4
  *         dL = 0.0             # <<<<<<<<<<<<<<
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1
  */
     __pyx_v_dL = 0.0;
 
-    /* "dadapy/cython_/cython_density.pyx":38
+    /* "dadapy/_cython/cython_density.pyx":38
  *         j = 4
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:             # <<<<<<<<<<<<<<
  *             ksel = j - 1
  *             vvi = prefactor * pow(distances[i, ksel], id_sel)
  */
     while (1) {
@@ -2078,131 +2189,131 @@
         goto __pyx_L7_bool_binop_done;
       }
       __pyx_t_12 = ((__pyx_v_dL < __pyx_v_Dthr) != 0);
       __pyx_t_11 = __pyx_t_12;
       __pyx_L7_bool_binop_done:;
       if (!__pyx_t_11) break;
 
-      /* "dadapy/cython_/cython_density.pyx":39
+      /* "dadapy/_cython/cython_density.pyx":39
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1             # <<<<<<<<<<<<<<
  *             vvi = prefactor * pow(distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(distances[dist_indices[i, j], ksel], id_sel)
  */
       __pyx_v_ksel = (__pyx_v_j - 1);
 
-      /* "dadapy/cython_/cython_density.pyx":40
+      /* "dadapy/_cython/cython_density.pyx":40
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1
  *             vvi = prefactor * pow(distances[i, ksel], id_sel)             # <<<<<<<<<<<<<<
  *             vvj = prefactor * pow(distances[dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  */
       __pyx_t_13 = __pyx_v_i;
       __pyx_t_14 = __pyx_v_ksel;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_distances.diminfo[0].shape;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_distances.diminfo[1].shape;
-      __pyx_v_vvi = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t *, __pyx_pybuffernd_distances.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_distances.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_distances.diminfo[1].strides)), __pyx_v_id_sel));
+      __pyx_v_vvi = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t *, __pyx_pybuffernd_distances.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_distances.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_distances.diminfo[1].strides)), __pyx_v_id_sel));
 
-      /* "dadapy/cython_/cython_density.pyx":41
+      /* "dadapy/_cython/cython_density.pyx":41
  *             ksel = j - 1
  *             vvi = prefactor * pow(distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(distances[dist_indices[i, j], ksel], id_sel)             # <<<<<<<<<<<<<<
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_13 = __pyx_v_j;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_dist_indices.diminfo[0].shape;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_dist_indices.diminfo[1].shape;
-      __pyx_t_15 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
+      __pyx_t_15 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_dist_indices.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_dist_indices.diminfo[1].strides));
       __pyx_t_16 = __pyx_v_ksel;
       if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_pybuffernd_distances.diminfo[0].shape;
       if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_distances.diminfo[1].shape;
-      __pyx_v_vvj = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t *, __pyx_pybuffernd_distances.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_distances.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_distances.diminfo[1].strides)), __pyx_v_id_sel));
+      __pyx_v_vvj = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t *, __pyx_pybuffernd_distances.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_distances.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_distances.diminfo[1].strides)), __pyx_v_id_sel));
 
-      /* "dadapy/cython_/cython_density.pyx":42
+      /* "dadapy/_cython/cython_density.pyx":42
  *             vvi = prefactor * pow(distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(distances[dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )             # <<<<<<<<<<<<<<
  *             j = j + 1
  *         if j == maxk:
  */
       __pyx_v_dL = ((-2.0 * __pyx_v_ksel) * (((log(__pyx_v_vvi) + log(__pyx_v_vvj)) - (2.0 * log((__pyx_v_vvi + __pyx_v_vvj)))) + log(4.0)));
 
-      /* "dadapy/cython_/cython_density.pyx":43
+      /* "dadapy/_cython/cython_density.pyx":43
  *             vvj = prefactor * pow(distances[dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1             # <<<<<<<<<<<<<<
  *         if j == maxk:
  *             kstar[i] = j - 1
  */
       __pyx_v_j = (__pyx_v_j + 1);
     }
 
-    /* "dadapy/cython_/cython_density.pyx":44
+    /* "dadapy/_cython/cython_density.pyx":44
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  *         if j == maxk:             # <<<<<<<<<<<<<<
  *             kstar[i] = j - 1
  *         else:
  */
     __pyx_t_11 = ((__pyx_v_j == __pyx_v_maxk) != 0);
     if (__pyx_t_11) {
 
-      /* "dadapy/cython_/cython_density.pyx":45
+      /* "dadapy/_cython/cython_density.pyx":45
  *             j = j + 1
  *         if j == maxk:
  *             kstar[i] = j - 1             # <<<<<<<<<<<<<<
  *         else:
  *             kstar[i] = j - 2
  */
       __pyx_t_13 = __pyx_v_i;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 1);
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 1);
 
-      /* "dadapy/cython_/cython_density.pyx":44
+      /* "dadapy/_cython/cython_density.pyx":44
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  *         if j == maxk:             # <<<<<<<<<<<<<<
  *             kstar[i] = j - 1
  *         else:
  */
       goto __pyx_L9;
     }
 
-    /* "dadapy/cython_/cython_density.pyx":47
+    /* "dadapy/_cython/cython_density.pyx":47
  *             kstar[i] = j - 1
  *         else:
  *             kstar[i] = j - 2             # <<<<<<<<<<<<<<
  * 
  *     return kstar
  */
     /*else*/ {
       __pyx_t_13 = __pyx_v_i;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 2);
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 2);
     }
     __pyx_L9:;
   }
 
-  /* "dadapy/cython_/cython_density.pyx":49
+  /* "dadapy/_cython/cython_density.pyx":49
  *             kstar[i] = j - 2
  * 
  *     return kstar             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_kstar));
   __pyx_r = ((PyObject *)__pyx_v_kstar);
   goto __pyx_L0;
 
-  /* "dadapy/cython_/cython_density.pyx":21
+  /* "dadapy/_cython/cython_density.pyx":21
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                     DTYPE_t Nele,
  *                     DTYPE_t maxk,
  */
 
@@ -2217,44 +2328,44 @@
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_distances.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("dadapy.cython_.cython_density._compute_kstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_density._compute_kstar", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_dist_indices.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_distances.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_kstar);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "dadapy/cython_/cython_density.pyx":54
+/* "dadapy/_cython/cython_density.pyx":54
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar_interp(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                           DTYPE_t Nele,
  *                           DTYPE_t maxk,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_6dadapy_7cython__14cython_density_3_compute_kstar_interp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_6dadapy_7cython__14cython_density_3_compute_kstar_interp = {"_compute_kstar_interp", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7cython__14cython_density_3_compute_kstar_interp, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_6dadapy_7cython__14cython_density_3_compute_kstar_interp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr;
+static PyObject *__pyx_pw_6dadapy_7_cython_14cython_density_3_compute_kstar_interp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_6dadapy_7_cython_14cython_density_3_compute_kstar_interp = {"_compute_kstar_interp", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7_cython_14cython_density_3_compute_kstar_interp, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_6dadapy_7_cython_14cython_density_3_compute_kstar_interp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr;
   PyArrayObject *__pyx_v_cross_dist_indices = 0;
   PyArrayObject *__pyx_v_cross_distances = 0;
   PyArrayObject *__pyx_v_data_distances = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -2348,41 +2459,41 @@
     __pyx_v_cross_distances = ((PyArrayObject *)values[5]);
     __pyx_v_data_distances = ((PyArrayObject *)values[6]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
   __Pyx_RaiseArgtupleInvalid("_compute_kstar_interp", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 54, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("dadapy.cython_.cython_density._compute_kstar_interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_density._compute_kstar_interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_cross_dist_indices), __pyx_ptype_5numpy_ndarray, 1, "cross_dist_indices", 0))) __PYX_ERR(0, 58, __pyx_L1_error)
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_cross_distances), __pyx_ptype_5numpy_ndarray, 1, "cross_distances", 0))) __PYX_ERR(0, 59, __pyx_L1_error)
   if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_data_distances), __pyx_ptype_5numpy_ndarray, 1, "data_distances", 0))) __PYX_ERR(0, 60, __pyx_L1_error)
-  __pyx_r = __pyx_pf_6dadapy_7cython__14cython_density_2_compute_kstar_interp(__pyx_self, __pyx_v_id_sel, __pyx_v_Nele, __pyx_v_maxk, __pyx_v_Dthr, __pyx_v_cross_dist_indices, __pyx_v_cross_distances, __pyx_v_data_distances);
+  __pyx_r = __pyx_pf_6dadapy_7_cython_14cython_density_2_compute_kstar_interp(__pyx_self, __pyx_v_id_sel, __pyx_v_Nele, __pyx_v_maxk, __pyx_v_Dthr, __pyx_v_cross_dist_indices, __pyx_v_cross_distances, __pyx_v_data_distances);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_6dadapy_7cython__14cython_density_2_compute_kstar_interp(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_cross_dist_indices, PyArrayObject *__pyx_v_cross_distances, PyArrayObject *__pyx_v_data_distances) {
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_dL;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_vvi;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_vvj;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_i;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_j;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_v_ksel;
+static PyObject *__pyx_pf_6dadapy_7_cython_14cython_density_2_compute_kstar_interp(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_id_sel, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_Nele, __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_maxk, __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_Dthr, PyArrayObject *__pyx_v_cross_dist_indices, PyArrayObject *__pyx_v_cross_distances, PyArrayObject *__pyx_v_data_distances) {
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_dL;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_vvi;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_vvj;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_i;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_j;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_v_ksel;
   PyArrayObject *__pyx_v_kstar = 0;
-  __pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t __pyx_v_prefactor;
+  __pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t __pyx_v_prefactor;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_cross_dist_indices;
   __Pyx_Buffer __pyx_pybuffer_cross_dist_indices;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_cross_distances;
   __Pyx_Buffer __pyx_pybuffer_cross_distances;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_data_distances;
   __Pyx_Buffer __pyx_pybuffer_data_distances;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_kstar;
@@ -2392,17 +2503,17 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyArrayObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   double __pyx_t_7;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_8;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_9;
-  __pyx_t_6dadapy_7cython__14cython_density_DTYPE_t __pyx_t_10;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_8;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_9;
+  __pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   int __pyx_lineno = 0;
@@ -2423,29 +2534,29 @@
   __pyx_pybuffernd_cross_distances.rcbuffer = &__pyx_pybuffer_cross_distances;
   __pyx_pybuffer_data_distances.pybuffer.buf = NULL;
   __pyx_pybuffer_data_distances.refcount = 0;
   __pyx_pybuffernd_data_distances.data = NULL;
   __pyx_pybuffernd_data_distances.rcbuffer = &__pyx_pybuffer_data_distances;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_cross_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer, (PyObject*)__pyx_v_cross_dist_indices, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
   }
   __pyx_pybuffernd_cross_dist_indices.diminfo[0].strides = __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cross_dist_indices.diminfo[0].shape = __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_cross_dist_indices.diminfo[1].strides = __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_cross_dist_indices.diminfo[1].shape = __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cross_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_cross_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cross_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_cross_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
   }
   __pyx_pybuffernd_cross_distances.diminfo[0].strides = __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cross_distances.diminfo[0].shape = __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_cross_distances.diminfo[1].strides = __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_cross_distances.diminfo[1].shape = __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_data_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_data_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_data_distances.rcbuffer->pybuffer, (PyObject*)__pyx_v_data_distances, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 54, __pyx_L1_error)
   }
   __pyx_pybuffernd_data_distances.diminfo[0].strides = __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_data_distances.diminfo[0].shape = __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_data_distances.diminfo[1].strides = __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_data_distances.diminfo[1].shape = __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.shape[1];
 
-  /* "dadapy/cython_/cython_density.pyx":66
+  /* "dadapy/_cython/cython_density.pyx":66
  *     cdef floatTYPE_t dL, vvi, vvj
  *     cdef DTYPE_t i, j, ksel
  *     cdef np.ndarray[DTYPE_t, ndim = 1] kstar = np.empty(Nele, dtype=int)             # <<<<<<<<<<<<<<
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 66, __pyx_L1_error)
@@ -2468,25 +2579,25 @@
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 66, __pyx_L1_error)
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_4);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_kstar = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf = NULL;
       __PYX_ERR(0, 66, __pyx_L1_error)
     } else {__pyx_pybuffernd_kstar.diminfo[0].strides = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_kstar.diminfo[0].shape = __pyx_pybuffernd_kstar.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_5 = 0;
   __pyx_v_kstar = ((PyArrayObject *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":67
+  /* "dadapy/_cython/cython_density.pyx":67
  *     cdef DTYPE_t i, j, ksel
  *     cdef np.ndarray[DTYPE_t, ndim = 1] kstar = np.empty(Nele, dtype=int)
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )             # <<<<<<<<<<<<<<
  * 
  *     for i in range(Nele):
  */
   __pyx_t_4 = PyFloat_FromDouble(((__pyx_v_id_sel / 2.0) * log(M_PI))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 67, __pyx_L1_error)
@@ -2515,45 +2626,45 @@
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_7 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_7 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_prefactor = exp(__pyx_t_7);
 
-  /* "dadapy/cython_/cython_density.pyx":69
+  /* "dadapy/_cython/cython_density.pyx":69
  *     cdef floatTYPE_t prefactor = exp( id_sel / 2.0 * log(pi) - gammaln((id_sel + 2.0) / 2.0) )
  * 
  *     for i in range(Nele):             # <<<<<<<<<<<<<<
  *         j = 4
  *         dL = 0.0
  */
   __pyx_t_8 = __pyx_v_Nele;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "dadapy/cython_/cython_density.pyx":70
+    /* "dadapy/_cython/cython_density.pyx":70
  * 
  *     for i in range(Nele):
  *         j = 4             # <<<<<<<<<<<<<<
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:
  */
     __pyx_v_j = 4;
 
-    /* "dadapy/cython_/cython_density.pyx":71
+    /* "dadapy/_cython/cython_density.pyx":71
  *     for i in range(Nele):
  *         j = 4
  *         dL = 0.0             # <<<<<<<<<<<<<<
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1
  */
     __pyx_v_dL = 0.0;
 
-    /* "dadapy/cython_/cython_density.pyx":72
+    /* "dadapy/_cython/cython_density.pyx":72
  *         j = 4
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:             # <<<<<<<<<<<<<<
  *             ksel = j - 1
  *             vvi = prefactor * pow(cross_distances[i, ksel], id_sel)
  */
     while (1) {
@@ -2564,129 +2675,129 @@
         goto __pyx_L7_bool_binop_done;
       }
       __pyx_t_12 = ((__pyx_v_dL < __pyx_v_Dthr) != 0);
       __pyx_t_11 = __pyx_t_12;
       __pyx_L7_bool_binop_done:;
       if (!__pyx_t_11) break;
 
-      /* "dadapy/cython_/cython_density.pyx":73
+      /* "dadapy/_cython/cython_density.pyx":73
  *         dL = 0.0
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1             # <<<<<<<<<<<<<<
  *             vvi = prefactor * pow(cross_distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(data_distances[cross_dist_indices[i, j], ksel], id_sel)
  */
       __pyx_v_ksel = (__pyx_v_j - 1);
 
-      /* "dadapy/cython_/cython_density.pyx":74
+      /* "dadapy/_cython/cython_density.pyx":74
  *         while j < maxk and dL < Dthr:
  *             ksel = j - 1
  *             vvi = prefactor * pow(cross_distances[i, ksel], id_sel)             # <<<<<<<<<<<<<<
  *             vvj = prefactor * pow(data_distances[cross_dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  */
       __pyx_t_13 = __pyx_v_i;
       __pyx_t_14 = __pyx_v_ksel;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_cross_distances.diminfo[0].shape;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_cross_distances.diminfo[1].shape;
-      __pyx_v_vvi = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t *, __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cross_distances.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_cross_distances.diminfo[1].strides)), __pyx_v_id_sel));
+      __pyx_v_vvi = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t *, __pyx_pybuffernd_cross_distances.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_cross_distances.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_cross_distances.diminfo[1].strides)), __pyx_v_id_sel));
 
-      /* "dadapy/cython_/cython_density.pyx":75
+      /* "dadapy/_cython/cython_density.pyx":75
  *             ksel = j - 1
  *             vvi = prefactor * pow(cross_distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(data_distances[cross_dist_indices[i, j], ksel], id_sel)             # <<<<<<<<<<<<<<
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_13 = __pyx_v_j;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_cross_dist_indices.diminfo[0].shape;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_cross_dist_indices.diminfo[1].shape;
-      __pyx_t_15 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_cross_dist_indices.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_cross_dist_indices.diminfo[1].strides));
+      __pyx_t_15 = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_cross_dist_indices.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_cross_dist_indices.diminfo[1].strides));
       __pyx_t_16 = __pyx_v_ksel;
       if (__pyx_t_15 < 0) __pyx_t_15 += __pyx_pybuffernd_data_distances.diminfo[0].shape;
       if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_data_distances.diminfo[1].shape;
-      __pyx_v_vvj = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__14cython_density_floatTYPE_t *, __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_data_distances.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_data_distances.diminfo[1].strides)), __pyx_v_id_sel));
+      __pyx_v_vvj = (__pyx_v_prefactor * pow((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_14cython_density_floatTYPE_t *, __pyx_pybuffernd_data_distances.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_data_distances.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_data_distances.diminfo[1].strides)), __pyx_v_id_sel));
 
-      /* "dadapy/cython_/cython_density.pyx":76
+      /* "dadapy/_cython/cython_density.pyx":76
  *             vvi = prefactor * pow(cross_distances[i, ksel], id_sel)
  *             vvj = prefactor * pow(data_distances[cross_dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )             # <<<<<<<<<<<<<<
  *             j = j + 1
  *         if j == maxk:
  */
       __pyx_v_dL = ((-2.0 * __pyx_v_ksel) * (((log(__pyx_v_vvi) + log(__pyx_v_vvj)) - (2.0 * log((__pyx_v_vvi + __pyx_v_vvj)))) + log(4.0)));
 
-      /* "dadapy/cython_/cython_density.pyx":77
+      /* "dadapy/_cython/cython_density.pyx":77
  *             vvj = prefactor * pow(data_distances[cross_dist_indices[i, j], ksel], id_sel)
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1             # <<<<<<<<<<<<<<
  *         if j == maxk:
  *             kstar[i] = j - 1
  */
       __pyx_v_j = (__pyx_v_j + 1);
     }
 
-    /* "dadapy/cython_/cython_density.pyx":78
+    /* "dadapy/_cython/cython_density.pyx":78
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  *         if j == maxk:             # <<<<<<<<<<<<<<
  *             kstar[i] = j - 1
  *         else:
  */
     __pyx_t_11 = ((__pyx_v_j == __pyx_v_maxk) != 0);
     if (__pyx_t_11) {
 
-      /* "dadapy/cython_/cython_density.pyx":79
+      /* "dadapy/_cython/cython_density.pyx":79
  *             j = j + 1
  *         if j == maxk:
  *             kstar[i] = j - 1             # <<<<<<<<<<<<<<
  *         else:
  *             kstar[i] = j - 2
  */
       __pyx_t_13 = __pyx_v_i;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 1);
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 1);
 
-      /* "dadapy/cython_/cython_density.pyx":78
+      /* "dadapy/_cython/cython_density.pyx":78
  *             dL = -2.0 * ksel * ( log(vvi) + log(vvj) - 2.0 * log(vvi + vvj) + log(4) )
  *             j = j + 1
  *         if j == maxk:             # <<<<<<<<<<<<<<
  *             kstar[i] = j - 1
  *         else:
  */
       goto __pyx_L9;
     }
 
-    /* "dadapy/cython_/cython_density.pyx":81
+    /* "dadapy/_cython/cython_density.pyx":81
  *             kstar[i] = j - 1
  *         else:
  *             kstar[i] = j - 2             # <<<<<<<<<<<<<<
  * 
  *     return kstar
  */
     /*else*/ {
       __pyx_t_13 = __pyx_v_i;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 2);
+      *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_14cython_density_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_kstar.diminfo[0].strides) = (__pyx_v_j - 2);
     }
     __pyx_L9:;
   }
 
-  /* "dadapy/cython_/cython_density.pyx":83
+  /* "dadapy/_cython/cython_density.pyx":83
  *             kstar[i] = j - 2
  * 
  *     return kstar             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_kstar));
   __pyx_r = ((PyObject *)__pyx_v_kstar);
   goto __pyx_L0;
 
-  /* "dadapy/cython_/cython_density.pyx":54
+  /* "dadapy/_cython/cython_density.pyx":54
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar_interp(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                           DTYPE_t Nele,
  *                           DTYPE_t maxk,
  */
 
@@ -2702,30 +2813,30 @@
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cross_distances.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_data_distances.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("dadapy.cython_.cython_density._compute_kstar_interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_density._compute_kstar_interp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cross_dist_indices.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cross_distances.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_data_distances.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_kstar);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":734
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -2734,29 +2845,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":735
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":736
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 735, __pyx_L1_error)
+  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":734
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -2767,15 +2878,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":737
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -2784,29 +2895,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":738
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":739
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 738, __pyx_L1_error)
+  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":737
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -2817,15 +2928,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":740
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -2834,29 +2945,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":741
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":742
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 741, __pyx_L1_error)
+  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":740
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -2867,15 +2978,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":743
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -2884,29 +2995,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":744
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":745
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 744, __pyx_L1_error)
+  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":743
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -2917,15 +3028,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":746
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -2934,29 +3045,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":747
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":748
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 747, __pyx_L1_error)
+  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":746
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -2967,212 +3078,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":749
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":750
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":751
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":752
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":750
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":753
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":754
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":749
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":868
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":869
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":930
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":870
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":931
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":868
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":872
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":873
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":934
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":874
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":875
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":936
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":874
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":876
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":937
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":872
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":880
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3188,15 +3299,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":881
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -3204,84 +3315,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":882
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":943
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
-      __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 882, __pyx_L3_error)
+      __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 943, __pyx_L3_error)
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":881
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":883
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":944
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 883, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":884
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 884, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple_, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __PYX_ERR(1, 884, __pyx_L5_except_error)
+      __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":881
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":880
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3296,15 +3407,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":886
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3320,15 +3431,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":887
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3336,84 +3447,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":888
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":949
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
-      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 888, __pyx_L3_error)
+      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 949, __pyx_L3_error)
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":887
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":889
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":950
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 889, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":890
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 890, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __PYX_ERR(1, 890, __pyx_L5_except_error)
+      __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":887
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":886
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3428,15 +3539,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":892
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3452,15 +3563,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":893
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3468,84 +3579,84 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":894
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":955
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
-      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 894, __pyx_L3_error)
+      __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 955, __pyx_L3_error)
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":893
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":895
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":956
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 895, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":896
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 896, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __PYX_ERR(1, 896, __pyx_L5_except_error)
+      __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":893
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":892
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3560,14 +3671,188 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
+ * 
+ * 
+ * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.timedelta64)`
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":979
+ *     bool
+ *     """
+ *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
+  goto __pyx_L0;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
+ * 
+ * 
+ * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.timedelta64)`
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
+ * 
+ * 
+ * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.datetime64)`
+ */
+
+static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
+  int __pyx_r;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("is_datetime64_object", 0);
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":994
+ *     bool
+ *     """
+ *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
+  goto __pyx_L0;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
+ * 
+ * 
+ * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
+ *     """
+ *     Cython equivalent of `isinstance(obj, np.datetime64)`
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
+ * 
+ * 
+ * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy datetime64 object
+ */
+
+static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
+  npy_datetime __pyx_r;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1004
+ *     also needed.  That can be found using `get_datetime64_unit`.
+ *     """
+ *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
+  goto __pyx_L0;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
+ * 
+ * 
+ * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy datetime64 object
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
+ * 
+ * 
+ * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ */
+
+static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
+  npy_timedelta __pyx_r;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1011
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ *     """
+ *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
+  goto __pyx_L0;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
+ * 
+ * 
+ * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the int64 value underlying scalar numpy timedelta64 object
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
+ * 
+ * 
+ * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ */
+
+static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
+  NPY_DATETIMEUNIT __pyx_r;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1018
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ *     """
+ *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
+ */
+  __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
+  goto __pyx_L0;
+
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
+ * 
+ * 
+ * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the unit part of the dtype for a numpy datetime64 object.
+ */
+
+  /* function exit code */
+  __pyx_L0:;
+  return __pyx_r;
+}
+
 static PyMethodDef __pyx_methods[] = {
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
@@ -3610,36 +3895,34 @@
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_s_DTYPE, __pyx_k_DTYPE, sizeof(__pyx_k_DTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_Dthr, __pyx_k_Dthr, sizeof(__pyx_k_Dthr), 0, 0, 1, 1},
   {&__pyx_n_s_ImportError, __pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 0, 1, 1},
   {&__pyx_n_s_Nele, __pyx_k_Nele, sizeof(__pyx_k_Nele), 0, 0, 1, 1},
-  {&__pyx_n_s_bool, __pyx_k_bool, sizeof(__pyx_k_bool), 0, 0, 1, 1},
-  {&__pyx_n_s_boolTYPE, __pyx_k_boolTYPE, sizeof(__pyx_k_boolTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_compute_kstar, __pyx_k_compute_kstar, sizeof(__pyx_k_compute_kstar), 0, 0, 1, 1},
   {&__pyx_n_s_compute_kstar_interp, __pyx_k_compute_kstar_interp, sizeof(__pyx_k_compute_kstar_interp), 0, 0, 1, 1},
   {&__pyx_n_s_cross_dist_indices, __pyx_k_cross_dist_indices, sizeof(__pyx_k_cross_dist_indices), 0, 0, 1, 1},
   {&__pyx_n_s_cross_distances, __pyx_k_cross_distances, sizeof(__pyx_k_cross_distances), 0, 0, 1, 1},
   {&__pyx_kp_s_cython_density_pyx, __pyx_k_cython_density_pyx, sizeof(__pyx_k_cython_density_pyx), 0, 0, 1, 0},
   {&__pyx_n_s_dL, __pyx_k_dL, sizeof(__pyx_k_dL), 0, 0, 1, 1},
-  {&__pyx_n_s_dadapy_cython__cython_density, __pyx_k_dadapy_cython__cython_density, sizeof(__pyx_k_dadapy_cython__cython_density), 0, 0, 1, 1},
+  {&__pyx_n_s_dadapy__cython_cython_density, __pyx_k_dadapy__cython_cython_density, sizeof(__pyx_k_dadapy__cython_cython_density), 0, 0, 1, 1},
   {&__pyx_n_s_data_distances, __pyx_k_data_distances, sizeof(__pyx_k_data_distances), 0, 0, 1, 1},
   {&__pyx_n_s_dist_indices, __pyx_k_dist_indices, sizeof(__pyx_k_dist_indices), 0, 0, 1, 1},
   {&__pyx_n_s_distances, __pyx_k_distances, sizeof(__pyx_k_distances), 0, 0, 1, 1},
   {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_empty, __pyx_k_empty, sizeof(__pyx_k_empty), 0, 0, 1, 1},
-  {&__pyx_n_s_float, __pyx_k_float, sizeof(__pyx_k_float), 0, 0, 1, 1},
+  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_floatTYPE, __pyx_k_floatTYPE, sizeof(__pyx_k_floatTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_gammaln, __pyx_k_gammaln, sizeof(__pyx_k_gammaln), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_id_sel, __pyx_k_id_sel, sizeof(__pyx_k_id_sel), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
-  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
+  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_ksel, __pyx_k_ksel, sizeof(__pyx_k_ksel), 0, 0, 1, 1},
   {&__pyx_n_s_kstar, __pyx_k_kstar, sizeof(__pyx_k_kstar), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_maxk, __pyx_k_maxk, sizeof(__pyx_k_maxk), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
@@ -3652,59 +3935,59 @@
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_vvi, __pyx_k_vvi, sizeof(__pyx_k_vvi), 0, 0, 1, 1},
   {&__pyx_n_s_vvj, __pyx_k_vvj, sizeof(__pyx_k_vvj), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
   __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 35, __pyx_L1_error)
-  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 884, __pyx_L1_error)
+  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":884
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple_)) __PYX_ERR(1, 884, __pyx_L1_error)
+  __pyx_tuple_ = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple_)) __PYX_ERR(1, 945, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple_);
   __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":890
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 890, __pyx_L1_error)
+  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__2);
   __Pyx_GIVEREF(__pyx_tuple__2);
 
-  /* "dadapy/cython_/cython_density.pyx":21
+  /* "dadapy/_cython/cython_density.pyx":21
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                     DTYPE_t Nele,
  *                     DTYPE_t maxk,
  */
   __pyx_tuple__3 = PyTuple_Pack(14, __pyx_n_s_id_sel, __pyx_n_s_Nele, __pyx_n_s_maxk, __pyx_n_s_Dthr, __pyx_n_s_dist_indices, __pyx_n_s_distances, __pyx_n_s_dL, __pyx_n_s_vvi, __pyx_n_s_vvj, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ksel, __pyx_n_s_kstar, __pyx_n_s_prefactor); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__3);
   __Pyx_GIVEREF(__pyx_tuple__3);
   __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(6, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__3, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_density_pyx, __pyx_n_s_compute_kstar, 21, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 21, __pyx_L1_error)
 
-  /* "dadapy/cython_/cython_density.pyx":54
+  /* "dadapy/_cython/cython_density.pyx":54
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar_interp(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                           DTYPE_t Nele,
  *                           DTYPE_t maxk,
  */
   __pyx_tuple__5 = PyTuple_Pack(15, __pyx_n_s_id_sel, __pyx_n_s_Nele, __pyx_n_s_maxk, __pyx_n_s_Dthr, __pyx_n_s_cross_dist_indices, __pyx_n_s_cross_distances, __pyx_n_s_data_distances, __pyx_n_s_dL, __pyx_n_s_vvi, __pyx_n_s_vvj, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_ksel, __pyx_n_s_kstar, __pyx_n_s_prefactor); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 54, __pyx_L1_error)
@@ -3780,26 +4063,46 @@
   sizeof(PyTypeObject),
   #else
   sizeof(PyHeapTypeObject),
   #endif
   __Pyx_ImportType_CheckSize_Warn);
    if (!__pyx_ptype_7cpython_4type_type) __PYX_ERR(2, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 199, __pyx_L1_error)
+  __pyx_t_1 = PyImport_ImportModule("numpy"); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_ptype_5numpy_dtype = __Pyx_ImportType(__pyx_t_1, "numpy", "dtype", sizeof(PyArray_Descr), __Pyx_ImportType_CheckSize_Ignore);
-   if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(1, 199, __pyx_L1_error)
+   if (!__pyx_ptype_5numpy_dtype) __PYX_ERR(1, 200, __pyx_L1_error)
   __pyx_ptype_5numpy_flatiter = __Pyx_ImportType(__pyx_t_1, "numpy", "flatiter", sizeof(PyArrayIterObject), __Pyx_ImportType_CheckSize_Ignore);
-   if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(1, 222, __pyx_L1_error)
+   if (!__pyx_ptype_5numpy_flatiter) __PYX_ERR(1, 223, __pyx_L1_error)
   __pyx_ptype_5numpy_broadcast = __Pyx_ImportType(__pyx_t_1, "numpy", "broadcast", sizeof(PyArrayMultiIterObject), __Pyx_ImportType_CheckSize_Ignore);
-   if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(1, 226, __pyx_L1_error)
+   if (!__pyx_ptype_5numpy_broadcast) __PYX_ERR(1, 227, __pyx_L1_error)
   __pyx_ptype_5numpy_ndarray = __Pyx_ImportType(__pyx_t_1, "numpy", "ndarray", sizeof(PyArrayObject), __Pyx_ImportType_CheckSize_Ignore);
-   if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(1, 238, __pyx_L1_error)
+   if (!__pyx_ptype_5numpy_ndarray) __PYX_ERR(1, 239, __pyx_L1_error)
+  __pyx_ptype_5numpy_generic = __Pyx_ImportType(__pyx_t_1, "numpy", "generic", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_generic) __PYX_ERR(1, 771, __pyx_L1_error)
+  __pyx_ptype_5numpy_number = __Pyx_ImportType(__pyx_t_1, "numpy", "number", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_number) __PYX_ERR(1, 773, __pyx_L1_error)
+  __pyx_ptype_5numpy_integer = __Pyx_ImportType(__pyx_t_1, "numpy", "integer", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_integer) __PYX_ERR(1, 775, __pyx_L1_error)
+  __pyx_ptype_5numpy_signedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "signedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_signedinteger) __PYX_ERR(1, 777, __pyx_L1_error)
+  __pyx_ptype_5numpy_unsignedinteger = __Pyx_ImportType(__pyx_t_1, "numpy", "unsignedinteger", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_unsignedinteger) __PYX_ERR(1, 779, __pyx_L1_error)
+  __pyx_ptype_5numpy_inexact = __Pyx_ImportType(__pyx_t_1, "numpy", "inexact", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_inexact) __PYX_ERR(1, 781, __pyx_L1_error)
+  __pyx_ptype_5numpy_floating = __Pyx_ImportType(__pyx_t_1, "numpy", "floating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_floating) __PYX_ERR(1, 783, __pyx_L1_error)
+  __pyx_ptype_5numpy_complexfloating = __Pyx_ImportType(__pyx_t_1, "numpy", "complexfloating", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_complexfloating) __PYX_ERR(1, 785, __pyx_L1_error)
+  __pyx_ptype_5numpy_flexible = __Pyx_ImportType(__pyx_t_1, "numpy", "flexible", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_flexible) __PYX_ERR(1, 787, __pyx_L1_error)
+  __pyx_ptype_5numpy_character = __Pyx_ImportType(__pyx_t_1, "numpy", "character", sizeof(PyObject), __Pyx_ImportType_CheckSize_Warn);
+   if (!__pyx_ptype_5numpy_character) __PYX_ERR(1, 789, __pyx_L1_error)
   __pyx_ptype_5numpy_ufunc = __Pyx_ImportType(__pyx_t_1, "numpy", "ufunc", sizeof(PyUFuncObject), __Pyx_ImportType_CheckSize_Ignore);
-   if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(1, 764, __pyx_L1_error)
+   if (!__pyx_ptype_5numpy_ufunc) __PYX_ERR(1, 827, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -3963,19 +4266,17 @@
   if (__pyx_AsyncGen_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   #ifdef __Pyx_StopAsyncIteration_USED
   if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
   /*--- Library function declarations ---*/
   /*--- Threads initialization code ---*/
-  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
-  #ifdef WITH_THREAD /* Python build with threading support? */
+  #if defined(WITH_THREAD) && PY_VERSION_HEX < 0x030700F0 && defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
   PyEval_InitThreads();
   #endif
-  #endif
   /*--- Module creation code ---*/
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   __pyx_m = __pyx_pyinit_module;
   Py_INCREF(__pyx_m);
   #else
   #if PY_MAJOR_VERSION < 3
   __pyx_m = Py_InitModule4("cython_density", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
@@ -3992,22 +4293,22 @@
   Py_INCREF(__pyx_cython_runtime);
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_dadapy__cython___cython_density) {
+  if (__pyx_module_is_main_dadapy___cython__cython_density) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "dadapy.cython_.cython_density")) {
-      if (unlikely(PyDict_SetItemString(modules, "dadapy.cython_.cython_density", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "dadapy._cython.cython_density")) {
+      if (unlikely(PyDict_SetItemString(modules, "dadapy._cython.cython_density", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -4020,26 +4321,26 @@
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
-  /* "dadapy/cython_/cython_density.pyx":2
+  /* "dadapy/_cython/cython_density.pyx":2
  * import cython
  * import numpy as np             # <<<<<<<<<<<<<<
  * 
  * cimport numpy as np
  */
   __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":6
+  /* "dadapy/_cython/cython_density.pyx":6
  * cimport numpy as np
  * 
  * from scipy.special import gammaln             # <<<<<<<<<<<<<<
  * 
  * from libc.math cimport exp, log, pi, pow
  */
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
@@ -4052,114 +4353,99 @@
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_gammaln); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_gammaln, __pyx_t_1) < 0) __PYX_ERR(0, 6, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":10
+  /* "dadapy/_cython/cython_density.pyx":10
  * from libc.math cimport exp, log, pi, pow
  * 
- * DTYPE = np.int             # <<<<<<<<<<<<<<
- * floatTYPE = np.float
- * boolTYPE = np.bool
+ * DTYPE = np.int64             # <<<<<<<<<<<<<<
+ * floatTYPE = np.float64
+ * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":11
+  /* "dadapy/_cython/cython_density.pyx":11
+ * 
+ * DTYPE = np.int64
+ * floatTYPE = np.float64             # <<<<<<<<<<<<<<
  * 
- * DTYPE = np.int
- * floatTYPE = np.float             # <<<<<<<<<<<<<<
- * boolTYPE = np.bool
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":12
- * DTYPE = np.int
- * floatTYPE = np.float
- * boolTYPE = np.bool             # <<<<<<<<<<<<<<
- * 
- * ctypedef np.int_t DTYPE_t
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_bool); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_boolTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-
-  /* "dadapy/cython_/cython_density.pyx":21
+  /* "dadapy/_cython/cython_density.pyx":21
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                     DTYPE_t Nele,
  *                     DTYPE_t maxk,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7cython__14cython_density_1_compute_kstar, NULL, __pyx_n_s_dadapy_cython__cython_density); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_kstar, __pyx_t_1) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_14cython_density_1_compute_kstar, NULL, __pyx_n_s_dadapy__cython_cython_density); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_kstar, __pyx_t_2) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":54
+  /* "dadapy/_cython/cython_density.pyx":54
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _compute_kstar_interp(floatTYPE_t id_sel,             # <<<<<<<<<<<<<<
  *                           DTYPE_t Nele,
  *                           DTYPE_t maxk,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7cython__14cython_density_3_compute_kstar_interp, NULL, __pyx_n_s_dadapy_cython__cython_density); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_kstar_interp, __pyx_t_1) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_14cython_density_3_compute_kstar_interp, NULL, __pyx_n_s_dadapy__cython_cython_density); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_compute_kstar_interp, __pyx_t_2) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/cython_/cython_density.pyx":1
+  /* "dadapy/_cython/cython_density.pyx":1
  * import cython             # <<<<<<<<<<<<<<
  * import numpy as np
  * 
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "../../../../programs/anaconda3/envs/py37/lib/python3.7/site-packages/numpy/__init__.pxd":892
- *         raise ImportError("numpy.core.umath failed to import")
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
- * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
- *     try:
- *         _import_umath()
+ * 
+ * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
+ *     """
+ *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init dadapy.cython_.cython_density", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init dadapy._cython.cython_density", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init dadapy.cython_.cython_density");
+    PyErr_SetString(PyExc_ImportError, "init dadapy._cython.cython_density");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -4998,15 +5284,15 @@
     return __Pyx_GetBuiltinName(name);
 }
 
 /* PyObjectCall */
   #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
     PyObject *result;
-    ternaryfunc call = func->ob_type->tp_call;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
     if (unlikely(!call))
         return PyObject_Call(func, arg, kw);
     if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
         return NULL;
     result = (*call)(func, arg, kw);
     Py_LeaveRecursiveCall();
     if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
@@ -5240,15 +5526,15 @@
         return __Pyx_PyFunction_FastCall(func, &arg, 1);
     }
 #endif
     if (likely(PyCFunction_Check(func))) {
         if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
             return __Pyx_PyObject_CallMethO(func, arg);
 #if CYTHON_FAST_PYCCALL
-        } else if (PyCFunction_GET_FLAGS(func) & METH_FASTCALL) {
+        } else if (__Pyx_PyFastCFunction_Check(func)) {
             return __Pyx_PyCFunction_FastCall(func, &arg, 1);
 #endif
         }
     }
     return __Pyx__PyObject_CallOneArg(func, arg);
 }
 #else
@@ -5768,15 +6054,15 @@
       } else {
         PyErr_Clear();
         use_cline = NULL;
       }
     }
     if (!use_cline) {
         c_line = 0;
-        PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
+        (void) PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
     }
     else if (use_cline == Py_False || (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
         c_line = 0;
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
@@ -5862,41 +6148,48 @@
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
   #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
-    PyCodeObject *py_code = 0;
-    PyObject *py_srcfile = 0;
-    PyObject *py_funcname = 0;
+    PyCodeObject *py_code = NULL;
+    PyObject *py_funcname = NULL;
     #if PY_MAJOR_VERSION < 3
+    PyObject *py_srcfile = NULL;
     py_srcfile = PyString_FromString(filename);
-    #else
-    py_srcfile = PyUnicode_FromString(filename);
-    #endif
     if (!py_srcfile) goto bad;
+    #endif
     if (c_line) {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
         #else
         py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
+        funcname = PyUnicode_AsUTF8(py_funcname);
+        if (!funcname) goto bad;
         #endif
     }
     else {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromString(funcname);
-        #else
-        py_funcname = PyUnicode_FromString(funcname);
+        if (!py_funcname) goto bad;
         #endif
     }
-    if (!py_funcname) goto bad;
+    #if PY_MAJOR_VERSION < 3
     py_code = __Pyx_PyCode_New(
         0,
         0,
         0,
         0,
         0,
         __pyx_empty_bytes, /*PyObject *code,*/
@@ -5907,34 +6200,49 @@
         __pyx_empty_tuple, /*PyObject *cellvars,*/
         py_srcfile,   /*PyObject *filename,*/
         py_funcname,  /*PyObject *name,*/
         py_line,
         __pyx_empty_bytes  /*PyObject *lnotab*/
     );
     Py_DECREF(py_srcfile);
-    Py_DECREF(py_funcname);
+    #else
+    py_code = PyCode_NewEmpty(filename, funcname, py_line);
+    #endif
+    Py_XDECREF(py_funcname);  // XDECREF since it's only set on Py3 if cline
     return py_code;
 bad:
-    Py_XDECREF(py_srcfile);
     Py_XDECREF(py_funcname);
+    #if PY_MAJOR_VERSION < 3
+    Py_XDECREF(py_srcfile);
+    #endif
     return NULL;
 }
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyFrameObject *py_frame = 0;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject *ptype, *pvalue, *ptraceback;
     if (c_line) {
         c_line = __Pyx_CLineForTraceback(tstate, c_line);
     }
     py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
     if (!py_code) {
+        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
         py_code = __Pyx_CreateCodeObjectForTraceback(
             funcname, c_line, py_line, filename);
-        if (!py_code) goto bad;
+        if (!py_code) {
+            /* If the code object creation fails, then we should clear the
+               fetched exception references and propagate the new exception */
+            Py_XDECREF(ptype);
+            Py_XDECREF(pvalue);
+            Py_XDECREF(ptraceback);
+            goto bad;
+        }
+        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
         __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
     }
     py_frame = PyFrame_New(
         tstate,            /*PyThreadState *tstate,*/
         py_code,           /*PyCodeObject *code,*/
         __pyx_d,    /*PyObject *globals,*/
         0                  /*PyObject *locals*/
@@ -5985,45 +6293,14 @@
                 else\
                     goto raise_overflow;\
             }\
         }\
         return (target_type) value;\
     }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_long(npy_long value) {
-    const npy_long neg_one = (npy_long) ((npy_long) 0 - (npy_long) 1), const_zero = (npy_long) 0;
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(npy_long) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(npy_long) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_long) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(npy_long) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_long) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(npy_long),
-                                     little, !is_unsigned);
-    }
-}
-
 /* Declarations */
   #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
       return ::std::complex< float >(x, y);
     }
   #else
@@ -6326,15 +6603,22 @@
             return z;
         }
     #endif
 #endif
 
 /* CIntFromPy */
   static CYTHON_INLINE npy_long __Pyx_PyInt_As_npy_long(PyObject *x) {
-    const npy_long neg_one = (npy_long) ((npy_long) 0 - (npy_long) 1), const_zero = (npy_long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const npy_long neg_one = (npy_long) -1, const_zero = (npy_long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(npy_long) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(npy_long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -6514,16 +6798,61 @@
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to npy_long");
     return (npy_long) -1;
 }
 
 /* CIntToPy */
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_long(npy_long value) {
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const npy_long neg_one = (npy_long) -1, const_zero = (npy_long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
+    const int is_unsigned = neg_one > const_zero;
+    if (is_unsigned) {
+        if (sizeof(npy_long) < sizeof(long)) {
+            return PyInt_FromLong((long) value);
+        } else if (sizeof(npy_long) <= sizeof(unsigned long)) {
+            return PyLong_FromUnsignedLong((unsigned long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(npy_long) <= sizeof(unsigned PY_LONG_LONG)) {
+            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
+#endif
+        }
+    } else {
+        if (sizeof(npy_long) <= sizeof(long)) {
+            return PyInt_FromLong((long) value);
+#ifdef HAVE_LONG_LONG
+        } else if (sizeof(npy_long) <= sizeof(PY_LONG_LONG)) {
+            return PyLong_FromLongLong((PY_LONG_LONG) value);
+#endif
+        }
+    }
+    {
+        int one = 1; int little = (int)*(unsigned char *)&one;
+        unsigned char *bytes = (unsigned char *)&value;
+        return _PyLong_FromByteArray(bytes, sizeof(npy_long),
+                                     little, !is_unsigned);
+    }
+}
+
+/* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
         if (sizeof(long) < sizeof(long)) {
             return PyInt_FromLong((long) value);
         } else if (sizeof(long) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
@@ -6546,15 +6875,22 @@
         return _PyLong_FromByteArray(bytes, sizeof(long),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntFromPy */
   static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
-    const long neg_one = (long) ((long) 0 - (long) 1), const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const long neg_one = (long) -1, const_zero = (long) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(long) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -6735,15 +7071,22 @@
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to long");
     return (long) -1;
 }
 
 /* CIntFromPy */
   static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
-    const int neg_one = (int) ((int) 0 - (int) 1), const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wconversion"
+#endif
+    const int neg_one = (int) -1, const_zero = (int) 0;
+#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
+#pragma GCC diagnostic pop
+#endif
     const int is_unsigned = neg_one > const_zero;
 #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_Check(x))) {
         if (sizeof(int) < sizeof(long)) {
             __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
         } else {
             long val = PyInt_AS_LONG(x);
@@ -7024,19 +7367,41 @@
     }
     return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
 }
 #endif
 
 /* CheckBinaryVersion */
   static int __Pyx_check_binary_version(void) {
-    char ctversion[4], rtversion[4];
-    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
-    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
-    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
+    char ctversion[5];
+    int same=1, i, found_dot;
+    const char* rt_from_call = Py_GetVersion();
+    PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
+    found_dot = 0;
+    for (i = 0; i < 4; i++) {
+        if (!ctversion[i]) {
+            same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
+            break;
+        }
+        if (rt_from_call[i] != ctversion[i]) {
+            same = 0;
+            break;
+        }
+    }
+    if (!same) {
+        char rtversion[5] = {'\0'};
         char message[200];
+        for (i=0; i<4; ++i) {
+            if (rt_from_call[i] == '.') {
+                if (found_dot) break;
+                found_dot = 1;
+            } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
+                break;
+            }
+            rtversion[i] = rt_from_call[i];
+        }
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
@@ -7286,14 +7651,31 @@
   }
   x = PyNumber_Index(b);
   if (!x) return -1;
   ival = PyInt_AsSsize_t(x);
   Py_DECREF(x);
   return ival;
 }
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject* o) {
+  if (sizeof(Py_hash_t) == sizeof(Py_ssize_t)) {
+    return (Py_hash_t) __Pyx_PyIndex_AsSsize_t(o);
+#if PY_MAJOR_VERSION < 3
+  } else if (likely(PyInt_CheckExact(o))) {
+    return PyInt_AS_LONG(o);
+#endif
+  } else {
+    Py_ssize_t ival;
+    PyObject *x;
+    x = PyNumber_Index(o);
+    if (!x) return -1;
+    ival = PyInt_AsLong(x);
+    Py_DECREF(x);
+    return ival;
+  }
+}
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b) {
   return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
 }
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
     return PyInt_FromSize_t(ival);
 }
```

### Comparing `dadapy-0.1.1/dadapy/_cython/cython_maximum_likelihood_opt.c` & `dadapy-0.2.0/dadapy/_cython/cython_maximum_likelihood_opt.c`

 * *Files 3% similar despite different names*

```diff
@@ -1,33 +1,20 @@
-/* Generated by Cython 0.29.24 */
-
-/* BEGIN: Cython Metadata
-{
-    "distutils": {
-        "depends": [],
-        "name": "dadapy.cython_.cython_maximum_likelihood_opt",
-        "sources": [
-            "dadapy/cython_/cython_maximum_likelihood_opt.pyx"
-        ]
-    },
-    "module_name": "dadapy.cython_.cython_maximum_likelihood_opt"
-}
-END: Cython Metadata */
+/* Generated by Cython 0.29.30 */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_24"
-#define CYTHON_HEX_VERSION 0x001D18F0
+#define CYTHON_ABI "0_29_30"
+#define CYTHON_HEX_VERSION 0x001D1EF0
 #define CYTHON_FUTURE_DIVISION 0
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -94,14 +81,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC (PYPY_VERSION_HEX >= 0x07030900)
+  #endif
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -135,14 +125,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -166,53 +159,64 @@
   #endif
   #ifndef CYTHON_USE_PYLIST_INTERNALS
     #define CYTHON_USE_PYLIST_INTERNALS 1
   #endif
   #ifndef CYTHON_USE_UNICODE_INTERNALS
     #define CYTHON_USE_UNICODE_INTERNALS 1
   #endif
-  #if PY_VERSION_HEX < 0x030300F0
+  #if PY_VERSION_HEX < 0x030300F0 || PY_VERSION_HEX >= 0x030B00A2
     #undef CYTHON_USE_UNICODE_WRITER
     #define CYTHON_USE_UNICODE_WRITER 0
   #elif !defined(CYTHON_USE_UNICODE_WRITER)
     #define CYTHON_USE_UNICODE_WRITER 1
   #endif
   #ifndef CYTHON_AVOID_BORROWED_REFS
     #define CYTHON_AVOID_BORROWED_REFS 0
   #endif
   #ifndef CYTHON_ASSUME_SAFE_MACROS
     #define CYTHON_ASSUME_SAFE_MACROS 1
   #endif
   #ifndef CYTHON_UNPACK_METHODS
     #define CYTHON_UNPACK_METHODS 1
   #endif
-  #ifndef CYTHON_FAST_THREAD_STATE
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_FAST_THREAD_STATE
+    #define CYTHON_FAST_THREAD_STATE 0
+  #elif !defined(CYTHON_FAST_THREAD_STATE)
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
-    #define CYTHON_FAST_PYCALL 1
+    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
   #ifndef CYTHON_USE_DICT_VERSIONS
     #define CYTHON_USE_DICT_VERSIONS (PY_VERSION_HEX >= 0x030600B1)
   #endif
-  #ifndef CYTHON_USE_EXC_INFO_STACK
+  #if PY_VERSION_HEX >= 0x030B00A4
+    #undef CYTHON_USE_EXC_INFO_STACK
+    #define CYTHON_USE_EXC_INFO_STACK 0
+  #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
-  #include "longintrepr.h"
+  #if PY_MAJOR_VERSION < 3
+    #include "longintrepr.h"
+  #endif
   #undef SHIFT
   #undef BASE
   #undef MASK
   #ifdef SIZEOF_VOID_P
     enum { __pyx_check_sizeof_voidp = 1 / (int)(SIZEOF_VOID_P == sizeof(void*)) };
   #endif
 #endif
@@ -321,17 +325,76 @@
 #if PY_MAJOR_VERSION < 3
   #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
   #define __Pyx_DefaultClassType PyClass_Type
 #else
   #define __Pyx_BUILTIN_MODULE_NAME "builtins"
-#if PY_VERSION_HEX >= 0x030800A4 && PY_VERSION_HEX < 0x030800B2
-  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
-          PyCode_New(a, 0, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
+  #define __Pyx_DefaultClassType PyType_Type
+#if PY_VERSION_HEX >= 0x030B00A1
+    static CYTHON_INLINE PyCodeObject* __Pyx_PyCode_New(int a, int k, int l, int s, int f,
+                                                    PyObject *code, PyObject *c, PyObject* n, PyObject *v,
+                                                    PyObject *fv, PyObject *cell, PyObject* fn,
+                                                    PyObject *name, int fline, PyObject *lnos) {
+        PyObject *kwds=NULL, *argcount=NULL, *posonlyargcount=NULL, *kwonlyargcount=NULL;
+        PyObject *nlocals=NULL, *stacksize=NULL, *flags=NULL, *replace=NULL, *call_result=NULL, *empty=NULL;
+        const char *fn_cstr=NULL;
+        const char *name_cstr=NULL;
+        PyCodeObject* co=NULL;
+        PyObject *type, *value, *traceback;
+        PyErr_Fetch(&type, &value, &traceback);
+        if (!(kwds=PyDict_New())) goto end;
+        if (!(argcount=PyLong_FromLong(a))) goto end;
+        if (PyDict_SetItemString(kwds, "co_argcount", argcount) != 0) goto end;
+        if (!(posonlyargcount=PyLong_FromLong(0))) goto end;
+        if (PyDict_SetItemString(kwds, "co_posonlyargcount", posonlyargcount) != 0) goto end;
+        if (!(kwonlyargcount=PyLong_FromLong(k))) goto end;
+        if (PyDict_SetItemString(kwds, "co_kwonlyargcount", kwonlyargcount) != 0) goto end;
+        if (!(nlocals=PyLong_FromLong(l))) goto end;
+        if (PyDict_SetItemString(kwds, "co_nlocals", nlocals) != 0) goto end;
+        if (!(stacksize=PyLong_FromLong(s))) goto end;
+        if (PyDict_SetItemString(kwds, "co_stacksize", stacksize) != 0) goto end;
+        if (!(flags=PyLong_FromLong(f))) goto end;
+        if (PyDict_SetItemString(kwds, "co_flags", flags) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_code", code) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_consts", c) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_names", n) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_varnames", v) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_freevars", fv) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_cellvars", cell) != 0) goto end;
+        if (PyDict_SetItemString(kwds, "co_linetable", lnos) != 0) goto end;
+        if (!(fn_cstr=PyUnicode_AsUTF8AndSize(fn, NULL))) goto end;
+        if (!(name_cstr=PyUnicode_AsUTF8AndSize(name, NULL))) goto end;
+        if (!(co = PyCode_NewEmpty(fn_cstr, name_cstr, fline))) goto end;
+        if (!(replace = PyObject_GetAttrString((PyObject*)co, "replace"))) goto cleanup_code_too;
+        if (!(empty = PyTuple_New(0))) goto cleanup_code_too; // unfortunately __pyx_empty_tuple isn't available here
+        if (!(call_result = PyObject_Call(replace, empty, kwds))) goto cleanup_code_too;
+        Py_XDECREF((PyObject*)co);
+        co = (PyCodeObject*)call_result;
+        call_result = NULL;
+        if (0) {
+            cleanup_code_too:
+            Py_XDECREF((PyObject*)co);
+            co = NULL;
+        }
+        end:
+        Py_XDECREF(kwds);
+        Py_XDECREF(argcount);
+        Py_XDECREF(posonlyargcount);
+        Py_XDECREF(kwonlyargcount);
+        Py_XDECREF(nlocals);
+        Py_XDECREF(stacksize);
+        Py_XDECREF(replace);
+        Py_XDECREF(call_result);
+        Py_XDECREF(empty);
+        if (type) {
+            PyErr_Restore(type, value, traceback);
+        }
+        return co;
+    }
 #else
   #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
           PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
 #endif
   #define __Pyx_DefaultClassType PyType_Type
 #endif
 #ifndef Py_TPFLAGS_CHECKTYPES
@@ -561,18 +624,18 @@
   #ifndef PyUnicode_InternFromString
     #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
   #endif
 #endif
 #if PY_VERSION_HEX < 0x030200A4
   typedef long Py_hash_t;
   #define __Pyx_PyInt_FromHash_t PyInt_FromLong
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsHash_t
 #else
   #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
-  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
+  #define __Pyx_PyInt_AsHash_t   __Pyx_PyIndex_AsSsize_t
 #endif
 #if PY_MAJOR_VERSION >= 3
   #define __Pyx_PyMethod_New(func, self, klass) ((self) ? ((void)(klass), PyMethod_New(func, self)) : __Pyx_NewRef(func))
 #else
   #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
 #endif
 #if CYTHON_USE_ASYNC_SLOTS
@@ -589,16 +652,18 @@
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
 
-#if defined(WIN32) || defined(MS_WINDOWS)
-  #define _USE_MATH_DEFINES
+#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
+  #if !defined(_USE_MATH_DEFINES)
+    #define _USE_MATH_DEFINES
+  #endif
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
 #else
 static CYTHON_INLINE float __PYX_NAN() {
   float value;
@@ -621,16 +686,16 @@
   #ifdef __cplusplus
     #define __PYX_EXTERN_C extern "C"
   #else
     #define __PYX_EXTERN_C extern
   #endif
 #endif
 
-#define __PYX_HAVE__dadapy__cython___cython_maximum_likelihood_opt
-#define __PYX_HAVE_API__dadapy__cython___cython_maximum_likelihood_opt
+#define __PYX_HAVE__dadapy___cython__cython_maximum_likelihood_opt
+#define __PYX_HAVE_API__dadapy___cython__cython_maximum_likelihood_opt
 /* Early includes */
 #include <string.h>
 #include <stdio.h>
 #include "numpy/arrayobject.h"
 #include "numpy/ndarrayobject.h"
 #include "numpy/ndarraytypes.h"
 #include "numpy/arrayscalars.h"
@@ -731,14 +796,15 @@
 static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
 static CYTHON_INLINE int __Pyx_PyObject_IsTrueAndDecref(PyObject*);
 static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
 #define __Pyx_PySequence_Tuple(obj)\
     (likely(PyTuple_CheckExact(obj)) ? __Pyx_NewRef(obj) : PySequence_Tuple(obj))
 static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject*);
 #if CYTHON_ASSUME_SAFE_MACROS
 #define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
 #else
 #define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
 #endif
 #define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
 #if PY_MAJOR_VERSION >= 3
@@ -865,15 +931,15 @@
 #if CYTHON_CCOMPLEX && !defined(__cplusplus) && defined(__sun__) && defined(__GNUC__)
   #undef _Complex_I
   #define _Complex_I 1.0fj
 #endif
 
 
 static const char *__pyx_f[] = {
-  "dadapy/cython_/cython_maximum_likelihood_opt.pyx",
+  "cython_maximum_likelihood_opt.pyx",
   "__init__.pxd",
   "type.pxd",
 };
 /* BufferFormatStructs.proto */
 #define IS_UNSIGNED(type) (((type) -1) > 0)
 struct __Pyx_StructField_;
 #define __PYX_BUF_FLAGS_PACKED_STRUCT (1 << 0)
@@ -906,220 +972,220 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":690
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":691
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":693
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":693
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":697
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":698
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":700
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":700
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":704
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":705
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":705
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":714
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":715
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":716
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":716
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":718
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":719
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":720
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":720
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":722
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":723
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":723
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":725
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":726
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":727
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":727
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
-/* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":11
- * boolTYPE = np.bool
+/* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":13
+ * 
  * 
  * ctypedef np.int_t DTYPE_t             # <<<<<<<<<<<<<<
  * ctypedef np.float64_t floatTYPE_t
  * 
  */
-typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t;
+typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t;
 
-/* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":12
+/* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":14
  * 
  * ctypedef np.int_t DTYPE_t
  * ctypedef np.float64_t floatTYPE_t             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False)
  */
-typedef __pyx_t_5numpy_float64_t __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t;
+typedef __pyx_t_5numpy_float64_t __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -1139,42 +1205,42 @@
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":730
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":731
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":731
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":733
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":733
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -1393,21 +1459,29 @@
 #define __Pyx_PyFunction_FastCallDict(func, args, nargs, kwargs) _PyFunction_FastCallDict(func, args, nargs, kwargs)
 #endif
 #define __Pyx_BUILD_ASSERT_EXPR(cond)\
     (sizeof(char [1 - 2*!(cond)]) - 1)
 #ifndef Py_MEMBER_SIZE
 #define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
 #endif
+#if CYTHON_FAST_PYCALL
   static size_t __pyx_pyframe_localsplus_offset = 0;
   #include "frameobject.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
   #define __Pxy_PyFrame_Initialize_Offsets()\
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
+#endif // CYTHON_FAST_PYCALL
 #endif
 
 /* PyObjectCall.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
 #else
 #define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
@@ -1765,21 +1839,21 @@
 static PyTypeObject *__pyx_ptype_5numpy_complexfloating = 0;
 static PyTypeObject *__pyx_ptype_5numpy_flexible = 0;
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'libc.math' */
 
-/* Module declarations from 'dadapy.cython_.cython_maximum_likelihood_opt' */
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t = { "floatTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t), { 0 }, 0, 'R', 0, 0 };
-#define __Pyx_MODULE_NAME "dadapy.cython_.cython_maximum_likelihood_opt"
-extern int __pyx_module_is_main_dadapy__cython___cython_maximum_likelihood_opt;
-int __pyx_module_is_main_dadapy__cython___cython_maximum_likelihood_opt = 0;
+/* Module declarations from 'dadapy._cython.cython_maximum_likelihood_opt' */
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t = { "floatTYPE_t", NULL, sizeof(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t), { 0 }, 0, 'R', 0, 0 };
+#define __Pyx_MODULE_NAME "dadapy._cython.cython_maximum_likelihood_opt"
+extern int __pyx_module_is_main_dadapy___cython__cython_maximum_likelihood_opt;
+int __pyx_module_is_main_dadapy___cython__cython_maximum_likelihood_opt = 0;
 
-/* Implementation of 'dadapy.cython_.cython_maximum_likelihood_opt' */
+/* Implementation of 'dadapy._cython.cython_maximum_likelihood_opt' */
 static PyObject *__pyx_builtin_range;
 static PyObject *__pyx_builtin_ImportError;
 static const char __pyx_k_A[] = "A";
 static const char __pyx_k_B[] = "B";
 static const char __pyx_k_a[] = "a";
 static const char __pyx_k_b[] = "b";
 static const char __pyx_k_j[] = "j";
@@ -1791,73 +1865,69 @@
 static const char __pyx_k_jf[] = "jf";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_sa[] = "sa";
 static const char __pyx_k_sb[] = "sb";
 static const char __pyx_k_tt[] = "tt";
 static const char __pyx_k_vi[] = "vi";
 static const char __pyx_k_eps[] = "eps";
-static const char __pyx_k_int[] = "int";
 static const char __pyx_k_Cov2[] = "Cov2";
-static const char __pyx_k_bool[] = "bool";
 static const char __pyx_k_func[] = "func";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_time[] = "time";
 static const char __pyx_k_DTYPE[] = "DTYPE";
 static const char __pyx_k_finfo[] = "finfo";
-static const char __pyx_k_float[] = "float";
+static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_niter[] = "niter";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_rinit[] = "rinit";
 static const char __pyx_k_sigma[] = "sigma";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_detinv[] = "detinv";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_nrmaxl[] = "_nrmaxl";
 static const char __pyx_k_Covinv2[] = "Covinv2";
+static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_kstar_i[] = "kstar_i";
 static const char __pyx_k_matinv2[] = "_matinv2";
 static const char __pyx_k_stepmax[] = "stepmax";
-static const char __pyx_k_boolTYPE[] = "boolTYPE";
 static const char __pyx_k_fepsilon[] = "fepsilon";
 static const char __pyx_k_floatTYPE[] = "floatTYPE";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_nrmaxl_locals__matinv2[] = "_nrmaxl.<locals>._matinv2";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
-static const char __pyx_k_dadapy_cython__cython_maximum_li[] = "dadapy/cython_/cython_maximum_likelihood_opt.pyx";
+static const char __pyx_k_cython_maximum_likelihood_opt_py[] = "cython_maximum_likelihood_opt.pyx";
+static const char __pyx_k_dadapy__cython_cython_maximum_li[] = "dadapy._cython.cython_maximum_likelihood_opt";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
-static const char __pyx_k_dadapy_cython__cython_maximum_li_2[] = "dadapy.cython_.cython_maximum_likelihood_opt";
 static PyObject *__pyx_n_s_A;
 static PyObject *__pyx_n_s_B;
 static PyObject *__pyx_n_s_Cov2;
 static PyObject *__pyx_n_s_Covinv2;
 static PyObject *__pyx_n_s_DTYPE;
 static PyObject *__pyx_n_s_ImportError;
 static PyObject *__pyx_n_s_L0;
 static PyObject *__pyx_n_s_a;
 static PyObject *__pyx_n_s_b;
-static PyObject *__pyx_n_s_bool;
-static PyObject *__pyx_n_s_boolTYPE;
 static PyObject *__pyx_n_s_cline_in_traceback;
-static PyObject *__pyx_kp_s_dadapy_cython__cython_maximum_li;
-static PyObject *__pyx_n_s_dadapy_cython__cython_maximum_li_2;
+static PyObject *__pyx_kp_s_cython_maximum_likelihood_opt_py;
+static PyObject *__pyx_n_s_dadapy__cython_cython_maximum_li;
 static PyObject *__pyx_n_s_detinv;
 static PyObject *__pyx_n_s_eps;
 static PyObject *__pyx_n_s_fepsilon;
 static PyObject *__pyx_n_s_finfo;
-static PyObject *__pyx_n_s_float;
+static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_floatTYPE;
 static PyObject *__pyx_n_s_func;
 static PyObject *__pyx_n_s_ga;
 static PyObject *__pyx_n_s_gb;
 static PyObject *__pyx_n_s_import;
-static PyObject *__pyx_n_s_int;
+static PyObject *__pyx_n_s_int64;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_jf;
 static PyObject *__pyx_n_s_kstar_i;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_matinv2;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_niter;
@@ -1876,40 +1946,40 @@
 static PyObject *__pyx_n_s_stepmax;
 static PyObject *__pyx_n_s_t;
 static PyObject *__pyx_n_s_test;
 static PyObject *__pyx_n_s_time;
 static PyObject *__pyx_n_s_tt;
 static PyObject *__pyx_n_s_vi;
 static PyObject *__pyx_n_s_zeros;
-static PyObject *__pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_A, PyArrayObject *__pyx_v_B); /* proto */
-static PyObject *__pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt__nrmaxl(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit, __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i, PyArrayObject *__pyx_v_vi); /* proto */
+static PyObject *__pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_A, PyArrayObject *__pyx_v_B); /* proto */
+static PyObject *__pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt__nrmaxl(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit, __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i, PyArrayObject *__pyx_v_vi); /* proto */
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__2;
 static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__6;
 static PyObject *__pyx_codeobj__3;
 static PyObject *__pyx_codeobj__7;
 /* Late includes */
 
-/* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":16
+/* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(floatTYPE_t rinit,             # <<<<<<<<<<<<<<
  *             DTYPE_t kstar_i,
  *             np.ndarray[floatTYPE_t, ndim = 1] vi):
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_1_nrmaxl(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_6dadapy_7cython__29cython_maximum_likelihood_opt_1_nrmaxl = {"_nrmaxl", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_1_nrmaxl, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_1_nrmaxl(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i;
+static PyObject *__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_1_nrmaxl(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_6dadapy_7_cython_29cython_maximum_likelihood_opt_1_nrmaxl = {"_nrmaxl", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_1_nrmaxl, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_1_nrmaxl(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i;
   PyArrayObject *__pyx_v_vi = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_nrmaxl (wrapper)", 0);
@@ -1934,69 +2004,69 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rinit)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kstar_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, 1); __PYX_ERR(0, 16, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, 1); __PYX_ERR(0, 18, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_vi)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, 2); __PYX_ERR(0, 16, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, 2); __PYX_ERR(0, 18, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_nrmaxl") < 0)) __PYX_ERR(0, 16, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_nrmaxl") < 0)) __PYX_ERR(0, 18, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
-    __pyx_v_rinit = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_rinit == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 16, __pyx_L3_error)
-    __pyx_v_kstar_i = __Pyx_PyInt_As_npy_long(values[1]); if (unlikely((__pyx_v_kstar_i == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 17, __pyx_L3_error)
+    __pyx_v_rinit = __pyx_PyFloat_AsDouble(values[0]); if (unlikely((__pyx_v_rinit == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 18, __pyx_L3_error)
+    __pyx_v_kstar_i = __Pyx_PyInt_As_npy_long(values[1]); if (unlikely((__pyx_v_kstar_i == ((npy_long)-1)) && PyErr_Occurred())) __PYX_ERR(0, 19, __pyx_L3_error)
     __pyx_v_vi = ((PyArrayObject *)values[2]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 16, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_nrmaxl", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 18, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("dadapy.cython_.cython_maximum_likelihood_opt._nrmaxl", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_maximum_likelihood_opt._nrmaxl", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_vi), __pyx_ptype_5numpy_ndarray, 1, "vi", 0))) __PYX_ERR(0, 18, __pyx_L1_error)
-  __pyx_r = __pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt__nrmaxl(__pyx_self, __pyx_v_rinit, __pyx_v_kstar_i, __pyx_v_vi);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_vi), __pyx_ptype_5numpy_ndarray, 1, "vi", 0))) __PYX_ERR(0, 20, __pyx_L1_error)
+  __pyx_r = __pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt__nrmaxl(__pyx_self, __pyx_v_rinit, __pyx_v_kstar_i, __pyx_v_vi);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":32
+/* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":34
  * 
  *     #useful subroutine
  *     def _matinv2(np.ndarray[floatTYPE_t, ndim = 2] A, np.ndarray[floatTYPE_t, ndim = 2] B):             # <<<<<<<<<<<<<<
  *     # Performs a direct calculation of the inverse of a 22 matrix.
  *         cdef floatTYPE_t detinv
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2 = {"_matinv2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2 = {"_matinv2", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyArrayObject *__pyx_v_A = 0;
   PyArrayObject *__pyx_v_B = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -2020,52 +2090,52 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_A)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_B)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_matinv2", 1, 2, 2, 1); __PYX_ERR(0, 32, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_matinv2", 1, 2, 2, 1); __PYX_ERR(0, 34, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_matinv2") < 0)) __PYX_ERR(0, 32, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_matinv2") < 0)) __PYX_ERR(0, 34, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_A = ((PyArrayObject *)values[0]);
     __pyx_v_B = ((PyArrayObject *)values[1]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_matinv2", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 32, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_matinv2", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 34, __pyx_L3_error)
   __pyx_L3_error:;
-  __Pyx_AddTraceback("dadapy.cython_.cython_maximum_likelihood_opt._nrmaxl._matinv2", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_maximum_likelihood_opt._nrmaxl._matinv2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_A), __pyx_ptype_5numpy_ndarray, 1, "A", 0))) __PYX_ERR(0, 32, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_B), __pyx_ptype_5numpy_ndarray, 1, "B", 0))) __PYX_ERR(0, 32, __pyx_L1_error)
-  __pyx_r = __pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_self, __pyx_v_A, __pyx_v_B);
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_A), __pyx_ptype_5numpy_ndarray, 1, "A", 0))) __PYX_ERR(0, 34, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_B), __pyx_ptype_5numpy_ndarray, 1, "B", 0))) __PYX_ERR(0, 34, __pyx_L1_error)
+  __pyx_r = __pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_self, __pyx_v_A, __pyx_v_B);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_A, PyArrayObject *__pyx_v_B) {
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_detinv;
+static PyObject *__pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_A, PyArrayObject *__pyx_v_B) {
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_detinv;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_A;
   __Pyx_Buffer __pyx_pybuffer_A;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_B;
   __Pyx_Buffer __pyx_pybuffer_B;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   Py_ssize_t __pyx_t_1;
@@ -2086,24 +2156,24 @@
   __pyx_pybuffernd_A.rcbuffer = &__pyx_pybuffer_A;
   __pyx_pybuffer_B.pybuffer.buf = NULL;
   __pyx_pybuffer_B.refcount = 0;
   __pyx_pybuffernd_B.data = NULL;
   __pyx_pybuffernd_B.rcbuffer = &__pyx_pybuffer_B;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_A.rcbuffer->pybuffer, (PyObject*)__pyx_v_A, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 32, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_A.rcbuffer->pybuffer, (PyObject*)__pyx_v_A, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 34, __pyx_L1_error)
   }
   __pyx_pybuffernd_A.diminfo[0].strides = __pyx_pybuffernd_A.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_A.diminfo[0].shape = __pyx_pybuffernd_A.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_A.diminfo[1].strides = __pyx_pybuffernd_A.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_A.diminfo[1].shape = __pyx_pybuffernd_A.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_B.rcbuffer->pybuffer, (PyObject*)__pyx_v_B, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 32, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_B.rcbuffer->pybuffer, (PyObject*)__pyx_v_B, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 34, __pyx_L1_error)
   }
   __pyx_pybuffernd_B.diminfo[0].strides = __pyx_pybuffernd_B.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_B.diminfo[0].shape = __pyx_pybuffernd_B.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_B.diminfo[1].strides = __pyx_pybuffernd_B.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_B.diminfo[1].shape = __pyx_pybuffernd_B.rcbuffer->pybuffer.shape[1];
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":37
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":39
  *         #cdef np.ndarray[floatTYPE_t, ndim = 2] B = np.zeros((2, 2))
  * 
  *         detinv = 1./(A[0,0]*A[1,1] - A[0,1]*A[1,0])             # <<<<<<<<<<<<<<
  *         B[0,0] = +detinv * A[1,1]
  *         B[1,0] = -detinv * A[1,0]
  */
   __pyx_t_1 = 0;
@@ -2118,85 +2188,85 @@
   __pyx_t_6 = 1;
   if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_pybuffernd_A.diminfo[1].shape;
   __pyx_t_7 = 1;
   __pyx_t_8 = 0;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_pybuffernd_A.diminfo[1].shape;
-  __pyx_v_detinv = (1. / (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_2, __pyx_pybuffernd_A.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_A.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_A.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)))));
+  __pyx_v_detinv = (1. / (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_2, __pyx_pybuffernd_A.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_3, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_A.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_A.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)))));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":38
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":40
  * 
  *         detinv = 1./(A[0,0]*A[1,1] - A[0,1]*A[1,0])
  *         B[0,0] = +detinv * A[1,1]             # <<<<<<<<<<<<<<
  *         B[1,0] = -detinv * A[1,0]
  *         B[0,1] = -detinv * A[0,1]
  */
   __pyx_t_8 = 1;
   __pyx_t_7 = 1;
   if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_pybuffernd_A.diminfo[1].shape;
   __pyx_t_6 = 0;
   __pyx_t_5 = 0;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_pybuffernd_B.diminfo[0].shape;
   if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_pybuffernd_B.diminfo[1].shape;
-  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_5, __pyx_pybuffernd_B.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_A.diminfo[1].strides)));
+  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_5, __pyx_pybuffernd_B.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_A.diminfo[1].strides)));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":39
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":41
  *         detinv = 1./(A[0,0]*A[1,1] - A[0,1]*A[1,0])
  *         B[0,0] = +detinv * A[1,1]
  *         B[1,0] = -detinv * A[1,0]             # <<<<<<<<<<<<<<
  *         B[0,1] = -detinv * A[0,1]
  *         B[1,1] = +detinv * A[0,0]
  */
   __pyx_t_7 = 1;
   __pyx_t_8 = 0;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_pybuffernd_A.diminfo[1].shape;
   __pyx_t_5 = 1;
   __pyx_t_6 = 0;
   if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_pybuffernd_B.diminfo[0].shape;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_pybuffernd_B.diminfo[1].shape;
-  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_B.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)));
+  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_B.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":40
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":42
  *         B[0,0] = +detinv * A[1,1]
  *         B[1,0] = -detinv * A[1,0]
  *         B[0,1] = -detinv * A[0,1]             # <<<<<<<<<<<<<<
  *         B[1,1] = +detinv * A[0,0]
  * 
  */
   __pyx_t_8 = 0;
   __pyx_t_7 = 1;
   if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_pybuffernd_A.diminfo[1].shape;
   __pyx_t_6 = 0;
   __pyx_t_5 = 1;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_pybuffernd_B.diminfo[0].shape;
   if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_pybuffernd_B.diminfo[1].shape;
-  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_5, __pyx_pybuffernd_B.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_A.diminfo[1].strides)));
+  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_5, __pyx_pybuffernd_B.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_A.diminfo[1].strides)));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":41
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":43
  *         B[1,0] = -detinv * A[1,0]
  *         B[0,1] = -detinv * A[0,1]
  *         B[1,1] = +detinv * A[0,0]             # <<<<<<<<<<<<<<
  * 
  *     # function
  */
   __pyx_t_7 = 0;
   __pyx_t_8 = 0;
   if (__pyx_t_7 < 0) __pyx_t_7 += __pyx_pybuffernd_A.diminfo[0].shape;
   if (__pyx_t_8 < 0) __pyx_t_8 += __pyx_pybuffernd_A.diminfo[1].shape;
   __pyx_t_5 = 1;
   __pyx_t_6 = 1;
   if (__pyx_t_5 < 0) __pyx_t_5 += __pyx_pybuffernd_B.diminfo[0].shape;
   if (__pyx_t_6 < 0) __pyx_t_6 += __pyx_pybuffernd_B.diminfo[1].shape;
-  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_B.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)));
+  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_B.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_B.diminfo[0].strides, __pyx_t_6, __pyx_pybuffernd_B.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_A.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_A.diminfo[0].strides, __pyx_t_8, __pyx_pybuffernd_A.diminfo[1].strides)));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":32
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":34
  * 
  *     #useful subroutine
  *     def _matinv2(np.ndarray[floatTYPE_t, ndim = 2] A, np.ndarray[floatTYPE_t, ndim = 2] B):             # <<<<<<<<<<<<<<
  *     # Performs a direct calculation of the inverse of a 22 matrix.
  *         cdef floatTYPE_t detinv
  */
 
@@ -2207,72 +2277,72 @@
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_A.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_B.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("dadapy.cython_.cython_maximum_likelihood_opt._nrmaxl._matinv2", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_maximum_likelihood_opt._nrmaxl._matinv2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_A.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_B.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":16
+/* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(floatTYPE_t rinit,             # <<<<<<<<<<<<<<
  *             DTYPE_t kstar_i,
  *             np.ndarray[floatTYPE_t, ndim = 1] vi):
  */
 
-static PyObject *__pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt__nrmaxl(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit, __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i, PyArrayObject *__pyx_v_vi) {
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_j;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_niter;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_a;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_b;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_L0;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_stepmax;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_ga;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_gb;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_jf;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_t;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_s;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_tt;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_func;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sigma;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sa;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sb;
+static PyObject *__pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt__nrmaxl(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_rinit, __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_kstar_i, PyArrayObject *__pyx_v_vi) {
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_j;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_v_niter;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_a;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_b;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_L0;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_stepmax;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_ga;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_gb;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_jf;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_t;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_s;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_tt;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_func;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sigma;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sa;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_sb;
   PyArrayObject *__pyx_v_Cov2 = 0;
   PyArrayObject *__pyx_v_Covinv2 = 0;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_fepsilon;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_v_fepsilon;
   PyObject *__pyx_v__matinv2 = 0;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_Cov2;
   __Pyx_Buffer __pyx_pybuffer_Cov2;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_Covinv2;
   __Pyx_Buffer __pyx_pybuffer_Covinv2;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_vi;
   __Pyx_Buffer __pyx_pybuffer_vi;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyArrayObject *__pyx_t_4 = NULL;
   PyArrayObject *__pyx_t_5 = NULL;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t __pyx_t_6;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_7;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_8;
-  __pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_9;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t __pyx_t_6;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_7;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_8;
+  __pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_DTYPE_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   int __pyx_t_14;
   int __pyx_t_15;
   double __pyx_t_16;
@@ -2292,376 +2362,376 @@
   __pyx_pybuffernd_Covinv2.rcbuffer = &__pyx_pybuffer_Covinv2;
   __pyx_pybuffer_vi.pybuffer.buf = NULL;
   __pyx_pybuffer_vi.refcount = 0;
   __pyx_pybuffernd_vi.data = NULL;
   __pyx_pybuffernd_vi.rcbuffer = &__pyx_pybuffer_vi;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_vi.rcbuffer->pybuffer, (PyObject*)__pyx_v_vi, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 16, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_vi.rcbuffer->pybuffer, (PyObject*)__pyx_v_vi, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 18, __pyx_L1_error)
   }
   __pyx_pybuffernd_vi.diminfo[0].strides = __pyx_pybuffernd_vi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_vi.diminfo[0].shape = __pyx_pybuffernd_vi.rcbuffer->pybuffer.shape[0];
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":25
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":27
  *     cdef floatTYPE_t a,b,L0,stepmax,ga,gb,jf,t,s,tt,func,sigma,sa,sb
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Cov2 = np.zeros((2, 2))             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Covinv2 = np.zeros((2, 2))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_tuple_) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_tuple_);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 25, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 27, __pyx_L1_error)
   __pyx_t_4 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Cov2.rcbuffer->pybuffer, (PyObject*)__pyx_t_4, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Cov2.rcbuffer->pybuffer, (PyObject*)__pyx_t_4, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Cov2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 25, __pyx_L1_error)
+      __PYX_ERR(0, 27, __pyx_L1_error)
     } else {__pyx_pybuffernd_Cov2.diminfo[0].strides = __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Cov2.diminfo[0].shape = __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Cov2.diminfo[1].strides = __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Cov2.diminfo[1].shape = __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_4 = 0;
   __pyx_v_Cov2 = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":26
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":28
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Cov2 = np.zeros((2, 2))
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Covinv2 = np.zeros((2, 2))             # <<<<<<<<<<<<<<
  * 
  *     cdef floatTYPE_t fepsilon=np.finfo(float).eps
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 26, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_tuple_) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_tuple_);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 26, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 28, __pyx_L1_error)
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Covinv2.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Covinv2.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Covinv2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 26, __pyx_L1_error)
+      __PYX_ERR(0, 28, __pyx_L1_error)
     } else {__pyx_pybuffernd_Covinv2.diminfo[0].strides = __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Covinv2.diminfo[0].shape = __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Covinv2.diminfo[1].strides = __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Covinv2.diminfo[1].shape = __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_5 = 0;
   __pyx_v_Covinv2 = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":28
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":30
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Covinv2 = np.zeros((2, 2))
  * 
  *     cdef floatTYPE_t fepsilon=np.finfo(float).eps             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_finfo); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_finfo); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, ((PyObject *)(&PyFloat_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)(&PyFloat_Type)));
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_eps); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_eps); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_6 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_6 == ((npy_float64)-1)) && PyErr_Occurred())) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_fepsilon = __pyx_t_6;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":32
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":34
  * 
  *     #useful subroutine
  *     def _matinv2(np.ndarray[floatTYPE_t, ndim = 2] A, np.ndarray[floatTYPE_t, ndim = 2] B):             # <<<<<<<<<<<<<<
  *     # Performs a direct calculation of the inverse of a 22 matrix.
  *         cdef floatTYPE_t detinv
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2, 0, __pyx_n_s_nrmaxl_locals__matinv2, NULL, __pyx_n_s_dadapy_cython__cython_maximum_li_2, __pyx_d, ((PyObject *)__pyx_codeobj__3)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl_1_matinv2, 0, __pyx_n_s_nrmaxl_locals__matinv2, NULL, __pyx_n_s_dadapy__cython_cython_maximum_li, __pyx_d, ((PyObject *)__pyx_codeobj__3)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v__matinv2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":44
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":46
  * 
  *     # function
  *     b=rinit             # <<<<<<<<<<<<<<
  *     L0=0.
  *     a=0.
  */
   __pyx_v_b = __pyx_v_rinit;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":45
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":47
  *     # function
  *     b=rinit
  *     L0=0.             # <<<<<<<<<<<<<<
  *     a=0.
  *     stepmax=0.1*abs(b)
  */
   __pyx_v_L0 = 0.;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":46
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":48
  *     b=rinit
  *     L0=0.
  *     a=0.             # <<<<<<<<<<<<<<
  *     stepmax=0.1*abs(b)
  *     gb=float(kstar_i)
  */
   __pyx_v_a = 0.;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":47
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":49
  *     L0=0.
  *     a=0.
  *     stepmax=0.1*abs(b)             # <<<<<<<<<<<<<<
  *     gb=float(kstar_i)
  *     ga= float(kstar_i + 1) * float(kstar_i) / 2.
  */
   __pyx_v_stepmax = (0.1 * fabs(__pyx_v_b));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":48
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":50
  *     a=0.
  *     stepmax=0.1*abs(b)
  *     gb=float(kstar_i)             # <<<<<<<<<<<<<<
  *     ga= float(kstar_i + 1) * float(kstar_i) / 2.
  * 
  */
   __pyx_v_gb = ((double)__pyx_v_kstar_i);
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":49
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":51
  *     stepmax=0.1*abs(b)
  *     gb=float(kstar_i)
  *     ga= float(kstar_i + 1) * float(kstar_i) / 2.             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_v_ga = ((((double)(__pyx_v_kstar_i + 1)) * ((double)__pyx_v_kstar_i)) / 2.);
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":52
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":54
  * 
  * 
  *     for j in range(kstar_i):             # <<<<<<<<<<<<<<
  *         jf=float(j+1)
  *         t=b+a*jf
  */
   __pyx_t_7 = __pyx_v_kstar_i;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_j = __pyx_t_9;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":53
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":55
  * 
  *     for j in range(kstar_i):
  *         jf=float(j+1)             # <<<<<<<<<<<<<<
  *         t=b+a*jf
  *         s=exp(t)
  */
     __pyx_v_jf = ((double)(__pyx_v_j + 1));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":54
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":56
  *     for j in range(kstar_i):
  *         jf=float(j+1)
  *         t=b+a*jf             # <<<<<<<<<<<<<<
  *         s=exp(t)
  *         tt=vi[j]*s
  */
     __pyx_v_t = (__pyx_v_b + (__pyx_v_a * __pyx_v_jf));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":55
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":57
  *         jf=float(j+1)
  *         t=b+a*jf
  *         s=exp(t)             # <<<<<<<<<<<<<<
  *         tt=vi[j]*s
  *         L0=L0+t-tt
  */
     __pyx_v_s = exp(__pyx_v_t);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":56
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":58
  *         t=b+a*jf
  *         s=exp(t)
  *         tt=vi[j]*s             # <<<<<<<<<<<<<<
  *         L0=L0+t-tt
  *         gb=gb-tt
  */
     __pyx_t_10 = __pyx_v_j;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_vi.diminfo[0].shape;
-    __pyx_v_tt = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_vi.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_vi.diminfo[0].strides)) * __pyx_v_s);
+    __pyx_v_tt = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_vi.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_vi.diminfo[0].strides)) * __pyx_v_s);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":57
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":59
  *         s=exp(t)
  *         tt=vi[j]*s
  *         L0=L0+t-tt             # <<<<<<<<<<<<<<
  *         gb=gb-tt
  *         ga=ga-jf*tt
  */
     __pyx_v_L0 = ((__pyx_v_L0 + __pyx_v_t) - __pyx_v_tt);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":58
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":60
  *         tt=vi[j]*s
  *         L0=L0+t-tt
  *         gb=gb-tt             # <<<<<<<<<<<<<<
  *         ga=ga-jf*tt
  *         Cov2[0,0]=Cov2[0,0]-tt
  */
     __pyx_v_gb = (__pyx_v_gb - __pyx_v_tt);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":59
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":61
  *         L0=L0+t-tt
  *         gb=gb-tt
  *         ga=ga-jf*tt             # <<<<<<<<<<<<<<
  *         Cov2[0,0]=Cov2[0,0]-tt
  *         Cov2[0,1]=Cov2[0,1]-jf*tt
  */
     __pyx_v_ga = (__pyx_v_ga - (__pyx_v_jf * __pyx_v_tt));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":60
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":62
  *         gb=gb-tt
  *         ga=ga-jf*tt
  *         Cov2[0,0]=Cov2[0,0]-tt             # <<<<<<<<<<<<<<
  *         Cov2[0,1]=Cov2[0,1]-jf*tt
  *         Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  */
     __pyx_t_10 = 0;
     __pyx_t_11 = 0;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
     __pyx_t_12 = 0;
     __pyx_t_13 = 0;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - __pyx_v_tt);
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - __pyx_v_tt);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":61
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":63
  *         ga=ga-jf*tt
  *         Cov2[0,0]=Cov2[0,0]-tt
  *         Cov2[0,1]=Cov2[0,1]-jf*tt             # <<<<<<<<<<<<<<
  *         Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  *     Cov2[1,0]=Cov2[0,1]
  */
     __pyx_t_11 = 0;
     __pyx_t_10 = 1;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
     __pyx_t_13 = 0;
     __pyx_t_12 = 1;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - (__pyx_v_jf * __pyx_v_tt));
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - (__pyx_v_jf * __pyx_v_tt));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":62
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":64
  *         Cov2[0,0]=Cov2[0,0]-tt
  *         Cov2[0,1]=Cov2[0,1]-jf*tt
  *         Cov2[1,1]=Cov2[1,1]-jf*jf*tt             # <<<<<<<<<<<<<<
  *     Cov2[1,0]=Cov2[0,1]
  * 
  */
     __pyx_t_10 = 1;
     __pyx_t_11 = 1;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
     __pyx_t_12 = 1;
     __pyx_t_13 = 1;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - ((__pyx_v_jf * __pyx_v_jf) * __pyx_v_tt));
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - ((__pyx_v_jf * __pyx_v_jf) * __pyx_v_tt));
   }
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":63
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":65
  *         Cov2[0,1]=Cov2[0,1]-jf*tt
  *         Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  *     Cov2[1,0]=Cov2[0,1]             # <<<<<<<<<<<<<<
  * 
  *     _matinv2(Cov2,Covinv2)
  */
   __pyx_t_11 = 0;
   __pyx_t_10 = 1;
   if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
   if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
   __pyx_t_13 = 1;
   __pyx_t_12 = 0;
   if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
   if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides));
+  *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides));
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":65
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":67
  *     Cov2[1,0]=Cov2[0,1]
  * 
  *     _matinv2(Cov2,Covinv2)             # <<<<<<<<<<<<<<
  *     func=100.
  *     niter=0
  */
-  __pyx_t_3 = __pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_v__matinv2, ((PyArrayObject *)__pyx_v_Cov2), ((PyArrayObject *)__pyx_v_Covinv2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_3 = __pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_v__matinv2, ((PyArrayObject *)__pyx_v_Cov2), ((PyArrayObject *)__pyx_v_Covinv2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":66
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":68
  * 
  *     _matinv2(Cov2,Covinv2)
  *     func=100.             # <<<<<<<<<<<<<<
  *     niter=0
  * 
  */
   __pyx_v_func = 100.;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":67
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":69
  *     _matinv2(Cov2,Covinv2)
  *     func=100.
  *     niter=0             # <<<<<<<<<<<<<<
  * 
  *     while ( ((func)>1e-3) and (niter < 10000) ):
  */
   __pyx_v_niter = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":69
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":71
  *     niter=0
  * 
  *     while ( ((func)>1e-3) and (niter < 10000) ):             # <<<<<<<<<<<<<<
  *         sb=(Covinv2[0,0]*gb+Covinv2[0,1]*ga)
  *         sa=(Covinv2[1,0]*gb+Covinv2[1,1]*ga)
  */
   while (1) {
@@ -2672,336 +2742,336 @@
       goto __pyx_L7_bool_binop_done;
     }
     __pyx_t_15 = ((__pyx_v_niter < 0x2710) != 0);
     __pyx_t_14 = __pyx_t_15;
     __pyx_L7_bool_binop_done:;
     if (!__pyx_t_14) break;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":70
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":72
  * 
  *     while ( ((func)>1e-3) and (niter < 10000) ):
  *         sb=(Covinv2[0,0]*gb+Covinv2[0,1]*ga)             # <<<<<<<<<<<<<<
  *         sa=(Covinv2[1,0]*gb+Covinv2[1,1]*ga)
  *         niter=niter+1
  */
     __pyx_t_10 = 0;
     __pyx_t_11 = 0;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Covinv2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Covinv2.diminfo[1].shape;
     __pyx_t_12 = 0;
     __pyx_t_13 = 1;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Covinv2.diminfo[0].shape;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Covinv2.diminfo[1].shape;
-    __pyx_v_sb = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_gb) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_ga));
+    __pyx_v_sb = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_gb) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_ga));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":71
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":73
  *     while ( ((func)>1e-3) and (niter < 10000) ):
  *         sb=(Covinv2[0,0]*gb+Covinv2[0,1]*ga)
  *         sa=(Covinv2[1,0]*gb+Covinv2[1,1]*ga)             # <<<<<<<<<<<<<<
  *         niter=niter+1
  *         sigma=0.1
  */
     __pyx_t_13 = 1;
     __pyx_t_12 = 0;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Covinv2.diminfo[0].shape;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Covinv2.diminfo[1].shape;
     __pyx_t_11 = 1;
     __pyx_t_10 = 1;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Covinv2.diminfo[0].shape;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Covinv2.diminfo[1].shape;
-    __pyx_v_sa = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_gb) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_ga));
+    __pyx_v_sa = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_gb) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Covinv2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Covinv2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Covinv2.diminfo[1].strides)) * __pyx_v_ga));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":72
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":74
  *         sb=(Covinv2[0,0]*gb+Covinv2[0,1]*ga)
  *         sa=(Covinv2[1,0]*gb+Covinv2[1,1]*ga)
  *         niter=niter+1             # <<<<<<<<<<<<<<
  *         sigma=0.1
  *         if (abs(sigma*sb) > stepmax) :
  */
     __pyx_v_niter = (__pyx_v_niter + 1);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":73
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":75
  *         sa=(Covinv2[1,0]*gb+Covinv2[1,1]*ga)
  *         niter=niter+1
  *         sigma=0.1             # <<<<<<<<<<<<<<
  *         if (abs(sigma*sb) > stepmax) :
  *             sigma=abs(stepmax/sb)
  */
     __pyx_v_sigma = 0.1;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":74
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":76
  *         niter=niter+1
  *         sigma=0.1
  *         if (abs(sigma*sb) > stepmax) :             # <<<<<<<<<<<<<<
  *             sigma=abs(stepmax/sb)
  *         b=b-sigma*sb
  */
     __pyx_t_14 = ((fabs((__pyx_v_sigma * __pyx_v_sb)) > __pyx_v_stepmax) != 0);
     if (__pyx_t_14) {
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":75
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":77
  *         sigma=0.1
  *         if (abs(sigma*sb) > stepmax) :
  *             sigma=abs(stepmax/sb)             # <<<<<<<<<<<<<<
  *         b=b-sigma*sb
  *         a=a-sigma*sa
  */
       __pyx_v_sigma = fabs((__pyx_v_stepmax / __pyx_v_sb));
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":74
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":76
  *         niter=niter+1
  *         sigma=0.1
  *         if (abs(sigma*sb) > stepmax) :             # <<<<<<<<<<<<<<
  *             sigma=abs(stepmax/sb)
  *         b=b-sigma*sb
  */
     }
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":76
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":78
  *         if (abs(sigma*sb) > stepmax) :
  *             sigma=abs(stepmax/sb)
  *         b=b-sigma*sb             # <<<<<<<<<<<<<<
  *         a=a-sigma*sa
- *         L0=0.
+ * 
  */
     __pyx_v_b = (__pyx_v_b - (__pyx_v_sigma * __pyx_v_sb));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":77
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":79
  *             sigma=abs(stepmax/sb)
  *         b=b-sigma*sb
  *         a=a-sigma*sa             # <<<<<<<<<<<<<<
+ * 
  *         L0=0.
- *         gb= float(kstar_i)
  */
     __pyx_v_a = (__pyx_v_a - (__pyx_v_sigma * __pyx_v_sa));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":78
- *         b=b-sigma*sb
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":81
  *         a=a-sigma*sa
+ * 
  *         L0=0.             # <<<<<<<<<<<<<<
  *         gb= float(kstar_i)
  *         ga= float(kstar_i + 1) * float(kstar_i) / 2.
  */
     __pyx_v_L0 = 0.;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":79
- *         a=a-sigma*sa
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":82
+ * 
  *         L0=0.
  *         gb= float(kstar_i)             # <<<<<<<<<<<<<<
  *         ga= float(kstar_i + 1) * float(kstar_i) / 2.
  *         Cov2[0,0]=0. #gbb
  */
     __pyx_v_gb = ((double)__pyx_v_kstar_i);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":80
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":83
  *         L0=0.
  *         gb= float(kstar_i)
  *         ga= float(kstar_i + 1) * float(kstar_i) / 2.             # <<<<<<<<<<<<<<
  *         Cov2[0,0]=0. #gbb
  *         Cov2[0,1]=0. #gab
  */
     __pyx_v_ga = ((((double)(__pyx_v_kstar_i + 1)) * ((double)__pyx_v_kstar_i)) / 2.);
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":81
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":84
  *         gb= float(kstar_i)
  *         ga= float(kstar_i + 1) * float(kstar_i) / 2.
  *         Cov2[0,0]=0. #gbb             # <<<<<<<<<<<<<<
  *         Cov2[0,1]=0. #gab
  *         Cov2[1,1]=0. #gaa
  */
     __pyx_t_10 = 0;
     __pyx_t_11 = 0;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":82
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":85
  *         ga= float(kstar_i + 1) * float(kstar_i) / 2.
  *         Cov2[0,0]=0. #gbb
  *         Cov2[0,1]=0. #gab             # <<<<<<<<<<<<<<
  *         Cov2[1,1]=0. #gaa
  *         for j in range(kstar_i):
  */
     __pyx_t_11 = 0;
     __pyx_t_10 = 1;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":83
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":86
  *         Cov2[0,0]=0. #gbb
  *         Cov2[0,1]=0. #gab
  *         Cov2[1,1]=0. #gaa             # <<<<<<<<<<<<<<
  *         for j in range(kstar_i):
  *             jf=float(j+1)
  */
     __pyx_t_10 = 1;
     __pyx_t_11 = 1;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides) = 0.;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":84
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":87
  *         Cov2[0,1]=0. #gab
  *         Cov2[1,1]=0. #gaa
  *         for j in range(kstar_i):             # <<<<<<<<<<<<<<
  *             jf=float(j+1)
  *             t=b+a*jf
  */
     __pyx_t_7 = __pyx_v_kstar_i;
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_j = __pyx_t_9;
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":85
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":88
  *         Cov2[1,1]=0. #gaa
  *         for j in range(kstar_i):
  *             jf=float(j+1)             # <<<<<<<<<<<<<<
  *             t=b+a*jf
  *             s=exp(t)
  */
       __pyx_v_jf = ((double)(__pyx_v_j + 1));
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":86
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":89
  *         for j in range(kstar_i):
  *             jf=float(j+1)
  *             t=b+a*jf             # <<<<<<<<<<<<<<
  *             s=exp(t)
  *             tt=vi[j]*s
  */
       __pyx_v_t = (__pyx_v_b + (__pyx_v_a * __pyx_v_jf));
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":87
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":90
  *             jf=float(j+1)
  *             t=b+a*jf
  *             s=exp(t)             # <<<<<<<<<<<<<<
  *             tt=vi[j]*s
  *             L0=L0+t-tt
  */
       __pyx_v_s = exp(__pyx_v_t);
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":88
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":91
  *             t=b+a*jf
  *             s=exp(t)
  *             tt=vi[j]*s             # <<<<<<<<<<<<<<
  *             L0=L0+t-tt
  *             gb=gb-tt
  */
       __pyx_t_11 = __pyx_v_j;
       if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_vi.diminfo[0].shape;
-      __pyx_v_tt = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_vi.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_vi.diminfo[0].strides)) * __pyx_v_s);
+      __pyx_v_tt = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_vi.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_vi.diminfo[0].strides)) * __pyx_v_s);
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":89
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":92
  *             s=exp(t)
  *             tt=vi[j]*s
  *             L0=L0+t-tt             # <<<<<<<<<<<<<<
  *             gb=gb-tt
  *             ga=ga-jf*tt
  */
       __pyx_v_L0 = ((__pyx_v_L0 + __pyx_v_t) - __pyx_v_tt);
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":90
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":93
  *             tt=vi[j]*s
  *             L0=L0+t-tt
  *             gb=gb-tt             # <<<<<<<<<<<<<<
  *             ga=ga-jf*tt
  *             Cov2[0,0]=Cov2[0,0]-tt
  */
       __pyx_v_gb = (__pyx_v_gb - __pyx_v_tt);
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":91
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":94
  *             L0=L0+t-tt
  *             gb=gb-tt
  *             ga=ga-jf*tt             # <<<<<<<<<<<<<<
  *             Cov2[0,0]=Cov2[0,0]-tt
  *             Cov2[0,1]=Cov2[0,1]-jf*tt
  */
       __pyx_v_ga = (__pyx_v_ga - (__pyx_v_jf * __pyx_v_tt));
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":92
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":95
  *             gb=gb-tt
  *             ga=ga-jf*tt
  *             Cov2[0,0]=Cov2[0,0]-tt             # <<<<<<<<<<<<<<
  *             Cov2[0,1]=Cov2[0,1]-jf*tt
  *             Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  */
       __pyx_t_11 = 0;
       __pyx_t_10 = 0;
       if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
       __pyx_t_12 = 0;
       __pyx_t_13 = 0;
       if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - __pyx_v_tt);
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - __pyx_v_tt);
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":93
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":96
  *             ga=ga-jf*tt
  *             Cov2[0,0]=Cov2[0,0]-tt
  *             Cov2[0,1]=Cov2[0,1]-jf*tt             # <<<<<<<<<<<<<<
  *             Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  *         Cov2[1,0]=Cov2[0,1]
  */
       __pyx_t_10 = 0;
       __pyx_t_11 = 1;
       if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
       __pyx_t_13 = 0;
       __pyx_t_12 = 1;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - (__pyx_v_jf * __pyx_v_tt));
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - (__pyx_v_jf * __pyx_v_tt));
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":94
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":97
  *             Cov2[0,0]=Cov2[0,0]-tt
  *             Cov2[0,1]=Cov2[0,1]-jf*tt
  *             Cov2[1,1]=Cov2[1,1]-jf*jf*tt             # <<<<<<<<<<<<<<
  *         Cov2[1,0]=Cov2[0,1]
  *         #Covinv2=np.linalg.inv(Cov2)
  */
       __pyx_t_11 = 1;
       __pyx_t_10 = 1;
       if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
       __pyx_t_12 = 1;
       __pyx_t_13 = 1;
       if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
       if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - ((__pyx_v_jf * __pyx_v_jf) * __pyx_v_tt));
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[1].strides)) - ((__pyx_v_jf * __pyx_v_jf) * __pyx_v_tt));
     }
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":95
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":98
  *             Cov2[0,1]=Cov2[0,1]-jf*tt
  *             Cov2[1,1]=Cov2[1,1]-jf*jf*tt
  *         Cov2[1,0]=Cov2[0,1]             # <<<<<<<<<<<<<<
  *         #Covinv2=np.linalg.inv(Cov2)
  *         #Covinv2=_matinv2(Cov2)
  */
     __pyx_t_10 = 0;
     __pyx_t_11 = 1;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_11 < 0) __pyx_t_11 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
     __pyx_t_13 = 1;
     __pyx_t_12 = 0;
     if (__pyx_t_13 < 0) __pyx_t_13 += __pyx_pybuffernd_Cov2.diminfo[0].shape;
     if (__pyx_t_12 < 0) __pyx_t_12 += __pyx_pybuffernd_Cov2.diminfo[1].shape;
-    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7cython__29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides));
+    *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Cov2.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_29cython_maximum_likelihood_opt_floatTYPE_t *, __pyx_pybuffernd_Cov2.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Cov2.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_Cov2.diminfo[1].strides));
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":98
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":101
  *         #Covinv2=np.linalg.inv(Cov2)
  *         #Covinv2=_matinv2(Cov2)
  *         _matinv2(Cov2,Covinv2)             # <<<<<<<<<<<<<<
  *         if ((abs(a) <= fepsilon ) or (abs(b) <= fepsilon )):
  *             func=max(abs(gb),abs(ga))
  */
-    __pyx_t_3 = __pyx_pf_6dadapy_7cython__29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_v__matinv2, ((PyArrayObject *)__pyx_v_Cov2), ((PyArrayObject *)__pyx_v_Covinv2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_3 = __pyx_pf_6dadapy_7_cython_29cython_maximum_likelihood_opt_7_nrmaxl__matinv2(__pyx_v__matinv2, ((PyArrayObject *)__pyx_v_Cov2), ((PyArrayObject *)__pyx_v_Covinv2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 101, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":99
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":102
  *         #Covinv2=_matinv2(Cov2)
  *         _matinv2(Cov2,Covinv2)
  *         if ((abs(a) <= fepsilon ) or (abs(b) <= fepsilon )):             # <<<<<<<<<<<<<<
  *             func=max(abs(gb),abs(ga))
  *         else:
  */
     __pyx_t_15 = ((fabs(__pyx_v_a) <= __pyx_v_fepsilon) != 0);
@@ -3011,15 +3081,15 @@
       goto __pyx_L13_bool_binop_done;
     }
     __pyx_t_15 = ((fabs(__pyx_v_b) <= __pyx_v_fepsilon) != 0);
     __pyx_t_14 = __pyx_t_15;
     __pyx_L13_bool_binop_done:;
     if (__pyx_t_14) {
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":100
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":103
  *         _matinv2(Cov2,Covinv2)
  *         if ((abs(a) <= fepsilon ) or (abs(b) <= fepsilon )):
  *             func=max(abs(gb),abs(ga))             # <<<<<<<<<<<<<<
  *         else:
  *             func=max(abs(gb/b),abs(ga/a))
  */
       __pyx_t_16 = fabs(__pyx_v_ga);
@@ -3027,57 +3097,57 @@
       if (((__pyx_t_16 > __pyx_t_17) != 0)) {
         __pyx_t_18 = __pyx_t_16;
       } else {
         __pyx_t_18 = __pyx_t_17;
       }
       __pyx_v_func = __pyx_t_18;
 
-      /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":99
+      /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":102
  *         #Covinv2=_matinv2(Cov2)
  *         _matinv2(Cov2,Covinv2)
  *         if ((abs(a) <= fepsilon ) or (abs(b) <= fepsilon )):             # <<<<<<<<<<<<<<
  *             func=max(abs(gb),abs(ga))
  *         else:
  */
       goto __pyx_L12;
     }
 
-    /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":102
+    /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":105
  *             func=max(abs(gb),abs(ga))
  *         else:
  *             func=max(abs(gb/b),abs(ga/a))             # <<<<<<<<<<<<<<
+ * 
  *     #Cov2=-Cov2
- *     #Covinv2=np.linalg.inv(Cov2)
  */
     /*else*/ {
       __pyx_t_18 = fabs((__pyx_v_ga / __pyx_v_a));
       __pyx_t_16 = fabs((__pyx_v_gb / __pyx_v_b));
       if (((__pyx_t_18 > __pyx_t_16) != 0)) {
         __pyx_t_17 = __pyx_t_18;
       } else {
         __pyx_t_17 = __pyx_t_16;
       }
       __pyx_v_func = __pyx_t_17;
     }
     __pyx_L12:;
   }
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":109
- *     #print("N iterations: ", niter)
- *     #print(func)
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":112
+ *     #_matinv2(Cov2,Covinv2)
+ * 
  *     return b             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_b); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_b); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":16
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(floatTYPE_t rinit,             # <<<<<<<<<<<<<<
  *             DTYPE_t kstar_i,
  *             np.ndarray[floatTYPE_t, ndim = 1] vi):
  */
 
@@ -3090,15 +3160,15 @@
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Cov2.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Covinv2.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_vi.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
-  __Pyx_AddTraceback("dadapy.cython_.cython_maximum_likelihood_opt._nrmaxl", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __Pyx_AddTraceback("dadapy._cython.cython_maximum_likelihood_opt._nrmaxl", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Cov2.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Covinv2.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_vi.rcbuffer->pybuffer);
   __pyx_L2:;
@@ -3106,15 +3176,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_Covinv2);
   __Pyx_XDECREF(__pyx_v__matinv2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":735
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -3123,29 +3193,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":736
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":736
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -3156,15 +3226,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":738
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -3173,29 +3243,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":739
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":739
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -3206,15 +3276,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":741
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -3223,29 +3293,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":742
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":742
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -3256,15 +3326,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":744
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3273,29 +3343,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":745
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":745
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3306,15 +3376,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":747
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3323,29 +3393,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":748
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":748
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3356,212 +3426,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":750
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":751
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":752
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":752
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":754
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":754
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":929
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":930
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":931
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":931
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":933
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":934
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":935
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":936
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":936
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":937
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":937
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":941
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3577,15 +3647,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":942
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -3593,53 +3663,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":943
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":943
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 943, __pyx_L3_error)
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":944
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":944
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":945
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
@@ -3647,30 +3717,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":942
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3685,15 +3755,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":947
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3709,15 +3779,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":948
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3725,53 +3795,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":949
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":949
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 949, __pyx_L3_error)
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":950
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":950
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":951
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
@@ -3779,30 +3849,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":948
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3817,15 +3887,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":953
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3841,15 +3911,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":954
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3857,53 +3927,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":955
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":955
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 955, __pyx_L3_error)
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":956
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":956
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":957
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
@@ -3911,30 +3981,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":954
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3949,176 +4019,176 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":967
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":979
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":979
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":967
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":982
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":994
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":994
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":982
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":997
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1004
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1004
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":997
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1007
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1011
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1011
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1007
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1018
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1018
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -4178,30 +4248,28 @@
   {&__pyx_n_s_Cov2, __pyx_k_Cov2, sizeof(__pyx_k_Cov2), 0, 0, 1, 1},
   {&__pyx_n_s_Covinv2, __pyx_k_Covinv2, sizeof(__pyx_k_Covinv2), 0, 0, 1, 1},
   {&__pyx_n_s_DTYPE, __pyx_k_DTYPE, sizeof(__pyx_k_DTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_ImportError, __pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 0, 1, 1},
   {&__pyx_n_s_L0, __pyx_k_L0, sizeof(__pyx_k_L0), 0, 0, 1, 1},
   {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
   {&__pyx_n_s_b, __pyx_k_b, sizeof(__pyx_k_b), 0, 0, 1, 1},
-  {&__pyx_n_s_bool, __pyx_k_bool, sizeof(__pyx_k_bool), 0, 0, 1, 1},
-  {&__pyx_n_s_boolTYPE, __pyx_k_boolTYPE, sizeof(__pyx_k_boolTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
-  {&__pyx_kp_s_dadapy_cython__cython_maximum_li, __pyx_k_dadapy_cython__cython_maximum_li, sizeof(__pyx_k_dadapy_cython__cython_maximum_li), 0, 0, 1, 0},
-  {&__pyx_n_s_dadapy_cython__cython_maximum_li_2, __pyx_k_dadapy_cython__cython_maximum_li_2, sizeof(__pyx_k_dadapy_cython__cython_maximum_li_2), 0, 0, 1, 1},
+  {&__pyx_kp_s_cython_maximum_likelihood_opt_py, __pyx_k_cython_maximum_likelihood_opt_py, sizeof(__pyx_k_cython_maximum_likelihood_opt_py), 0, 0, 1, 0},
+  {&__pyx_n_s_dadapy__cython_cython_maximum_li, __pyx_k_dadapy__cython_cython_maximum_li, sizeof(__pyx_k_dadapy__cython_cython_maximum_li), 0, 0, 1, 1},
   {&__pyx_n_s_detinv, __pyx_k_detinv, sizeof(__pyx_k_detinv), 0, 0, 1, 1},
   {&__pyx_n_s_eps, __pyx_k_eps, sizeof(__pyx_k_eps), 0, 0, 1, 1},
   {&__pyx_n_s_fepsilon, __pyx_k_fepsilon, sizeof(__pyx_k_fepsilon), 0, 0, 1, 1},
   {&__pyx_n_s_finfo, __pyx_k_finfo, sizeof(__pyx_k_finfo), 0, 0, 1, 1},
-  {&__pyx_n_s_float, __pyx_k_float, sizeof(__pyx_k_float), 0, 0, 1, 1},
+  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_floatTYPE, __pyx_k_floatTYPE, sizeof(__pyx_k_floatTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_func, __pyx_k_func, sizeof(__pyx_k_func), 0, 0, 1, 1},
   {&__pyx_n_s_ga, __pyx_k_ga, sizeof(__pyx_k_ga), 0, 0, 1, 1},
   {&__pyx_n_s_gb, __pyx_k_gb, sizeof(__pyx_k_gb), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
-  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
+  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_jf, __pyx_k_jf, sizeof(__pyx_k_jf), 0, 0, 1, 1},
   {&__pyx_n_s_kstar_i, __pyx_k_kstar_i, sizeof(__pyx_k_kstar_i), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_matinv2, __pyx_k_matinv2, sizeof(__pyx_k_matinv2), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_niter, __pyx_k_niter, sizeof(__pyx_k_niter), 0, 0, 1, 1},
@@ -4223,81 +4291,81 @@
   {&__pyx_n_s_time, __pyx_k_time, sizeof(__pyx_k_time), 0, 0, 1, 1},
   {&__pyx_n_s_tt, __pyx_k_tt, sizeof(__pyx_k_tt), 0, 0, 1, 1},
   {&__pyx_n_s_vi, __pyx_k_vi, sizeof(__pyx_k_vi), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 54, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":25
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":27
  *     cdef floatTYPE_t a,b,L0,stepmax,ga,gb,jf,t,s,tt,func,sigma,sa,sb
  * 
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Cov2 = np.zeros((2, 2))             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[floatTYPE_t, ndim = 2] Covinv2 = np.zeros((2, 2))
  * 
  */
-  __pyx_tuple_ = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 25, __pyx_L1_error)
+  __pyx_tuple_ = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple_);
   __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":32
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":34
  * 
  *     #useful subroutine
  *     def _matinv2(np.ndarray[floatTYPE_t, ndim = 2] A, np.ndarray[floatTYPE_t, ndim = 2] B):             # <<<<<<<<<<<<<<
  *     # Performs a direct calculation of the inverse of a 22 matrix.
  *         cdef floatTYPE_t detinv
  */
-  __pyx_tuple__2 = PyTuple_Pack(3, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_detinv); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 32, __pyx_L1_error)
+  __pyx_tuple__2 = PyTuple_Pack(3, __pyx_n_s_A, __pyx_n_s_B, __pyx_n_s_detinv); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__2);
   __Pyx_GIVEREF(__pyx_tuple__2);
-  __pyx_codeobj__3 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__2, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_dadapy_cython__cython_maximum_li, __pyx_n_s_matinv2, 32, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 32, __pyx_L1_error)
+  __pyx_codeobj__3 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__2, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_maximum_likelihood_opt_py, __pyx_n_s_matinv2, 34, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 34, __pyx_L1_error)
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":945
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__4 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(1, 945, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__4);
   __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":951
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__5 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(1, 951, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__5);
   __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":16
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(floatTYPE_t rinit,             # <<<<<<<<<<<<<<
  *             DTYPE_t kstar_i,
  *             np.ndarray[floatTYPE_t, ndim = 1] vi):
  */
-  __pyx_tuple__6 = PyTuple_Pack(24, __pyx_n_s_rinit, __pyx_n_s_kstar_i, __pyx_n_s_vi, __pyx_n_s_j, __pyx_n_s_niter, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_L0, __pyx_n_s_stepmax, __pyx_n_s_ga, __pyx_n_s_gb, __pyx_n_s_jf, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_tt, __pyx_n_s_func, __pyx_n_s_sigma, __pyx_n_s_sa, __pyx_n_s_sb, __pyx_n_s_Cov2, __pyx_n_s_Covinv2, __pyx_n_s_fepsilon, __pyx_n_s_matinv2, __pyx_n_s_matinv2); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __pyx_tuple__6 = PyTuple_Pack(24, __pyx_n_s_rinit, __pyx_n_s_kstar_i, __pyx_n_s_vi, __pyx_n_s_j, __pyx_n_s_niter, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_L0, __pyx_n_s_stepmax, __pyx_n_s_ga, __pyx_n_s_gb, __pyx_n_s_jf, __pyx_n_s_t, __pyx_n_s_s, __pyx_n_s_tt, __pyx_n_s_func, __pyx_n_s_sigma, __pyx_n_s_sa, __pyx_n_s_sb, __pyx_n_s_Cov2, __pyx_n_s_Covinv2, __pyx_n_s_fepsilon, __pyx_n_s_matinv2, __pyx_n_s_matinv2); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__6);
   __Pyx_GIVEREF(__pyx_tuple__6);
-  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(3, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_dadapy_cython__cython_maximum_li, __pyx_n_s_nrmaxl, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 16, __pyx_L1_error)
+  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(3, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__6, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_maximum_likelihood_opt_py, __pyx_n_s_nrmaxl, 18, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -4594,22 +4662,22 @@
   Py_INCREF(__pyx_cython_runtime);
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
   /*--- Initialize various global constants etc. ---*/
   if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
   if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
-  if (__pyx_module_is_main_dadapy__cython___cython_maximum_likelihood_opt) {
+  if (__pyx_module_is_main_dadapy___cython__cython_maximum_likelihood_opt) {
     if (PyObject_SetAttr(__pyx_m, __pyx_n_s_name, __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   }
   #if PY_MAJOR_VERSION >= 3
   {
     PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
-    if (!PyDict_GetItemString(modules, "dadapy.cython_.cython_maximum_likelihood_opt")) {
-      if (unlikely(PyDict_SetItemString(modules, "dadapy.cython_.cython_maximum_likelihood_opt", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
+    if (!PyDict_GetItemString(modules, "dadapy._cython.cython_maximum_likelihood_opt")) {
+      if (unlikely(PyDict_SetItemString(modules, "dadapy._cython.cython_maximum_likelihood_opt", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
     }
   }
   #endif
   /*--- Builtin init code ---*/
   if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   /*--- Constants init code ---*/
   if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -4622,105 +4690,89 @@
   (void)__Pyx_modinit_variable_import_code();
   (void)__Pyx_modinit_function_import_code();
   /*--- Execution code ---*/
   #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
   if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   #endif
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":2
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":1
+ * import time             # <<<<<<<<<<<<<<
+ * 
  * import cython
- * import numpy as np             # <<<<<<<<<<<<<<
- * import time
- * cimport numpy as np
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_time, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 2, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_time, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":3
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":4
+ * 
  * import cython
- * import numpy as np
- * import time             # <<<<<<<<<<<<<<
+ * import numpy as np             # <<<<<<<<<<<<<<
+ * 
  * cimport numpy as np
- * from libc.math cimport exp
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_time, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_time, __pyx_t_1) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":7
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":9
  * from libc.math cimport exp
  * 
- * DTYPE = np.int             # <<<<<<<<<<<<<<
- * floatTYPE = np.float
- * boolTYPE = np.bool
+ * DTYPE = np.int64             # <<<<<<<<<<<<<<
+ * floatTYPE = np.float64
+ * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":8
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":10
+ * 
+ * DTYPE = np.int64
+ * floatTYPE = np.float64             # <<<<<<<<<<<<<<
  * 
- * DTYPE = np.int
- * floatTYPE = np.float             # <<<<<<<<<<<<<<
- * boolTYPE = np.bool
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":9
- * DTYPE = np.int
- * floatTYPE = np.float
- * boolTYPE = np.bool             # <<<<<<<<<<<<<<
- * 
- * ctypedef np.int_t DTYPE_t
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bool); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_boolTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":16
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(floatTYPE_t rinit,             # <<<<<<<<<<<<<<
  *             DTYPE_t kstar_i,
  *             np.ndarray[floatTYPE_t, ndim = 1] vi):
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7cython__29cython_maximum_likelihood_opt_1_nrmaxl, NULL, __pyx_n_s_dadapy_cython__cython_maximum_li_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_nrmaxl, __pyx_t_2) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_29cython_maximum_likelihood_opt_1_nrmaxl, NULL, __pyx_n_s_dadapy__cython_cython_maximum_li); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_nrmaxl, __pyx_t_1) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/cython_/cython_maximum_likelihood_opt.pyx":1
- * import cython             # <<<<<<<<<<<<<<
- * import numpy as np
- * import time
+  /* "dadapy/_cython/cython_maximum_likelihood_opt.pyx":1
+ * import time             # <<<<<<<<<<<<<<
+ * 
+ * import cython
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../../anaconda3/envs/pynn/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -4728,19 +4780,19 @@
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   if (__pyx_m) {
     if (__pyx_d) {
-      __Pyx_AddTraceback("init dadapy.cython_.cython_maximum_likelihood_opt", __pyx_clineno, __pyx_lineno, __pyx_filename);
+      __Pyx_AddTraceback("init dadapy._cython.cython_maximum_likelihood_opt", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
-    PyErr_SetString(PyExc_ImportError, "init dadapy.cython_.cython_maximum_likelihood_opt");
+    PyErr_SetString(PyExc_ImportError, "init dadapy._cython.cython_maximum_likelihood_opt");
   }
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   return (__pyx_m != NULL) ? 0 : -1;
   #elif PY_MAJOR_VERSION >= 3
   return __pyx_m;
@@ -6399,14 +6451,17 @@
         argc = PyTuple_GET_SIZE(args);
         new_args = PyTuple_GetSlice(args, 1, argc);
         if (unlikely(!new_args))
             return NULL;
         self = PyTuple_GetItem(args, 0);
         if (unlikely(!self)) {
             Py_DECREF(new_args);
+            PyErr_Format(PyExc_TypeError,
+                         "unbound method %.200S() needs an argument",
+                         cyfunc->func_qualname);
             return NULL;
         }
         result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
         Py_DECREF(new_args);
     } else {
         result = __Pyx_CyFunction_Call(func, args, kw);
     }
@@ -6467,20 +6522,23 @@
     0,
     0,
     0,
     0,
 #if PY_VERSION_HEX >= 0x030400a1
     0,
 #endif
-#if PY_VERSION_HEX >= 0x030800b1
+#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
     0,
 #endif
 #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
     0,
 #endif
+#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
+    0,
+#endif
 };
 static int __pyx_CyFunction_init(void) {
     __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
     if (unlikely(__pyx_CyFunctionType == NULL)) {
         return -1;
     }
     return 0;
@@ -6992,15 +7050,15 @@
       } else {
         PyErr_Clear();
         use_cline = NULL;
       }
     }
     if (!use_cline) {
         c_line = 0;
-        PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
+        (void) PyObject_SetAttr(__pyx_cython_runtime, __pyx_n_s_cline_in_traceback, Py_False);
     }
     else if (use_cline == Py_False || (use_cline != Py_True && PyObject_Not(use_cline) != 0)) {
         c_line = 0;
     }
     __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
     return c_line;
 }
@@ -7086,41 +7144,48 @@
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
   #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
-    PyCodeObject *py_code = 0;
-    PyObject *py_srcfile = 0;
-    PyObject *py_funcname = 0;
+    PyCodeObject *py_code = NULL;
+    PyObject *py_funcname = NULL;
     #if PY_MAJOR_VERSION < 3
+    PyObject *py_srcfile = NULL;
     py_srcfile = PyString_FromString(filename);
-    #else
-    py_srcfile = PyUnicode_FromString(filename);
-    #endif
     if (!py_srcfile) goto bad;
+    #endif
     if (c_line) {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
         #else
         py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
+        if (!py_funcname) goto bad;
+        funcname = PyUnicode_AsUTF8(py_funcname);
+        if (!funcname) goto bad;
         #endif
     }
     else {
         #if PY_MAJOR_VERSION < 3
         py_funcname = PyString_FromString(funcname);
-        #else
-        py_funcname = PyUnicode_FromString(funcname);
+        if (!py_funcname) goto bad;
         #endif
     }
-    if (!py_funcname) goto bad;
+    #if PY_MAJOR_VERSION < 3
     py_code = __Pyx_PyCode_New(
         0,
         0,
         0,
         0,
         0,
         __pyx_empty_bytes, /*PyObject *code,*/
@@ -7131,34 +7196,49 @@
         __pyx_empty_tuple, /*PyObject *cellvars,*/
         py_srcfile,   /*PyObject *filename,*/
         py_funcname,  /*PyObject *name,*/
         py_line,
         __pyx_empty_bytes  /*PyObject *lnotab*/
     );
     Py_DECREF(py_srcfile);
-    Py_DECREF(py_funcname);
+    #else
+    py_code = PyCode_NewEmpty(filename, funcname, py_line);
+    #endif
+    Py_XDECREF(py_funcname);  // XDECREF since it's only set on Py3 if cline
     return py_code;
 bad:
-    Py_XDECREF(py_srcfile);
     Py_XDECREF(py_funcname);
+    #if PY_MAJOR_VERSION < 3
+    Py_XDECREF(py_srcfile);
+    #endif
     return NULL;
 }
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyFrameObject *py_frame = 0;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject *ptype, *pvalue, *ptraceback;
     if (c_line) {
         c_line = __Pyx_CLineForTraceback(tstate, c_line);
     }
     py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
     if (!py_code) {
+        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
         py_code = __Pyx_CreateCodeObjectForTraceback(
             funcname, c_line, py_line, filename);
-        if (!py_code) goto bad;
+        if (!py_code) {
+            /* If the code object creation fails, then we should clear the
+               fetched exception references and propagate the new exception */
+            Py_XDECREF(ptype);
+            Py_XDECREF(pvalue);
+            Py_XDECREF(ptraceback);
+            goto bad;
+        }
+        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
         __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
     }
     py_frame = PyFrame_New(
         tstate,            /*PyThreadState *tstate,*/
         py_code,           /*PyCodeObject *code,*/
         __pyx_d,    /*PyObject *globals,*/
         0                  /*PyObject *locals*/
@@ -8283,19 +8363,41 @@
     }
     return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
 }
 #endif
 
 /* CheckBinaryVersion */
   static int __Pyx_check_binary_version(void) {
-    char ctversion[4], rtversion[4];
-    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
-    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
-    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
+    char ctversion[5];
+    int same=1, i, found_dot;
+    const char* rt_from_call = Py_GetVersion();
+    PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
+    found_dot = 0;
+    for (i = 0; i < 4; i++) {
+        if (!ctversion[i]) {
+            same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
+            break;
+        }
+        if (rt_from_call[i] != ctversion[i]) {
+            same = 0;
+            break;
+        }
+    }
+    if (!same) {
+        char rtversion[5] = {'\0'};
         char message[200];
+        for (i=0; i<4; ++i) {
+            if (rt_from_call[i] == '.') {
+                if (found_dot) break;
+                found_dot = 1;
+            } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
+                break;
+            }
+            rtversion[i] = rt_from_call[i];
+        }
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
@@ -8545,14 +8647,31 @@
   }
   x = PyNumber_Index(b);
   if (!x) return -1;
   ival = PyInt_AsSsize_t(x);
   Py_DECREF(x);
   return ival;
 }
+static CYTHON_INLINE Py_hash_t __Pyx_PyIndex_AsHash_t(PyObject* o) {
+  if (sizeof(Py_hash_t) == sizeof(Py_ssize_t)) {
+    return (Py_hash_t) __Pyx_PyIndex_AsSsize_t(o);
+#if PY_MAJOR_VERSION < 3
+  } else if (likely(PyInt_CheckExact(o))) {
+    return PyInt_AS_LONG(o);
+#endif
+  } else {
+    Py_ssize_t ival;
+    PyObject *x;
+    x = PyNumber_Index(o);
+    if (!x) return -1;
+    ival = PyInt_AsLong(x);
+    Py_DECREF(x);
+    return ival;
+  }
+}
 static CYTHON_INLINE PyObject * __Pyx_PyBool_FromLong(long b) {
   return b ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False);
 }
 static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
     return PyInt_FromSize_t(ival);
 }
```

### Comparing `dadapy-0.1.1/dadapy/_cython/cython_maximum_likelihood_opt_full.c` & `dadapy-0.2.0/dadapy/_cython/cython_maximum_likelihood_opt_full.c`

 * *Files 4% similar despite different names*

```diff
@@ -1,20 +1,20 @@
-/* Generated by Cython 0.29.28 */
+/* Generated by Cython 0.29.30 */
 
 #ifndef PY_SSIZE_T_CLEAN
 #define PY_SSIZE_T_CLEAN
 #endif /* PY_SSIZE_T_CLEAN */
 #include "Python.h"
 #ifndef Py_PYTHON_H
     #error Python headers needed to compile C extensions, please install development version of Python.
 #elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03030000)
     #error Cython requires Python 2.6+ or Python 3.3+.
 #else
-#define CYTHON_ABI "0_29_28"
-#define CYTHON_HEX_VERSION 0x001D1CF0
+#define CYTHON_ABI "0_29_30"
+#define CYTHON_HEX_VERSION 0x001D1EF0
 #define CYTHON_FUTURE_DIVISION 0
 #include <stddef.h>
 #ifndef offsetof
   #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
 #endif
 #if !defined(WIN32) && !defined(MS_WINDOWS)
   #ifndef __stdcall
@@ -81,14 +81,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC (PYPY_VERSION_HEX >= 0x07030900)
+  #endif
 #elif defined(PYSTON_VERSION)
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 1
   #define CYTHON_COMPILING_IN_CPYTHON 0
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -122,14 +125,17 @@
   #define CYTHON_PEP489_MULTI_PHASE_INIT 0
   #undef CYTHON_USE_TP_FINALIZE
   #define CYTHON_USE_TP_FINALIZE 0
   #undef CYTHON_USE_DICT_VERSIONS
   #define CYTHON_USE_DICT_VERSIONS 0
   #undef CYTHON_USE_EXC_INFO_STACK
   #define CYTHON_USE_EXC_INFO_STACK 0
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 0
+  #endif
 #else
   #define CYTHON_COMPILING_IN_PYPY 0
   #define CYTHON_COMPILING_IN_PYSTON 0
   #define CYTHON_COMPILING_IN_CPYTHON 1
   #ifndef CYTHON_USE_TYPE_SLOTS
     #define CYTHON_USE_TYPE_SLOTS 1
   #endif
@@ -175,15 +181,15 @@
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_FAST_THREAD_STATE
     #define CYTHON_FAST_THREAD_STATE 0
   #elif !defined(CYTHON_FAST_THREAD_STATE)
     #define CYTHON_FAST_THREAD_STATE 1
   #endif
   #ifndef CYTHON_FAST_PYCALL
-    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030B00A1)
+    #define CYTHON_FAST_PYCALL (PY_VERSION_HEX < 0x030A0000)
   #endif
   #ifndef CYTHON_PEP489_MULTI_PHASE_INIT
     #define CYTHON_PEP489_MULTI_PHASE_INIT (PY_VERSION_HEX >= 0x03050000)
   #endif
   #ifndef CYTHON_USE_TP_FINALIZE
     #define CYTHON_USE_TP_FINALIZE (PY_VERSION_HEX >= 0x030400a1)
   #endif
@@ -192,14 +198,17 @@
   #endif
   #if PY_VERSION_HEX >= 0x030B00A4
     #undef CYTHON_USE_EXC_INFO_STACK
     #define CYTHON_USE_EXC_INFO_STACK 0
   #elif !defined(CYTHON_USE_EXC_INFO_STACK)
     #define CYTHON_USE_EXC_INFO_STACK (PY_VERSION_HEX >= 0x030700A3)
   #endif
+  #ifndef CYTHON_UPDATE_DESCRIPTOR_DOC
+    #define CYTHON_UPDATE_DESCRIPTOR_DOC 1
+  #endif
 #endif
 #if !defined(CYTHON_FAST_PYCCALL)
 #define CYTHON_FAST_PYCCALL  (CYTHON_FAST_PYCALL && PY_VERSION_HEX >= 0x030600B1)
 #endif
 #if CYTHON_USE_PYLONG_INTERNALS
   #if PY_MAJOR_VERSION < 3
     #include "longintrepr.h"
@@ -643,16 +652,18 @@
     typedef struct {
         unaryfunc am_await;
         unaryfunc am_aiter;
         unaryfunc am_anext;
     } __Pyx_PyAsyncMethodsStruct;
 #endif
 
-#if defined(WIN32) || defined(MS_WINDOWS)
-  #define _USE_MATH_DEFINES
+#if defined(_WIN32) || defined(WIN32) || defined(MS_WINDOWS)
+  #if !defined(_USE_MATH_DEFINES)
+    #define _USE_MATH_DEFINES
+  #endif
 #endif
 #include <math.h>
 #ifdef NAN
 #define __PYX_NAN() ((float) NAN)
 #else
 static CYTHON_INLINE float __PYX_NAN() {
   float value;
@@ -961,205 +972,205 @@
   char enc_type;
   char new_packmode;
   char enc_packmode;
   char is_valid_array;
 } __Pyx_BufFmt_Context;
 
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":690
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":690
  * # in Cython to enable them only on the right systems.
  * 
  * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  */
 typedef npy_int8 __pyx_t_5numpy_int8_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":691
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":691
  * 
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t
  */
 typedef npy_int16 __pyx_t_5numpy_int16_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":692
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":692
  * ctypedef npy_int8       int8_t
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_int64      int64_t
  * #ctypedef npy_int96      int96_t
  */
 typedef npy_int32 __pyx_t_5numpy_int32_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":693
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":693
  * ctypedef npy_int16      int16_t
  * ctypedef npy_int32      int32_t
  * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_int96      int96_t
  * #ctypedef npy_int128     int128_t
  */
 typedef npy_int64 __pyx_t_5numpy_int64_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":697
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":697
  * #ctypedef npy_int128     int128_t
  * 
  * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  */
 typedef npy_uint8 __pyx_t_5numpy_uint8_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":698
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":698
  * 
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t
  */
 typedef npy_uint16 __pyx_t_5numpy_uint16_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":699
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":699
  * ctypedef npy_uint8      uint8_t
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uint64     uint64_t
  * #ctypedef npy_uint96     uint96_t
  */
 typedef npy_uint32 __pyx_t_5numpy_uint32_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":700
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":700
  * ctypedef npy_uint16     uint16_t
  * ctypedef npy_uint32     uint32_t
  * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_uint96     uint96_t
  * #ctypedef npy_uint128    uint128_t
  */
 typedef npy_uint64 __pyx_t_5numpy_uint64_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":704
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":704
  * #ctypedef npy_uint128    uint128_t
  * 
  * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
  * ctypedef npy_float64    float64_t
  * #ctypedef npy_float80    float80_t
  */
 typedef npy_float32 __pyx_t_5numpy_float32_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":705
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":705
  * 
  * ctypedef npy_float32    float32_t
  * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
  * #ctypedef npy_float80    float80_t
  * #ctypedef npy_float128   float128_t
  */
 typedef npy_float64 __pyx_t_5numpy_float64_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":714
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":714
  * # The int types are mapped a bit surprising --
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t
  */
 typedef npy_long __pyx_t_5numpy_int_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":715
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":715
  * # numpy.int corresponds to 'l' and numpy.long to 'q'
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longlong   longlong_t
  * 
  */
 typedef npy_longlong __pyx_t_5numpy_long_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":716
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":716
  * ctypedef npy_long       int_t
  * ctypedef npy_longlong   long_t
  * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_ulong      uint_t
  */
 typedef npy_longlong __pyx_t_5numpy_longlong_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":718
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":718
  * ctypedef npy_longlong   longlong_t
  * 
  * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t
  */
 typedef npy_ulong __pyx_t_5numpy_uint_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":719
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":719
  * 
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulong_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":720
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":720
  * ctypedef npy_ulong      uint_t
  * ctypedef npy_ulonglong  ulong_t
  * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_intp       intp_t
  */
 typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":722
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":722
  * ctypedef npy_ulonglong  ulonglong_t
  * 
  * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
  * ctypedef npy_uintp      uintp_t
  * 
  */
 typedef npy_intp __pyx_t_5numpy_intp_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":723
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":723
  * 
  * ctypedef npy_intp       intp_t
  * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_double     float_t
  */
 typedef npy_uintp __pyx_t_5numpy_uintp_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":725
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":725
  * ctypedef npy_uintp      uintp_t
  * 
  * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t
  */
 typedef npy_double __pyx_t_5numpy_float_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":726
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":726
  * 
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
  * ctypedef npy_longdouble longdouble_t
  * 
  */
 typedef npy_double __pyx_t_5numpy_double_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":727
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":727
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
 
 /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":13
- * boolTYPE = np.bool
+ * 
  * 
  * ctypedef np.int_t DTYPE_t             # <<<<<<<<<<<<<<
  * ctypedef np.float64_t floatTYPE_t
  * 
  */
 typedef __pyx_t_5numpy_int_t __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t;
 
@@ -1194,42 +1205,42 @@
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":729
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
  * 
  * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t
  */
 typedef npy_cfloat __pyx_t_5numpy_cfloat_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":730
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":730
  * 
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
  * ctypedef npy_clongdouble clongdouble_t
  * 
  */
 typedef npy_cdouble __pyx_t_5numpy_cdouble_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":731
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":731
  * ctypedef npy_cfloat      cfloat_t
  * ctypedef npy_cdouble     cdouble_t
  * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cdouble     complex_t
  */
 typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":733
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":733
  * ctypedef npy_clongdouble clongdouble_t
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
@@ -1414,14 +1425,20 @@
     (sizeof(char [1 - 2*!(cond)]) - 1)
 #ifndef Py_MEMBER_SIZE
 #define Py_MEMBER_SIZE(type, member) sizeof(((type *)0)->member)
 #endif
 #if CYTHON_FAST_PYCALL
   static size_t __pyx_pyframe_localsplus_offset = 0;
   #include "frameobject.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
   #define __Pxy_PyFrame_Initialize_Offsets()\
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
@@ -1781,79 +1798,79 @@
 static const char __pyx_k_a[] = "a";
 static const char __pyx_k_i[] = "i";
 static const char __pyx_k_j[] = "j";
 static const char __pyx_k_l[] = "l";
 static const char __pyx_k_lr[] = "lr";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_eps[] = "eps";
-static const char __pyx_k_int[] = "int";
 static const char __pyx_k_Hess[] = "Hess";
-static const char __pyx_k_bool[] = "bool";
 static const char __pyx_k_flag[] = "flag";
 static const char __pyx_k_func[] = "func";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_name[] = "__name__";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_time[] = "time";
 static const char __pyx_k_DTYPE[] = "DTYPE";
 static const char __pyx_k_finfo[] = "finfo";
-static const char __pyx_k_float[] = "float";
+static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_kstar[] = "kstar";
 static const char __pyx_k_niter[] = "niter";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_zeros[] = "zeros";
 static const char __pyx_k_detinv[] = "detinv";
 static const char __pyx_k_gf_tmp[] = "gf_tmp";
 static const char __pyx_k_grad_a[] = "grad_a";
 static const char __pyx_k_grad_f[] = "grad_f";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_nrmaxl[] = "_nrmaxl";
 static const char __pyx_k_HessInv[] = "HessInv";
 static const char __pyx_k_delta_a[] = "delta_a";
 static const char __pyx_k_delta_f[] = "delta_f";
+static const char __pyx_k_detHess[] = "detHess";
+static const char __pyx_k_float64[] = "float64";
 static const char __pyx_k_stepmax[] = "stepmax";
 static const char __pyx_k_volumes[] = "volumes";
-static const char __pyx_k_boolTYPE[] = "boolTYPE";
 static const char __pyx_k_fepsilon[] = "fepsilon";
 static const char __pyx_k_floatTYPE[] = "floatTYPE";
 static const char __pyx_k_ImportError[] = "ImportError";
+static const char __pyx_k_is_singular[] = "is_singular";
 static const char __pyx_k_cline_in_traceback[] = "cline_in_traceback";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_cython_maximum_likelihood_opt_fu[] = "cython_maximum_likelihood_opt_full.pyx";
 static const char __pyx_k_dadapy__cython_cython_maximum_li[] = "dadapy._cython.cython_maximum_likelihood_opt_full";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static PyObject *__pyx_n_s_DTYPE;
 static PyObject *__pyx_n_s_F;
 static PyObject *__pyx_n_s_Hess;
 static PyObject *__pyx_n_s_HessInv;
 static PyObject *__pyx_n_s_ImportError;
 static PyObject *__pyx_n_s_N;
 static PyObject *__pyx_n_s_a;
-static PyObject *__pyx_n_s_bool;
-static PyObject *__pyx_n_s_boolTYPE;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_kp_s_cython_maximum_likelihood_opt_fu;
 static PyObject *__pyx_n_s_dadapy__cython_cython_maximum_li;
 static PyObject *__pyx_n_s_delta_a;
 static PyObject *__pyx_n_s_delta_f;
+static PyObject *__pyx_n_s_detHess;
 static PyObject *__pyx_n_s_detinv;
 static PyObject *__pyx_n_s_eps;
 static PyObject *__pyx_n_s_fepsilon;
 static PyObject *__pyx_n_s_finfo;
 static PyObject *__pyx_n_s_flag;
-static PyObject *__pyx_n_s_float;
+static PyObject *__pyx_n_s_float64;
 static PyObject *__pyx_n_s_floatTYPE;
 static PyObject *__pyx_n_s_func;
 static PyObject *__pyx_n_s_gf_tmp;
 static PyObject *__pyx_n_s_grad_a;
 static PyObject *__pyx_n_s_grad_f;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_import;
-static PyObject *__pyx_n_s_int;
+static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_is_singular;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_kstar;
 static PyObject *__pyx_n_s_l;
 static PyObject *__pyx_n_s_lr;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_name;
 static PyObject *__pyx_n_s_niter;
@@ -1969,14 +1986,15 @@
 }
 
 static PyObject *__pyx_pf_6dadapy_7_cython_34cython_maximum_likelihood_opt_full__nrmaxl(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_F, PyArrayObject *__pyx_v_kstar, PyArrayObject *__pyx_v_volumes) {
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_v_i;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_v_j;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_v_niter;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_v_flag;
+  __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_v_is_singular;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_a;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_stepmax;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_lr;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_grad_a;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_delta_a;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_grad_f;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_delta_f;
@@ -1984,14 +2002,15 @@
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_l;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_func;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_detinv;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t __pyx_v_fepsilon;
   PyArrayObject *__pyx_v_Hess = 0;
   PyArrayObject *__pyx_v_HessInv = 0;
   npy_intp __pyx_v_N;
+  PyObject *__pyx_v_detHess = NULL;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_F;
   __Pyx_Buffer __pyx_pybuffer_F;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_Hess;
   __Pyx_Buffer __pyx_pybuffer_Hess;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_HessInv;
   __Pyx_Buffer __pyx_pybuffer_HessInv;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_kstar;
@@ -2011,21 +2030,21 @@
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_t_11;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_t_12;
   __pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   int __pyx_t_15;
-  int __pyx_t_16;
+  Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   Py_ssize_t __pyx_t_21;
-  Py_ssize_t __pyx_t_22;
+  int __pyx_t_22;
   double __pyx_t_23;
   double __pyx_t_24;
   double __pyx_t_25;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_nrmaxl", 0);
@@ -2062,15 +2081,15 @@
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_volumes.rcbuffer->pybuffer, (PyObject*)__pyx_v_volumes, &__Pyx_TypeInfo_nn___pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 18, __pyx_L1_error)
   }
   __pyx_pybuffernd_volumes.diminfo[0].strides = __pyx_pybuffernd_volumes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_volumes.diminfo[0].shape = __pyx_pybuffernd_volumes.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_volumes.diminfo[1].strides = __pyx_pybuffernd_volumes.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_volumes.diminfo[1].shape = __pyx_pybuffernd_volumes.rcbuffer->pybuffer.shape[1];
 
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":25
- *     cdef DTYPE_t                                i, j, niter, flag
+ *     cdef DTYPE_t                                i, j, niter, flag, is_singular
  *     cdef floatTYPE_t                            a, stepmax, lr, grad_a, delta_a, grad_f, delta_f, gf_tmp, l, func, detinv
  *     cdef floatTYPE_t                            fepsilon    = np.finfo(float).eps             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]      Hess        = np.zeros((2, 2))
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]      HessInv     = np.zeros((2, 2))
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -2177,572 +2196,1058 @@
     } else {__pyx_pybuffernd_HessInv.diminfo[0].strides = __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_HessInv.diminfo[0].shape = __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_HessInv.diminfo[1].strides = __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_HessInv.diminfo[1].shape = __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_6 = 0;
   __pyx_v_HessInv = ((PyArrayObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":40
- *     #     B[1,1] = +detinv * A[0,0]
+  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":30
+ * 
  * 
  *     N = F.shape[0]             # <<<<<<<<<<<<<<
+ *     is_singular = 0
  *     for i in range(N):
- * 
  */
   __pyx_v_N = (__pyx_v_F->dimensions[0]);
 
-  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":41
+  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":31
  * 
  *     N = F.shape[0]
+ *     is_singular = 0             # <<<<<<<<<<<<<<
+ *     for i in range(N):
+ * 
+ */
+  __pyx_v_is_singular = 0;
+
+  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":32
+ *     N = F.shape[0]
+ *     is_singular = 0
  *     for i in range(N):             # <<<<<<<<<<<<<<
  * 
  *         flag = 0
  */
   __pyx_t_7 = __pyx_v_N;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":43
+    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":34
  *     for i in range(N):
  * 
  *         flag = 0             # <<<<<<<<<<<<<<
  *         for j in range(kstar[i]):
  *             if volumes[i, j] < 1.0e-300:
  */
     __pyx_v_flag = 0;
 
-    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":44
+    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":35
  * 
  *         flag = 0
  *         for j in range(kstar[i]):             # <<<<<<<<<<<<<<
  *             if volumes[i, j] < 1.0e-300:
  *                 flag = 1
  */
     __pyx_t_10 = __pyx_v_i;
     if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_kstar.diminfo[0].shape;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_kstar.diminfo[0].strides));
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_j = __pyx_t_13;
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":45
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":36
  *         flag = 0
  *         for j in range(kstar[i]):
  *             if volumes[i, j] < 1.0e-300:             # <<<<<<<<<<<<<<
  *                 flag = 1
  *                 break
  */
       __pyx_t_10 = __pyx_v_i;
       __pyx_t_14 = __pyx_v_j;
       if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_volumes.diminfo[0].shape;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_volumes.diminfo[1].shape;
       __pyx_t_15 = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_volumes.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_volumes.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_volumes.diminfo[1].strides)) < 1.0e-300) != 0);
       if (__pyx_t_15) {
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":46
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":37
  *         for j in range(kstar[i]):
  *             if volumes[i, j] < 1.0e-300:
  *                 flag = 1             # <<<<<<<<<<<<<<
  *                 break
  * 
  */
         __pyx_v_flag = 1;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":47
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":38
  *             if volumes[i, j] < 1.0e-300:
  *                 flag = 1
  *                 break             # <<<<<<<<<<<<<<
  * 
  *         if flag==0:
  */
         goto __pyx_L6_break;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":45
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":36
  *         flag = 0
  *         for j in range(kstar[i]):
  *             if volumes[i, j] < 1.0e-300:             # <<<<<<<<<<<<<<
  *                 flag = 1
  *                 break
  */
       }
     }
     __pyx_L6_break:;
 
-    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":49
+    /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":40
  *                 break
  * 
  *         if flag==0:             # <<<<<<<<<<<<<<
  *             a=0.
  *             stepmax=0.1*abs(F[i])
  */
     __pyx_t_15 = ((__pyx_v_flag == 0) != 0);
     if (__pyx_t_15) {
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":50
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":41
  * 
  *         if flag==0:
  *             a=0.             # <<<<<<<<<<<<<<
  *             stepmax=0.1*abs(F[i])
- *             func=100.
+ * 
  */
       __pyx_v_a = 0.;
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":51
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":42
  *         if flag==0:
  *             a=0.
  *             stepmax=0.1*abs(F[i])             # <<<<<<<<<<<<<<
- *             func=100.
- *             niter=0
+ * 
+ *             #hessian and gradient update
  */
       __pyx_t_14 = __pyx_v_i;
       if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_F.diminfo[0].shape;
       __pyx_v_stepmax = (0.1 * fabs((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_F.diminfo[0].strides))));
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":52
- *             a=0.
- *             stepmax=0.1*abs(F[i])
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":45
+ * 
+ *             #hessian and gradient update
+ *             grad_f = float(kstar[i])             # <<<<<<<<<<<<<<
+ *             grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
+ *             Hess[0,0]=0.
+ */
+      __pyx_t_14 = __pyx_v_i;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+      __pyx_v_grad_f = ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides)));
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":46
+ *             #hessian and gradient update
+ *             grad_f = float(kstar[i])
+ *             grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.             # <<<<<<<<<<<<<<
+ *             Hess[0,0]=0.
+ *             Hess[0,1]=0.
+ */
+      __pyx_t_14 = __pyx_v_i;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+      __pyx_t_10 = __pyx_v_i;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+      __pyx_v_grad_a = ((((double)((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1)) * ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_kstar.diminfo[0].strides)))) / 2.);
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":47
+ *             grad_f = float(kstar[i])
+ *             grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
+ *             Hess[0,0]=0.             # <<<<<<<<<<<<<<
+ *             Hess[0,1]=0.
+ *             Hess[1,1]=0.
+ */
+      __pyx_t_10 = 0;
+      __pyx_t_14 = 0;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":48
+ *             grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
+ *             Hess[0,0]=0.
+ *             Hess[0,1]=0.             # <<<<<<<<<<<<<<
+ *             Hess[1,1]=0.
+ *             for j in range(kstar[i]):
+ */
+      __pyx_t_14 = 0;
+      __pyx_t_10 = 1;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":49
+ *             Hess[0,0]=0.
+ *             Hess[0,1]=0.
+ *             Hess[1,1]=0.             # <<<<<<<<<<<<<<
+ *             for j in range(kstar[i]):
+ *                 l=float(j+1)
+ */
+      __pyx_t_10 = 1;
+      __pyx_t_14 = 1;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":50
+ *             Hess[0,1]=0.
+ *             Hess[1,1]=0.
+ *             for j in range(kstar[i]):             # <<<<<<<<<<<<<<
+ *                 l=float(j+1)
+ * 
+ */
+      __pyx_t_14 = __pyx_v_i;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+      __pyx_t_11 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides));
+      __pyx_t_12 = __pyx_t_11;
+      for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
+        __pyx_v_j = __pyx_t_13;
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":51
+ *             Hess[1,1]=0.
+ *             for j in range(kstar[i]):
+ *                 l=float(j+1)             # <<<<<<<<<<<<<<
+ * 
+ *                 gf_tmp = volumes[i, j]*exp(F[i]+a*l)
+ */
+        __pyx_v_l = ((double)(__pyx_v_j + 1));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":53
+ *                 l=float(j+1)
+ * 
+ *                 gf_tmp = volumes[i, j]*exp(F[i]+a*l)             # <<<<<<<<<<<<<<
+ * 
+ *                 grad_f = grad_f - gf_tmp
+ */
+        __pyx_t_14 = __pyx_v_i;
+        __pyx_t_10 = __pyx_v_j;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_volumes.diminfo[0].shape;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_volumes.diminfo[1].shape;
+        __pyx_t_16 = __pyx_v_i;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_F.diminfo[0].shape;
+        __pyx_v_gf_tmp = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_volumes.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_volumes.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_volumes.diminfo[1].strides)) * exp(((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_F.diminfo[0].strides)) + (__pyx_v_a * __pyx_v_l))));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":55
+ *                 gf_tmp = volumes[i, j]*exp(F[i]+a*l)
+ * 
+ *                 grad_f = grad_f - gf_tmp             # <<<<<<<<<<<<<<
+ *                 grad_a = grad_a - l*gf_tmp
+ * 
+ */
+        __pyx_v_grad_f = (__pyx_v_grad_f - __pyx_v_gf_tmp);
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":56
+ * 
+ *                 grad_f = grad_f - gf_tmp
+ *                 grad_a = grad_a - l*gf_tmp             # <<<<<<<<<<<<<<
+ * 
+ *                 Hess[0,0] = Hess[0,0] - gf_tmp
+ */
+        __pyx_v_grad_a = (__pyx_v_grad_a - (__pyx_v_l * __pyx_v_gf_tmp));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":58
+ *                 grad_a = grad_a - l*gf_tmp
+ * 
+ *                 Hess[0,0] = Hess[0,0] - gf_tmp             # <<<<<<<<<<<<<<
+ *                 Hess[0,1] = Hess[0,1] - l*gf_tmp
+ *                 Hess[1,1] = Hess[1,1] - l**2*gf_tmp
+ */
+        __pyx_t_16 = 0;
+        __pyx_t_10 = 0;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_14 = 0;
+        __pyx_t_17 = 0;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) - __pyx_v_gf_tmp);
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":59
+ * 
+ *                 Hess[0,0] = Hess[0,0] - gf_tmp
+ *                 Hess[0,1] = Hess[0,1] - l*gf_tmp             # <<<<<<<<<<<<<<
+ *                 Hess[1,1] = Hess[1,1] - l**2*gf_tmp
+ *             Hess[1,0] = Hess[0,1]
+ */
+        __pyx_t_10 = 0;
+        __pyx_t_16 = 1;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_17 = 0;
+        __pyx_t_14 = 1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (__pyx_v_l * __pyx_v_gf_tmp));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":60
+ *                 Hess[0,0] = Hess[0,0] - gf_tmp
+ *                 Hess[0,1] = Hess[0,1] - l*gf_tmp
+ *                 Hess[1,1] = Hess[1,1] - l**2*gf_tmp             # <<<<<<<<<<<<<<
+ *             Hess[1,0] = Hess[0,1]
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ */
+        __pyx_t_16 = 1;
+        __pyx_t_10 = 1;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_14 = 1;
+        __pyx_t_17 = 1;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (pow(__pyx_v_l, 2.0) * __pyx_v_gf_tmp));
+      }
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":61
+ *                 Hess[0,1] = Hess[0,1] - l*gf_tmp
+ *                 Hess[1,1] = Hess[1,1] - l**2*gf_tmp
+ *             Hess[1,0] = Hess[0,1]             # <<<<<<<<<<<<<<
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *             if detHess< fepsilon:
+ */
+      __pyx_t_10 = 0;
+      __pyx_t_16 = 1;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      __pyx_t_17 = 1;
+      __pyx_t_14 = 0;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides));
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":62
+ *                 Hess[1,1] = Hess[1,1] - l**2*gf_tmp
+ *             Hess[1,0] = Hess[0,1]
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]             # <<<<<<<<<<<<<<
+ *             if detHess< fepsilon:
+ *               is_singular = 1
+ */
+      __pyx_t_16 = 0;
+      __pyx_t_10 = 0;
+      if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      __pyx_t_14 = 1;
+      __pyx_t_17 = 1;
+      if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      __pyx_t_18 = 0;
+      __pyx_t_19 = 1;
+      if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      __pyx_t_20 = 1;
+      __pyx_t_21 = 0;
+      if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+      if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+      __pyx_t_3 = PyFloat_FromDouble((((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[1].strides))))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_XDECREF_SET(__pyx_v_detHess, __pyx_t_3);
+      __pyx_t_3 = 0;
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":63
+ *             Hess[1,0] = Hess[0,1]
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *             if detHess< fepsilon:             # <<<<<<<<<<<<<<
+ *               is_singular = 1
+ *             else:
+ */
+      __pyx_t_3 = PyFloat_FromDouble(__pyx_v_fepsilon); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_detHess, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+      if (__pyx_t_15) {
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":64
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *             if detHess< fepsilon:
+ *               is_singular = 1             # <<<<<<<<<<<<<<
+ *             else:
+ *               #inversion of the hessian matrix
+ */
+        __pyx_v_is_singular = 1;
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":63
+ *             Hess[1,0] = Hess[0,1]
+ *             detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *             if detHess< fepsilon:             # <<<<<<<<<<<<<<
+ *               is_singular = 1
+ *             else:
+ */
+        goto __pyx_L11;
+      }
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":67
+ *             else:
+ *               #inversion of the hessian matrix
+ *               detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])             # <<<<<<<<<<<<<<
+ *               HessInv[0,0] = +detinv * Hess[1,1]
+ *               HessInv[1,0] = -detinv * Hess[1,0]
+ */
+      /*else*/ {
+        __pyx_t_21 = 0;
+        __pyx_t_20 = 0;
+        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_19 = 1;
+        __pyx_t_18 = 1;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_17 = 0;
+        __pyx_t_14 = 1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_10 = 1;
+        __pyx_t_16 = 0;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_v_detinv = (1. / (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)))));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":68
+ *               #inversion of the hessian matrix
+ *               detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
+ *               HessInv[0,0] = +detinv * Hess[1,1]             # <<<<<<<<<<<<<<
+ *               HessInv[1,0] = -detinv * Hess[1,0]
+ *               HessInv[0,1] = -detinv * Hess[0,1]
+ */
+        __pyx_t_16 = 1;
+        __pyx_t_10 = 1;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_14 = 0;
+        __pyx_t_17 = 0;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":69
+ *               detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
+ *               HessInv[0,0] = +detinv * Hess[1,1]
+ *               HessInv[1,0] = -detinv * Hess[1,0]             # <<<<<<<<<<<<<<
+ *               HessInv[0,1] = -detinv * Hess[0,1]
+ *               HessInv[1,1] = +detinv * Hess[0,0]
+ */
+        __pyx_t_10 = 1;
+        __pyx_t_16 = 0;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_17 = 1;
+        __pyx_t_14 = 0;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":70
+ *               HessInv[0,0] = +detinv * Hess[1,1]
+ *               HessInv[1,0] = -detinv * Hess[1,0]
+ *               HessInv[0,1] = -detinv * Hess[0,1]             # <<<<<<<<<<<<<<
+ *               HessInv[1,1] = +detinv * Hess[0,0]
+ * 
+ */
+        __pyx_t_16 = 0;
+        __pyx_t_10 = 1;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_14 = 0;
+        __pyx_t_17 = 1;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":71
+ *               HessInv[1,0] = -detinv * Hess[1,0]
+ *               HessInv[0,1] = -detinv * Hess[0,1]
+ *               HessInv[1,1] = +detinv * Hess[0,0]             # <<<<<<<<<<<<<<
+ * 
+ *             func=100.
+ */
+        __pyx_t_10 = 0;
+        __pyx_t_16 = 0;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_17 = 1;
+        __pyx_t_14 = 1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+      }
+      __pyx_L11:;
+
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":73
+ *               HessInv[1,1] = +detinv * Hess[0,0]
+ * 
  *             func=100.             # <<<<<<<<<<<<<<
  *             niter=0
  * 
  */
       __pyx_v_func = 100.;
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":53
- *             stepmax=0.1*abs(F[i])
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":74
+ * 
  *             func=100.
  *             niter=0             # <<<<<<<<<<<<<<
  * 
- *             while ( ((func)>1e-3) and (niter < 10001) ):
+ *             while ( ((func)>1e-3) and (niter < 10000) ):
  */
       __pyx_v_niter = 0;
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":55
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":76
  *             niter=0
  * 
- *             while ( ((func)>1e-3) and (niter < 10001) ):             # <<<<<<<<<<<<<<
+ *             while ( ((func)>1e-3) and (niter < 10000) ):             # <<<<<<<<<<<<<<
  * 
- *                 #hessian and gradient update
+ *                 if detHess<fepsilon:
  */
       while (1) {
-        __pyx_t_16 = ((__pyx_v_func > 1e-3) != 0);
-        if (__pyx_t_16) {
+        __pyx_t_22 = ((__pyx_v_func > 1e-3) != 0);
+        if (__pyx_t_22) {
         } else {
-          __pyx_t_15 = __pyx_t_16;
-          goto __pyx_L11_bool_binop_done;
+          __pyx_t_15 = __pyx_t_22;
+          goto __pyx_L14_bool_binop_done;
         }
-        __pyx_t_16 = ((__pyx_v_niter < 0x2711) != 0);
-        __pyx_t_15 = __pyx_t_16;
-        __pyx_L11_bool_binop_done:;
+        __pyx_t_22 = ((__pyx_v_niter < 0x2710) != 0);
+        __pyx_t_15 = __pyx_t_22;
+        __pyx_L14_bool_binop_done:;
         if (!__pyx_t_15) break;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":58
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":78
+ *             while ( ((func)>1e-3) and (niter < 10000) ):
+ * 
+ *                 if detHess<fepsilon:             # <<<<<<<<<<<<<<
+ *                   #parameter update fixed point iteration
+ *                   F[i] = ( -a*kstar[i]*(kstar[i]+1)/2  - (grad_f-kstar[i]) ) / kstar[i]
+ */
+        __pyx_t_1 = PyFloat_FromDouble(__pyx_v_fepsilon); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_1);
+        __pyx_t_3 = PyObject_RichCompare(__pyx_v_detHess, __pyx_t_1, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 78, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        if (__pyx_t_15) {
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":80
+ *                 if detHess<fepsilon:
+ *                   #parameter update fixed point iteration
+ *                   F[i] = ( -a*kstar[i]*(kstar[i]+1)/2  - (grad_f-kstar[i]) ) / kstar[i]             # <<<<<<<<<<<<<<
+ *                   a = (- F[i]*kstar[i] - (grad_f-kstar[i])) / (kstar[i]*(kstar[i]+1)/2)
+ *                 else:
+ */
+          __pyx_t_16 = __pyx_v_i;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_10 = __pyx_v_i;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_14 = __pyx_v_i;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_17 = __pyx_v_i;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_18 = __pyx_v_i;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_F.diminfo[0].shape;
+          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_F.diminfo[0].strides) = ((((((-__pyx_v_a) * (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_kstar.diminfo[0].strides))) * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1)) / 2.0) - (__pyx_v_grad_f - (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides)))) / (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_kstar.diminfo[0].strides)));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":81
+ *                   #parameter update fixed point iteration
+ *                   F[i] = ( -a*kstar[i]*(kstar[i]+1)/2  - (grad_f-kstar[i]) ) / kstar[i]
+ *                   a = (- F[i]*kstar[i] - (grad_f-kstar[i])) / (kstar[i]*(kstar[i]+1)/2)             # <<<<<<<<<<<<<<
+ *                 else:
+ *                   #parameter step calculation
+ */
+          __pyx_t_17 = __pyx_v_i;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_F.diminfo[0].shape;
+          __pyx_t_14 = __pyx_v_i;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_10 = __pyx_v_i;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_16 = __pyx_v_i;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_t_18 = __pyx_v_i;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+          __pyx_v_a = ((((-(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_F.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides))) - (__pyx_v_grad_f - (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_kstar.diminfo[0].strides)))) / (((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_kstar.diminfo[0].strides)) * ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1)) / 2));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":78
+ *             while ( ((func)>1e-3) and (niter < 10000) ):
+ * 
+ *                 if detHess<fepsilon:             # <<<<<<<<<<<<<<
+ *                   #parameter update fixed point iteration
+ *                   F[i] = ( -a*kstar[i]*(kstar[i]+1)/2  - (grad_f-kstar[i]) ) / kstar[i]
+ */
+          goto __pyx_L16;
+        }
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":84
+ *                 else:
+ *                   #parameter step calculation
+ *                   delta_f = (HessInv[0,0]*grad_f+HessInv[0,1]*grad_a)             # <<<<<<<<<<<<<<
+ *                   delta_a = (HessInv[1,0]*grad_f+HessInv[1,1]*grad_a)
+ * 
+ */
+        /*else*/ {
+          __pyx_t_18 = 0;
+          __pyx_t_16 = 0;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          __pyx_t_10 = 0;
+          __pyx_t_14 = 1;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          __pyx_v_delta_f = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_f) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_a));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":85
+ *                   #parameter step calculation
+ *                   delta_f = (HessInv[0,0]*grad_f+HessInv[0,1]*grad_a)
+ *                   delta_a = (HessInv[1,0]*grad_f+HessInv[1,1]*grad_a)             # <<<<<<<<<<<<<<
+ * 
+ *                   #learning rate/counter update
+ */
+          __pyx_t_14 = 1;
+          __pyx_t_10 = 0;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          __pyx_t_16 = 1;
+          __pyx_t_18 = 1;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          __pyx_v_delta_a = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_f) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_a));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":88
+ * 
+ *                   #learning rate/counter update
+ *                   niter=niter+1             # <<<<<<<<<<<<<<
+ *                   lr=0.1
+ *                   if (abs(lr*delta_f) > stepmax) :
+ */
+          __pyx_v_niter = (__pyx_v_niter + 1);
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":89
+ *                   #learning rate/counter update
+ *                   niter=niter+1
+ *                   lr=0.1             # <<<<<<<<<<<<<<
+ *                   if (abs(lr*delta_f) > stepmax) :
+ *                       lr=abs(stepmax/delta_f)
+ */
+          __pyx_v_lr = 0.1;
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":90
+ *                   niter=niter+1
+ *                   lr=0.1
+ *                   if (abs(lr*delta_f) > stepmax) :             # <<<<<<<<<<<<<<
+ *                       lr=abs(stepmax/delta_f)
+ * 
+ */
+          __pyx_t_15 = ((fabs((__pyx_v_lr * __pyx_v_delta_f)) > __pyx_v_stepmax) != 0);
+          if (__pyx_t_15) {
+
+            /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":91
+ *                   lr=0.1
+ *                   if (abs(lr*delta_f) > stepmax) :
+ *                       lr=abs(stepmax/delta_f)             # <<<<<<<<<<<<<<
+ * 
+ *                   #parameter update
+ */
+            __pyx_v_lr = fabs((__pyx_v_stepmax / __pyx_v_delta_f));
+
+            /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":90
+ *                   niter=niter+1
+ *                   lr=0.1
+ *                   if (abs(lr*delta_f) > stepmax) :             # <<<<<<<<<<<<<<
+ *                       lr=abs(stepmax/delta_f)
+ * 
+ */
+          }
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":94
+ * 
+ *                   #parameter update
+ *                   F[i] = F[i] - lr*delta_f             # <<<<<<<<<<<<<<
+ *                   a = a - lr*delta_a
+ * 
+ */
+          __pyx_t_18 = __pyx_v_i;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_F.diminfo[0].shape;
+          __pyx_t_16 = __pyx_v_i;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_F.diminfo[0].shape;
+          *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_F.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_F.diminfo[0].strides)) - (__pyx_v_lr * __pyx_v_delta_f));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":95
+ *                   #parameter update
+ *                   F[i] = F[i] - lr*delta_f
+ *                   a = a - lr*delta_a             # <<<<<<<<<<<<<<
+ * 
+ *                 #gradient calculation at F[i]: it must be computed after F update to provide a consistent check of func
+ */
+          __pyx_v_a = (__pyx_v_a - (__pyx_v_lr * __pyx_v_delta_a));
+        }
+        __pyx_L16:;
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":98
  * 
- *                 #hessian and gradient update
+ *                 #gradient calculation at F[i]: it must be computed after F update to provide a consistent check of func
  *                 grad_f = float(kstar[i])             # <<<<<<<<<<<<<<
  *                 grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
  *                 Hess[0,0]=0.
  */
-        __pyx_t_14 = __pyx_v_i;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-        __pyx_v_grad_f = ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides)));
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+        __pyx_v_grad_f = ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_kstar.diminfo[0].strides)));
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":59
- *                 #hessian and gradient update
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":99
+ *                 #gradient calculation at F[i]: it must be computed after F update to provide a consistent check of func
  *                 grad_f = float(kstar[i])
  *                 grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.             # <<<<<<<<<<<<<<
  *                 Hess[0,0]=0.
  *                 Hess[0,1]=0.
  */
-        __pyx_t_14 = __pyx_v_i;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-        __pyx_t_10 = __pyx_v_i;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-        __pyx_v_grad_a = ((((double)((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1)) * ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_kstar.diminfo[0].strides)))) / 2.);
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+        __pyx_t_16 = __pyx_v_i;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+        __pyx_v_grad_a = ((((double)((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_kstar.diminfo[0].strides)) + 1)) * ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_kstar.diminfo[0].strides)))) / 2.);
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":60
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":100
  *                 grad_f = float(kstar[i])
  *                 grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
  *                 Hess[0,0]=0.             # <<<<<<<<<<<<<<
  *                 Hess[0,1]=0.
  *                 Hess[1,1]=0.
  */
-        __pyx_t_10 = 0;
-        __pyx_t_14 = 0;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+        __pyx_t_16 = 0;
+        __pyx_t_18 = 0;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":61
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":101
  *                 grad_a = float(kstar[i] + 1) * float(kstar[i]) / 2.
  *                 Hess[0,0]=0.
  *                 Hess[0,1]=0.             # <<<<<<<<<<<<<<
  *                 Hess[1,1]=0.
  *                 for j in range(kstar[i]):
  */
-        __pyx_t_14 = 0;
-        __pyx_t_10 = 1;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+        __pyx_t_18 = 0;
+        __pyx_t_16 = 1;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":62
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":102
  *                 Hess[0,0]=0.
  *                 Hess[0,1]=0.
  *                 Hess[1,1]=0.             # <<<<<<<<<<<<<<
  *                 for j in range(kstar[i]):
  *                     l=float(j+1)
  */
-        __pyx_t_10 = 1;
-        __pyx_t_14 = 1;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
+        __pyx_t_16 = 1;
+        __pyx_t_18 = 1;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = 0.;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":63
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":103
  *                 Hess[0,1]=0.
  *                 Hess[1,1]=0.
  *                 for j in range(kstar[i]):             # <<<<<<<<<<<<<<
  *                     l=float(j+1)
  * 
  */
-        __pyx_t_14 = __pyx_v_i;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_kstar.diminfo[0].shape;
-        __pyx_t_11 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_kstar.diminfo[0].strides));
+        __pyx_t_18 = __pyx_v_i;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_kstar.diminfo[0].shape;
+        __pyx_t_11 = (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_DTYPE_t *, __pyx_pybuffernd_kstar.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_kstar.diminfo[0].strides));
         __pyx_t_12 = __pyx_t_11;
         for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
           __pyx_v_j = __pyx_t_13;
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":64
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":104
  *                 Hess[1,1]=0.
  *                 for j in range(kstar[i]):
  *                     l=float(j+1)             # <<<<<<<<<<<<<<
  * 
  *                     gf_tmp = volumes[i, j]*exp(F[i]+a*l)
  */
           __pyx_v_l = ((double)(__pyx_v_j + 1));
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":66
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":106
  *                     l=float(j+1)
  * 
  *                     gf_tmp = volumes[i, j]*exp(F[i]+a*l)             # <<<<<<<<<<<<<<
  * 
  *                     grad_f = grad_f - gf_tmp
  */
-          __pyx_t_14 = __pyx_v_i;
-          __pyx_t_10 = __pyx_v_j;
-          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_volumes.diminfo[0].shape;
-          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_volumes.diminfo[1].shape;
-          __pyx_t_17 = __pyx_v_i;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_F.diminfo[0].shape;
-          __pyx_v_gf_tmp = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_volumes.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_volumes.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_volumes.diminfo[1].strides)) * exp(((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_F.diminfo[0].strides)) + (__pyx_v_a * __pyx_v_l))));
+          __pyx_t_18 = __pyx_v_i;
+          __pyx_t_16 = __pyx_v_j;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_volumes.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_volumes.diminfo[1].shape;
+          __pyx_t_10 = __pyx_v_i;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_F.diminfo[0].shape;
+          __pyx_v_gf_tmp = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_volumes.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_volumes.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_volumes.diminfo[1].strides)) * exp(((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_F.diminfo[0].strides)) + (__pyx_v_a * __pyx_v_l))));
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":68
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":108
  *                     gf_tmp = volumes[i, j]*exp(F[i]+a*l)
  * 
  *                     grad_f = grad_f - gf_tmp             # <<<<<<<<<<<<<<
  *                     grad_a = grad_a - l*gf_tmp
  * 
  */
           __pyx_v_grad_f = (__pyx_v_grad_f - __pyx_v_gf_tmp);
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":69
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":109
  * 
  *                     grad_f = grad_f - gf_tmp
  *                     grad_a = grad_a - l*gf_tmp             # <<<<<<<<<<<<<<
  * 
  *                     Hess[0,0] = Hess[0,0] - gf_tmp
  */
           __pyx_v_grad_a = (__pyx_v_grad_a - (__pyx_v_l * __pyx_v_gf_tmp));
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":71
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":111
  *                     grad_a = grad_a - l*gf_tmp
  * 
  *                     Hess[0,0] = Hess[0,0] - gf_tmp             # <<<<<<<<<<<<<<
  *                     Hess[0,1] = Hess[0,1] - l*gf_tmp
  *                     Hess[1,1] = Hess[1,1] - l**2*gf_tmp
  */
-          __pyx_t_17 = 0;
           __pyx_t_10 = 0;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          __pyx_t_14 = 0;
+          __pyx_t_16 = 0;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
           __pyx_t_18 = 0;
-          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) - __pyx_v_gf_tmp);
+          __pyx_t_14 = 0;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)) - __pyx_v_gf_tmp);
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":72
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":112
  * 
  *                     Hess[0,0] = Hess[0,0] - gf_tmp
  *                     Hess[0,1] = Hess[0,1] - l*gf_tmp             # <<<<<<<<<<<<<<
  *                     Hess[1,1] = Hess[1,1] - l**2*gf_tmp
  *                 Hess[1,0] = Hess[0,1]
  */
-          __pyx_t_10 = 0;
-          __pyx_t_17 = 1;
-          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          __pyx_t_18 = 0;
-          __pyx_t_14 = 1;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (__pyx_v_l * __pyx_v_gf_tmp));
+          __pyx_t_16 = 0;
+          __pyx_t_10 = 1;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_14 = 0;
+          __pyx_t_18 = 1;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (__pyx_v_l * __pyx_v_gf_tmp));
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":73
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":113
  *                     Hess[0,0] = Hess[0,0] - gf_tmp
  *                     Hess[0,1] = Hess[0,1] - l*gf_tmp
  *                     Hess[1,1] = Hess[1,1] - l**2*gf_tmp             # <<<<<<<<<<<<<<
  *                 Hess[1,0] = Hess[0,1]
  * 
  */
-          __pyx_t_17 = 1;
           __pyx_t_10 = 1;
-          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          __pyx_t_14 = 1;
+          __pyx_t_16 = 1;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
           __pyx_t_18 = 1;
-          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (pow(__pyx_v_l, 2.0) * __pyx_v_gf_tmp));
+          __pyx_t_14 = 1;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)) - (pow(__pyx_v_l, 2.0) * __pyx_v_gf_tmp));
         }
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":74
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":114
  *                     Hess[0,1] = Hess[0,1] - l*gf_tmp
  *                     Hess[1,1] = Hess[1,1] - l**2*gf_tmp
  *                 Hess[1,0] = Hess[0,1]             # <<<<<<<<<<<<<<
  * 
- *                 #inversion of the hessian matrix
- */
-        __pyx_t_10 = 0;
-        __pyx_t_17 = 1;
-        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_18 = 1;
-        __pyx_t_14 = 0;
-        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":77
- * 
- *                 #inversion of the hessian matrix
- *                 detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])             # <<<<<<<<<<<<<<
- *                 HessInv[0,0] = +detinv * Hess[1,1]
- *                 HessInv[1,0] = -detinv * Hess[1,0]
+ *                 detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
  */
-        __pyx_t_17 = 0;
-        __pyx_t_10 = 0;
-        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        __pyx_t_16 = 0;
+        __pyx_t_10 = 1;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
         if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
         __pyx_t_14 = 1;
-        __pyx_t_18 = 1;
+        __pyx_t_18 = 0;
         if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
         if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_19 = 0;
-        __pyx_t_20 = 1;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_21 = 1;
-        __pyx_t_22 = 0;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_v_detinv = (1. / (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Hess.diminfo[1].strides)))));
+        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides));
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":78
- *                 #inversion of the hessian matrix
- *                 detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
- *                 HessInv[0,0] = +detinv * Hess[1,1]             # <<<<<<<<<<<<<<
- *                 HessInv[1,0] = -detinv * Hess[1,0]
- *                 HessInv[0,1] = -detinv * Hess[0,1]
- */
-        __pyx_t_22 = 1;
-        __pyx_t_21 = 1;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_20 = 0;
-        __pyx_t_19 = 0;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[1].strides)));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":79
- *                 detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
- *                 HessInv[0,0] = +detinv * Hess[1,1]
- *                 HessInv[1,0] = -detinv * Hess[1,0]             # <<<<<<<<<<<<<<
- *                 HessInv[0,1] = -detinv * Hess[0,1]
- *                 HessInv[1,1] = +detinv * Hess[0,0]
- */
-        __pyx_t_21 = 1;
-        __pyx_t_22 = 0;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_19 = 1;
-        __pyx_t_20 = 0;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Hess.diminfo[1].strides)));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":80
- *                 HessInv[0,0] = +detinv * Hess[1,1]
- *                 HessInv[1,0] = -detinv * Hess[1,0]
- *                 HessInv[0,1] = -detinv * Hess[0,1]             # <<<<<<<<<<<<<<
- *                 HessInv[1,1] = +detinv * Hess[0,0]
- * 
- */
-        __pyx_t_22 = 0;
-        __pyx_t_21 = 1;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[1].shape;
-        __pyx_t_20 = 0;
-        __pyx_t_19 = 1;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[1].strides)));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":81
- *                 HessInv[1,0] = -detinv * Hess[1,0]
- *                 HessInv[0,1] = -detinv * Hess[0,1]
- *                 HessInv[1,1] = +detinv * Hess[0,0]             # <<<<<<<<<<<<<<
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":116
+ *                 Hess[1,0] = Hess[0,1]
  * 
- *                 #parameter step calculation
+ *                 detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]             # <<<<<<<<<<<<<<
+ *                 if detHess < fepsilon:
+ *                   is_singular = 1
  */
-        __pyx_t_21 = 0;
-        __pyx_t_22 = 0;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[0].shape;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_10 = 0;
+        __pyx_t_16 = 0;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_18 = 1;
+        __pyx_t_14 = 1;
+        if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_17 = 0;
         __pyx_t_19 = 1;
+        if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Hess.diminfo[1].shape;
         __pyx_t_20 = 1;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+        __pyx_t_21 = 0;
+        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+        __pyx_t_3 = PyFloat_FromDouble((((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[1].strides))))); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_DECREF_SET(__pyx_v_detHess, __pyx_t_3);
+        __pyx_t_3 = 0;
+
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":117
+ * 
+ *                 detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *                 if detHess < fepsilon:             # <<<<<<<<<<<<<<
+ *                   is_singular = 1
+ * 
+ */
+        __pyx_t_3 = PyFloat_FromDouble(__pyx_v_fepsilon); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_1 = PyObject_RichCompare(__pyx_v_detHess, __pyx_t_3, Py_LT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __pyx_t_15 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_15 < 0)) __PYX_ERR(0, 117, __pyx_L1_error)
+        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+        if (__pyx_t_15) {
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":84
- * 
- *                 #parameter step calculation
- *                 delta_f = (HessInv[0,0]*grad_f+HessInv[0,1]*grad_a)             # <<<<<<<<<<<<<<
- *                 delta_a = (HessInv[1,0]*grad_f+HessInv[1,1]*grad_a)
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":118
+ *                 detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *                 if detHess < fepsilon:
+ *                   is_singular = 1             # <<<<<<<<<<<<<<
  * 
+ *                 else:
  */
-        __pyx_t_22 = 0;
-        __pyx_t_21 = 0;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        __pyx_t_20 = 0;
-        __pyx_t_19 = 1;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        __pyx_v_delta_f = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_21, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_f) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_a));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":85
- *                 #parameter step calculation
- *                 delta_f = (HessInv[0,0]*grad_f+HessInv[0,1]*grad_a)
- *                 delta_a = (HessInv[1,0]*grad_f+HessInv[1,1]*grad_a)             # <<<<<<<<<<<<<<
+          __pyx_v_is_singular = 1;
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":117
  * 
- *                 #learning rate/counter update
- */
-        __pyx_t_19 = 1;
-        __pyx_t_20 = 0;
-        if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        __pyx_t_21 = 1;
-        __pyx_t_22 = 1;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
-        __pyx_v_delta_a = (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_f) + ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_HessInv.diminfo[1].strides)) * __pyx_v_grad_a));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":88
- * 
- *                 #learning rate/counter update
- *                 niter=niter+1             # <<<<<<<<<<<<<<
- *                 lr=0.1
- *                 if (abs(lr*delta_f) > stepmax) :
- */
-        __pyx_v_niter = (__pyx_v_niter + 1);
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":89
- *                 #learning rate/counter update
- *                 niter=niter+1
- *                 lr=0.1             # <<<<<<<<<<<<<<
- *                 if (abs(lr*delta_f) > stepmax) :
- *                     lr=abs(stepmax/delta_f)
- */
-        __pyx_v_lr = 0.1;
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":90
- *                 niter=niter+1
- *                 lr=0.1
- *                 if (abs(lr*delta_f) > stepmax) :             # <<<<<<<<<<<<<<
- *                     lr=abs(stepmax/delta_f)
+ *                 detHess = Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0]
+ *                 if detHess < fepsilon:             # <<<<<<<<<<<<<<
+ *                   is_singular = 1
  * 
  */
-        __pyx_t_15 = ((fabs((__pyx_v_lr * __pyx_v_delta_f)) > __pyx_v_stepmax) != 0);
-        if (__pyx_t_15) {
+          goto __pyx_L20;
+        }
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":91
- *                 lr=0.1
- *                 if (abs(lr*delta_f) > stepmax) :
- *                     lr=abs(stepmax/delta_f)             # <<<<<<<<<<<<<<
- * 
- *                 #parameter update
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":122
+ *                 else:
+ *                   #inversion of the hessian matrix
+ *                   detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])             # <<<<<<<<<<<<<<
+ *                   HessInv[0,0] = +detinv * Hess[1,1]
+ *                   HessInv[1,0] = -detinv * Hess[1,0]
  */
-          __pyx_v_lr = fabs((__pyx_v_stepmax / __pyx_v_delta_f));
+        /*else*/ {
+          __pyx_t_21 = 0;
+          __pyx_t_20 = 0;
+          if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_20 < 0) __pyx_t_20 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_19 = 1;
+          __pyx_t_17 = 1;
+          if (__pyx_t_19 < 0) __pyx_t_19 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_17 < 0) __pyx_t_17 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_14 = 0;
+          __pyx_t_18 = 1;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_16 = 1;
+          __pyx_t_10 = 0;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_v_detinv = (1. / (((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_20, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Hess.diminfo[1].strides))) - ((*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_Hess.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)))));
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":90
- *                 niter=niter+1
- *                 lr=0.1
- *                 if (abs(lr*delta_f) > stepmax) :             # <<<<<<<<<<<<<<
- *                     lr=abs(stepmax/delta_f)
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":123
+ *                   #inversion of the hessian matrix
+ *                   detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
+ *                   HessInv[0,0] = +detinv * Hess[1,1]             # <<<<<<<<<<<<<<
+ *                   HessInv[1,0] = -detinv * Hess[1,0]
+ *                   HessInv[0,1] = -detinv * Hess[0,1]
+ */
+          __pyx_t_10 = 1;
+          __pyx_t_16 = 1;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_18 = 0;
+          __pyx_t_14 = 0;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":124
+ *                   detinv = 1./(Hess[0,0]*Hess[1,1] - Hess[0,1]*Hess[1,0])
+ *                   HessInv[0,0] = +detinv * Hess[1,1]
+ *                   HessInv[1,0] = -detinv * Hess[1,0]             # <<<<<<<<<<<<<<
+ *                   HessInv[0,1] = -detinv * Hess[0,1]
+ *                   HessInv[1,1] = +detinv * Hess[0,0]
+ */
+          __pyx_t_16 = 1;
+          __pyx_t_10 = 0;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_14 = 1;
+          __pyx_t_18 = 0;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":125
+ *                   HessInv[0,0] = +detinv * Hess[1,1]
+ *                   HessInv[1,0] = -detinv * Hess[1,0]
+ *                   HessInv[0,1] = -detinv * Hess[0,1]             # <<<<<<<<<<<<<<
+ *                   HessInv[1,1] = +detinv * Hess[0,0]
  * 
  */
-        }
+          __pyx_t_10 = 0;
+          __pyx_t_16 = 1;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_18 = 0;
+          __pyx_t_14 = 1;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[1].strides) = ((-__pyx_v_detinv) * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[1].strides)));
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":94
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":126
+ *                   HessInv[1,0] = -detinv * Hess[1,0]
+ *                   HessInv[0,1] = -detinv * Hess[0,1]
+ *                   HessInv[1,1] = +detinv * Hess[0,0]             # <<<<<<<<<<<<<<
  * 
- *                 #parameter update
- *                 F[i] = F[i] - lr*delta_f             # <<<<<<<<<<<<<<
- *                 a = a - lr*delta_a
  * 
  */
-        __pyx_t_22 = __pyx_v_i;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_F.diminfo[0].shape;
-        __pyx_t_21 = __pyx_v_i;
-        if (__pyx_t_21 < 0) __pyx_t_21 += __pyx_pybuffernd_F.diminfo[0].shape;
-        *__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_F.diminfo[0].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_F.diminfo[0].strides)) - (__pyx_v_lr * __pyx_v_delta_f));
+          __pyx_t_16 = 0;
+          __pyx_t_10 = 0;
+          if (__pyx_t_16 < 0) __pyx_t_16 += __pyx_pybuffernd_Hess.diminfo[0].shape;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_Hess.diminfo[1].shape;
+          __pyx_t_14 = 1;
+          __pyx_t_18 = 1;
+          if (__pyx_t_14 < 0) __pyx_t_14 += __pyx_pybuffernd_HessInv.diminfo[0].shape;
+          if (__pyx_t_18 < 0) __pyx_t_18 += __pyx_pybuffernd_HessInv.diminfo[1].shape;
+          *__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_HessInv.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_HessInv.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_HessInv.diminfo[1].strides) = (__pyx_v_detinv * (*__Pyx_BufPtrStrided2d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_Hess.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Hess.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_Hess.diminfo[1].strides)));
+        }
+        __pyx_L20:;
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":95
- *                 #parameter update
- *                 F[i] = F[i] - lr*delta_f
- *                 a = a - lr*delta_a             # <<<<<<<<<<<<<<
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":130
  * 
- *                 if ((abs(a) <= fepsilon ) or (abs(F[i]) <= fepsilon )):
- */
-        __pyx_v_a = (__pyx_v_a - (__pyx_v_lr * __pyx_v_delta_a));
-
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":97
- *                 a = a - lr*delta_a
  * 
  *                 if ((abs(a) <= fepsilon ) or (abs(F[i]) <= fepsilon )):             # <<<<<<<<<<<<<<
  *                     func = max(abs(grad_f),abs(grad_a))
  *                 else:
  */
-        __pyx_t_16 = ((fabs(__pyx_v_a) <= __pyx_v_fepsilon) != 0);
-        if (!__pyx_t_16) {
+        __pyx_t_22 = ((fabs(__pyx_v_a) <= __pyx_v_fepsilon) != 0);
+        if (!__pyx_t_22) {
         } else {
-          __pyx_t_15 = __pyx_t_16;
-          goto __pyx_L17_bool_binop_done;
+          __pyx_t_15 = __pyx_t_22;
+          goto __pyx_L22_bool_binop_done;
         }
-        __pyx_t_22 = __pyx_v_i;
-        if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_F.diminfo[0].shape;
-        __pyx_t_16 = ((fabs((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_F.diminfo[0].strides))) <= __pyx_v_fepsilon) != 0);
-        __pyx_t_15 = __pyx_t_16;
-        __pyx_L17_bool_binop_done:;
+        __pyx_t_10 = __pyx_v_i;
+        if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_F.diminfo[0].shape;
+        __pyx_t_22 = ((fabs((*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_F.diminfo[0].strides))) <= __pyx_v_fepsilon) != 0);
+        __pyx_t_15 = __pyx_t_22;
+        __pyx_L22_bool_binop_done:;
         if (__pyx_t_15) {
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":98
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":131
  * 
  *                 if ((abs(a) <= fepsilon ) or (abs(F[i]) <= fepsilon )):
  *                     func = max(abs(grad_f),abs(grad_a))             # <<<<<<<<<<<<<<
  *                 else:
  *                     func = max(abs(grad_f/F[i]),abs(grad_a/a))
  */
           __pyx_t_23 = fabs(__pyx_v_grad_a);
@@ -2750,63 +3255,74 @@
           if (((__pyx_t_23 > __pyx_t_24) != 0)) {
             __pyx_t_25 = __pyx_t_23;
           } else {
             __pyx_t_25 = __pyx_t_24;
           }
           __pyx_v_func = __pyx_t_25;
 
-          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":97
- *                 a = a - lr*delta_a
+          /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":130
+ * 
  * 
  *                 if ((abs(a) <= fepsilon ) or (abs(F[i]) <= fepsilon )):             # <<<<<<<<<<<<<<
  *                     func = max(abs(grad_f),abs(grad_a))
  *                 else:
  */
-          goto __pyx_L16;
+          goto __pyx_L21;
         }
 
-        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":100
+        /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":133
  *                     func = max(abs(grad_f),abs(grad_a))
  *                 else:
  *                     func = max(abs(grad_f/F[i]),abs(grad_a/a))             # <<<<<<<<<<<<<<
- *     return F
+ * 
+ * 
  */
         /*else*/ {
           __pyx_t_25 = fabs((__pyx_v_grad_a / __pyx_v_a));
-          __pyx_t_22 = __pyx_v_i;
-          if (__pyx_t_22 < 0) __pyx_t_22 += __pyx_pybuffernd_F.diminfo[0].shape;
-          __pyx_t_23 = fabs((__pyx_v_grad_f / (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_F.diminfo[0].strides))));
+          __pyx_t_10 = __pyx_v_i;
+          if (__pyx_t_10 < 0) __pyx_t_10 += __pyx_pybuffernd_F.diminfo[0].shape;
+          __pyx_t_23 = fabs((__pyx_v_grad_f / (*__Pyx_BufPtrStrided1d(__pyx_t_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_floatTYPE_t *, __pyx_pybuffernd_F.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_F.diminfo[0].strides))));
           if (((__pyx_t_25 > __pyx_t_23) != 0)) {
             __pyx_t_24 = __pyx_t_25;
           } else {
             __pyx_t_24 = __pyx_t_23;
           }
           __pyx_v_func = __pyx_t_24;
         }
-        __pyx_L16:;
+        __pyx_L21:;
       }
 
-      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":49
+      /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":40
  *                 break
  * 
  *         if flag==0:             # <<<<<<<<<<<<<<
  *             a=0.
  *             stepmax=0.1*abs(F[i])
  */
     }
   }
 
-  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":101
- *                 else:
- *                     func = max(abs(grad_f/F[i]),abs(grad_a/a))
- *     return F             # <<<<<<<<<<<<<<
+  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":137
+ * 
+ * 
+ *     return F, is_singular             # <<<<<<<<<<<<<<
  */
   __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyInt_From_npy_long(__pyx_v_is_singular); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_F));
-  __pyx_r = ((PyObject *)__pyx_v_F);
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_F));
+  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_F));
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
+  __pyx_t_1 = 0;
+  __pyx_r = __pyx_t_3;
+  __pyx_t_3 = 0;
   goto __pyx_L0;
 
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(np.ndarray[floatTYPE_t, ndim = 1] F,             # <<<<<<<<<<<<<<
  *             np.ndarray[DTYPE_t, ndim = 1] kstar,
@@ -2836,20 +3352,21 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Hess.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_HessInv.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_kstar.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_volumes.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_Hess);
   __Pyx_XDECREF((PyObject *)__pyx_v_HessInv);
+  __Pyx_XDECREF(__pyx_v_detHess);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":735
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -2858,29 +3375,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":736
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":736
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":735
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":735
  * ctypedef npy_cdouble     complex_t
  * 
  * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  */
 
@@ -2891,15 +3408,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":738
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -2908,29 +3425,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":739
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":739
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 739, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":738
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":738
  *     return PyArray_MultiIterNew(1, <void*>a)
  * 
  * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  */
 
@@ -2941,15 +3458,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":741
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -2958,29 +3475,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":742
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":742
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":741
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":741
  *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
  * 
  * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  */
 
@@ -2991,15 +3508,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":744
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3008,29 +3525,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":745
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":745
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 745, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":744
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":744
  *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
  * 
  * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  */
 
@@ -3041,15 +3558,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":747
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3058,29 +3575,29 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":748
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":748
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 748, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":747
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":747
  *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
  * 
  * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  */
 
@@ -3091,212 +3608,212 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":750
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyDataType_SHAPE(PyArray_Descr *__pyx_v_d) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("PyDataType_SHAPE", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":751
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   __pyx_t_1 = (PyDataType_HASSUBARRAY(__pyx_v_d) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":752
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":752
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape             # <<<<<<<<<<<<<<
  *     else:
  *         return ()
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject*)__pyx_v_d->subarray->shape));
     __pyx_r = ((PyObject*)__pyx_v_d->subarray->shape);
     goto __pyx_L0;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":751
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":751
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):
  *     if PyDataType_HASSUBARRAY(d):             # <<<<<<<<<<<<<<
  *         return <tuple>d.subarray.shape
  *     else:
  */
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":754
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":754
  *         return <tuple>d.subarray.shape
  *     else:
  *         return ()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_empty_tuple);
     __pyx_r = __pyx_empty_tuple;
     goto __pyx_L0;
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":750
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":750
  *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
  * 
  * cdef inline tuple PyDataType_SHAPE(dtype d):             # <<<<<<<<<<<<<<
  *     if PyDataType_HASSUBARRAY(d):
  *         return <tuple>d.subarray.shape
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":929
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
 static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("set_array_base", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":930
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":930
  * 
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!             # <<<<<<<<<<<<<<
  *     PyArray_SetBaseObject(arr, base)
  * 
  */
   Py_INCREF(__pyx_v_base);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":931
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":931
  * cdef inline void set_array_base(ndarray arr, object base):
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)             # <<<<<<<<<<<<<<
  * 
  * cdef inline object get_array_base(ndarray arr):
  */
   (void)(PyArray_SetBaseObject(__pyx_v_arr, __pyx_v_base));
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":929
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":929
  *     int _import_umath() except -1
  * 
  * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
  *     Py_INCREF(base) # important to do this before stealing the reference below!
  *     PyArray_SetBaseObject(arr, base)
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":933
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
 static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
   PyObject *__pyx_v_base;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("get_array_base", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":934
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":934
  * 
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)             # <<<<<<<<<<<<<<
  *     if base is NULL:
  *         return None
  */
   __pyx_v_base = PyArray_BASE(__pyx_v_arr);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":935
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   __pyx_t_1 = ((__pyx_v_base == NULL) != 0);
   if (__pyx_t_1) {
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":936
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":936
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  *         return None             # <<<<<<<<<<<<<<
  *     return <object>base
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":935
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":935
  * cdef inline object get_array_base(ndarray arr):
  *     base = PyArray_BASE(arr)
  *     if base is NULL:             # <<<<<<<<<<<<<<
  *         return None
  *     return <object>base
  */
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":937
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":937
  *     if base is NULL:
  *         return None
  *     return <object>base             # <<<<<<<<<<<<<<
  * 
  * # Versions of the import_* functions which are more suitable for
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_base));
   __pyx_r = ((PyObject *)__pyx_v_base);
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":933
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":933
  *     PyArray_SetBaseObject(arr, base)
  * 
  * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
  *     base = PyArray_BASE(arr)
  *     if base is NULL:
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":941
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3312,15 +3829,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_array", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
   {
@@ -3328,53 +3845,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":943
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":943
  * cdef inline int import_array() except -1:
  *     try:
  *         __pyx_import_array()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")
  */
       __pyx_t_4 = _import_array(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 943, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":944
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":944
  *     try:
  *         __pyx_import_array()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 944, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":945
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
@@ -3382,30 +3899,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":942
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":942
  * # Cython code.
  * cdef inline int import_array() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         __pyx_import_array()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":941
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":941
  * # Versions of the import_* functions which are more suitable for
  * # Cython code.
  * cdef inline int import_array() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         __pyx_import_array()
  */
 
@@ -3420,15 +3937,15 @@
   __Pyx_AddTraceback("numpy.import_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":947
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3444,15 +3961,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_umath", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3460,53 +3977,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":949
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":949
  * cdef inline int import_umath() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 949, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":950
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":950
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 950, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":951
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
@@ -3514,30 +4031,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":948
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":948
  * 
  * cdef inline int import_umath() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":947
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":947
  *         raise ImportError("numpy.core.multiarray failed to import")
  * 
  * cdef inline int import_umath() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3552,15 +4069,15 @@
   __Pyx_AddTraceback("numpy.import_umath", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":953
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3576,15 +4093,15 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("import_ufunc", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
   {
@@ -3592,53 +4109,53 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":955
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":955
  * cdef inline int import_ufunc() except -1:
  *     try:
  *         _import_umath()             # <<<<<<<<<<<<<<
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")
  */
       __pyx_t_4 = _import_umath(); if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(1, 955, __pyx_L3_error)
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     }
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_try_end;
     __pyx_L3_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":956
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":956
  *     try:
  *         _import_umath()
  *     except Exception:             # <<<<<<<<<<<<<<
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  */
     __pyx_t_4 = __Pyx_PyErr_ExceptionMatches(((PyObject *)(&((PyTypeObject*)PyExc_Exception)[0])));
     if (__pyx_t_4) {
       __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
       if (__Pyx_GetException(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7) < 0) __PYX_ERR(1, 956, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":957
+      /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
       __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
@@ -3646,30 +4163,30 @@
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":954
+    /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":954
  * 
  * cdef inline int import_ufunc() except -1:
  *     try:             # <<<<<<<<<<<<<<
  *         _import_umath()
  *     except Exception:
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":953
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":953
  *         raise ImportError("numpy.core.umath failed to import")
  * 
  * cdef inline int import_ufunc() except -1:             # <<<<<<<<<<<<<<
  *     try:
  *         _import_umath()
  */
 
@@ -3684,176 +4201,176 @@
   __Pyx_AddTraceback("numpy.import_ufunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":967
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_timedelta64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_timedelta64_object", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":979
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":979
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyTimedeltaArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyTimedeltaArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":967
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":967
  * 
  * 
  * cdef inline bint is_timedelta64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.timedelta64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":982
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
 static CYTHON_INLINE int __pyx_f_5numpy_is_datetime64_object(PyObject *__pyx_v_obj) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_datetime64_object", 0);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":994
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":994
  *     bool
  *     """
  *     return PyObject_TypeCheck(obj, &PyDatetimeArrType_Type)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = PyObject_TypeCheck(__pyx_v_obj, (&PyDatetimeArrType_Type));
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":982
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":982
  * 
  * 
  * cdef inline bint is_datetime64_object(object obj):             # <<<<<<<<<<<<<<
  *     """
  *     Cython equivalent of `isinstance(obj, np.datetime64)`
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":997
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
 static CYTHON_INLINE npy_datetime __pyx_f_5numpy_get_datetime64_value(PyObject *__pyx_v_obj) {
   npy_datetime __pyx_r;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1004
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1004
  *     also needed.  That can be found using `get_datetime64_unit`.
  *     """
  *     return (<PyDatetimeScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyDatetimeScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":997
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":997
  * 
  * 
  * cdef inline npy_datetime get_datetime64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy datetime64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1007
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
 static CYTHON_INLINE npy_timedelta __pyx_f_5numpy_get_timedelta64_value(PyObject *__pyx_v_obj) {
   npy_timedelta __pyx_r;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1011
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1011
  *     returns the int64 value underlying scalar numpy timedelta64 object
  *     """
  *     return (<PyTimedeltaScalarObject*>obj).obval             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((PyTimedeltaScalarObject *)__pyx_v_obj)->obval;
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1007
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1007
  * 
  * 
  * cdef inline npy_timedelta get_timedelta64_value(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the int64 value underlying scalar numpy timedelta64 object
  */
 
   /* function exit code */
   __pyx_L0:;
   return __pyx_r;
 }
 
-/* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+/* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
 static CYTHON_INLINE NPY_DATETIMEUNIT __pyx_f_5numpy_get_datetime64_unit(PyObject *__pyx_v_obj) {
   NPY_DATETIMEUNIT __pyx_r;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1018
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1018
  *     returns the unit part of the dtype for a numpy datetime64 object.
  *     """
  *     return <NPY_DATETIMEUNIT>(<PyDatetimeScalarObject*>obj).obmeta.base             # <<<<<<<<<<<<<<
  */
   __pyx_r = ((NPY_DATETIMEUNIT)((PyDatetimeScalarObject *)__pyx_v_obj)->obmeta.base);
   goto __pyx_L0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -3911,35 +4428,35 @@
   {&__pyx_n_s_DTYPE, __pyx_k_DTYPE, sizeof(__pyx_k_DTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_F, __pyx_k_F, sizeof(__pyx_k_F), 0, 0, 1, 1},
   {&__pyx_n_s_Hess, __pyx_k_Hess, sizeof(__pyx_k_Hess), 0, 0, 1, 1},
   {&__pyx_n_s_HessInv, __pyx_k_HessInv, sizeof(__pyx_k_HessInv), 0, 0, 1, 1},
   {&__pyx_n_s_ImportError, __pyx_k_ImportError, sizeof(__pyx_k_ImportError), 0, 0, 1, 1},
   {&__pyx_n_s_N, __pyx_k_N, sizeof(__pyx_k_N), 0, 0, 1, 1},
   {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
-  {&__pyx_n_s_bool, __pyx_k_bool, sizeof(__pyx_k_bool), 0, 0, 1, 1},
-  {&__pyx_n_s_boolTYPE, __pyx_k_boolTYPE, sizeof(__pyx_k_boolTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_kp_s_cython_maximum_likelihood_opt_fu, __pyx_k_cython_maximum_likelihood_opt_fu, sizeof(__pyx_k_cython_maximum_likelihood_opt_fu), 0, 0, 1, 0},
   {&__pyx_n_s_dadapy__cython_cython_maximum_li, __pyx_k_dadapy__cython_cython_maximum_li, sizeof(__pyx_k_dadapy__cython_cython_maximum_li), 0, 0, 1, 1},
   {&__pyx_n_s_delta_a, __pyx_k_delta_a, sizeof(__pyx_k_delta_a), 0, 0, 1, 1},
   {&__pyx_n_s_delta_f, __pyx_k_delta_f, sizeof(__pyx_k_delta_f), 0, 0, 1, 1},
+  {&__pyx_n_s_detHess, __pyx_k_detHess, sizeof(__pyx_k_detHess), 0, 0, 1, 1},
   {&__pyx_n_s_detinv, __pyx_k_detinv, sizeof(__pyx_k_detinv), 0, 0, 1, 1},
   {&__pyx_n_s_eps, __pyx_k_eps, sizeof(__pyx_k_eps), 0, 0, 1, 1},
   {&__pyx_n_s_fepsilon, __pyx_k_fepsilon, sizeof(__pyx_k_fepsilon), 0, 0, 1, 1},
   {&__pyx_n_s_finfo, __pyx_k_finfo, sizeof(__pyx_k_finfo), 0, 0, 1, 1},
   {&__pyx_n_s_flag, __pyx_k_flag, sizeof(__pyx_k_flag), 0, 0, 1, 1},
-  {&__pyx_n_s_float, __pyx_k_float, sizeof(__pyx_k_float), 0, 0, 1, 1},
+  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
   {&__pyx_n_s_floatTYPE, __pyx_k_floatTYPE, sizeof(__pyx_k_floatTYPE), 0, 0, 1, 1},
   {&__pyx_n_s_func, __pyx_k_func, sizeof(__pyx_k_func), 0, 0, 1, 1},
   {&__pyx_n_s_gf_tmp, __pyx_k_gf_tmp, sizeof(__pyx_k_gf_tmp), 0, 0, 1, 1},
   {&__pyx_n_s_grad_a, __pyx_k_grad_a, sizeof(__pyx_k_grad_a), 0, 0, 1, 1},
   {&__pyx_n_s_grad_f, __pyx_k_grad_f, sizeof(__pyx_k_grad_f), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
-  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
+  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_is_singular, __pyx_k_is_singular, sizeof(__pyx_k_is_singular), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_kstar, __pyx_k_kstar, sizeof(__pyx_k_kstar), 0, 0, 1, 1},
   {&__pyx_n_s_l, __pyx_k_l, sizeof(__pyx_k_l), 0, 0, 1, 1},
   {&__pyx_n_s_lr, __pyx_k_lr, sizeof(__pyx_k_lr), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_name, __pyx_k_name, sizeof(__pyx_k_name), 0, 0, 1, 1},
   {&__pyx_n_s_niter, __pyx_k_niter, sizeof(__pyx_k_niter), 0, 0, 1, 1},
@@ -3953,15 +4470,15 @@
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
   {&__pyx_n_s_time, __pyx_k_time, sizeof(__pyx_k_time), 0, 0, 1, 1},
   {&__pyx_n_s_volumes, __pyx_k_volumes, sizeof(__pyx_k_volumes), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 41, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 32, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
@@ -3975,26 +4492,26 @@
  *     cdef np.ndarray[floatTYPE_t, ndim = 2]      HessInv     = np.zeros((2, 2))
  * 
  */
   __pyx_tuple_ = PyTuple_Pack(2, __pyx_int_2, __pyx_int_2); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 26, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple_);
   __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":945
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
   __pyx_tuple__2 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(1, 945, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__2);
   __Pyx_GIVEREF(__pyx_tuple__2);
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":951
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__3 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(1, 951, __pyx_L1_error)
@@ -4004,18 +4521,18 @@
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(np.ndarray[floatTYPE_t, ndim = 1] F,             # <<<<<<<<<<<<<<
  *             np.ndarray[DTYPE_t, ndim = 1] kstar,
  *             np.ndarray[floatTYPE_t, ndim = 2] volumes):
  */
-  __pyx_tuple__4 = PyTuple_Pack(22, __pyx_n_s_F, __pyx_n_s_kstar, __pyx_n_s_volumes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_niter, __pyx_n_s_flag, __pyx_n_s_a, __pyx_n_s_stepmax, __pyx_n_s_lr, __pyx_n_s_grad_a, __pyx_n_s_delta_a, __pyx_n_s_grad_f, __pyx_n_s_delta_f, __pyx_n_s_gf_tmp, __pyx_n_s_l, __pyx_n_s_func, __pyx_n_s_detinv, __pyx_n_s_fepsilon, __pyx_n_s_Hess, __pyx_n_s_HessInv, __pyx_n_s_N); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 18, __pyx_L1_error)
+  __pyx_tuple__4 = PyTuple_Pack(24, __pyx_n_s_F, __pyx_n_s_kstar, __pyx_n_s_volumes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_niter, __pyx_n_s_flag, __pyx_n_s_is_singular, __pyx_n_s_a, __pyx_n_s_stepmax, __pyx_n_s_lr, __pyx_n_s_grad_a, __pyx_n_s_delta_a, __pyx_n_s_grad_f, __pyx_n_s_delta_f, __pyx_n_s_gf_tmp, __pyx_n_s_l, __pyx_n_s_func, __pyx_n_s_detinv, __pyx_n_s_fepsilon, __pyx_n_s_Hess, __pyx_n_s_HessInv, __pyx_n_s_N, __pyx_n_s_detHess); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__4);
   __Pyx_GIVEREF(__pyx_tuple__4);
-  __pyx_codeobj__5 = (PyObject*)__Pyx_PyCode_New(3, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__4, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_maximum_likelihood_opt_fu, __pyx_n_s_nrmaxl, 18, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 18, __pyx_L1_error)
+  __pyx_codeobj__5 = (PyObject*)__Pyx_PyCode_New(3, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__4, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_cython_maximum_likelihood_opt_fu, __pyx_n_s_nrmaxl, 18, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 18, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -4365,79 +4882,64 @@
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":9
  * from libc.math cimport exp
  * 
- * DTYPE = np.int             # <<<<<<<<<<<<<<
- * floatTYPE = np.float
- * boolTYPE = np.bool
+ * DTYPE = np.int64             # <<<<<<<<<<<<<<
+ * floatTYPE = np.float64
+ * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":10
  * 
- * DTYPE = np.int
- * floatTYPE = np.float             # <<<<<<<<<<<<<<
- * boolTYPE = np.bool
+ * DTYPE = np.int64
+ * floatTYPE = np.float64             # <<<<<<<<<<<<<<
+ * 
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_floatTYPE, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":11
- * DTYPE = np.int
- * floatTYPE = np.float
- * boolTYPE = np.bool             # <<<<<<<<<<<<<<
- * 
- * ctypedef np.int_t DTYPE_t
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_bool); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_boolTYPE, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":18
  * @cython.boundscheck(False)
  * @cython.cdivision(True)
  * def _nrmaxl(np.ndarray[floatTYPE_t, ndim = 1] F,             # <<<<<<<<<<<<<<
  *             np.ndarray[DTYPE_t, ndim = 1] kstar,
  *             np.ndarray[floatTYPE_t, ndim = 2] volumes):
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_1_nrmaxl, NULL, __pyx_n_s_dadapy__cython_cython_maximum_li); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_nrmaxl, __pyx_t_2) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_6dadapy_7_cython_34cython_maximum_likelihood_opt_full_1_nrmaxl, NULL, __pyx_n_s_dadapy__cython_cython_maximum_li); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_nrmaxl, __pyx_t_1) < 0) __PYX_ERR(0, 18, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "dadapy/_cython/cython_maximum_likelihood_opt_full.pyx":1
  * import time             # <<<<<<<<<<<<<<
  * 
  * import cython
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "../../../../../../../anaconda3/lib/python3.9/site-packages/numpy/__init__.pxd":1014
+  /* "../../../../../../../anaconda3/envs/pynn1/lib/python3.8/site-packages/numpy/__init__.pxd":1014
  * 
  * 
  * cdef inline NPY_DATETIMEUNIT get_datetime64_unit(object obj) nogil:             # <<<<<<<<<<<<<<
  *     """
  *     returns the unit part of the dtype for a numpy datetime64 object.
  */
 
@@ -6146,14 +6648,20 @@
     Py_INCREF(code_object);
 }
 
 /* AddTraceback */
   #include "compile.h"
 #include "frameobject.h"
 #include "traceback.h"
+#if PY_VERSION_HEX >= 0x030b00a6
+  #ifndef Py_BUILD_CORE
+    #define Py_BUILD_CORE 1
+  #endif
+  #include "internal/pycore_frame.h"
+#endif
 static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
             const char *funcname, int c_line,
             int py_line, const char *filename) {
     PyCodeObject *py_code = NULL;
     PyObject *py_funcname = NULL;
     #if PY_MAJOR_VERSION < 3
     PyObject *py_srcfile = NULL;
@@ -6209,22 +6717,32 @@
     return NULL;
 }
 static void __Pyx_AddTraceback(const char *funcname, int c_line,
                                int py_line, const char *filename) {
     PyCodeObject *py_code = 0;
     PyFrameObject *py_frame = 0;
     PyThreadState *tstate = __Pyx_PyThreadState_Current;
+    PyObject *ptype, *pvalue, *ptraceback;
     if (c_line) {
         c_line = __Pyx_CLineForTraceback(tstate, c_line);
     }
     py_code = __pyx_find_code_object(c_line ? -c_line : py_line);
     if (!py_code) {
+        __Pyx_ErrFetchInState(tstate, &ptype, &pvalue, &ptraceback);
         py_code = __Pyx_CreateCodeObjectForTraceback(
             funcname, c_line, py_line, filename);
-        if (!py_code) goto bad;
+        if (!py_code) {
+            /* If the code object creation fails, then we should clear the
+               fetched exception references and propagate the new exception */
+            Py_XDECREF(ptype);
+            Py_XDECREF(pvalue);
+            Py_XDECREF(ptraceback);
+            goto bad;
+        }
+        __Pyx_ErrRestoreInState(tstate, ptype, pvalue, ptraceback);
         __pyx_insert_code_object(c_line ? -c_line : py_line, py_code);
     }
     py_frame = PyFrame_New(
         tstate,            /*PyThreadState *tstate,*/
         py_code,           /*PyCodeObject *code,*/
         __pyx_d,    /*PyObject *globals,*/
         0                  /*PyObject *locals*/
@@ -7387,19 +7905,41 @@
     }
     return (PyErr_GivenExceptionMatches(err, exc_type1) || PyErr_GivenExceptionMatches(err, exc_type2));
 }
 #endif
 
 /* CheckBinaryVersion */
   static int __Pyx_check_binary_version(void) {
-    char ctversion[4], rtversion[4];
-    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
-    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
-    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
+    char ctversion[5];
+    int same=1, i, found_dot;
+    const char* rt_from_call = Py_GetVersion();
+    PyOS_snprintf(ctversion, 5, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
+    found_dot = 0;
+    for (i = 0; i < 4; i++) {
+        if (!ctversion[i]) {
+            same = (rt_from_call[i] < '0' || rt_from_call[i] > '9');
+            break;
+        }
+        if (rt_from_call[i] != ctversion[i]) {
+            same = 0;
+            break;
+        }
+    }
+    if (!same) {
+        char rtversion[5] = {'\0'};
         char message[200];
+        for (i=0; i<4; ++i) {
+            if (rt_from_call[i] == '.') {
+                if (found_dot) break;
+                found_dot = 1;
+            } else if (rt_from_call[i] < '0' || rt_from_call[i] > '9') {
+                break;
+            }
+            rtversion[i] = rt_from_call[i];
+        }
         PyOS_snprintf(message, sizeof(message),
                       "compiletime version %s of module '%.100s' "
                       "does not match runtime version %s",
                       ctversion, __Pyx_MODULE_NAME, rtversion);
         return PyErr_WarnEx(NULL, message, 1);
     }
     return 0;
```

### Comparing `dadapy-0.1.1/dadapy/_utils/metric_comparisons.py` & `dadapy-0.2.0/dadapy/_utils/metric_comparisons.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -14,51 +14,56 @@
 # ==============================================================================
 
 import numpy as np
 from sklearn.neighbors import NearestNeighbors
 
 
 def _return_ranks(dist_indices_1, dist_indices_2, k=1):
-    """Finds all the ranks according to distance 2 of the kth neighbours according to distance 1.
+    """Finds all the ranks according to distance 2 of the neighbours according to distance 1.
+       Neighbours in distance 1 are considered up to order k.
 
     Args:
-        dist_indices_1 (np.ndarray(int)): N x maxk matrix, nearest neighbours according to distance1
-        dist_indices_2 (np.ndarray(int))): N x maxk_2 matrix, nearest neighbours according to distance2
+        dist_indices_1 (np.ndarray(int)): N x maxk matrix, nearest neighbours according to distance 1
+        dist_indices_2 (np.ndarray(int))): N x maxk_2 matrix, nearest neighbours according to distance 2
         k (int): order of nearest neighbour considered for the calculation of the conditional ranks, default is 1
 
     Returns:
-        np.array(int): ranks according to distance 2 of the first neighbour in distance 1
+        conditional_ranks (np.ndarray(int)): N x k matrix, ranks according to distance 2 of the neighbours in distance 1
 
     """
     assert dist_indices_1.shape[0] == dist_indices_2.shape[0]
 
     N = dist_indices_1.shape[0]
     maxk_2 = dist_indices_2.shape[1]
 
-    conditional_ranks = np.zeros(N)
+    conditional_ranks = np.zeros((N, k))
 
     for i in range(N):
-        idx_k_d1 = dist_indices_1[i, k]
+        idx_k_d1 = dist_indices_1[i, 1 : k + 1]
 
-        wr = np.where(idx_k_d1 == dist_indices_2[i])
-
-        if len(wr[0]) == 0:
-            conditional_ranks[i] = np.random.randint(maxk_2, N)
-        else:
-            conditional_ranks[i] = wr[0][0]
+        wr = [
+            np.where(idx_k_d1[k_neighbor] == dist_indices_2[i])[0]
+            for k_neighbor in range(k)
+        ]
+
+        for k_neighbor in range(k):
+            if len(wr[k_neighbor]) == 0:
+                conditional_ranks[i, k_neighbor] = np.random.randint(maxk_2, N)
+            else:
+                conditional_ranks[i, k_neighbor] = wr[k_neighbor][0]
 
     return conditional_ranks
 
 
 def _return_imbalance(dist_indices_1, dist_indices_2, k=1):
     """Compute the information imbalance between two precomputed distance measures.
 
     Args:
-        dist_indices_1 (np.ndarray(int): nearest neighbours according to distance1
-        dist_indices_2 (np.ndarray(int): nearest neighbours according to distance2
+        dist_indices_1 (np.ndarray(int)): nearest neighbours according to distance 1
+        dist_indices_2 (np.ndarray(int)): nearest neighbours according to distance 2
         k (int): order of nearest neighbour considered for the calculation of the imbalance, default = 1
 
     Returns:
         (float): information imbalance from distance 1 to distance 2
 
     """
     assert dist_indices_1.shape[0] == dist_indices_2.shape[0]
```

### Comparing `dadapy-0.1.1/dadapy/_utils/utils.py` & `dadapy-0.2.0/dadapy/_utils/utils.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -15,14 +15,15 @@
 import multiprocessing
 import re
 import warnings
 
 import numpy as np
 import scipy.special as sp
 from scipy.spatial import cKDTree
+from scipy.special import binom
 from sklearn.metrics import pairwise_distances
 from sklearn.neighbors import NearestNeighbors
 
 cores = multiprocessing.cpu_count()
 
 
 def compute_all_distances(X, n_jobs=cores, metric="euclidean"):
@@ -97,15 +98,14 @@
     Returns:
         distances (np.ndarray(int)): N x maxk matrix, indices of the neighbours of each point
         dist_indices (np.ndarray(float)): N x maxk matrix, distances of the neighbours of each point
 
     """
 
     if period is None:
-
         # nbrs = NearestNeighbors(n_neighbors=maxk, metric=metric, p=p).fit(X)
         nbrs = NearestNeighbors(n_neighbors=maxk, metric=metric).fit(X)
 
         distances, dist_indices = nbrs.kneighbors(X_new)
 
         # in case of hamming distance, make them integer
         if metric == "hamming":
@@ -141,18 +141,22 @@
 
     """
 
     distances, dist_indices = compute_cross_nn_distances(
         X, X, maxk + 1, metric=metric, period=period
     )
 
-    zero_dists = np.sum(distances[:, 1] <= 1.1 * np.finfo(distances.dtype).eps)
+    zero_dists = np.sum(distances[:, 1:] <= 1.1 * np.finfo(distances.dtype).eps)
     if zero_dists > 0:
         warnings.warn(
-            f"there may be data with zero distance from each other; this may compromise the correct behavior of some routines"
+            f"There are points with neighbours at 0 distance, meaning the dataset probably has identical points.\n"
+            f"This can cause problems in various routines.\nWe suggest to either perform smearing of distances using\n"
+            f"remove_zero_dists()\n"
+            f"or remove identical points using\n"
+            f"remove_identical_points())."
         )
 
     return distances, dist_indices
 
 
 def cast_to64(myarray):
     if myarray.dtype == "float32":
@@ -160,57 +164,118 @@
     return myarray
 
 
 # --------------------------------------------------------------------------------------
 # Helper functions
 
 
-def _loglik(d, mus, n1, n2, N, eps):
+def _neg_loglik(dtype, d, mus, n1, n2):
+    mus, n1, n2 = _filter_mus(dtype, mus, n1, n2)
+
+    N = len(mus)
+    term1 = (N - 1) * np.log(d)
+    term2 = np.sum((n2 - n1 - 1) * np.log(mus**d - 1))
+    term3 = -np.sum(np.log(sp.beta(n2 - n1, n1)))
+    term4 = -np.sum((((n2 - 1) * d) + 1) * np.log(mus))
+
+    return -(term1 + term2 + term3 + term4)
+
+
+def _neg_dloglik_did(d, mus, n1, n2, N, eps):
+    """Compute the negative derivative of the log likelihood with respect to the id."""
     one_m_mus_d = 1.0 - mus ** (-d)
     "regularize small numbers"
     one_m_mus_d[one_m_mus_d < 2 * eps] = 2 * eps
     sum = np.sum(((1 - n2 + n1) / one_m_mus_d + n2 - 1.0) * np.log(mus))
     return sum - (N - 1) / d
 
 
-def _argmax_loglik(dtype, d0, d1, mus, n1, n2, N, eps=1.0e-7):
-    # mu can't be == 1 add some noise
+def _filter_mus(dtype, mus, n1, n2):
     indx = np.nonzero(mus == 1)
-    mus[indx] += 1e-10  # np.finfo(dtype).eps
+    mus[indx] += 10 * np.finfo(dtype).eps
+
+    q3, q2 = np.percentile(mus, [95, 50])
+    mu_max = (
+        20 * (q3 - q2) + q2
+    )  # very generous threshold: to accomodate fat tailed distributions
+    select = (
+        mus < mu_max
+    )  # remove high mu values related very likely to overlapping datapoints
+    mus = mus[select]
+
+    if isinstance(n1, np.ndarray):
+        n1 = n1[select]
+
+    if isinstance(n2, np.ndarray):
+        n1 = n1[select]
+
+    return mus, n1, n2
+
 
-    l1 = _loglik(d1, mus, n1, n2, N, eps)
+def _argmax_loglik(dtype, d0, d1, mus, n1, n2, eps=1.0e-7):
+    mus, n1, n2 = _filter_mus(dtype, mus, n1, n2)
+
+    N = len(mus)
+    l1 = _neg_dloglik_did(d1, mus, n1, n2, N, eps)
     while abs(d0 - d1) > eps:
         d2 = (d0 + d1) / 2.0
-        l2 = _loglik(d2, mus, n1, n2, N, eps)
+        l2 = _neg_dloglik_did(d2, mus, n1, n2, N, eps)
         if l2 * l1 > 0:
             d1 = d2
         else:
             d0 = d2
     d = (d0 + d1) / 2.0
 
     return d
 
 
 def _fisher_info_scaling(id_ml, mus, n1, n2, eps):
     N = len(mus)
-    one_m_mus_d = 1.0 - mus ** (-id_ml)
+    one_m_mus_d = 1.0 - mus ** (-1.0 * id_ml)
     "regularize small numbers"
     one_m_mus_d[one_m_mus_d < eps] = eps
     log_mu = np.log(mus)
 
     j0 = N / id_ml**2
 
     factor1 = np.divide(log_mu, one_m_mus_d)
     factor2 = mus ** (-id_ml)
     tmp = np.multiply(factor1**2, factor2)
-    j1 = (n2 - n1 - 1) * np.sum(tmp)
-
+    j1 = np.sum((n2 - n1 - 1) * tmp)
     return j0 + j1
 
 
+def log_binom_stirling(k, n):
+    return (
+        (k + 0.5) * np.log(k)
+        - (n + 0.5) * np.log(n)
+        - (k - n + 0.5) * np.log(k - n)
+        - 0.5 * np.log(2 * np.pi)
+    )
+
+
+def binomial_loglik(d, k, n, r):
+    if isinstance(k, np.ndarray):
+        pk = np.histogram(k, bins=np.arange(-0.5, k.max() + 1.5))[0]
+        pk = pk / pk.sum()
+    else:
+        pk = np.ones(k + 1)
+        k = [k]
+    log_binom = np.log(binom(k, n))
+    if np.any(log_binom == np.inf):
+        mask = np.where(log_binom == np.inf)[0]
+        log_binom[mask] = log_binom_stirling(k[mask], n[mask])
+    return -np.sum(
+        n * d * np.log(r)
+        + (k - n) * np.log(1.0 - r**d)
+        + log_binom
+        + np.log([pk[ki] for ki in k])
+    )
+
+
 def _compute_binomial_cramerrao(d, k, r, n):
     """Calculate the Cramer Rao lower bound for the variance associated with the binomial estimator
 
     Args:
         d (float): intrinsic dimension
         k (float, np.ndarray(float)): number of neighbours within the external shell
         r (float): ratio among internal and external radii
@@ -315,15 +380,15 @@
     from scipy.special import beta as beta_f
     from scipy.stats import beta as beta_d
 
     D_MAX = 100.0
     D_MIN = 0.0001
 
     a = a0 + n.sum()
-    if isinstance(k, (np.int, int)):
+    if isinstance(k, (np.int64, int)):
         b = b0 + k * n.shape[0] - n.sum()
     else:
         b = b0 + k.sum() - n.sum()
     posterior = beta_d(a, b)
 
     if posterior_profile:
         import matplotlib.pyplot as plt
```

### Comparing `dadapy-0.1.1/dadapy/base.py` & `dadapy-0.2.0/dadapy/base.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -16,14 +16,15 @@
 """
 The *base* module contains the *Base* class.
 
 This class contains essential methods and attributes needed for all other classes.
 """
 import multiprocessing
 import time
+import warnings
 
 import numpy as np
 
 from dadapy._utils.utils import compute_nn_distances, from_all_distances_to_nndistances
 
 cores = multiprocessing.cpu_count()
 rng = np.random.default_rng()
@@ -41,83 +42,112 @@
         verbose=False,
         njobs=cores,
     ):
         """Containing coordinates and/or distances and some basic methods.
 
         Args:
             coordinates (np.ndarray(float)): the data points loaded, of shape (N , dimension of embedding space)
-            distances (np.ndarray(float)): A matrix of dimension N x mask containing distances between points
+            distances (np.ndarray(float), tuple(np.ndarray(float), np.ndarray(float)) ): Distance matrix (N x N),
+                                        or tuple of nearest neighbor distances (N x maxk) and their indices (N x maxk).
             maxk (int): maximum number of neighbours to be considered for the calculation of distances
             period (np.array(float), optional): array containing the periodicity of each coordinate. Default is None
             verbose (bool): whether you want the code to speak or shut up
             njobs (int): number of cores to be used
         """
         self.X = coordinates
         self.maxk = maxk
         self.verb = verbose
         self.njobs = njobs
         self.dims = None
         self.N = None
         self.metric = "euclidean"
         self.period = period
 
-        if coordinates is not None:
+        if self.X is not None:
             assert isinstance(
                 self.X, np.ndarray
             ), "Coordinates must be in numpy ndarray format"
-
-            self.dtype = self.X.dtype
+            if self.X.dtype == np.float64:
+                pass
+            elif self.X.dtype == np.float32 or self.X.dtype == np.float16:
+                self.X = self.X.astype(np.float64, casting="safe")
+            else:
+                warnings.warn(
+                    f"data type is {self.X.dtype}: most methods work only with float-type inputs",
+                    stacklevel=2,
+                )
 
             self.N = self.X.shape[0]
             self.dims = coordinates.shape[1]
             self.distances = None
             if self.maxk is None:
                 self.maxk = min(100, self.N - 1)
 
         if distances is not None:
-            if isinstance(distances, tuple):
-                assert isinstance(
-                    distances[0], np.ndarray
-                ), "distances must be in numpy ndarray format"
-                assert isinstance(
-                    distances[1], np.ndarray
-                ), "distance indices must be in numpy ndarray format"
-
-                assert (
-                    distances[0].shape[0] == distances[1].shape[0]
-                ), "distances and indices must have the same shape"
-
-                if self.maxk is None:
-                    self.maxk = min(100, distances[0].shape[1] - 1)
-
-                self.N = distances[0].shape[0]
-                self.distances = distances[0][:, : self.maxk + 1]
-                self.dist_indices = distances[1][:, : self.maxk + 1]
+            self.distances, self.dist_indices, self.N, self.maxk = self._init_distances(
+                distances, self.maxk
+            )
 
-            else:
-                assert isinstance(
-                    distances, np.ndarray
-                ), "distances must be in numpy ndarray format"
-                assert (
-                    distances.shape[0] == distances.shape[1]
-                ), "distance matrix shape must be N x N"
-
-                self.N = distances.shape[0]
-                if self.maxk is None:
-                    self.maxk = min(100, distances.shape[1] - 1)
+        self.dtype = np.float64
+        self.eps = np.finfo(self.dtype).eps
+
+    # this function is useful for overlap with another dataset and makes __init__ little bit shorter
+    def _init_distances(self, distances, maxk=None):
+        if isinstance(distances, tuple):
+            assert isinstance(
+                distances[0], np.ndarray
+            ), "distances must be in numpy ndarray format"
+            assert isinstance(
+                distances[1], np.ndarray
+            ), "distance indices must be in numpy ndarray format"
+
+            assert (
+                distances[0].shape[0] == distances[1].shape[0]
+            ), "distances and indices must have the same shape"
+
+            if maxk is None:
+                maxk = min(100, distances[0].shape[1] - 1)
+
+            elif maxk > (distances[0].shape[1] - 1):
+                maxk = distances[0].shape[1] - 1
+                warnings.warn(
+                    f"maxk requested bigger than number of features: setting maxk to {maxk}",
+                    stacklevel=2,
+                )
+
+            N = distances[0].shape[0]
 
-                self.distances, self.dist_indices = from_all_distances_to_nndistances(
-                    distances, self.maxk
+            dist = distances[0][:, : maxk + 1]
+            dist_indices = distances[1][:, : maxk + 1]
+
+        else:
+            assert isinstance(
+                distances, np.ndarray
+            ), "distances must be in numpy ndarray format"
+            assert (
+                distances.shape[0] == distances.shape[1]
+            ), "distance matrix shape must be N x N"
+
+            N = distances.shape[0]
+            if maxk is None:
+                maxk = min(100, distances.shape[1] - 1)
+
+            elif maxk > (distances.shape[1] - 1):
+                maxk = distances.shape[1] - 1
+                warnings.warn(
+                    f"maxk requested bigger than number of features: setting maxk to {maxk}",
+                    stacklevel=2,
                 )
 
-            self.dtype = self.distances.dtype
-        try:
-            self.eps = np.finfo(self.dtype).eps
-        except BaseException:
-            self.eps = None
+            dist, dist_indices = from_all_distances_to_nndistances(distances, maxk)
+
+        if dist.dtype == np.float32:
+            dist = dist.astype(np.float64, casting="safe")
+
+        return dist, dist_indices, N, maxk
 
     # ----------------------------------------------------------------------------------------------
 
     def compute_distances(self, maxk=None, metric="euclidean", period=None):
         """Compute distaces between points up to the maxk nearest neighbour.
 
         Args:
@@ -165,51 +195,46 @@
         sec2 = time.time()
         if self.verb:
             print("{0:0.2f} seconds for computing distances".format(sec2 - sec))
 
     # -------------------------------------------------------------------------------
 
     # better to use this formulation which can be applied to _mus_scaling_reduce_func
-    def _remove_zero_dists(self, distances):
-        """Find zero nearest neighhbour distances and substitute the numerical zeros with a very small number.
+    def remove_zero_dists(self, distances):
+        """Find zero neighbour distances and substitute the numerical zeros with a very small number.
 
         This method is mostly useful to regularize the computation of certain id estimators.
-
-        Args:
-            distances: distances to modify
-
-        Returns:
-            distances with regularised zeros
-
         """
-        # find all points with any zero distance
-        indx_ = np.nonzero(distances[:, 1] < np.finfo(self.dtype).eps)[0]
-        # set nearest distance to eps:
-        distances[indx_, 1] = np.finfo(self.dtype).eps
+        # find all distances which are 0
+        indices = np.nonzero(distances[:, 1:] < np.finfo(self.dtype).eps)
+        # set distance to epsilon
+        distances[indices] = np.finfo(self.dtype).eps
 
         return distances
 
     def remove_identical_points(self):
         """Find points that are numerically identical and remove them.
 
-        For very large datasets this method might be slow and you might want to use a command like: awk '!seen[$0]++' .
+        For very large datasets this method might be slow; you might want to use a command like: awk '!seen[$0]++' .
         See
         https://unix.stackexchange.com/questions/11939/how-to-get-only-the-unique-results-without-having-to-sort-data
         for more information
         """
         if self.N > 100000:
-            print("WARNING: this method might be very slow for large datasets. ")
+            print(
+                "WARNING: this method might be very slow for large datasets.\n"
+                "We suggest to use something like \"awk '!seen[$0]++'\""
+            )
 
         # removal of overlapping data points
         X_unique = np.unique(self.X, axis=0)
 
         N_unique = X_unique.shape[0]
 
         if N_unique < self.N:
-
             print(
                 f"{self.N - N_unique} overlapping datapoints found: keeping {N_unique} unique elements",
                 "WARNING: the order of points has been changed!",
             )
 
             self.X = X_unique
             self.N = N_unique
```

### Comparing `dadapy-0.1.1/dadapy/clustering.py` & `dadapy-0.2.0/dadapy/clustering.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -17,19 +17,21 @@
 The *clustering* module contains the *Clustering* class.
 
 Density-based clustering algorithms are implemented as methods of this class.
 """
 
 import multiprocessing
 import time
+import warnings
 
 import numpy as np
 import scipy as sp
 
 from dadapy._cython import cython_clustering as cf
+from dadapy._cython import cython_clustering_v2 as cf2
 from dadapy.density_estimation import DensityEstimation
 
 cores = multiprocessing.cpu_count()
 
 
 class Clustering(DensityEstimation):
     """Perform clustering using various density-based clustering algorithms.
@@ -71,19 +73,15 @@
         self.log_den_bord_err = None
         self.log_den_bord = None
         self.bord_indices = None
 
         self.delta = None  # Minimum distance from an element with higher density
         self.ref = None  # Index of the nearest element with higher density
 
-    def compute_clustering_ADP(
-        self,
-        Z=1.65,
-        halo=False,
-    ):
+    def compute_clustering_ADP(self, Z=1.65, halo=False, v2=False):
         """Compute clustering according to the algorithm DPA.
 
         The only free parameter is the merging factor Z, which controls how the different density peaks are merged
         together. The higher the Z, the more aggressive the merging, the smaller the number of clusters.
         The calculation is optimized though cython
 
         Args:
@@ -100,52 +98,68 @@
         """
         if self.log_den is None:
             self.compute_density_PAk()
 
         if self.verb:
             print("Clustering started")
 
+        if v2 is True:
+            warnings.warn(
+                """using adp implementation v2: this requires less memory but can
+                be two times slower than the original implementation""",
+                stacklevel=2,
+            )
+
         # Make all values of log_den positives (this is important to help convergence)
         # even when subtracting the value Z*log_den_err
         log_den_min = np.min(self.log_den - Z * self.log_den_err)
-
         log_den_c = self.log_den - log_den_min + 1
 
         # Putative modes of the PDF as preliminary clusters
         g = log_den_c - self.log_den_err
 
         # centers are point of max density  (max(g) ) within their optimal neighborhood (defined by kstar)
         seci = time.time()
 
-        out = cf._compute_clustering(
-            Z,
-            halo,
-            self.kstar,
-            self.dist_indices.astype(int),
-            self.maxk,
-            self.verb,
-            self.log_den_err,
-            log_den_min,
-            log_den_c,
-            g,
-            self.N,
-        )
+        if v2:
+            out = cf2._compute_clustering(
+                Z,
+                halo,
+                self.kstar,
+                self.dist_indices.astype(int),
+                self.maxk,
+                self.verb,
+                self.log_den_err,
+                log_den_c,
+                g,
+                self.N,
+            )
+        else:
+            out = cf._compute_clustering(
+                Z,
+                halo,
+                self.kstar,
+                self.dist_indices.astype(int),
+                self.maxk,
+                self.verb,
+                self.log_den_err,
+                log_den_c,
+                g,
+                self.N,
+            )
 
         secf = time.time()
 
         self.cluster_indices = out[0]
         self.N_clusters = out[1]
         self.cluster_assignment = out[2]
         self.cluster_centers = out[3]
-        out_bord = out[4]
-        log_den_min = out[5]
-        self.log_den_bord_err = out[6]
-        self.bord_indices = out[7]
-
-        self.log_den_bord = out_bord + log_den_min - 1
+        self.log_den_bord = out[4] + log_den_min - 1
+        self.log_den_bord_err = out[5]
+        self.bord_indices = out[6]
 
         if self.verb:
             print(f"Clustering finished, {self.N_clusters} clusters found")
             print(f"total time is, {secf - seci}")
 
         return self.cluster_assignment
 
@@ -230,25 +244,30 @@
                     halo_cutoff[j] = np.max(td)
             halo[tt[(self.log_den < halo_cutoff[self.cluster_assignment])]] = -1
             self.cluster_assignment = halo
 
         return self.cluster_assignment
 
     def compute_clustering_ADP_pure_python(  # noqa: C901
-        self,
-        Z=1.65,
-        halo=False,
+        self, Z=1.65, halo=False, v2=False
     ):
         """Compute ADP clustering, but without the cython optimization."""
         if self.log_den is None:
             self.compute_density_PAk()
 
         if self.verb:
             print("Clustering started")
 
+        if v2 is True:
+            warnings.warn(
+                """using adp implementation v2: this requires less memory but
+                can be two times slower than the original implementation""",
+                stacklevel=2,
+            )
+
         # Make all values of log_den positives (this is important to help convergence)
         # even when subtracting the value Z*log_den_err
         log_den_min = np.min(self.log_den - Z * self.log_den_err)
         # define a "log_den_c" specific to perform clustering
         log_den_c = self.log_den - log_den_min + 1
 
         # Find the putative modes of the PDF as preliminary clusters
@@ -273,55 +292,96 @@
                 "{0:0.2f} seconds clustering before multimodality test".format(
                     sec2 - sec
                 )
             )
 
         # Find border points between putative clusters
         sec = time.time()
-
-        (
-            log_den_bord,
-            log_den_bord_err,
-            bord_index,
-        ) = self._find_borders_between_clusters(
-            Nclus, g, cl_struct, centers, cluster_init, log_den_c
-        )
+        if not v2:
+            (
+                log_den_bord,
+                log_den_bord_err,
+                bord_index,
+            ) = self._find_borders_between_clusters(
+                Nclus, g, cl_struct, centers, cluster_init, log_den_c
+            )
+        else:
+            saddle_density, saddle_indices = self._find_borders_between_clusters_v2(
+                Nclus, g, cl_struct, centers, cluster_init, log_den_c
+            )
 
         sec2 = time.time()
         if self.verb:
             print("{0:0.2f} seconds identifying the borders".format(sec2 - sec))
 
         sec = time.time()
-        surviving_clusters = self._multimodality_test(
-            Nclus, Z, log_den_c, centers, cl_struct, log_den_bord, log_den_bord_err
-        )
+        if not v2:
+            surviving_clusters, bord_index = self._multimodality_test(
+                Nclus,
+                Z,
+                log_den_c,
+                centers,
+                cl_struct,
+                log_den_bord,
+                log_den_bord_err,
+                bord_index,
+            )
+        else:
+            (
+                surviving_clusters,
+                saddle_density,
+                saddle_indices,
+            ) = self._multimodality_test_v2(
+                Nclus, Z, log_den_c, centers, cl_struct, saddle_density, saddle_indices
+            )
 
         sec2 = time.time()
         if self.verb:
             print("{0:0.2f} seconds with multimodality test".format(sec2 - sec))
 
-        (
-            N_clusters,
-            cluster_assignment,
-            cluster_indices,
-            cluster_centers,
-            log_den_bord,
-            log_den_bord_err,
-            bord_indices,
-        ) = self._finalise_clustering(
-            Nclus,
-            halo,
-            surviving_clusters,
-            cl_struct,
-            centers,
-            log_den_bord,
-            log_den_bord_err,
-            bord_index,
-            log_den_c,
-        )
+        if not v2:
+            (
+                N_clusters,
+                cluster_assignment,
+                cluster_indices,
+                cluster_centers,
+                log_den_bord,
+                log_den_bord_err,
+                bord_indices,
+            ) = self._finalise_clustering(
+                Nclus,
+                halo,
+                surviving_clusters,
+                cl_struct,
+                centers,
+                log_den_bord,
+                log_den_bord_err,
+                bord_index,
+                log_den_c,
+            )
+
+        else:
+            (
+                N_clusters,
+                cluster_assignment,
+                cluster_indices,
+                cluster_centers,
+                log_den_bord,
+                log_den_bord_err,
+                bord_indices,
+            ) = self._finalise_clustering_v2(
+                Nclus,
+                halo,
+                surviving_clusters,
+                cl_struct,
+                centers,
+                saddle_density,
+                saddle_indices,
+                log_den_c,
+            )
 
         self.cluster_indices = cluster_indices
         self.N_clusters = N_clusters
         self.cluster_assignment = cluster_assignment
         self.cluster_centers = cluster_centers
         self.log_den_bord = (
             log_den_bord + log_den_min - 1
@@ -362,15 +422,14 @@
             # index of the point of maximum density in these neighborhoods
             max_rho = np.argmax(g[l])
             max_rho = l[max_rho]
 
             # if the density of 'max_rho' is higher than that of i_center,
             # remove i_center and store [i_center,  max_rho] (see later)
             if g[max_rho] > g[i_center]:
-
                 # check if this max_rho is already in removed centers
                 if len(removed_centers) > 0:
                     is_valid = np.where(np.array(removed_centers)[:, 0] == max_rho)[0]
                     # if current max_rho is in removed centers use its max_rho
                     if is_valid.size > 0:
                         max_rho = removed_centers[is_valid[0]][1]
 
@@ -471,43 +530,65 @@
             log_den_c: log density of points
 
         Returns:
             log_den_bord: log density of the saddle points
             log_den_bord_err: error on the log density of saddle points
             bord_index: square matrix providing the index of the saddle point between any two peaks
         """
-        log_den_bord = np.zeros((Nclus, Nclus), dtype=float)
-        log_den_bord_err = np.zeros((Nclus, Nclus), dtype=float)
+        # this implementation can be vry costly if Nclus is > 10^4
+        if Nclus > 10000:
+            warnings.warn(
+                """There are > 10k initial putative clusters:
+            the matrices of the saddle points may cause out of memory error (3x Nclus x Nclus --> > 2.4 GB required).
+            If this is the case, call compute_clustering_ADP_pure_python(v2 = True). Ignore the warning otherwise.""",
+                stacklevel=2,
+            )
 
-        # set all bord indices to -1 (no points) initially
-        bord_index = np.ones((Nclus, Nclus), dtype=int) * -1
+        try:
+            log_den_bord = np.zeros((Nclus, Nclus), dtype=np.float64)
+            log_den_bord_err = np.zeros((Nclus, Nclus), dtype=np.float64)
+            # set all bord indices to -1 (no points) initially
+            bord_index = np.ones((Nclus, Nclus), dtype=int) * -1
+        except MemoryError:
+            print(
+                f"Nclus = {Nclus}. Out of memory error: call compute_clustering_ADP_pure_python(v2 = True)"
+            )
 
         for c in range(Nclus):
-            for p1 in cl_struct[c]:
+            for p1 in cl_struct[c]:  # p1 points in a given cluster
                 if p1 in centers:
                     pp = -1
 
                 else:
+                    # a point p2 in the neighborhood of p1 belongs to a cluster cp different from p1
                     for k in range(1, self.kstar[p1] + 1):
                         p2 = self.dist_indices[p1, k]
                         pp = -1
-                        if cluster_init[p2] != c:
+                        if (
+                            cluster_init[p2] != c
+                        ):  # a point in the neighborhood of p1 belongs to another cluster
                             pp = p2
-                            cp = cluster_init[pp]
+                            cp = cluster_init[pp]  # neighbor cluster index
                             break
                 if pp != -1:
                     for k in range(1, self.maxk):
-                        po = self.dist_indices[pp, k]
-                        if po == p1:
+                        po = self.dist_indices[pp, k]  # pp here is p2
+                        if po == p1:  # p1 is the closest point of p2 belonging to c
                             break
-                        if cluster_init[po] == c:
+                        if (
+                            cluster_init[po] == c
+                        ):  # there is a point of c closest to p2 than p1
                             pp = -1
                             break
+
+                # here check if the border point is a saddle point
                 if pp != -1:
-                    if g[p1] > log_den_bord[c][cp]:
+                    if (
+                        g[p1] > log_den_bord[c][cp]
+                    ):  # g = log_den_c - self.log_den_err different from next log_den_bord without log_den_err
                         log_den_bord[c][cp] = g[p1]
                         log_den_bord[cp][c] = g[p1]
                         bord_index[cp][c] = p1
                         bord_index[c][cp] = p1
 
         # fill in matrices of bord densities and errors in a symmetric way
         for i in range(Nclus - 1):
@@ -522,24 +603,31 @@
         for i in range(Nclus):
             log_den_bord[i][i] = -1.0
             log_den_bord_err[i][i] = 0.0
 
         return log_den_bord, log_den_bord_err, bord_index
 
     def _multimodality_test(
-        self, Nclus, Z, log_den_c, centers, cl_struct, log_den_bord, log_den_bord_err
+        self,
+        Nclus,
+        Z,
+        log_den_c,
+        centers,
+        cl_struct,
+        log_den_bord,
+        log_den_bord_err,
+        bord_index,
     ):
         """Merge couples of peaks if these are not statistically significant."""
         check = 1
 
         # all clusters are initialised as "surviving"
         surviving_clusters = [1] * Nclus
 
         while check == 1:
-
             # density and position of borders to be merged
             pos = []
             ipos = []
             jpos = []
 
             check = 0
 
@@ -595,24 +683,29 @@
                 cl_struct[imod].extend(cl_struct[jmod])
                 cl_struct[jmod] = []
 
                 # recompute the borders with the other peaks
                 for i in range(Nclus):
                     if i != imod and i != jmod:
                         if log_den_bord[imod][i] < log_den_bord[jmod][i]:
+                            bord_index[imod][i] = bord_index[jmod][i]
+                            bord_index[i][imod] = bord_index[imod][i]
+
                             log_den_bord[imod][i] = log_den_bord[jmod][i]
                             log_den_bord[i][imod] = log_den_bord[imod][i]
+
                             log_den_bord_err[imod][i] = log_den_bord_err[jmod][i]
                             log_den_bord_err[i][imod] = log_den_bord_err[imod][i]
+
                         log_den_bord[jmod][i] = -1
                         log_den_bord[i][jmod] = log_den_bord[jmod][i]
                         log_den_bord_err[jmod][i] = 0
                         log_den_bord_err[i][jmod] = log_den_bord_err[jmod][i]
 
-        return surviving_clusters
+        return surviving_clusters, bord_index
 
     def _finalise_clustering(  # noqa: C901
         self,
         Nclus,
         halo,
         surviving_clusters,
         cl_struct,
@@ -675,7 +768,343 @@
             cluster_assignment,
             cluster_indices,
             cluster_centers,
             log_den_bord_m,
             log_den_bord_err_m,
             bord_indices_m,
         )
+
+    def _find_borders_between_clusters_v2(  # noqa: C901
+        self, Nclus, g, cl_struct, centers, cluster_init, log_den_c
+    ):
+        """Find saddle points between clusters.
+
+        Assume i and j are points belonging to the clusters c(i) and c(j).
+        Then, point i is a border point between c(i) and c(j) if:
+            a) It has in its neighborhood a point j belonging to other cluster.
+            b) There are no other points belonging to c(i) nearer from point j
+            c) It has the maximum density among the points that fulfill a) & b)
+
+        Args:
+            Nclus: number of clusters                       int
+            g: scaled log density of points                 np.array(N)
+            cl_struct: points assigned to each cluster      list(list())
+            centers: data index of density peaks            np.array(Nclus)
+            cluster_init: cluster assignment                np.array(N)
+            log_den_c: log density of points                np.array(N)
+
+        Returns:
+            log_den_bord: log density of the saddle points
+            log_den_bord_err: error on the log density of saddle points
+            bord_index: square matrix providing the index of the saddle point between any two peaks
+        """
+        saddle_count = 0
+        for c in range(Nclus):
+            # saddle point index, saddle point density, saddle point error, cluster1 index, cluster2 index, valid_saddle
+            # create another array of indices
+
+            saddle_density_tmp = np.zeros(
+                (Nclus, 3), dtype=float
+            )  # density, density_error, normalized_density
+            saddle_indices_tmp = -np.ones(
+                (Nclus, 4), dtype=int
+            )  # saddle point, cluster1, cluster2, is_valid saddle
+
+            if c == 0:
+                saddle_density = saddle_density_tmp
+                saddle_indices = saddle_indices_tmp
+                # array of saddle points of cluster  c (will be eventually much less than Nclus)
+            else:
+                saddle_density = np.concatenate(
+                    (saddle_density, saddle_density_tmp), axis=0
+                )
+                saddle_indices = np.concatenate(
+                    (saddle_indices, saddle_indices_tmp), axis=0
+                )
+
+            for p1 in cl_struct[c]:  # p1 point in a given cluster
+                if p1 in centers:
+                    pp = -1
+
+                else:
+                    # a point p2 in the neighborhood of p1 belongs to a cluster cp different from p1
+                    for k in range(1, self.kstar[p1] + 1):
+                        p2 = self.dist_indices[p1, k]
+                        pp = -1
+                        if (
+                            cluster_init[p2] != c
+                        ):  # a point in the neighborhood of p1 belongs to another cluster
+                            pp = p2
+                            cp = cluster_init[pp]  # neighbor cluster index
+                            break
+
+                if pp != -1:
+                    # p1 is the closest point in c to p2
+                    for k in range(1, self.maxk):  # why maxk?
+                        po = self.dist_indices[pp, k]  # pp here is p2
+                        if po == p1:  # p1 is the closest point of p2 belonging to c
+                            break
+                        if (
+                            cluster_init[po] == c
+                        ):  # p1 is NOT the closest point of p2 belonging to c
+                            pp = -1
+                            break
+
+                # here check if the border point is a saddle point
+                if pp != -1:
+                    # maybe contrunct a matrix of border points [p, g, c1, c2]
+                    # in log_den_bord_tmp the cluster are coupled with indices that go from smaller to bigger
+                    if c > cp:
+                        c1 = cp
+                        c2 = c
+                    else:
+                        c1 = c
+                        c2 = cp
+
+                    flag = 0
+                    for i in range(saddle_count):
+                        if c1 == saddle_indices[i, 1] and c2 == saddle_indices[i, 2]:
+                            flag = 1  # there is already a border point between c and cp
+                            if g[p1] > saddle_density[i, 2]:
+                                saddle_indices[i, 0] = p1  # useful at the end
+                                saddle_density[i] = np.array(
+                                    [log_den_c[p1], self.log_den_err[p1], g[p1]]
+                                )
+                                break
+
+                    if flag == 0:
+                        saddle_indices[saddle_count] = np.array(
+                            [p1, c1, c2, 1], dtype=int
+                        )
+                        saddle_density[saddle_count] = np.array(
+                            [log_den_c[p1], self.log_den_err[p1], g[p1]]
+                        )
+                        saddle_count += 1
+
+            saddle_density = saddle_density[:saddle_count]
+            saddle_indices = saddle_indices[:saddle_count]
+
+        sort_indices = saddle_density[:, 0].argsort()[::-1]
+        saddle_density = saddle_density[sort_indices]
+        saddle_indices = saddle_indices[sort_indices]
+
+        return saddle_density[:, :2], saddle_indices
+
+    def _multimodality_test_v2(
+        self, Nclus, Z, log_den_c, centers, cl_struct, saddle_density, saddle_indices
+    ):
+        """Merge couples of peaks if these are not statistically significant.
+
+        Args:
+            Nclus: number of clusters                       int
+            Z: scaled log density of points                 int
+            log_den_c: log density of points                np.array(N)
+            centers: data index of density peaks            np.array(Nclus)
+            cl_struct: points assigned to each cluster      list(list())
+            log_den_bord,                                   np.array((Nclus, 6))
+        """
+        check = 1
+        # all clusters are initialised as "surviving"
+        surviving_clusters = np.ones(Nclus, dtype=int)
+        nsaddles = len(saddle_density)
+
+        while check == 1:
+            check = 0
+            current_saddle = -1.0
+            for i in range(nsaddles):  # log_den_bord already sorted
+                if saddle_indices[i, 3] == 1:
+                    clus1, clus2 = (
+                        saddle_indices[i, 1],
+                        saddle_indices[i, 2],
+                    )  # cluster indices
+                    center1, center2 = (
+                        centers[clus1],
+                        centers[clus2],
+                    )  # data indices peak of clus1, clus2
+
+                    a1 = (
+                        log_den_c[center1] - saddle_density[i, 0]
+                    )  # log_den_c is an array of the density of all the points
+                    a2 = log_den_c[center2] - saddle_density[i, 0]
+                    sum_err1 = self.log_den_err[center1] + saddle_density[i, 1]
+                    sum_err2 = self.log_den_err[center2] + saddle_density[i, 1]
+
+                    # statistical thresholds
+                    e1 = Z * sum_err1
+                    e2 = Z * sum_err2
+                    if a1 < e1 or a2 < e2:
+                        check = 1
+                        if current_saddle < saddle_density[i, 0]:
+                            max_a1, max_a2 = a1, a2
+                            max_sum_err1, max_sum_err2 = sum_err1, sum_err2
+                            to_remove = i
+                            current_saddle = saddle_density[i, 0]
+
+            if check == 1:
+                saddle_indices[
+                    to_remove, -1
+                ] = 0  # the couple center1, center2 is removed
+                margin1 = max_a1 / max_sum_err1
+                margin2 = max_a2 / max_sum_err2
+
+                # only the peak with the highest margin is kept:
+                # by convention we set this peak to be center1
+                if margin1 < margin2:
+                    c1, c2 = saddle_indices[to_remove, 2], saddle_indices[to_remove, 1]
+                else:
+                    c1, c2 = saddle_indices[to_remove, 1], saddle_indices[to_remove, 2]
+
+                surviving_clusters[c2] = 0  # the second peak is removed
+                cl_struct[c1].extend(cl_struct[c2])
+                cl_struct[c2] = []
+
+                # select the clusters that are neighbors to cluster1 and cluster2
+                # cluster label, saddle label, position of c1/c2 in saddle_indices[:, 1:3]
+
+                saddle_indices = self._find_neighbor_clusters_v2(
+                    saddle_density, saddle_indices, to_remove, nsaddles, c1, c2
+                )
+
+        return surviving_clusters, saddle_density, saddle_indices
+
+    def _finalise_clustering_v2(  # noqa: C901
+        self,
+        Nclus,
+        halo,
+        surviving_clusters,
+        cl_struct,
+        centers,
+        saddle_density,
+        saddle_indices,
+        log_den_c,
+    ):
+        """Finalise clustering."""
+        N_clusters = 0
+        mapping = -np.ones(Nclus, dtype=int)  # all original centers
+        cluster_indices, cluster_centers = [], []
+        for i in range(Nclus):
+            if surviving_clusters[i] == 1:
+                mapping[i] = N_clusters  # center is surviving
+                N_clusters += 1
+                # !!!!!! check the index i is correct?
+                cluster_indices.append(cl_struct[i])
+                cluster_centers.append(centers[i])
+
+        bord_indices_m = -np.ones((N_clusters, N_clusters), dtype=int)
+        log_den_bord_m = np.zeros((N_clusters, N_clusters), dtype=float)
+        log_den_bord_err_m = np.zeros((N_clusters, N_clusters), dtype=float)
+
+        for i in range(len(saddle_density)):  # all original saddles
+            if saddle_indices[i, 3] == 1:  # a valid saddle is between two valid centers
+                j, k = (
+                    mapping[saddle_indices[i, 1]],
+                    mapping[saddle_indices[i, 2]],
+                )  # map the two valid centers in the corresponding valid new cluster labels
+                log_den_bord_m[j, k] = saddle_density[i, 0]
+                log_den_bord_m[k, j] = log_den_bord_m[j, k]
+
+                log_den_bord_err_m[j, k] = saddle_density[i, 1]
+                log_den_bord_err_m[k, j] = log_den_bord_err_m[j, k]
+
+                bord_indices_m[j, k] = saddle_indices[i, 0]
+                bord_indices_m[k, j] = bord_indices_m[j, k]
+
+        log_den_bord_m[np.diag_indices(N_clusters)] = -1
+
+        Last_cls = np.empty(self.N, dtype=int)
+        for j in range(N_clusters):
+            for k in cluster_indices[j]:
+                Last_cls[k] = j
+        Last_cls_halo = np.copy(Last_cls)
+        nh = 0
+        for j in range(N_clusters):
+            log_den_halo = max(log_den_bord_m[j])
+            for k in cluster_indices[j]:
+                if log_den_c[k] < log_den_halo:
+                    nh = nh + 1
+                    Last_cls_halo[k] = -1
+        if halo:
+            cluster_assignment = Last_cls_halo
+        else:
+            cluster_assignment = Last_cls
+
+        log_den_bord_m = np.copy(log_den_bord_m)
+
+        return (
+            N_clusters,
+            cluster_assignment,
+            cluster_indices,
+            cluster_centers,
+            log_den_bord_m,
+            log_den_bord_err_m,
+            bord_indices_m,
+        )
+
+    def _find_neighbor_clusters_v2(  # noqa: C901
+        self,
+        saddle_density,
+        saddle_indices,
+        to_remove,
+        nsaddles,
+        c1,
+        c2,
+    ):
+        neighbors1 = np.zeros((len(saddle_density), 3), dtype=int)
+        neighbors2 = np.zeros((len(saddle_density), 3), dtype=int)
+        len_neigh1, len_neigh2 = 0, 0
+        for i in range(nsaddles):
+            if i != to_remove and saddle_indices[i, 3] == 1:
+                cluster_couple = saddle_indices[i, 1:3]
+
+                if c1 in cluster_couple:
+                    neighbors1[len_neigh1] = np.array([cluster_couple[0], i, 2])
+                    if cluster_couple[0] == c1:
+                        neighbors1[len_neigh1] = np.array([cluster_couple[1], i, 1])
+                    len_neigh1 += 1
+
+                elif c2 in cluster_couple:
+                    neighbors2[len_neigh2] = np.array([cluster_couple[0], i, 2])
+                    if cluster_couple[0] == c2:
+                        neighbors2[len_neigh2] = np.array([cluster_couple[1], i, 1])
+                    len_neigh2 += 1
+
+        neighbors1, neighbors2 = neighbors1[:len_neigh1], neighbors2[:len_neigh2]
+
+        # check which are the common neighbors between cluster1 and cluster2
+        neighbors1 = neighbors1[neighbors1[:, 0].argsort()]
+        neighbors2 = neighbors2[neighbors2[:, 0].argsort()]
+        i, j = 0, 0
+        while i < len(neighbors1) and j < len(neighbors2):
+            if neighbors1[i, 0] == neighbors2[j, 0]:  # there is a common element
+                index1, index2 = (
+                    neighbors1[i, 1],
+                    neighbors2[j, 1],
+                )  # index common neighbor w.r.t cluster1
+                if saddle_density[index1, 0] < saddle_density[index2, 0]:
+                    # if the density of the saddle is higher between cluster2 and common neighbor,
+                    # use this as new saddle between cluster1 and common neighbor
+                    saddle_density[index1, 0] = saddle_density[
+                        index2, 0
+                    ]  # saddle density
+                    saddle_density[index1, 1] = saddle_density[
+                        index2, 1
+                    ]  # saddle error
+                # the couples of common elements with the c2 are "deleted"
+                saddle_indices[index2, -1] = 0
+                i += 1
+                j += 1
+
+            elif neighbors1[i, 0] < neighbors2[j, 0]:
+                i += 1
+            else:
+                # neighbors of c2 which were not neighbors of c1 become neighbors of c1
+                index2, c2_index = neighbors2[j, 1], neighbors2[j, 2]
+                saddle_indices[index2, c2_index] = c1
+                j += 1
+
+        # some js in the comparison may not have been taken into account
+        while j < len(neighbors2):
+            index2, c2_index = neighbors2[j, 1], neighbors2[j, 2]
+            saddle_indices[index2, c2_index] = c1
+            j += 1
+
+        return saddle_indices
```

### Comparing `dadapy-0.1.1/dadapy/density_estimation.py` & `dadapy-0.2.0/dadapy/density_estimation.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -84,15 +84,15 @@
 
         self.dc = None
         self.log_den = None
         self.log_den_err = None
 
     # ----------------------------------------------------------------------------------------------
 
-    def compute_density_kNN(self, k=10):
+    def compute_density_kNN(self, k=10, bias=False):
         """Compute the density of each point using a simple kNN estimator.
 
         Args:
             k (int): number of neighbours used to compute the density
 
         Returns:
             log_den (np.ndarray(float)): estimated log density
@@ -103,15 +103,19 @@
 
         if self.verb:
             print(f"k-NN density estimation started (k={k})")
 
         self.set_kstar(k)
 
         log_den, log_den_err, dc = return_not_normalised_density_kstarNN(
-            self.distances, self.intrinsic_dim, self.kstar, interpolation=False
+            self.distances,
+            self.intrinsic_dim,
+            self.kstar,
+            interpolation=False,
+            bias=bias,
         )
 
         # Normalise density
         log_den -= np.log(self.N)
 
         self.log_den = log_den
         self.log_den_err = log_den_err
@@ -144,23 +148,24 @@
             self.intrinsic_dim,
             self.N,
             self.maxk,
             Dthr,
             self.dist_indices.astype("int64"),
             self.distances.astype("float64"),
         )
+
         self.set_kstar(kstar)
 
         sec2 = time.time()
         if self.verb:
             print("{0:0.2f} seconds computing kstar".format(sec2 - sec))
 
     # ----------------------------------------------------------------------------------------------
 
-    def compute_density_kstarNN(self, Dthr=23.92812698):
+    def compute_density_kstarNN(self, Dthr=23.92812698, bias=False):
         """Compute the density of each point using a simple kNN estimator with an optimal choice of k.
 
         Args:
             Dthr (float): Likelihood ratio parameter used to compute optimal k, the value of Dthr=23.92 corresponds
                 to a p-value of 1e-6.
 
         Returns:
@@ -169,15 +174,19 @@
         """
         self.compute_kstar(Dthr)
 
         if self.verb:
             print("kstar-NN density estimation started")
 
         log_den, log_den_err, dc = return_not_normalised_density_kstarNN(
-            self.distances, self.intrinsic_dim, self.kstar, interpolation=False
+            self.distances,
+            self.intrinsic_dim,
+            self.kstar,
+            interpolation=False,
+            bias=bias,
         )
 
         # Normalise density
         log_den -= np.log(self.N)
 
         self.log_den = log_den
         self.log_den_err = log_den_err
@@ -235,15 +244,15 @@
         if self.verb:
             print("k-peaks density estimation finished")
 
         return self.log_den, self.log_den_err
 
     # ----------------------------------------------------------------------------------------------
 
-    def compute_density_PAk(self, Dthr=23.92812698, optimized=True):
+    def compute_density_PAk(self, Dthr=23.92812698, optimized=True, bias=False):
         """Compute the density of each point using the PAk estimator.
 
         Args:
             Dthr (float): Likelihood ratio parameter used to compute optimal k, the value of Dthr=23.92 corresponds
                 to a p-value of 1e-6.
 
         Returns:
@@ -262,23 +271,25 @@
         if optimized:
             log_den, log_den_err, dc = return_not_normalised_density_PAk_optimized(
                 self.distances,
                 self.intrinsic_dim,
                 self.kstar,
                 self.maxk,
                 interpolation=False,
+                bias=bias,
             )
 
         else:
             log_den, log_den_err, dc = return_not_normalised_density_PAk(
                 self.distances,
                 self.intrinsic_dim,
                 self.kstar,
                 self.maxk,
                 interpolation=False,
+                bias=bias,
             )
 
         sec2 = time.time()
 
         if self.verb:
             print(
                 "{0:0.2f} seconds optimizing the likelihood for all the points".format(
```

### Comparing `dadapy-0.1.1/dadapy/id_estimation.py` & `dadapy-0.2.0/dadapy/id_estimation.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -113,22 +113,24 @@
 
     # ----------------------------------------------------------------------------------------------
     def compute_id_2NN(
         self,
         algorithm="base",
         fraction=0.9,
         decimation=1,
+        n_iter=None,
         set_attr=True,
     ):
         """Compute intrinsic dimension using the 2NN algorithm.
 
         Args:
             algorithm (str): 'base' to perform the linear fit, 'ml' to perform maximum likelihood
             fraction (float): fraction of mus that will be considered for the estimate (discard highest mus)
             decimation (float): fraction of randomly sampled points used to compute the id
+            n_iter (int): number of times the ID is computed on data subsets (useful when decimation < 1)
             set_attr (bool): whether to change the class attributes as a result of the computation
 
         Returns:
             id (float): the estimated intrinsic dimension
             id_err (float): the standard error on the id estimation
             rs (float): the average nearest neighbor distance (rs)
 
@@ -160,80 +162,116 @@
                                         #'id' is the mean over 4 bootstrap samples;
                                         #'error' is standard error of the sample mean.
 
         References:
             E. Facco, M. d’Errico, A. Rodriguez, A. Laio, Estimating the intrinsic dimension of datasets by a minimal
             neighborhood information, Scientific reports 7 (1) (2017) 1–8
         """
+        assert (self.X is not None) or (
+            self.distances is not None
+        ), """2NN algorithm requires that either self.X or self.distances is not None.\
+            Please initialize a coordinate or distance matrix."""
         assert (
             0.0 < decimation and decimation <= 1.0
         ), "'decimation' must be between 0 and 1"
         assert 0.0 < fraction and fraction <= 1.0, "'fraction' must be between 0 and 1"
         if fraction == 1.0 and algorithm == "base":
             algorithm = "ml"
             print("fraction = 1: algorithm set to ml")
 
-        nrep = int(np.rint(1.0 / decimation))
-        ids = np.zeros(nrep)
-        rs = np.zeros(nrep)
-
-        N_subset = int(np.rint(self.N * decimation))
-        mus = np.zeros((N_subset, nrep))
-
-        for j in range(nrep):
-
-            if decimation == 1 and self.distances is not None:
-                # with decimation == 1 use saved distances if present
-                distances, dist_indices = self.distances, self.dist_indices
-
-            elif decimation == 1 and self.distances is None and set_attr is True:
-                # with decimation ==1 and set_attr==True compute distances and save them
+        if decimation == 1:
+            if self.distances is None:
                 self.compute_distances()
-                distances, dist_indices = self.distances, self.dist_indices
 
-            else:
-                # if set_attr==False or for decimation < 1 random sample points don't save distances
-                idx = np.random.choice(self.N, size=N_subset, replace=False)
-                X_decimated = self.X[idx]
+            mus = self.distances[:, 2] / self.distances[:, 1]
+            intrinsic_dim = self._compute_id_2NN(mus, fraction, algorithm)
+            intrinsic_dim_err = 0.0
+            intrinsic_dim_scale = np.mean(self.distances[:, np.array([1, 2])])
 
-                distances, dist_indices = compute_nn_distances(
-                    X_decimated,
-                    maxk=3,  # only compute first 2 nn
-                    metric=self.metric,
-                    period=self.period,
-                )
+        else:
+            n_subset = int(np.rint(self.N * decimation))
+            if n_iter is None:
+                n_iter = int(np.rint(1.0 / decimation))
 
-            mus[:, j] = distances[:, 2] / distances[:, 1]
-            ids[j] = self._compute_id_2NN(mus[:, j], fraction, algorithm)
-            rs[j] = np.mean(distances[:, np.array([1, 2])])
+            mus, id_list, r_list = self._compute_id_iterated(
+                n_iter, n_subset, fraction, algorithm
+            )
 
-        intrinsic_dim = np.mean(ids)
-        intrinsic_dim_err = np.std(ids) / len(ids) ** 0.5
-        intrinsic_dim_scale = np.mean(rs)
+            intrinsic_dim = np.mean(id_list)
+            intrinsic_dim_err = np.std(id_list) / len(id_list) ** 0.5
+            intrinsic_dim_scale = np.mean(r_list)
 
         if self.verb:
             print(f"ID estimation finished: selecting ID of {intrinsic_dim}")
 
         if set_attr:
             self.intrinsic_dim = intrinsic_dim
             self.intrinsic_dim_err = intrinsic_dim_err
             self.intrinsic_dim_scale = intrinsic_dim_scale
             self.intrinsic_dim_mus = mus
 
         return intrinsic_dim, intrinsic_dim_err, intrinsic_dim_scale
 
     # ----------------------------------------------------------------------------------------------
 
+    def _compute_id_iterated(self, n_iter, n_subset, fraction, algorithm):
+        ids = np.zeros(n_iter)
+        rs = np.zeros(n_iter)
+        n_survived = np.zeros(n_iter)
+        mus = [[] for _ in range(n_iter)]
+        decimation_from_distances = self.X is None and self.distances is not None
+
+        for j in range(n_iter):
+            # do decimation from pure distance matrix
+            if decimation_from_distances:
+                # random subsample a subset of indices
+                indices = np.random.choice(self.N, n_subset, replace=False)
+                # Is self.dist_indices[i, j] selected?
+                mask = np.isin(self.dist_indices, indices)
+
+                # distance matrix where the selected indices also have two nearest neighbors within self.maxk
+                distances = []
+                for index in indices:
+                    if np.sum(mask[index]) > 2:
+                        distances.append(self.distances[index, mask[index]][:3])
+                distances = np.array(distances)
+                n_survived[j] = distances.shape[0]
+
+            else:
+                idx = np.random.choice(self.N, size=n_subset, replace=False)
+                x_decimated = self.X[idx]
+                distances, _ = compute_nn_distances(
+                    x_decimated,
+                    maxk=3,  # only compute first 2 nn
+                    metric=self.metric,
+                    period=self.period,
+                )
+
+            mus[j] = distances[:, 2] / distances[:, 1]
+            ids[j] = self._compute_id_2NN(mus[j], fraction, algorithm)
+            rs[j] = np.mean(distances[:, np.array([1, 2])])
+
+        if decimation_from_distances and (np.mean(n_survived) < 0.8 * n_subset):
+            warnings.warn(
+                f"""Decimation from a sparse distance matrix uses
+                on average {int(np.mean(n_survived))} out of the {n_subset} data points. """,
+                stacklevel=2,
+            )
+
+        return mus, ids, rs
+
     def return_id_scaling_2NN(
         self,
         N_min=10,
         algorithm="base",
         fraction=0.9,
     ):
-        """Compute the id at different scales using the 2NN algorithm.
+        """Compute the id with the 2NN algorithm at different scales.
+
+        The different scales are obtained by sampling subsets of [N, N/2, N/4, N/8, ..., N_min] data points.
 
         Args:
             N_min (int): minimum number of points considered when decimating the dataset,
                         N_min effectively sets the largest 'scale';
             algorithm (str): 'base' to perform the linear fit, 'ml' to perform maximum likelihood;
             fraction (float): fraction of mus that will be considered for the estimate (discard highest mus).
 
@@ -275,37 +313,37 @@
             Nsubsets = Nsubsets[Nsubsets > N_min]
 
         ids_scaling = np.zeros(Nsubsets.shape[0])
         ids_scaling_err = np.zeros(Nsubsets.shape[0])
         rs_scaling = np.zeros((Nsubsets.shape[0]))
 
         for i, N_subset in enumerate(Nsubsets):
-
             ids_scaling[i], ids_scaling_err[i], rs_scaling[i] = self.compute_id_2NN(
                 algorithm=algorithm,
                 fraction=fraction,
                 decimation=N_subset / self.N,
                 set_attr=False,
             )
 
         return ids_scaling, ids_scaling_err, rs_scaling
 
     # ----------------------------------------------------------------------------------------------
     def return_id_scaling_gride(
-        self, range_max=64, d0=0.001, d1=1000, eps=1e-7, save_mus=False
+        self, range_max=64, d0=0.001, d1=1000, eps=1e-7, set_attr=False
     ):
         """Compute the id at different scales using the Gride algorithm.
 
         Args:
             range_max (int): maximum nearest neighbor rank considered for the id computations;
                             the number of id estimates are log2(range_max) as the nearest neighbor
                             order ('scale') is doubled at each estimate;
             d0 (float): minimum intrinsic dimension considered in the search;
             d1 (float): maximum intrinsic dimension considered in the search;
             eps (float): precision of the approximate id calculation.
+            set_attr (bool): whether to change the class attributes as a result of the computation
 
         Returns:
             ids_scaling (np.ndarray(float)): array of intrinsic dimensions of length log2(range_max);
             ids_scaling_err (np.ndarray(float)): array of error estimates;
             rs_scaling (np.ndarray(float)): array of average distances of the neighbors involved in the estimates.
 
         Quick Start:
@@ -334,68 +372,69 @@
                 array([0.52 0.69 0.93 1.26 1.75 2.48 3.54 4.99])
 
 
         References:
             F. Denti, D. Doimo, A. Laio, A. Mira, Distributional results for model-based intrinsic dimension
             estimators, arXiv preprint arXiv:2104.13832 (2021).
         """
+        assert (self.X is not None) or (
+            self.distances is not None
+        ), """2NN algorithm requires that either self.X or self.distances is not None.\
+            Please initialize a coordinate or distance matrix."""
+
         max_rank = min(self.N, range_max)
+        if self.X is None and max_rank > self.maxk:
+            max_rank = self.maxk
+            warnings.warn(
+                f"""{range_max} set to {range_max} but data class initialized with\
+                    a sparse distance matrix with only {self.maxk} nearest neighbors.\
+                    {range_max} is set to {self.maxk}""",
+                stacklevel=2,
+            )
         max_step = int(math.log(max_rank, 2))
         nn_ranks = np.array([2**i for i in range(max_step)])
 
-        if self.distances is not None and range_max < self.maxk + 1:
-            max_rank = min(max_rank, self.maxk + 1)
-            if self.verb:
-                print(
-                    f"distance already computed up to {max_rank}. max rank set to {max_rank}"
-                )
-
+        if self.distances is not None and max_rank < self.maxk + 1:
             mus = self.distances[:, nn_ranks[1:]] / self.distances[:, nn_ranks[:-1]]
             rs = self.distances[:, np.array([nn_ranks[:-1], nn_ranks[1:]])]
 
         elif self.X is not None:
-
-            if self.verb:
-                print(
-                    f"distance not computed up to {max_rank}. distance computation started"
-                )
-
             distances, dist_indices, mus, rs = self._return_mus_scaling(
                 range_scaling=max_rank
             )
-            # returns:
-            # distances, dist_indices (self.N, self.maxk+1): sorted distances and dist indices up to maxk+1
-            # mus (self.N, len(nn_ranks)): ratio between 2*kth and kth neighbor distances of every data point
-            # rs (self.N, 2, len(nn_ranks)): kth, 2*kth neighbor of every data, for every nn_ranks
+
             if self.verb:
                 print("distance computation finished")
 
             # if distances have not been computed save them
             if self.distances is None:
                 self.distances = distances
                 self.dist_indices = dist_indices
                 self.N = distances.shape[0]
 
         # compute IDs (and their error) via maximum likelihood for all the scales up to max_rank
+        ids_scaling, ids_scaling_err = self._compute_id_gride_multiscale(
+            mus, d0, d1, eps
+        )
         if self.verb:
-            print("id inference started")
-        ids_scaling, ids_scaling_err = self._compute_id_gride(mus, d0, d1, eps)
-        if self.verb:
-            print("id inference finished")
+            print("id computation finished")
 
         "average of the kth and 2*kth neighbor distances taken over all datapoints for each id estimate"
         rs_scaling = np.mean(rs, axis=(0, 1))
 
-        if save_mus:
+        if set_attr:
+            self.intrinsic_dim_gride = ids_scaling
+            self.intrinsic_dim_err_gride = ids_scaling_err
+            self.intrinsic_dim_scale_gride = rs_scaling
             self.intrinsic_dim_mus_gride = mus
 
         return ids_scaling, ids_scaling_err, rs_scaling
 
     # ----------------------------------------------------------------------------------------------
-    def _compute_id_gride(self, mus, d0, d1, eps):
+    def _compute_id_gride_multiscale(self, mus, d0, d1, eps):
         """Compute the id using the gride algorithm.
 
         Helper of return return_id_gride.
 
         Args:
             mus (np.ndarray(float)): ratio of the distances of nth and 2nth nearest neighbours (Ndata x log2(range_max))
             d0 (float): minimum intrinsic dimension considered in the search;
@@ -406,30 +445,40 @@
             intrinsic_dim (np.ndarray(float): array of id estimates
             intrinsic_dim_err (np.ndarray(float): array of error estimates
         """
         # array of ids (as a function of the average distance to a point)
         ids_scaling = np.zeros(mus.shape[1])
         # array of error estimates (via fisher information)
         ids_scaling_err = np.zeros(mus.shape[1])
+
         for i in range(mus.shape[1]):
             n1 = 2**i
-            id = ut._argmax_loglik(
-                self.dtype, d0, d1, mus[:, i], n1, 2 * n1, self.N, eps=eps
-            )  # eps=precision id calculation
-            ids_scaling[i] = id
-
-            ids_scaling_err[i] = (
-                1
-                / ut._fisher_info_scaling(
-                    id, mus[:, i], n1, 2 * n1, eps=5 * self.eps
-                )  # eps=regularization small numbers
-            ) ** 0.5
+
+            intrinsic_dim, id_error = self._compute_id_gride_single_scale(
+                d0, d1, mus[:, i], n1, 2 * n1, eps
+            )
+
+            ids_scaling[i] = intrinsic_dim
+            ids_scaling_err[i] = id_error
 
         return ids_scaling, ids_scaling_err
 
+    def _compute_id_gride_single_scale(self, d0, d1, mus, n1, n2, eps):
+        id = ut._argmax_loglik(
+            self.dtype, d0, d1, mus, n1, n2, eps=eps
+        )  # eps=precision id calculation
+        id_err = (
+            1
+            / ut._fisher_info_scaling(
+                id, mus, n1, 2 * n1, eps=5 * self.eps
+            )  # eps=regularization small numbers
+        ) ** 0.5
+
+        return id, id_err
+
     def _mus_scaling_reduce_func(self, dist, start, range_scaling):
         """Help to compute the "mus" needed to compute the id.
 
         Applied at the end of pairwise_distance_chunked see:
         https://github.com/scikit-learn/scikit-learn/blob/95119c13af77c76e150b753485c662b7c52a41a2/sklearn/metrics/pairwise.py#L1474
 
         Once a chunk of the distance matrix is computed _mus_scaling_reduce_func
@@ -459,15 +508,15 @@
         neigh_ind = np.argpartition(dist, steps[-1], axis=1)
         neigh_ind = neigh_ind[:, : steps[-1] + 1]
 
         # argpartition doesn't guarantee sorted order, so we sort again
         neigh_ind = neigh_ind[sample_range, np.argsort(dist[sample_range, neigh_ind])]
 
         dist = np.sqrt(dist[sample_range, neigh_ind])
-        dist = self._remove_zero_dists(dist)
+        dist = self.remove_zero_dists(dist)
         mus = dist[:, steps[1:]] / dist[:, steps[:-1]]
         rs = dist[:, np.array([steps[:-1], steps[1:]])]
 
         dist = copy.deepcopy(dist[:, : self.maxk + 1])
         neigh_ind = copy.deepcopy(neigh_ind[:, : self.maxk + 1])
 
         return dist, neigh_ind, mus, rs
@@ -512,15 +561,16 @@
 
         zero_dists = np.sum(
             neigh_dist[0][:, 1] <= 1.1 * np.finfo(neigh_dist[0].dtype).eps
         )
         if zero_dists > 0:
             warnings.warn(
                 """there may be data with zero distance from each other;
-                this may compromise the correct behavior of some routines"""
+                this may compromise the correct behavior of some routines""",
+                stacklevel=2,
             )
 
         return (
             np.vstack(neigh_dist),
             np.vstack(neigh_ind),
             np.vstack(mus),
             np.vstack(rs),
```

### Comparing `dadapy-0.1.1/dadapy/metric_comparisons.py` & `dadapy-0.2.0/dadapy/metric_comparisons.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -232,15 +232,15 @@
     def _return_imb_with_coords(self, X, coords, dist_indices, k):
         """Return the imbalances between a 'full' distance and a distance built using a subset of coordinates.
 
         Args:
             X: coordinate matrix
             coords: subset of coordinates to be used when building the alternative distance
             dist_indices (int[:,:]): nearest neighbours according to full distance
-            k (int): order of nearest neighbour considered, default is 1
+            k (int): number of neighbours considered in the computation of the imbalances, default is 1
 
         Returns:
             (float, float): the information imbalance from 'full' to 'alternative' and vice versa
         """
         X_ = X[:, coords]
 
         if self.period is not None:
@@ -453,37 +453,90 @@
 
         imbalances = self.return_inf_imb_target_selected_coords(
             target_ranks, coord_list, k=k
         )
 
         return np.array(coord_list), np.array(imbalances)
 
-    def return_label_overlap(self, labels, k=30):
+    def return_label_overlap(self, labels, k=30, avg=True):
         """Return the neighbour overlap between the full space and a set of labels.
 
         An overlap of 1 means that all neighbours of a point have the same label as the central point.
 
         Args:
-            labels (np.ndarray): the labels with respect to which the overlap is computed
+            labels (list): the labels with respect to which the overlap is computed
             k (int): the number of neighbours considered for the overlap
 
         Returns:
             (float): the neighbour overlap of the points
         """
         if self.distances is None:
             assert self.X is not None
             self.compute_distances()
 
-        overlaps = []
+        assert len(labels) == self.dist_indices.shape[0]
+        neighbor_index = self.dist_indices[:, 1 : k + 1]
+        ground_truth_labels = np.repeat(np.array([labels]).T, repeats=k, axis=1)
+        overlaps = np.equal(np.array(labels)[neighbor_index], ground_truth_labels)
+
+        overlaps = np.mean(overlaps, axis=1)
+        if avg:
+            overlaps = np.mean(overlaps)
+
+        return overlaps
+
+    def return_data_overlap(self, coordinates=None, distances=None, k=30, avg=True):
+        """Return the neighbour overlap between the full space and another dataset.
+
+        An overlap of 1 means that all neighbours of a point are the same in the two spaces.
+
+        Args:
+            coordinates (np.ndarray(float)): the data set to compare, of shape (N , dimension of embedding space)
+            distances (np.ndarray(float), tuple(np.ndarray(float), np.ndarray(float)) ):
+                                        Distance matrix (see base class for shape explanation)
+            k (int): the number of neighbours considered for the overlap
+
+        Returns:
+            (float): the neighbour overlap of the points
+        """
+        if self.distances is None:
+            assert self.X is not None
+            self.compute_distances()
+
+        if distances is None:
+            assert coordinates is not None
+            _, dist_indices = compute_nn_distances(
+                coordinates, self.maxk, self.metric, self.period
+            )
+        else:
+            distances, dist_indices, N, maxk = self._init_distances(
+                distances, self.maxk
+            )
+
+        if self.maxk < k:
+            k = self.maxk
+
+        assert self.N == dist_indices.shape[0]
+
+        overlaps = -np.ones((self.N))
+
         for i in range(self.N):
-            neigh_idx_i = self.dist_indices[i, 1 : k + 1]
-            overlaps.append(sum(labels[neigh_idx_i] == labels[i]) / k)
+            overlaps[i] = (
+                len(
+                    np.intersect1d(
+                        self.dist_indices[i, 1 : k + 1], dist_indices[i, 1 : k + 1]
+                    )
+                )
+                / k
+            )
 
-        overlap = np.mean(overlaps)
-        return overlap
+        if avg:
+            overlaps = np.mean(overlaps)
+
+        return overlaps
 
     def return_label_overlap_coords(self, labels, coords, k=30):
         """Return the neighbour overlap between a selection of coordinates and a set of labels.
 
         An overlap of 1 means that all neighbours of a point have the same label as the central point.
 
         Args:
@@ -554,7 +607,67 @@
             if self.verb:
                 print("computing overlap for coord selection")
 
             overlap = self.return_label_overlap_coords(labels, coords, k)
             overlaps.append(overlap)
 
         return overlaps
+
+    def return_inf_imb_causality(
+        self, cause_present, effect_present, effect_future, weights, k=1
+    ):
+        """Return the imbalances (weight * cause_present, effect_present) -> effect_future.
+
+        Args:
+            cause_present (np.ndarray(float)): N x D1 matrix, putative driver system data set at time t
+            effect_present (np.ndarray(float)): N x D2 matrix, putative driven system data set at time t
+            effect_future (np.ndarray(float)): N x D2 matrix, putative driven system data set at time t + tau
+            weights (list(float), np.ndarray(float)): scaling parameters for the driver system at time t
+            k (int): order of nearest neighbour considered for the calculation of the imbalance
+
+        Returns:
+            imbalances (np.ndarray(float)): the information imbalances for the different weights
+        """
+        _, ranks_effect_future = compute_nn_distances(
+            effect_future, self.maxk, self.metric, self.period
+        )
+
+        imbalances = Parallel(n_jobs=self.njobs)(
+            delayed(self.return_inf_imb_causality_target_rank)(
+                cause_present, effect_present, ranks_effect_future, weight, k
+            )
+            for weight in weights
+        )
+
+        return imbalances
+
+    def return_inf_imb_causality_target_rank(
+        self, cause_present, effect_present, ranks_effect_future, weight=1, k=1
+    ):
+        """Return the imbalance (weight * cause_present, effect_present) -> effect_future.
+
+        Args:
+            cause_present (np.ndarray(float)): N x D1 matrix, putative driver system data set at time t
+            effect_present (np.ndarray(float)): N x D2 matrix, putative driven system data set at time t
+            ranks_effect_future (np.ndarray(float)): N x maxk matrix, putative driven system ranks at time t + tau
+            weight (float): scaling parameter for the driver system at time t
+            k (int): order of nearest neighbour considered for the calculation of the imbalance
+
+        Returns:
+            imb (float): the information imbalance
+        """
+        if (
+            cause_present.shape[0] != effect_present.shape[0]
+            or cause_present.shape[0] != ranks_effect_future.shape[0]
+        ):
+            raise ValueError(
+                "Number of points must be the same in 'cause_present','effect_present' and 'effect_future'!"
+            )
+
+        space_present = np.column_stack((weight * cause_present, effect_present))
+        _, ranks_present = compute_nn_distances(
+            space_present, self.maxk, self.metric, self.period
+        )
+
+        imb = _return_imbalance(ranks_present, ranks_effect_future, k=k)
+
+        return imb
```

### Comparing `dadapy-0.1.1/dadapy/plot.py` & `dadapy-0.2.0/dadapy/plot.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2021-2022 The DADApy Authors. All Rights Reserved.
+# Copyright 2021-2023 The DADApy Authors. All Rights Reserved.
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #     http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -379,15 +379,15 @@
     plt.ylabel(r"ln($\rho$)")
     if savefig != "":
         plt.savefig(savefig)
     plt.show()
 
 
 def plot_inf_imb_plane(imbalances, coord_list=None, labels=None):
-    """Plot the information imbalance plane corresponding to the computed ibalances.
+    """Plot the information imbalance plane corresponding to the computed imbalances.
 
     Args:
         imbalances (np.ndarray): Imbalances from the full space to specific sets of coordinates and vice-versa
         coord_list (list of lists of integers, optional): The list of coordinates considered for the information
         imbalance computations
         labels (list of strings, optional): Labels for the list of coordinates
 
@@ -413,14 +413,152 @@
 
     plt.xlabel(r"$\Delta(X_{full} \rightarrow X_{coords}) $")
     plt.ylabel(r"$\Delta(X_{coords} \rightarrow X_{full}) $")
 
     plt.show()
 
 
+# --------------------------------------------------------------------------------------
+
+
+def plot_pdf(n_emp, n_mod, title=None, fileout=None):
+    """Compare two pdfs.
+
+    Args:
+        n_emp (np.ndarray): sample of empirical points
+        n_mod (np.ndarray): sample of model-simulated points
+        title (string, optional): title
+        fileout (string, optional): path to save the plot
+
+    Returns:
+
+    """
+
+    sup = max(n_emp.max(), n_mod.max())
+    inf = min(n_emp.min(), n_mod.min())
+    a = np.histogram(
+        n_emp, range=(inf - 0.5, sup + 0.5), bins=sup - inf + 1, density=True
+    )
+    b = np.histogram(
+        n_mod, range=(inf - 0.5, sup + 0.5), bins=sup - inf + 1, density=True
+    )
+
+    plt.figure()
+    if title is not None:
+        plt.title(title)
+    plt.plot(a[0], "-", label="n empirical", linewidth=4, alpha=0.9)
+    plt.plot(b[0], "--", label="n model", linewidth=4, alpha=0.9)
+    plt.xlabel("n", fontsize=15)
+    plt.ylabel("P(n)", fontsize=15)
+    plt.legend(fontsize=14, frameon=False)
+    plt.xticks(size=14)
+    plt.yticks(size=14)
+    plt.tight_layout()
+    if fileout is not None:
+        plt.savefig(fileout)
+    else:
+        plt.show()
+
+
+# --------------------------------------------------------------------------------------
+
+
+def plot_cdf(n_emp, n_mod, title, fileout=None):
+    """Compare two cdfs.
+
+    Args:
+        n_emp (np.ndarray): sample of empirical points
+        n_mod (np.ndarray): sample of model-simulated points
+        title (string, optional): title
+        fileout (string, optional): path to save the plot
+
+    Returns:
+
+    """
+    sup = max(n_emp.max(), n_mod.max())
+    inf = min(n_emp.min(), n_mod.min())
+    a = np.histogram(
+        n_emp, range=(inf - 0.5, sup + 0.5), bins=sup - inf + 1, density=True
+    )
+    b = np.histogram(
+        n_mod, range=(inf - 0.5, sup + 0.5), bins=sup - inf + 1, density=True
+    )
+
+    cdf_nn = np.cumsum(a[0])
+    cdf_nn = cdf_nn / cdf_nn[-1]
+    cdf_nmod = np.cumsum(b[0])
+    cdf_nmod = cdf_nmod / cdf_nmod[-1]
+
+    plt.figure()
+    plt.title(title)
+    plt.plot(cdf_nn, "-", label="n empirical", linewidth=4, alpha=0.9)
+    plt.plot(cdf_nmod, "--", label="n model", linewidth=4, alpha=0.9)
+    plt.xlabel("n", fontsize=15)
+    plt.ylabel("F(n)", fontsize=15)
+    plt.legend(fontsize=14, frameon=False)
+    plt.xticks(size=14)
+    plt.yticks(size=14)
+    plt.tight_layout()
+    if fileout is not None:
+        plt.savefig(fileout)
+    else:
+        plt.show()
+
+
+# --------------------------------------------------------------------------------------
+
+
+def plot_id_pv(x, idd, pv, title, xlabel, fileout):
+    """Plot IDs and p-values from windowing.
+
+    Args:
+        x (np.ndarray): scales
+        idd (np.ndarray): intrinsic dimensions
+        pv (np.ndarray): p-values
+        title (string, optional): title
+        xlabel (string, optional): label of x axis
+        fileout (string, optional): path to save the plot
+
+    Returns:
+
+    """
+    fig, ax1 = plt.subplots()
+
+    c_left = "firebrick"
+    c_right = "navy"
+
+    plt.yticks(fontsize=13)
+    plt.xticks(fontsize=13)
+
+    ax1.set_title(title)
+    ax1.set_xlabel(xlabel, size=15)
+    ax1.set_ylabel("estimated id", size=15, c=c_left)
+    ax1.tick_params(axis="y", colors=c_left)
+
+    ax1.scatter(x, idd, alpha=0.85, c=c_left, s=75)
+
+    ax2 = ax1.twinx()
+    ax2.set_ylabel("p-value", size=15, c=c_right)
+    ax2.tick_params(axis="y", colors=c_right)
+    ax2.set_yscale("log")
+
+    ax2.scatter(x, pv, marker="^", color=c_right, s=75)
+    # ax2.plot(data[:,0],np.ones_like(data[:,-1])*0.05,'k--',alpha=0.5,label=r'$\alpha=0.05$')
+
+    plt.legend()
+    plt.tight_layout()
+
+    if fileout is not None:
+        plt.savefig(fileout)
+    else:
+        plt.show()
+
+
+# --------------------------------------------------------------------------------------
+
 if __name__ == "__main__":
     # basic tests for plotting functions
     from dadapy import Data
 
     X = np.vstack(
         (np.random.normal(0, 1, size=(1000, 5)), np.random.normal(5, 1, size=(1000, 5)))
     )
```

### Comparing `dadapy-0.1.1/dadapy.egg-info/SOURCES.txt` & `dadapy-0.2.0/dadapy.egg-info/SOURCES.txt`

 * *Files 18% similar despite different names*

```diff
@@ -1,25 +1,34 @@
 LICENSE
 README.md
+pyproject.toml
 setup.cfg
 setup.py
 dadapy/__init__.py
 dadapy/base.py
 dadapy/clustering.py
 dadapy/data.py
 dadapy/density_estimation.py
+dadapy/id_discrete.py
 dadapy/id_estimation.py
 dadapy/metric_comparisons.py
 dadapy/plot.py
 dadapy.egg-info/PKG-INFO
 dadapy.egg-info/SOURCES.txt
 dadapy.egg-info/dependency_links.txt
 dadapy.egg-info/requires.txt
 dadapy.egg-info/top_level.txt
 dadapy/_cython/cython_clustering.c
+dadapy/_cython/cython_clustering_v2.c
 dadapy/_cython/cython_density.c
+dadapy/_cython/cython_distances.c
 dadapy/_cython/cython_maximum_likelihood_opt.c
 dadapy/_cython/cython_maximum_likelihood_opt_full.c
 dadapy/_utils/__init__.py
 dadapy/_utils/density_estimation.py
+dadapy/_utils/discrete_functions.py
+dadapy/_utils/id_estimation.py
 dadapy/_utils/metric_comparisons.py
-dadapy/_utils/utils.py
+dadapy/_utils/utils.py
+dadapy/_utils/discrete_volumes/L_coefficients_exact.dat
+dadapy/_utils/discrete_volumes/L_coefficients_float.dat
+dadapy/_utils/discrete_volumes/V_exact.dat
```

### Comparing `dadapy-0.1.1/setup.py` & `dadapy-0.2.0/setup.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,33 +1,41 @@
+import os
 from setuptools import setup, Extension
 
-cmdclass = {}
-
 class get_numpy_include(object):
     """Defer numpy.get_include() until after numpy is installed.
     From: https://stackoverflow.com/questions/19919905/how-to-bootstrap-numpy-installation-in-setup-py
     """
 
     def __str__(self):
         import numpy
 
         return numpy.get_include()
 
+
 ext_modules = []
 
 ext_modules += [
     Extension(
         "dadapy._cython.cython_clustering",
         sources=["dadapy/_cython/cython_clustering.c"],
         include_dirs=[get_numpy_include()],
     )
 ]
 
 ext_modules += [
     Extension(
+        "dadapy._cython.cython_clustering_v2",
+        sources=["dadapy/_cython/cython_clustering_v2.c"],
+        include_dirs=[get_numpy_include()],
+    )
+]
+
+ext_modules += [
+    Extension(
         "dadapy._cython.cython_maximum_likelihood_opt",
         sources=["dadapy/_cython/cython_maximum_likelihood_opt.c"],
         include_dirs=[get_numpy_include()],
     )
 ]
 
 ext_modules += [
@@ -43,20 +51,35 @@
     Extension(
         "dadapy._cython.cython_density",
         sources=["dadapy/_cython/cython_density.c"],
         include_dirs=[get_numpy_include()],
     )
 ]
 
+ext_parallel = Extension(
+        "dadapy._cython.cython_distances",
+        sources=["dadapy/_cython/cython_distances.c"],
+        include_dirs=[get_numpy_include()],)
+
+
+extra_compile_args = ['-fopenmp'],
+extra_link_args = ['-fopenmp'],
+
+# Check if the '-fopenmp' flag is supported
+command = 'gcc -fopenmp -E - < /dev/null > /dev/null 2>&1 && echo "OpenMP supported" || echo "OpenMP not supported"'
+
+if os.system(command) == "OpenMP supported":
+    # If '-fopenmp' is supported, add the extra compile and link arguments
+    # Installing cython_distances using OpenMP
+    ext_parallel.extra_compile_args.append('-fopenmp')
+    ext_parallel.extra_link_args.append('-fopenmp')
+
+# If OpenMP is not available, the C extension to compute distances in discrete spaces will not run in parallel.
+
+ext_modules += [ext_parallel]
 
 setup(
-    name="dadapy",
-    version="0.1.1",
-    url="https://dadapy.readthedocs.io/",
-    description="A Python package for Distance-based Analysis of DAta-manifolds.",
-    long_description="A Python package for Distance-based Analysis of DAta-manifolds.",
     packages=["dadapy", "dadapy._utils"],
-    install_requires=["numpy", "scipy", "scikit-learn", "matplotlib"],
-    extras_require={"dev": ["tox", "black", "isort", "pytest"]},
-    cmdclass=cmdclass,
     ext_modules=ext_modules,
+    include_package_data=True,
+    package_data={'dadapy': ['_utils/discrete_volumes/*.dat']},
 )
```

