# Comparing `tmp/datarobotx-0.1.7-py3-none-any.whl.zip` & `tmp/datarobotx-0.1.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,58 +1,58 @@
-Zip file size: 142133 bytes, number of entries: 56
--rw-rw-r--  2.0 unx     1566 b- defN 23-May-23 15:23 datarobotx/__init__.py
--rw-rw-r--  2.0 unx      271 b- defN 23-May-23 15:23 datarobotx/_version.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/py.typed
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/client/__init__.py
--rw-rw-r--  2.0 unx     9402 b- defN 23-May-23 15:23 datarobotx/client/datasets.py
--rw-rw-r--  2.0 unx    16124 b- defN 23-May-23 15:23 datarobotx/client/deployments.py
--rw-rw-r--  2.0 unx     1002 b- defN 23-May-23 15:23 datarobotx/client/prediction_servers.py
--rw-rw-r--  2.0 unx    25695 b- defN 23-May-23 15:23 datarobotx/client/projects.py
--rw-rw-r--  2.0 unx     2420 b- defN 23-May-23 15:23 datarobotx/client/status.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/common/__init__.py
--rw-rw-r--  2.0 unx     7273 b- defN 23-May-23 15:23 datarobotx/common/client.py
--rw-rw-r--  2.0 unx     9358 b- defN 23-May-23 15:23 datarobotx/common/config.py
--rw-rw-r--  2.0 unx     4588 b- defN 23-May-23 15:23 datarobotx/common/configurator.py
--rw-rw-r--  2.0 unx   131191 b- defN 23-May-23 15:23 datarobotx/common/dr_config.py
--rw-rw-r--  2.0 unx    10494 b- defN 23-May-23 15:23 datarobotx/common/logging.py
--rw-rw-r--  2.0 unx     3980 b- defN 23-May-23 15:23 datarobotx/common/transformations.py
--rw-rw-r--  2.0 unx    15032 b- defN 23-May-23 15:23 datarobotx/common/ts_helpers.py
--rw-rw-r--  2.0 unx      605 b- defN 23-May-23 15:23 datarobotx/common/types.py
--rw-rw-r--  2.0 unx    27474 b- defN 23-May-23 15:23 datarobotx/common/utils.py
--rw-rw-r--  2.0 unx      136 b- defN 23-May-23 15:23 datarobotx/llm/__init__.py
--rw-rw-r--  2.0 unx     2119 b- defN 23-May-23 15:23 datarobotx/llm/utils.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/llm/chains/__init__.py
--rw-rw-r--  2.0 unx    12665 b- defN 23-May-23 15:23 datarobotx/llm/chains/data_dict.py
--rw-rw-r--  2.0 unx     9398 b- defN 23-May-23 15:23 datarobotx/llm/chains/enrich.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/models/__init__.py
--rw-rw-r--  2.0 unx     2754 b- defN 23-May-23 15:23 datarobotx/models/autoanomaly.py
--rw-rw-r--  2.0 unx     3332 b- defN 23-May-23 15:23 datarobotx/models/autocluster.py
--rw-rw-r--  2.0 unx     2465 b- defN 23-May-23 15:23 datarobotx/models/automl.py
--rw-rw-r--  2.0 unx    11349 b- defN 23-May-23 15:23 datarobotx/models/autopilot.py
--rw-rw-r--  2.0 unx    11242 b- defN 23-May-23 15:23 datarobotx/models/autots.py
--rw-rw-r--  2.0 unx    14976 b- defN 23-May-23 15:23 datarobotx/models/colreduce.py
--rw-rw-r--  2.0 unx    24551 b- defN 23-May-23 15:23 datarobotx/models/deploy.py
--rw-rw-r--  2.0 unx    33947 b- defN 23-May-23 15:23 datarobotx/models/deployment.py
--rw-rw-r--  2.0 unx     7914 b- defN 23-May-23 15:23 datarobotx/models/evaluation.py
--rw-rw-r--  2.0 unx    16937 b- defN 23-May-23 15:23 datarobotx/models/featurediscovery.py
--rw-rw-r--  2.0 unx     5593 b- defN 23-May-23 15:23 datarobotx/models/intraproject.py
--rw-rw-r--  2.0 unx    28420 b- defN 23-May-23 15:23 datarobotx/models/model.py
--rw-rw-r--  2.0 unx     9736 b- defN 23-May-23 15:23 datarobotx/models/selfdiscovery.py
--rw-rw-r--  2.0 unx     4422 b- defN 23-May-23 15:23 datarobotx/models/share.py
--rw-rw-r--  2.0 unx    20800 b- defN 23-May-23 15:23 datarobotx/models/sparkingest.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-23 15:23 datarobotx/viz/__init__.py
--rw-rw-r--  2.0 unx     4906 b- defN 23-May-23 15:23 datarobotx/viz/charts.py
--rw-rw-r--  2.0 unx     6326 b- defN 23-May-23 15:23 datarobotx/viz/leaderboard.py
--rw-rw-r--  2.0 unx     9407 b- defN 23-May-23 15:23 datarobotx/viz/modelcard.py
--rw-rw-r--  2.0 unx     9508 b- defN 23-May-23 15:23 datarobotx/viz/viz.py
--rw-rw-r--  2.0 unx      926 b- defN 23-May-23 15:23 datarobotx/viz/templates/drx_button.html
--rw-rw-r--  2.0 unx     1490 b- defN 23-May-23 15:23 datarobotx/viz/templates/leaderboard.html
--rw-rw-r--  2.0 unx      414 b- defN 23-May-23 15:23 datarobotx/viz/templates/leaderboard.md
--rw-rw-r--  2.0 unx     5433 b- defN 23-May-23 15:23 datarobotx/viz/templates/model_card.html
--rw-rw-r--  2.0 unx       48 b- defN 23-May-23 15:23 datarobotx/viz/templates/model_card.md
--rw-rw-r--  2.0 unx     3140 b- defN 23-May-23 15:23 datarobotx/viz/templates/robot.svg
--rw-rw-r--  2.0 unx     3135 b- defN 23-May-23 15:23 datarobotx/viz/templates/robot_large.svg
--rw-rw-r--  2.0 unx     5537 b- defN 23-May-23 15:24 datarobotx-0.1.7.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-May-23 15:24 datarobotx-0.1.7.dist-info/WHEEL
--rw-rw-r--  2.0 unx       11 b- defN 23-May-23 15:24 datarobotx-0.1.7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4836 b- defN 23-May-23 15:24 datarobotx-0.1.7.dist-info/RECORD
-56 files, 544440 bytes uncompressed, 134433 bytes compressed:  75.3%
+Zip file size: 143113 bytes, number of entries: 56
+-rw-rw-r--  2.0 unx     1566 b- defN 23-May-25 20:03 datarobotx/__init__.py
+-rw-rw-r--  2.0 unx      271 b- defN 23-May-25 20:03 datarobotx/_version.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/py.typed
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/client/__init__.py
+-rw-rw-r--  2.0 unx     9402 b- defN 23-May-25 20:03 datarobotx/client/datasets.py
+-rw-rw-r--  2.0 unx    16124 b- defN 23-May-25 20:03 datarobotx/client/deployments.py
+-rw-rw-r--  2.0 unx     1002 b- defN 23-May-25 20:03 datarobotx/client/prediction_servers.py
+-rw-rw-r--  2.0 unx    25695 b- defN 23-May-25 20:03 datarobotx/client/projects.py
+-rw-rw-r--  2.0 unx     2425 b- defN 23-May-25 20:03 datarobotx/client/status.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/common/__init__.py
+-rw-rw-r--  2.0 unx     7760 b- defN 23-May-25 20:03 datarobotx/common/client.py
+-rw-rw-r--  2.0 unx     9358 b- defN 23-May-25 20:03 datarobotx/common/config.py
+-rw-rw-r--  2.0 unx     4588 b- defN 23-May-25 20:03 datarobotx/common/configurator.py
+-rw-rw-r--  2.0 unx   131191 b- defN 23-May-25 20:03 datarobotx/common/dr_config.py
+-rw-rw-r--  2.0 unx    10494 b- defN 23-May-25 20:03 datarobotx/common/logging.py
+-rw-rw-r--  2.0 unx     3980 b- defN 23-May-25 20:03 datarobotx/common/transformations.py
+-rw-rw-r--  2.0 unx    15032 b- defN 23-May-25 20:03 datarobotx/common/ts_helpers.py
+-rw-rw-r--  2.0 unx      605 b- defN 23-May-25 20:03 datarobotx/common/types.py
+-rw-rw-r--  2.0 unx    27474 b- defN 23-May-25 20:03 datarobotx/common/utils.py
+-rw-rw-r--  2.0 unx      143 b- defN 23-May-25 20:03 datarobotx/llm/__init__.py
+-rw-rw-r--  2.0 unx     3769 b- defN 23-May-25 20:03 datarobotx/llm/utils.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/llm/chains/__init__.py
+-rw-rw-r--  2.0 unx    12665 b- defN 23-May-25 20:03 datarobotx/llm/chains/data_dict.py
+-rw-rw-r--  2.0 unx    12342 b- defN 23-May-25 20:03 datarobotx/llm/chains/enrich.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/models/__init__.py
+-rw-rw-r--  2.0 unx     2754 b- defN 23-May-25 20:03 datarobotx/models/autoanomaly.py
+-rw-rw-r--  2.0 unx     3332 b- defN 23-May-25 20:03 datarobotx/models/autocluster.py
+-rw-rw-r--  2.0 unx     2465 b- defN 23-May-25 20:03 datarobotx/models/automl.py
+-rw-rw-r--  2.0 unx    11349 b- defN 23-May-25 20:03 datarobotx/models/autopilot.py
+-rw-rw-r--  2.0 unx    11242 b- defN 23-May-25 20:03 datarobotx/models/autots.py
+-rw-rw-r--  2.0 unx    14976 b- defN 23-May-25 20:03 datarobotx/models/colreduce.py
+-rw-rw-r--  2.0 unx    24551 b- defN 23-May-25 20:03 datarobotx/models/deploy.py
+-rw-rw-r--  2.0 unx    33947 b- defN 23-May-25 20:03 datarobotx/models/deployment.py
+-rw-rw-r--  2.0 unx     7914 b- defN 23-May-25 20:03 datarobotx/models/evaluation.py
+-rw-rw-r--  2.0 unx    16937 b- defN 23-May-25 20:03 datarobotx/models/featurediscovery.py
+-rw-rw-r--  2.0 unx     5593 b- defN 23-May-25 20:03 datarobotx/models/intraproject.py
+-rw-rw-r--  2.0 unx    28420 b- defN 23-May-25 20:03 datarobotx/models/model.py
+-rw-rw-r--  2.0 unx     9736 b- defN 23-May-25 20:03 datarobotx/models/selfdiscovery.py
+-rw-rw-r--  2.0 unx     4422 b- defN 23-May-25 20:03 datarobotx/models/share.py
+-rw-rw-r--  2.0 unx    20800 b- defN 23-May-25 20:03 datarobotx/models/sparkingest.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-25 20:09 datarobotx/viz/__init__.py
+-rw-rw-r--  2.0 unx     4906 b- defN 23-May-25 20:03 datarobotx/viz/charts.py
+-rw-rw-r--  2.0 unx     6326 b- defN 23-May-25 20:03 datarobotx/viz/leaderboard.py
+-rw-rw-r--  2.0 unx     9407 b- defN 23-May-25 20:03 datarobotx/viz/modelcard.py
+-rw-rw-r--  2.0 unx     9508 b- defN 23-May-25 20:03 datarobotx/viz/viz.py
+-rw-rw-r--  2.0 unx      926 b- defN 23-May-25 20:03 datarobotx/viz/templates/drx_button.html
+-rw-rw-r--  2.0 unx     1490 b- defN 23-May-25 20:03 datarobotx/viz/templates/leaderboard.html
+-rw-rw-r--  2.0 unx      414 b- defN 23-May-25 20:03 datarobotx/viz/templates/leaderboard.md
+-rw-rw-r--  2.0 unx     5433 b- defN 23-May-25 20:03 datarobotx/viz/templates/model_card.html
+-rw-rw-r--  2.0 unx       48 b- defN 23-May-25 20:03 datarobotx/viz/templates/model_card.md
+-rw-rw-r--  2.0 unx     3140 b- defN 23-May-25 20:03 datarobotx/viz/templates/robot.svg
+-rw-rw-r--  2.0 unx     3135 b- defN 23-May-25 20:03 datarobotx/viz/templates/robot_large.svg
+-rw-rw-r--  2.0 unx     5731 b- defN 23-May-25 20:09 datarobotx-0.1.8.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-25 20:09 datarobotx-0.1.8.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       11 b- defN 23-May-25 20:09 datarobotx-0.1.8.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4837 b- defN 23-May-25 20:09 datarobotx-0.1.8.dist-info/RECORD
+56 files, 549728 bytes uncompressed, 135413 bytes compressed:  75.4%
```

## zipnote {}

```diff
@@ -150,20 +150,20 @@
 
 Filename: datarobotx/viz/templates/robot.svg
 Comment: 
 
 Filename: datarobotx/viz/templates/robot_large.svg
 Comment: 
 
-Filename: datarobotx-0.1.7.dist-info/METADATA
+Filename: datarobotx-0.1.8.dist-info/METADATA
 Comment: 
 
-Filename: datarobotx-0.1.7.dist-info/WHEEL
+Filename: datarobotx-0.1.8.dist-info/WHEEL
 Comment: 
 
-Filename: datarobotx-0.1.7.dist-info/top_level.txt
+Filename: datarobotx-0.1.8.dist-info/top_level.txt
 Comment: 
 
-Filename: datarobotx-0.1.7.dist-info/RECORD
+Filename: datarobotx-0.1.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## datarobotx/_version.py

```diff
@@ -6,8 +6,8 @@
 # DataRobot, Inc.
 #
 # This is proprietary source code of DataRobot, Inc. and its
 # affiliates.
 #
 # Released under the terms of DataRobot Tool and Utility Agreement.
 #
-__version__ = "0.1.7"
+__version__ = "0.1.8"
```

## datarobotx/client/status.py

```diff
@@ -29,15 +29,15 @@
     Returns None if response status == 200 (still in process)
     Returns object id extracted from url if response status == 303
     """
     resp = await session.get(url, allow_redirects=False)
     if resp.status == 200:  # in process or errored update progress
         json = await resp.json()
         if json["status"].upper() in ("ERROR", "ABORTED", "EXPIRED"):
-            raise_status_error(json)
+            raise_status_error(url, json)
         if json["status"].upper() in ("COMPLETED"):  # used for async jobs like batch predictions
             return cast(str, json["id"])
     elif resp.status == 303:  # 303 / completed
         url = resp.headers["Location"]
         obj_id = url.split("/")[-2]
         return obj_id
     else:
```

## datarobotx/common/client.py

```diff
@@ -151,27 +151,45 @@
     kwargs = str(coro_kwargs)
     message = f'Polling using coroutine "{qualname}"'
     if len(coro_args) > 0:
         message += f', with positional arguments "{args}"'
     if len(coro_kwargs) > 0:
         message += f', with keyword arguments "{kwargs}"'
     message += f" timed out after {timeout} seconds."
+    message = "\n".join(
+        textwrap.wrap(
+            message,
+            width=100,
+            subsequent_indent="    ",
+            break_on_hyphens=False,
+            break_long_words=False,
+        )
+    )
     raise RuntimeError(message)
 
 
-def raise_status_error(json: Dict[str, Any]) -> None:
+def raise_status_error(url: str, json: Dict[str, Any]) -> None:
     """Raise a runtime error if error received while polling DR /status/ endpoint"""
     status_id = json.get("statusId", json.get("id", "UNKNOWN"))
     message = (
-        "DataRobot error detected while checking the status of task id "
-        + f"'{status_id}'.\n"
-        + f"Status: {json['status']}\n"
-        + f"Message: {json['message']}"
+        "DataRobot error detected while polling the status of job id "
+        + f"'{status_id}' at URL '{url}'.\n"
+        + f"Status: {json.get('status', 'UNKNOWN')}\n"
+        + f"Message: {json.get('message', 'UNKNOWN')}"
     )
-    raise RuntimeError(message)
+    message = "\n".join(
+        textwrap.wrap(
+            message,
+            width=100,
+            subsequent_indent="    ",
+            break_on_hyphens=False,
+            break_long_words=False,
+        )
+    )
+    raise ValueError(message)
 
 
 session = Session()
 
 
 async def read_resp_data(
     resp: aiohttp.ClientResponse, f: io.BytesIO, pbar: tqdm.tqdm  # type: ignore[type-arg]
```

## datarobotx/llm/__init__.py

```diff
@@ -1,7 +1,7 @@
 # flake8: noqa
 
 try:
     from .chains.data_dict import DataDictChain
-    from .chains.enrich import enrich
+    from .chains.enrich import embed, enrich
 except ImportError:
     pass
```

## datarobotx/llm/utils.py

```diff
@@ -7,15 +7,15 @@
 #
 # This is proprietary source code of DataRobot, Inc. and its
 # affiliates.
 #
 # Released under the terms of DataRobot Tool and Utility Agreement.
 from functools import wraps
 from math import floor, log10
-from typing import Any, Callable, Optional
+from typing import Any, Callable, Dict, List, Optional
 
 import langchain.cache
 
 
 def round_sig_figs(value: Any, coerce: bool = False, n: int = 2) -> str:
     """LLM prompt helper function for rounding pd.Series to n sig figs
     Parameters
@@ -68,7 +68,61 @@
 
         if cache is not None:
             return inner_wrapper
         else:
             return f
 
     return outer_wrapper
+
+
+# Stop gap until this guy is merged: https://github.com/hwchase17/langchain/pull/1930/
+class InMemoryEmbeddingsCache:
+    """Cache that stores things in memory."""
+
+    def __init__(self) -> None:
+        """Initialize with empty cache."""
+        self._cache: Dict[int, Optional[List[float]]] = {}
+
+    def lookup(self, text: str) -> Optional[List[float]]:
+        """Look up based on text hash."""
+        h = hash(text.encode())
+        return self._cache.get(h, None)
+
+    def update(self, text: str, embeddings: List[float]) -> None:
+        """Update cache with embeddings from text."""
+        h = hash(text.encode())
+        self._cache[h] = embeddings
+
+    def clear(self) -> None:
+        """Clear the cache."""
+        self._cache = {}
+
+
+def with_embedding_cache(
+    cache: bool = True,
+) -> Callable[[Callable[..., Any]], Any]:
+    """
+    Decorator for applying a custom llm cache for the duration of the function
+
+    Functions using this are in charge of cleaning the cache.
+    """
+    # Start caching at decoration time
+
+    def outer_wrapper(f: Callable[..., Any]) -> Callable[..., Any]:
+        @wraps(f)
+        def inner_wrapper(*args, **kwargs) -> Any:  # type: ignore[no-untyped-def]
+            cached = _embedding_cache.lookup(*args, **kwargs)
+            if cached is not None:
+                return cached
+            res = f(*args, **kwargs)
+            _embedding_cache.update(*args, embeddings=res)  # type: ignore[misc]
+            return res
+
+        if cache:
+            return inner_wrapper
+        else:
+            return f
+
+    return outer_wrapper
+
+
+_embedding_cache = InMemoryEmbeddingsCache()
```

## datarobotx/llm/chains/enrich.py

```diff
@@ -10,28 +10,30 @@
 #
 # Released under the terms of DataRobot Tool and Utility Agreement.
 from __future__ import annotations
 
 from typing import Any, Callable, Dict, List, Optional, Union
 import weakref
 
+from langchain import embeddings
 from langchain.cache import InMemoryCache
 from langchain.chains.base import Chain
 from langchain.chains.llm import LLMChain
+from langchain.embeddings.base import Embeddings
 from langchain.llms import BaseLLM
 from langchain.memory import ConversationTokenBufferMemory
 from langchain.prompts.base import BasePromptTemplate
 from langchain.prompts.prompt import PromptTemplate
 from langchain.schema import BaseMemory
 from langchain.tools import BaseTool
 import pandas as pd
 from pydantic import root_validator
 
 from datarobotx.common.logging import tqdm
-from datarobotx.llm.utils import with_llm_cache
+from datarobotx.llm.utils import _embedding_cache, with_embedding_cache, with_llm_cache
 
 _ENRICH_CONTEXT = (
     "A dataset is being prepared to train a predictive model. As part of "
     + "preparing the dataset new columns will be added by first retrieving an "
     + "answer to a question for each individual row in the dataset."
 )
 
@@ -258,7 +260,88 @@
 
         pbar.update()
         return answer
 
     # Close progress bar when enricher function is garbage collected
     weakref.finalize(enricher, pbar.close)
     return enricher
+
+
+def embed(
+    text: str,
+    using: Optional[Embeddings] = None,
+    cache: bool = True,
+) -> Callable[[pd.DataFrame], Any]:
+    """Enrich structured data with the embeddings from an LLM or chain
+
+    Convenience function for usage with pandas.DataFrame.apply():
+
+    - Caches duplicative embedding prompts
+    - Progress updating
+
+    Parameters
+    ----------
+    text : str
+        Text to extract embedding on. Provided as Python f-string that
+        can be formatted with data from other fields in the dataframe row or column
+    using : langchain.embeddings.base.Embeddings, default = None
+        Langchain abstraction to be used to extract embeddings
+        If None, SentenceTransformerEmbeddings(model="all-MiniLM-L6-v2") will be used
+    cache : bool, default = True
+        If true, an InMemoryCache will be initialized and used for the lifecycle of the returned
+        function; caching reduces API consumption from duplicative completions
+
+    Returns
+    -------
+    Callable
+        Function that can be used directly by pandas.DataFrame.apply() to perform the
+        requested enrichment.
+
+    Examples
+    --------
+    >>> import pandas as pd
+    >>> from langchain import embeddings
+    >>> embed_model = embeddings.OpenAIEmbeddings(model="text-embedding-ada-002")
+    >>> df = pd.read_csv('https://s3.amazonaws.com/datarobot_public/drx/' +
+    ...                  'amazon_food_reviews_small.csv')
+    >>> df_test = df[:5].copy(deep=True)
+    >>> df_with_embeddings = df_test.join(
+    ...    df_test.apply(embed('Summary: {Summary}\nReview: {Text}', embed_model), axis=1)
+    ...    )
+    """
+    pbar = tqdm(
+        bar_format="{n_fmt}{unit} [{elapsed}, {rate_fmt}]",
+        unit=" rows",
+        unit_scale=True,
+        unit_divisor=1000,
+    )
+    if using is None:
+        using = embeddings.SentenceTransformerEmbeddings(model="all-MiniLM-L6-v2")
+    else:
+        assert isinstance(using, Embeddings)
+
+    def embedder(s: pd.Series) -> str:
+        prompt_template = PromptTemplate.from_template(text)
+        formatted_q = prompt_template.format(
+            **{
+                key: value
+                for key, value in s.to_dict().items()
+                if key in prompt_template.input_variables
+            }
+        )
+
+        @with_embedding_cache(cache)
+        def embed(prompt: str) -> pd.Series:
+            answer = pd.Series(using.embed_query(prompt))  # type: ignore[union-attr]
+            answer.index = [f"embedding_{i}" for i in range(len(answer.index))]
+            return answer
+
+        pbar.update()
+        return embed(formatted_q)
+
+    def collect_garbage() -> None:
+        _embedding_cache.clear()
+        pbar.close()
+
+    # Close progress bar when embeder function is garbage collected
+    weakref.finalize(embedder, collect_garbage)
+    return embedder
```

## Comparing `datarobotx-0.1.7.dist-info/METADATA` & `datarobotx-0.1.8.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: datarobotx
-Version: 0.1.7
+Version: 0.1.8
 Summary: DataRobotX is a collection of DataRobot extensions
 Home-page: https://datarobot.github.io/drx
 Author: DataRobot
 Author-email: datarobotx@datarobot.com
 License: DataRobot Tool and Utility Agreement
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
@@ -72,26 +72,30 @@
 Requires-Dist: altair (<5.0.0) ; extra == 'dev'
 Requires-Dist: cloudpickle ; extra == 'dev'
 Requires-Dist: transformers ; extra == 'dev'
 Requires-Dist: scikit-learn ; extra == 'dev'
 Requires-Dist: torch ; extra == 'dev'
 Requires-Dist: pyspark ; extra == 'dev'
 Requires-Dist: typing-extensions (<4.6.0) ; extra == 'dev'
+Requires-Dist: sentence-transformers ; extra == 'dev'
+Requires-Dist: torch (>=1.6.0) ; extra == 'dev'
 Requires-Dist: openai ; extra == 'dev'
 Requires-Dist: pyarrow (==11.0.0) ; extra == 'dev'
 Requires-Dist: mypy (==1.0.0) ; extra == 'dev'
 Requires-Dist: urllib3 (<2.0.0) ; extra == 'dev'
 Requires-Dist: langchain ; (python_version >= "3.8") and extra == 'dev'
 Requires-Dist: pydantic ; (python_version >= "3.8") and extra == 'dev'
 Requires-Dist: tiktoken (==0.3.3) ; (python_version >= "3.8") and extra == 'dev'
 Provides-Extra: llm
 Requires-Dist: langchain ; extra == 'llm'
 Requires-Dist: pydantic ; extra == 'llm'
 Requires-Dist: tiktoken ; extra == 'llm'
 Requires-Dist: openai ; extra == 'llm'
+Requires-Dist: torch ; extra == 'llm'
+Requires-Dist: sentence-transformers ; extra == 'llm'
 Provides-Extra: spark
 Requires-Dist: pyspark ; extra == 'spark'
 
 <img align="center" src="https://s3.amazonaws.com/datarobot_public/drx/drx_gifs/logo.png" alt="drx">
 
 ![PyPI](https://img.shields.io/pypi/v/datarobotx)
 ![PyPI - Python Version](https://img.shields.io/pypi/pyversions/datarobotx)
```

## Comparing `datarobotx-0.1.7.dist-info/RECORD` & `datarobotx-0.1.8.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,31 +1,31 @@
 datarobotx/__init__.py,sha256=znA3kfQXkSRBeNke-g_y-KrY4bBPDplDMl2DH_uBUFg,1566
-datarobotx/_version.py,sha256=ZEibNTMFqsnJYyymde5x44ZVS8K13QnsY9IMlUeKn5s,271
+datarobotx/_version.py,sha256=YbmjoFAJFffTB02BogXW2qVn8XkYm31j1NmWsUFpwWs,271
 datarobotx/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 datarobotx/client/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 datarobotx/client/datasets.py,sha256=l1SoA0yl2Eqbb3pQNcoa9G_sj9MK_xObxt9pt7wvON8,9402
 datarobotx/client/deployments.py,sha256=KThuu3P5eeeFix8pRItg3NOD_cQlhxGpluBBwsRW2r4,16124
 datarobotx/client/prediction_servers.py,sha256=BS6Z1fT5ev6ldiIOxKZcuELGcT2k5scZ5j8VH7q3ads,1002
 datarobotx/client/projects.py,sha256=3bVdOMN8tTNrIYcyB7_KdlTghjy02fcSEkxPKmNj5W8,25695
-datarobotx/client/status.py,sha256=ExkEDpnBbyQCemp2r4cptUMzwhM5o3F_febWq4qsmKI,2420
+datarobotx/client/status.py,sha256=FeL6fiyhLtBxqIuLK_BWDgAR0wcBT218XFwbEAYalqk,2425
 datarobotx/common/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-datarobotx/common/client.py,sha256=FCfYTdvGTdneJDcFhmDzK4ZBIf1BtmzV5vYYi0z5CkI,7273
+datarobotx/common/client.py,sha256=TrjwGAIoxU2efp_YXa3PiZlQDIyRM5-sxopqJpVETPo,7760
 datarobotx/common/config.py,sha256=kVkaVX9JCjxuM_rzWfjgbATOoBvDuzDf9WuMn10zadY,9358
 datarobotx/common/configurator.py,sha256=vdTL4Esk_QYyWNg31EGap7PsBvhL7QizGDVr0FEKxSo,4588
 datarobotx/common/dr_config.py,sha256=RCFE7VEMFxmSFF2Ry2NvONC4g9xh98_QChuubgaq1OI,131191
 datarobotx/common/logging.py,sha256=r9vB5UAT4yGhX9jp98rtHGr3TykFS2yDYiAJvygaF6Q,10494
 datarobotx/common/transformations.py,sha256=ZZpNBmgu1jZvfrNoVtwfLsvSvwGDE5WCTrKkfYosngA,3980
 datarobotx/common/ts_helpers.py,sha256=SF1l_WxaYgt2Z6cKH5ab5WX6ExH3c4BW0aEgrm1qMz8,15032
 datarobotx/common/types.py,sha256=HJqSsXwz5kr7TeVzNc3J5vPsBwCO3pgMCkEartnoG9o,605
 datarobotx/common/utils.py,sha256=U0rZkyksp9xgadBi6stZGFBPa2F93hZFWMV9MkwPVCc,27474
-datarobotx/llm/__init__.py,sha256=3FvuXJ7JCHlVKIxlpw1tk7H7WfIco3Qe7vj6d55sj44,136
-datarobotx/llm/utils.py,sha256=VrHRbXIhfQgIidJ7b1r0zuw0tUbIp8-3yPpXOBoJ2HQ,2119
+datarobotx/llm/__init__.py,sha256=MHMQ_XOreud0vpjRRPAP43r6rb1TjrqvZJol84HMFO0,143
+datarobotx/llm/utils.py,sha256=nd41kCCdlp3PJjDoqZfkpgecvNabkvWwZ2llBaUuIpU,3769
 datarobotx/llm/chains/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 datarobotx/llm/chains/data_dict.py,sha256=Ee4761z8v5AvcbX7nykMhEHhEW-TnXr56K6BDe8q5G0,12665
-datarobotx/llm/chains/enrich.py,sha256=CEGafCnHM6DJBSQxUKLKWXLOUZWsPYM159lS5VP2aI0,9398
+datarobotx/llm/chains/enrich.py,sha256=QXRyxttsyfTMpC5Jo1eEq9ccEoh7MPzcB7ktqMS4ej0,12342
 datarobotx/models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 datarobotx/models/autoanomaly.py,sha256=IkhJzilTX1NWiiiEQbVgnd9rWRHnFdeUtdv03kREDXc,2754
 datarobotx/models/autocluster.py,sha256=UBwcx1_oFrlXnae4oNx3poNybmq1bBh_MPnsPbF_46w,3332
 datarobotx/models/automl.py,sha256=K3tTFn84WVdLobzDBDvEnOtyXazrIcZ86y0hN7elSho,2465
 datarobotx/models/autopilot.py,sha256=v2WlNOM55nQuaRtmCaBsnXJqlFtsfg71EAUXKkIo7BI,11349
 datarobotx/models/autots.py,sha256=zf5UmPJ_M1fF_lkiB_oixQ4hWb196F1KofHHm3ym6Fw,11242
 datarobotx/models/colreduce.py,sha256=Y0gXfziUEKOtOTMgGwprl4AZAAxtAvYT3zATuWHBJWg,14976
@@ -46,11 +46,11 @@
 datarobotx/viz/templates/drx_button.html,sha256=z2wsHdX64v0kbsleMCyo943QnEMGxi0RfHI34hyHMCg,926
 datarobotx/viz/templates/leaderboard.html,sha256=SYSaWRuNBXEzNcm0KE9TUbCo4KDHVB8wABbeQiiz3f8,1490
 datarobotx/viz/templates/leaderboard.md,sha256=QeFvLJVpLSJ1SwHF1cWdj46toXo_1ZD7OznMSG1Bx-k,414
 datarobotx/viz/templates/model_card.html,sha256=H2YKd4gNBGnaEMLCGeywx1DR6O3zvFM_ci9cxfvQ-p0,5433
 datarobotx/viz/templates/model_card.md,sha256=5Bdd7jKLEYY-hpeZ2I99C6sJwMqaeMS5jRbwLcmrCuc,48
 datarobotx/viz/templates/robot.svg,sha256=ZVruQowP1A7ri6frXGiCZnpOnY_KM8Osi66nMJAdyiM,3140
 datarobotx/viz/templates/robot_large.svg,sha256=lAbBH7yv151ngs7Y1jlMw8anqQ-PG77tzTJawLCrc3E,3135
-datarobotx-0.1.7.dist-info/METADATA,sha256=wDTsMurBdBBfFnt1B3FfJZBgbq9fZ4G-WkviJS7uFOs,5537
-datarobotx-0.1.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-datarobotx-0.1.7.dist-info/top_level.txt,sha256=_lN2CPexvLnaRX18n5OTMk9KDKnkKNABD7EzuwyfUpI,11
-datarobotx-0.1.7.dist-info/RECORD,,
+datarobotx-0.1.8.dist-info/METADATA,sha256=taSD6WnVI14S1WdXjl0FT8F25xHNcZmh3hEEGo_phB8,5731
+datarobotx-0.1.8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+datarobotx-0.1.8.dist-info/top_level.txt,sha256=_lN2CPexvLnaRX18n5OTMk9KDKnkKNABD7EzuwyfUpI,11
+datarobotx-0.1.8.dist-info/RECORD,,
```

